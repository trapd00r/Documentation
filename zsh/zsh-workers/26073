From zsh-workers-return-26073-mason-zsh=primenet.com.au@sunsite.dk Thu Nov 20 13:04:27 2008
Return-Path: <zsh-workers-return-26073-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3189 invoked from network); 20 Nov 2008 13:04:22 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 20 Nov 2008 13:04:22 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 15602 invoked from network); 20 Nov 2008 13:04:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 20 Nov 2008 13:04:13 -0000
Received: (qmail 10182 invoked by alias); 20 Nov 2008 13:04:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26073
Received: (qmail 10164 invoked from network); 20 Nov 2008 13:04:07 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 20 Nov 2008 13:04:07 -0000
Received: from ug-out-1314.google.com (ug-out-1314.google.com [66.249.92.170])
	by bifrost.dotsrc.org (Postfix) with ESMTP id D846680525B4
	for <zsh-workers@sunsite.dk>; Thu, 20 Nov 2008 14:04:03 +0100 (CET)
Received: by ug-out-1314.google.com with SMTP id 36so270596ugg.18
        for <zsh-workers@sunsite.dk>; Thu, 20 Nov 2008 05:04:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:received:date:from:to:subject
         :message-id:mime-version:content-type:content-disposition:user-agent;
        bh=sOfFLvDrvHmAM45ws8zKoZKgsWFlJSjnFVWHru6TQ7k=;
        b=jlc+sQM3pxpaEutG9s8dRAqdU/6Xg7jquaUisCZRmNWue0j0POr950acTnCc16l2a9
         GSijukmapekvH38iFF5C3uUkFvsDRSngfJvirtuM+NQUC3EyZRIPC6Ejy3Sj0NcsrRft
         WoPMEqt/ripR5BgXIbQkvT0KJ2mltf3WWAwMw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=date:from:to:subject:message-id:mime-version:content-type
         :content-disposition:user-agent;
        b=Stu4wPJa95EmuSqbtkqduCXI5ZeOQL9yqg1x2xAK3VMIMDGpv+G5bPjToG0DaCON6t
         xrRHlqRy9iS5AVb3ch20dngDQBMEdvH82SNBfMAncCTEc7Idmhu+XJjfZ/E9fdUBhvjx
         Jx5KqPU3zbXKwyzD4XVuP1K08pJ4bGIKOf51w=
Received: by 10.103.248.17 with SMTP id a17mr860740mus.97.1227186242467;
        Thu, 20 Nov 2008 05:04:02 -0800 (PST)
Received: from wicklow.lan (stc92-3-82-245-249-89.fbx.proxad.net [82.245.249.89])
        by mx.google.com with ESMTPS id s10sm1294692mue.15.2008.11.20.05.04.00
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 20 Nov 2008 05:04:01 -0800 (PST)
Received: by wicklow.lan (Postfix, from userid 1002)
	id D11C1F18A1; Thu, 20 Nov 2008 14:03:58 +0100 (CET)
Date: Thu, 20 Nov 2008 14:03:58 +0100
From: Baptiste Daroussin <baptiste.daroussin@gmail.com>
To: zsh-workers@sunsite.dk
Subject: new completions functions
Message-ID: <20081120130358.GA68204@wicklow.lan>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="kORqDWCi7qDJ0mEj"
Content-Disposition: inline
User-Agent: Mutt/1.5.18 (2008-05-17)
X-Virus-Scanned: ClamAV 0.92.1/8653/Thu Nov 20 10:04:07 2008 on bifrost
X-Virus-Status: Clean


--kORqDWCi7qDJ0mEj
Content-Type: multipart/mixed; boundary="PNTmBPCT7hxwcZjr"
Content-Disposition: inline


--PNTmBPCT7hxwcZjr
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Here are two new completion function :=20
one for portaudit (FreeBSD specific)
one for pfctl (all BSD related)

PS: still no idea about the ..<tab> bug ...
regards,
Bapt

--PNTmBPCT7hxwcZjr
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename=_portaudit

#compdef portaudit

_arguments -s \
    '-a[Vulnerability report for all installed packages]' \
    '-C[Vulnerability report for the port in the current working directory]' \
    '-d[Print creation date of the database]' \
    '-F[Fetch the current database]' \
    '-q[Quiet mode]' \
    '-V[Show portaudit version number]' \
    '-v[Verbose mode]' \
    '-X[Download a fresh database from least days old]:days:' \
    '-f[Check the packages listed in file]:file:_files' \
    '-r[Restrict listed vulnerabilities with eregex pattern]:eregex:' \
    ':pkg-name:'

--PNTmBPCT7hxwcZjr
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename=_pfctl
Content-Transfer-Encoding: quoted-printable

#compdef pfctl

local pfctl_flush_modifiers pfctl_optimizer_level pfctl_show_modifiers pfct=
l_tables_command pfctl_debug_level

pfctl_flush_modifiers=3D(
    'all:Flush all'
    'info:Flush the filter information'
    'nat:Flush the NAT rules'
    'osfp:Flush the passive operating system fingerprints'
    'queue:Flush the queue rules'
    'rules:Flush the filter rules'
    'state:Flush the stable table'
    'Sources:Flush the source tracking table'
    'Tables:Flush the tables'
)

pfctl_show_modifiers=3D(
    'nat:Show the currently loaded NAT rules'
    'queue:Show the currently loaded queue rules'
    'rules:Show the currently loaded filter rules'
    'Anchors:Show the currently loaded anchors directly attached to the mai=
n ruleset'
    'state:Show the contents of the state table'
    'Sources:Show the contents of the source tracking table'
    'info:Show filter information'
    'labels:Show per-rule statistics of filter rules with labels'
    'timeouts:Show the current global timeouts'
    'memory:Show the current pool memory hard limits'
    'Tables:Show the list of tables'
    'osfp:Show the list of operating system fingerprints'
    'Interfaces:Show the list of interfaces and interface drivers available=
 to PF'
    'all:Show all except for the lists of interfaces and operating system f=
ingerprints'
)

pfctl_optimizer_level=3D(
    'none:Disable the ruleset optimizer'
    'basic:Enable basic ruleset optimizations'
    'profile:Enable basic ruleset optimizations with profiling'
)
pfctl_tables_command=3D(
    'kill:Kill a table'
    'flush:Flush all addresses of a table'
    'add:Add one or more addresses in a table'
    'delete:Delete one or more addresses from a table'
    'expire:Delete addresses which had their statistics cleared more than n=
umber seconds ago'
    'replace:Replace the addresses of the table'
    'show:Show the content (addresses) of a table'
    'test:Test if the given addresses match a table'
    'zero:Clear all the statistics of a table'
    'load:Load only the table definitions from pf.conf(5)'
)
pfctl_debug_level=3D(
    "none:Don\'t generate debug messages"=20
    'urgent:Generate debug messages only for serious errors'=20
    'misc:Generate debug messages for various errors'=20
    'loud:Generate debug messages for common conditions'
)
_iface() {
    local pfctl_iface
    pfctl_iface=3D($(pfctl -s Interfaces))
    compadd $pfctl_iface
}
_tables() {
    local pfctl_tables
    pfctl_tables=3D($(pfctl -s Tables))
     compadd $pfctl_tables
}
# TODO:
# Missing -a
#
_arguments -s \
    '-F[Flush the filter parameters specified by modifier]:modifier:(($pfct=
l_flush_modifiers))' \
    '-A[Load only the queue rules present in the rule file]' \
    '-D[Define macro to be set to value]:macro:' \
    '-d[Disable the packet filter]' \
    '-e[Enable the packet filter]' \
    '-f[Load the rules contained in a file]:configuration file:_files' \
    '-g[Include output helpful for debugging]' \
    '-h[Help]' \
    '-i[Restrict the operation to the given interface]:interface:_iface' \
    '-K[Kill all of the source tracking entries originating from the specif=
ied host or network]:host or network:_hosts' \
    '-k[Kill all of the state entries originating from the specified host o=
r network]:host or network:_hosts' \
    '-m[Merge in explicitly given options]' \
    '-N[Load only the NAT rules present in the rule file]' \
    '-n[Do not actually load rules, just parse them]' \
    '-O[Load only the options present in the rule file]' \
    '-o[Control the ruleset optimizer]:level:(($pfctl_optimizer_level))' \
    '-p[Use the device file device instead of the default /dev/pf]:device:_=
files' \
    '-q[Only print errors and warnings]' \
    '-R[Load only the filter rules present in the rule file]' \
    '-r[Perform reverse DNS lookups on states when displaying them]' \
    '-s[Show the filter parameters specified by modifier]:modifier:(($pfctl=
_show_modifiers ))' \
    '-T[Specify the command to apply to the table]:command:(($pfctl_tables_=
command))' \
    '-t[Specify the name of the table]:table:_tables' \
    '-v[Produce more verbose output]' \
    '-x[Set the debug level]:debug level:(($pfctl_debug_level))' \
    '-z[Clear per-rule statistics]'

--PNTmBPCT7hxwcZjr--

--kORqDWCi7qDJ0mEj
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.9 (FreeBSD)

iEYEARECAAYFAkklYD4ACgkQ8kTtMUmk6Ew+MgCgvp0vsat1Ze+nDUMGnGlXNK1l
KtkAnjTk6ZknoB0CAmQUJiyzfd6NZb/m
=8M/e
-----END PGP SIGNATURE-----

--kORqDWCi7qDJ0mEj--

