From zsh-workers-return-19376-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 15 14:36:56 2004
Return-Path: <zsh-workers-return-19376-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 679 invoked from network); 15 Jan 2004 14:36:55 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 15 Jan 2004 14:36:55 -0000
Received: (qmail 21254 invoked by alias); 15 Jan 2004 14:36:47 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19376
Received: (qmail 21151 invoked from network); 15 Jan 2004 14:36:46 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 15 Jan 2004 14:36:46 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [198.51.251.8] by sunsite.dk (MessageWall 1.0.8) with SMTP; 15 Jan 2004 14:36:46 -0000
Received: from chorus.teradyne.com (chorus.teradyne.com [131.101.1.195])
	by rent.teradyne.com (8.8.8+Sun/8.8.8) with ESMTP id JAA14556;
	Thu, 15 Jan 2004 09:36:45 -0500 (EST)
Received: from kiki.icd.teradyne.com (kiki.icd.teradyne.com [131.101.10.126]) by chorus.teradyne.com (8.8.8+Sun/8.7.1) with ESMTP id JAA10459; Thu, 15 Jan 2004 09:36:45 -0500 (EST)
Received: from denver.icd.teradyne.com (denver [131.101.18.106])
	by kiki.icd.teradyne.com (8.9.3+Sun/8.9.3) with ESMTP id JAA26282;
	Thu, 15 Jan 2004 09:37:33 -0500 (EST)
Received: (from shelton@localhost)
	by denver.icd.teradyne.com (8.11.6+Sun/8.11.6) id i0FEai101668;
	Thu, 15 Jan 2004 09:36:44 -0500 (EST)
X-Authentication-Warning: denver.icd.teradyne.com: shelton set sender to acs@alumni.princeton.edu using -f
To: Peter Stephenson <pws@csr.com>
Cc: zsh-workers@sunsite.dk
Subject: Re: Coredump in test B02 as of 2004-01-13
References: <5197.1074163875@csr.com>
From: Vin Shelton <acs@alumni.princeton.edu>
Organization: Teradyne, Inc
Date: Thu, 15 Jan 2004 09:36:43 -0500
In-Reply-To: <5197.1074163875@csr.com> (Peter Stephenson's message of "Thu,
 15 Jan 2004 10:51:15 +0000")
Message-ID: <545u12x5ldw.fsf@alumni.princeton.edu>
Lines: 37
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Peter Stephenson <pws@csr.com> writes:

> Vin Shelton wrote:
>> Greetings,
>> 
>> On my SunOS systems at work I'm seeing the following failure in the
>> testsuite when running against a build of 2004-01-13:
>
> Reduces to:
>
>   unset argv
>   print $#
>
> Right idea, wrong number of ampersands.
>
> Index: Src/params.c
> ===================================================================
> RCS file: /cvsroot/zsh/zsh/Src/params.c,v
> retrieving revision 1.75
> diff -u -r1.75 params.c
> --- Src/params.c	12 Jan 2004 12:09:12 -0000	1.75
> +++ Src/params.c	15 Jan 2004 10:50:29 -0000
> @@ -2585,7 +2585,7 @@
>       * ways which need to be set to NULL.  We can't do this
>       * with user tied variables since we can leak memory.
>       */
> -    if ((pm->flags & PM_SPECIAL) & !x)
> +    if ((pm->flags & PM_SPECIAL) && !x)
>  	*dptr = mkarray(NULL);
>      else
>  	*dptr = x;
>

Yes, this fixes the coredump.  Thanks, Peter!

  - Vin

