From zsh-users-return-11388-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 12 00:47:11 2007
Return-Path: <zsh-users-return-11388-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23720 invoked from network); 12 Apr 2007 00:47:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=5.0 tests=AWL,BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Apr 2007 00:47:09 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 26424 invoked from network); 11 Apr 2007 19:20:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Apr 2007 19:20:23 -0000
Received: (qmail 8527 invoked by alias); 11 Apr 2007 19:20:15 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11388
Received: (qmail 8517 invoked from network); 11 Apr 2007 19:20:13 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 11 Apr 2007 19:20:13 -0000
Received: (qmail 25168 invoked from network); 11 Apr 2007 19:20:13 -0000
Received: from smtpout0157.sc1.he.tucows.com (HELO n082.sc1.he.tucows.com) (64.97.136.157)
  by a.mx.sunsite.dk with SMTP; 11 Apr 2007 19:20:10 -0000
Received: from sc.homeunix.net (82.26.164.173) by n082.sc1.he.tucows.com (7.2.069.1)
        id 45B8F3DB00590B92; Wed, 11 Apr 2007 19:20:08 +0000
Received: from chazelas by sc.homeunix.net with local (Exim 4.63)
	(envelope-from <stephane_chazelas@yahoo.fr>)
	id 1HbiMD-0003CC-NA; Wed, 11 Apr 2007 20:19:53 +0100
Date: Wed, 11 Apr 2007 20:19:53 +0100
From: Stephane Chazelas <Stephane_Chazelas@yahoo.fr>
To: Micah Cowan <micah@cowan.name>
Cc: zsh-users@sunsite.dk
Subject: Re: Reading line by line
Message-ID: <20070411191953.GF4996@sc.homeunix.net>
Mail-Followup-To: Micah Cowan <micah@cowan.name>, zsh-users@sunsite.dk
References: <242911.74922.qm@web8402.mail.in.yahoo.com> <461D2541.1080104@cowan.name> <20070411183602.GD4996@sc.homeunix.net> <461D2E79.6070907@cowan.name>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <461D2E79.6070907@cowan.name>
User-Agent: Mutt/1.5.6i

On Wed, Apr 11, 2007 at 11:52:41AM -0700, Micah Cowan wrote:
[...]
> $ echo 'a   b' | read -r
> 
> zsh will preserve all whitespace between a and b, whereas other shells 
> will condense it to a single space. POSIX states that, after splitting 
> the fields, if there is only one variable name left in the args, all 
> remaining fields will be assigned to that variable, with "their 
> intervening separation", which IMO is difficult to interpret as anything 
> other than the original separation that had been encountered.
[...]

No, you must have been confused by word splitting occuring upon
unquoted variable expansions.

In

echo 'a  b' | read a
echo $a

You see "a b", not because "read" compresses the spaces, but
because $a is word split into 2 arguments "a" and "b", and
echo outputs its parameters separated by *one* space.

echo 'a  b' | read a
echo "$a"

outputs "a  b"

That's what POSIX requires and that's how zsh behaves when
in POSIX emulation.

When not in POSIX emulation, zsh behaves (almost) the intuitive
way, that is

echo $a

does pass the content of $a as a single argument to echo which
is the content of $a. I said "almost" because it's only true if
$a is set and not empty (and of course if it's of scarlar type).

Note that word splitting is not the only thing performed by
POSIX shells upon variable expansion, there's also filename
generation. That's why one should *NEVER* leave variables
unquoted in POSIX scripts.

In zsh, to have word splitting:

$=a instead of $a ($= look like scissors).

$~a to have filename generation.

So $a in POSIX shells is like $=~a in zsh.

-- 
Stéphane

