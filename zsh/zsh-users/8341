From zsh-users-return-8341-mason-zsh=primenet.com.au@sunsite.dk Sat Jan 08 05:20:20 2005
Return-Path: <zsh-users-return-8341-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2975 invoked from network); 8 Jan 2005 05:20:19 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 8 Jan 2005 05:20:19 -0000
Received: (qmail 69376 invoked from network); 8 Jan 2005 05:20:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 8 Jan 2005 05:20:13 -0000
Received: (qmail 21864 invoked by alias); 8 Jan 2005 05:19:23 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8341
Received: (qmail 21853 invoked from network); 8 Jan 2005 05:19:22 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 8 Jan 2005 05:19:22 -0000
Received: (qmail 68173 invoked from network); 8 Jan 2005 05:18:23 -0000
Received: from adsl-216-158-26-62.cust.oldcity.dca.net (HELO spacecat.mcgillsociety.org) (216.158.26.62)
  by a.mx.sunsite.dk with SMTP; 8 Jan 2005 05:18:19 -0000
Received: from [10.0.1.2] (abase.mcgillsociety.org [216.158.26.165])
	by spacecat.mcgillsociety.org (8.11.3/8.11.3) with ESMTP id j085GHl347100
	for <zsh-users@sunsite.dk>; Sat, 8 Jan 2005 00:16:17 -0500 (EST)
Mime-Version: 1.0 (Apple Message framework v619)
In-Reply-To: <20031119170220.GB6550@atoom.net>
References: <6037.1069091427@csr.com> <2B1BAD39-19FA-11D8-BE95-000393768D2C@mcgillsociety.org> <20031119170220.GB6550@atoom.net>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Message-Id: <B4498176-6134-11D9-AB6E-000393768D2C@mcgillsociety.org>
Content-Transfer-Encoding: 7bit
X-Image-Url: http://www.mcgillsociety.org/magill.jpg
From: "William H. Magill" <magill@mcgillsociety.org>
Subject: zsh as ksh for login shell -- a bug with PS1?
Date: Sat, 8 Jan 2005 00:18:17 -0500
To: zsh users <zsh-users@sunsite.dk>
X-Mailer: Apple Mail (2.619)
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

This is under FreeBSD 5.3 on an Alpha XP1000;
Zsh version zsh 4.2.1 (alpha-portbld-freebsd6.0)

/usr/local/bin/zsh is sym-linked to /usr/local/bin/ksh
both are in /etc/shells.

I have a two-line prompt string

PS1='[$PWD] $me
  $HOST> '

I have been using this for many years. It works fine under ksh on Tru64 
Unix 5.1 and when zsh 4.2.1 itself is evoked as the login shell.

However, if I change the /etc/password entry to evoke ksh instead of 
zsh, the newline is lost, resulting in a prompt consisting of "$HOST> "

Use of single or double quotes makes no difference.
I've tried it with and without "set -o PROMPT_SUBST" and note no change.
I've tried it using \n instead of a "real" newline without effect. (\n 
winds up in the prompt string.)

Set displays PS1 as the string containing the newline. It is only the 
actual prompt itself which does not contain the newline, only the 
second line of output.

There is clearly a difference in between the performance of zsh and zsh 
as ksh.

Is this a bug with zsh?

T.T.F.N.
William H. Magill
# Beige G3 [Rev A motherboard - 300 MHz 768 Meg] OS X 10.2.8
# Flat-panel iMac (2.1) [800MHz - Super Drive - 768 Meg] OS X 10.3.7
# PWS433a [Alpha 21164 Rev 7.2 (EV56)- 64 Meg] Tru64 5.1a
# XP1000  [Alpha 21264-3 (EV6) - 256 meg] FreeBSD 5.3
# XP1000  [Alpha 21264-A (EV 6.7) - 384 meg] FreeBSD 5.3
magill@mcgillsociety.org
magill@acm.org
magill@mac.com
whmagill@gmail.com

