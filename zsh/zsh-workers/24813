From zsh-workers-return-24813-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 14 13:34:46 2008
Return-Path: <zsh-workers-return-24813-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14304 invoked from network); 14 Apr 2008 13:34:45 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Apr 2008 13:34:45 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 40097 invoked from network); 14 Apr 2008 13:34:41 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Apr 2008 13:34:41 -0000
Received: (qmail 25450 invoked by alias); 14 Apr 2008 13:34:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24813
Received: (qmail 25434 invoked from network); 14 Apr 2008 13:34:37 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 14 Apr 2008 13:34:37 -0000
Received: from wx-out-0506.google.com (wx-out-0506.google.com [66.249.82.227])
	by bifrost.dotsrc.org (Postfix) with ESMTP id EC4C78043AC7
	for <zsh-workers@sunsite.dk>; Mon, 14 Apr 2008 15:34:30 +0200 (CEST)
Received: by wx-out-0506.google.com with SMTP id h27so1404453wxd.3
        for <zsh-workers@sunsite.dk>; Mon, 14 Apr 2008 06:34:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=b+nz6xUaGJeMGSKvKHy6ri717ripKkAjiB7aMksyxbI=;
        b=pRYEhslu41AhY1S7T3GGBaMLHdtcGt/C9uEueccGf9rzM+hEI7LnMIO9gOPswz4AqaL+RdpqhOeZHZCDRY7XKfukqgg+GXN+vhaA5KvOq5ymSJMlTHe8MP6lWSe5P9yYZQ08qmnDVlmtO0EsjmfpFvYCpMeAYe+JRFx/VeNu0t8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=gYB1UE+VpI/dBqZhLLPyiPUwaJ6x4X6B94Ae4ZlXHrILPrSoszdogsnqJETg6Y/lC6hNVwr9CMlivRaLcDQguYwOdi8aRTpkJPA42v2cfP/E3yieT+U/HdXP5q8VscvmfYG8ux6YAKmUxN/vLRpqyDItvNkeBsNN8LtC0R1AeIc=
Received: by 10.141.42.10 with SMTP id u10mr3317066rvj.252.1208180059849;
        Mon, 14 Apr 2008 06:34:19 -0700 (PDT)
Received: by 10.141.202.18 with HTTP; Mon, 14 Apr 2008 06:34:19 -0700 (PDT)
Message-ID: <237967ef0804140634l7e02ce6fofff7f3f3ec6c8d7c@mail.gmail.com>
Date: Mon, 14 Apr 2008 15:34:19 +0200
From: "Mikael Magnusson" <mikachu@gmail.com>
To: "Zsh Hackers' List" <zsh-workers@sunsite.dk>
Subject: Re: PATCH: (large) initial support for combining characters in ZLE.
In-Reply-To: <20080413175442.0e95a241@pws-pc>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <20080413175442.0e95a241@pws-pc>
X-Virus-Scanned: ClamAV 0.91.2/6759/Mon Apr 14 14:56:05 2008 on bifrost
X-Virus-Status: Clean

On 13/04/2008, Peter Stephenson <p.w.stephenson@ntlworld.com> wrote:
> Here is my first broad brush attempt to get combining characters working
>  in the line editor.  I think it's now working well enough to make it
>  worth testing, even if most of the testing is going to be making sure I
>  haven't broken anything that currently works.  SINGLE_LINE_ZLE in
>  particular could do with a workout since I've changed that without a
>  great deal of testing (it's not fundamentally kaput, but it could easily
>  be slightly bruised).

Hi, I'm not sure if you want bug reports at this point, but one thing
I noticed and can reproduce in zsh -f is that the cursor sometimes
gets misplaced in the terminal with combiningchars on.
% zsh -f
% setopt combiningchars
% print -z $'\u0342'
the buffer should now contain an inverted <0342>, press left or ctrl-a
or whatever to go to the start of the line and press 'a'. Here, in
both urxvt and xterm (though in xterm no ~ appears over the a) the
cursor goes to sit on the start of the previous line in the terminal.
Funnily when you backspace it goes back to the proper place in the
current buffer again.

-- 
Mikael Magnusson

