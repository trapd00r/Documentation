From zsh-workers-return-15905-mason-zsh=primenet.com.au@sunsite.dk Sun Sep 30 01:27:40 2001
Return-Path: <zsh-workers-return-15905-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15049 invoked from network); 30 Sep 2001 01:27:39 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Sep 2001 01:27:39 -0000
Received: (qmail 16105 invoked by alias); 30 Sep 2001 01:27:33 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15905
Received: (qmail 16093 invoked from network); 30 Sep 2001 01:27:32 -0000
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <1010930012412.ZM20346@candle.brasslantern.com>
Date: Sun, 30 Sep 2001 01:24:12 +0000
In-Reply-To: <20010929202423.K16561@hithaeglir.net>
Comments: In reply to lordzork@lordzork.com
        "Re: error on TTY read: no such file or directory" (Sep 29,  8:24pm)
References: <20010928121347.B16561@hithaeglir.net> 
	<3BB56D03.2000300@mow.siemens.ru> 
	<20010929034953.E16561@hithaeglir.net> 
	<3BB62E93.10802@mow.siemens.ru> 
	<20010929170811.G16561@hithaeglir.net> 
	<3BB63D16.5040709@mow.siemens.ru> 
	<20010929173848.H16561@hithaeglir.net> 
	<3BB64378.8060505@mow.siemens.ru> 
	<20010929181100.I16561@hithaeglir.net> 
	<1010929223918.ZM20169@candle.brasslantern.com> 
	<20010929202423.K16561@hithaeglir.net>
X-Mailer: Z-Mail (5.0.0 30July97)
To: lordzork@lordzork.com, zsh-workers@sunsite.dk
Subject: Re: error on TTY read: no such file or directory
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Sep 29,  8:24pm, lordzork@lordzork.com wrote:
}
} In the gothic chambers of the underworld on Sat 29 Sep 2001 at 18:39 -0400,
} Bart Schaefer muttered darkly:
} 
} > You need to find out why your read() call is so badly broken!
} 
} and this read() function is a part of what? zsh? glibc?

It's a system call (that's why it shows up in strace output).

As a workaround you can try changing

	    if (r == 1)
		break;

to

	    if (r > 0)
		break;

at line 407 of Src/Zle/zle_main.c; but if the wrong number of bytes may
be returned by read(), all sorts of other things are going to break (not
just in zsh), so you shouldn't leave it at that.  You may have to take
this up on a linux kernel list.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

