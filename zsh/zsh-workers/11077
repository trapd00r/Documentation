From zsh-workers-return-11077-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 02 15:17:19 2000
Return-Path: <zsh-workers-return-11077-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16711 invoked from network); 2 May 2000 15:17:18 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 May 2000 15:17:18 -0000
Received: (qmail 19383 invoked by alias); 2 May 2000 15:17:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11077
Received: (qmail 19306 invoked from network); 2 May 2000 15:17:03 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000502151648.ZM14068@candle.brasslantern.com>
Date: Tue, 2 May 2000 15:16:48 +0000
In-Reply-To: <390EC0E9.54E0FA69@u.genie.co.uk>
Comments: In reply to Oliver Kiddle <opk@u.genie.co.uk>
        "PATCH: _complete_debug and Re: Completion troubles" (May  2, 12:50pm)
References: <390EC0E9.54E0FA69@u.genie.co.uk>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Zsh workers <zsh-workers@sunsite.auc.dk>
Subject: Re: PATCH: _complete_debug and Re: Completion troubles
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On May 2, 12:50pm, Oliver Kiddle wrote:
}
} > Use _complete_debug, ^X?, and examine the trace file.
} 
} I actually, have nedit aliased to /usr/local/bin/nc and _complete_debug
} had a few problems creating a trace file with lots of slashes in its
} name.

Ooops.

} With the print -zR line in _complete_debug, why is $VISUAL and $EDITOR
} used? Why would anyone want to edit the trace file?

I always want to edit the trace file.  It's much easier to search forward
and backward in most editors than it is in most pagers, and I also find it
helpful to be able to delete (or hide with narrowing in emacs) large parts
of the trace that I have determined to be unrelated to the problem.

} > } The other thing is the _expand completer now seems to be expanding
} > } everything after a tilde which is annoying.
} > 
} > Hmm, that doesn't happen to me;  I get this sort of thing:
} 
} You get what I would expect. Try setting the glob style to a true value.

Ah.  That's a little odd, since `glob' ususally means filename generation
and `~' is filename expansion, but there probably isn't any useful way to
distinguish the two during _expand.

} You're right about substitute being true as being significant. I'm not
} sure that your fix has worked enitiely though - I get an error message
} about the closing brace being expected. What do you get if you do:
} exp='${foo'
} echo $(print -lR - ${(e)exp} 2>/dev/null)

Hmm, I was sure I tested that.  Got the redirection in the wrong place.

--- zsh-forge/current/Completion/Core/_expand	Mon May  1 10:58:58 2000
+++ Completion/Core/_expand	Tue May  2 08:04:07 2000
@@ -39,7 +39,7 @@
   { [[ "$curcontext" = expand-word:* ]] && expr=1 } } &&
     [[ "${(e):-\$[$expr]}" -eq 1 ]] &&
     exp=( ${(f)"$(print -lR - ${(e)exp//\\[ 	
-]/ } 2>/dev/null)"} )
+]/ })"} ) 2>/dev/null
 
 # If the array is empty, store the original string again.
 

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

