From zsh-users-return-8046-mason-zsh=primenet.com.au@sunsite.dk Fri Oct 08 13:20:41 2004
Return-Path: <zsh-users-return-8046-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21667 invoked from network); 8 Oct 2004 13:20:40 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 8 Oct 2004 13:20:40 -0000
Received: (qmail 45290 invoked from network); 8 Oct 2004 13:20:35 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 8 Oct 2004 13:20:35 -0000
Received: (qmail 14345 invoked by alias); 8 Oct 2004 13:19:49 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8046
Received: (qmail 14320 invoked from network); 8 Oct 2004 13:19:47 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 8 Oct 2004 13:19:47 -0000
Received: (qmail 43507 invoked from network); 8 Oct 2004 13:18:59 -0000
Received: from smtpout.mac.com (17.250.248.89)
  by a.mx.sunsite.dk with SMTP; 8 Oct 2004 13:18:57 -0000
Received: from mac.com (webmail09-en1 [10.13.10.98])
	by smtpout.mac.com (Xserve/MantshX 2.0) with ESMTP id i98DItLU005509
	for <zsh-users@sunsite.dk>; Fri, 8 Oct 2004 06:18:55 -0700 (PDT)
Received: from webmail09 (localhost [127.0.0.1])
	by mac.com (Xserve/webmail09/MantshX 4.0) with ESMTP id i98DIt5P007462
	for <zsh-users@sunsite.dk>; Fri, 8 Oct 2004 06:18:55 -0700 (PDT)
Message-ID: <15673690.1097241535059.JavaMail.jordan.breeding@mac.com>
Date: Fri, 08 Oct 2004 08:18:55 -0500
From: Jordan Breeding <jordan.breeding@mac.com>
To: zsh-users@sunsite.dk
Subject: prompt and prompt_cr option
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Originating-IP: 199.171.212.100/instID=45
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.9 required=6.0 tests=BAYES_30 autolearn=no 
	version=2.63
X-Spam-Hits: -0.9

Hello,

I have run into the problem several times of having lines of output in the shell that don't have a newline and having the prompt overwrite them.  I did find the `setopt nopromptcr` solution but I also like having multiline editing always work correctly.  I thought that I would try and solve both problems with the following:

setopt nopromptcr
prompt='%(1l,\n,)%! %n@%m %0~ > '

but that didn't seem to do the trick.  Is there a way to force zsh to check to see if the last character that was printed was a newline and if it wasn't to just print one before it issues the carriage return?

Jordan

