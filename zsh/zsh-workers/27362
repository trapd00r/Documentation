From zsh-workers-return-27362-mason-zsh=primenet.com.au@zsh.org Sat Nov 07 19:10:57 2009
Return-Path: <zsh-workers-return-27362-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2804 invoked by alias); 7 Nov 2009 19:10:57 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27362
Received: (qmail 4997 invoked from network); 7 Nov 2009 19:10:53 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 209.85.219.209 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=9LX9tLdEtEDEsdvgZ2KfEy7lH/WVpQzTrHvjcaZrRpg=;
        b=bu+0K+3vYesbLV3ltDYvvCR8RnAKG8cjJ5Li4hyPXj0KhytNM1uf9vqbox1mXhfpn0
         atTVLoggjY7MtSADTHmlwcO810Vwm0pFvxPcXrBdZl8eNrurvq9G3DVLFcwLKtIEBgXH
         x77NZX+NGWI2xzvKSLpZ/CeTPECwehzjk6nP4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=ikbx1NQPTt2+DxwjD0dXYBaRNe6h4kMEeky/TJfym++hGp95UWRKY4vR4ckYuDIFaW
         vvkqrfUX/HJooqS84JvSkcHWpljek/DnqYna7ftPOxDVC92dz8lNs67vM8GkPSEjou+/
         dFYanrYiZ3+OuQOA3KRMww6MCsVx0YNv46GcI=
MIME-Version: 1.0
Date: Sat, 7 Nov 2009 20:10:48 +0100
Message-ID: <237967ef0911071110x7b95a7a0kba90923d0e1961c1@mail.gmail.com>
Subject: Some more fixes for the attr module
From: Mikael Magnusson <mikachu@gmail.com>
To: zsh workers <zsh-workers@zsh.org>
Content-Type: multipart/mixed; boundary=000e0cdf935cdca9940477ccb700

--000e0cdf935cdca9940477ccb700
Content-Type: text/plain; charset=UTF-8

I ran clang 2.6 in analyze mode on zsh and it picked up some mistakes
I made with the error handling (patch attached). If anyone wants to
look at the rest i tarred up the reports and put them here, but most
of them are likely to be false positives (7.3MB packed)
http://mika.l3ib.org/zsh-clang-2009-11-06.tar.gz

-- 
Mikael Magnusson

--000e0cdf935cdca9940477ccb700
Content-Type: text/x-patch; charset=US-ASCII; 
	name="0001-attr-Fix-some-logic-errors-pointed-out-by-clang.patch"
Content-Disposition: attachment; 
	filename="0001-attr-Fix-some-logic-errors-pointed-out-by-clang.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_g1qqzsxu0

RnJvbTogTWlrYWVsIE1hZ251c3NvbiA8bWlrYWNodUBnbWFpbC5jb20+CkRhdGU6IEZyaSwgNiBO
b3YgMjAwOSAyMzo0MDoxMCArMDEwMApTdWJqZWN0OiBbUEFUQ0hdIGF0dHI6IEZpeCBzb21lIGxv
Z2ljIGVycm9ycyBwb2ludGVkIG91dCBieSBjbGFuZwoKVGhyZWUgX2xlbiB2YXJpYWJsZXMgd2Vy
ZSBjaGVja2VkIHdoZW4gdGhleSB3ZXJlIHVuaW5pdGlhbGl6ZWQKVGhlIGNhc2UgZm9yIHJldHVy
bmluZyAyIGNvdWxkIG5ldmVyIG9jY3VyCi0tLQogU3JjL01vZHVsZXMvYXR0ci5jIHwgICAxMiAr
KysrKystLS0tLS0KIDEgZmlsZXMgY2hhbmdlZCwgNiBpbnNlcnRpb25zKCspLCA2IGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL1NyYy9Nb2R1bGVzL2F0dHIuYyBiL1NyYy9Nb2R1bGVzL2F0dHIu
YwppbmRleCA3MjM0ODYyLi5hOWU5OTQ5IDEwMDY0NAotLS0gYS9TcmMvTW9kdWxlcy9hdHRyLmMK
KysrIGIvU3JjL01vZHVsZXMvYXR0ci5jCkBAIC05OCw3ICs5OCw3IEBAIHN0YXRpYyBpbnQKIGJp
bl9nZXRhdHRyKGNoYXIgKm5hbSwgY2hhciAqKmFyZ3YsIE9wdGlvbnMgb3BzLCBVTlVTRUQoaW50
IGZ1bmMpKQogewogICAgIGludCByZXQgPSAwOwotICAgIGludCBsaXN0X2xlbiwgdmFsX2xlbiwg
YXR0cl9sZW4sIHNsZW47CisgICAgaW50IGxpc3RfbGVuLCB2YWxfbGVuID0gMCwgYXR0cl9sZW4g
PSAwLCBzbGVuOwogICAgIGNoYXIgKnZhbHVlLCAqZmlsZSA9IGFyZ3ZbMF0sICphdHRyID0gYXJn
dlsxXSwgKnBhcmFtID0gYXJndlsyXTsKICAgICBpbnQgc3ltbGluayA9IE9QVF9JU1NFVChvcHMs
ICdoJyk7CiAKQEAgLTEyNSw5ICsxMjUsOSBAQCBiaW5fZ2V0YXR0cihjaGFyICpuYW0sIGNoYXIg
Kiphcmd2LCBPcHRpb25zIG9wcywgVU5VU0VEKGludCBmdW5jKSkKICAgICAgICAgICAgIHpmcmVl
KHZhbHVlLCB2YWxfbGVuKzEpOwogICAgICAgICB9CiAgICAgfQotICAgIGlmIChsaXN0X2xlbiA8
IDAgfHwgdmFsX2xlbiA8IDAgfHwgYXR0cl9sZW4gPCAwKSAgeworICAgIGlmIChsaXN0X2xlbiA8
IDAgfHwgdmFsX2xlbiA8IDAgfHwgYXR0cl9sZW4gPCAwIHx8IGF0dHJfbGVuID4gdmFsX2xlbikg
IHsKICAgICAgICAgendhcm5uYW0obmFtLCAiJXM6ICVlIiwgbWV0YWZ5KGZpbGUsIHNsZW4sIE1F
VEFfTk9BTExPQyksIGVycm5vKTsKLSAgICAgICAgcmV0ID0gMSArIChhdHRyX2xlbiA+IHZhbF9s
ZW4pOworICAgICAgICByZXQgPSAxICsgKGF0dHJfbGVuID4gdmFsX2xlbiB8fCBhdHRyX2xlbiA8
IDApOwogICAgIH0KICAgICByZXR1cm4gcmV0OwogfQpAQCAtMTcyLDcgKzE3Miw3IEBAIHN0YXRp
YyBpbnQKIGJpbl9saXN0YXR0cihjaGFyICpuYW0sIGNoYXIgKiphcmd2LCBPcHRpb25zIG9wcywg
VU5VU0VEKGludCBmdW5jKSkKIHsKICAgICBpbnQgcmV0ID0gMDsKLSAgICBpbnQgdmFsX2xlbiwg
bGlzdF9sZW4sIHNsZW47CisgICAgaW50IHZhbF9sZW4sIGxpc3RfbGVuID0gMCwgc2xlbjsKICAg
ICBjaGFyICp2YWx1ZSwgKmZpbGUgPSBhcmd2WzBdLCAqcGFyYW0gPSBhcmd2WzFdOwogICAgIGlu
dCBzeW1saW5rID0gT1BUX0lTU0VUKG9wcywgJ2gnKTsKIApAQCAtMjE0LDkgKzIxNCw5IEBAIGJp
bl9saXN0YXR0cihjaGFyICpuYW0sIGNoYXIgKiphcmd2LCBPcHRpb25zIG9wcywgVU5VU0VEKGlu
dCBmdW5jKSkKICAgICAgICAgfQogICAgICAgICB6ZnJlZSh2YWx1ZSwgdmFsX2xlbisxKTsKICAg
ICB9Ci0gICAgaWYgKHZhbF9sZW4gPCAwIHx8IGxpc3RfbGVuIDwgMCkgeworICAgIGlmICh2YWxf
bGVuIDwgMCB8fCBsaXN0X2xlbiA8IDAgfHwgbGlzdF9sZW4gPiB2YWxfbGVuKSB7CiAgICAgICAg
IHp3YXJubmFtKG5hbSwgIiVzOiAlZSIsIG1ldGFmeShmaWxlLCBzbGVuLCBNRVRBX05PQUxMT0Mp
LCBlcnJubyk7Ci0gICAgICAgIHJldCA9IDEgKyAobGlzdF9sZW4gPiB2YWxfbGVuKTsKKyAgICAg
ICAgcmV0ID0gMSArIChsaXN0X2xlbiA+IHZhbF9sZW4gfHwgbGlzdF9sZW4gPCAwKTsKICAgICB9
CiAgICAgcmV0dXJuIHJldDsKIH0KLS0gCjEuNi41Cgo=
--000e0cdf935cdca9940477ccb700--

