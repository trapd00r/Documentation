From zsh-users-return-12635-mason-zsh=primenet.com.au@sunsite.dk Mon Feb 25 17:18:03 2008
Return-Path: <zsh-users-return-12635-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6849 invoked from network); 25 Feb 2008 17:18:01 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 25 Feb 2008 17:18:01 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 56304 invoked from network); 25 Feb 2008 17:17:34 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 25 Feb 2008 17:17:34 -0000
Received: (qmail 21677 invoked by alias); 25 Feb 2008 17:17:25 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12635
Received: (qmail 21658 invoked from network); 25 Feb 2008 17:17:24 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 25 Feb 2008 17:17:24 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [217.69.20.190])
	by bifrost.dotsrc.org (Postfix) with ESMTP id DEE698026E0B
	for <zsh-users@sunsite.dk>; Mon, 25 Feb 2008 18:17:20 +0100 (CET)
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly51d.srv.mailcontrol.com (MailControl) with ESMTP id m1PHHDbH012589
	for <zsh-users@sunsite.dk>; Mon, 25 Feb 2008 17:17:16 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 25 Feb 2008 17:17:13 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id m1PHHDSj030297
	for <zsh-users@sunsite.dk>; Mon, 25 Feb 2008 17:17:13 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id m1PHHDbO030294
	for <zsh-users@sunsite.dk>; Mon, 25 Feb 2008 17:17:13 GMT
Message-Id: <200802251717.m1PHHDbO030294@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: autoload and alias expansion question
In-reply-to: <20080225164322.965811F9663@su20.iworld.com>
References: <20080225164322.965811F9663@su20.iworld.com>
Comments: In-reply-to "Peter Hegedus" <hegedus@jupitermedia.com>
   message dated "Mon, 25 Feb 2008 11:43:22 -0500."
Date: Mon, 25 Feb 2008 17:17:13 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 25 Feb 2008 17:17:13.0094 (UTC) FILETIME=[42FF8A60:01C877D2]
X-Scanned-By: MailControl A-08-00-04 (www.mailcontrol.com) on 10.68.0.161
X-Virus-Scanned: ClamAV 0.91.2/5987/Mon Feb 25 16:09:20 2008 on bifrost
X-Virus-Status: Clean

"Peter Hegedus" wrote:
> hegedus@su20% cat >foobar <<EOF
> foobar () { }
> alias DATE=date ; barfoo () { setopt aliases ; DATE ; ECHO OK }
> EOF
> hegedus@su20% autoload foobar
> hegedus@su20% foobar
> hegedus@su20% barfoo
> barfoo: command not found: DATE
> OK

> Do I miss something?

No, you don't.  Aliases are expanded very early, during the initial
parsing of the code, so the DATE is reached and parsed before the alias
command is run.

> Is there a way to make this work?

You have two obvious options.

Firstly, most people when writing scripts or functions would use scripts
or functions at this point anyway, i.e. DATE() { date; }.  The main use
of aliases is as a hack at the command line to save typing; they are
rather less atractive if that's not an issue.

Second, you can put the alias definitions in a separate file and ensure
that that gets loaded before the function.  There are various ways of
doing this if that's what you really need.  Until we know why you're not
using a function for DATE it's hard to answer.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

