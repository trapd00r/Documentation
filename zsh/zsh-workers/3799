From zsh-workers-request@math.gatech.edu Sat Mar 14 17:09:25 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 3976 invoked from network); 14 Mar 1998 17:09:23 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 14 Mar 1998 17:09:23 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id LAA19304;
	Sat, 14 Mar 1998 11:52:52 -0500 (EST)
Resent-Date: Sat, 14 Mar 1998 11:52:52 -0500 (EST)
Message-ID: <19980314165200.44416@thelonious.new.ox.ac.uk>
Date: Sat, 14 Mar 1998 16:52:00 +0000
From: Adam Spiers <adam@thelonious.new.ox.ac.uk>
To: zsh workers mailing list <zsh-workers@math.gatech.edu>
Subject: Seg fault after unset PATH
Reply-To: Adam Spiers <adam.spiers@new.ox.ac.uk>
Mail-Followup-To: zsh workers mailing list <zsh-workers@math.gatech.edu>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.89.1i
Resent-Message-ID: <"fPyo-1.0.Zj4.ZNh2r"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3799
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

miles:adam ...BUILD/zsh-3.0.5/Src % ./zsh
miles:adam ...BUILD/zsh-3.0.5/Src % unlimit coredumpsize 
miles:adam ...BUILD/zsh-3.0.5/Src % unset PATH           
miles:adam ...BUILD/zsh-3.0.5/Src % finger
zsh: 7075 segmentation fault  ./zsh
miles:adam ...BUILD/zsh-3.0.5/Src % gdb ./zsh core
GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.16 (i586-unknown-linux), Copyright 1996 Free Software Foundation, Inc...
Core was generated by `./zsh'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /lib/libncurses.so.4...done.
Reading symbols from /lib/libc.so.5...done.
Reading symbols from /lib/ld-linux.so.1...done.
#0  0x805c875 in hashcmd (arg0=0x80c734c "finger", pp=0x80e1510) at exec.c:448
448             if (**pp == '/') {
(gdb) bt
#0  0x805c875 in hashcmd (arg0=0x80c734c "finger", pp=0x80e1510) at exec.c:448
#1  0x805f2bd in execcmd (cmd=0x80c7460, input=0, output=0, how=2, last1=2)
    at exec.c:1364
#2  0x805d68e in execpline2 (pline=0x80c74a8, how=2, input=0, output=0, 
    last1=0) at exec.c:802
#3  0x805cf06 in execpline (l=0x80c744c, how=2, last1=0) at exec.c:647
#4  0x805cb27 in execlist (list=0x80c74b8, dont_change_job=0, exiting=0)
    at exec.c:527
#5  0x80708ef in loop (toplevel=1) at init.c:131
#6  0x807075a in main (argc=1, argv=0xbffff6b0) at init.c:77
#7  0x804a0cb in ___crt_dummy__ ()
(gdb) q
miles:adam ...BUILD/zsh-3.0.5/Src % echo $ZSH_VERSION 
3.0.5
miles:adam ...BUILD/zsh-3.0.5/Src % file zsh
zsh: ELF 32-bit LSB executable, Intel 80386, version 1, dynamically linked, not stripped
miles:adam ...BUILD/zsh-3.0.5/Src % uname -a
Linux miles.new.ox.ac.uk 2.0.33 #4 Wed Feb 18 10:49:27 GMT 1998 i586 unknown

I built this version of zsh using the spec file from the SRPM
for 3.0.5 on the RedHat contrib site, so no particularly odd
build options:

./configure --prefix=/usr --bindir=/bin --enable-etcdir=/etc/zsh 

Feel free to ask if you want more information on reproducing the
bug.  Hope this is of some use in tracking it down!

--
Adam Spiers, Computing Officer, New College, Oxford University, UK **
violoncello/modern jazz/juggling/cycling/Perl/Linux fanatic, M$ hater
e-mail: adam.spiers@new.ox.ac.uk  WWW: http://www.new.ox.ac.uk/~adam/

