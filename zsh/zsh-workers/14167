From zsh-workers-return-14167-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 30 16:47:57 2001
Return-Path: <zsh-workers-return-14167-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1146 invoked from network); 30 Apr 2001 16:47:56 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Apr 2001 16:47:56 -0000
Received: (qmail 19700 invoked by alias); 30 Apr 2001 16:47:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14167
Received: (qmail 19687 invoked from network); 30 Apr 2001 16:47:50 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
Date: Mon, 30 Apr 2001 20:47:31 +0400 (MSD)
From: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
X-X-Sender:  <bor@itsrm2.mow.siemens.ru>
To: <zsh-workers@sunsite.dk>
cc: Peter Whaite <peta@cortexmachina.com>
Subject: Re: comptest* failed to load module: zsh/termcap
In-Reply-To: <1010430163014.ZM4757@candle.brasslantern.com>
Message-ID: <Pine.SV4.4.33.0104302044140.13810-100000@itsrm2.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 30 Apr 2001, Bart Schaefer wrote:

> On Apr 30, 11:44am, Peter Whaite wrote:
> }
> } "Andrej Borsenkow" said:
> }
> } > And, of course - what system, what compiler, etc.
> }
> } % cat /etc/issue
> }
> } Red Hat Linux release 6.2 (Zoot)
> } Kernel 2.4.2 on an i586
>
> Meanwhile, I can reproduce your problem on that machine.  I changed the
> linkage for termcap and terminfo from dynamic to static and got:
>
> Modules/termcap.o: In function `scantermcap':
> Modules/termcap.o(.text+0x450): undefined reference to `boolcodes'
> Modules/termcap.o(.text+0x459): undefined reference to `boolcodes'
> Modules/termcap.o(.text+0x4bd): undefined reference to `numcodes'
> Modules/termcap.o(.text+0x4c3): undefined reference to `numcodes'
> Modules/termcap.o(.text+0x515): undefined reference to `strcodes'
> Modules/termcap.o(.text+0x51b): undefined reference to `strcodes'
>
> So the problem is that configure.in is still missing the AC_SEARCH_LIBS
> call to find the ncurses libraries (it does one only for tgetent, which
> finds old termcap first).
>

But it should not find the above variables then and should not try use
them (or use local static placeholders). So, the question is - why
configure sets HAVE_BOOLCODES and others at all? I believe, we finally
cleaned this up ... are you sure you are using the lates CVS?


> Edit configure.in; look for the line:
>
> AC_SEARCH_LIBS(tgetent, [$termcap_curses_order])
>
> Copy'n'paste that line, s/tgetent/tigetstr/, rerun autoconf and configure,
> then try "make" again.
>

That's workaround; still, the actual bug is different IMHO.

-andrej

