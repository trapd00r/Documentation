From zsh-workers-return-11453-mason-zsh=primenet.com.au@sunsite.auc.dk Thu May 18 07:15:27 2000
Return-Path: <zsh-workers-return-11453-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20032 invoked from network); 18 May 2000 07:15:25 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 May 2000 07:15:25 -0000
Received: (qmail 21791 invoked by alias); 18 May 2000 07:15:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11453
Received: (qmail 21782 invoked from network); 18 May 2000 07:15:18 -0000
Date: Thu, 18 May 2000 09:14:48 +0200 (MET DST)
Message-Id: <200005180714.JAA01448@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Wed, 17 May 2000 22:13:16 +0100
Subject: PATCH: Re: Module completion problem


Peter Stephenson wrote:

> Completing after zmodload currently gives me the message
> 
> _path_files:305: unknown file attribute
> 
> I don't know why, since the line in question is trying to expand
> 
>   ./Zsh/*.s[ol](:r)
> 
> which looks quite reasonable to me.  Or should the (:r) already have been
> removed in this case?

It had `...(\:r)' because _files didn't replace `\:' by `:'. I'm
pretty sure I tested this, has it changed lately? Or did I commit a
non-final version?

Bye
 Sven

Index: Completion/Core/_files
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_files,v
retrieving revision 1.11
diff -u -r1.11 _files
--- Completion/Core/_files	2000/05/11 09:12:57	1.11
+++ Completion/Core/_files	2000/05/18 07:12:56
@@ -53,7 +53,7 @@
   for sdef in "$def[@]"; do
 
     tag="${${sdef#*[^\\]:}%%:*}"
-    pat="${${${sdef%%:${tag}*}//\\\\:/:}//,/ }"
+    pat="${${${sdef%%:${tag}*}//\\:/:}//,/ }"
 
     if [[ "$sdef" = *:${tag}:* ]]; then
       descr="${(Q)sdef#*:${tag}:}"

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

