From zsh-users-return-14891-mason-zsh=primenet.com.au@zsh.org Fri Feb 26 10:55:01 2010
Return-Path: <zsh-users-return-14891-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6604 invoked by alias); 26 Feb 2010 10:55:01 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14891
Received: (qmail 9638 invoked from network); 26 Feb 2010 10:54:59 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-3.0 required=5.0 tests=AWL,BAYES_00,
	RCVD_IN_DNSWL_LOW,SPF_HELO_PASS autolearn=ham version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at csr.com does not designate permitted sender hosts)
Date: Fri, 26 Feb 2010 10:54:50 +0000
From: Peter Stephenson <pws@csr.com>
To: zsh-users@zsh.org
Subject: Re: Globbing inside conditional expression
Message-ID: <20100226105450.3531820a@news01>
In-Reply-To: <5169ff11002260218ld3499cco24f8285706ee946c@mail.gmail.com>
References: <5169ff11002260218ld3499cco24f8285706ee946c@mail.gmail.com>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 26 Feb 2010 10:54:50.0664 (UTC) FILETIME=[1E9F8A80:01CAB6D2]
X-Scanned-By: MailControl A-09-22-10 (www.mailcontrol.com) on 10.68.0.111

On Fri, 26 Feb 2010 10:18:01 +0000
Ben North <ben@redfrontdoor.org> wrote:
> > Actually [[ -f XX* ]] is invalid because [[ ]] doesn't do globbing.
> > You need the [ -f XX* ] form (see below).
> 
> answering my question.  Apologies for the noise.
> 
> Perhaps the documentation could be clarified though?

It's sort of implied by the fact that patterns are used for other reasons
in conditions, though as the XX* in the -f isn't a pattern there's room for
ambiguity in interpreting the documentation as it stands.

I suppose it's obvious, but globbing would produce multiple files, and then
a lot of the tests don't really make sense.  What does [[ -d XX* ]] mean if
some expansions are directories and some aren't?

Index: Doc/Zsh/cond.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/cond.yo,v
retrieving revision 1.8
diff -p -u -r1.8 cond.yo
--- Doc/Zsh/cond.yo	19 Jan 2010 10:20:16 -0000	1.8
+++ Doc/Zsh/cond.yo	26 Feb 2010 10:52:01 -0000
@@ -183,9 +183,10 @@ enditem()
 
 Normal shell expansion is performed on the var(file), var(string) and
 var(pattern) arguments, but the result of each expansion is constrained to
-be a single word, similar to the effect of double quotes.  However, pattern
-metacharacters are active for the var(pattern) arguments; the patterns
-are the same as those used for filename generation, see
+be a single word, similar to the effect of double quotes.
+File generation is not performed on any form of argument to conditions.
+However, pattern metacharacters are active for the var(pattern) arguments;
+the patterns are the same as those used for filename generation, see
 ifzman(\
 zmanref(zshexpn)\
 )\


-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

