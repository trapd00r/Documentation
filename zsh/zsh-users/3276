From zsh-users-return-3276-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jul 13 00:59:39 2000
Return-Path: <zsh-users-return-3276-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19471 invoked from network); 13 Jul 2000 00:59:37 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Jul 2000 00:59:37 -0000
Received: (qmail 804 invoked by alias); 13 Jul 2000 00:59:22 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3276
Received: (qmail 796 invoked from network); 13 Jul 2000 00:59:20 -0000
From: Scott Smedley <scottie@yoyo.cc.monash.edu.au>
Message-Id: <200007130107.LAA449963@yoyo.cc.monash.edu.au>
Subject: esc seq in prompt
To: zsh-users@sunsite.auc.dk
Date: Thu, 13 Jul 100 11:07:36 +1000 (EST)
X-Mailer: ELM [version 2.4 PL24 ME8b]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Hi,                                                                             
                                                                                
I'm having a small trouble with the command-line completion                     
system when I have escape sequences in my PROMPT environment variable.          
                                                                                
Basically, the cursor jumps to the right of screen (spaces are                  
inserted?) & confuses the hell out of mE when I hit TAB in a                    
directory & get multiple matches.                                               
                                                                                
Below is a copy of the *entire* .zshrc file I'm using to try &                  
debug this. I'd love some help or a pointer to get around this.                 
                                                                                
burns>> echo $ZSH_VERSION                                                       
3.1.9-dev-1                                                                     
burns>> uname -a                                                                
Linux burns 2.2.12-20 #1 Mon Sep 27 10:40:35 EDT 1999 i686 unknown              
                                                                                
=== cut: .zshrc ===                                                             
                                                                                
setPrompt ()                                                                    
{                                                                               
        rv=$?                                                                   
        local red green white errno color1 color2                               
        red=`print -nP '\e[\033[31;;1m'`                                        
        green=`print -nP '\e[\033[32;;1m'`                                      
        white=`print -nP '\e[\033[37;;1m'`                                      
        errno=""                                                                
        if [ $rv = 0 ] ; then                                                   
                color1=$green                                                   
                color2=$green                                                   
        else                                                                    
                color2=$red                                                     
                if [ $rv = 1 ] ; then                                           
                        color1=$green                                           
                else                                                            
                        color1=$red                                             
                        if [ $rv != 2 ] ; then                                  
                                errno="($rv)"                                   
                        fi                                                      
                fi
        fi                                                                      
        export PROMPT=$green$MACHINE$color1$errno">"$color2"> "$white           
}                                                                               
                                                                                
export MACHINE=`uname -n`                                                       
                                                                                
precmd ()                                                                       
{                                                                               
        setPrompt                                                               
}                                                                               
                                                                                
=== end: .zshrc ===                                                             
                                                                                
SCoTT! :)                                                                       
--------------------                                                            
scott@mobinfo.com.au

