From zsh-workers-return-5461-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Feb 22 09:16:41 1999
Return-Path: <zsh-workers-return-5461-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14330 invoked from network); 22 Feb 1999 09:16:40 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Feb 1999 09:16:40 -0000
Received: (qmail 22945 invoked by alias); 22 Feb 1999 09:16:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5461
Received: (qmail 22932 invoked from network); 22 Feb 1999 09:16:17 -0000
Message-Id: <9902220859.AA45996@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk
Subject: Re: Let's finish this new completion stuff 
In-Reply-To: ""Matt Armstrong""'s message of "Sat, 20 Feb 1999 19:59:45 NFT."
             <19990221035945.27944.qmail@hotmail.com> 
Date: Mon, 22 Feb 1999 09:59:49 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>

"Matt Armstrong" wrote:
> The thing that'd help me understand most is an easy way to see a 
> function call trace when __complete_expand-or-complete and friends get 
> called.  Is something like that possible?

You can use set -x (aka setopt xtrace), that's the main reason I've
enhanced it to trace conditions, function calls and arithmetic evaluations.
I've been using it a lot myself.  There are two problems: it messes up the
display, so it's hard to see what's happening, though if you're just
listing a completion it's not so bad since all the trace information is
above and you can still read the list.  You may be able to `exec
2>xtrace.log' since the tty is maintained separately (if it doesn't work,
it's probably a bug).  Note you can change PROMPT4, which escaped me until
the weekend.

Secondly (if it's a problem) set -x is different from ksh in that ksh turns
it off inside a function where it's not explicitly set, which zsh doesn't,
so you maybe get more info than you want.  (Does anybody think this should
be altered?  I think it's trivial to do that.  `emulate zsh' doesn't change
xtrace, but `emulate -R zsh' does, but even so you get everything up to and
including the emulate statement.)  `setopt localoptions [no]xtrace' does
work, of course.

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

