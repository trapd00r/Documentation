From zsh-users-return-3564-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Dec 13 06:22:51 2000
Return-Path: <zsh-users-return-3564-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19629 invoked from network); 13 Dec 2000 06:22:50 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Dec 2000 06:22:50 -0000
Received: (qmail 29266 invoked by alias); 13 Dec 2000 06:22:38 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3564
Received: (qmail 29255 invoked from network); 13 Dec 2000 06:22:37 -0000
Date: Wed, 13 Dec 2000 00:22:30 -0600
From: Dan Nelson <dnelson@emsphone.com>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: zsh-users@sunsite.auc.dk
Subject: Re: Bindkey + PageUp/PageDown keys
Message-ID: <20001213002230.A16743@dan.emsphone.com>
References: <Pine.LNX.4.21.0012111309170.2380-100000@ihp-pc7.ethz.ch> <slrn93b0c7.e8m.mason@coral.primenet.com.au> <1001213050341.ZM11148@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.3.12i
In-Reply-To: <1001213050341.ZM11148@candle.brasslantern.com>; from "Bart Schaefer" on Wed Dec 13 05:03:41 GMT 2000
X-OS: FreeBSD 5.0-CURRENT

In the last episode (Dec 13), Bart Schaefer said:
> On Dec 12,  1:38am, Geoff Wing wrote:
> } Subject: Re: Bindkey + PageUp/PageDown keys
> }
> } Oliver Grimm <grimm@particle.phys.ethz.ch> typed:
> } :In xterm, they are called 'Prior', 'Next', etc. but how do I use
> } :this with bindkey ?
> } 
> } Your terminal emulator (xterm) will translate the Prior (PageUp)
> } and Next (PageDown) keys into a character sequence - usually an
> } escape sequence (i.e. the first character in the sequence is an
> } escape character).
> 
> I realize that naming the file after $TERM is not quite accurate
> because e.g. one can use an xterm with with just about any kind of
> keyboard.  On the other hand, the same keyboard can generate
> different sequences in different terminal emulators.  If someone has
> a better idea for the file naming convention, I'd be happy to hear
> it.

It should be perfectly accurate, since TERM specifies not only output
escape sequences but input sequences as well; that's what all the
capabilities starting with k are.  If you have two terminal emulators
that send different ESC sequences for different keys, they should have
different TERM types (or you should submit a bug report to the author
of the one that's sending incorrect codes).

I use the following function in /etc/zshrc.  It's a wrapper around
bindkey that takes an extra argument - the termcap code to bind an
action to.  $2 is only used if there is no entry for that code.  I've
had this in my zshrc for so long I honestly have no idea what zsh's
default settings are for the keys I replace :)

# usage: bindtc <cap> <fallback> <zsh-command>
bindtc () 
{
	local keyval=$(echotc "$1" 2>&-)
	bindkey "${keyval:-$2}" "$3"
}

# Let backtab cycle through completions in reverse
bindtc bt "^[[Z" reverse-menu-complete

# Bindings for PGUP, PGDN, HOME, END
bindtc kP "^[[I" history-beginning-search-backward
bindtc kN "^[[G" history-beginning-search-forward
bindtc kh "^[[H" beginning-of-line
bindtc kH "^[[F" end-of-line

# Bindings for UP, DOWN, LEFT, RIGHT
bindtc ku "^[[A" up-line-or-history
bindtc kd "^[[B" down-line-or-history
bindtc kr "^[[C" forward-char
bindtc kl "^[[D" backward-char

-- 
	Dan Nelson
	dnelson@emsphone.com

