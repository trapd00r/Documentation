From zsh-users-return-14662-mason-zsh=primenet.com.au@zsh.org Fri Dec 18 12:07:25 2009
Return-Path: <zsh-users-return-14662-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5137 invoked by alias); 18 Dec 2009 12:07:25 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14662
Received: (qmail 5041 invoked from network); 18 Dec 2009 12:07:24 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00,SPF_HELO_PASS
	autolearn=ham version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at m.gmane.org designates 80.91.229.12 as permitted sender)
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-users@zsh.org
From:  Yuri D'Elia <wavexx@users.sf.net>
Subject:  Re: Force file completion when hitting TAB twice
Date:  Fri, 18 Dec 2009 13:06:52 +0100
Lines: 42
Message-ID:  <20091218130652.01236a7f@abz8111lx.eurac.edu>
References:  <20091217175808.2e860888@abz8111lx.eurac.edu>
	<20091218104616.49dafffa@news01>
	<200912181121.nBIBLIf9005083@news01.csr.com>
Mime-Version:  1.0
Content-Type:  text/plain; charset=US-ASCII
Content-Transfer-Encoding:  7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: eurac.edu
X-Newsreader: Claws Mail 3.7.3 (GTK+ 2.18.5; x86_64-pc-linux-gnu)
Sender: news <news@ger.gmane.org>

On Fri, 18 Dec 2009 11:21:18 +0000
Peter Stephenson <pws@csr.com> wrote:

> Peter Stephenson wrote:
> > zstyle ':completion:*' completer _complete _complete-failed
>                                                       ^
> Sorry, obvious typo here:  that should be an underscore.  Tried the
> following explicitly to make sure it did what I expected:
> 
> 
> _complete_failed() {
>   # Only complete if first attempt at completion failed.
>   # Usage:
>   #   zstyle ':completion:*' completer _complete _complete-failed
>   #   zstyle ':completion:complete-failed:*' completer
> <your-completers>
> 
>   if [[ $LASTWIDGET = *complete* && -z $_complete_failed_active ]];
> then local _complete_failed_active=1
>     local -a completers
>     local curcontext="complete-failed:::"
>     _main_complete "${completers[@]}"
>   fi
> }
> zstyle ':completion:*' completer _complete _complete_failed
> zstyle ':completion:complete-failed:*' completer _files

Very nice! But I still cannot complete with _files in some contextes.

Just to let you understand: sometimes some completion widgets try to be
smart and don't allow to complete all files. Mostly, these are bugs
in the completion widget. I try to track down the problem usually, but
it happened to me too many times in the past. I don't always have
the time, I simply want to 'get on' and debug later.

The 'git' completion is such and example of recurring headache.

git status [TAB TAB] still doesn't offer me a list of files with this
code (others, like ssh, do).

Ideas?


