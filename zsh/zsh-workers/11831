From zsh-workers-return-11831-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Jun 09 07:26:09 2000
Return-Path: <zsh-workers-return-11831-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4398 invoked from network); 9 Jun 2000 07:26:07 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 Jun 2000 07:26:07 -0000
Received: (qmail 12430 invoked by alias); 9 Jun 2000 07:25:59 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11831
Received: (qmail 12423 invoked from network); 9 Jun 2000 07:25:57 -0000
Date: Fri, 9 Jun 2000 09:25:51 +0200 (MET DST)
Message-Id: <200006090725.JAA22138@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Felix Rosencrantz's message of Thu, 8 Jun 2000 22:42:12 -0700
	(PDT)
Subject: Re: Interrupt causing problems for subsequent completions


Felix Rosencrantz wrote:

> >> Also, on a side note, I think there might be a bug in compadd (possibly
> >> matching) that causes it to get in a bad state if an interrupt is sent while
> it
> >> is working.  I typically want to interrupt in situations when completion is
> >> slow.  Completion works, but matching seems to have some problems.  (I know,
> >> you probably want some those helpful details...)
> >
> >Indeed, I do.
> 
> Thought so...  Sigh, don't have much in the way of details yet.  I did notice
> that the signal was being caught by a stack trace that ends like:
>       
>             strlen         
>             modify         [subst.c:2001]
>             paramsubst     [subst.c:1538]
>             stringsubst    [subst.c:121]
>             prefork        [subst.c:70]
>             execcmd        [exec.c:1715]
> 
> So it looks like compadd is not being interrupted.  But maybe the completion
> widget state is somehow messed up.
> 
> I have directory /drive2/tools that I attempt to type as "cd /d2/to<TAB>" that
> completes properly ( my matching spec has  "r:[^0-9]||[0-9]=**"). But after
> interrupting a completion widget, normal completion fails, and it attempts to
> do correction, and doesn't expand properly.

Yes, sounds more like some of the shell-code state not being reset
properly, I'll have a look (it may well be that this is a pure
shell-code problem, we don't catch SIGINT in there either).

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

