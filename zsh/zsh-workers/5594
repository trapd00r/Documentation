From zsh-workers-return-5594-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Mar 01 18:20:38 1999
Return-Path: <zsh-workers-return-5594-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1628 invoked from network); 1 Mar 1999 18:20:37 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Mar 1999 18:20:37 -0000
Received: (qmail 6199 invoked by alias); 1 Mar 1999 18:20:02 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5594
Received: (qmail 6187 invoked from network); 1 Mar 1999 18:19:59 -0000
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: <zsh-workers@sunsite.auc.dk>
Subject: RE: Something wrong with dependencies (RE: PATCH: Re: Don't understand compadd -p (or -P) any more)
Date: Mon, 1 Mar 1999 21:19:21 +0300
Message-ID: <007801be6410$06e221d0$21c9ca95@mowp.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2013.2901

I think, I guess why it happens. I did ``gmake; gmake distclean; gmake'' and
then applied patch. Unfortunately, the second make never makes any modules
(including zle).

Here is what is generated for distclean (and mostlyclean, realclean)
targets.

Src/Makefile:

Makemod modules.index prep: modules-bltin $(CONFIG_INCS)
	                      ^^^^^^^^^^^^^

distclean:   distclean-recursive   distclean-here
distclean-here: clean-here
clean-here: mostlyclean-here
mostlyclean-here:
        rm -f stamp-modobjs stamp-modobjs.tmp
clean-here:
	rm -f modules.index.tmp modules.stamp zsh ansi2knr.o ansi2knr
	rm -f libzsh-*.$(DL_EXT)
distclean-here:
	rm -f TAGS tags
	rm -f modules.index modules-bltin Makefile
distclean: distclean-modules
mostlyclean-modules clean-modules distclean-modules realclean-modules:
Makemod
        @$(MAKE) -f Makemod $(MAKEDEFS) `echo $@ | sed 's/-modules//'`

So, make first removes (among others) modules-bltin, _then_ excutes
distclean-modules, that depends on Makemod that depends on modules-bltin ...
that reruns our nice scripts and leaves some files around (because they
already are deleted from make's point of view :-). And for some reason, all
modules are omitted when these scripts are run, and obviously some files are
never recreated after that because they are already up to date.

That means, that after ``make distclean'' you better remove the whole tree
and start over again. But I just applied all post-pws-10 patches ...

What a mess really


> -----Original Message-----
> From: Andrej Borsenkow
> Sent: Monday, March 01, 1999 8:19 PM
> To: Sven Wischnowsky; zsh-workers@sunsite.auc.dk
> Subject: RE: Something wrong with dependencies (RE: PATCH: Re: Don't
> understand compadd -p (or -P) any more)
>
>
> I forgot to mention, it was with --enable-dynamic
>
> > I just finished with build when this arrived :-) I applied the
> > patch, did make - and Src/Zle/zle_tricky.c was not recompiled.
> >
> > /andrej

