From zsh-workers-return-6061-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Apr 20 13:01:21 1999
Return-Path: <zsh-workers-return-6061-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3279 invoked from network); 20 Apr 1999 13:01:19 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 20 Apr 1999 13:01:19 -0000
Received: (qmail 3565 invoked by alias); 20 Apr 1999 13:00:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6061
Received: (qmail 3538 invoked from network); 20 Apr 1999 13:00:55 -0000
Message-Id: <9904201236.AA44743@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk
Subject: Re: compstate[old_list] 
In-Reply-To: "Sven Wischnowsky"'s message of "Mon, 19 Apr 1999 12:00:37 DFT."
             <199904191000.MAA19181@beta.informatik.hu-berlin.de> 
Date: Tue, 20 Apr 1999 14:36:31 +0200
From: Peter Stephenson <pws@ibmth.df.unipi.it>

Sven Wischnowsky wrote:
> Peter Stephenson wrote:
> 
> > But when I start a non-contextual completion, and the list is displayed by
> > autolist, and I then type ^D, this doesn't work --- it seems
> > $compstate[old_list] is not set.  Is this just me?
> 
> This was caused in zle_main.c, which I obviously forgot to change.

I didn't notice to begin with, but this seems to have the opposite effect.
If I do a non-contextual completion, every completion-based command
following it always acts as if it were using the old list, and
_main_complete never gets called at all (I checked that the widget I first
used wasn't being called again, either).  This even happens to the extent
that calling a different ad-hoc completion when menucompletion is active
still simply cycles through the existing list.  The default should
presumably be to call the appropriate widget and allow the shell code to
decide whether to re-use the old list (though it's quite convenient that
TAB will now cycle through the ad-hoc completion list, which might be
harder to do in the shell code where it belongs).

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

