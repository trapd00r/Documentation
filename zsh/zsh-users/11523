From zsh-users-return-11523-mason-zsh=primenet.com.au@sunsite.dk Tue May 29 19:01:07 2007
Return-Path: <zsh-users-return-11523-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5865 invoked from network); 29 May 2007 19:01:05 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.0 (2007-05-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=no
	version=3.2.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 May 2007 19:01:05 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 92057 invoked from network); 29 May 2007 19:00:56 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 May 2007 19:00:56 -0000
Received: (qmail 21182 invoked by alias); 29 May 2007 19:00:49 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11523
Received: (qmail 21172 invoked from network); 29 May 2007 19:00:48 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 29 May 2007 19:00:48 -0000
Received: (qmail 90805 invoked from network); 29 May 2007 19:00:48 -0000
Received: from sol.nlnetlabs.nl (213.154.224.43)
  by a.mx.sunsite.dk with SMTP; 29 May 2007 19:00:45 -0000
Received: from elektron.atoom.net (a80-127-17-126.adsl.xs4all.nl [80.127.17.126])
	by sol.nlnetlabs.nl (Postfix) with ESMTP id 3FFA5188640
	for <zsh-users@sunsite.dk>; Tue, 29 May 2007 21:00:44 +0200 (CEST)
Received: by elektron.atoom.net (Postfix, from userid 1000)
	id 3236030002DE; Tue, 29 May 2007 21:00:44 +0200 (CEST)
Date: Tue, 29 May 2007 21:00:44 +0200
From: Miek Gieben <miek@miek.nl>
To: zsh users <zsh-users@sunsite.dk>
Subject: zsh crash with PS1
Message-ID: <20070529190044.GA11313@miek.nl>
Mail-Followup-To: zsh users <zsh-users@sunsite.dk>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="qDbXVdCdHGoSgWSk"
Content-Disposition: inline
User-Agent: Vim/Mutt/Linux
X-Home: www.miek.nl


--qDbXVdCdHGoSgWSk
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hello,

I'm was playing around with my prompt, and doing I got zsh to crash.
My PS1 is set to: (sorry for the long lines)

$'[%{\e[$C;34m%}$T%{\e[0m%}|%{\e[$C;34m%}%(1j.%j%{\e[0m%}|.%{\e[0m%})%l|%h>=
 %M %{\e[$C;32m%}%~%{\e[0m%}]\n%{\e[$C;32m%}%#%{\e[0m%} '

If I change the ' to ", like so:
$"[%{\e[$C;34m%}$T%{\e[0m%}|%{\e[$C;34m%}%(1j.%j%{\e[0m%}|.%{\e[0m%})%l|%h>=
 %M %{\e[$C;32m%}%~%{\e[0m%}]\n%{\e[$C;32m%}%#%{\e[0m%} "

I get the following:
zsh: parse error                                                           =
                        =20
$[\e[0;34m20:55\e[0m|\e[0;34m\e[0mpts/2|1> elektron \e[0;32m~\e[0m]\n\e[0;3=
2m%\e[0m  =20

I'm also using RPS and friends but I don't think that is relevant to the cr=
ash.

If I now press enter, zsh crashes (and makes my terminal disappear.

This is with:
zsh 4.3.2 (x86_64-unknown-linux-gnu)
on amd64 (Ubuntun feisty)


--
grtz,
  - Miek

  http://www.miek.nl
  PGP: 6A3C F450 6D4E 7C6B C23C  F982 258B 85CF 3880 D0F6

--qDbXVdCdHGoSgWSk
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFGXHhcJYuFzziA0PYRAnFJAKDoJ61ppWnIwUK1JqUO+Q95ZUUt7gCggQn8
cBuIRrGvEgvHPBXT7kKNCn8=
=Pn9O
-----END PGP SIGNATURE-----

--qDbXVdCdHGoSgWSk--

