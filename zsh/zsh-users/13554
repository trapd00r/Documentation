From zsh-users-return-13554-mason-zsh=primenet.com.au@sunsite.dk Tue Dec 09 15:58:34 2008
Return-Path: <zsh-users-return-13554-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25107 invoked from network); 9 Dec 2008 15:58:21 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 9 Dec 2008 15:58:21 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 7362 invoked from network); 9 Dec 2008 15:58:07 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 Dec 2008 15:58:07 -0000
Received: (qmail 3825 invoked by alias); 9 Dec 2008 15:57:49 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13554
Received: (qmail 3807 invoked from network); 9 Dec 2008 15:57:48 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 9 Dec 2008 15:57:48 -0000
Received: from mail.o2.co.uk (jabba.london.02.net [82.132.130.169])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 31AD680308BE
	for <zsh-users@sunsite.dk>; Tue,  9 Dec 2008 16:57:45 +0100 (CET)
Received: from sc.homeunix.net (78.105.235.196) by mail.o2.co.uk (8.0.013.3) (authenticated as stephane.chazelas)
        id 492B5B7202C12925; Tue, 9 Dec 2008 16:02:53 +0000
Received: from chazelas by sc.homeunix.net with local (Exim 4.69)
	(envelope-from <stephane_chazelas@yahoo.fr>)
	id 1LA4xw-0002PM-FC; Tue, 09 Dec 2008 15:57:40 +0000
Date: Tue, 9 Dec 2008 15:57:40 +0000
From: Stephane Chazelas <Stephane_Chazelas@yahoo.fr>
To: Peter Stephenson <pws@csr.com>
Cc: zsh-users@sunsite.dk
Subject: Re: Unsetting Array
Message-ID: <20081209155740.GD5462@sc.homeunix.net>
Mail-Followup-To: Peter Stephenson <pws@csr.com>, zsh-users@sunsite.dk
References: <54348.153.98.68.197.1228831457.squirrel@webmail.rocteur.com> <200812091418.mB9EIYrR005933@news01.csr.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <200812091418.mB9EIYrR005933@news01.csr.com>
User-Agent: Mutt/1.5.16 (2007-09-19)
X-Virus-Scanned: ClamAV 0.92.1/8735/Tue Dec  9 09:53:21 2008 on bifrost
X-Virus-Status: Clean

On Tue, Dec 09, 2008 at 02:18:34PM +0000, Peter Stephenson wrote:
> "Jerry Rocteur" wrote:
> > I'm using ZSH_VERION 4.2.6 on Redhat 5 to test some Korn shell scripts.
> > 
> > Note that /usr/bin/ksh is a link to /bin/zsh
> > 
> > I am unsetting an array like this unset variable[$i] and get
> >..
> > What is the correct way to unset an array element.
> 
> You can't strictly *unset* an element to an array.  In zsh, an array is
> always a set of strings that has a particular length.  So what you can
> do is limited to changing the length of the array or setting an element
> of the array to be an empty string.  The latter is probably nearest to
> what you want, but (in places where it makes a difference) the shell
> will always treat the empty element as a string with zero length, not as
> an unset parameter.  The syntax for that is
> 
>   variable[$i]=
[...]

Yes, contrary to ksh, zsh arrays are not sparse arrays but
normal arrays as for instance in C (though indices start at 1,
not 0). You could implement a sparse array with an associative
array.

Another thing to be aware of is that $array in zsh expands to
the non-empty elements of the array.

~$ a[5]=foo
~$ printf '<%s>\n' $a
<foo>
~$ printf '<%s>\n' "$a[@]"
<>
<>
<>
<>
<foo>

a[100000]=

declares an array of 100000 elements, all of them empty.

But you could do:

typeset -A a
a[100000]=

Which would declare an associative array with only one element
of key "100000" (beware 100000 is a string)

"$a[@]" would then expand to the list of values (here only one
empty value) but beware that you cannot guarantee the order in
which the values will be displayed.

-- 
Stéphane

