From zsh-workers-return-16770-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 06 14:44:17 2002
Return-Path: <zsh-workers-return-16770-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22601 invoked from network); 6 Mar 2002 14:44:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 Mar 2002 14:44:17 -0000
Received: (qmail 18093 invoked by alias); 6 Mar 2002 14:44:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16770
Received: (qmail 18082 invoked from network); 6 Mar 2002 14:44:11 -0000
Date: Wed, 6 Mar 2002 14:43:10 +0000
From: Adam Spiers <adam@spiers.net>
To: zsh-workers@sunsite.dk
Subject: Re: zrecompile not verbose enough on failure?
Message-ID: <20020306144310.A21102@corelli.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh-workers@sunsite.dk
References: <20011021214251.A31530@thelonious.new.ox.ac.uk> <1011022015957.ZM15484@candle.brasslantern.com> <15316.806.28762.457890@gargle.gargle.HOWL>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <15316.806.28762.457890@gargle.gargle.HOWL>; from wischnow@informatik.hu-berlin.de on Mon, Oct 22, 2001 at 01:29:42PM +0200
X-URL: http://tigerpig.org/
X-OS: RedHat Linux
Sender: "Adam Spiers,,07775562717,020 88 30 30 35" <adam@corelli.new.ox.ac.uk>

Sven Wischnowsky (wischnow@informatik.hu-berlin.de) wrote:
> Bart Schaefer wrote:
> 
> > On Oct 21,  9:42pm, Adam Spiers wrote:
> > }
> > } Why does zrecompile redirect STDERR to /dev/null when running
> > } zcompile?
> > 
> > Probably to suppress warning-only messages like
> > 
> > 	zcompile: functions will use zsh style autoloading
> > 
> > because zrecompile is intended to run unobtrusively from a .zshrc or the
> > like; but I agree that it would be nice to see more of the *real* failure
> > messages from zcompile.
> 
> Should we make it depend on the -q option?

Yes, that would be nicer than my solution, which was

Index: Functions/Misc/zrecompile
===================================================================
RCS file: /cvsroot/zsh/zsh/Functions/Misc/zrecompile,v
retrieving revision 1.8
diff -u -r1.8 zrecompile
--- Functions/Misc/zrecompile	29 May 2001 17:54:39 -0000	1.8
+++ Functions/Misc/zrecompile	6 Mar 2002 14:40:54 -0000
@@ -129,7 +129,7 @@
 	# old file by renaming it.
 
 	if { [[ ! -f $zwc ]] || mv $zwc ${zwc}.old } &&
-             zcompile $map $tmp $zwc $files 2> /dev/null; then
+             zcompile $map $tmp $zwc $files; then
           [[ -z $quiet ]] && print succeeded
         else
           [[ -z $quiet ]] && print failed


How best to make it depend on -q?  Is it possible to redirect STDERR
to a variable?

