From zsh-users-return-11879-mason-zsh=primenet.com.au@sunsite.dk Tue Sep 25 11:31:01 2007
Return-Path: <zsh-users-return-11879-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13679 invoked from network); 25 Sep 2007 11:30:51 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 25 Sep 2007 11:30:51 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 23193 invoked from network); 25 Sep 2007 11:30:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 25 Sep 2007 11:30:42 -0000
Received: (qmail 4529 invoked by alias); 25 Sep 2007 11:30:36 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11879
Received: (qmail 4514 invoked from network); 25 Sep 2007 11:30:35 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 25 Sep 2007 11:30:35 -0000
Received: (qmail 22221 invoked from network); 25 Sep 2007 11:30:35 -0000
Received: from cluster-d.mailcontrol.com (217.69.20.190)
  by a.mx.sunsite.dk with SMTP; 25 Sep 2007 11:30:32 -0000
Received: from rly25d.srv.mailcontrol.com (localhost.localdomain [127.0.0.1])
	by rly25d.srv.mailcontrol.com (MailControl) with ESMTP id l8PBUUvK020250
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <zsh-users@sunsite.dk>; Tue, 25 Sep 2007 12:30:30 +0100
Received: from submission.mailcontrol.com (submission.mailcontrol.com [86.111.216.190])
	by rly25d.srv.mailcontrol.com (MailControl) id l8PBU6Ct018990
	for zsh-users@sunsite.dk; Tue, 25 Sep 2007 12:30:06 +0100
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly25d-eth0.srv.mailcontrol.com (envelope-sender Peter.Stephenson@csr.com) (MIMEDefang) with ESMTP id l8PBTgQZ015742; Tue, 25 Sep 2007 12:30:06 +0100 (BST)
Received: from news01 ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 25 Sep 2007 12:29:49 +0100
Date: Tue, 25 Sep 2007 12:29:49 +0100
From: Peter Stephenson <pws@csr.com>
To: <zsh-users@sunsite.dk>
Cc: "John Cooper" <john.cooper@eu.citrix.com>
Subject: Re: Variable expansion problem
Message-ID: <20070925122949.3ee04e3f@news01>
In-Reply-To: <DD74FBB8EE28D441903D56487861CD9D1F554D07@lonpexch01.citrite.net>
References: <DD74FBB8EE28D441903D56487861CD9D1F554D01@lonpexch01.citrite.net>
	<200709250901.l8P91LYU017875@news01.csr.com>
	<DD74FBB8EE28D441903D56487861CD9D1F554D07@lonpexch01.citrite.net>
Organization: CSR
X-Mailer: Claws Mail 3.0.0 (GTK+ 2.10.14; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 25 Sep 2007 11:29:49.0756 (UTC) FILETIME=[6232CFC0:01C7FF67]
X-Scanned-By: MailControl A-07-08-10 (www.mailcontrol.com) on 10.68.1.135

On Tue, 25 Sep 2007 12:08:20 +0100
"John Cooper" <john.cooper@eu.citrix.com> wrote:
> Thanks for the reply, although it doesn't seem to be working for me.
> (the space between the 2 args is still quoted.). I suspect I'm doing
> something wrong!

Is <TAB> still bound to expand-or-complete?  (If you don't have _expand in
your completers it probably is.)  In that case, rebind it:

bindkey '\t' complete-word

You might want to add that _expand to your completers to restore expansion
to (almost) how it worked before.

Alternatively, you could bind the new function (defined as a completion
widget) to a different key

> I don't really understand the code, and I'm not sure what you mean by
> "only kicks in if the entire word matches $<paramname>.", as there is no
> <paramname> in the code - did you mean it kicks in when the entire param
> name matches "$IDENT"?

<paramname> just meant any parameter name.

> Btw, what is the "P" referring to in ${(P)+val}? 

That causes $val to be treated as the name of another parameter.

> I think what I really want is to be able to type
>   Prompt> $SITEMGR -c <TAB>
> .. and have it complete to:
>   Prompt> $SITEMGR -c ...

You'd need to define a completion for the expansion of $SITEMGR;
a completion for the basename of the command would be enough.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


.

