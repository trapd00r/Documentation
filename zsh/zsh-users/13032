From zsh-users-return-13032-mason-zsh=primenet.com.au@sunsite.dk Mon Jul 14 20:45:04 2008
Return-Path: <zsh-users-return-13032-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27755 invoked from network); 14 Jul 2008 20:45:02 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Jul 2008 20:45:02 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 34188 invoked from network); 14 Jul 2008 20:44:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Jul 2008 20:44:52 -0000
Received: (qmail 11137 invoked by alias); 14 Jul 2008 20:44:44 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13032
Received: (qmail 11127 invoked from network); 14 Jul 2008 20:44:44 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 14 Jul 2008 20:44:44 -0000
Received: from rv-out-0506.google.com (rv-out-0506.google.com [209.85.198.239])
	by bifrost.dotsrc.org (Postfix) with ESMTP id E2E1080525AB
	for <zsh-users@sunsite.dk>; Mon, 14 Jul 2008 22:44:29 +0200 (CEST)
Received: by rv-out-0506.google.com with SMTP id g37so4419794rvb.21
        for <zsh-users@sunsite.dk>; Mon, 14 Jul 2008 13:44:28 -0700 (PDT)
Received: by 10.140.191.14 with SMTP id o14mr6870997rvf.247.1216068268290;
        Mon, 14 Jul 2008 13:44:28 -0700 (PDT)
Received: by 10.141.48.18 with HTTP; Mon, 14 Jul 2008 13:44:28 -0700 (PDT)
Message-ID: <691a5d910807141344p4ccf0affq235b0925cd54a055@mail.gmail.com>
Date: Mon, 14 Jul 2008 13:44:28 -0700
From: "Bart Schaefer" <schaefer@brasslantern.com>
To: "Zsh users list" <zsh-users@sunsite.dk>
Subject: Re: history-beginning-local function
In-Reply-To: <1186.1216057340@csr.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <1186.1216057340@csr.com>
X-Virus-Scanned: ClamAV 0.92.1/7709/Mon Jul 14 18:16:52 2008 on bifrost
X-Virus-Status: Clean

On Mon, Jul 14, 2008 at 10:42 AM, Peter Stephenson <pws@csr.com> wrote:
> This function allows you to have a local history file [...]
>
> The main problem is that you have to create and update the local history
> file yourself since commands aren't saved to it.

One possibility would be to put something in chpwd that remembers the
history number upon entering a directory and, upon leaving it, appends
the higher-numbered history entries to the local file.

Another approach might be to have chpwd change the global HISTFILE.
Then use inc_append_history so that commands in each directory are
appended as you go.  That leaves just the problem of trapping shell
exit and writing the full history to the original HISTFILE (assuming
that's still desirable).

