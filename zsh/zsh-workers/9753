From zsh-workers-return-9753-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Feb 15 21:55:13 2000
Return-Path: <zsh-workers-return-9753-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25752 invoked from network); 15 Feb 2000 21:55:12 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Feb 2000 21:55:12 -0000
Received: (qmail 14283 invoked by alias); 15 Feb 2000 21:55:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9753
Received: (qmail 14266 invoked from network); 15 Feb 2000 21:55:03 -0000
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Still bugs completing .files; _multi_parts
Date: Tue, 15 Feb 2000 21:58:30 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E12Kpvo-00022q-00.2000-02-15-21-54-52@cmailg1.svr.pol.co.uk>

Firstly, I did

% less ~/.<TAB>

and got a list of files not beginning with a dot amongst those which did.


Secondly and unrelatedly, I was trying out _multi_parts for the user guide
and did (you can see where this is coming from):

_foo () {
  local groups
  groups=(news.announce.newuser
          news.groups.questions
          gnu.emacs.gnus
          comp.unix.shell
          rec.arts.sf.written
          freeserve.test) 
  _multi_parts . groups
}
compdef _foo foo

Hitting ^D, everything was fine: I get the list
  comp.        freeserve.   gnu.         news.        rec.       
as expected.  Now hitting tab, which causes menu completion and menu
selection to start up, things start to go wrong.  First, the list is
expanded to show both `news.', instead of pruning the duplicate.  Second,
the value inserted is the full whack, e.g. `comp.unix.shell'; I can't
simply cycle through the top level and select the next one down.  I'm
puzzled about this because as far as I can see the only existing call to
_multi_parts in _tar works just the same way, except with / as the
separator.  The clue seems to be that if I go straight into completion
without doing ^D things work as expected (except that I don't see a final
`.' if the part isn't the final one, as I would expect to do in the tar
case).

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

