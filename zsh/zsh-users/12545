From zsh-users-return-12545-mason-zsh=primenet.com.au@sunsite.dk Mon Feb 11 15:07:46 2008
Return-Path: <zsh-users-return-12545-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23485 invoked from network); 11 Feb 2008 15:07:44 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Feb 2008 15:07:44 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 28906 invoked from network); 11 Feb 2008 15:07:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Feb 2008 15:07:22 -0000
Received: (qmail 28762 invoked by alias); 11 Feb 2008 15:07:13 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12545
Received: (qmail 28746 invoked from network); 11 Feb 2008 15:07:13 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 11 Feb 2008 15:07:13 -0000
Received: from fg-out-1718.google.com (fg-out-1718.google.com [72.14.220.155])
	by bifrost.dotsrc.org (Postfix) with ESMTP id A98B180482A3
	for <zsh-users@sunsite.dk>; Mon, 11 Feb 2008 16:07:09 +0100 (CET)
Received: by fg-out-1718.google.com with SMTP id 16so4586308fgg.37
        for <zsh-users@sunsite.dk>; Mon, 11 Feb 2008 07:07:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:date:to:subject:message-id:references:mime-version:content-type:content-disposition:in-reply-to:user-agent:from;
        bh=cJyszj4jqVLa0MeS7eNxCYLaGjLcs8QtnCZpQaL46qw=;
        b=eWk20YAZWFVYp+v2P5V2oVUMW//c1bp5FY5Vnc7TboRRvJAyX9EVT3HWJfc/IkOvxCRuQqWcICNqf+BLsBqgPWXhnRn9DH0Nq3a6lB+kJPjovJmoOymO93tLn63kY8LlUSutzapXHekpm66x7wgb46xNq122QpKA09N5fHas9bU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=date:to:subject:message-id:references:mime-version:content-type:content-disposition:in-reply-to:user-agent:from;
        b=Ieeqy5VkJiRNa/TT/ce8dQnd2nM/HOht90oZqPEb8cEmpItjy2ZBPKRR+64I1ZRMhb0hyPbRQZWBpizPtlEGWDsL4qHKu5mWp2mjP1tpOPE38wezPw21yRnRmddekI57b4h1fsvmZ0Q2WFI9fPAUlT1HD6/KUEyMp1Hr2KQKLDg=
Received: by 10.86.25.17 with SMTP id 17mr74304fgy.15.1202742428815;
        Mon, 11 Feb 2008 07:07:08 -0800 (PST)
Received: from localhost ( [83.115.178.198])
        by mx.google.com with ESMTPS id e20sm16923387fga.1.2008.02.11.07.07.07
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 11 Feb 2008 07:07:07 -0800 (PST)
Date: Mon, 11 Feb 2008 16:07:09 +0100
To: zsh-users@sunsite.dk
Subject: Re: Phil's prompt is not working when LANG is set to UTF-8
Message-ID: <20080211150709.GA28841@localhost.localdomain>
References: <20080211033116.GD19613@phoenix.nasreddine.info> <237967ef0802102301i71dcd71erb1a2993a7f0bd643@mail.gmail.com> <20080211092021.GC6965@phoenix.nasreddine.info> <20080211130707.7d45f6af@news01> <20080211133743.GA28384@phoenix.nasreddine.info> <200802111407.m1BE77Lh004330@news01.csr.com>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="uAKRQypu60I7Lcqm"
Content-Disposition: inline
In-Reply-To: <200802111407.m1BE77Lh004330@news01.csr.com>
User-Agent: Mutt/1.5.11
From: antho.charles@gmail.com
X-Virus-Scanned: ClamAV 0.91.2/5773/Mon Feb 11 15:00:38 2008 on bifrost
X-Virus-Status: Clean


--uAKRQypu60I7Lcqm
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hi,

I didn't have this problem on Debian etch, but it appears when I
upgraded to lenny. It's the same problem: if I set LANG to a non utf8
encoding (fr_FR instead of fr_FR.UTF-8), RPROMPT is good, otherwise
it's partially on another line and the cusor is after RPROMPT.
(cf. http://tinyurl.com/3xjeqt)
I "solve" this problem with:

-- 8< -- 8< --
 ###
 # See if we can use extended characters to look nicer.
=20
 if [[ $TERM !=3D linux ]]; then
    typeset -A altchar
    set -A altchar ${(s..)terminfo[acsc]}
    PR_SET_CHARSET=3D"%{$terminfo[enacs]%}"
    PR_SHIFT_IN=3D"%{$terminfo[smacs]%}"
    PR_SHIFT_OUT=3D"%{$terminfo[rmacs]%}"
    PR_HBAR=3D${altchar[q]:--}
    PR_ULCORNER=3D${altchar[l]:--}
    PR_LLCORNER=3D${altchar[m]:--}
    PR_LRCORNER=3D${altchar[j]:--}
    PR_URCORNER=3D${altchar[k]:--}
fi
-- 8< -- 8< --

I don't define those variables if I'm in a console, then the prompt
looks good but without the fancy stuff, so it's not the real answer.
(cf. http://tinyurl.com/2bjl6x)
And my consoles are already in unicode mode.

--=20
Anthony CHARLES

--uAKRQypu60I7Lcqm
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (GNU/Linux)

iD8DBQFHsGSdh+bM1BRydIMRAp7CAKDOlT/8qVOd+iq/gJyYnrZkBudJqgCfVTG4
SJwvnukyCxyvDSx+TZpvjso=
=4zel
-----END PGP SIGNATURE-----

--uAKRQypu60I7Lcqm--

