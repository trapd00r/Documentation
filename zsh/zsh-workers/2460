From zsh-workers-request@euclid.skiles.gatech.edu  Sun Nov 24 02:50:46 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.6/8.7.3) with ESMTP id CAA20448 for <mason@primenet.com.au>; Sun, 24 Nov 1996 02:50:42 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id KAA20812; Sat, 23 Nov 1996 10:45:09 -0500 (EST)
Resent-Date: Sat, 23 Nov 1996 10:45:09 -0500 (EST)
From: Zefram <zefram@dcs.warwick.ac.uk>
Message-Id: <14808.199611231545@stone.dcs.warwick.ac.uk>
Subject: modules documentation
To: zsh-workers@math.gatech.edu (Z Shell workers mailing list)
Date: Sat, 23 Nov 1996 15:45:42 +0000 (GMT)
X-Patch: 131
X-Loop: zefram@dcs.warwick.ac.uk
X-Stardate: [-31]8468.28
X-US-Congress: Moronic fuckers
Content-Type: text
Resent-Message-ID: <"tq-a13.0.655.4mnbo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2460
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

This patch documents the zmodload builtin and the module_path parameter.
I documented the state of module loading as it is after recent patches
from me are applied, so this will need changes if one or more of my
patches don't get into the baseline.

More importantly, it adds infrastructure in Doc/Makefile.in to support
conditional inclusion in the man pages.  All the added documentation
only appears if zsh is configured for dynamic module loading.

 -zefram

      Index: Doc/Makefile.in
      ===================================================================
      RCS file: /home/zefram/usr/cvsroot/zsh/Doc/Makefile.in,v
      retrieving revision 1.1.1.15
      diff -c -r1.1.1.15 Makefile.in
      *** Makefile.in	1996/11/21 00:03:37	1.1.1.15
      --- Makefile.in	1996/11/23 01:10:52
      ***************
      *** 42,47 ****
      --- 42,49 ----
        VPATH      = @srcdir@
        
        prefix      = @prefix@
      + exec_prefix = @exec_prefix@
      + libdir      = @libdir@
        infodir     = @infodir@
        mandir      = @mandir@
        zshenv      = @zshenv@
      ***************
      *** 54,59 ****
      --- 56,63 ----
        INSTALL      = @INSTALL@
        INSTALL_DATA = @INSTALL_DATA@
        
      + DL_EXT = @DL_EXT@
      + 
        SED = sed
        
        .SUFFIXES:
      ***************
      *** 61,72 ****
      --- 65,81 ----
        
        # we just copy the man page to its new name
        # unless there is a rule below to edit it.
      + MODRULE = -e 's/^%IFDYN%//' -e '/^%IFNDYN%/d'
      + MONRULE = -e '/^%IFDYN%/d' -e 's/^%IFNDYN%//'
        .man.$(manext):
        	sed -e 's,%zshenv%,$(zshenv),g' \
        	    -e 's,%zshrc%,$(zshrc),g' \
        	    -e 's,%zprofile%,$(zprofile),g' \
        	    -e 's,%zlogin%,$(zlogin),g' \
        	    -e 's,%zlogout%,$(zlogout),g' \
      + 	    -e 's,%libdir%,$(libdir),g' \
      + 	    -e 's,%dl_ext%,$(DL_EXT),g' \
      + 	    $(MO@D@RULE) \
        	    -e 's,%mandir%,man$(manext),g' \
        	    -e 's,%manext%,$(manext),g' $< > $@
        
      Index: Doc/zshbuiltins.man
      ===================================================================
      RCS file: /home/zefram/usr/cvsroot/zsh/Doc/zshbuiltins.man,v
      retrieving revision 1.12
      diff -c -r1.12 zshbuiltins.man
      *** zshbuiltins.man	1996/11/21 00:42:18	1.12
      --- zshbuiltins.man	1996/11/23 01:16:37
      ***************
      *** 1198,1201 ****
      --- 1198,1232 ----
        .TP
        \fBwhich\fP [ \-\fBpam\fP ] \fIname\fP ...
        Same as \fBwhence \-c\fP.
      + %IFDYN%.TP
      + %IFDYN%\fBzmodload \fP[\fB-u\fP] \fIname
      + %IFDYN%Load (or, with
      + %IFDYN%.BR -u ,
      + %IFDYN%unload) a binary module.
      + %IFDYN%When loading a module, the module must be in a file named either
      + %IFDYN%.IB name .%dl_ext%
      + %IFDYN%or
      + %IFDYN%.IR name .
      + %IFDYN%.RS
      + %IFDYN%.PP
      + %IFDYN%The
      + %IFDYN%.IR name d
      + %IFDYN%module is searched for in the same way a command is, using
      + %IFDYN%.B $module_path
      + %IFDYN%instead of
      + %IFDYN%.BR $path .
      + %IFDYN%If
      + %IFDYN%.I name
      + %IFDYN%contains a
      + %IFDYN%.RB ` / ',
      + %IFDYN%it will be used as-is, and a path search will be performed otherwise.
      + %IFDYN%This behaviour can be modified by the
      + %IFDYN%.B PATH_DIRS
      + %IFDYN%option.
      + %IFDYN%.PP
      + %IFDYN%When unloading a module, the same
      + %IFDYN%.I name
      + %IFDYN%must be given that was given when the module was loaded, but it is not
      + %IFDYN%necessary for the module to exist in the filesystem.
      + %IFDYN%.RE
        .RE
      Index: Doc/zshparam.man
      ===================================================================
      RCS file: /home/zefram/usr/cvsroot/zsh/Doc/zshparam.man,v
      retrieving revision 1.12
      diff -c -r1.12 zshparam.man
      *** zshparam.man	1996/08/25 22:45:42	1.12
      --- zshparam.man	1996/11/23 01:00:02
      ***************
      *** 452,457 ****
      --- 452,465 ----
        whose value is not used by the shell.  The \fBmanpath\fP
        array can be useful, however, since setting it also sets
        \fBMANPATH\fP, and vice versa.
      + %IFDYN%.TP
      + %IFDYN%.B module_path (MODULE_PATH)
      + %IFDYN%An array (colon-separated list)
      + %IFDYN%of directories that
      + %IFDYN%.I zmodload
      + %IFDYN%searches for dynamically loadable modules.
      + %IFDYN%This is initialised to
      + %IFDYN%.BR %libdir%/zsh/$ZSH_VERSION .
        .TP
        .B NULLCMD
        The command name to assume if a redirection is specified

-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBMpZUDXD/+HJTpU/hAQG/JgQAjBAdgzGjY5WybalBEpB5f4Tc/K4nzBeU
1dH+dNGdEPF95m5Vjx55ONFnHdN+EZC1KzrlCZ6mefAZVNWd+qB7X/uUnlliJz+D
JZs2ObAbW5gmtVtt9lxBWNU80EtBOuDG9dPzavfaMH+l16ui0edqgovPuCPV6IAl
I23b/G8T8+I=
=q0mc
-----END PGP SIGNATURE-----

