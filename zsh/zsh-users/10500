From zsh-users-return-10500-mason-zsh=primenet.com.au@sunsite.dk Sun Jul 09 13:51:38 2006
Return-Path: <zsh-users-return-10500-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7865 invoked from network); 9 Jul 2006 13:51:36 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.3 (2006-06-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 9 Jul 2006 13:51:36 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 63634 invoked from network); 9 Jul 2006 13:51:28 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 Jul 2006 13:51:28 -0000
Received: (qmail 5466 invoked by alias); 9 Jul 2006 13:51:10 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 10500
Received: (qmail 5457 invoked from network); 9 Jul 2006 13:51:10 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 9 Jul 2006 13:51:10 -0000
Received: (qmail 61933 invoked from network); 9 Jul 2006 13:51:10 -0000
Received: from parhelion.firedrake.org (193.201.200.77)
  by a.mx.sunsite.dk with SMTP; 9 Jul 2006 13:51:09 -0000
Received: from phil by parhelion.firedrake.org with local (Exim 4.50 #1 (Debian))
	id 1FzZgh-00010j-TJ
	for <zsh-users@sunsite.dk>; Sun, 09 Jul 2006 14:51:07 +0100
Date: Sun, 9 Jul 2006 15:51:07 +0200
From: Phil Pennock <phil.pennock@globnix.org>
To: zsh-users@sunsite.dk
Subject: Tab-completion inside dir named with braces (brace_ccl)
Message-ID: <20060709135107.GA2753@parhelion.globnix.org>
Mail-Followup-To: zsh-users@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Sender: Phil Pennock <phil@firedrake.org>

Hi,

The zsh options brace_ccl doesn't appear to play nicely with expansion
under the new completion system.  Zsh 4.3.2.

 zsh -f
 setopt brace_ccl
 autoload -Uz compinit
 compinit -u
 zstyle ':completion:*' completer _expand _complete 

Mozilla Firefox puts extensions inside sub-directories of
~/.mozilla/firefox/<random>.<profname>/extensions/ and many of those
directories are named "{"<UUID>"}".

If I try to tab-complete the directory name, that succeeds, using the
appropriate backslash escaping.  But if I try to tab-complete a name
such as "install.rdf" inside that, then the backslashes are escaped
again and the braces are treated to brace expansion.  If I use '{1A
instead of \{1A then the brace expansion still happens.

So given '{1A2D0EC4-75F5-4c91-89C4-3656F6E44B68}' and tab-completing
twice, I can see either:
% vi \\-/i \\0/i \\1/i \\2/i \\3/i \\4/i \\5/i \\6/i \\7/i \\8/i \\9/i \\A/i \\B/i \\C/i \\D/i \\E/i \\F/i \\/i \\c/i 
% vi '-/i 0/i 1/i 2/i 3/i 4/i 5/i 6/i 7/i 8/i 9/i A/i B/i C/i D/i E/i F/i c/i 

I know, I'm explicitly putting expansion first (and I don't remember
why) but I think that zsh probably shouldn't be ignoring its own
escaping.

Is this a bug or expected behaviour?

Thanks,
-- 
VISTA: Viruses, Infections, Spyware, Trojans & Adware

