From zsh-workers-return-25739-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 24 08:58:24 2008
Return-Path: <zsh-workers-return-25739-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10493 invoked from network); 24 Sep 2008 08:58:22 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 24 Sep 2008 08:58:22 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 21707 invoked from network); 24 Sep 2008 08:58:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 24 Sep 2008 08:58:17 -0000
Received: (qmail 23790 invoked by alias); 24 Sep 2008 08:58:13 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25739
Received: (qmail 23776 invoked from network); 24 Sep 2008 08:58:12 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 24 Sep 2008 08:58:12 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [217.69.20.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 70C6080307AB
	for <zsh-workers@sunsite.dk>; Wed, 24 Sep 2008 10:58:09 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly47d.srv.mailcontrol.com (MailControl) with ESMTP id m8O8w8qi027509
	for <zsh-workers@sunsite.dk>; Wed, 24 Sep 2008 09:58:09 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 24 Sep 2008 09:58:08 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id m8O8w3Fq013383
	for <zsh-workers@sunsite.dk>; Wed, 24 Sep 2008 09:58:03 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id m8O8w3Yf013379
	for <zsh-workers@sunsite.dk>; Wed, 24 Sep 2008 09:58:03 +0100
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: PATCH: warn if libgdbm linked
X-Mailer: MH-E 8.0.3; nmh 1.3; GNU Emacs 22.1.1
Date: Wed, 24 Sep 2008 09:58:03 +0100
Message-ID: <13378.1222246683@csr.com>
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 24 Sep 2008 08:58:08.0512 (UTC) FILETIME=[AA35F000:01C91E23]
X-Scanned-By: MailControl A-08-50-15 (www.mailcontrol.com) on 10.68.0.157
X-Virus-Scanned: ClamAV 0.92.1/8323/Wed Sep 24 09:57:37 2008 on bifrost
X-Virus-Status: Clean

This is following a discussion off-list.  Linking against libgdbm in the
binary means it's covered by the GNU General Public License (even if the
binary only contains bindings to the shared library and not the code,
apparently), so it might be safer to warn that this has happened.  As
we're not using any GNU code in the source, it's not affected.

Index: configure.ac
===================================================================
RCS file: /cvsroot/zsh/zsh/configure.ac,v
retrieving revision 1.107
diff -u -r1.107 configure.ac
--- configure.ac	4 Aug 2008 17:44:35 -0000	1.107
+++ configure.ac	24 Sep 2008 08:52:03 -0000
@@ -2934,4 +2934,10 @@
 echo "See config.modules for installed modules and functions.
 "
 
-
+case x$LIBS in
+  (*-lgdbm*)
+  echo "WARNING: zsh has been linked against libgdbm.
+This means the binary is covered by the GNU General Public License.
+This does not affect the source code."
+  ;;
+esac


-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

