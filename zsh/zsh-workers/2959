From zsh-workers-request@euclid.skiles.gatech.edu Thu Mar 06 01:00:44 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 7522 invoked from network); 6 Mar 1997 01:00:42 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 6 Mar 1997 01:00:42 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id TAA07781; Wed, 5 Mar 1997 19:43:48 -0500 (EST)
Resent-Date: Wed, 5 Mar 1997 19:43:48 -0500 (EST)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <970305165110.ZM7569@candle.brasslantern.com>
Date: Wed, 5 Mar 1997 16:51:10 -0800
In-Reply-To: <hzoli@VNET.IBM.COM> (Zoltan T. Hidvegi)
        "Re: zle_refresh patch 2" (Mar  5,  6:47pm)
References: <9703052347.AA20952@lotto.fishkill.ibm.com>
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: <hzoli@VNET.IBM.COM> (Zoltan T. Hidvegi)
Subject: Re: zle_refresh patch 2
Cc: zsh-workers@math.gatech.edu (Zsh workers list)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"wDBvb2.0.Wv1.4DX7p"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2959
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Status: O

On Mar 5,  6:47pm,  (Zoltan T. Hidvegi) wrote:
} Subject: Re: zle_refresh patch 2
}
} Fine, but there are two problems: shortterm is a zle variable and in 3.1
} utils.c has no access to zle globals.

It's only mentioned in a DPUTS anyway; just scrap the DPUTS in 3.1 (as
you did).  Geoff's original patch did more with it than that.

} The other problem is that
} resetneeded local variable has the same name as a global one, which is
} misleading.  Also a comparision should use >= 3 instead on > 3.  I simply
} removed the resetneeded variable, since it was really unnecessary.

Hmm.  Well, I dislike your change because it presumes that init_term()
is independent of the values of "lines" and "columns".  This in itself
(init_term() not knowing about lines/columns) MAY be wrong, now that I
look at it, because init_term() is called from zle in a couple places,
namely putprompt() and zleread().

Will zle ever call init_term in such a way that a very-small terminal is
set incorrectly?  I don't follow it well enough to be sure.

-- 
Bart Schaefer                             Brass Lantern Enterprises
http://www.well.com/user/barts            http://www.nbn.com/people/lantern

