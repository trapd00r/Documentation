From zsh-workers-return-5518-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Feb 25 10:41:12 1999
Return-Path: <zsh-workers-return-5518-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1257 invoked from network); 25 Feb 1999 10:41:10 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Feb 1999 10:41:10 -0000
Received: (qmail 23947 invoked by alias); 25 Feb 1999 10:36:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5518
Received: (qmail 15625 invoked from network); 25 Feb 1999 09:45:06 -0000
Message-Id: <9902250925.AA18049@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk
Subject: Re: strange limit output for pws-9 
In-Reply-To: "Helmut Jarausch"'s message of "Thu, 25 Feb 1999 09:25:55 NFT."
             <jarausch-990225092544.A01191272@numa1.igpm.rwth-aachen.de> 
Date: Thu, 25 Feb 1999 10:25:49 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>

Helmut Jarausch wrote:
> Hi,
> 
> recent versions of zsh upto pws-9 plus patches here on my IRIX 6.5.2 box
> show a strange output
> 
> 5 % limit
> ...
> datasize        qdMB
> ...

It thinks rlim_t is a quad length variable, so is trying to print it with
printf("%qd", val), where val has type rlim_t: see showlimits() in
Src/Builtins/rlimits.c .  This implies either

(1) rlim_t really is that long, but the compiler doesn't understand the
format.  The test in configure is for sizeof(rlim_t) > sizeof(long), but it
doesn't test how to print it and maybe we just need to check if the
compiler thinks it's long long and wants "%lld" instead.  Try changing %qd
in that function to %lld, and if that works I'll rig up a configure test to
see which the compiler likes.  (I'm assuming this "%qd" really exists, and
isn't just a figment of someone's overactive imagination --- can anyone
swear to having seen it?)

or 

(2) rlim_t is no longer than long and RLIM_T_IS_QUAD_T is defined by
mistake by configure.  In that case the code around line 745 of
configure.in is responsible and doing something funny.  (This works OK on
Irix 6.2 where it identifies rlim_t as unsigned but not quad.)

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

