From zsh-users-return-8060-mason-zsh=primenet.com.au@sunsite.dk Sat Oct 16 21:41:23 2004
Return-Path: <zsh-users-return-8060-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5685 invoked from network); 16 Oct 2004 21:41:23 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 Oct 2004 21:41:22 -0000
Received: (qmail 94296 invoked from network); 16 Oct 2004 21:41:16 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Oct 2004 21:41:16 -0000
Received: (qmail 4561 invoked by alias); 16 Oct 2004 21:40:29 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8060
Received: (qmail 4548 invoked from network); 16 Oct 2004 21:40:27 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 16 Oct 2004 21:40:27 -0000
Received: (qmail 92483 invoked from network); 16 Oct 2004 21:39:28 -0000
Received: from mail.vc-graz.ac.at (HELO proxy.vc-graz.ac.at) (193.171.121.30)
  by a.mx.sunsite.dk with SMTP; 16 Oct 2004 21:39:28 -0000
Received: from localhost (b-55.vc-graz.ac.at [193.171.241.55])
	by proxy.vc-graz.ac.at (8.12.11/8.12.11) with ESMTP id i9GLdQvQ012299
	for <zsh-users@sunsite.dk>; Sat, 16 Oct 2004 23:39:26 +0200 (MEST)
Date: Sat, 16 Oct 2004 23:39:26 +0200
From: Michael Prokop <news@michael-prokop.at>
To: zsh-users@sunsite.dk
Subject: Change directory on invocation of zsh
Message-ID: <2004-10-16T23-18-26@devnull.michael-prokop.at>
Reply-To: Michael Prokop <zsh@michael-prokop.at>
Mail-Followup-To: zsh-users@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
X-URL: http://www.michael-prokop.at/
X-Operating-System: Debian GNU/Linux - 2.6.8.1 on a i686
X-Registered-Linux-User: 224337
X-Crypto: GnuPG/1.2.3 http://www.gnupg.org
X-GPG-Key-ID: 0x37E272E8
X-GPG-Key: http://www.michael-prokop.at/gpg
X-GPG-Fingerprint: 04AE E62C 9502 CD34 A7DA 857B D8DF 53FB 37E2 72E8
User-Agent: Mutt/1.5.6i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

Hello,

I'm using the latest zsh version of debian unstable (4.2.1).
I'm using rungetty on one of my systems.
My /etc/inittab looks like this:


1:12345:respawn:/bin/zsh --login -c "/usr/bin/grml-start ; /usr/bin/grml-screen" >/dev/tty1 2>&1 </dev/tty1
[...]
5:2345:respawn:/sbin/rungetty tty5 -u grml -g grml --autologin grml /bin/zsh


So I'm able to use autologin without doing login stuff.

My problem: when starting zsh my working directory is '/'.
Not just as user root but also as user 'grml'.

AFAIK the pam_env module is responsible for doing some basic
enviroment handling.  Because I don't use the PAM system I've a
little wrapper in my zsh config:

  ,---- [ /etc/zsh/zshrc ]
  | if [[ -z "$HOME" || "$HOME" == "/" ]] ; then
  |   if [[ `id -un` == "root" ]] ; then
  |      export HOME=/root
  |   else
  |      export HOME=/home/`id -un`
  |   fi
  | fi
  `----

Of course running 'cd' or 'cd $HOME' or 'cd ~' changes into my
homedirectory. But I'd like to change path already on login.
Doing something like '[ $SECONDS == "0" ] && cd $HOME' is a
workaround but changes the working directory to $HOME any time I'm
starting a new zsh. Am I on the wrong way?
Any ideas or any hints? Thanks!

thx && regards,
(-: Michael

