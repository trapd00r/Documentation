From zsh-users-return-14692-mason-zsh=primenet.com.au@zsh.org Sun Dec 27 18:57:32 2009
Return-Path: <zsh-users-return-14692-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6923 invoked by alias); 27 Dec 2009 18:57:31 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14692
Received: (qmail 6396 invoked from network); 27 Dec 2009 18:57:20 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-0.5 required=5.0 tests=AWL,BAYES_00,
	RCVD_NUMERIC_HELO,SPF_HELO_PASS autolearn=no version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at m.gmane.org designates 80.91.229.12 as permitted sender)
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-users@zsh.org
From:  Lloyd Zusman <ljz@asfast.com>
Subject:  Re: Encrypting history?
Date:  Sun, 27 Dec 2009 13:56:50 -0500
Organization:  Take a hippopotamus to lunch today.
Lines: 103
Message-ID:  <m2y6ko6ya5.fsf@asfast.com>
References:  <m2zl55uyzl.fsf@asfast.com>
	<13539.83135.qm@web65610.mail.ac4.yahoo.com>
Mime-Version:  1.0
Content-Type:  text/plain; charset=iso-8859-1
Content-Transfer-Encoding:  8bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 209.59.210.144
User-Agent: Gnus/5.110011 (No Gnus v0.11) Emacs/23.1.50 (darwin)
Cancel-Lock: sha1:xl3QpEJutskKWHxf7y2WIqVYjwU=
Cache-Post-Path: purity-of-essence.net!unknown@nadie.us
X-Cache: nntpcache 3.0.2 (see http://www.nntpcache.com/)
Sender: news <news@ger.gmane.org>

Guido van Steen <gvsteen@yahoo.com> writes:

> Hi Lloyd, 
>
> Interesting idea indeed! You might miss a feature like sharing a history file across sessions. 
>
> You could overcome this by seperately saving all your sessions' increments to your history file, and then incorporating them into the history file when you login again. 
>
> This way the entries of your history file might get out of order, but you could probably handle this by also saving the time when your commands were issued. 
>
> I would also be interested in a zsh extension like that. 
>
> Best wishes, 
>
> Guido 

Thank you for reminding me about sharing history across sessions.

I've never written an extension for zsh, and so the first thing I plan
to do is implement this via code in my .zlogin and .zlogout files. Then,
once I get it working, I'll take the plunge and try to turn it into an
extension.

Concerning this session-specific history issue, is there a way to get a
history list of the commands that were issued only during the current
session? If so, I think I probably could do something like this upon
logout:

* Lock the current history file
* Get the history list for the current session
* Encrypt this history list and append it to the current
  history file
* Unlock the current history file

Would that work?



> --- On Sun, 27/12/09, Lloyd Zusman <ljz@asfast.com> wrote:
>
>> From: Lloyd Zusman <ljz@asfast.com>
>> Subject: Encrypting history?
>> To: zsh-users@zsh.org
>> Date: Sunday, 27 December, 2009, 5:55 AM
>> I would like my command history to be
>> stored in an encrypted file. I
>> have read a few messages in this list from 2007 which state
>> that there
>> isn't a straightforward way to do this within zsh, itself,
>> and the use
>> of an encrypted file system is suggested.
>> 
>> However, I think that there might indeed be a way to
>> accomplish this.
>> 
>> Is it possible to do the following?
>> 
>> Make sure that SAVEHIST is set to 0.
>> 
>> Then, on login, prompt the user for a password. Remember
>> this password
>> for the duration of the shell session. Then, use this
>> password along
>> with a decryption program to read an encrypted history file
>> called, for
>> example, ~/.ehistory. Put the decrypted contents of this
>> file into the
>> current shell's history list via the repeated use of the
>> "print -s"
>> command.
>> 
>> Finally, on logout, pipe the output of "fc -ln 1" through a
>> program
>> which uses the same password entered at login time to
>> encrypt the
>> history and write it to the ~/.ehistory file.
>> 
>> Can any of you see any reason for why this would not work?
>> 
>> Or alternatively, is there perhaps a better way to do this
>> within zsh?
>> 
>> Thanks in advance.
>>   
>> 
>> -- 
>>  Lloyd Zusman
>>  ljz@asfast.com
>>  God bless you.
>> 
>> 
>
>
>       Get your new Email address!
> Grab the Email name you&#39;ve always wanted before someone else does!
> http://mail.promotions.yahoo.com/newdomains/aa/
>
>

-- 
 Lloyd Zusman
 ljz@asfast.com
 God bless you.

