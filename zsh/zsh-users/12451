From zsh-users-return-12451-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 17 17:27:00 2008
Return-Path: <zsh-users-return-12451-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29373 invoked from network); 17 Jan 2008 17:26:49 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.2 required=5.0 tests=AWL,BAYES_00,
	RCVD_IN_SORBS_WEB autolearn=no version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 Jan 2008 17:26:49 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 5762 invoked from network); 17 Jan 2008 17:26:27 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 Jan 2008 17:26:27 -0000
Received: (qmail 11073 invoked by alias); 17 Jan 2008 17:26:17 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12451
Received: (qmail 11056 invoked from network); 17 Jan 2008 17:26:16 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 17 Jan 2008 17:26:16 -0000
Received: from virusfilter.dotsrc.org (bifrost [127.0.0.1])
	by spamfilter.dotsrc.org (Postfix) with ESMTP id 6B3D18059008
	for <zsh-users@sunsite.dk>; Thu, 17 Jan 2008 18:26:13 +0100 (CET)
Received: from sienna.akte.de (sienna.akte.de [80.237.184.21])
	by bifrost.dotsrc.org (Postfix) with ESMTP
	for <zsh-users@sunsite.dk>; Thu, 17 Jan 2008 18:26:12 +0100 (CET)
Received: (root@sienna.akte.de) by sienna.akte.de id <S4079812AbYAQR0E>;
	Thu, 17 Jan 2008 18:26:04 +0100
KRecCount: 1
X-Originating-IP: [87.152.142.135]
X-KInfo: !spam auth
X-KInfo: virscan ok
Received: from condor.int.spiegl.de (p57988E87.dip.t-dialin.net [87.152.142.135])
	 by sienna.akte.de
	 via kasmail (3.1)
	 id <1JFYV9-7WP-1-sienna>; Thu, 17 Jan 2008 17:26:04 GMT
Received: from condor.int.spiegl.de (spiegl@localhost [127.0.0.1])
	by condor.int.spiegl.de (8.14.1/8.14.1/Debian-9) with ESMTP id m0HHQ3op016971
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
	for <zsh-users@sunsite.dk>; Thu, 17 Jan 2008 18:26:03 +0100
Received: (from spiegl@localhost)
	by condor.int.spiegl.de (8.14.1/8.14.1/Submit) id m0HHQ34Z016964
	for zsh-users@sunsite.dk; Thu, 17 Jan 2008 18:26:03 +0100
X-Authentication-Warning: condor.int.spiegl.de: spiegl set sender to zsh.Andy@spiegl.de using -f
Date:	Thu, 17 Jan 2008 18:26:03 +0100
From:	Andy Spiegl <zsh.Andy@spiegl.de>
To:	zsh-users@sunsite.dk
Subject: Re: idea for new feature (was: Re: sticky-note and zle bindings)
Message-ID: <20080117172603.GA664@spiegl.de>
Mail-Followup-To: zsh-users@sunsite.dk
References: <20080104105900.37a87f7e@news01> <237967ef0801040304h494987bv939bf6ff9541123f@mail.gmail.com> <477E177A.3060303@kotiportti.fi> <Xns9A20C0F173D23zzappergmailcom@80.91.229.13> <080113000048.ZM15017@torch.brasslantern.com> <20080116131048.GC16058@spiegl.de> <080116075915.ZM12209@torch.brasslantern.com> <20080116171253.GF16058@spiegl.de> <080116191103.ZM12889@torch.brasslantern.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <080116191103.ZM12889@torch.brasslantern.com>
X-PGP-GPG-Keys:	mail -s "send pgp" auto@spiegl.de
X-Fingerprint: Key-ID C2CB30F0: 9051 50B9 13B0 57B9 10FD  48AC 4FA1 209B
	C2CB 30F0
X-Accepted-File-Formats: ASCII OpenOffice .rtf .pdf - *NO* Microsoft files
	please.
X-why-you-shouldnt-use-MS-LookOut: http://www.jensbenecke.de/l-oe-en.php
X-warum-man-MS-Outlook-vermeiden-sollte: http://www.jensbenecke.de/l-oe-de.p
	hp
X-how-to-quote:	http://www.afaik.de/usenet/faq/zitieren/
X-how-to-ask-questions:	http://www.catb.org/~esr/faqs/smart-questions.html
X-stupid-disclaimers: http://goldmark.org/jeff/stupid-disclaimers/
User-Agent: Mutt/1.5.16 (2007-06-11)
X-Virus-Scanned: ClamAV using ClamSMTP

On 2008-01-16, 19:11, Bart Schaefer wrote:
> Of course this is what share_history and inc_append_history are in
> part intended to accomplish.
Only for the command history, though.
I was thinking about the directory stack.

> The problem is that zsh can't do it by iself.  So, your X server has
> crashed and 20 shell windows went kablooie.  Even if every zsh has
> faithfully been recording its state somewhere, how does each new
> xterm you launch on the retarted X desktop know which one of the 20
> saved states it should restore?
You're right - that's too complex and depends heavily on the user environment.
But zsh could start the cooperation by providing the saved data and some kind
of mechanism of reading it back in to restore the directory stack.

Having that, it will be up to the users/terminal-guys/xserver-guys to use
that data.  When they know that zsh provides this they might be interested
in using it.

> The upshot is that this isn't a zsh feature -- it's a cooperative
> feature that requires effort from both the shell and whatever other
> user interface environment it's running inside.
Right, so let's start. :-)

> It's pretty simple to dump state somewhere from the precmd() function
In a separate file for each zsh instance?  Using the PID?  Or a counter?
Or maybe some unique identifier for each instance, say shell1, shell2, ...
That way zsh could check at startup whether there is a state-file for
its name and read it back in.  The unique name should probably be in
an environment variable.  Hm, then in .xsession you would start several
xterms with shells like that:
 ZSHNAME="shell-1" /usr/bin/xterm -geometry 90x45+89+212 -T "Shell-1"
 ZSHNAME="shell-2" /usr/bin/xterm -geometry 90x45+89+212 -T "Shell-2"

How about that?

Bye,
 Andy.

-- 
 To err is human. To really screw it up takes a computer.

