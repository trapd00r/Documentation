From zsh-workers-return-12415-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jul 27 21:59:53 2000
Return-Path: <zsh-workers-return-12415-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20155 invoked from network); 27 Jul 2000 21:59:52 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Jul 2000 21:59:52 -0000
Received: (qmail 19874 invoked by alias); 27 Jul 2000 21:59:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12415
Received: (qmail 19867 invoked from network); 27 Jul 2000 21:59:40 -0000
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: PATCH: quote separators when using vared on array. 
In-reply-to: "Peter Stephenson"'s message of "Thu, 27 Jul 2000 18:40:09 BST."
             <0FYD00KQLAEWE6@la-la.cambridgesiliconradio.com> 
Date: Thu, 27 Jul 2000 22:59:50 +0100
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E13Hvgo-0006so-00.2000-07-27-22-59-38@cmailg5.svr.pol.co.uk>

Peter Stephenson wrote:
> we'll wait for some schmuck to fix it

One day I'm going to learn to programme.  (This version actually tested
with nulls as separators.)

Index: Src/utils.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/utils.c,v
retrieving revision 1.12
diff -u -r1.12 utils.c
--- Src/utils.c	2000/07/27 17:48:48	1.12
+++ Src/utils.c	2000/07/27 21:57:43
@@ -1901,6 +1901,8 @@
 	    if (quote && *t == '\\' &&
 		isep(t[1] == Meta ? (t[2] ^ 32) : t[1])) {
 		chuck(t);
+		if (*t == Meta)
+		    t++;
 		continue;
 	    }
 	    if (*t == Meta) {

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Work: pws@CambridgeSiliconRadio.com
Web: http://www.pwstephenson.fsnet.co.uk

