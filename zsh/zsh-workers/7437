From zsh-workers-return-7437-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Aug 14 22:05:55 1999
Return-Path: <zsh-workers-return-7437-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9323 invoked from network); 14 Aug 1999 22:05:53 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 14 Aug 1999 22:05:53 -0000
Received: (qmail 255 invoked by alias); 14 Aug 1999 22:05:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7437
Received: (qmail 245 invoked from network); 14 Aug 1999 22:05:35 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <990814220530.ZM6932@candle.brasslantern.com>
Date: Sat, 14 Aug 1999 22:05:30 +0000
In-Reply-To: <rsq7lmy73h0.fsf@crane.jaist.ac.jp>
Comments: In reply to Tanaka Akira <akr@jaist.ac.jp>
        "exec last command in last pipeline." (Aug 15,  1:04am)
References: <rsq7lmy73h0.fsf@crane.jaist.ac.jp>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: exec last command in last pipeline.
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Aug 15,  1:04am, Tanaka Akira wrote:
} Subject: exec last command in last pipeline.
}
} --- exec.c	1999/07/24 14:02:56	1.1.1.19
} +++ exec.c	1999/08/14 15:55:32
} @@ -1522,7 +1522,7 @@
}  
}  	    /* Current shell should not fork unless the *
}  	     * exec occurs at the end of a pipeline.    */
} -	    if ((cflags & BINF_EXEC) && last1 == 2)
} +	    if ((cflags & BINF_EXEC) && last1)
}  		flags |= CFLAG_EXEC;
}  
}  	    /* Empty command */

I'm extremely dubious of that change.  The only way that last1 can be set
to 2 is here in execpline2():

    if (pline->type == END)
    	execcmd(pline->left, input, output, how, last1 ? 1 : 2);

If you remove the test of last1 == 2 in execcmd(), there's no reason to
test for last1 in execpline2().  But both tests have been there since
before version 3.0.0; I'm concerned that the shell is going to exec in
some cases where it should not.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

