From zsh-workers-return-21469-mason-zsh=primenet.com.au@sunsite.dk Fri Jul 15 00:54:53 2005
Return-Path: <zsh-workers-return-21469-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29029 invoked from network); 15 Jul 2005 00:54:51 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 15 Jul 2005 00:54:51 -0000
Received: (qmail 66646 invoked from network); 15 Jul 2005 00:54:46 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 15 Jul 2005 00:54:46 -0000
Received: (qmail 1086 invoked by alias); 15 Jul 2005 00:54:43 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21469
Received: (qmail 1076 invoked from network); 15 Jul 2005 00:54:42 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 15 Jul 2005 00:54:42 -0000
Received: (qmail 66309 invoked from network); 15 Jul 2005 00:54:41 -0000
Received: from vms048pub.verizon.net (206.46.252.48)
  by a.mx.sunsite.dk with SMTP; 15 Jul 2005 00:54:37 -0000
Received: from candle.brasslantern.com ([71.116.88.149])
 by vms048.mailsrvcs.net
 (Sun Java System Messaging Server 6.2 HotFix 0.04 (built Dec 24 2004))
 with ESMTPA id <0IJN00BBY96P4ZS1@vms048.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Thu, 14 Jul 2005 19:54:26 -0500 (CDT)
Received: from candle.brasslantern.com (IDENT:schaefer@localhost [127.0.0.1])
	by candle.brasslantern.com (8.12.11/8.12.11) with ESMTP id j6F0sO1e028708	for
 <zsh-workers@sunsite.dk>; Thu, 14 Jul 2005 17:54:24 -0700
Received: (from schaefer@localhost)	by candle.brasslantern.com
 (8.12.11/8.12.11/Submit) id j6F0sOtv028707	for zsh-workers@sunsite.dk; Thu,
 14 Jul 2005 17:54:24 -0700
Date: Fri, 15 Jul 2005 00:54:24 +0000
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Good, easy to use, upstream defaults for zsh (i.e. improving
 usability)
In-reply-to: <200507141743.j6EHhxep028667@news01.csr.com>
To: zsh-workers@sunsite.dk
Message-id: <1050715005424.ZM28706@candle.brasslantern.com>
MIME-version: 1.0
X-Mailer: Z-Mail (5.0.0 30July97)
Content-type: text/plain; charset=us-ascii
References: <ef5675f305071015374c036f2f@mail.gmail.com>
	<3060c2390507101559320eb09c@mail.gmail.com>
	<ef5675f305071016226f9d44ce@mail.gmail.com>
	<200507141203.j6EC3Ktf015537@news01.csr.com>
	<1050714150608.ZM28405@candle.brasslantern.com>
	<200507141743.j6EHhxep028667@news01.csr.com>
Comments: In reply to Peter Stephenson <pws@csr.com>
 "Re: Good, easy to use, upstream defaults for zsh (i.e. improving usability)"
 (Jul 14,  6:43pm)
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

On Jul 14,  6:43pm, Peter Stephenson wrote:
}
} Bart Schaefer wrote:
} > Here's something that occurred to me:
} > 
} > During startup, if none of the ${ZDOTDIR:-$HOME}/.z* files are found,
} > zsh looks for (but does not complain if it does not find) a "new user"
} > module, e.g. zsh/newuser, and loads it.
} > 
} > (Or the module could be loaded unconditionally, and the test for whether
} > the .z* files exist could be part of the module bootup.)
} 
} The second alternative is more natural from the point of view of
} modularity, although a little less efficient.  Presumably we could
} safely attempt to unload the module immediately.

Agreed on both counts.

} > We could provide a default implementation of zsh/newuser that looks
} > for files in /usr/share/zsh/$VERSION

On further thought, probably the right thing is for the module to look
for a *single* file, and either simply source it, or autoload it and
then call a specified function that it is expected to define.  Anything
else we might want to do can then be programmed in shell language,
within that file or function.

(I think the test for existence of the .z* files should remain within
the C code, though.)

} One thing that occurs to me is that we need to make it easy for admins
} to override the defaults.  Hence I think it should look in, say,
} <install-path>/newuser/ and <install-path>/$VERSION/newuser/, probably
} in that order

This would be fine, though perhaps <install-path>/site-functions/ is a
better spot to look first if it were a single autoloadable file.  There
may be valid reasons to make this something that can be manually loaded/
called, as with compinstall.

