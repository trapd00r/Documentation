From zsh-workers-return-16720-mason-zsh=primenet.com.au@sunsite.dk Tue Feb 26 20:17:08 2002
Return-Path: <zsh-workers-return-16720-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13690 invoked from network); 26 Feb 2002 20:17:08 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 26 Feb 2002 20:17:08 -0000
Received: (qmail 2521 invoked by alias); 26 Feb 2002 20:17:01 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16720
Received: (qmail 2503 invoked from network); 26 Feb 2002 20:17:00 -0000
Date: Tue, 26 Feb 2002 12:16:54 -0800 (PST)
From: Bart Schaefer <schaefer@brasslantern.com>
Sender: <schaefer@ns1.sodaware.com>
To: DervishD <raul@viadomus.com>
cc: Zsh <zsh-workers@sunsite.dk>
Subject: Re: About 'test' compatibility
In-Reply-To: <3C7BEB12.mailIC1111B0Z@viadomus.com>
Message-ID: <Pine.LNX.4.33.0202261211590.14523-100000@ns1.sodaware.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Tue, 26 Feb 2002, DervishD wrote:

>     I'm trying to use zsh for building the linux kernel, but the
> configuration scripts make use of the '[' builtin, and assume that
> '-a' means 'and', and not 'true if file exists'.

Can you give an example of the way this is failing?

Zsh 'test' does support -a for "and" but only when it appears as an infix
operator, e.g.

	[ foo -a bar ]		is true
	[ foo -a "" ]		is false
	[ "" -a bar ]		is false

	[ -a bar ]		is true if file "bar" exists, else false

My suspicion would be that the kernel build is doing something like

	[ $foo -a $bar ]

which zsh would interpret as infix -a only if $foo were non-empty.  The
correct test would be

	[ "$foo" -a "$bar" ]

and if that is indeed the issue, the kernel build scripts really should be
fixed.

