From zsh-workers-return-10314-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Mar 29 10:50:52 2000
Return-Path: <zsh-workers-return-10314-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16720 invoked from network); 29 Mar 2000 10:50:51 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 29 Mar 2000 10:50:51 -0000
Received: (qmail 15087 invoked by alias); 29 Mar 2000 10:50:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10314
Received: (qmail 15074 invoked from network); 29 Mar 2000 10:50:37 -0000
Message-ID: <38E1DFEA.E7CFAE7@u.genie.co.uk>
Date: Wed, 29 Mar 2000 11:50:18 +0100
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.72 [en] (Win95; I)
X-Accept-Language: en
MIME-Version: 1.0
To: Zsh workers <zsh-workers@sunsite.auc.dk>
Subject: PATCH: misc. small changes
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

This patch just tidies up a few small things. _zpty is modified to make
use of Sven's changes which are now in dev-20. There is a small fix for
_nedit. I've added a second condition test for /dev/fd/0 to the tests
as there is two separate forms of handling for this. The ChangeLog
referenced 9761 twice and refered to a zsh-3.1.6-pws-11.new directory
for one change - probably my fault for generating the diff from the
wrong place. Finally, I have made an addition to the docs for the
subst-globs-only style I added to _expand and fixed a typo.

Oliver

--- Completion/Builtins/_zpty.bak	Tue Mar 28 18:55:40 2000
+++ Completion/Builtins/_zpty	Tue Mar 28 18:56:11 2000
@@ -7,9 +7,9 @@
   '(-d -w -r -L)-b[io to pseudo-terminal blocking]' \
   '(-e -b -w -r -L)-d[delete command]:*:name:->name' \
   '(-e -b -d -r -L)-w[send string to command]:name:->name:*:strings to write' \
-  '(-e -b -d -w -L)-r[read string from command]:name:->name:param:_parameters:*:nothing:_nothing' \
+  '(-e -b -d -w -L *)-r[read string from command]:name:->name:param:_parameters' \
   '(-e -b -d -w -r)-L[list defined commands as calls]' \
-  '*::args:_normal'
+  '(-r)*::args:_normal'
 
 if [[ $state = name ]] && _wanted names; then
   list=( ${${(f)"$(zpty)"}#*\) } )
--- Completion/User/_nedit.bak	Tue Mar 28 18:57:07 2000
+++ Completion/User/_nedit	Tue Mar 28 18:57:25 2000
@@ -40,7 +40,7 @@
     '(-background)-bg[specify background color]:background color:_x_color' \
     '(-fg)-foreground:foreground color:_x_color' \
     '(-foreground)-fg[specify foreground color]:foreground color:_x_color' \
-    '-import[load additional preferences file]:nedit preferences file:_files' \
+    '*-import[load additional preferences file]:nedit preferences file:_files' \
     "$nedit_common[@]"
 fi
 
--- Test/07cond.ztst.bak	Tue Mar 28 18:40:58 2000
+++ Test/07cond.ztst	Tue Mar 28 18:46:07 2000
@@ -139,7 +139,10 @@
 0:|| and && in conds
 
   [[ -e /dev/fd/0 ]]
-0:/dev/fd support in conds
+0:/dev/fd support in conds handled by access
+
+  [[ -O /dev/fd/0 ]]
+0:/dev/fd support in conds handled by stat
 
   [[ ( -z foo && -z foo ) || -z foo ]]
 1:complex conds with skipping
--- ChangeLog.bak	Tue Mar 28 19:08:03 2000
+++ ChangeLog	Tue Mar 28 19:17:33 2000
@@ -628,8 +628,6 @@
 
 	* Sven: 9763: Src/subst.c: addition to 9757.
 
-	* Oliver: 9761: Completion/Core/_expand: handle suffix.
-
 	* Sven: 9759: Completion/Base/_default, Doc/Zsh/compsys.yo,
 	Src/Zle/comp.h, Src/Zle/compcore.c, Src/Zle/compctl.c,
 	Src/Zle/complete.c: use-compctl style to use existing compctls;
@@ -1744,12 +1742,9 @@
 
 1999-12-14  Peter Stephenson  <pws@pwstephenson.fsnet.co.uk>
 
-	* Oliver: 9047: zsh-3.1.6-pws-11.new/Src/Zle/compcore.c,
-	zsh-3.1.6-pws-11.new/Src/Zle/compresult.c,
-	zsh-3.1.6-pws-11.new/Src/Zle/zle_thingy.c,
-	zsh-3.1.6-pws-11.new/Src/Zle/zle_tricky.c,
-	zsh-3.1.6-pws-11.new/Src/mkmakemod.sh: hack .export files to
-	be made in time for use.
+	* Oliver: 9047: Src/Zle/compcore.c, Src/Zle/compresult.c,
+	Src/Zle/zle_thingy.c, Src/Zle/zle_tricky.c, Src/mkmakemod.sh:
+	hack .export files to be made in time for use.
 
 	* Sven: 9039: Doc/Zsh/mod_compctl.yo: description change.
 
--- Doc/Zsh/compsys.yo.bak	Tue Mar 28 19:27:49 2000
+++ Doc/Zsh/compsys.yo	Wed Mar 29 10:42:45 2000
@@ -1413,6 +1413,13 @@
 substitution will be performed only if given an explicit numeric
 argument other than `tt(1)', as by typing `tt(ESC 2 TAB)'.
 )
+item(tt(subst-globs-only))(
+If this is set to `tt(1)' or an expression that evaluates to `tt(1)'
+then _expand will only do substitution if globbing is able to do
+something. This is useful if you prefer not to have substitution but
+want globbing to work in cases where there are substitutions in the
+string.
+)
 item(tt(tag-order))(
 This provides a mechanism for sorting how the tags available in a
 particular context will be used.
@@ -1776,7 +1783,7 @@
 string from the line.
 
 Which kind of expansion is tried is controlled by the tt(substitute)
-nad tt(glob) styles. Note that neither of these has a default value so 
+and tt(glob) styles. Note that neither of these has a default value so 
 that they have to be set to make tt(_expand) generate any expansions
 at all.

