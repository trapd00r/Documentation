From zsh-users-return-6080-mason-zsh=primenet.com.au@sunsite.dk Tue May 06 21:34:34 2003
Return-Path: <zsh-users-return-6080-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20235 invoked from network); 6 May 2003 21:34:34 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 May 2003 21:34:34 -0000
Received: (qmail 10142 invoked by alias); 6 May 2003 21:34:17 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6080
Received: (qmail 10135 invoked from network); 6 May 2003 21:34:16 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 6 May 2003 21:34:16 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [212.87.0.242] by sunsite.dk (MessageWall 1.0.8) with SMTP; 6 May 2003 21:34:16 -0000
Received: from mike by Amber.lab.icm.edu.pl with local (Exim 3.36 #1 (Debian))
	id 19DA4m-000846-00
	for <zsh-users@sunsite.dk>; Tue, 06 May 2003 23:34:16 +0200
Date: Tue, 6 May 2003 23:34:16 +0200
From: =?iso-8859-2?Q?Micha=B3?= Politowski <mpol@charybda.icm.edu.pl>
To: zsh-users@sunsite.dk
Subject: remote files completion for scp
Message-ID: <20030506213416.GA30800@Amber.lab.icm.edu.pl>
Mail-Followup-To: zsh-users@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-2
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable
X-PGP: 1024D/8C6E2929; AC30 1FC4 4C4B 8834 38D8  21DA 7EB7 7AAB 8C6E 2929; 2002-03-02 -- 2004-03-01
User-Agent: Mutt/1.5.4i

I believe that this completion needs something, maybe dequoting like this, =
to work correctly.
Without this it can't complete any remote path segments after one with
spaces, with the change it works for me.

--- /usr/share/zsh/4.0.6/functions/Completion/Unix/_ssh	2003-03-25 15:45:53=
=2E000000000 +0100
+++ /home/mike/.zsh/functions/_ssh	2003-05-06 23:18:03.000000000 +0200
@@ -7,5 +7,5 @@
   if zstyle -T ":completion:${curcontext}:" remote-access; then
     zparseopts -D -E -a args p: 1 2 4 6 F:
-    remfiles=3D(${(M)${(f)"$(ssh $args -a -x ${words[CURRENT]%%:*} ls -d1F=
 ${PREFIX%%[^./][^/]#}\* 2>/dev/null)"}%%[^/]#(|/)})
+    remfiles=3D(${(M)${(f)"$(ssh $args -a -x ${words[CURRENT]%%:*} ls -d1F=
 ${(Q)PREFIX%%[^./][^/]#}\* 2>/dev/null)"}%%[^/]#(|/)})
     compset -P '*/'
     compset -S '/*' || suf=3D'remote file'



One other thing. I obviously don't understand something about quoting.
Why with foo=3D'a\string\with\some\backslashes'
echo "${foo//'\'/-}"
and
echo "${foo//"\\"/-}"
work but
echo "${foo//\\/-}"
doesn't do any substitutions,
no matter how many backslashes do I actually put in the last one?

--=20
Micha=B3 Politowski -- mpol@charybda.icm.edu.pl
Warning: this is a memetically modified message

