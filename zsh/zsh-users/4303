From zsh-users-return-4303-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 01 06:59:30 2001
Return-Path: <zsh-users-return-4303-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21709 invoked from network); 1 Oct 2001 06:59:29 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Oct 2001 06:59:29 -0000
Received: (qmail 27794 invoked by alias); 1 Oct 2001 06:59:16 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4303
Received: (qmail 27778 invoked from network); 1 Oct 2001 06:59:15 -0000
Message-Id: <200110010703.f9173Fq10895@bang.houseoflove>
X-Mailer: exmh version 2.4 05/15/2001 with nmh-1.0.4
From: Drew Perttula <drewp@bigasterisk.com>
To: zsh-users@sunsite.dk
Subject: Re: get the number of active jobs to show in the prompt? 
In-Reply-To: Your message of "Mon, 01 Oct 2001 08:37:58 +0200."
             <20011001083758.A12916@globnix.org> 
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Date: Sun, 30 Sep 2001 23:59:21 -0700


> Actually, what I have is this:
> precmd () {
> 	local exitstatus=$?
> 	psvar[1]=SIG 
> 	[[ $exitstatus -ge 128 ]] && psvar[1]=SIG$signals[$exitstatus-127] 
> 	[[ $psvar[1] = SIG ]] && psvar[1]=$exitstatus 
> 	jobs % >& /dev/null && psvar[2]=""  || psvar[2]=() 
> }
> [ switch PS1 depending upon $TERM, but for xterm: ]
> PS1=': %2(L.%U[%L]%u.)%(?..%B{%v}%b)%(2v:+:-)%n@%m:%l(%!)%30<..<%~%#; '
> 
> The key thing is the %(2v:+:-)  --  psvar[2] was set depending upon
> whether or not there are background jobs, %(2v:+:-) therefore gives a
> '+' if there are background jobs, or a '-' if not.

It seems like the + and - come at the reverse times than you say, 
but, just the same, this looks like what I want.

Thanks everyone for the quick responses!

-Drew



