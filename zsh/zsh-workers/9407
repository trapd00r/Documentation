From zsh-workers-return-9407-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Jan 22 19:50:37 2000
Return-Path: <zsh-workers-return-9407-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5757 invoked from network); 22 Jan 2000 19:50:35 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Jan 2000 19:50:35 -0000
Received: (qmail 22251 invoked by alias); 22 Jan 2000 19:50:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9407
Received: (qmail 22243 invoked from network); 22 Jan 2000 19:50:27 -0000
To: zsh-workers@sunsite.auc.dk
Subject: Re: vared and history 
In-reply-to: "Sven Wischnowsky"'s message of "Fri, 21 Jan 2000 10:36:35 +0100."
             <200001210936.KAA02351@beta.informatik.hu-berlin.de> 
Date: Sat, 22 Jan 2000 19:52:54 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E12C6Y9-0000ho-00.2000-01-22-19-50-21@mail3.svr.pol.co.uk>

Sven Wischnowsky wrote:
> 
> Again no `PATCH:' in the subject because I'm not sure about this at
> all...
> 
> The patch just makes bin_vared() call hbegin(1) and hend() when given
> the -h option. That's the same loop() does, so it seemed sensible...
> 
> Peter: does this look like the right thing for you? It seems to work.

Looks all right.  I had the hbegin/hend somewhere else and I still didn't
get the right line, but this way it seems to work.  The other question is
whether we leave it up to the user to add it to the history with print -s.
I suppose that's all right here.

> Another thing is that in functions like nslookup one probably wants to 
> be able to use ^D on an empty line to leave vared. I couldn't find a
> way to make this possible, so I added the -e option (making it accept
> EOF). Is that right? Was there really no way?

The point was probably to allow the editor to get hold of all the
characters.  You could probably bind ^D to accept-line to get pretty much
the same effect, but if you only wanted that on an empty line you would
need your own widget.

> The stuff in nslookup just makes it use -e and history and improves
> the prompt styles.

I missed the nslookup part out because I haven't applied the zpty patch.
I haven't applied that because I don't know if it's going to fail to
compile on some systems.  This may require some more configure tests.  But
it would be a nice library to have.

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

