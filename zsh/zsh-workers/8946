From zsh-workers-return-8946-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Dec 08 14:41:36 1999
Return-Path: <zsh-workers-return-8946-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24142 invoked from network); 8 Dec 1999 14:41:34 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Dec 1999 14:41:34 -0000
Received: (qmail 6237 invoked by alias); 8 Dec 1999 14:41:16 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8946
Received: (qmail 6230 invoked from network); 8 Dec 1999 14:41:15 -0000
Date: Wed, 8 Dec 1999 14:40:42 GMT
Message-Id: <199912081440.OAA16357@mango.dublin.iona.ie>
To: zsh-workers@sunsite.auc.dk
From: zefram@fysh.org
Subject: PATCH: a couple of Makefile fixes

"make distclean" reveals two small bugs:

1. The Test subdirectory needs to be entered for cleaning.

2. There is a very long-standing bug that causes stamp-h.in to be created
   in the wrong directory if it doesn't already exist.  I remember fixing
   this several years ago, but the change evidently disappeared sometime
   since.

-zefram

*** ../zsh-cvs-snapshot-08.12.1999.04.04.02/Makefile.in	Mon Dec  6 04:33:02 1999
--- Makefile.in	Wed Dec  8 14:10:52 1999
***************
*** 98,103 ****
--- 98,104 ----
  distclean-here:
  	@cd Completion && $(MAKE) $(MAKEDEFS) $@
  	@cd Functions && $(MAKE) $(MAKEDEFS) $@
+ 	@cd Test && $(MAKE) $(MAKEDEFS) $@
  	rm -f Makefile config.h config.status config.log config.cache stamp-h Config/defs.mk
  
  realclean-here:
***************
*** 123,129 ****
  config.h.in: stamp-h.in
  stamp-h.in: configure.in acconfig.h aclocal.m4 aczsh.m4
  	cd $(sdir) && autoheader
! 	echo > $@
  
  # ========== DEPENDENCIES FOR DISTRIBUTION ==========
  
--- 124,130 ----
  config.h.in: stamp-h.in
  stamp-h.in: configure.in acconfig.h aclocal.m4 aczsh.m4
  	cd $(sdir) && autoheader
! 	echo > $(sdir)/stamp-h.in
  
  # ========== DEPENDENCIES FOR DISTRIBUTION ==========
  
END

