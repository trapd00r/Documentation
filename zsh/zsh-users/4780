From zsh-users-return-4780-mason-zsh=primenet.com.au@sunsite.dk Tue Mar 26 01:18:10 2002
Return-Path: <zsh-users-return-4780-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25768 invoked from network); 26 Mar 2002 01:18:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 26 Mar 2002 01:18:09 -0000
Received: (qmail 9720 invoked by alias); 26 Mar 2002 01:17:55 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4780
Received: (qmail 9709 invoked from network); 26 Mar 2002 01:17:53 -0000
Date: Mon, 25 Mar 2002 17:17:44 -0800 (PST)
From: Bart Schaefer <schaefer@brasslantern.com>
Sender: schaefer@ns1.sodaware.com
To: Joakim Ryden <jryden@forumone.com>
cc: zsh-users <zsh-users@sunsite.dk>
Subject: Re: My zshrc; any sugestions welcome
In-Reply-To: <20020326000618.GJ5719@forumone.com>
Message-ID: <Pine.LNX.4.44.0203251706460.5070-100000@ns1.sodaware.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 25 Mar 2002, Joakim Ryden wrote:

> /home/jo/.zshrc:133: compinit: function definition file not found
>
> whereas just straight sourcing ~/.zshrc (not from the function)
> works fine. i'm sure i'm overlooking something stupid. any ideas
> anyone??

It's because `typeset -U path fpath ...' is executing inside the function
context and therefore turning all those arrays into local variables that
don't have their usual values.  I should have noticed this before.

There is no workaround for this using functions in zsh 3.0, so the `src'
function can't be used if the .zshrc is going to be read that version.
If only 4.0 will ever read it, you can change the call to typset to use
the -g option

	typeset -gU path fpath ...

and then all will be well.

Alternately, put the body of the `src' function in another file (called
for example `~/.zsh_reload') and then read *that* file with `source', e.g.

	alias src='source ~/.zsh_reload'

