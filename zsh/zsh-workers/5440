From zsh-workers-return-5440-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Feb 20 16:01:18 1999
Return-Path: <zsh-workers-return-5440-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17791 invoked from network); 20 Feb 1999 16:01:13 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 20 Feb 1999 16:01:13 -0000
Received: (qmail 12736 invoked by alias); 20 Feb 1999 16:01:01 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5440
Received: (qmail 11057 invoked from network); 20 Feb 1999 15:57:15 -0000
Message-Id: <9902201541.AA37470@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Non-patch for zftp
Date: Sat, 20 Feb 1999 16:41:27 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>

I've made some changes to zftp; since it applies to pws-8 and I'm about to
produce pws-9, it seems pointless to post it separately, but here is a list
of changes that will appear.

1. The functions in Misc/zftp-functions now avoid using zftp in subshells,
since I discovered that on Irix 6.2 it doesn't work --- the control fd is
invalid after a fork().  That's strange, since I vaguely thought I'd
originally tried it there and it did work.  However, I haven't been able to
track down any change which has affected this.  It's OK on every other OS
I've tested (the Linux box is currently down).

2. The zf* functions now have auto-open capability:  if the connection
times out, `zftp test' should be able to spot this and the functions will
transparently re-open the connection --- assuming you set it up in the
usual way with zfopen.  Also, if you explicitly close the connection, a
zfcd or zfdir will re-open it permanently while zfget will open it just for
that file grab (etc.).

3. There are more `return 6' statements in the source; 6 is the special
code for `don't even think about doing anything else', so this ought to
reduce the incidence of multiple error messages.

4. New Functions/Completion/_zftp:  currently this uses the old-style
completion functions zfget_match and zfcd_match, but it could be made
smarter.  (For example, prefix handling of directories can now be done as
if they were real directories.)

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

