From zsh-workers-return-6827-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 24 15:05:53 1999
Return-Path: <zsh-workers-return-6827-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25101 invoked from network); 24 Jun 1999 15:05:51 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Jun 1999 15:05:51 -0000
Received: (qmail 20878 invoked by alias); 24 Jun 1999 15:05:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6827
Received: (qmail 20871 invoked from network); 24 Jun 1999 15:05:34 -0000
Date: Thu, 24 Jun 1999 17:05:43 +0200
From: Jos Backus <Jos.Backus@nl.origin-it.com>
To: zsh-workers@sunsite.auc.dk
Subject: 3.0.6-pre-5 problem
Message-ID: <19990624170543.A750@hal.mpn.cp.philips.com>
Reply-To: Jos Backus <Jos.Backus@nl.origin-it.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.6i

	Hi,

Because of the outdated system ncurses FreeBSD uses, I am using the following
function:

mutt () {
	command mutt "$@"
	echotc rs
}

With 3.0.6-pre-5 something odd is happening:

hal:~% xterm &!

---Mutt: =inbox [Msgs:726 New:10 Flag:1 Inc:11 5.1M]---(threads/date)---(end)---
^Z	<background mutt>
zsh: 685 suspended (signal)  mutt | 
zsh: 686 running             mutt
hal:~% fg
q	<quit mutt>
---Mutt: =inbox [Msgs:727 New:11 Flag:1 Inc:11 5.1M]---(threads/date)---(99%)---

<xterm ``hangs'', no prompt is output>

There's a core file, too:

hal:~jos# gdb /bin/zsh zsh.core
GNU gdb 4.18
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-unknown-freebsd"...
(no debugging symbols found)...
Core was generated by `zsh'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /usr/lib/libtermcap.so.2...(no debugging symbols found)...
done.
Reading symbols from /usr/lib/libc.so.3...(no debugging symbols found)...done.
Reading symbols from /usr/libexec/ld-elf.so.1...(no debugging symbols found)...
done.
#0  0x8063943 in makerunning ()
(gdb) where
#0  0x8063943 in makerunning ()
#1  0x806398d in makerunning ()
#2  0x806398d in makerunning ()
#3  0x804b126 in bin_fg ()
#4  0x804a558 in execbuiltin ()
#5  0x80576fb in execcmd ()
#6  0x8055b5b in execpline2 ()
#7  0x805561f in execpline ()
#8  0x805530e in execlist ()
#9  0x8061ad8 in loop ()
#10 0x8061951 in main ()
#11 0x8049f61 in _start ()
(gdb) 

This doesn't happen when I call mutt directly (using ``command mutt'').

This looks like a zsh problem that may have been introduced with pre-5.

I can supply details if needed.

Thanks,
-- 
Jos Backus                          _/ _/_/_/  "Reliability means never
                                   _/ _/   _/   having to say you're sorry."
                                  _/ _/_/_/             -- D. J. Bernstein
                             _/  _/ _/    _/
Jos.Backus@nl.origin-it.com  _/_/  _/_/_/      use Std::Disclaimer;

