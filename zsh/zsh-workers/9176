From zsh-workers-return-9176-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Jan 01 20:58:31 2000
Return-Path: <zsh-workers-return-9176-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26448 invoked from network); 1 Jan 2000 20:58:30 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Jan 2000 20:58:30 -0000
Received: (qmail 15156 invoked by alias); 1 Jan 2000 20:58:24 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9176
Received: (qmail 15149 invoked from network); 1 Jan 2000 20:58:23 -0000
To: zsh-workers <zsh-workers@sunsite.auc.dk>
Subject: Re: Glob problem with memory 
In-reply-to: "Felix Rosencrantz"'s message of "Wed, 29 Dec 1999 23:51:46 PST."
             <19991230075146.20165.qmail@web1303.mail.yahoo.com> 
Date: Sat, 01 Jan 2000 17:16:39 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E124S7C-0002dj-00.2000-01-01-17-14-54@mail3.svr.pol.co.uk>

Felix Rosencrantz wrote:
> When attempting to do an "echo *(/)" or use other glob qualifiers,
> I've been getting a bus error with this stack trace on Solaris 5.6.

P.S. to my last message:  actually, if Linux is anything to go by, mmap()
should return things in multiples of the page size, in which case there
would be no alignment problems.  But it still seems something of this kind
is the most likely solution, so

1) you can probably see if it is by locating the (single) mmap() call in
mem.c, and adding underneath
  fprintf(stderr, "%p\n", h);
  fflush(stderr);
and looking at the pointers output;

2) I suppose it could be failing to use mmap64() for some reason --- at
least, this is the correct call for Linux with large file support, I don't
know if that's true for Solaris, but it's a good bet.  You could check with
nm whether zsh is linked with that.

In any case, I haven't seen any problems under Linux.
-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

