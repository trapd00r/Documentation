From zsh-workers-return-20355-mason-zsh=primenet.com.au@sunsite.dk Sat Sep 11 23:17:37 2004
Return-Path: <zsh-workers-return-20355-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27360 invoked from network); 11 Sep 2004 23:17:36 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Sep 2004 23:17:36 -0000
Received: (qmail 1478 invoked from network); 11 Sep 2004 23:17:30 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Sep 2004 23:17:30 -0000
Received: (qmail 1943 invoked by alias); 11 Sep 2004 23:17:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20355
Received: (qmail 1923 invoked from network); 11 Sep 2004 23:17:17 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 11 Sep 2004 23:17:17 -0000
Received: (qmail 888 invoked from network); 11 Sep 2004 23:16:26 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 11 Sep 2004 23:16:24 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 7BE6A7004C; Sat, 11 Sep 2004 19:16:28 -0400 (EDT)
Date: Sat, 11 Sep 2004 19:16:28 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Subject: [joshk@triplehelix.org: Bug#271196: makefile completion catches some delayed expansions as targets]
Message-ID: <20040911231628.GA17128@scowler.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.6+20040722i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

I can reproduce this, but only if use-perl is off.

----- Forwarded message from Joshua Kwan <joshk@triplehelix.org> -----

I have this in a debian/rules file:

ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
CFLAGS := -g -O0 -Wall
else
CFLAGS := -g -O2 -Wall
endif

Completion shows:

% make -f debian/rules
CFLAGS             build-arch         build-stamp-indep
binary             build-indep        clean
build              build-stamp-arch   install

CFLAGS shouldn't get flagged as a target.

The complete debian/rules is attached.

-- System Information:
Debian Release: 3.1
  APT prefers unstable
  APT policy: (500, 'unstable'), (499, 'testing'), (1, 'experimental')
Architecture: i386 (i686)
Kernel: Linux 2.6.9-rc1
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (ignored: LC_ALL set to en_US.UTF-8)

Versions of packages zsh depends on:
ii  debconf                     1.4.34       Debian configuration management sy
ii  libc6                       2.3.2.ds1-16 GNU C Library: Shared libraries an
ii  libcap1                     1:1.10-14    support for getting/setting POSIX.
ii  libncurses5                 5.4-4        Shared libraries for terminal hand
ii  passwd                      1:4.0.3-30.1 Change and administer password and

-- debconf information excluded

#!/usr/bin/make -f
# debian/rules for devscripts, based on the example file rules.indep.

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
CFLAGS := -g -O0 -Wall
else
CFLAGS := -g -O2 -Wall
endif

# Here we perform some checks to ensure that we haven't goofed or left
# debugging code around or ... before we build the package
test: test-stamp
test-stamp:
	# debugging info in bts?
	if grep -q '\$$debug *= *1' bts.pl; then exit 1; else exit 0; fi
	touch test-stamp

build-indep: build-stamp-indep
build-stamp-indep: test-stamp
	dh_testdir
	touch build-stamp-indep

build-arch: build-stamp-arch
build-stamp-arch: test-stamp
	dh_testdir
	$(MAKE) CFLAGS='$(CFLAGS)'
	touch build-stamp-arch

build: build-arch build-indep

clean:
	dh_testdir
	dh_testroot
	-$(MAKE) clean
	rm -f build-stamp* test-stamp
	dh_clean

install: build
	dh_testdir
	dh_testroot
	dh_clean -k
	dh_installdirs
	$(MAKE) DESTDIR=$(CURDIR)/debian/devscripts install

# Build architecture-independent files here.
binary-indep: build-indep
# We have nothing to do

# Build architecture-dependent files here.
binary-arch: build-arch install
	dh_testdir
	dh_testroot
	dh_installdocs README
	dh_installexamples
#	This is now done by the make install command above
#	dh_installman
	dh_link /usr/share/devscripts/conf.default \
		/usr/share/doc/devscripts/devscripts.conf.ex
	dh_installchangelogs
	dh_strip
	dh_compress
	dh_fixperms
	dh_installdeb
	dh_perl
	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

binary: binary-indep binary-arch

.PHONY: build-arch build-indep build clean binary-indep binary-arch binary \
	install

# Local variables:
# mode: makefile
# End:


----- End forwarded message -----

