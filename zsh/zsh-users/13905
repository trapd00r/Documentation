From zsh-users-return-13905-mason-zsh=primenet.com.au@sunsite.dk Sat Mar 14 08:37:26 2009
Return-Path: <zsh-users-return-13905-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 103 invoked from network); 14 Mar 2009 08:37:20 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Mar 2009 08:37:20 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 69022 invoked from network); 14 Mar 2009 08:34:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Mar 2009 08:34:59 -0000
Received: (qmail 4457 invoked by alias); 14 Mar 2009 08:34:44 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13905
Received: (qmail 4447 invoked from network); 14 Mar 2009 08:34:43 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 14 Mar 2009 08:34:43 -0000
Received: from atom.smasher.org (atom.smasher.org [69.55.237.145])
	by bifrost.dotsrc.org (Postfix) with SMTP id F24DD80307F8
	for <zsh-users@sunsite.dk>; Sat, 14 Mar 2009 09:34:29 +0100 (CET)
Received: (qmail 78415 invoked by uid 1000); 14 Mar 2009 08:34:21 -0000
Message-ID: <20090314083421.78414.qmail@smasher.org>
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
Date: Sat, 14 Mar 2009 21:34:19 +1300 (NZDT)
From: Atom Smasher <atom@smasher.org>
MIME-Version: 1.0
OpenPGP: id=0xB88D52E4D9F57808; algo=1 (RSA); size=4096; url=http://atom.smasher.org/pgp.txt
Subject: weird behavior with "[un]setopt monitor"
To: zsh-users@sunsite.dk
X-POM: The Moon is Waning Gibbous (88% of Full)
X-Hashcash: 1:20:0903140834:zsh-users@sunsite.dk::ExtF1c1vdIJ+XzAT:0000000000000
	0000000000000000000000009i04
X-Virus-Scanned: ClamAV 0.92.1/9107/Sat Mar 14 06:25:15 2009 on bifrost
X-Virus-Status: Clean

as expected:
  % sleep 30 &
  [1] 47773
  % jobs
  [1]  + running    sleep 30
  % kill %sleep
  [1]  + terminated  sleep 30

somewhat as expected:
  % unsetopt monitor ; sleep 30 & ; setopt monitor
  % jobs
  [1]  + running    sleep 30
  % kill %sleep
  kill: kill %sleep failed: no such process

not at all expected:
  % unsetopt monitor ; sleep 30 & ; setopt monitor
  % jobs
  [1]  + running    sleep 30
  % unsetopt monitor ; kill %sleep
  % jobs
  %

in the first case, i start "sleep 30" in the background. it shows up in 
the jobs table, and can be killed as expected. no surprised there.

in the second case, i start "sleep 30" in the background after unsetting 
the monitor option. after the job is dropped into the background, i reset 
the monitor option. the job is listed in the jobs table, which i didn't 
expect. as expected, it isn't killed in the normal way.

the third example is where things really get weird. i start "sleep 30" in 
the background after unsetting the monitor option. after the job is 
dropped into the background, i reset the monitor option. the job is listed 
in the jobs table, which i didn't expect. so far, the same as the second 
example. but if after i unset the monitor option, i can kill the job with 
kill. not at all what i expected.

is this a bug or an undocumented feature? it seems like an alternate table 
to store jobs in, which is useful. can i take advantage of this feature? 
or is it a bug that will be "fixed"?

thanks...


-- 
         ...atom

  ________________________
  http://atom.smasher.org/
  762A 3B98 A3C3 96C9 C6B7 582A B88D 52E4 D9F5 7808
  -------------------------------------------------

 	"I have presented factual data, statistical data, and
 	 projected data. Form your own conclusions. Perhaps the
 	 NSA has found a polynomial-time (read: fast) factoring
 	 algorithm. But we cannot dismiss an otherwise secure
 	 cryptosystem due to paranoia. Of course, on the same
 	 token, we cannot trust cryptosystems on hearsay or
 	 assumptions of security. Bottom line is this: in the
 	 field of computer security, it pays to be cautious. But
 	 it doesn't pay to be un-informed or needlessly paranoid.
 	 Know the facts."
 		-- infiNity, The PGP Attack FAQ

