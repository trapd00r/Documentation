From zsh-workers-return-23130-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 23 19:09:39 2007
Return-Path: <zsh-workers-return-23130-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14729 invoked from network); 23 Jan 2007 19:09:34 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Jan 2007 19:09:34 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 71609 invoked from network); 23 Jan 2007 19:09:29 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Jan 2007 19:09:29 -0000
Received: (qmail 1033 invoked by alias); 23 Jan 2007 19:09:26 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23130
Received: (qmail 1024 invoked from network); 23 Jan 2007 19:09:25 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 23 Jan 2007 19:09:25 -0000
Received: (qmail 71308 invoked from network); 23 Jan 2007 19:09:25 -0000
Received: from mailfe04.tele2.fr (HELO swip.net) (212.247.154.108)
  by a.mx.sunsite.dk with SMTP; 23 Jan 2007 19:09:19 -0000
X-Cloudmark-Score: 0.000000 []
Received: from [213.103.55.136] (account eu1388219@tele2.fr HELO localhost)
  by mailfe04.swip.net (CommuniGate Pro SMTP 5.0.12)
  with ESMTPA id 390968136 for zsh-workers@sunsite.dk; Tue, 23 Jan 2007 20:09:16 +0100
Date: Tue, 23 Jan 2007 20:09:16 +0100
From: "arno." <arno.@no-log.org>
To: zsh-workers@sunsite.dk
Subject: PATCH: updated _debchange
Message-ID: <20070123190916.GA5793@localhost.localdomain>
Mail-Followup-To: zsh-workers@sunsite.dk
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="T4sUOijqQbZv57TR"
Content-Disposition: inline
User-Agent: Mutt/1.5.13 (2006-08-11)


--T4sUOijqQbZv57TR
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hi,
I made a _debchange completion that supports more command line options=20
than current one

arno.


Index: Completion/Debian/Command/_debchange
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
RCS file: /cvsroot/zsh/zsh/Completion/Debian/Command/_debchange,v
retrieving revision 1.2
diff -u -r1.2 _debchange
--- Completion/Debian/Command/_debchange	31 Jul 2003 15:26:14 -0000	1.2
+++ Completion/Debian/Command/_debchange	23 Jan 2007 18:57:06 -0000
@@ -1,10 +1,46 @@
 #compdef debchange dch=3Ddebchange
=20
-_arguments \
-  '(-h --help)'{-h,--help}'[display help information]' \
-  '--version' \
-  '(--append -a --newversion -v --increment -i)'{-i,--increment}'[incremen=
t release or version number]' \
-  '(--append -a --newversion -v --increment -i)'{-a,--append}'[add new cha=
ngelog entry]' \
-  '(--append -a --newversion -v --increment -i)'{-v,--newversion}'[specify=
 new version number]:version:' \
-  '(--preserve -p)'{-p,--preserve}'[preserve source tree directory name]' \
-  ':text:'
+_debchange () {
+    emulate -L zsh
+    setopt extendedglob
+
+    # only 0 or 1 of those options may be proposed
+    local exlusive=3D"--append -a --increment -i --edit -e --release -r --=
newversion -v --fromdirname -d"
+   =20
+    local logheuristic=3D"looks for dupload or dput log file"
+    local changelogheuristic=3D"searchs for UNRELEASED in changelog"
+    local distribs=3D"unstable testing stable experimental UNRELEASED test=
ing-security stable-security oldstable-security"
+
+    _arguments \
+    '--create[create new debian/changelog]' \
+    '(--force-bad-version, -b)'{-b,--force-bad-version}'[allows version to=
 be less than current one]' \
+    '(--no-preserve --preserve -p)'{-p,--preserve}'[do preserve source tre=
e directory name]' \
+    '(--no-preserve --preserve -p)--no-preserve[do not preserve source tre=
e directory name]' \
+    '(--query)--noquery[do not contact BTS]' \
+    '(--noquery)--query[do contact BTS]' \
+    '(--multimaint)--nomultimaint[do not introduce multi-maintainer distin=
ctions]' \
+    '(--nomultimaint)--multimaint[do introduce multi-maintainer distinctio=
ns]' \
+    "($exlusive)"{-i,--increment}'[increment release or version number]' \
+    "($exlusive)"{-a,--append}'[add new changelog entry]' \
+    "($exlusive)"{-v,--newversion}'[specify new version number]:version:' \
+    "($exlusive)"{-e,--edit}'[update timestamp, and start editor]' \
+    "($exlusive)"{-r,--release}'[update timestamp. Possibly set distributi=
on]' \
+    '(--closes --news)--closes[add entries to close bugs]:bugs closed:' \
+    '(--changelog -c --closes -news)--news[edit newsfile]' \
+    '(--changelog -c --news)'{-c,--changelog}'[edit changelog]:changelog f=
ile:_files' \
+    '--release-heuristic[method to determine package release]:heuristic:((=
changelog\:$changelogheuristic log\:$logheuristic))' \
+    '--check-dirname-level[how to check directory]:level:((0\:never 1\:def=
ault 2\:always))' \
+    '--check-dirname-regex[regex for directory matching]:regexp:' \
+    '--package[package name]:name:' \
+    "($exlusive)"{-d,--fromdirname}'[get version from directory name]' \
+    '(--distribution -D)'{--distribution,-D}"[use specified distribution]:=
distribution:($distribs)" \
+    '(--urgency -u)'{--urgency,-u}'[specify urgency]:urgency:(low medium h=
igh critical emergency)' \
+    '(--maintmaint -m)'{--maintmaint,-m}'[do not modify maintainer in chan=
gelog]' \
+    '(--no-conf --noconf)'{--no-conf,--noconf}'[do not read any configurat=
ion files]' \
+    '(-h --help)'{-h,--help}'[display help information]' \
+    '--version[display version and copyright]' \
+    ':text:( )'
+
+}
+
+_debchange "$@"

--T4sUOijqQbZv57TR
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFFtl1ciH9aBScBsrMRAj1nAJ4mzb4YLIHUyZnaE0/xm1i/0YeI+QCePCJ0
E4mRSYYSUYk11LKWAa4musA=
=k0WC
-----END PGP SIGNATURE-----

--T4sUOijqQbZv57TR--

