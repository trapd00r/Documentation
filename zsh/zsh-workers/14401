From zsh-workers-return-14401-mason-zsh=primenet.com.au@sunsite.dk Sun May 20 10:23:41 2001
Return-Path: <zsh-workers-return-14401-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22653 invoked from network); 20 May 2001 10:23:39 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 20 May 2001 10:23:39 -0000
Received: (qmail 18183 invoked by alias); 20 May 2001 10:23:32 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14401
Received: (qmail 18161 invoked from network); 20 May 2001 10:23:30 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "ZSH Workers Mailing List" <zsh-workers@sunsite.dk>
Subject: RE: PATCH: workaround for "config.status not found" on Cygwin
Date: Sun, 20 May 2001 14:23:28 +0400
Message-ID: <002601c0e116$e8fd7a30$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_0027_01C0E138.7010A0D0"
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
In-Reply-To: <000201c0e10e$687feda0$21c9ca95@mow.siemens.ru>
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200

This is a multi-part message in MIME format.

------=_NextPart_000_0027_01C0E138.7010A0D0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit


>
> Cygwin can optionally use NTFS attributes to emulate Unix file permissions
> (CYGWIN=...ntea...). In this case file on NTFS must have x bit to be
> considered executable.

It is worse. I build off SAMBA drive and none file on the SAMBA is
considered executable in this case. It is O.K. if no ntea is set. So, this
patch extends (and replaces) the previous one by sticking $(SHELL) or
/bin/sh where possible.

-andrej

------=_NextPart_000_0027_01C0E138.7010A0D0
Content-Type: application/octet-stream;
	name="zsh.config.status.diff"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename="zsh.config.status.diff"

Index: Makefile.in=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/Makefile.in,v=0A=
retrieving revision 1.7=0A=
diff -u -r1.7 Makefile.in=0A=
--- Makefile.in	2001/02/14 17:58:11	1.7=0A=
+++ Makefile.in	2001/05/20 10:11:19=0A=
@@ -79,7 +79,7 @@=0A=
 install.fns:=0A=
 	if test x$(fndir) !=3D x && test x$(fndir) !=3D xno; then \=0A=
 	  test x$(sitefndir) !=3D xno && \=0A=
-	    $(sdir_top)/mkinstalldirs $(DESTDIR)$(sitefndir); \=0A=
+	    $(SHELL) $(sdir_top)/mkinstalldirs $(DESTDIR)$(sitefndir); \=0A=
 	  sdir_top=3D"$(sdir_top)" fndir=3D"$(fndir)" dir_top=3D"$(dir_top)" \=0A=
 	  FUNCTIONS_SUBDIRS=3D"$(FUNCTIONS_SUBDIRS)" \=0A=
 	  INSTALL_DATA=3D"$(INSTALL_DATA)" \=0A=
@@ -126,7 +126,7 @@=0A=
 config: config.h=0A=
 =0A=
 config.status: $(sdir)/configure=0A=
-	./config.status --recheck=0A=
+	$(SHELL) ./config.status --recheck=0A=
 =0A=
 $(sdir)/configure: $(sdir)/configure.in $(sdir)/aclocal.m4 =
$(sdir)/aczsh.m4=0A=
 	cd $(sdir) && autoconf=0A=
@@ -134,7 +134,7 @@=0A=
 config.h: stamp-h=0A=
 stamp-h: $(sdir)/config.h.in config.status=0A=
 	cd $(dir_top) && \=0A=
-	  CONFIG_FILES=3D CONFIG_HEADERS=3D$(subdir)/config.h ./config.status=0A=
+	  CONFIG_FILES=3D CONFIG_HEADERS=3D$(subdir)/config.h $(SHELL) =
./config.status=0A=
 =0A=
 $(sdir)/config.h.in: $(sdir)/stamp-h.in=0A=
 $(sdir)/stamp-h.in: $(sdir)/configure.in $(sdir)/acconfig.h \=0A=
Index: configure.in=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/configure.in,v=0A=
retrieving revision 1.57=0A=
diff -u -r1.57 configure.in=0A=
--- configure.in	2001/05/10 07:13:41	1.57=0A=
+++ configure.in	2001/05/20 10:11:20=0A=
@@ -1913,6 +1913,7 @@=0A=
 cp $CONFIG_STATUS $CONFIG_STATUS.old=0A=
 sed '1,$s@^\( *ac_file_inputs=3D\).*$@\1`echo $ac_file_in | sed -e =
"s%^%:%" -e "s%:\\([^!]\\)% $ac_given_srcdir/\\1%g" -e "s%:!% %"`@' \=0A=
  $CONFIG_STATUS.old >$CONFIG_STATUS=0A=
+ chmod +x $CONFIG_STATUS=0A=
  rm -f $CONFIG_STATUS.old]=0A=
 =0A=
 test "$real_no_create" =3D yes || ${CONFIG_SHELL-/bin/sh} =
$CONFIG_STATUS || exit 1=0A=
Index: Config/config.mk=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/Config/config.mk,v=0A=
retrieving revision 1.2=0A=
diff -u -r1.2 config.mk=0A=
--- Config/config.mk	2000/05/10 18:29:37	1.2=0A=
+++ Config/config.mk	2001/05/20 10:11:20=0A=
@@ -35,8 +35,8 @@=0A=
 =0A=
 Makefile: Makefile.in $(dir_top)/config.status $(CONFIG_INCS)=0A=
 	cd $(dir_top) && \=0A=
-	  CONFIG_FILES=3D$(subdir)/$@ CONFIG_HEADERS=3D ./config.status=0A=
+	  CONFIG_FILES=3D$(subdir)/$@ CONFIG_HEADERS=3D $(SHELL) =
./config.status=0A=
 =0A=
 $(dir_top)/Config/defs.mk: $(sdir_top)/Config/defs.mk.in =
$(dir_top)/config.status=0A=
 	cd $(dir_top) && \=0A=
-	  CONFIG_FILES=3DConfig/defs.mk CONFIG_HEADERS=3D ./config.status=0A=
+	  CONFIG_FILES=3DConfig/defs.mk CONFIG_HEADERS=3D $(SHELL) =
./config.status=0A=
Index: Config/installfns.sh=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/Config/installfns.sh,v=0A=
retrieving revision 1.7=0A=
diff -u -r1.7 installfns.sh=0A=
--- Config/installfns.sh	2001/04/02 16:49:25	1.7=0A=
+++ Config/installfns.sh	2001/05/20 10:11:20=0A=
@@ -2,7 +2,7 @@=0A=
 =0A=
 fndir=3D$DESTDIR$fndir=0A=
 =0A=
-$sdir_top/mkinstalldirs $fndir || exit 1;=0A=
+/bin/sh $sdir_top/mkinstalldirs $fndir || exit 1;=0A=
 =0A=
 allfuncs=3D"`grep ' functions=3D.' ${dir_top}/config.modules |=0A=
   sed -e '/^#/d' -e '/ link=3Dno/d' -e 's/^.* functions=3D//'`"=0A=
@@ -32,7 +32,7 @@=0A=
     else=0A=
       instdir=3D"$fndir"=0A=
     fi=0A=
-    test -d $instdir || $sdir_top/mkinstalldirs $instdir || exit 1=0A=
+    test -d $instdir || /bin/sh $sdir_top/mkinstalldirs $instdir || =
exit 1=0A=
     $INSTALL_DATA $sdir_top/$file $instdir || exit 1=0A=
   fi=0A=
 done=0A=
Index: Doc/Makefile.in=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/Doc/Makefile.in,v=0A=
retrieving revision 1.7=0A=
diff -u -r1.7 Makefile.in=0A=
--- Doc/Makefile.in	2000/12/05 05:07:52	1.7=0A=
+++ Doc/Makefile.in	2001/05/20 10:11:21=0A=
@@ -250,7 +250,7 @@=0A=
 =0A=
 # install man pages, creating install directory if necessary=0A=
 install.man: man=0A=
-	$(sdir_top)/mkinstalldirs $(DESTDIR)$(mandir)/man1=0A=
+	${SHELL} $(sdir_top)/mkinstalldirs $(DESTDIR)$(mandir)/man1=0A=
 	for file in $(MAN); do \=0A=
 	    $(INSTALL_DATA) $(sdir)/$$file $(DESTDIR)$(mandir)/man1/`echo =
$$file | sed 's|zsh|$(tzsh)|'` || exit 1; \=0A=
 	done=0A=
@@ -258,7 +258,7 @@=0A=
 =0A=
 # install info pages, creating install directory if necessary=0A=
 install.info: texi=0A=
-	$(sdir_top)/mkinstalldirs $(DESTDIR)$(infodir)=0A=
+	${SHELL} $(sdir_top)/mkinstalldirs $(DESTDIR)$(infodir)=0A=
 	rm -rf infodir=0A=
 	mkdir infodir=0A=
 	if ( \=0A=
@@ -296,7 +296,7 @@=0A=
 =0A=
 # install HTML manual=0A=
 install.html: html=0A=
-	$(sdir_top)/mkinstalldirs $(DESTDIR)$(htmldir)=0A=
+	${SHELL} $(sdir_top)/mkinstalldirs $(DESTDIR)$(htmldir)=0A=
 	for file in zsh_*.html; do \=0A=
 	    $(INSTALL_DATA) $$file $(DESTDIR)$(htmldir) || exit 1; \=0A=
 	done=0A=
Index: Src/Makefile.in=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/Src/Makefile.in,v=0A=
retrieving revision 1.10=0A=
diff -u -r1.10 Makefile.in=0A=
--- Src/Makefile.in	2001/04/23 19:59:04	1.10=0A=
+++ Src/Makefile.in	2001/05/20 10:11:21=0A=
@@ -161,7 +161,7 @@=0A=
 =0A=
 # install binary, creating install directory if necessary=0A=
 install.bin-here: zsh$(EXEEXT) $(INSTLIB)=0A=
-	$(sdir_top)/mkinstalldirs $(DESTDIR)$(bindir)=0A=
+	${SHELL} $(sdir_top)/mkinstalldirs $(DESTDIR)$(bindir)=0A=
 	$(INSTALL_PROGRAM) $(STRIPFLAGS) zsh$(EXEEXT) =
$(DESTDIR)$(bindir)/$(tzsh)-$(VERSION)$(EXEEXT)=0A=
 	if test -f $(DESTDIR)$(bindir)/$(tzsh)$(EXEEXT); then \=0A=
 	    rm -f $(DESTDIR)$(bindir)/$(tzsh).old; \=0A=
@@ -174,7 +174,7 @@=0A=
 =0A=
 install.bin-N:=0A=
 install.bin-L: $(LIBZSH)=0A=
-	$(sdir_top)/mkinstalldirs $(DESTDIR)$(libdir)/$(tzsh)=0A=
+	${SHELL} $(sdir_top)/mkinstalldirs $(DESTDIR)$(libdir)/$(tzsh)=0A=
 	$(INSTALL_PROGRAM) $(LIBZSH) $(DESTDIR)$(libdir)/$(tzsh)/$(LIBZSH)=0A=
 install.cygwin-lib: $(LIBZSH)=0A=
 	$(INSTALL_PROGRAM) $(LIBZSH) $(DESTDIR)$(bindir)/$(LIBZSH)=0A=
Index: Src/mkmakemod.sh=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/Src/mkmakemod.sh,v=0A=
retrieving revision 1.10=0A=
diff -u -r1.10 mkmakemod.sh=0A=
--- Src/mkmakemod.sh	2001/04/23 19:59:04	1.10=0A=
+++ Src/mkmakemod.sh	2001/05/20 10:11:22=0A=
@@ -320,7 +320,7 @@=0A=
 	    ;; esac=0A=
 	    instsubdir=3D`echo $name | sed 's,^,/,;s,/[^/]*$,,'`=0A=
 	    echo "install.modules.${mddname}: ${mddname}.\$(DL_EXT)"=0A=
-	    echo "	\$(sdir_top)/mkinstalldirs =
\$(DESTDIR)\$(MODDIR)${instsubdir}"=0A=
+	    echo "	\$(SHELL) \$(sdir_top)/mkinstalldirs =
\$(DESTDIR)\$(MODDIR)${instsubdir}"=0A=
 	    echo "	\$(INSTALL_PROGRAM) \$(STRIPFLAGS) ${mddname}.\$(DL_EXT) =
\$(DESTDIR)\$(MODDIR)/${name}.\$(DL_EXT)"=0A=
 	    echo=0A=
 	    echo "uninstall.modules.${mddname}:"=0A=
@@ -472,7 +472,7 @@=0A=
     # tree, this is a problem.  zsh's configure script edits =
config.status,=0A=
     # adding the feature that an input filename starting with "!" has =
the=0A=
     # "!" removed and is not mangled further.=0A=
-    =
CONFIG_FILES=3D$the_subdir/${the_makefile}:\!$the_subdir/${the_makefile}.=
in CONFIG_HEADERS=3D ./config.status=0A=
+    =
CONFIG_FILES=3D$the_subdir/${the_makefile}:\!$the_subdir/${the_makefile}.=
in CONFIG_HEADERS=3D ${CONFIG_SHELL-/bin/sh} ./config.status=0A=
 =0A=
 fi=0A=
 =0A=

------=_NextPart_000_0027_01C0E138.7010A0D0--

