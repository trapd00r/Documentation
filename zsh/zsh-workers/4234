From zsh-workers-request@math.gatech.edu Fri Jul 17 10:49:54 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 588 invoked from network); 17 Jul 1998 10:49:52 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 17 Jul 1998 10:49:52 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id GAA03491;
	Fri, 17 Jul 1998 06:42:39 -0400 (EDT)
Resent-Date: Fri, 17 Jul 1998 06:42:39 -0400 (EDT)
To: zsh-workers@math.gatech.edu
Path: mason
From: mason@primenet.com.au (Geoff Wing)
Newsgroups: lists.zsh.workers
Subject: Re: bug with chpwd/allexport
Date: 17 Jul 1998 10:44:21 GMT
Organization: PrimeNet Computer Consultants
Lines: 38
Message-ID: <slrn6quao5.e2.mason@coral.PrimeNet.com.au>
References: <35AF27D6.7362E041@hp.com>
Reply-To: mason@primenet.com.au
NNTP-Posting-Host: coral.primenet.com.au
X-Trace: coral.primenet.com.au 900672261 451 203.24.36.33 (17 Jul 1998 10:44:21 GMT)
X-Complaints-To: usenet@coral.primenet.com.au
NNTP-Posting-Date: 17 Jul 1998 10:44:21 GMT
X-Newsreader: slrn (0.9.5.2 UNIX)
Resent-Message-ID: <"893E63.0.Rs.Ugohr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4234
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Dominik Vogt <dominik_vogt@hp.com> typed:
:# export PS1='%~>'
:~ > setopt ALLEXPORT
:~ > setopt AUTONAMEDIRS
:~ > function chpwd () {
:> FOO=$PWD
:> echo $FOO
:> }
:~ > cd /etc
:/etc
:$FOO >
 ^^^^ You mean "~FOO >"

:There is a simple workaround:
:function chpwd () {
:     setopt LOCALOPTIONS
:     unsetopt AUTONAMEDIRS
:     unsetopt ALLEXPORT
:     FOO=$PWD
:     echo $FOO
:}

Simple workaround 1:
    chpwd () {
	echo $PWD
    }

Simple workaround 2 (in case we're only seeing a fragment of your chpwd() ):
    chpwd() {
	local FOO=$PWD
	echo $FOO
    }

BTW, do you have a good reason for setopt'ing ALL_EXPORT?  Why polute your
environment in that manner?
-- 
Geoff Wing   <gcw@pobox.com>            Mobile : 0412 162 441
Work URL: http://www.primenet.com.au/   Ego URL: http://pobox.com/~gcw/

