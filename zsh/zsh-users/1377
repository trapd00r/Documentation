From zsh-workers-request@math.gatech.edu Mon Mar 09 17:43:14 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 26415 invoked from network); 9 Mar 1998 17:43:13 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 9 Mar 1998 17:43:13 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id MAA29466;
	Mon, 9 Mar 1998 12:30:09 -0500 (EST)
Resent-Date: Mon, 9 Mar 1998 12:29:06 -0500 (EST)
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <980309093033.ZM9449@candle.brasslantern.com>
Date: Mon, 9 Mar 1998 09:30:33 -0800
In-Reply-To: <19980309180141.A4396@fax-hk.kappa.ro>
Comments: In reply to Mircea Damian <dmircea@mail.kappa.ro>
        "Re: question" (Mar  9,  6:01pm)
References: <19980309132719.A8586@fax-hk.kappa.ro> 
	<199803091148.LAA08838@taos.demon.co.uk> 
	<slrn6g7vhp.o10.mason@coral.primenet.com.au> 
	<19980309180141.A4396@fax-hk.kappa.ro>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Mircea Damian <dmircea@mail.kappa.ro>, zsh-users@math.gatech.edu
Subject: Re: question
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"COyr62.0.NB7.XR21r"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1377
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Mar 9,  6:01pm, Mircea Damian wrote:
} Subject: Re: question
}
} Another issue:
}  There is a problem in zsh-3.0.5 which I can't reproduce it. Sometimes, not
} very often, it happens to exit unexpectedly from my session.

Have you by any chance applied a patch for the HIST_REDUCE_BLANKS option?
The most recently posted version of that patch -- which was quite a while
ago, admittedly -- applies (IIRC) without rejections to zsh-3.0.x, but
introduces a bug that causes the shell to exit as soon as the length of
the history exactly equals HISTSIZE.  

However, I doubt that's the problem ... the only place in the code that
I can find that would print the string "logout" on the same line as the
prompt, like you showed here:

} dmircea@mail:/home/dmircea% logout

Is this bit of init.c:

	if (!(isset(IGNOREEOF) && interact)) {
#if 0
	    if (interact)
		fputs(islogin ? "logout\n" : "exit\n", stderr);
#endif
	    zexit(lastval, 0);
	    continue;
	}

That would mean that (1) you've changed the `#if 0' to get that code to
compile and (2) zsh is seeing end-of-file on the terminal.  You might want
to try "setopt ignoreeof" and just to see what happens.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

