From zsh-workers-request@math.gatech.edu Sun Apr 26 23:55:56 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11407 invoked from network); 26 Apr 1998 23:55:55 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 26 Apr 1998 23:55:55 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id TAA06271;
	Sun, 26 Apr 1998 19:48:22 -0400 (EDT)
Resent-Date: Sun, 26 Apr 1998 19:48:08 -0400 (EDT)
To: zsh-users@math.gatech.edu
Sender: monnier@TEQUILA.SYSTEMSZ.CS.YALE.EDU
From: Stefan Monnier <monnier+lists/zsh/users/news/@TEQUILA.SYSTEMSZ.CS.YALE.EDU>
Newsgroups: lists.zsh.users
Subject: tty settings
Date: 26 Apr 1998 19:48:06 -0400
Message-ID: <5l1zukkuvd.fsf@tequila.systemsz.cs.yale.edu>
Lines: 22
X-Newsreader: Gnus v5.5/Emacs 20.2
Path: tequila.systemsz.cs.yale.edu
NNTP-Posting-Host: tequila.systemsz.cs.yale.edu
Resent-Message-ID: <"IdSGw3.0.UX1.tUyGr"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1483
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu


When I use zsh inside an Emacs shell buffer, I get all kinds of ugly
^M's and echoing of the command.  By experimenting with other shells
I came to the conclusion that it's zsh's fault in that it changes the
tty settings (like 'echo').

Better yet, it seems that zsh resets the `echo' setting whenever a prompt is
displayed (and even if ttyctl is unfrozen):

    % ttyctl -u; stty -echo; stty -a | grep echo
    isig icanon iexten -echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke
    % stty -a | grep echo
    isig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke
    % ttyctl
    tty is not frozen
    % 

How can I convince zsh (3.0.5) not to mess around with the tty settings
in Emacs shells buffers (TERM=dumb) ?


	Stefan

