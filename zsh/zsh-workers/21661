From zsh-workers-return-21661-mason-zsh=primenet.com.au@sunsite.dk Thu Aug 18 10:06:49 2005
Return-Path: <zsh-workers-return-21661-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24716 invoked from network); 18 Aug 2005 10:06:47 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 Aug 2005 10:06:47 -0000
Received: (qmail 88014 invoked from network); 18 Aug 2005 10:06:41 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 Aug 2005 10:06:41 -0000
Received: (qmail 7302 invoked by alias); 18 Aug 2005 10:06:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21661
Received: (qmail 7293 invoked from network); 18 Aug 2005 10:06:38 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 18 Aug 2005 10:06:38 -0000
Received: (qmail 87743 invoked from network); 18 Aug 2005 10:06:38 -0000
Received: from mailhost1.csr.com (HELO MAILSWEEPER01.csr.com) (81.105.217.43)
  by a.mx.sunsite.dk with SMTP; 18 Aug 2005 10:06:31 -0000
Received: from exchange03.csr.com (unverified [10.100.137.60]) by 
    MAILSWEEPER01.csr.com (Content Technologies SMTPRS 4.3.12) with ESMTP id 
    <T72d5ab849f0a6c8d012e8@MAILSWEEPER01.csr.com> for 
    <zsh-workers@sunsite.dk>; Thu, 18 Aug 2005 11:04:19 +0100
Received: from news01 ([10.103.143.38]) by exchange03.csr.com with Microsoft 
    SMTPSVC (5.0.2195.6713); Thu, 18 Aug 2005 11:06:38 +0100
Date: Thu, 18 Aug 2005 11:06:35 +0100
From: Peter Stephenson <pws@csr.com>
To: zsh-workers@sunsite.dk
Subject: Re: PATCH: Re: zsh 4.2.5 segfaults when substituting on $match
Message-Id: <20050818110635.5570822e.pws@csr.com>
In-Reply-To: <237967ef05081800073a693560@mail.gmail.com>
References: <20050815203800.GA144@DervishD> 
    <20050817234259.AF914866A@pwstephenson.fsnet.co.uk> 
    <237967ef05081800073a693560@mail.gmail.com>
Organization: Cambridge Silicon Radio
X-Mailer: Sylpheed version 0.9.12 (GTK+ 1.2.10; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 18 Aug 2005 10:06:38.0084 (UTC) 
    FILETIME=[85AE1C40:01C5A3DC]
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

Mikael Magnusson <mikachu@gmail.com> wrote:
> > Index: Src/glob.c
> 
> This commit introduces a crash for me when i do 'export <tab>',
> reverting to 1.44 fixes the crash.

Sorry, that was plain stupidity.  The intention was to replace the file
static variable with an automatic, not a function static.

Index: Src/glob.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/glob.c,v
retrieving revision 1.45
diff -u -r1.45 glob.c
--- Src/glob.c	17 Aug 2005 23:45:32 -0000	1.45
+++ Src/glob.c	18 Aug 2005 10:04:15 -0000
@@ -2228,7 +2228,7 @@
      * ${...//#foo/bar} even though SUB_GLOBAL is set, since the match
      * is anchored.  It goes on the heap.
      */
-    static LinkList repllist = NULL;
+    LinkList repllist = NULL;
 
     /* perform must-match test for complex closures */
     if (p->mustoff)


-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


**********************************************************************
This email and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this email in error please notify
the system manager.

**********************************************************************

