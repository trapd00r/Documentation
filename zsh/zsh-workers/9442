From zsh-workers-return-9442-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jan 27 16:16:35 2000
Return-Path: <zsh-workers-return-9442-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26991 invoked from network); 27 Jan 2000 16:16:34 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Jan 2000 16:16:34 -0000
Received: (qmail 19416 invoked by alias); 27 Jan 2000 16:16:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9442
Received: (qmail 19408 invoked from network); 27 Jan 2000 16:16:28 -0000
Date: Thu, 27 Jan 2000 17:16:24 +0100 (MET)
Message-Id: <200001271616.RAA19570@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Thu, 27 Jan 2000 18:49:59 +0300
Subject: RE: dev-15: accept-and-menu-complete and suffix in braces


Andrej Borsenkow wrote:

> > Yes, we had. And I don't get the behaviour you describe (neither for
> > in-brace-completion nor anywhere else)... any funny option/style settings?
> >
> 
> itsrm2% compstyle '*:paths' cursor 'yes'

When inside a word it can't auto-remove the suffix and with
compstate[to_end]='' it didn't check if it was at the end...

Bye
 Sven

diff -ru ../z.old/Src/Zle/compresult.c Src/Zle/compresult.c
--- ../z.old/Src/Zle/compresult.c	Thu Jan 27 17:06:56 2000
+++ Src/Zle/compresult.c	Thu Jan 27 17:14:59 2000
@@ -719,7 +719,8 @@
 	/* We are currently not in a menu-completion, *
 	 * so set the position variables.             */
 	minfo.pos = wb;
-	minfo.we = (movetoend >= 2 || (movetoend == 1 && !menucmp));
+	minfo.we = (movetoend >= 2 || (movetoend == 1 && !menucmp) ||
+		    (!movetoend && cs == we));
 	minfo.end = we;
     }
     /* If we are already in a menu-completion or if we have done a *

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

