From zsh-users-return-3674-mason-zsh=primenet.com.au@sunsite.dk Thu Mar 15 09:49:06 2001
Return-Path: <zsh-users-return-3674-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15735 invoked from network); 15 Mar 2001 09:49:05 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Mar 2001 09:49:05 -0000
Received: (qmail 14516 invoked by alias); 15 Mar 2001 09:48:30 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 3674
Received: (qmail 14503 invoked from network); 15 Mar 2001 09:48:30 -0000
Date: Thu, 15 Mar 2001 10:46:25 +0100 (MET)
Message-Id: <200103150946.KAA23783@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-users@sunsite.dk
In-reply-to: John Cooper's message of 14 Mar 2001 15:53:46 +0000
Subject: Re: Odd behavior with ZLS_COLORS


John Cooper wrote:

> [ZSH_VERSION is 4.0.1-pre-2]
> 
> I have `zmodload zsh/complist' in my .zshrc file, but after attempting
> completion, my ZLS_COLORS variable seems to get cleared:
> 
>   % ZLS_COLORS=$LS_COLORS
>   % echo $ZLS_COLORS
>   di=1;31:ex=1;32:*.dll=1;32:*.java=1;33:*.c=1;33:*.html=1;33:*.htm=1;33:*.el=1;35:*.zip=1;35:*.gz=1;35:*.tar=1;35:*.jar=1;35:*.cab=1;35
>   % ls apacheTAB
>   ApacheJServ-1.1.2/  apache_1.3.14/    
>   % echo $ZLS_COLORS
> 
>   %
> 
> Oddly, the coloring of file names is identical to what I get with GNU `ls' with
> the sole exception that zsh completion gives me directories in blue, but ls
> shows them in red!

The obvious explanation is that somehow I got the builtin default
(hard-coded into complist.c -- ZLS_COLORS is set (i.e., in this case,
cleared) from the list-color style before the code that uses
$ZLS_COLORS) wrong.  And I love separating single words from the rest
of the sentence by long and nested parentheses.

Bye
 Sven

Index: Src/Zle/complist.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/complist.c,v
retrieving revision 1.39
diff -u -r1.39 complist.c
--- Src/Zle/complist.c	2001/01/18 14:41:40	1.39
+++ Src/Zle/complist.c	2001/03/15 09:42:15
@@ -76,7 +76,7 @@
 /* Default values. */
 
 static char *defcols[] = {
-    "0", "0", "1;34", "1;36", "33", "1;35", "1;33", "1;33", "1;32", NULL,
+    "0", "0", "1;31", "1;36", "33", "1;35", "1;33", "1;33", "1;32", NULL,
     "\033[", "m", NULL, "0", "0", "7", "0", "0"
 };
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

