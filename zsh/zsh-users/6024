From zsh-users-return-6024-mason-zsh=primenet.com.au@sunsite.dk Sun Apr 06 20:45:49 2003
Return-Path: <zsh-users-return-6024-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8406 invoked from network); 6 Apr 2003 20:45:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 Apr 2003 20:45:48 -0000
Received: (qmail 3486 invoked by alias); 6 Apr 2003 20:45:31 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6024
Received: (qmail 3478 invoked from network); 6 Apr 2003 20:45:30 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 6 Apr 2003 20:45:30 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [4.3.58.174] by sunsite.dk (MessageWall 1.0.8) with SMTP; 6 Apr 2003 20:45:30 -0000
Received: (from schaefer@localhost)
	by candle.brasslantern.com (8.11.6/8.11.6) id h36KjSt07832
	for zsh-users@sunsite.dk; Sun, 6 Apr 2003 13:45:28 -0700
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <1030406204528.ZM7831@candle.brasslantern.com>
Date: Sun, 6 Apr 2003 20:45:28 +0000
In-Reply-To: <lvrttw99lgmm.dlg@thorstenkampe.de>
Comments: In reply to Thorsten Kampe <thorsten@thorstenkampe.de>
        "Re: ZSH on Dos/Windows (long)" (Apr  6,  9:19pm)
References: <200304050139220710.001E4844@127.0.0.1> 
	<200304051059200520.000D11E0@127.0.0.1> 
	<m9fgfw9whykk$.dlg@thorstenkampe.de> 
	<200304051353440930.00ACC4C4@127.0.0.1> 
	<1e2co8dovf08r.dlg@thorstenkampe.de> 
	<200304061248380080.0081454B@127.0.0.1> 
	<lvrttw99lgmm.dlg@thorstenkampe.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-users@sunsite.dk
Subject: Re: ZSH on Dos/Windows (long)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Having a few free minutes and a much larger disk recently installed
on my Windows box, I decided to fiddle with Cygwin a bit.

Aside:  The cygwin installer created C:\{bin,usr,lib}\ even though I
told it to use C:\Cygwin\ as root.  Those directories are all empty;
the installed files went correctly into C:\Cygwin\{bin,usr,lib,etc}\

First thing I noticed is that many of the zsh functions (in $fpath)
don't get very far if you haven't installed the fileutils and sh-utils
packages.  So I went back and installed them.

I also installed termcap and terminfo, (lack of) which may have some
bearing on the problems Luciano is having.

Second thing I noticed is that the PATH is not set up correctly if you
start zsh directly (as opposed to starting bash first and then running
zsh from there).  This is the fault of whoever built the zsh package
for cygwin, not of zsh itself.

Third thing: as usual, bash exports PS1, so the prompt looks stupid if
you start zsh from bash.

Fourth: Colored prompts work fine.  I did
	autoload -U promptinit
	promptinit
	prompt -p
and the only prompts that didn't display properly are the ones that need
perl to compute some of their components.  I'm now using "prompt bart"
(how surprising).

This makes me wonder how Luciano is starting up zsh.

Fifth: zkbd doesn't work, because "read -t" doesn't work and because each
new "read -k" discards typeahead.  I hacked it a bit (leaving it unusable
for anyone who doesn't know what I did, so I'm not going to post it) and
used it to generate the appended file.

It appears from Thorsten's message that there may be different sequences
when the shift or control keys are pressed, because I don't know what
generates e.g. "^[Od" (which Thorsten bound to backward-word).

Sixth:  The command `: **/*' from /cygdrive/c did indeed take several
minutes ... long enough that I went to do something else and didn't
notice exactly how long.

---- 8< ---- $HOME/.zkbd/cygwin-pc-cygwin ---- 8< ----
typeset -g -A key

key[F1]='^[[[A'
key[F2]='^[[[B'
key[F3]='^[[[C'
key[F4]='^[[[D'
key[F5]='^[[[E'
key[F6]='^[[17'
key[F7]='^[[18'
key[F8]='^[[19'
key[F9]='^[[20'
key[F10]='^[[21'
key[F11]='^[[23'
key[F12]='^[[24'
key[Backspace]='^H'
key[Insert]='^[[2~'
key[Home]='^[[1~'
key[PageUp]='^[[5~'
key[Delete]='^[[3~'
key[End]='^[[4~'
key[PageDown]='^[[6~'
key[Up]='^[[A'
key[Left]='^[[D'
key[Down]='^[[B'
key[Right]='^[[C'

bindkey "$key[Delete]" delete-char
bindkey "$key[Home]" beginning-of-line
bindkey "$key[End]" end-of-line
---- 8< ---- snip ---- 8< ----

