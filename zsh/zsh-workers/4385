From zsh-workers-request@math.gatech.edu Tue Sep 15 22:19:26 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26751 invoked from network); 15 Sep 1998 22:19:25 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 15 Sep 1998 22:19:25 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id SAA23680;
	Tue, 15 Sep 1998 18:12:41 -0400 (EDT)
Resent-Date: Tue, 15 Sep 1998 18:12:41 -0400 (EDT)
Message-Id: <m0zJ3N1-000X3MC@mailgw.approve.se>
Date: Wed, 16 Sep 1998 00:14:47 +0200 (MET-DST)
From: Goran Larsson <hoh@lorelei.approve.se>
Subject: select behaving strange in 3.1.4
To: zsh-workers@math.gatech.edu
MIME-Version: 1.0
Content-Type: TEXT/plain; CHARSET=US-ASCII
Resent-Message-ID: <"Z810b2.0.xn5.PPk_r"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4385
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Look at this:

$ echo $ZSH_VERSION
3.1.4
$ 
$ cat select_weirdness
#!/usr/local/bin/zsh

PROMPT3="What now?"
select junk in A B C; do
        echo $junk
done
$ 
$ ./select_weirdness
1) A  2) B  3) C
What now?^D                                        <-- enter control-D
$ 
$ . ./select_weirdness
1) A  2) B  3) C
What now?^D                                        <-- enter control-D
zsh: do you wish to see all 1120 possibilities? y  <-- enter y
[[[ list of 1120 executable files, shell builtins, et.al. ]]]
What now?^G                                        <-- enter control-G
$ 

The zshmisc.1 manpage says about select that

 "list is executed for each selection until a break or
  end-of-file is encountered."

Now, the control-D did not act as end-of-file here and control-G
isn't mentioned in the manpage, so what is going on?

Even more weird is that by entering this another anomaly shows up:

$ . ./select_weirdness
1) A  2) B  3) C
What now?^C                                        <-- enter control-C
$ 
$ . ./select_weirdness
1) A  2) B  3) C
What now?2                                         <-- enter 2
B
What now?^D                                        <-- enter control-D
zsh: do you wish to see all 1120 possibilities? n  <-- enter n
What now?^C                                        <-- enter control-C

At this point control-C has stopped working and control-D only
asks stupid questions. No documented way out of select works, so
I have to use the undocumented control-G.

What now?^G                                        <-- enter control-G
$ 

Who broke select, and why?

-- 
 Goran Larsson            hoh@approve.se
 I was an atheist,        http://home1.swipnet.se/%7Ew-12153/
 until I found out I was God.


