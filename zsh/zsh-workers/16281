From zsh-workers-return-16281-mason-zsh=primenet.com.au@sunsite.dk Fri Nov 23 02:39:11 2001
Return-Path: <zsh-workers-return-16281-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14122 invoked from network); 23 Nov 2001 02:39:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 23 Nov 2001 02:39:09 -0000
Received: (qmail 29090 invoked by alias); 23 Nov 2001 02:38:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16281
Received: (qmail 29078 invoked from network); 23 Nov 2001 02:38:56 -0000
Message-ID: <3BFDB6BB.3070505@oberbrunner.com>
Date: Thu, 22 Nov 2001 21:38:51 -0500
From: Gary Oberbrunner <garyo@oberbrunner.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:0.9.6) Gecko/20011120
X-Accept-Language: en-us
MIME-Version: 1.0
To: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
CC: zsh-workers@sunsite.dk
Subject: Re: Zsh 4.0.4 and Emacs 21.1 in Windows XP
References: <000001c17348$9794de80$21c9ca95@mow.siemens.ru>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit

Borsenkow Andrej wrote:

>Probably, you are using native emacs and Cygwin zsh. In this case emacs
>writes pipe to zsh in text mode (CR-LF under DOS) and zsh reads it in
>binary mode (default for pipes under Cygwin). Please, look on
>www.cygwin.com for description of CYGWIN variable, specifically
>nobinmode. But I have no idea what effects may it have - it makes Cygwin
>read/write pipes in text (in DOS sense) mode which is O.K. for pure text
>but may break binary data.
>
>In general it is bad idea to mix native and Cygwin applications.
>
Yes, I think you nailed it here; my Emacs is compiled natively for 
Win32, and I guess zsh must be compiled with cygwin (I don't remember). 
 And what you describe above sounds like it could be the cause -- I've 
traced it quite thoroughly in emacs and it's definitely NOT sending a 
CR, only LF.  So it must be zsh/cygwin that's adding the CR.  Maybe I 
can add an option to zsh to strip off trailing CRs -- can anyone point 
me to where to start looking?  input.c maybe?

Thanks,

-- Gary Oberbrunner (garyo@genarts.com)

