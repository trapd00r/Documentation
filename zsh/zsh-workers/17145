From zsh-workers-return-17145-mason-zsh=primenet.com.au@sunsite.dk Tue May 14 07:45:18 2002
Return-Path: <zsh-workers-return-17145-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7481 invoked from network); 14 May 2002 07:45:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 14 May 2002 07:45:17 -0000
Received: (qmail 25637 invoked by alias); 14 May 2002 07:45:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17145
Received: (qmail 25622 invoked from network); 14 May 2002 07:45:07 -0000
From: Sven Wischnowsky <wischnow@berkom.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15584.49227.780505.590251@wischnow.berkom.de>
Date: Tue, 14 May 2002 09:44:11 +0200
To: zsh-workers@sunsite.dk
Subject: Re: completion in quotes - " vs ' - no suffix added
In-Reply-To: <1021313089.2926.10.camel@localhost.localdomain>
References: <15576.54689.459113.686818@wischnow.berkom.de>
	<6134254DE87BD411908B00A0C99B044F02E89A73@mowd019a.mow.siemens.ru>
	<15577.7296.682622.411849@wischnow.berkom.de>
	<1020508153855.ZM7837@candle.brasslantern.com>
	<15583.34740.981994.404489@wischnow.berkom.de>
	<6134254DE87BD411908B00A0C99B044F02E89A8C@mowd019a.mow.siemens.ru>
	<1020513173320.ZM12360@candle.brasslantern.com>
	<1021313089.2926.10.camel@localhost.localdomain>
X-Mailer: VM 6.95 under 21.5 (patch 3) "asparagus" XEmacs Lucid


Borsenkow Andrej wrote:

> ...
> 
> so correctly escaped filename is inserted but is not unquoted when
> testing for file type.

That's exactly the point -- the code in compresult.c responsible for
this is *very* old and, ahem, hasn't been updated for this. The patch
I sent is only for the quoting issues Bart described in the mail I
replied to, not for the file-testing code -- it was already hard
enough without that ;-}

> > One oddity is that typing the closing quote after `ls "a\\ d/' does not
> > auto-remove the slash, but I don't think that's strictly a bug.
> >
> 
> May be it should; but then it becomes increasingly more complicated with
> nested quotes. Besides, you may want to continue quoted word ...

I think we decided against it exactly for this reason. I'll have more
to say about this when I start talking about what we can do to improve
suffix handling.


So the next steps are to get the file-type testing right. I'd like to
do that more thoroughly to finally be able to implement this other
thing we've been talking about, where a space as a file-type character
(with LIST_TYPES) isn't counted to allow tighter packing of rows in
listings.

That's also the reason why I haven't tried to change the difference in
quoting in listings Andrej pointed out. To repeat: we meant to make it
always be quoted. But with display strings and what not the shell code
is able to defeat this. Personally, I prefer it this way, so we might
want to make this be controlled by a style. But then the shell code
would be responsible to handle different quoting behaviour in some
cases, namely: whenever it uses display strings. If there are no
display strings, the C-code could use them internally for the unquoted
form.

Do others have any opinions on this?


Bye
  Sven

-- 
Sven Wischnowsky                          wischnow@berkom.de

