From zsh-workers-return-15540-mason-zsh=primenet.com.au@sunsite.dk Mon Jul 30 17:17:16 2001
Return-Path: <zsh-workers-return-15540-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17563 invoked from network); 30 Jul 2001 17:17:15 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Jul 2001 17:17:15 -0000
Received: (qmail 4078 invoked by alias); 30 Jul 2001 17:17:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15540
Received: (qmail 4053 invoked from network); 30 Jul 2001 17:17:04 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
From: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
To: Adam Spiers <adam@spiers.net>
Cc: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Message-ID: <3B6597A1.4060603@mow.siemens.ru>
Date: Mon, 30 Jul 2001 21:21:37 +0400
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.2) Gecko/20010628
X-Accept-Language: en-us
MIME-Version: 1.0
Subject: Re: location of pcre.h
References: <20010730153817.A16119@thelonious.new.ox.ac.uk> <007d01c11906$5ad4acb0$21c9ca95@mow.siemens.ru> <20010730155528.B16163@thelonious.new.ox.ac.uk>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit

Adam Spiers wrote:

> Borsenkow Andrej (Andrej.Borsenkow@mow.siemens.ru) wrote:
> 
>>Do they have anything else in /usr/include/pcre? Else I'd call this broken
>>(yet another thing in 7.0).
>>
> 
> Yes, pcreposix.h is also there.
> 
> 
>>Obvious fix is to check for both pcre.h and pcre/pcre.h and take whatever
>>exists
>>
>>#ifdef HAVE_PCRE_H
>>#include <pcre.h>
>>#else
>>#ifdef HAVE_PCRE_PCRE_H - ick!
>>#include <pcre/pcre.h>
>>#else
>>#error pcre not found
>>#endif
>>#endif
>>
> 
> Yep.  Presumably this needs some autoconf wizardry to set
> HAVE_PCRE_PCRE_H in the first place, which is where I get lost ...
> 


Just add it to AC_CHECK_HEADERS(...), near pcre.h.


> 
>>Additionally, pcre should be compiled conditionally only if prerequisites
>>are found (compare termcap.mdd or terminfo.mdd).
>>
> 
> There must be a bug in that too then, because I get
> 
>   checking for pcre.h... no
> 
> 


There is probably no bug. I meant "we should add code to pcre.mdd to 
conditionally compile it", not that it is already there. Currently it is 
unconditional.

Ideally, it would be nice to have some high level means to specify 
conditions ... probably something like

need_headers="pcre.h"
need_libraries="perl.so"

or like. It is better to no add any autoconf-dependent code to mdd files.

-andrej



