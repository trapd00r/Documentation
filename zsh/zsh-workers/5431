From zsh-workers-return-5431-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Feb 19 14:21:21 1999
Return-Path: <zsh-workers-return-5431-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6162 invoked from network); 19 Feb 1999 14:21:20 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Feb 1999 14:21:20 -0000
Received: (qmail 28692 invoked by alias); 19 Feb 1999 14:20:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5431
Received: (qmail 28684 invoked from network); 19 Feb 1999 14:20:53 -0000
Reply-To: <probin@qnx.com>
From: "Philippe Robin" <probin@qnx.com>
To: <zsh-workers@math.gatech.edu>
Subject: zsh on QNX4
Date: Fri, 19 Feb 1999 14:15:04 -0000
Message-ID: <000001be5c12$3f07e000$089d9e9f@philippe.qssl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook 8.5, Build 4.71.2173.0
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V4.72.2106.4

Hi ,

I got zsh running on QNX 4.25 operating system. I have included the few
modifications I did to get it to work at the end of this mail if you want to
incorporate this...

Feel free to contact me if you have any queries.

Thanks,

Philippe
---------------
Philippe Robin
e-mail: probin@qnx.com

############################
zsh.h:

#define GETPGRP_VOID

#include <config.h>
#include <system.h>

#define QNX
#undef OXTABS

---------
zle_refresh.c line 231

#ifdef QNX
    oxtabs = 0;
#else
    oxtabs = ((SGTTYFLAG & SGTABTYPE) == SGTABTYPE);
#endif

----------
zle_main.c line 103 (XTABS and ONLCR flags not defined on QNX)

#  ifdef OXTABS
    ti.tio.c_oflag &= ~OXTABS;
#  else
//    ti.tio.c_oflag &= ~XTABS;
#  endif
# endif
//    ti.tio.c_oflag |= ONLCR;

--------------
compat.c line 109

#ifndef QNX
char *
zgetcwd(void)
{
    return getcwd(NULL, 0);
}
#else
char *
zgetcwd(void)
{
....
}
#endif
-----------------
halloc() is already defined on QNX with the following prototype:
void __huge *halloc( long int numb, size_t size );

so the halloc() function must either be renamed in files where it
is used so that it doesn't clash with the system one or alternatively
use the system function.

The files concerned are:
mem.c, subst.c, utils.c, zle_hist.c, zle_misc.c, zle_tricky.c,
zle_utils.c, zle_word.c



