From zsh-workers-return-28790-mason-zsh=primenet.com.au@zsh.org Tue Feb 22 00:18:13 2011
Return-Path: <zsh-workers-return-28790-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1478 invoked by alias); 22 Feb 2011 00:18:12 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28790
Received: (qmail 8066 invoked from network); 22 Feb 2011 00:18:10 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.3.1
Received-SPF: none (ns1.primenet.com.au: domain at hightek.org does not designate permitted sender hosts)
Date: Mon, 21 Feb 2011 18:18:01 -0600
From: Vincent Stemen <vince.lists@hightek.org>
To: zsh-workers@zsh.org
Subject: Re: Installation fails because the documentation is not building
Message-ID: <20110222001801.GA19390@quark.hightek.org>
References: <20110221031449.GA5748@quark.hightek.org> <AANLkTin6ZDDw0R=JryDQSOy4+GOdndEQ58+VVDFeMouM@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <AANLkTin6ZDDw0R=JryDQSOy4+GOdndEQ58+VVDFeMouM@mail.gmail.com>
User-Agent: Mutt/1.5.18 (2008-05-17)
Sender: Vincent Stemen <vince@hightek.org>

On Sun, Feb 20, 2011 at 09:55:51PM -0800, Wayne Davison wrote:
> On Sun, Feb 20, 2011 at 7:14 PM, Vincent Stemen <vince.lists@hightek.org>wrote:
> 
> > I assume it is failing on the "test -s" statement, because when I look in
> > the
> > Doc directory, all the man files ending in ".1" are zero length.
> >
> 
> The Doc Makefile will create 0-length *.1 files if it doesn't think that
> yodl is around. Perhaps you ran make before yodl was installed, and didn't
> remove those files?  It looks like only a "make realclean"  will remove the
> *.1 files (and you'd probably want to just manually remove the *.1 files
> instead of going to that extreme).
> 
> I'm not sure why none of the lesser clean targets will clean up the *.1
> files, though.  Maybe it is to help folks who don't have yodl installed and
> get the *.1 files manually?
> 
> ..wayne..

Ah.  Yes, that was the problem.  Manually removing them worked.  Thanks.  

Yes, I did build from the repo source prior to installing yodl for
testing the sh compatibility patches.  

Seems to me that the installation code could use some improvement here.
The build was successful without yodl but the installation was not,
which was not really a surprise.  However, after installing yodl, the
installation still failed.  Even after doing a make clean or make
distclean, and reconfiguring.  That's not a very intuitive behavior.  

If those empty files are going to be created, I would suggest, when it
checks if they are empty, if yodl is installed, then automatically
delete and re-build them.  

You might also consider, if yodl is not installed, rather than exiting
with an error, perhaps printing a message to stderr that they are being
skipped and why, then continuing without error.  If you prefer it to
exit with an error by default in this case, then perhaps print a message
providing an alternate installation target that can be used to install
without the man pages.

Vince

