From zsh-users-return-8549-mason-zsh=primenet.com.au@sunsite.dk Sat Feb 26 13:32:09 2005
Return-Path: <zsh-users-return-8549-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3419 invoked from network); 26 Feb 2005 13:32:08 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Feb 2005 13:32:08 -0000
Received: (qmail 94662 invoked from network); 26 Feb 2005 13:32:03 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Feb 2005 13:32:03 -0000
Received: (qmail 19659 invoked by alias); 26 Feb 2005 13:31:46 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8549
Received: (qmail 19643 invoked from network); 26 Feb 2005 13:31:46 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 26 Feb 2005 13:31:46 -0000
Received: (qmail 93487 invoked from network); 26 Feb 2005 13:31:46 -0000
Received: from smtprelay01.ispgateway.de (80.67.18.13)
  by a.mx.sunsite.dk with SMTP; 26 Feb 2005 13:31:42 -0000
Received: (qmail 31711 invoked from network); 26 Feb 2005 13:31:41 -0000
Received: from unknown (HELO twoflower.home.noschinski.de) (336680@[80.130.121.101])
          (envelope-sender <lars@public.noschinski.de>)
          by smtprelay01.ispgateway.de (qmail-ldap-1.03) with SMTP
          for <zsh-users@sunsite.dk>; 26 Feb 2005 13:31:41 -0000
Received: by twoflower.home.noschinski.de (Postfix, from userid 1000)
	id 05A41ACA1B; Sat, 26 Feb 2005 14:31:57 +0100 (CET)
Date: Sat, 26 Feb 2005 14:31:56 +0100
From: Lars Noschinski <lars@public.noschinski.de>
To: zsh-users@sunsite.dk
Subject: Programable subversion completion depends on locale
Message-ID: <20050226133156.GA32380@twoflower>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: mutt-ng 1.5.8i (Linux)
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

Hello!

The subversion completions uses the output of 'svn help' to generate a
list of available subversion commands. But as 'svn help' is run with the
users locale settings, the completion doesn't work with non-english
locales.

I've little experience with shell programming, but adding

---- add Completion/Base/_call_program_li ----------------------
#autoload +X

local tmp

if zstyle -s ":completion:${curcontext}:${1}" command tmp; then
  if [[ "$tmp" = -* ]]; then
    eval LC_ALL=C "$tmp[2,-1]" "$argv[2,-1]"
  else
    eval LC_ALL=C "$tmp"
  fi
else
  eval LC_ALL=C "$argv[2,-1]"
fi
----------------------------------------------------------------

and replacing "_call_program" with "_call_program_li" in
Completion/Unix/_subversion fixes the problem for me.

