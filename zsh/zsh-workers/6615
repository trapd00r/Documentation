From zsh-workers-return-6615-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 14 08:51:52 1999
Return-Path: <zsh-workers-return-6615-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27990 invoked from network); 14 Jun 1999 08:51:51 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 14 Jun 1999 08:51:51 -0000
Received: (qmail 4185 invoked by alias); 14 Jun 1999 08:49:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6615
Received: (qmail 4172 invoked from network); 14 Jun 1999 08:49:46 -0000
To: zsh-workers@sunsite.auc.dk
Path: mason
From: mason@primenet.com.au (Geoff Wing)
X-Newsgroups: lists.zsh.workers
Subject: Re: BUG: 3.1.5-pws-21: lfs
Date: 14 Jun 1999 08:49:36 GMT
Organization: PrimeNet Computer Consultants
Lines: 27
Distribution: local
Message-ID: <slrn7m9gh0.r33.mason@coral.primenet.com.au>
References: "Geoff Wing"'s message of "14 Jun 1999 08:08:42 NFT." <9906140749.AA31296@ibmth.df.unipi.it>
Reply-To: mason@primenet.com.au
NNTP-Posting-Host: coral.primenet.com.au
X-Trace: coral.primenet.com.au 929350176 27907 203.43.15.2 (14 Jun 1999 08:49:36 GMT)
X-Complaints-To: usenet@coral.primenet.com.au
NNTP-Posting-Date: 14 Jun 1999 08:49:36 GMT
User-Agent: slrn/0.9.5.6 (UNIX)

Peter Stephenson <pws@ibmth.df.unipi.it> typed:
:Geoff Wing wrote:
:> :I get a near continuous spew out of:
:> :	BUG: attempt to free storage at invalid address
:> Occurs due to malloc() not aligning on M_ALIGN.
:Any chance you could find out where in zsh's malloc() this is happening?
:It's probably something like one of the structs m_hdr, m_shdr or heap not
:having a size divisible by 8. I altered definitions of structures and sizes
:to get this to work on one system (IRIX 6.2 with gcc), so there is some
:compiler/system dependency here.

Possibly something much simpler.

% size zsh
text    data    bss     dec     hex     filename
290784  16384   31524   338692  52b04   zsh

First time through malloc():
 (m = sbrk(4096)) @ mem.c:760  gives   m = 0x53b24

Yay.

Regards,
-- 
Geoff Wing : <gcw@pobox.com>     Work URL: http://www.primenet.com.au/
Rxvt Stuff : <gcw@rxvt.org>      Ego URL : http://pobox.com/~gcw/
Zsh Stuff  : <gcw@zsh.org>       Phone   : (Australia) 0413 431 874

