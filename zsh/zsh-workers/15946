From zsh-workers-return-15946-mason-zsh=primenet.com.au@sunsite.dk Fri Oct 05 12:42:56 2001
Return-Path: <zsh-workers-return-15946-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7328 invoked from network); 5 Oct 2001 12:42:55 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 5 Oct 2001 12:42:55 -0000
Received: (qmail 7332 invoked by alias); 5 Oct 2001 12:42:49 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15946
Received: (qmail 7321 invoked from network); 5 Oct 2001 12:42:48 -0000
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15293.43718.912158.772235@gargle.gargle.HOWL>
Date: Fri, 5 Oct 2001 14:42:46 +0200
To: zsh-workers@sunsite.dk
Subject: Re: file completion listing in 4.1.0-dev-2
In-Reply-To: <OFC93C48F6.437F16D4-ON80256ADC.0039266F@uk.jpmorgan.com>
References: <OFC93C48F6.437F16D4-ON80256ADC.0039266F@uk.jpmorgan.com>
X-Mailer: VM 6.92 under 21.1 (patch 3) "Acadia" XEmacs Lucid


martin.ebourne@arcordia.com wrote:

> Also, if I do the below, then I get the blank line in the listing as
> indicated, and the cursor is left incorrectly where the '#' is (the
> character is really an 'e' under the cursor). This works correctly in
> zsh-4.1.0-dev-1.

Oops.  It thought it needed more columns and printed two runs of
spaces instead of one.


Bye
  Sven

Index: Src/Zle/compresult.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/compresult.c,v
retrieving revision 1.41
diff -u -r1.41 compresult.c
--- Src/Zle/compresult.c	2001/08/08 07:41:04	1.41
+++ Src/Zle/compresult.c	2001/10/05 12:35:37
@@ -1717,8 +1717,11 @@
                                 ws[tcol] = len;
                             }
                         }
-                        if (width < columns)
+                        if (width < columns) {
+                            if (++tcol < tcols)
+                                tcols = tcol;
                             break;
+                        }
                     }
 		}
 	    }

-- 
Sven Wischnowsky                    wischnow@informatik.hu-berlin.de

