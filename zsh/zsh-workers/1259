From A.Main@dcs.warwick.ac.uk Wed Jun  5 01:54:02 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id BAA26994 for <mason@werple.mira.net.au>; Wed, 5 Jun 1996 01:54:01 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id LAA07061; Tue, 4 Jun 1996 11:44:49 -0400 (EDT)
Resent-Date: Tue, 4 Jun 1996 11:44:49 -0400 (EDT)
From: Zefram <A.Main@dcs.warwick.ac.uk>
Message-Id: <2063.199606041544@downwind.dcs.warwick.ac.uk>
Subject: Some display fixes in hashtable.c
To: zsh-workers@math.gatech.edu (Z Shell workers mailing list)
Date: Tue, 4 Jun 1996 16:44:24 +0100 (BST)
X-Patch: 103
X-Loop: zefram@dcs.warwick.ac.uk
X-Stardate: [-31]7608.27
X-US-Congress: Moronic fuckers
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"Eecs63.0.Fk1.md5jn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1259
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 2651
Status: OR

-----BEGIN PGP SIGNED MESSAGE-----

One of my recent patches broke a couple of display formats in hashtable.c.
The symptoms are that command hash table entries lose their filename
(sometimes garbage appears instead), and array values as output by "set"
look like "foo=(bar bazquux )" instead of "foo=(bar baz quux)".

 -zefram

      Index: Src/hashtable.c
      *** hashtable.c	1996/05/18 10:21:03	1.3
      --- hashtable.c	1996/06/04 13:33:28
      ***************
      *** 602,608 ****
        	} else {
        	    zputs(*(cn->u.name), stdout);
        	    putchar('/');
      ! 	    zputs(cn->u.cmd, stdout);
        	    putchar('\n');
        	}
        	return;
      --- 602,608 ----
        	} else {
        	    zputs(*(cn->u.name), stdout);
        	    putchar('/');
      ! 	    zputs(cn->nam, stdout);
        	    putchar('\n');
        	}
        	return;
      ***************
      *** 619,625 ****
        	    printf(" is ");
        	    nicezputs(*(cn->u.name), stdout);
        	    putchar('/');
      ! 	    nicezputs(cn->u.cmd, stdout);
        	    putchar('\n');
        	}
        	return;
      --- 619,625 ----
        	    printf(" is ");
        	    nicezputs(*(cn->u.name), stdout);
        	    putchar('/');
      ! 	    nicezputs(cn->nam, stdout);
        	    putchar('\n');
        	}
        	return;
      ***************
      *** 635,641 ****
        	putchar('=');
        	quotedzputs(*(cn->u.name), stdout);
        	putchar('/');
      ! 	quotedzputs(cn->u.cmd, stdout);
        	putchar('\n');
            }
        }
      --- 635,641 ----
        	putchar('=');
        	quotedzputs(*(cn->u.name), stdout);
        	putchar('/');
      ! 	quotedzputs(cn->nam, stdout);
        	putchar('\n');
            }
        }
      ***************
      *** 1074,1083 ****
        	/* array */
        	putchar('(');
        	u = p->gets.afn(p);
      ! 	while (*u) {
        	    quotedzputs(*u++, stdout);
      ! 	    if(u[1])
        		putchar(' ');
        	}
        	printf(")\n");
        	break;
      --- 1074,1085 ----
        	/* array */
        	putchar('(');
        	u = p->gets.afn(p);
      ! 	if(*u) {
        	    quotedzputs(*u++, stdout);
      ! 	    while (*u) {
        		putchar(' ');
      + 		quotedzputs(*u++, stdout);
      + 	    }
        	}
        	printf(")\n");
        	break;

-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBMbQ8dnD/+HJTpU/hAQF50gP/fJ/odL70wZ/ggphkI8MNeirhP/oqe75z
llfFR7aEEKwfH8QJGm3X9okYJTEhGaLcwJgvm0+fko1agpCUUg13lTvhcnLWGKTo
QwdmcivG5e5li9RyzePhZcyr9cfQChWhwBccGu6mVwYe+EuGSgtTGwWe8bmfC8wt
uQ4xKY3bQt0=
=3SPO
-----END PGP SIGNATURE-----


