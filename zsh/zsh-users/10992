From zsh-users-return-10992-mason-zsh=primenet.com.au@sunsite.dk Thu Nov 16 08:48:47 2006
Return-Path: <zsh-users-return-10992-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26949 invoked from network); 16 Nov 2006 08:48:39 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.0 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO,
	NO_REAL_NAME,PLING_QUERY,UNPARSEABLE_RELAY autolearn=no version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 Nov 2006 08:48:39 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 38073 invoked from network); 16 Nov 2006 08:48:30 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Nov 2006 08:48:30 -0000
Received: (qmail 12387 invoked by alias); 16 Nov 2006 08:48:17 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 10992
Received: (qmail 12377 invoked from network); 16 Nov 2006 08:48:17 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 16 Nov 2006 08:48:17 -0000
Received: (qmail 36234 invoked from network); 16 Nov 2006 08:48:16 -0000
Received: from max71.rrze.uni-erlangen.de (131.188.3.181)
  by a.mx.sunsite.dk with SMTP; 16 Nov 2006 08:48:13 -0000
Received: from max71.rrze.uni-erlangen.de (max71.rrze.uni-erlangen.de [131.188.3.181]) by max71.rrze.uni-erlangen.de with ESMTP for zsh-users@sunsite.dk; Thu, 16 Nov 2006 09:46:47 +0100
Received: from max71.rrze.uni-erlangen.de ([131.188.3.181])
 by max71.rrze.uni-erlangen.de (max71.rrze.uni-erlangen.de [127.0.0.1]) (amavisd-new)
 with ESMTP id 24830-04-1962 for <zsh-users@sunsite.dk>;
 Thu, 16 Nov 2006 09:46:47 +0100 (MET)
Received: from biochem.uni-erlangen.de ([131.188.174.10] [131.188.174.10]) by mailhub.rrze.uni-erlangen.de with ESMTP for zsh-users@sunsite.dk; Thu, 16 Nov 2006 09:46:47 +0100
Received: from BIOCHEM2/SpoolDir by biochem.uni-erlangen.de (Mercury 1.48);
    16 Nov 06 09:46:40 +0100
Received: from SpoolDir by BIOCHEM2 (Mercury 1.48); 16 Nov 06 09:46:35 +0100
Received: from biochem.uni-erlangen.de (131.188.174.197) by biochem.uni-erlangen.de (Mercury 1.48) with ESMTP;
    16 Nov 06 09:46:33 +0100
Date: Thu, 16 Nov 2006 09:46:40 +0100
From: holger.dinkel@gmail.com
To: zsh-users@sunsite.dk
Subject: NOCLOBBER option: ">" to ">!" in history?
Message-Id: <20061116084640.GP5693@megaira.biochem.uni-erlangen.de>
Reply-To: holger.dinkel@gmail.com
Mail-Followup-To: zsh-users@sunsite.dk
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="cxMSjUqMQBJIqbX5"
Content-Disposition: inline
User-Agent: mutt-ng/devel-r804 (Linux)
X-Virus-Scanned: by amavisd-new-20030616 (RRZE) on max71.rrze.uni-erlangen.de


--cxMSjUqMQBJIqbX5
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable


Hi List,

i stumbled upon an oddity regarding the "noclobber" option...

In http://zsh.sunsite.dk/Intro/intro_16.html it reads:

---------------------------------------------------------------------------=
-----
NOCLOBBER prevents you from accidentally overwriting an existing file.=20
% setopt noclobber
% cat /dev/null >~/.zshrc
zsh: file exists: /u/pfalstad/.zshrc

If you really do want to clobber a file, you can use the >! operator. To ma=
ke things easier in this case, the > is stored in the history list as a >!:=
=20
% cat /dev/null >! ~/.zshrc
% cat /etc/motd > ~/.zshrc
zsh: file exists: /u/pfalstad/.zshrc
% !!
cat /etc/motd >! ~/.zshrc
% ...
---------------------------------------------------------------------------=
-----

So using the noclobber option, piping into an existing file should
raise an error, but the last command in the history should contain the
"override" command ">!".

Sad enough this does not work in my case:

        $ setopt noclobber
        $ cat /dev/null >! /tmp/testfile
        $ cat /etc/motd > /tmp/testfile
        zsh: file exists: /tmp/testfile
        $ !!
        cat /etc/motd > /tmp/testfile
        zsh: file exists: /tmp/testfile


i already tried this with an empty .zshrc in order to exclude any
cross-reaction with my other zsh-settings, but to no avail...

$zsh --version
zsh 4.2.5 (i686-pc-linux-gnu)


Does anyone know why this isn't working?
I like the noclobber idea a lot, because it prevents me from
accidentally overwriting files. Yet it would be beneficial if i did
not have to re-edit the last command each time i want to overwrite the
file...

Any idea highly appreciated!

Many thanks in advance,

Holger

--cxMSjUqMQBJIqbX5
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)

iD8DBQFFXCVwSgBXYj76uIcRAq4sAKCR9EBUzJ1XjRva8Fb1QtpYda27rACfaTiR
Y5/aMApdKY6UCTBTSN3TWTg=
=gCF/
-----END PGP SIGNATURE-----

--cxMSjUqMQBJIqbX5--

