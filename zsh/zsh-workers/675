From zsh-workers-request@euclid.skiles.gatech.edu  Thu Dec  7 11:29:52 1995
Received: from euclid.skiles.gatech.edu (euclid.skiles.gatech.edu [130.207.146.50]) by werple.net.au (8.7/8.7.1) with ESMTP id LAA23416 for <mason@werple.mira.net.au>; Thu, 7 Dec 1995 11:29:45 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id TAA14961; Wed, 6 Dec 1995 19:09:30 -0500 (EST)
Resent-Date: Wed, 6 Dec 1995 19:09:30 -0500 (EST)
Message-Id: <199512070009.QAA24330@block.statsci.com>
X-Mailer: exmh version 1.6.4 10/10/95
To: zsh-workers@math.gatech.edu
Cc: scott@statsci.com
Subject: Re: bug in Doc/Makefile when configure --srcdir used (or implied) 
In-reply-to: Your message of "Wed, 06 Dec 1995 14:13:58 -0800."
             <199512062213.OAA23083@block.statsci.com> 
Reply-to: scott@statsci.com
Mime-Version: 1.0
Content-Type: multipart/mixed ;
	boundary="===_0_Wed_Dec__6_16:08:17_PST_1995"
Date: Wed, 06 Dec 1995 16:09:45 -0800
From: Scott Blachowicz <scott@statsci.com>
Resent-Message-ID: <"oD8bm.0.hf3.v2Znm"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/675
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

This is a multipart MIME message.

--===_0_Wed_Dec__6_16:08:17_PST_1995
Content-Type: text/plain; charset=us-ascii

Scott Blachowicz <scott@statsci.com> wrote:

> so it looks like the Doc Makefile can't handle a redirected srcdir.  I
> made these changes to get it going:

Yes, I'm an idiot...I transcribed the patch and didn't test it...it was SO
simple. :-)

At any rate, I forgot the part about editing zshall.man into zshall.1, so
here is an updated patch (of probably the wrong way to fix it :-)) for
Doc/Makefile.in.

Thou shalt test precisely what thou sends...
Thou shalt test precisely what thou sends...
Thou shalt test precisely what thou sends...

Scott Blachowicz    Ph: 206/283-8802x240    StatSci, a div of MathSoft, Inc.
                                            1700 Westlake Ave N #500
scott@statsci.com                           Seattle, WA USA   98109
Scott.Blachowicz@seaslug.org


--===_0_Wed_Dec__6_16:08:17_PST_1995
Content-Type: application/x-patch
Content-Description: Makefile.in.patch

--- Makefile.in.dist	Wed Dec  6 14:08:37 1995
+++ Makefile.in	Wed Dec  6 15:29:32 1995
@@ -45,9 +45,9 @@
 .SUFFIXES:
 
 # man pages to install
-MAN = zsh.1 zshbuiltins.1 zshcompctl.1 zshexpn.1 \
-zshmisc.1 zshoptions.1 zshparam.1 zshzle.1 \
-zshall.1
+MAN = $(srcdir)/zsh.1 $(srcdir)/zshbuiltins.1 $(srcdir)/zshcompctl.1 \
+$(srcdir)/zshexpn.1 $(srcdir)/zshmisc.1 $(srcdir)/zshoptions.1 \
+$(srcdir)/zshparam.1 $(srcdir)/zshzle.1 zshall.1
 
 # man pages contained in distribution
 DISTMAN = zsh.1 zshbuiltins.1 zshcompctl.1 zshexpn.1 \
@@ -69,7 +69,7 @@
 all: $(MAN)
 
 zshall.1:
-	$(SED) -e 's|path-to-man-pages|$(mandir)/man$(manext)|' < zshall.man > $@
+	$(SED) -e 's|path-to-man-pages|$(mandir)/man$(manext)|' < $(srcdir)/zshall.man > $@
 
 # ========== DEPENDENCIES FOR INSTALLING ==========
 
@@ -83,8 +83,8 @@
 install.man: $(MAN)
 	$(top_srcdir)/mkinstalldirs $(mandir)/man$(manext)
 	for file in $(MAN); do \
-	  man=`echo $$file | $(SED) s/\.1/\.$(manext)/`; \
-	  $(INSTALL_DATA) $(srcdir)/$$file $(mandir)/man$(manext)/$$man ; \
+	  man=`echo $$file | $(SED) -e s,.*/,, -e s/\.1/\.$(manext)/`; \
+	  $(INSTALL_DATA) $$file $(mandir)/man$(manext)/$$man ; \
 	done
 
 # install info pages, creating install directory if necessary
@@ -98,7 +98,7 @@
 uninstall.man:
 	cd $(mandir)/man$(manext); \
 	for file in $(MAN); do \
-	  man=`echo $$file | $(SED) s/\.1/\.$(manext)/`; \
+	  man=`echo $$file | $(SED) -e s,.*/,, -e s/\.1/\.$(manext)/`; \
 	  rm -f $$man; \
 	done
 

--===_0_Wed_Dec__6_16:08:17_PST_1995--


