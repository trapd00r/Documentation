From zsh-workers-return-15701-mason-zsh=primenet.com.au@sunsite.dk Fri Aug 24 06:54:29 2001
Return-Path: <zsh-workers-return-15701-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12416 invoked from network); 24 Aug 2001 06:54:27 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Aug 2001 06:54:27 -0000
Received: (qmail 6193 invoked by alias); 24 Aug 2001 06:54:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15701
Received: (qmail 6181 invoked from network); 24 Aug 2001 06:54:19 -0000
Message-ID: <20010824065417.34532.qmail@web10408.mail.yahoo.com>
Date: Thu, 23 Aug 2001 23:54:17 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: Working with the historywords special parameter
To: zsh-workers <zsh-workers@sunsite.auc.dk>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

I'm trying to create a completer that uses the previous word on the line
and the special parameter historywords to determine what values current
word should be.

It looks to me like there is no single expression that can be used to
get just the list of all the elements that match an expression from an
array.  It seems like you need to iterate over the elements of an array
via an expression like:

    #the_word is $words[CURRENT-1]
    cnt=2
    words=()
    while [[ $historywords[(in:cnt:)the_word] -lt  $#historywords  ]] ; do
       words=($words $historywords[$historywords[(in:cnt:)the_word]-1]
       let "cnt = cnt + 1" 
    done

Is there a faster way to do this?

I'd like to do this with a large historywords (currently I have
4728 elements) doing this takes between 1 and 2 seconds. If I copy
historywords to a temporary array to do the search it goes much faster.
But if the search could be done in one operation, it would be faster and
wouldn't require a temporary copy of historywords.

Would anyone object to a new special parameter (maybe historywordsnums)
that has corresponding elements to historywords saying with which
history line the word is associated?  I ask since one of the problems
with this completer is that it picks up false "matches" when the
previous word is the last word of a previous command, it gets the next command.

It would be nice to be able to determine if a word is the last word of
the line, or what the first word of the line is.

-FR.


__________________________________________________
Do You Yahoo!?
Make international calls for as low as $.04/minute with Yahoo! Messenger
http://phonecard.yahoo.com/

