From zsh-workers-return-17961-mason-zsh=primenet.com.au@sunsite.dk Sat Nov 23 15:20:22 2002
Return-Path: <zsh-workers-return-17961-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3100 invoked from network); 23 Nov 2002 15:20:21 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 23 Nov 2002 15:20:21 -0000
Received: (qmail 6537 invoked by alias); 23 Nov 2002 15:20:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17961
Received: (qmail 6526 invoked from network); 23 Nov 2002 15:20:13 -0000
Date: Sat, 23 Nov 2002 16:20:10 +0100
From: Armin Wolfermann <aw@osn.de>
To: zsh-workers@sunsite.dk
Subject: PATCH: _sysctl for OpenBSD
Message-ID: <20021123152032.GA16106@kuba.osn.de>
Mail-Followup-To: zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
X-Habeas-SWE-1: winter into spring
X-Habeas-SWE-2: brightly anticipated
X-Habeas-SWE-3: like Habeas SWE (tm)
X-Habeas-SWE-4: Copyright 2002 Habeas (tm)
X-Habeas-SWE-5: Sender Warranted Email (SWE) (tm). The sender of this
X-Habeas-SWE-6: email in exchange for a license for this Habeas
X-Habeas-SWE-7: warrant mark warrants that this is a Habeas Compliant
X-Habeas-SWE-8: Message (HCM) and not spam. Please report use of this
X-Habeas-SWE-9: mark in spam to <http://www.habeas.com/report/>.
User-Agent: Mutt/1.5.1i

Index: _sysctl
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_sysctl,v
retrieving revision 1.4
diff -u -r1.4 _sysctl
--- _sysctl	8 Oct 2001 16:22:40 -0000	1.4
+++ _sysctl	23 Nov 2002 15:17:58 -0000
@@ -33,4 +33,13 @@
       '(-n -w -p -a *)-A[list all in table form]' \
       '(-n -p -a -A)*:sysctl variable:_files -W /proc/sys'
   ;;
+  openbsd*)
+  : ${(A)_cache_sysctlvars:=${${(f)"$(sysctl -a)"}%% *}}
+  _arguments -s -A "-*" \
+    '(-w -A *)-a[list all string and integer variables]' \
+    '(-w -a *)-A[list all known variables]' \
+    '(-w)-n[show only values]' \
+    '(-a -A -n)-w[write variable]' \
+    '(-a -A)*:sysctl variable:_multi_parts ${words[(r)-w]:+-S=} -i . _cache_sysctlvars'
+    ;;
 esac



