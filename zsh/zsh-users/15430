From zsh-users-return-15430-mason-zsh=primenet.com.au@zsh.org Sun Sep 26 19:10:11 2010
Return-Path: <zsh-users-return-15430-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17752 invoked by alias); 26 Sep 2010 19:10:10 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15430
Received: (qmail 23110 invoked from network); 26 Sep 2010 19:10:08 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,SPF_HELO_PASS
	autolearn=ham version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at eu.citrix.com designates 62.200.22.115 as permitted sender)
X-IronPort-AV: E=Sophos;i="4.57,239,1283731200"; 
   d="scan'208";a="2040697"
From: John Cooper <John.Cooper@eu.citrix.com>
To: "zsh-users@zsh.org" <zsh-users@zsh.org>
CC: John Cooper <John.Cooper@eu.citrix.com>
Date: Sun, 26 Sep 2010 19:59:44 +0100
Subject: RE: Case-insensitive completion problems with Cygwin 1.7
Thread-Topic: Case-insensitive completion problems with Cygwin 1.7
Thread-Index: ActdmGONOJ/OHzmPR2+yc7LRXDkceAAFDfoQ
Message-ID: <FFDB98DC9661D3418B9EB0FF5202E46B8D331851BE@LONPMAILBOX01.citrite.net>
References: <000201cb5d9a$e2ecfd40$a8c6f7c0$@ntlworld.com>
In-Reply-To: <000201cb5d9a$e2ecfd40$a8c6f7c0$@ntlworld.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Through trial-and-error I found that changing fake-files to be:
  zstyle ':completion:*' fake-files '/c:c:' '/d:d:' '/b:b:' '/o:o:' '/w:w:'=
 '/r:r:' '/v:v:'
.. instead of:
  zstyle ':completion:*' fake-files '/:c:' '/:d:' '/:b:' '/:o:' '/:w:' '/:r=
:' '/:v:'

.. allows case-insensitive completion to work correctly, even when using a =
drive letter.

However, I've noticed 2 side-effects:

1. When I type `ls /c/<Tab>' the listing includes a spurious 'c:' entry. Th=
is does not happen when I use `ls c:/<Tab>'.
2. When I use `ls /c/<Tab>' files with the `execute' bit set are shown acco=
rding to the `ex' color I've defined in LS_COLORS, and this matches the col=
oring I see when I just type `ls'. However, when I use `ls c:/<Tab>' execut=
able files are not colorized as expected (just shown as white). It's as if =
the executable-ness of files is somehow lost when completing via c:/.

Btw, for the coloring I have the following in my .zshrc:
  zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}

    --- John.

-----Original Message-----
From: John Cooper [mailto:super.cooper@ntlworld.com]=20
Sent: 26 September 2010 5:50 PM
To: zsh-users@zsh.org
Cc: John Cooper
Subject: Case-insensitive completion problems with Cygwin 1.7

I've just upgraded to Cygwin 1.7 (and zsh 4.3.10) and found that
case-insensitive completion no longer works when the path starts with a
drive letter.

If I start off with `zsh -f' file completion works as expected even when
using a drive letter:
$ ls /c/<TAB>    # works as expected
$ ls c:/<TAB>    # works as expected

However, after running the following (to allow for case-insensitive
completion):
  zstyle ':completion:*' matcher-list 'm:{a-z}=3D{A-Z}'
  autoload -U compinit
  compinit -C
$ ls /c/<TAB>   # still works as expected
$ ls c:/<TAB>   # fails - no completions are listed

Previously I was using zsh 4.3.2 running under Cygwin 1.5, and I used to
additionally have the following lines in my .zshrc:
zstyle ':completion:*:paths' accept-exact 'c:' 'd:' 'b:' 'o:' 'w:' 'r:' 'v:=
'
zstyle ':completion:*' fake-files '/:c' '/:d' '/:b' '/:o' '/:w' '/:r' '/:v'

This allowed completion to work when using drive letters in zsh 4.3.2, but
it doesn't work with zsh 4.3.10 and Cygwin 1.7.

Is there any other way around this, so that I can still perform
case-insensitive completion using c:/ ?

Btw, my /etc/fstab contains the following, which allows me to use /c/ rathe=
r
than the default /cygdrive/c/
none / cygdrive binary,posix=3D0,user 0 0

Thanks,

    --- John.


