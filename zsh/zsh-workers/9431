From zsh-workers-return-9431-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jan 26 07:45:30 2000
Return-Path: <zsh-workers-return-9431-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2600 invoked from network); 26 Jan 2000 07:45:30 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 Jan 2000 07:45:30 -0000
Received: (qmail 24297 invoked by alias); 26 Jan 2000 07:45:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9431
Received: (qmail 24284 invoked from network); 26 Jan 2000 07:45:21 -0000
To: zsh-workers@sunsite.auc.dk
Subject: core dump with completion
MIME-Version: 1.0 (generated by AKEMI 1.13.2 - =?ISO-2022-JP?B?Ig==?=
 =?ISO-2022-JP?B?GyRCQTA0Y0s8GyhCIg==?=)
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 26 Jan 2000 16:45:15 +0900
Message-ID: <rsqd7qpuvhw.fsf@crane.jaist.ac.jp>
Lines: 42
User-Agent: Chao-gnus/6.12.5 AKEMI/1.13.2 (=?ISO-2022-JP?B?GyRCQTAbKEI=?=
 =?ISO-2022-JP?B?GyRCNGNLPBsoQg==?=) FLAM-DOODLE/1.12.6
 (=?ISO-2022-JP?B?GyRCM3cbKEI=?= 10R4.0/5.0) Emacs/20.4
 (sparc-sun-solaris2.6) MULE/4.0 (HANANOEN)

zsh patched upto 9421 dumps core on Solaris 7 as follows:

Z:akr@is27e1u11% cvs co -r zsh-workers_9421 -d zsh9421 zsh
Z:akr@is27e1u11% cd zsh9421
Z:akr@is27e1u11% Util/preconfig
Z:akr@is27e1u11%  ./configure --prefix=/space/akr/zsh/tmp --enable-zsh-debug --enable-zsh-mem-debug && make && make install
Z:akr@is27e1u11% Src/zsh -f
is27e1u11% bindkey -e; autoload -U compinit; compinit -D
is27e1u11% ls c<TAB>
is27e1u11% ls config<TAB>
zsh: segmentation fault (core dumped)  Src/zsh -f
Z:akr@is27e1u11% 

(gdb) where
#0  0xff145c8c in realfree ()
#1  0xff146460 in cleanfree ()
#2  0xff145628 in _malloc_unlocked ()
#3  0xff145544 in malloc ()
#4  0x681d0 in zalloc (size=45) at mem.c:491
#5  0x683d8 in dupstring (
    s=0x10eeb8 "no=0:fi=0:di=0:ln=0:pi=0:so=0:bd=0:cd=0:ex=0") at mem.c:555
#6  0xff023604 in getcols (c=0xff038304) at complist.c:360
#7  0xff025340 in complistmatches (dummy=0xff0967e4, dat=0xffbeefe0)
    at complist.c:767
#8  0x6d370 in runhookdef (h=0xff0967e4, d=0xffbeefe0) at module.c:1613
#9  0xff0849dc in list_matches (dummy=0xff0ee4c8, dummy2=0x0)
    at compresult.c:1842
#10 0x6d370 in runhookdef (h=0xff0ee4c8, d=0x0) at module.c:1613
#11 0xff0c0fb8 in zrefresh () at zle_refresh.c:602
#12 0xff0b6cc0 in zleread (lp=0xd5eb0 "%m%# ", rp=0x0, flags=3)
    at zle_main.c:589
#13 0x53ab4 in inputline () at input.c:265
#14 0x53880 in ingetc () at input.c:210
#15 0x490fc in ihgetc () at hist.c:242
#16 0x5ba70 in gettok () at lex.c:560
#17 0x5adcc in yylex () at lex.c:313
#18 0x7a0a0 in parse_event () at parse.c:292
#19 0x4fcf0 in loop (toplevel=1, justonce=0) at init.c:115
#20 0x1b2a8 in main (argc=2, argv=0xffbef6ac) at ./main.c:89
(gdb) 
-- 
Tanaka Akira

