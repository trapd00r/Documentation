From zsh-workers-return-7911-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Sep 17 11:22:40 1999
Return-Path: <zsh-workers-return-7911-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17201 invoked from network); 17 Sep 1999 11:22:38 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 17 Sep 1999 11:22:38 -0000
Received: (qmail 20208 invoked by alias); 17 Sep 1999 11:22:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7911
Received: (qmail 20201 invoked from network); 17 Sep 1999 11:22:27 -0000
Date: Fri, 17 Sep 1999 12:22:25 +0100
From: Adam Spiers <adam@thelonious.new.ox.ac.uk>
To: zsh-workers@sunsite.auc.dk
Subject: Re: _man only uses $manpath
Message-ID: <19990917122225.B27658@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh-workers@sunsite.auc.dk
References: <199909170945.LAA02310@beta.informatik.hu-berlin.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0pre2i
In-Reply-To: <199909170945.LAA02310@beta.informatik.hu-berlin.de>
X-URL: http://www.new.ox.ac.uk/~adam/
X-OS: Linux 2.2.9 i686

Sven Wischnowsky (wischnow@informatik.hu-berlin.de) wrote:
> Oliver Kiddle wrote:
> > What are you trying to achieve with man -w - find a default manpath to
> > use if $manpath is unset? As far as I can tell man -w only gives you the
> > location of a specific man page which isn't entirely useful for finding
> > a default manpath as the default can (and often will) contain more than
> > one directory.

No, the GNU man displays all the man paths it will use if invoked as
`man -w':

       -w or --path
              Don't  actually display the man pages, but do print
              the location(s) of the files that would be  format-
              ted  or displayed. If no argument is given: display
              (on  stdout)  the  list  of  directories  that   is
              searched by man for man pages. If manpath is a link
              to  man,  then  "manpath"  is  equivalent  to  "man
              --path".

       -W     Like -w, but print file names one per line, without
              additional information.  This is  useful  in  shell
              commands like man -aW man | xargs ls -l

> > The only way I know of finding the default manpath is by
> > running the man binary through strings.

In the GNU case, you can just grep /etc/man.config for `^MANPATH '.

> > Maybe we could use a for loop to
> > guess possible man directories and check them.
> 
> Yes, a la `_x_color'.

I'd rather keep guessing as a last resort.  Maybe try man -w and check
the exit code, then

  if [[ -r /etc/man.config ]]; then 
    ...

?

