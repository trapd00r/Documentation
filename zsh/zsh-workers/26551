From zsh-workers-return-26551-mason-zsh=primenet.com.au@sunsite.dk Wed Feb 11 18:13:31 2009
Return-Path: <zsh-workers-return-26551-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2883 invoked from network); 11 Feb 2009 18:13:27 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Feb 2009 18:13:27 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 50895 invoked from network); 11 Feb 2009 18:13:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Feb 2009 18:13:23 -0000
Received: (qmail 28988 invoked by alias); 11 Feb 2009 18:13:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26551
Received: (qmail 28973 invoked from network); 11 Feb 2009 18:13:17 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 11 Feb 2009 18:13:17 -0000
Received: from vms173003pub.verizon.net (vms173003pub.verizon.net [206.46.173.3])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 1DABA80271F0
	for <zsh-workers@sunsite.dk>; Wed, 11 Feb 2009 19:13:13 +0100 (CET)
Received: from torch.brasslantern.com ([96.238.220.215])
 by vms173003.mailsrvcs.net
 (Sun Java(tm) System Messaging Server 6.3-7.04 (built Sep 26 2008; 32bit))
 with ESMTPA id <0KEW0010UYLVIG80@vms173003.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Wed, 11 Feb 2009 12:13:12 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n1BID6MG008177	for
 <zsh-workers@sunsite.dk>; Wed, 11 Feb 2009 10:13:07 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n1BID6bh008176	for zsh-workers@sunsite.dk; Wed,
 11 Feb 2009 10:13:06 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <090211101306.ZM8175@torch.brasslantern.com>
Date: Wed, 11 Feb 2009 10:13:06 -0800
In-reply-to: <2d460de70902110952y6fb7e609u6c5693694e5bec80@mail.gmail.com>
Comments: In reply to Richard Hartmann <richih.mailinglist@gmail.com>
 "bug in single_command" (Feb 11,  6:52pm)
References: <2d460de70902110952y6fb7e609u6c5693694e5bec80@mail.gmail.com>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: bug in single_command
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii
X-Virus-Scanned: ClamAV 0.92.1/8980/Wed Feb 11 17:40:45 2009 on bifrost
X-Virus-Status: Clean

On Feb 11,  6:52pm, Richard Hartmann wrote:
}
} Quoting Doc/Zsh/options.yo for single_command:
} 
} The value of this option cannot be changed anywhere other than the
} command line.

I suggest changing "the command line" here to something like "in the
flags supplied at invocation of the shell" to match terminology that
is used elsewhere, e.g., the manual section "Invocation".

} My personal interpretation is that I can
} 
}   setopt single_command
} 
} which is obviously not correct.

It's true that "the command line" used elsewhere in the manual often
refers to the equivalent of the ZLE input buffer.  On the other hand,
it seems so obvious that "setopt single_command" would cause the shell
to immediately exit (after all, it has now executed a single command!)
that I hardly believe thsi is a source of significant confusion.

A better question might be why these options are not mentioned in the
"Invocation" section, since that's the only context in which they make
sense, rather than being relegated to the "Single Letter Options".

} Also, wouldn't it make sense to move errors into dosetopt() so the error
} messages could be more explicit about _why_ a setopt went wrong?

Without looking, I'd suspect that the reason is that dosetopt() may at
times be called from a context where emitting an error message is not
appropriate.  In general it's bad programming to spew to the standard
error stream at too low a level because it takes control away from the
caller.

