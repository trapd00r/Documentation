From zsh-users-return-5484-mason-zsh=primenet.com.au@sunsite.dk Fri Nov 08 11:08:46 2002
Return-Path: <zsh-users-return-5484-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2252 invoked from network); 8 Nov 2002 11:08:46 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 8 Nov 2002 11:08:46 -0000
Received: (qmail 27217 invoked by alias); 8 Nov 2002 11:07:51 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 5484
Received: (qmail 27205 invoked from network); 8 Nov 2002 11:07:49 -0000
To: zsh-users@sunsite.dk (Zsh users list)
Subject: Vared with newlines between array elements
Date: Fri, 08 Nov 2002 11:07:20 +0000
Message-ID: <8483.1036753640@csr.com>
From: Peter Stephenson <pws@csr.com>

I just realised this trivial function is the answer to all my problems
with editing path and similar array variables with vared --- it puts
each element on a new line, so it's much easier to manipulate elements
separately.

To get filename completion to work properly, it should only require
backslashes before newlines and not other whitespace, nor anything else.
In other words, you get `/e/Program\ Files' from completion, but you
need `/e/Program Files' because vared preserves the backslash.
This could be fixed up if vared always stripped backslashes, which is
more symmetric since it always doubles existing backslashes (i.e. if you
had `/e/Program\ Files' to begin with it would have been quoted as
`/e/Program\\ Files' for editing.  However, the function is buried
inside the shell array splitting functions, so it's not entirely trivial
to fix without knock-on effects.

# Use vared with array elements joined by newlines.
# This makes reordering or removal of elements much simpler.
#
# With this function whitespace other than newlines in array elements
# should not be quoted by a backslash; this needs special completion
# handling (not currently provided).

local IFS='
'

vared "$@"
# End

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 692070


**********************************************************************
The information transmitted is intended only for the person or
entity to which it is addressed and may contain confidential 
and/or privileged material. 
Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by 
persons or entities other than the intended recipient is 
prohibited.  
If you received this in error, please contact the sender and 
delete the material from any computer.
**********************************************************************

