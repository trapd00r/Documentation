From zsh-users-return-11925-mason-zsh=primenet.com.au@sunsite.dk Thu Oct 04 16:44:24 2007
Return-Path: <zsh-users-return-11925-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3748 invoked from network); 4 Oct 2007 16:44:15 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 4 Oct 2007 16:44:15 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 87518 invoked from network); 4 Oct 2007 16:44:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 4 Oct 2007 16:44:09 -0000
Received: (qmail 16559 invoked by alias); 4 Oct 2007 16:44:02 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11925
Received: (qmail 16544 invoked from network); 4 Oct 2007 16:44:02 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 4 Oct 2007 16:44:02 -0000
Received: (qmail 86266 invoked from network); 4 Oct 2007 16:44:02 -0000
Received: from smtpout0185.sc1.he.tucows.com (HELO n068.sc1.he.tucows.com) (64.97.136.185)
  by a.mx.sunsite.dk with SMTP; 4 Oct 2007 16:43:56 -0000
Received: from sc.homeunix.net (82.26.172.247) by n068.sc1.he.tucows.com (7.2.069.1)
        id 47030B1E0002571C; Thu, 4 Oct 2007 16:43:53 +0000
Received: from chazelas by sc.homeunix.net with local (Exim 4.67)
	(envelope-from <stephane_chazelas@yahoo.fr>)
	id 1IdTnb-0006PI-PG; Thu, 04 Oct 2007 17:43:43 +0100
Date: Thu, 4 Oct 2007 17:43:43 +0100
From: Stephane Chazelas <Stephane_Chazelas@yahoo.fr>
To: Julio Garcia <pastaza@hotmail.com>
Cc: zsh-users@sunsite.dk
Subject: Re: How do I change the subshell to something other than /bin/sh?
Message-ID: <20071004164343.GA5401@sc.homeunix.net>
Mail-Followup-To: Julio Garcia <pastaza@hotmail.com>, zsh-users@sunsite.dk
References: <BAY142-F32351B72FA90C8C20D323EA3A80@phx.gbl>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <BAY142-F32351B72FA90C8C20D323EA3A80@phx.gbl>
User-Agent: Mutt/1.5.16 (2007-06-11)

On Thu, Oct 04, 2007 at 10:29:49AM -0600, Julio Garcia wrote:
[...]
> logsol10-1 ~ > ./x.sh
> ./x.sh
>   PID TTY         TIME CMD
> 24296 pts/8       0:00 zsh
>  5205 pts/8       0:00 ps
>  5204 pts/8       0:00 sh
>
> Note that it execs sh. How can I tell it to use another shell? zsh or bash, 
> for example?
[...]

You probably shouldn't do that. It's probably safer to trust zsh
for the current setting. Normally, if you write POSIX scripts,
you should *not* use the "#! /bin/sh -" lines, and trust the
"system" (if you're in a POSIX environment) for calling the
right shell (that is a POSIX one, which zsh is not by default)
to interpret the file. In the case of zsh, it's not actually the
"system" that decides what shell to call, but zsh. But zsh
should be setup to try and use the same shell as the "system"
would use.

Hmmm, looking at the code, looks like zsh has "/bin/sh"
hardcoded as the path of that shell. That makes it not POSIX on
systems where the POSIX shell is not in /bin like on Solaris.
(on Solaris, execvp(), system()... may call /bin/sh or a
standard shell depending on how you link the executable that
uses those functions).

Given that it's hardcoded, I don't think there's a way you can
change the shell zsh uses in this case.

But you can run call the interpreter directly: bash ./x.sh or
/usr/xpg4/bin/sh ./x.sh.

Or, if you want to call bash as "sh" for it to behave more
POSIXly:

ARGV0=sh bash ./x.sh

-- 
Stéphane

