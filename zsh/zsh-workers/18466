From zsh-workers-return-18466-mason-zsh=primenet.com.au@sunsite.dk Wed Apr 23 18:43:12 2003
Return-Path: <zsh-workers-return-18466-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9480 invoked from network); 23 Apr 2003 18:43:12 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 23 Apr 2003 18:43:12 -0000
Received: (qmail 11993 invoked by alias); 23 Apr 2003 18:43:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18466
Received: (qmail 11984 invoked from network); 23 Apr 2003 18:43:06 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 23 Apr 2003 18:43:06 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [195.92.193.211] by sunsite.dk (MessageWall 1.0.8) with SMTP; 23 Apr 2003 18:43:6 -0000
Received: from modem-246.cleaner-wrasse.dialup.pol.co.uk ([62.136.246.246] helo=pwstephenson.fsnet.co.uk)
	by cmailm4.svr.pol.co.uk with esmtp (Exim 4.14)
	id 198PCz-0003qw-9C
	for zsh-workers@sunsite.dk; Wed, 23 Apr 2003 19:43:05 +0100
Received: by pwstephenson.fsnet.co.uk (Postfix, from userid 501)
	id ED31A1B76A; Wed, 23 Apr 2003 18:47:48 +0100 (BST)
Received: from pwstephenson.fsnet.co.uk (localhost [127.0.0.1])
	by pwstephenson.fsnet.co.uk (Postfix) with ESMTP id A7AD71B769
	for <zsh-workers@sunsite.dk>; Wed, 23 Apr 2003 18:47:48 +0100 (BST)
To: zsh-workers@sunsite.dk
Subject: Re: Conflict with zftp + tcp modules? 
In-reply-to: "Borzenkov Andrey"'s message of "Mon, 21 Apr 2003 15:49:50 +0400."
             <6134254DE87BD411908B00A0C99B044F03A0B6C3@mowd019a.mow.siemens.ru> 
Date: Wed, 23 Apr 2003 18:47:43 +0100
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <20030423174748.ED31A1B76A@pwstephenson.fsnet.co.uk>

Borzenkov Andrey wrote:
> it was never intended to work this way. Zftp.c includes zftp.mdh and tcp.h
> that in turn includes tcp.mdh. mdh is expected to _the_ only and single mdh
> for the module being compiled; having two mdh's is wrong.
> 
> Oliver, Peter, could you look in tcp and see if you can move tcp.mdh =
> into
> tcp.c?

Seems to be trivial, at least it doesn't generate any new errors or
warnings here.

Index: Src/Modules/tcp.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Modules/tcp.c,v
retrieving revision 1.34
diff -u -r1.34 tcp.c
--- Src/Modules/tcp.c	6 Feb 2003 12:21:49 -0000	1.34
+++ Src/Modules/tcp.c	23 Apr 2003 18:37:06 -0000
@@ -34,6 +34,7 @@
  * doesn't exist on cygwin.
  */
 #include "tcp.h"
+#include "tcp.mdh"
 
 /*
  * We use poll() in preference to select because some subset of manuals says
Index: Src/Modules/tcp.h
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Modules/tcp.h,v
retrieving revision 1.6
diff -u -r1.6 tcp.h
--- Src/Modules/tcp.h	2 Oct 2001 02:35:01 -0000	1.6
+++ Src/Modules/tcp.h	23 Apr 2003 18:37:06 -0000
@@ -83,7 +83,6 @@
     int flags;
 };
 
-#include "tcp.mdh"
 #include "tcp.pro"
 
 #ifndef INET_ADDRSTRLEN

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Work: pws@csr.com
Web: http://www.pwstephenson.fsnet.co.uk

