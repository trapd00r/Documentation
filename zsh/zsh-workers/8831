From zsh-workers-return-8831-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Dec 01 09:09:34 1999
Return-Path: <zsh-workers-return-8831-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11506 invoked from network); 1 Dec 1999 09:09:33 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Dec 1999 09:09:33 -0000
Received: (qmail 6836 invoked by alias); 1 Dec 1999 09:09:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8831
Received: (qmail 6829 invoked from network); 1 Dec 1999 09:09:27 -0000
Date: Wed, 1 Dec 1999 10:09:24 +0100 (MET)
Message-Id: <199912010909.KAA14478@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: zefram@fysh.org's message of Tue, 30 Nov 1999 18:15:27 +0000
Subject: Re: PATCH: zftp without inet_aton()


Zefram wrote:

> This should fix zftp for systems that lack inet_aton().  I haven't tested
> it on such a system, however.

It doesn't. For me at least:

gcc -c -I.  -DHAVE_CONFIG_H -DMODULE -Wall -Wno-implicit -Wmissing-prototypes -ggdb
-fpic -o zftp..o zftp.c
In file included from zftp.c:53:
zftp.pro:35: warning: `struct in_addr' declared inside parameter list
zftp.pro:35: warning: its scope is only this definition or declaration,
zftp.pro:35: warning: which is probably not what you want.
In file included from zftp.c:60:
/usr/include/arpa/inet.h:72: conflicting types for `inet_aton'
zftp.pro:35: previous declaration of `inet_aton'
make[2]: *** [zftp..o] Error 1


Quick fix below (can't move the includes below the arpa thingies
because at least my arpa/telnet.h #defines DO, which would then cause
mishap in zsh.h:212).

Bye
 Sven

--- Src/Modules/zftp.c.old	Wed Dec  1 10:04:32 1999
+++ Src/Modules/zftp.c	Wed Dec  1 10:05:58 1999
@@ -49,14 +49,15 @@
 struct zftp_session;
 typedef struct zftp_session *Zftp_session;
 
-#include "zftp.mdh"
-#include "zftp.pro"
-
 #include <sys/socket.h>
 #include <netdb.h>
 #include <netinet/in_systm.h>
 #include <netinet/in.h>
 #include <netinet/ip.h>
+
+#include "zftp.mdh"
+#include "zftp.pro"
+
 #include <arpa/inet.h>
 /* it's a TELNET based protocol, but don't think I like doing this */
 #include <arpa/telnet.h>

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

