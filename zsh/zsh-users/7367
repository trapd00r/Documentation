From zsh-users-return-7367-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 19 15:40:56 2004
Return-Path: <zsh-users-return-7367-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24430 invoked from network); 19 Apr 2004 15:40:55 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 19 Apr 2004 15:40:55 -0000
Received: (qmail 2443 invoked by alias); 19 Apr 2004 15:40:38 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7367
Received: (qmail 2427 invoked from network); 19 Apr 2004 15:40:37 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 19 Apr 2004 15:40:37 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 19 Apr 2004 15:40:37 -0000
Received: (qmail 22008 invoked from network); 19 Apr 2004 15:40:37 -0000
Received: from main.gmane.org (80.91.224.249)
  by a.mx.sunsite.dk with SMTP; 19 Apr 2004 15:40:35 -0000
Received: from list by main.gmane.org with local (Exim 3.35 #1 (Debian))
	id 1BFast-0000Wy-00
	for <zsh-users@sunsite.dk>; Mon, 19 Apr 2004 17:40:35 +0200
Received: from isi-dialin-129-206.isionline-dialin.de ([195.158.129.206])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Mon, 19 Apr 2004 17:40:35 +0200
Received: from thorsten by isi-dialin-129-206.isionline-dialin.de with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Mon, 19 Apr 2004 17:40:35 +0200
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-users@sunsite.dk
From: Thorsten Kampe <thorsten@thorstenkampe.de>
Subject: Re: completion not inserting matches
Date: Mon, 19 Apr 2004 17:40:29 +0200
Lines: 84
Message-ID: <iw5pveco3uox$.dlg@thorstenkampe.de>
References: <x1n6gf1ludq1.dlg@thorstenkampe.de> <1040418232047.ZM8981@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@sea.gmane.org
X-Gmane-NNTP-Posting-Host: isi-dialin-129-206.isionline-dialin.de
User-Agent: 40tude_Dialog/2.0.10.1de
Sender: news <news@sea.gmane.org>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

* Bart Schaefer (2004-04-19 01:20 +0100)
> On Apr 18,  4:17pm, Thorsten Kampe wrote:
> } | root@wolfbrand# cd r3<TAB>
> } | root@wolfbrand# cd linux-2.4.2---sr3
> } |                                ^ Cursor jumps to this point
> } | local directory
> } | linux-2.4.20-wolk4.11s-r3/  linux-2.4.25_pre7-gss-r3/
> 
> At this point things are a little messed up.  Note that there isn't any
> matching file that actually has three hyphens; those are standing in for
> "-.-" in the first match and "_--" in the second match.

Yes.

Without "m:[-._]=[-._]"      it completes to "linux-2.4.2--sr3"
Without "r:|[-./_]=** r:|=*" it completes to "s-r3"

> Also, the right completion would be "linux-2.4.2--s-r3", so I'm not
> sure how the final hyphen and the "s" are becoming transposed.

Yes. Another oddity:

root@wolfbrand# cd 20<TAB>
root@wolfbrand# cd linux-2..420-wolk4.
local directory
linux-2.4.20-wolk4.9s-r6/   linux-2.4.20-wolk4.11s-r3/

...while it should complete to "linux-2.4.20-wolk4." (the longest
unambiguous part). In this case it cycles through the completions.
 
> } | root@wolfbrand# cd linux-2.4.2--<TAB>-sr3
> 
> That doesn't match where you said the cursor was.  Did you move the
> cursor to the right before pressing TAB, or should that have said
> 
>     root@wolfbrand# cd linux-2.4.2-<TAB>--sr3
> 
> ??

Yes, "-<TAB>--" is more accurate as the cursor sits and blinks on the
middle hyphen "-".
 
> If I understand correctly, you were expecting this to take you into menu
> completion cycling between the two previous matches.  I confess I don't
> know why it does not, except that it may be related to the transposed "s".

Actually I had a phenomenon yesterday while trying to complete some
directories in /usr/src like the one mentioned, where pressing <TAB> a
second time resulted in a "logout" (first log out of "screen" and then
on a third TAB out of the shell thereby closing the ssh connection). I
could reproduce this. So I thought that I had really messed things up.
 
> } These are my completion settings: [1] and [2].
> 
> It'd be a little easier to work with these if they didn't have the ascii
> art border.  As it is it's not possible to cut'n'paste them into a shell
> to duplicate your setup.

These "ascii art borders" are "box quotes" and supposed to make the
quoted text more readable and structured (and it prevents unwanted
linebreaks), but I learned my lesson...
 
> I do notice that you're not using the _oldlist completer.  You might try
> adding that to the front of your list of completers and see if it helps.

Yes, that works perfectly. Although

* I cannot see where I am "using special completion functions, i.e.
commands other than the standard completion system"

* I don't use any other key to generate any completion except the
Tab-key

* My matcher list[1] should work that way (because of the "+") that
even on the second try when case-insensitive and partial-word
completion didn't generate matches, substring completion uses the
other ones ("case-insensitive and partial-word"), too. So the matches
could (in theory) never decrease only increase.


Thorsten

[1]
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z} m:[-._]=[-._] r:|[-./_]=** r:|=*' '+l:|=*'

