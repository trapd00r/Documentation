From zsh-workers-return-22221-mason-zsh=primenet.com.au@sunsite.dk Sat Feb 11 12:05:31 2006
Return-Path: <zsh-workers-return-22221-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12062 invoked from network); 11 Feb 2006 12:05:29 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Feb 2006 12:05:29 -0000
Received: (qmail 59925 invoked from network); 11 Feb 2006 12:05:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Feb 2006 12:05:23 -0000
Received: (qmail 14794 invoked by alias); 11 Feb 2006 12:05:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22221
Received: (qmail 14784 invoked from network); 11 Feb 2006 12:05:19 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 11 Feb 2006 12:05:19 -0000
Received: (qmail 59623 invoked from network); 11 Feb 2006 12:05:19 -0000
Received: from ns9.hostinglmi.net (213.194.149.146)
  by a.mx.sunsite.dk with SMTP; 11 Feb 2006 12:05:17 -0000
Received: from 212.red-80-35-44.staticip.rima-tde.net ([80.35.44.212]:36267 helo=localhost)
	by ns9.hostinglmi.net with esmtpa (Exim 4.52)
	id 1F7tV9-0005Nt-EQ; Sat, 11 Feb 2006 13:05:19 +0100
Date: Sat, 11 Feb 2006 13:06:23 +0100
From: DervishD <zsh@dervishd.net>
To: Andrey Borzenkov <arvidjaar@newmail.ru>,
	Zsh-workers <zsh-workers@sunsite.dk>
Subject: Re: [SOLVED] Libtool/zsh quoting problem: a zsh... bug?
Message-ID: <20060211120623.GB13513@DervishD>
Mail-Followup-To: Andrey Borzenkov <arvidjaar@newmail.ru>,
	Zsh-workers <zsh-workers@sunsite.dk>
References: <20060209233201.GA5875@fargo> <20060211093607.GD10579@DervishD> <200602111321.48602.arvidjaar@newmail.ru> <20060211110630.GA13442@DervishD> <20060211113325.GB9019@fargo>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <20060211113325.GB9019@fargo>
User-Agent: Mutt/1.4.2.1i
Organization: DervishD
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - ns9.hostinglmi.net
X-AntiAbuse: Original Domain - sunsite.dk
X-AntiAbuse: Originator/Caller UID/GID - [0 0] / [47 12]
X-AntiAbuse: Sender Address Domain - dervishd.net
X-Source: 
X-Source-Args: 
X-Source-Dir: 

    Hi David :)

 * David <david@pleyades.net> dixit:
> On Feb 11 at 12:06:30, DervishD wrote:
> >     The problem is that libtool doesn't use "${1+... but just $1+...,
> > without quotes, so the splitting *should* be done. That's why I think
> > bash is wrong here and zsh is right.
> > 
> >     Anyway, if the people at autoconf used the "alias -g" solution,
> > libtool people could, too...
> 
> Thanks a lot for your help, i'd never find out this problem by myself ;).

    You're more than welcome. Thanks for reporting the problem.
Unfortunately libtool is heavily used nowadays, so many people is
going to be bitten by this bug if they use Zsh as /bin/sh (as I do).

> In fact i'm still trying to understand it :), because for me that ${1+"$@"}
> construct is bit weird...

    Some shells (ugly, old shells) doesn't treat "$@" (double quoted)
as "nothing", as the SUS standard says. Instead, they treat the
expression above as "" (and empty pair of double quotes), which is
not exactly "nothing". Well, to work around this, you always can use
this: ${1+"$@"}, what will *correctly* substitute "nothing" if no
parameters are available (that is, when $@ is empty). Unfortunately,
zsh does field splitting on the above, but bash doesn't. The libtool
script does heavy use of the above construct, and I think it can be
avoided most of the time, but I NOT going to hack libtool, the code
is a nightmare.

    If the libtool people accept the patch, well, then there is a
possibility. Otherwise... The patch is not very intrusive, and anyway
they are already doing a couple of things under Zsh, so...

    I've prepared the patch and it works with littlecms. Now I have
to check libtool pristine sources ;)

    Raúl Núñez de Arenas Coronado

-- 
Linux Registered User 88736 | http://www.dervishd.net
http://www.pleyades.net & http://www.gotesdelluna.net
It's my PC and I'll cry if I want to... RAmen!

