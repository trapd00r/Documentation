From zsh-workers-return-13578-mason-zsh=primenet.com.au@sunsite.dk Tue Mar 06 15:38:30 2001
Return-Path: <zsh-workers-return-13578-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19931 invoked from network); 6 Mar 2001 15:38:30 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Mar 2001 15:38:30 -0000
Received: (qmail 24256 invoked by alias); 6 Mar 2001 15:38:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13578
Received: (qmail 24243 invoked from network); 6 Mar 2001 15:38:05 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010306153706.ZM24531@candle.brasslantern.com>
Date: Tue, 6 Mar 2001 15:37:05 +0000
In-Reply-To: <200103061257.NAA02830@beta.informatik.hu-berlin.de>
Comments: In reply to Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
        "PATCH: Re: 4.0.1-pre-1" (Mar  6,  1:57pm)
References: <200103061257.NAA02830@beta.informatik.hu-berlin.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>,
        zsh-workers@sunsite.dk
Subject: Re: PATCH: Re: 4.0.1-pre-1
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Mar 6,  1:57pm, Sven Wischnowsky wrote:
} Subject: PATCH: Re: 4.0.1-pre-1
}
} The patch below changes the code in parse.c to use real memory for the 
} `ecbuf'. It would be very nice if we could avoid that and instead
} write a better hrealloc(), but that's non-trivial to say the least.
} 
} I think I got the freeing right, but I'd be thankful if someone with 
} an allocation profiler could verify that.

It runs "make check" correctly when linked with ElectricFence, but I
don't believe that detects memory leaks, only memory under/over-runs.

However, with the latest CVS this morning, I'm getting a failure in
54compmatch:

*** /tmp/zsh.ztst.out.22091     Tue Mar  6 07:31:47 2001
--- /tmp/zsh.ztst.tout.22091    Tue Mar  6 07:31:48 2001
***************
*** 1,3 ****
! line: {tst .:}{}
  COMPADD:{}
  INSERT_POSITIONS:{4:5:6}
--- 1,3 ----
! line: {tst }{.:}
  COMPADD:{}
  INSERT_POSITIONS:{4:5:6}
Test ../../zsh-3.1.6/Test/54compmatch.ztst failed: output differs from expected as shown above for:
 workers_11388_matcher='r:|[:.]=** r:|=*'
 workers_11388_list=(a.b:0 c.d:1)
 test_code $workers_11388_matcher workers_11388_list
 comptest $'tst :\t'
Was testing: Non-bug from workers 11388
../../zsh-3.1.6/Test/54compmatch.ztst: test failed.


(This reminds me again that we'd discussed renumbering the test suite to
group similar tests together and perform them in vaguely dependency order.
Are we going to get to that and to re-organizing Completion/ before PWS
decides to shove 4.0.1 out the door?)

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

