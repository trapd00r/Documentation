From zsh-workers-return-8833-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Dec 01 09:30:37 1999
Return-Path: <zsh-workers-return-8833-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11676 invoked from network); 1 Dec 1999 09:30:36 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Dec 1999 09:30:36 -0000
Received: (qmail 8172 invoked by alias); 1 Dec 1999 09:30:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8833
Received: (qmail 8165 invoked from network); 1 Dec 1999 09:30:19 -0000
Subject: Re: PATCH: zftp without inet_aton()
In-Reply-To: <199912010909.KAA14478@beta.informatik.hu-berlin.de> from Sven Wischnowsky at "Dec 1, 1999 10: 9:24 am"
To: wischnow@informatik.hu-berlin.de (Sven Wischnowsky)
Date: Wed, 1 Dec 1999 09:30:17 +0000 (GMT)
Cc: zsh-workers@sunsite.auc.dk
X-Mailer: ELM [version 2.4ME+ PL48 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Message-Id: <E11t65Z-00051q-00@crucigera.fysh.org>
From: Zefram <zefram@fysh.org>

Sven Wischnowsky wrote:
>Quick fix below (can't move the includes below the arpa thingies
>because at least my arpa/telnet.h #defines DO, which would then cause
>mishap in zsh.h:212).

The proper fix is to add struct in_addr to the list of forward structure
declarations.  This patch applies on top of 8831, though only to
reverse it.

-zefram

diff -u -r ../zsh-/Src/Modules/zftp.c ./Src/Modules/zftp.c
--- ../zsh-/Src/Modules/zftp.c	Wed Dec  1 09:26:06 1999
+++ ./Src/Modules/zftp.c	Wed Dec  1 09:27:42 1999
@@ -43,21 +43,21 @@
 
 /* needed in prototypes for statics */
 struct hostent;
+struct in_addr;
 struct sockaddr_in;
 struct sockaddr_in6;
 union zftp_sockaddr;
 struct zftp_session;
 typedef struct zftp_session *Zftp_session;
 
+#include "zftp.mdh"
+#include "zftp.pro"
+
 #include <sys/socket.h>
 #include <netdb.h>
 #include <netinet/in_systm.h>
 #include <netinet/in.h>
 #include <netinet/ip.h>
-
-#include "zftp.mdh"
-#include "zftp.pro"
-
 #include <arpa/inet.h>
 /* it's a TELNET based protocol, but don't think I like doing this */
 #include <arpa/telnet.h>
END

