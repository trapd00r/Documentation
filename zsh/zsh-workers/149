From zsh-workers-request@math.gatech.edu  Wed Jul  5 19:44:44 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id TAA00942 for <mason@werple.mira.net.au>; Wed, 5 Jul 1995 19:44:41 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA18432
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Wed, 5 Jul 1995 05:44:40 -0400
Received: by math (5.x/SMI-SVR4)
	id AA20764; Wed, 5 Jul 1995 05:41:19 -0400
Resent-Date: Wed, 5 Jul 1995 11:40:23 +0100 (MET DST)
Old-Return-Path: <hzoli@cs.elte.hu>
From: hzoli@cs.elte.hu (Zoltan Hidvegi)
Message-Id: <9507050940.AA05399@turan.elte.hu>
Subject: Bugfix: zsh crashes if invoked with unset PATH
To: zsh-workers@math.gatech.edu (zsh-workers)
Date: Wed, 5 Jul 1995 11:40:23 +0100 (MET DST)
X-Mailer: ELM [version 2.4 PL21]
Content-Type: text
Resent-Message-Id: <"uArgH2.0.M45.-ub-l"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/149
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

If PATH is not set in the environment, zsh dumps core the first time it
attempts to execute an external command without an absolute path. That is
because in init.c newcmdnamtable() is called before the path is initialised.

% unset PATH ; ./zsh -fc 'ls'            
zsh: 5275 segmentation fault (core dumped)  ./zsh -fc 'ls'

Because of this bug one of my boot scripts faild (that's almost the only place
where PATH is unset).

Here is the patch to fix that. It applies with fuzz 2 to the baseline zsh as I
added /usr/local/bin to the default path in my release.

Bye,
  Zoltan

