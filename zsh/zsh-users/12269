From zsh-users-return-12269-mason-zsh=primenet.com.au@sunsite.dk Sat Dec 01 02:59:14 2007
Return-Path: <zsh-users-return-12269-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29262 invoked from network); 1 Dec 2007 02:59:06 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Dec 2007 02:59:06 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 31620 invoked from network); 1 Dec 2007 02:59:01 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Dec 2007 02:59:01 -0000
Received: (qmail 510 invoked by alias); 1 Dec 2007 02:58:47 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12269
Received: (qmail 496 invoked from network); 1 Dec 2007 02:58:47 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 1 Dec 2007 02:58:47 -0000
Received: (qmail 30294 invoked from network); 1 Dec 2007 02:58:47 -0000
Received: from vms173003pub.verizon.net (206.46.173.3)
  by a.mx.sunsite.dk with SMTP; 1 Dec 2007 02:58:41 -0000
Received: from torch.brasslantern.com ([71.121.18.67])
 by vms173003.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0JSC005H5O6OS382@vms173003.mailsrvcs.net> for
 zsh-users@sunsite.dk; Fri, 30 Nov 2007 20:56:49 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id lB12wRDQ018404	for
 <zsh-users@sunsite.dk>; Fri, 30 Nov 2007 18:58:27 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id lB12wRkp018403	for zsh-users@sunsite.dk; Fri,
 30 Nov 2007 18:58:27 -0800
Date: Fri, 30 Nov 2007 18:58:27 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: command substitution: zsh waits until command exits
In-reply-to: <20071130163155.GL5855@prunille.vinc17.org>
To: zsh-users@sunsite.dk
Message-id: <071130185827.ZM18402@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <20071130133943.GG5855@prunille.vinc17.org>
	<071130073719.ZM18090@torch.brasslantern.com>
	<20071130163155.GL5855@prunille.vinc17.org>
Comments: In reply to Vincent Lefevre <vincent@vinc17.org>
 "Re: command substitution: zsh waits until command exits" (Nov 30,  5:31pm)

On Nov 30,  5:31pm, Vincent Lefevre wrote:
} Subject: Re: command substitution: zsh waits until command exits
}
} > with "Command Substitution" listed as happening at the third step,
} > 
} >    ... in left-to-right fashion.
} 
} By "when zsh does the substitution", this includes the question
} whether zsh does the substitution before or after the command exits.
} For instance, zsh could start commands in the left-to-right fashion
} (I assumed asynchronously), but could replace the $(...) in some
} arbitrary order, once it knows the result, i.e. once the standard
} output is closed.

No, that would be non-deterministic with respect to left-to-right order.
Consider:

  echo $(echo first; exec >&- ; echo last > /tmp/first) $(</tmp/first)

If the commands were only started left-to-right and not also finished
left-to-right, $(</tmp/first) could fail with "no such file".

The default is to do everything synchronously.  That's why cases that
are asynchronous are explicitly called out, like process substitution.

} >   echo $(coproc xterm -e 'tty >&3; sleep 999999' 3>&1 ; read -E <&p)
} 
} OK, thanks. But is there any reason why Ctrl-C doesn't work in the
} xterm?

Could be any of a variety of reasons, the most likely of which is that no
interactive shell is being run.  Explicitly set the tty up the way you
want it by using X resources:

  XTerm*ttyModes: erase ^? intr ^C

Or

  xterm -xrm "*ttyModes: erase ^? intr ^C" -e 'tty >&3; sleep 999999' 3>&1

