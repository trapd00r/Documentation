From zsh-users-return-15431-mason-zsh=primenet.com.au@zsh.org Mon Sep 27 18:40:20 2010
Return-Path: <zsh-users-return-15431-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27808 invoked by alias); 27 Sep 2010 18:40:19 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15431
Received: (qmail 12636 invoked from network); 27 Sep 2010 18:40:16 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,SPF_HELO_PASS
	autolearn=ham version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at eu.citrix.com designates 62.200.22.115 as permitted sender)
X-IronPort-AV: E=Sophos;i="4.57,244,1283731200"; 
   d="scan'208";a="2060687"
From: John Cooper <John.Cooper@eu.citrix.com>
To: "zsh-users@zsh.org" <zsh-users@zsh.org>
CC: John Cooper <John.Cooper@eu.citrix.com>
Date: Mon, 27 Sep 2010 19:40:07 +0100
Subject: RE: Case-insensitive completion problems with Cygwin 1.7
Thread-Topic: Case-insensitive completion problems with Cygwin 1.7
Thread-Index: ActdmGONOJ/OHzmPR2+yc7LRXDkceAAFDfoQADFsHeA=
Message-ID: <FFDB98DC9661D3418B9EB0FF5202E46B8D331852DA@LONPMAILBOX01.citrite.net>
References: <000201cb5d9a$e2ecfd40$a8c6f7c0$@ntlworld.com>
 <FFDB98DC9661D3418B9EB0FF5202E46B8D331851BE@LONPMAILBOX01.citrite.net>
In-Reply-To: <FFDB98DC9661D3418B9EB0FF5202E46B8D331851BE@LONPMAILBOX01.citrite.net>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Unfortunately, the updated fake-files below does not actually fix the probl=
em. It appeared to work on my home computer because HOME is set to "/c" and=
 I was testing the completion from /c. If I change to any other directory, =
typing `ls c:/<Tab>' does not work as expected, but just (after a short del=
ay) starts to complete files in the current directory.

So, it still seems that completing through a drive letter has regressed in =
zsh 4.3.10 (compared with 4.3.2). Does anyone have any ideas on other setti=
ngs I could try to get this to work?

Thanks,

    --- John.

-----Original Message-----
From: John Cooper=20
Sent: 26 September 2010 8:00 PM
To: zsh-users@zsh.org
Cc: John Cooper
Subject: RE: Case-insensitive completion problems with Cygwin 1.7

Through trial-and-error I found that changing fake-files to be:
  zstyle ':completion:*' fake-files '/c:c:' '/d:d:' '/b:b:' '/o:o:' '/w:w:'=
 '/r:r:' '/v:v:'
.. instead of:
  zstyle ':completion:*' fake-files '/:c:' '/:d:' '/:b:' '/:o:' '/:w:' '/:r=
:' '/:v:'

.. allows case-insensitive completion to work correctly, even when using a =
drive letter.

However, I've noticed 2 side-effects:

1. When I type `ls /c/<Tab>' the listing includes a spurious 'c:' entry. Th=
is does not happen when I use `ls c:/<Tab>'.
2. When I use `ls /c/<Tab>' files with the `execute' bit set are shown acco=
rding to the `ex' color I've defined in LS_COLORS, and this matches the col=
oring I see when I just type `ls'. However, when I use `ls c:/<Tab>' execut=
able files are not colorized as expected (just shown as white). It's as if =
the executable-ness of files is somehow lost when completing via c:/.

Btw, for the coloring I have the following in my .zshrc:
  zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}

    --- John.

-----Original Message-----
From: John Cooper [mailto:super.cooper@ntlworld.com]=20
Sent: 26 September 2010 5:50 PM
To: zsh-users@zsh.org
Cc: John Cooper
Subject: Case-insensitive completion problems with Cygwin 1.7

I've just upgraded to Cygwin 1.7 (and zsh 4.3.10) and found that
case-insensitive completion no longer works when the path starts with a
drive letter.

If I start off with `zsh -f' file completion works as expected even when
using a drive letter:
$ ls /c/<TAB>    # works as expected
$ ls c:/<TAB>    # works as expected

However, after running the following (to allow for case-insensitive
completion):
  zstyle ':completion:*' matcher-list 'm:{a-z}=3D{A-Z}'
  autoload -U compinit
  compinit -C
$ ls /c/<TAB>   # still works as expected
$ ls c:/<TAB>   # fails - no completions are listed

Previously I was using zsh 4.3.2 running under Cygwin 1.5, and I used to
additionally have the following lines in my .zshrc:
zstyle ':completion:*:paths' accept-exact 'c:' 'd:' 'b:' 'o:' 'w:' 'r:' 'v:=
'
zstyle ':completion:*' fake-files '/:c' '/:d' '/:b' '/:o' '/:w' '/:r' '/:v'

This allowed completion to work when using drive letters in zsh 4.3.2, but
it doesn't work with zsh 4.3.10 and Cygwin 1.7.

Is there any other way around this, so that I can still perform
case-insensitive completion using c:/ ?

Btw, my /etc/fstab contains the following, which allows me to use /c/ rathe=
r
than the default /cygdrive/c/
none / cygdrive binary,posix=3D0,user 0 0

Thanks,

    --- John.


