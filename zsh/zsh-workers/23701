From zsh-workers-return-23701-mason-zsh=primenet.com.au@sunsite.dk Wed Jul 25 19:56:26 2007
Return-Path: <zsh-workers-return-23701-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13936 invoked from network); 25 Jul 2007 19:56:22 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 25 Jul 2007 19:56:22 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 79686 invoked from network); 25 Jul 2007 19:56:16 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 25 Jul 2007 19:56:16 -0000
Received: (qmail 22520 invoked by alias); 25 Jul 2007 19:56:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23701
Received: (qmail 22509 invoked from network); 25 Jul 2007 19:56:13 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 25 Jul 2007 19:56:13 -0000
Received: (qmail 79398 invoked from network); 25 Jul 2007 19:56:13 -0000
Received: from ug-out-1314.google.com (66.249.92.175)
  by a.mx.sunsite.dk with SMTP; 25 Jul 2007 19:56:08 -0000
Received: by ug-out-1314.google.com with SMTP id u2so393911uge
        for <zsh-workers@sunsite.dk>; Wed, 25 Jul 2007 12:56:07 -0700 (PDT)
DKIM-Signature: a=rsa-sha1; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=SJcKtJifwFJ0sTUpDVVIC0nifMue8MR3zzs9RjxorEQR98vsZCE9dPFWPcW7+0e8w+HFQgQVRBSpLi1R2QqOs1jFNZDyrEc5ogu8b8W2991wyHQbz+Uc1h8Ef9kFnT09UEFoQG+fzqnlfM7Au+mUxKiRofpgoyAZ6R5vqti2rd8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=gFJ5ZBQ9R6s80WRfkfJJUQeGZU3H4oPbkOEqgSDbeHO/O2GV3V3Q/HyqF+rgIjJlK18SMov33pOAWpKgocQQWUmua7MZeOwoyWl2kIHPbhabGICpvayNXTyiMIKwpqkjrX/b+7bqK8L4/3wtb5DKYDuAqj0s0EMPiMXgIP5w0hk=
Received: by 10.78.171.20 with SMTP id t20mr257119hue.1185393367150;
        Wed, 25 Jul 2007 12:56:07 -0700 (PDT)
Received: by 10.78.163.10 with HTTP; Wed, 25 Jul 2007 12:56:07 -0700 (PDT)
Message-ID: <747dc8f30707251256q36a4f18bka028ec7e972645c3@mail.gmail.com>
Date: Wed, 25 Jul 2007 16:56:07 -0300
From: "Renato Botelho" <rbgarga@gmail.com>
To: zsh-workers@sunsite.dk
Subject: Re: Problems building 4.3.4 on FreeBSD
In-Reply-To: <747dc8f30707251156k79397da4l141ed6a03d1973a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <747dc8f30707251120p69307dc5pdce77ce965fa1b19@mail.gmail.com>
	 <747dc8f30707251156k79397da4l141ed6a03d1973a@mail.gmail.com>

On 7/25/07, Renato Botelho <rbgarga@gmail.com> wrote:
> On 7/25/07, Renato Botelho <rbgarga@gmail.com> wrote:
> > Hello,
> >
> > I'm working to upgrade zsh on FreeBSD ports tree from 4.3.2 to 4.3.4
> > and i had a problem building it.
> >
> > When iconv was not found, Src/utils.c didn't build, i made this change
> > and everything built file:
> >
> > --- Src/utils.c.orig    Tue Apr 17 10:57:15 2007
> > +++ Src/utils.c Wed Jul 25 15:13:58 2007
> > @@ -4569,11 +4570,11 @@
> >      int count;
> >  #else
> >      unsigned int wval;
> > +    size_t count;
> >  # if defined(HAVE_NL_LANGINFO) && defined(CODESET) && defined(HAVE_ICONV)
> >      iconv_t cd;
> >      char inbuf[4];
> >      size_t inbytes, outbytes;
> > -    size_t count;
> >  # endif
> >  #endif
>
> Now all built fine, but I have a problem at install time:
>
> cc  -s -shared -o zutil.so   zutil..o    -lncurses -lm  -lc
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  zutil.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/zutil.so
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  compctl.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/compctl.so
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  complete.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/complete.so
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  complist.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/complist.so
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  computil.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/computil.so
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  deltochar.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/deltochar.so
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  zle.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/zle.so
> /bin/sh ../../mkinstalldirs /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh
> install  -s -o root -g wheel -m 555  zleparameter.so
> /tmp/zsh-4.3.4/lib/zsh/4.3.4/zsh/zleparameter.so
> if test x/tmp/zsh-4.3.4/share/zsh/4.3.4/functions != x && test
> x/tmp/zsh-4.3.4/share/zsh/4.3.4/functions != xno; then  test
> x/tmp/zsh-4.3.4/share/zsh/site-functions != xno &&  /bin/sh
> ./mkinstalldirs /tmp/zsh-4.3.4/share/zsh/site-functions;  sdir_top="."
> fndir="/tmp/zsh-4.3.4/share/zsh/4.3.4/functions" dir_top="."
> scriptdir="/tmp/zsh-4.3.4/share/zsh/4.3.4/scripts"
> FUNCTIONS_SUBDIRS="yes"  INSTALL_DATA="install  -o root -g wheel -m
> 444"  INSTALL_PROGRAM="install  -s -o root -g wheel -m 555"
> DESTDIR="" VERSION="4.3.4"  /bin/sh ./Config/installfns.sh || exit 1;
> fi;  exit 0
> mkdir /tmp/zsh-4.3.4/share/zsh
> mkdir /tmp/zsh-4.3.4/share/zsh/site-functions
> mkdir /tmp/zsh-4.3.4/share/zsh/4.3.4
> mkdir /tmp/zsh-4.3.4/share/zsh/4.3.4/functions
> mkdir /tmp/zsh-4.3.4/share/zsh/4.3.4/functions/Exceptions
> mkdir /tmp/zsh-4.3.4/share/zsh/4.3.4/functions/Misc
> strip: /tmp/zsh-4.3.4/share/zsh/4.3.4/functions/Misc/harden: File
> format not recognized
> install: wait: No such file or directory
> *** Error code 1
>
> Somebody can give me some help? The problem seems to be on Config/installfns.sh

I figured it out, the problem is caused because some Functions and
Completions has 0755 permissions, so, installfns.sh consider it
executable and call install with -s.

-- 
Renato Botelho

