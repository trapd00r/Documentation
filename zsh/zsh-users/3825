From zsh-users-return-3825-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 19 05:11:20 2001
Return-Path: <zsh-users-return-3825-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7315 invoked from network); 19 Apr 2001 05:11:19 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Apr 2001 05:11:19 -0000
Received: (qmail 27351 invoked by alias); 19 Apr 2001 05:10:41 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 3825
Received: (qmail 27332 invoked from network); 19 Apr 2001 05:10:40 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
Date: Thu, 19 Apr 2001 09:10:36 +0400 (MSD)
From: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
X-X-Sender:  <bor@itsrm2.mow.siemens.ru>
To: Andre Pang <ozone@algorithm.com.au>
cc: zsh-users <zsh-users@sunsite.auc.dk>
Subject: Re: { foo=bar; command; } | othercommand; echo $foo == no output?
In-Reply-To: <20010419133634.A5425@exodus>
Message-ID: <Pine.SV4.4.33.0104190905120.2959-100000@itsrm2.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 19 Apr 2001, Andre Pang wrote:

> I have a problem,  I want to tee and still get the return code:
>
>   prog  x y z | tee
>   echo $?
>

In recent enough zsh (4.0.1-pre-3 is the latest version) you can use
$pipestatus:

pipestatus <S> <Z>
     An array containing the exit values returned by all commands in the
     last pipeline.

bor@itsrm2:~%> cat /foo/bar | tee
cat: Cannot open /foo/bar: No such file or directory
bor@itsrm2:~%> print $pipestatus
2 0

-andrej



