From zsh-workers-return-6298-mason-zsh=primenet.com.au@sunsite.auc.dk Mon May 17 09:00:53 1999
Return-Path: <zsh-workers-return-6298-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2661 invoked from network); 17 May 1999 09:00:52 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 17 May 1999 09:00:52 -0000
Received: (qmail 27260 invoked by alias); 17 May 1999 09:00:32 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6298
Received: (qmail 27252 invoked from network); 17 May 1999 09:00:31 -0000
Date: Mon, 17 May 1999 11:00:29 +0200 (MET DST)
Message-Id: <199905170900.LAA14975@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Jens Schleusener's message of Sat, 15 May 1999 20:34:55 +0200
	(DFT)
Subject: Re: zsh-3.1.5-pws-18 substitution bug ?


Jens Schleusener wrote:

> between versions zsh-3.1.5-pws-16 and zsh-3.1.5-pws-18 there was
> introduced probably a bug (?) regarding substitutions like
> 
>   ${*:-word}
> 
> that no longer works if $* name is empty or undefined.

multsub() didn't set `*isarr = 0' when returning a joined array.

Bye
 Sven

--- os/subst.c	Fri May 14 09:08:03 1999
+++ Src/subst.c	Mon May 17 10:57:42 1999
@@ -285,6 +285,8 @@
 	}
 	*s = sepjoin(r, NULL);
 	mult_isarr = omi;
+	if (isarr)
+	    *isarr = 0;
 	return 0;
     }
     if (l)

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

