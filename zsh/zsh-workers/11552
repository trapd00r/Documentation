From zsh-workers-return-11552-mason-zsh=primenet.com.au@sunsite.auc.dk Wed May 24 08:31:11 2000
Return-Path: <zsh-workers-return-11552-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27860 invoked from network); 24 May 2000 08:31:10 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 May 2000 08:31:10 -0000
Received: (qmail 3958 invoked by alias); 24 May 2000 08:30:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11552
Received: (qmail 3944 invoked from network); 24 May 2000 08:30:43 -0000
Date: Wed, 24 May 2000 10:29:11 +0200 (MET DST)
Message-Id: <200005240829.KAA23193@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Bart Schaefer"'s message of Wed, 24 May 2000 04:41:58 +0000
Subject: PATCH: Re: _rpm odd behavior


Bart Schaefer wrote:

> ...
> 
> Is it a new problem that _arguments has trouble dealing with multiple
> single-letter options packed in the same word?

It wasn't. My fault (of course, sigh). It reset the `single' flag in
parse_cadef() although it shouldn't.

IT also adds the `-c'. Any other missing options anywhere?

Bye
 Sven

Index: Completion/Linux/_rpm
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Linux/_rpm,v
retrieving revision 1.8
diff -u -r1.8 _rpm
--- Completion/Linux/_rpm	2000/05/22 14:11:34	1.8
+++ Completion/Linux/_rpm	2000/05/24 08:29:32
@@ -96,7 +96,7 @@
   case "$lstate" in
   query)
     _arguments -s \
-      '*-v[verbose mode]' -q \
+      '*-v[verbose mode]' -q -c \
       '--rcfile:resource file:_files' \
       '--ftpproxy:FTP proxy server:_hosts' \
       '--ftpport:FTP port number:' \
Index: Src/Zle/computil.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/computil.c,v
retrieving revision 1.22
diff -u -r1.22 computil.c
--- Src/Zle/computil.c	2000/05/22 09:28:35	1.22
+++ Src/Zle/computil.c	2000/05/24 08:29:34
@@ -628,7 +628,6 @@
 
     all = ret = alloc_cadef(oargs, single, match, flags);
     optp = &(ret->opts);
-    single = flags = 0;
     anum = 1;
 
     sargs = args;
@@ -664,7 +663,7 @@
 		set_cadef_opts(ret);
 		ret = ret->snext = alloc_cadef(NULL, single, NULL, flags);
 		optp = &(ret->opts);
-		single = flags = nopts = ndopts = nodopts = 0;
+		nopts = ndopts = nodopts = 0;
 		anum = 1;
 	    }
 	    continue;

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

