From zsh-workers-return-21677-mason-zsh=primenet.com.au@sunsite.dk Fri Aug 19 17:18:04 2005
Return-Path: <zsh-workers-return-21677-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8330 invoked from network); 19 Aug 2005 17:18:00 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 19 Aug 2005 17:18:00 -0000
Received: (qmail 37052 invoked from network); 19 Aug 2005 17:17:53 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 19 Aug 2005 17:17:53 -0000
Received: (qmail 13133 invoked by alias); 19 Aug 2005 17:17:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21677
Received: (qmail 13112 invoked from network); 19 Aug 2005 17:17:49 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 19 Aug 2005 17:17:49 -0000
Received: (qmail 36598 invoked from network); 19 Aug 2005 17:17:49 -0000
Received: from dsl3-63-249-88-2.cruzio.com (HELO dot.blorf.net) (63.249.88.2)
  by a.mx.sunsite.dk with SMTP; 19 Aug 2005 17:17:41 -0000
Received: by dot.blorf.net (Postfix, from userid 1000)
	id 6CADD38A3; Fri, 19 Aug 2005 10:17:39 -0700 (PDT)
Date: Fri, 19 Aug 2005 10:17:39 -0700
From: Wayne Davison <wayned@users.sourceforge.net>
To: Peter Stephenson <pws@csr.com>
Cc: zsh-workers@sunsite.dk
Subject: Re: PATCH: insert-unicode-char
Message-ID: <20050819171739.GA8782@blorf.net>
References: <200508181543.j7IFhDjV003092@news01.csr.com> <20050818220853.GC5006@puritan.pnetwork> <29060.1124443370@csr.com> <20050819163131.409874e7.pws@csr.com>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="uQr8t48UFsdbeI+V"
Content-Disposition: inline
In-Reply-To: <20050819163131.409874e7.pws@csr.com>
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4


--uQr8t48UFsdbeI+V
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

On Fri, Aug 19, 2005 at 04:31:31PM +0100, Peter Stephenson wrote:
> The RQUOTE() was because nroff is doing something funny with right
> quotes, but it seems this is beyond the reach of Yodl so it doesn't
> have any practical effect.

My version of yodl is patched to transform ' into \&' instead of \',
but it appears that yodl is not touching the ' in this context:

    sitem(tt('))(

I therefore patched the sed command in the Makefile.in to tweak the
resulting nroff source to add in the missing \& prefix.  Attached is a
patch.

I'll also attach a patch for anyone using a stock version of yodl (this
patch is derived from Debian, and some other distributions already
include it too).

..wayne..

--uQr8t48UFsdbeI+V
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="apostrophe.patch"

--- Doc/Makefile.in	31 Jul 2005 18:04:35 -0000	1.27
+++ Doc/Makefile.in	19 Aug 2005 17:09:37 -0000
@@ -117,7 +117,8 @@ zsh.info: $(sdir)/zsh.texi
 	esac; \
 	case '$(YODL)' in :*) touch $$target ;; *) \
 	    echo $(YODL) -o $$target -I$(sdir) -w zman.yo version.yo $< ; \
-	    $(YODL) -I$(sdir) -w zman.yo version.yo $< | sed -e '1s/\\-/-/g' -e '/^\.'\''/d' > $$target \
+	    $(YODL) -I$(sdir) -w zman.yo version.yo $< | \
+	      sed -e '1s/\\-/-/g' -e '/^\.'\''/d' -e 's/\\fB'\''\\fP/\\fB\\\&'\''\\fP/' > $$target \
 	;; esac; \
 
 # These targets are no longer made by default, nor

--uQr8t48UFsdbeI+V
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="yodl.patch"

--- yodl-1.31.18.orig/macros/chartables/man.tables.yo
+++ yodl-1.31.18/macros/chartables/man.tables.yo
@@ -3,7 +3,7 @@
 DEFINECHARTABLE(standard)(
     '\\'    = "\\e"
     '.'	    = "\\&."
-    '\''    = "\\'"
+    '\''    = "\\&'"
 )
 
 COMMENT(*** Accent characters, leading to empty chars. ***)

--uQr8t48UFsdbeI+V--

