From zsh-workers-return-10692-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Apr 12 11:09:23 2000
Return-Path: <zsh-workers-return-10692-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17897 invoked from network); 12 Apr 2000 11:09:21 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 12 Apr 2000 11:09:21 -0000
Received: (qmail 13603 invoked by alias); 12 Apr 2000 11:09:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10692
Received: (qmail 13573 invoked from network); 12 Apr 2000 11:09:07 -0000
Date: Wed, 12 Apr 2000 13:09:05 +0200 (MET DST)
Message-Id: <200004121109.NAA09784@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Adam Spiers's message of Tue, 11 Apr 2000 21:38:23 +0100
Subject: PATCH: Re: core dump with fc


Adam Spiers wrote:

> I have an alias for extracting from tar balls after looking at them
> (thanks Bart :-)
> 
> xt: aliased to fc -e - tvf=xf ztf=zxf -1
> 
> However ...
> 
> $ echo tvf
> $ xt
> zsh: 15486 segmentation fault (core dumped)  zsh
> 
> Stack trace follows.  This /doesn't/ happen if I start up with -f, but
> I'm hoping the bug is obvious enough that I won't have to narrow the
> problem down to one particular line in my huge .zshrc.

The next field of the `struct asgment's for the substitutions wasn't
initialised properly.

Bye
 Sven

Index: Src/builtin.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/builtin.c,v
retrieving revision 1.4
diff -u -r1.4 builtin.c
--- Src/builtin.c	2000/04/04 14:08:56	1.4
+++ Src/builtin.c	2000/04/12 11:06:56
@@ -1224,6 +1224,7 @@
 	}
 	a->name = *argv;
 	a->value = s;
+	a->next = NULL;
 	argv++;
     }
     /* interpret and check first history line specifier */

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

