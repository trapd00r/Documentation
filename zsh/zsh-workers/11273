From zsh-workers-return-11273-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 09 09:50:49 2000
Return-Path: <zsh-workers-return-11273-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15254 invoked from network); 9 May 2000 09:50:48 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 May 2000 09:50:48 -0000
Received: (qmail 22404 invoked by alias); 9 May 2000 09:50:25 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11273
Received: (qmail 22390 invoked from network); 9 May 2000 09:50:24 -0000
Date: Tue, 9 May 2000 11:50:21 +0200 (MET DST)
Message-Id: <200005090950.LAA13244@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 09 May 2000 18:41:02 +0900
Subject: PATCH: Re: gcc -M<TAB>


Tanaka Akira wrote:

> Z(4):akr@serein% Src/zsh -f  
> serein% bindkey -e; autoload -U compinit; compinit -D 
> serein% gcc -M<TAB>
> _arguments:165: not an identifier: L:|-{fW}no-=-{fW} r:|[_-]=* r:|=*
> serein% gcc -M

Ahem. No good using an option for more than one purpose (-M was used
for comparguments and _argument_sets).

Oh Gott, wie peinlich.

Bye
 Sven

Index: Completion/Base/_argument_sets
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Base/_argument_sets,v
retrieving revision 1.1
diff -u -r1.1 _argument_sets
--- Completion/Base/_argument_sets	2000/04/25 09:48:09	1.1
+++ Completion/Base/_argument_sets	2000/05/09 09:49:31
@@ -20,7 +20,7 @@
 while true; do
   end=$argv[(i)-]
 
-  _arguments -M xor "$1" "$all[@]" "${(@)argv[2,end-1]}"
+  _arguments -m xor "$1" "$all[@]" "${(@)argv[2,end-1]}"
   r=$?
 
   oopt_args=( "$oopt_args[@]" "${(kv)opt_args}" )
Index: Completion/Base/_arguments
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Base/_arguments,v
retrieving revision 1.13
diff -u -r1.13 _arguments
--- Completion/Base/_arguments	2000/05/09 09:44:27	1.13
+++ Completion/Base/_arguments	2000/05/09 09:49:31
@@ -150,13 +150,13 @@
 
 multi=(-i)
 subopts=()
-while [[ "$1" = -(O*|C|M*) ]]; do
+while [[ "$1" = -(O*|C|m*) ]]; do
   case "$1" in
   -C) usecc=yes; shift ;;
   -O) subopts=( "${(@P)2}" ); shift 2 ;;
   -O*)  subopts=( "${(@P)1[3,-1]}" ); shift ;;
-  -M) ismulti=yes multi=(-I "$2" "$3"); shift 3 ;;
-  -M*) ismulti=yes multi=(-I "${1[3,-1]}" "$2"); shift 2 ;;
+  -m) ismulti=yes multi=(-I "$2" "$3"); shift 3 ;;
+  -m*) ismulti=yes multi=(-I "${1[3,-1]}" "$2"); shift 2 ;;
   esac
 done
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

