From zsh-workers-return-20484-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 13 17:40:01 2004
Return-Path: <zsh-workers-return-20484-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29338 invoked from network); 13 Oct 2004 17:40:00 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Oct 2004 17:40:00 -0000
Received: (qmail 72746 invoked from network); 13 Oct 2004 17:39:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2004 17:39:54 -0000
Received: (qmail 15971 invoked by alias); 13 Oct 2004 17:39:39 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20484
Received: (qmail 15953 invoked from network); 13 Oct 2004 17:39:38 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 13 Oct 2004 17:39:38 -0000
Received: (qmail 72198 invoked from network); 13 Oct 2004 17:38:39 -0000
Received: from pop-a065c05.pas.sa.earthlink.net (207.217.121.183)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2004 17:38:38 -0000
Received: from daisy.psp.pas.earthlink.net ([207.217.78.223])
	by pop-a065c05.pas.sa.earthlink.net with esmtp (Exim 3.33 #1)
	id 1CHn5B-00010a-00
	for zsh-workers@sunsite.dk; Wed, 13 Oct 2004 10:38:37 -0700
Message-ID: <23496743.1097689117107.JavaMail.root@daisy.psp.pas.earthlink.net>
Date: Wed, 13 Oct 2004 10:38:36 -0700 (PDT)
From: Jamax <codemonkey49@earthlink.net>
Reply-To: Jamax <codemonkey49@earthlink.net>
To: zsh-workers@sunsite.dk
Subject: data loss in pipes
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Mailer: Earthlink Zoo Mail 1.0
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=1.0 required=6.0 tests=FROM_ENDS_IN_NUMS autolearn=no 
	version=2.63
X-Spam-Hits: 1.0


Hi,

I've been having some problems with pipes and data loss with zsh and I wanted to bring it to your attention.  Recently I noticed that linux kernels would not compile as they would either fail during assembly because of strange errors (comments interpreted as instructions, etc) and then it started happening in some software at work and I finally clued in that zsh is losing data through pipes.

For example, I run:
    make 2>&1 | grep 'undefined reference'

And I usually get a truncated list as a result, whereas with bash and it always prints the full output (the kernel compiles work in bash too).

My gentoo config:
    sys-devel/gcc-3.4.2-r2
    app-shells/zsh-4.2.1
    app-shells/bash-3.0-r6
    sys-kernel/development-sources-2.6.9_rc2
    CFLAGS=-O -fPIC -pipe

I think this could possibly be a gcc compiler problem, as I compiled gcc, make, etc with these cflags:
    CFLAGS=-O2 -ftracer -fprefetch-loop-arrays -march=pentium4 -frename-registers -fmove-all-movables -freduce-all-givs -pipe

Jam




