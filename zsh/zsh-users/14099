From zsh-users-return-14099-mason-zsh=primenet.com.au@sunsite.dk Wed May 06 12:27:18 2009
Return-Path: <zsh-users-return-14099-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29356 invoked from network); 6 May 2009 12:27:15 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 6 May 2009 12:27:15 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 69771 invoked from network); 6 May 2009 12:26:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 6 May 2009 12:26:59 -0000
Received: (qmail 19291 invoked by alias); 6 May 2009 12:26:40 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14099
Received: (qmail 19277 invoked from network); 6 May 2009 12:26:39 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 6 May 2009 12:26:39 -0000
Received: from exprod8og105.obsmtp.com (exprod8og105.obsmtp.com [64.18.3.90])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 4354480590A3
	for <zsh-users@sunsite.dk>; Wed,  6 May 2009 14:26:09 +0200 (CEST)
Received: from source ([153.98.68.229]) (using TLSv1) by exprod8ob105.postini.com ([64.18.7.12]) with SMTP
	ID DSNKSgGB9pHl7JZf7cdq/UUJx1gnu1Bv424g@postini.com; Wed, 06 May 2009 05:26:33 PDT
Received: from HHBRUE007.hq.corp.eurocontrol.int (hhbrue007.hq.corp.eurocontrol.int [193.221.160.203])
	by draco.eurocontrol.be (8.13.8/8.13.8) with ESMTP id n46CQWKT023318
	for <zsh-users@sunsite.dk>; Wed, 6 May 2009 14:26:32 +0200
Received: from FFBRUE001.cfmu.corp.eurocontrol.int ([193.58.25.50]) by HHBRUE007.hq.corp.eurocontrol.int with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 6 May 2009 14:26:28 +0200
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: zsh in ksh emulation mode: typeset -i "allows" string as variable value
Date: Wed, 6 May 2009 14:26:27 +0200
Message-ID: <38D4FA2BB99A674BADDED237051D97A70AC9845E@FFBRUE001.cfmu.corp.eurocontrol.int>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: zsh in ksh emulation mode: typeset -i "allows" string as variable value
Thread-Index: AcnOReD+phNpDLSdQguBtnHSRNnGKA==
From: "Tristan TERPELLE" <tristan.terpelle@eurocontrol.int>
To: <zsh-users@sunsite.dk>
X-OriginalArrivalTime: 06 May 2009 12:26:28.0505 (UTC) FILETIME=[E1518090:01C9CE45]
X-Virus-Scanned: ClamAV 0.92.1/9333/Wed May  6 05:55:26 2009 on bifrost
X-Virus-Status: Clean

We're running zsh in ksh emulation. It has come to our attention that
it's possible to assign a non-integer value to a variable defined as
integer with "typeset -i" (or with "integer").=20

After assigning a string to an integer variable, the exit code is 0. The
new value of the variable is 0 aswell.=20

On HP-UX's ksh, however, such an operation isn't permitted resulting in
an error message and an exit code of 1.

Is this normal behaviour for zsh or a bug? Can this behaviour be changed
through zsh' options?


For example, zsh-4.2.6-2.hotfix on RHEL 5.1 x86_64

foo@bar: typeset -i day=3D5
foo@bar: echo $?
0
foo@bar: echo $day
5
foo@bar: day=3Dfive
foo@bar: echo $?
0
foo@bar: echo $day
0
foo@bar: typeset -i day=3Dfive
foo@bar: echo $?
0
foo@bar: echo $day
0
foo@bar: uname -a
Linux bar 2.6.18-53.el5 #1 SMP Wed Oct 10 16:34:19 EDT 2007 x86_64
x86_64 x86_64 GNU/Linux
foo@bar: rpm -q zsh
zsh-4.2.6-2.hotfix

... and ksh on HP-UX 11.11

foo@hpux: typeset -i day=3D5
foo@hpux: echo $?
0
foo@hpux: echo $day
5
foo@hpux: day=3Dfive
ksh: five: bad number
foo@hpux: echo $?
1
foo@hpux: echo $day
5
foo@hpux: uname -a
HP-UX hpux B.11.11 U 9000/800 645092970 unlimited-user license


---

Tristan Terpelle
____

This message and any files transmitted with it are legally privileged and=
 intended for the sole use of the individual(s) or entity to whom they ar=
e addressed. If you are not the intended recipient, please notify the sen=
der by reply and delete the message and any attachments from your system.=
 Any unauthorised use or disclosure of the content of this message is str=
ictly prohibited and may be unlawful.

Nothing in this e-mail message amounts to a contractual or legal commitme=
nt on the part of EUROCONTROL, unless it is confirmed by appropriately si=
gned hard copy.

Any views expressed in this message are those of the sender.
=0D

