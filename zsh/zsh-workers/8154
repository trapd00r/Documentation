From zsh-workers-return-8154-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Oct 07 11:05:53 1999
Return-Path: <zsh-workers-return-8154-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21368 invoked from network); 7 Oct 1999 11:05:52 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Oct 1999 11:05:52 -0000
Received: (qmail 26640 invoked by alias); 7 Oct 1999 11:05:23 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8154
Received: (qmail 26630 invoked from network); 7 Oct 1999 11:05:23 -0000
Subject: PATCH: option changes
To: zsh-workers@sunsite.auc.dk
Date: Thu, 7 Oct 1999 12:05:21 +0100 (BST)
X-Mailer: ELM [version 2.4ME+ PL48 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Message-Id: <E11ZBMP-0005dU-00@crucigera.fysh.org>
From: Zefram <zefram@fysh.org>

Further to my last message, here's the patch, which I'm sending separately
in case it turns out to be controversial.

It also occurred to me that having SHORT_LOOPS on by default in sh/ksh
mode is rather dubious.  There's a second patch below to change that.

-zefram

--- Src/options.c~	Thu Oct  7 11:56:56 1999
+++ Src/options.c	Thu Oct  7 11:58:17 1999
@@ -105,7 +105,7 @@
 {NULL, "equals",	      OPT_EMULATE|OPT_ZSH,	 EQUALS},
 {NULL, "errexit",	      OPT_EMULATE,		 ERREXIT},
 {NULL, "exec",		      OPT_EMULATE|OPT_ALL,		 EXECOPT},
-{NULL, "extendedglob",	      OPT_EMULATE,		 EXTENDEDGLOB},
+{NULL, "extendedglob",	      OPT_EMULATE|OPT_ZSH,	 EXTENDEDGLOB},
 {NULL, "extendedhistory",     OPT_CSH,			 EXTENDEDHISTORY},
 {NULL, "flowcontrol",	      OPT_ALL,			 FLOWCONTROL},
 {NULL, "functionargzero",     OPT_EMULATE|OPT_NONBOURNE, FUNCTIONARGZERO},
--- Doc/Zsh/options.yo~	Thu Oct  7 12:00:15 1999
+++ Doc/Zsh/options.yo	Thu Oct  7 12:00:59 1999
@@ -329,7 +329,7 @@
 )
 pindex(EXTENDED_GLOB)
 cindex(globbing, extended)
-item(tt(EXTENDED_GLOB))(
+item(tt(EXTENDED_GLOB) <Z>)(
 Treat the `tt(#)', `tt(~)' and `tt(^)' characters as part of patterns
 for filename generation, etc.  (An initial unquoted `tt(~)'
 always produces named directory expansion.)
END

--- Src/options.c~	Thu Oct  7 11:56:56 1999
+++ Src/options.c	Thu Oct  7 11:58:17 1999
@@ -185,7 +185,7 @@
 {NULL, "shglob",	      OPT_EMULATE|OPT_BOURNE,	 SHGLOB},
 {NULL, "shinstdin",	      OPT_SPECIAL,		 SHINSTDIN},
 {NULL, "shoptionletters",     OPT_EMULATE|OPT_BOURNE,	 SHOPTIONLETTERS},
-{NULL, "shortloops",	      OPT_EMULATE|OPT_ALL,	 SHORTLOOPS},
+{NULL, "shortloops",	      OPT_EMULATE|OPT_NONBOURNE, SHORTLOOPS},
 {NULL, "shwordsplit",	      OPT_EMULATE|OPT_BOURNE,	 SHWORDSPLIT},
 {NULL, "singlecommand",	      OPT_SPECIAL,		 SINGLECOMMAND},
 {NULL, "singlelinezle",	      OPT_KSH,			 SINGLELINEZLE},
--- Doc/Zsh/options.yo~	Thu Oct  7 12:00:15 1999
+++ Doc/Zsh/options.yo	Thu Oct  7 12:00:59 1999
@@ -982,7 +982,7 @@
 This also affects the value of the tt(-) special parameter.
 )
 pindex(SHORT_LOOPS)
-item(tt(SHORT_LOOPS) <D>)(
+item(tt(SHORT_LOOPS) <C> <Z>)(
 Allow the short forms of tt(for), tt(select),
 tt(if), and tt(function) constructs.
 )
END

