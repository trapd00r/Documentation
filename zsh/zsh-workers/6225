From zsh-workers-return-6225-mason-zsh=primenet.com.au@sunsite.auc.dk Thu May 06 11:35:27 1999
Return-Path: <zsh-workers-return-6225-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4352 invoked from network); 6 May 1999 11:35:25 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 May 1999 11:35:25 -0000
Received: (qmail 21615 invoked by alias); 6 May 1999 11:35:06 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6225
Received: (qmail 21600 invoked from network); 6 May 1999 11:35:05 -0000
From: Wayne Davison <wayne@clari.net>
Message-Id: <199905061134.EAA07181@bebop.clari.net>
To: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
Cc: zsh-workers@sunsite.auc.dk
In-reply-to: wischnow's message of Tue, 04 May 1999 17:37:20 +0200.
	     <199905041537.RAA01787@beta.informatik.hu-berlin.de> 
Subject: Re: zsh-3.0.6-pre-2: clear list 
Date: Thu, 06 May 1999 04:34:43 -0700
Sender: wayne@clari.net

Sven Wischnowsky writes:
> --- Src/zle_refresh.c.old	Tue May  4 17:06:35 1999
> +++ Src/zle_refresh.c	Tue May  4 17:26:22 1999
> @@ -61,6 +61,16 @@
>  static unsigned pmpt_attr = 0,	/* text attributes after displaying pro
> mpt  */
>      rpmpt_attr = 0;		/* text attributes after displaying rprompt */
>  
> +/* Non-zero if a completion list was displayed. */
> +
> +/**/
> +int listshown;
> +
> +/* Non-zero if refresh() should clear the list below the prompt. */
> +
> +/**/
> +int clearlist;
> +
>  /**/
>  void
>  resetvideo(void)

I don't think this is the right way to do this for 3.0.6.  These
variables don't get prefixed with "extern" in the .pro file, and I
believe that this will fail on a system whose linker doesn't merge
duplicate data definitions.  I moved these lines to globals.h (sans
the /**/ tags) and prefixed them with "EXTERN".

..wayne..

