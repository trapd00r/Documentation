From zsh-workers-return-21847-mason-zsh=primenet.com.au@sunsite.dk Thu Oct 06 23:27:30 2005
Return-Path: <zsh-workers-return-21847-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24255 invoked from network); 6 Oct 2005 23:27:28 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 6 Oct 2005 23:27:28 -0000
Received: (qmail 84427 invoked from network); 6 Oct 2005 23:27:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 6 Oct 2005 23:27:22 -0000
Received: (qmail 25396 invoked by alias); 6 Oct 2005 23:27:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21847
Received: (qmail 25379 invoked from network); 6 Oct 2005 23:27:14 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 6 Oct 2005 23:27:14 -0000
Received: (qmail 83346 invoked from network); 6 Oct 2005 23:27:14 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 6 Oct 2005 23:27:14 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 48F357C08E; Thu,  6 Oct 2005 19:27:12 -0400 (EDT)
Date: Thu, 6 Oct 2005 19:27:12 -0400
From: Clint Adams <clint@zsh.org>
To: zsh-workers@sunsite.dk
Subject: segfault with certain filenames
Message-ID: <20051006232712.GA1886@scowler.net>
Mail-Followup-To: zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.5 required=5.0 tests=AWL,BAYES_00,LONGWORDS 
	autolearn=no version=3.0.4

In an 84-column-wide terminal,

% touch "aaaaaaaaa bbbbbbbbb ccccccccc ddddddddd eeeeeeeee fffffffff ggggggggg hhhh".{1..100}

In an 80-column-wide terminal,

% touch "aaaaaaaaa bbbbbbbbb ccccccccc ddddddddd eeeeeeeee fffffffff ggggggggg ".{1..100}


After tabbing through file completion in the former case,

#0  clprintm (g=0x8196890, mp=0x81967bc, mc=Variable "mc" is not available.
) at ../../../Src/Zle/complist.c:1532
        mm = Variable "mm" is not available.
(gdb) bt
#0  clprintm (g=0x8196890, mp=0x81967bc, mc=Variable "mc" is not available.
) at ../../../Src/Zle/complist.c:1532
#1  0xb7b0eb46 in complistmatches (dummy=0xb7b91850, dat=0x28817564)
    at ../../../Src/Zle/complist.c:1650
#2  0xb7b8dd33 in list_matches (dummy=0xb7bc1e40, dummy2=0x0)
    at ../../../Src/Zle/compresult.c:2214
#3  0xb7baca0f in zrefresh () at ../../../Src/Zle/zle_refresh.c:767
#4  0xb7b1176c in domenuselect (dummy=0xb7b91814, dat=0xbfc1a86c)
    at ../../../Src/Zle/complist.c:2236
#5  0x0808b138 in runhookdef (h=0xb7b91814, d=0xbfc1a86c)
    at ../../Src/module.c:1883
#6  0xb7b7c7ee in after_complete (dummy=0xb7bc1e7c, dat=0x28817564)
    at ../../../Src/Zle/compcore.c:513
#7  0xb7bb410c in docomplete (lst=0) at ../../../Src/Zle/zle_tricky.c:851
#8  0xb7bb06a8 in completecall (args=0x2880ef7c)
    at ../../../Src/Zle/zle_tricky.c:208
#9  0xb7ba48ae in execzlefunc (func=0xb7bbf310, args=0xb7bc213c)
    at ../../../Src/Zle/zle_main.c:1087
#10 0xb7ba4bb0 in zlecore () at ../../../Src/Zle/zle_main.c:862
#11 0xb7ba57e7 in zleread (lp=0x80d1e00, rp=0x0, flags=679572836, 
    context=679572836) at ../../../Src/Zle/zle_main.c:1016
#12 0x0807b108 in ingetc () at ../../Src/input.c:278
#13 0x08074341 in ihgetc () at ../../Src/hist.c:240
#14 0x08082196 in gettok () at ../../Src/lex.c:628
#15 0x080831d5 in yylex () at ../../Src/lex.c:344
#16 0x0809b7f9 in parse_event () at ../../Src/parse.c:451
#17 0x08077df5 in loop (toplevel=1, justonce=0) at ../../Src/init.c:128
#18 0x0807a6ec in zsh_main (argc=1, argv=0xbfc1b7a4) at ../../Src/init.c:1312

