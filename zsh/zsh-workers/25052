From zsh-workers-return-25052-mason-zsh=primenet.com.au@sunsite.dk Fri May 16 11:40:58 2008
Return-Path: <zsh-workers-return-25052-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1468 invoked from network); 16 May 2008 11:40:55 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 May 2008 11:40:55 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 37346 invoked from network); 16 May 2008 11:40:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 May 2008 11:40:49 -0000
Received: (qmail 390 invoked by alias); 16 May 2008 11:40:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25052
Received: (qmail 374 invoked from network); 16 May 2008 11:40:45 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 16 May 2008 11:40:45 -0000
Received: from cluster-g.mailcontrol.com (cluster-g.mailcontrol.com [85.115.41.190])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 90DE780589A4
	for <zsh-workers@sunsite.dk>; Fri, 16 May 2008 13:40:40 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly30g.srv.mailcontrol.com (MailControl) with ESMTP id m4GBebwg004096
	for <zsh-workers@sunsite.dk>; Fri, 16 May 2008 12:40:38 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 16 May 2008 12:40:15 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id m4GBeGKi032423
	for <zsh-workers@sunsite.dk>; Fri, 16 May 2008 12:40:16 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id m4GBeFRl032420
	for <zsh-workers@sunsite.dk>; Fri, 16 May 2008 12:40:15 +0100
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: PATCH: colour clarifications
X-Mailer: MH-E 8.0.3; nmh 1.3-RC1; GNU Emacs 22.1.1
Date: Fri, 16 May 2008 12:40:15 +0100
Message-ID: <32419.1210938015@csr.com>
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 16 May 2008 11:40:15.0995 (UTC) FILETIME=[9C20CCB0:01C8B749]
X-Scanned-By: MailControl A-08-50-03 (www.mailcontrol.com) on 10.71.0.140
X-Virus-Scanned: ClamAV 0.91.2/7134/Fri May 16 12:51:30 2008 on bifrost
X-Virus-Status: Clean


Welcome to repetition city.

Index: Doc/Zsh/compctl.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/compctl.yo,v
retrieving revision 1.8
diff -u -r1.8 compctl.yo
--- Doc/Zsh/compctl.yo	5 Jan 2007 20:55:03 -0000	1.8
+++ Doc/Zsh/compctl.yo	16 May 2008 11:38:19 -0000
@@ -469,7 +469,8 @@
 string.
 
 The sequences tt(%B), tt(%b), tt(%S), tt(%s), tt(%U), and tt(%u) specify
-output attributes (bold, standout, and underline) and tt(%{...%}) can
+output attributes (bold, standout, and underline), tt(%F), tt(%f), tt(%K),
+tt(%k) specify foreground and background colours, and tt(%{...%}) can
 be used to include literal escape sequences as in prompts.
 )
 item(tt(-Y) var(explanation))(
Index: Doc/Zsh/compsys.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/compsys.yo,v
retrieving revision 1.208
diff -u -r1.208 compsys.yo
--- Doc/Zsh/compsys.yo	1 Apr 2008 09:22:30 -0000	1.208
+++ Doc/Zsh/compsys.yo	16 May 2008 11:38:25 -0000
@@ -1512,9 +1512,15 @@
 If this is set for the tt(descriptions) tag, its value is used as a
 string to display above matches in completion lists.  The sequence
 `tt(%d)' in this string will be replaced with a short description of
-what these matches are.  This string may also contain the sequences to
-specify output attributes, such as `tt(%B)', `tt(%S)' and
-`tt(%{)...tt(%})'.
+what these matches are.  This string may also contain the following
+sequences to specify output attributes,
+ifnzman(noderef(Prompt Expansion))\
+ifzman(as described in the section PROMPT EXPANSION in zmanref(zshmisc)):
+`tt(%B)', `tt(%S)', `tt(%U)', `tt(%F)', `tt(%K)' and their lower case
+counterparts, as well as `tt(%{)...tt(%})'.  `tt(%F)', `tt(%K)' and
+`tt(%{)...tt(%})' take arguments in the same form as prompt
+expansion.  Note that the tt(%G) sequence is not available; an argument
+to `tt(%{)' should be used instead.
 
 The style is tested with each tag valid for the current completion
 before it is tested for the tt(descriptions) tag.  Hence different format 
@@ -1870,9 +1876,10 @@
 be replaced by a variable width string.  As in other prompt strings, the
 escape sequences `tt(%S)', `tt(%s)', `tt(%B)', `tt(%b)', `tt(%U)',
 `tt(%u)' for entering and leaving the display modes
-standout, bold and underline are also available, as is the form
+standout, bold and underline, and `tt(%F)', `tt(%f)', `tt(%K)', `tt(%k)' for
+changing the foreground background colour, are also available, as is the form
 `tt(%{)...tt(%})' for enclosing escape sequences which display with zero
-width.
+(or, with a numeric argument, some other) width.
 
 After deleting this prompt the variable tt(LISTPROMPT) should be unset for
 the the removal to take effect.
Index: Doc/Zsh/mod_complist.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/mod_complist.yo,v
retrieving revision 1.22
diff -u -r1.22 mod_complist.yo
--- Doc/Zsh/mod_complist.yo	12 May 2008 17:04:01 -0000	1.22
+++ Doc/Zsh/mod_complist.yo	16 May 2008 11:38:25 -0000
@@ -160,7 +160,8 @@
 parameter must be set.  Its value will be used as the prompt; if it
 is the empty string, a default prompt will be used.  The value may
 contain escapes of the form `tt(%x)'.  It supports the escapes
-`tt(%B)', `tt(%b)', `tt(%S)', `tt(%s)', `tt(%U)', `tt(%u)' and
+`tt(%B)', `tt(%b)', `tt(%S)', `tt(%s)', `tt(%U)', `tt(%u)', `tt(%F)',
+`tt(%f)', `tt(%K)', `tt(%k)' and
 `tt(%{...%})' used also in shell prompts as well as three pairs of
 additional sequences: a `tt(%l)' or `tt(%L)' is replaced by the number
 of the last line shown and the total number of lines in the form
Index: Doc/Zsh/prompt.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/prompt.yo,v
retrieving revision 1.12
diff -u -r1.12 prompt.yo
--- Doc/Zsh/prompt.yo	9 May 2008 17:33:50 -0000	1.12
+++ Doc/Zsh/prompt.yo	16 May 2008 11:38:26 -0000
@@ -191,7 +191,8 @@
 the values allowed are as described for the tt(fg) tt(zle_highlight)
 attribute;
 ifzman(see em(Character Highlighting) in zmanref(zshzle))\
-ifnzman(noderef(Character Highlighting)).
+ifnzman(noderef(Character Highlighting)).  This means that numeric
+colours are allowed in the second format also.
 )
 item(tt(%K) LPAR()tt(%k)RPAR())(
 Start (stop) using a different bacKground colour.  The syntax is


-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

