From zsh-users-return-5595-mason-zsh=primenet.com.au@sunsite.dk Thu Dec 19 11:42:46 2002
Return-Path: <zsh-users-return-5595-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7234 invoked from network); 19 Dec 2002 11:42:45 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 19 Dec 2002 11:42:45 -0000
Received: (qmail 11051 invoked by alias); 19 Dec 2002 11:42:34 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 5595
Received: (qmail 11044 invoked from network); 19 Dec 2002 11:42:34 -0000
From: Borzenkov Andrey <Andrey.Borzenkov@siemens.com>
To: "'Aidan Kehoe'" <kehoea@parhasard.net>, zsh-users@sunsite.dk
Subject: RE: Dynamically adding to $mailpath?
Date: Thu, 19 Dec 2002 14:42:23 +0300
Message-ID: <6134254DE87BD411908B00A0C99B044F03A0B5AC@MOWD019A>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.4510
In-Reply-To: <15873.44013.976882.301072@gargle.gargle.HOWL>
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2800.1106


> Should this;
> 
>   typeset -a mailpath
>   for i in ~/mail/*.spool; do
>     set $mailpath[$#mailpath+1]="${i}?You have new mail in $(basename $i
> .spool).";
>   done
> 
> have worked? 

No; 

1. $mailpath[$#mailpath+1] is evaluated before even trying to execute
anyting so the above is the same as

set ="{i}..."

2. set foo[bar] is wrong for setting any variable anyway

3. you do not need basename in zsh, it does it internally.


I got around it by using $MAILPATH, but
> 
>   zsh: /home/hcksplat/mail/X.spool?You have new mail in X. not found
>   $
> 
> doesn't seem right to me. ZSH_VERSION=4.0.4, setopt gives nobeep,
> correct, noglobalrcs, histignoredups, histignorespace, interactive,
> monitor, shinstdin.
> 

mailpath=((${$(echo ~/mail/*.spool(N))//(#m)*/$MATCH?You have new mail in
${MATCH:r:t}}))

should work though. Unfortunately you still need one fork (echo) unless I
miss some obvious way to treat result of nested globbing as array.

-andrey

