From schaefer@candle.brasslantern.com Sat Jul 13 13:05:31 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id NAA00946 for <mason@werple.mira.net.au>; Sat, 13 Jul 1996 13:05:28 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id WAA22928; Fri, 12 Jul 1996 22:52:12 -0400 (EDT)
Resent-Date: Fri, 12 Jul 1996 22:41:35 -0400 (EDT)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <960712194219.ZM779@candle.brasslantern.com>
Date: Fri, 12 Jul 1996 19:42:16 -0700
In-Reply-To: unpingco@mpl.UCSD.EDU (Jose Unpingco)
        "Re: On the topic of prompts" (Jul 12, 11:36am)
References: <9607121836.AA10161@cryptica.UCSD.EDU>
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (4.0b.702 02jul96)
To: unpingco@mpl.UCSD.EDU (Jose Unpingco)
Subject: Re: On the topic of prompts
Cc: zsh-users@math.gatech.edu
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"7I-Ob2.0.ca5.Upmvn"@euclid>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/291
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 2036
Status: OR

On Jul 12, 11:36am, Jose Unpingco wrote:
} Subject: Re: On the topic of prompts
}
} I've thought about sticking a highlighted status line on the last line
} of a vt100 or xterm which would contain handy info like PWD, but I
} could never figure out how. Could you be more specific about what you
} mention below? I've never programmed a terminal before and I'm not
} sure what you mean by games with the "termcap sequences".

Since programming a terminal is not something I do for entertainment,
I was hoping *not* to be specific. :-)  However:

If you look at the termcap database, the "cs" capability is the "change
scrolling region" escape sequence.  So, supposing you have an 80x24
screen, AND your terminal supports scrolling regions, AND your termcap
is complete enough to include the "cs" capability (many aren't), THEN
you can do this sort of thing:

	# Remember that zsh numbers lines/columns from 0 (zero)!
	# Also, for some reason, zsh reads termcap args in reverse order,
	# so although the cs string wants to use 1;23, zsh has to be told
	# 23 and then 1.  Similarly for cm.  Is this a bug?

	precmd() {
	    echotc cs $[$LINES-1] 1	# Set scrolling region
	    echotc cm 0 0		# Move cursor to first line
	    print -nP "%S$ZSH_NAME $ZSH_VERSION%s %h %m %n %W %@"
	    echotc cm 0 $[$LINES-1]	# Move cursor to last line
	}

One thing you have to remember is to reset the scrolling region to the
full screen before you run commands like "less", "more", or "vi".  That
means you may have to set up a whole bunch of functions like:

	more() {
	    [[ -t 1 ]] && echotc cs $[$LINES-1] 0	# Full-screen scroll
	    command more $*
	}

Also note that strange things may happen if you try to print more than
one line into the space above the scrolling region.

Specific enough?

-- 
Bart Schaefer                             Brass Lantern Enterprises
http://www.well.com/user/barts            http://www.nbn.com/people/lantern

New male in /home/schaefer:
>N  2 Justin William Schaefer  Sat May 11 03:43  53/4040  "Happy Birthday"


