From zsh-workers-return-6875-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Jun 27 09:38:33 1999
Return-Path: <zsh-workers-return-6875-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3190 invoked from network); 27 Jun 1999 09:38:31 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Jun 1999 09:38:31 -0000
Received: (qmail 15197 invoked by alias); 27 Jun 1999 09:38:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6875
Received: (qmail 15181 invoked from network); 27 Jun 1999 09:38:19 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <990627093815.ZM9764@candle.brasslantern.com>
Date: Sun, 27 Jun 1999 09:38:15 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Zle redisplay bug in pws-24
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

It's probably present in other versions too ... yup, 3.0.6-pre-5 has it ..

It happens with a multiline buffer, and appears to have something to do with
killing a line that is exactly one character shorter than the width of the
terminal.  Here's how I reproduced it:

Start with a prompt string that's ten characters long (e.g. "zagzig<2> " was
mine at the time).  In netscape, go to article 6850 in the zsh-workers
archive; drag-select the patch at the end (from "---" through "sleep(1);").
Back in your zsh terminal, start a here-document ("patch -p0 -R <<'EOF'")
and then paste in the text.  Finish with EOF and hit return.  Note that
the patch fails because of whitespace differences (sigh).  Hit ctrl-P to
call back the here-document and move up to edit the "patch" line.  Decide
that's not what you want to do after all and idly begin tapping ctrl-K
until you see:

zagzig<2>             while ((ttpgrp = gettygrp()) != -1 && ttpgrp != mypgrp) {
                sleep(1);

EOF

The cursor at this moment is right after the prompt.  Hit ctrl-K again and
you see (cursor represented by an underscore):

          _
zagzig<7>       sleep(1);                                                      
                
EOF

Whoops, the prompt moved down to the "sleep(1);" line, but the cursor is
still on the line above it!

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

