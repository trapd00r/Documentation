From zsh-workers-return-7562-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Aug 31 09:20:56 1999
Return-Path: <zsh-workers-return-7562-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18944 invoked from network); 31 Aug 1999 09:20:54 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 31 Aug 1999 09:20:54 -0000
Received: (qmail 8545 invoked by alias); 31 Aug 1999 07:44:43 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7562
Received: (qmail 8532 invoked from network); 31 Aug 1999 07:44:41 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <990831073445.ZM15310@candle.brasslantern.com>
Date: Tue, 31 Aug 1999 07:34:45 +0000
In-Reply-To: <rsq3dx0mwp3.fsf@crane.jaist.ac.jp>
Comments: In reply to Tanaka Akira <akr@jaist.ac.jp>
        "PATCH: 3.1.6-pws-2: Config/installfns.sh" (Aug 31, 12:54pm)
References: <rsq3dx0mwp3.fsf@crane.jaist.ac.jp>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: 3.1.6-pws-2: Config/installfns.sh
Cc: pws@ifh.de
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Aug 31, 12:54pm, Tanaka Akira wrote:
} Subject: PATCH: 3.1.6-pws-2: Config/installfns.sh
}
} I found that Functions/{Makefile,Makefile.in,README.zftp} are
} installed to prefix/share/zsh/functions.

The uninstallfns.sh script needs the same fix, and needs to have the DESTDIR
references inserted as well.


Index: uninstallfns.sh
===================================================================
@@ -7,22 +7,22 @@
   if test -f "$sdir/$file"; then
     install="$install $file"
   else
-    install="$install `echo $sdir/$file | sed -e \"s%$sdir/%%g\"`"
+    install="$install `echo '' $sdir/$file | sed -e \"s% $sdir/%%g\"`"
   fi
 done
 
 for file in $install; do
   if test -f $sdir/$file; then
     if test x$FUNCTIONS_SUBDIRS != x -a x$FUNCTIONS_SUBDIRS != xno; then
-      rm -f $fndir/$file;
-      if test -f $fndir.old/$file; then
-	mv $fndir.old/$file $fndir/$file
+      rm -f $DESTDIR$fndir/$file;
+      if test -f $DESTDIR$fndir.old/$file; then
+	mv $DESTDIR$fndir.old/$file $DESTDIR$fndir/$file
       fi
     else
       bfile="`echo $file | sed -e 's%^.*/%%'`"
-      rm -f "$fndir/$bfile"; \
-      if test -f $fndir.old/$bfile; then
-        mv $fndir.old/$bfile $fndir/$bfile
+      rm -f "$DESTDIR$fndir/$bfile"; \
+      if test -f $DESTDIR$fndir.old/$bfile; then
+        mv $DESTDIR$fndir.old/$bfile $DESTDIR$fndir/$bfile
       fi
     fi
   fi

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

