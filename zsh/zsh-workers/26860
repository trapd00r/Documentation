From zsh-workers-return-26860-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 21 15:37:36 2009
Return-Path: <zsh-workers-return-26860-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14698 invoked from network); 21 Apr 2009 15:37:24 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 21 Apr 2009 15:37:24 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 13470 invoked from network); 21 Apr 2009 15:37:18 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 21 Apr 2009 15:37:18 -0000
Received: (qmail 19333 invoked by alias); 21 Apr 2009 15:37:12 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26860
Received: (qmail 19313 invoked from network); 21 Apr 2009 15:37:12 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 21 Apr 2009 15:37:12 -0000
Received: from QMTA10.westchester.pa.mail.comcast.net (qmta10.westchester.pa.mail.comcast.net [76.96.62.17])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 2D8B38028C72
	for <zsh-workers@sunsite.dk>; Tue, 21 Apr 2009 17:36:11 +0200 (CEST)
Received: from OMTA04.westchester.pa.mail.comcast.net ([76.96.62.35])
	by QMTA10.westchester.pa.mail.comcast.net with comcast
	id iA6A1b0040ldTLk5AFd8pP; Tue, 21 Apr 2009 15:37:08 +0000
Received: from smtp.klanderman.net ([98.217.254.247])
	by OMTA04.westchester.pa.mail.comcast.net with comcast
	id iFd81b00p5M2Np63QFd812; Tue, 21 Apr 2009 15:37:08 +0000
Received: from lwm.klanderman.net (unknown [192.168.100.50])
	by smtp.klanderman.net (Postfix) with ESMTP id 32421B3014B
	for <zsh-workers@sunsite.dk>; Tue, 21 Apr 2009 11:37:07 -0400 (EDT)
Received: by lwm.klanderman.net (Postfix, from userid 500)
	id 0DC819FC5F9; Tue, 21 Apr 2009 11:37:07 -0400 (EDT)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <18925.59426.988752.584683@gargle.gargle.HOWL>
Date: Tue, 21 Apr 2009 11:37:06 -0400
From: Greg Klanderman <gak@klanderman.net>
To: Zsh list <zsh-workers@sunsite.dk>
Subject: file completion problem in 4.3.9-dev-2
Reply-To: gak@klanderman.net
X-Mailer: VM 7.17 under 21.4 (patch 17) "Jumbo Shrimp" XEmacs Lucid
X-Virus-Scanned: ClamAV 0.92.1/9267/Tue Apr 21 14:59:05 2009 on bifrost
X-Virus-Status: Clean


I see this issue more generally with my complete init files loaded.
Under the minimal configuration below, the problem is not as
reproducible, for example substituting "ls" for "cat", or completing
"temp/tom" from the next directory level up do not reproduce it,
whereas they do with my init files.

The problem seems to have to do with the space in the directory names;
if I remove the spaces, or substitute a character that does not need
to be escaped, I cannot reproduce the problem.

| [~] greg@lwm| zsh -f
| lwm% echo $ZSH_VERSION
| 4.3.9-dev-2
| lwm% echo $ZSH_PATCHLEVEL
| 1.4656
| lwm% rm .zcompdump
| lwm% autoload -U compinit
| lwm% compinit -u
| lwm% zstyle ':completion:*' matcher-list '' 'm:{a-zA-Z}={A-Za-z}' '+ l:|=* r:|=*'
| lwm% setopt noautomenu
| lwm% cd temp
| lwm% ls -l
| total 20
| drwxr-xr-x  2 greg greg 4096 Apr 21 10:28 Buffalo Tom
| drwxr-xr-x  2 greg greg 4096 Apr 21 10:28 Flanagan, Tommy
| drwxr-xr-x  2 greg greg 4096 Apr 21 10:28 Petty, Tom
| drwxr-xr-x  2 greg greg 4096 Apr 21 10:28 Russell, Tom
| drwxr-xr-x  2 greg greg 4096 Apr 21 10:28 Waits, Tom
| lwm%                  

Now if I type "cat tom" and hit <Control-d> to list completions, I see:

| lwm% cat tom
| Buffalo\ Tom/      Flanagan,\ Tommy/  Petty,\ Tom/       Russell,\ Tom/     Waits,\ Tom/

OK, now hit <tab> to complete and I get:

| lwm% cat \ Tom

OK, now <Control-d> lists:

| lwm% cat \ Tom
| Buffalo\ Tom/      Flanagan,\ Tommy/  Petty,\ Tom/       Russell,\ Tom/     Waits,\ Tom/

OK, now <tab> again *incorrectly* completes to:

| lwm% cat o\ Tom

thanks,
Greg

