From zsh-workers-return-9278-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Jan 09 18:42:40 2000
Return-Path: <zsh-workers-return-9278-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1525 invoked from network); 9 Jan 2000 18:42:39 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 Jan 2000 18:42:39 -0000
Received: (qmail 17830 invoked by alias); 9 Jan 2000 18:42:32 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9278
Received: (qmail 17820 invoked from network); 9 Jan 2000 18:42:32 -0000
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: PATCH: _path_files -g
Date: Sun, 09 Jan 2000 18:44:31 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E127NIM-00048r-00.2000-01-09-18-42-30@cmailg1.svr.pol.co.uk>

Completion of .dvi files has seized up because _path_files insists on using
$fignore.  I don't think fignore or even ignored-suffixes should be used
with an explicit glob pattern.  This is how it used to work.  You could
work around it with ignored-suffixes, but styles are for user preferences,
not to fix up things that should work anyway, so I think the same argument
as for fignore applies.

Index: Completion/Core/_path_files
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/Completion/Core/_path_files,v
retrieving revision 1.13
diff -u -r1.13 _path_files
--- Completion/Core/_path_files	2000/01/07 19:42:02	1.13
+++ Completion/Core/_path_files	2000/01/08 21:58:07
@@ -160,7 +160,7 @@
 
 # If given no `-F' option, we want to use the `ignored-suffixes'-style.
 
-if (( ! $#ignore )); then
+if [[ $#ignore -eq 0 && -z $gopt ]]; then
   if zstyle -a ":completion${curcontext}:files" ignored-suffixes ignore; then
     ignore=(-F "( $ignore )")
   else

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

