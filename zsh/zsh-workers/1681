From schaefer@candle.brasslantern.com Thu Jul 18 01:19:32 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id BAA26525 for <mason@werple.mira.net.au>; Thu, 18 Jul 1996 01:19:30 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id LAA17068; Wed, 17 Jul 1996 11:13:35 -0400 (EDT)
Resent-Date: Wed, 17 Jul 1996 11:13:35 -0400 (EDT)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <9607170814.ZM5812@candle.brasslantern.com>
Date: Wed, 17 Jul 1996 08:14:30 -0700
In-Reply-To: Peter Stephenson <pws@ifh.de>
        "Re: That infinite loop in Geoff's second zle_refresh patch" (Jul 17, 12:03pm)
References: <199607171003.MAA25843@hydra.ifh.de> 
	<199607171421.OAA24456@werple.net.au>
In-Reply-To: Geoff Wing <mason@werple.net.au>
        "Re: That infinite loop in Geoff's second zle_refresh patch" (Jul 18, 12:21am)
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (3.2.1 24feb96 Caldera)
To: Peter Stephenson <pws@ifh.de>,
        zsh-workers@math.gatech.edu (Zsh hackers list),
        Geoff Wing <mason@werple.net.au>
Subject: Re: That infinite loop in Geoff's second zle_refresh patch
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"J4cEG3.0.dA4.VCGxn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1681
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1545
Status: OR

On Jul 17, 12:03pm, Peter Stephenson wrote:
> Subject: Re: That infinite loop in Geoff's second zle_refresh patch
> schaefer@candle.brasslantern.com wrote:
> > The patch below changes starting count from 0 to 1, which stops the
> > infinite loop, but feels wrong to me.
> 
> This has a bad effect:  inserting or deleting on a continued line
> before the end of the line redisplays the rest of line wrongly.

My patch depended on Goeff's second zle_refresh.c patch, which was not
included in pre3.  Could it be that you don't have Geoff's patch?
Should I send a complete diff of my zle_refresh.c against pre3?  (I
have other patches from Zefram in there, too.)

I still don't understand (a) why the code worked before, as it was
calling tcdelcost(0) long ago; nor (b) what made it break this time.
Any insight, Geoff?

On Jul 18, 12:21am, Geoff Wing wrote:
> Subject: Re: That infinite loop in Geoff's second zle_refresh patch
> 
> Looks fine to me.  I give it my blessing :-)  

And there's no problem with the fact that `for (...; *p1; p1++, i++)'
now has i indexing one position farther into p1?  (That looked OK to
me -- in fact, it made more sense than what was there before, as i
is now the length of the substring that gets printed out of p1 -- but
I don't deeply understand the surrounding code, so ....)

> :This has a bad effect:  inserting or deleting on a continued line
> :before the end of the line redisplays the rest of line wrongly.
> 
> Um, what stuffs up?  Is this on an xterm?  An example?

Yes, an example would be helpful.


