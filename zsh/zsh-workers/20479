From zsh-workers-return-20479-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 13 16:02:18 2004
Return-Path: <zsh-workers-return-20479-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9581 invoked from network); 13 Oct 2004 16:02:18 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Oct 2004 16:02:18 -0000
Received: (qmail 82062 invoked from network); 13 Oct 2004 16:02:11 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2004 16:02:11 -0000
Received: (qmail 26160 invoked by alias); 13 Oct 2004 16:01:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20479
Received: (qmail 26143 invoked from network); 13 Oct 2004 16:01:55 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 13 Oct 2004 16:01:55 -0000
Received: (qmail 81468 invoked from network); 13 Oct 2004 16:01:09 -0000
Received: from moonbase.zanshin.com (64.84.47.139)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2004 16:01:07 -0000
Received: from toltec.zanshin.com (toltec.zanshin.com [64.84.47.166])
	by moonbase.zanshin.com (8.13.1/8.13.1) with ESMTP id i9DG1426010859;
	Wed, 13 Oct 2004 09:01:04 -0700
Date: Wed, 13 Oct 2004 09:01:04 -0700 (PDT)
From: Bart Schaefer <schaefer@brasslantern.com>
Reply-To: zsh-workers@sunsite.dk
To: pws@pwstephenson.fsnet.co.uk
cc: zsh-workers@sunsite.dk
Subject: Re: [rr13@mail.inf.tu-dresden.de: Bug#276187: zsh: Ineractive menu
 completion with tab doesnt work.]
In-Reply-To: <29047814.1097666227044.JavaMail.www@wwinf3002>
Message-ID: <Pine.LNX.4.61.0410130844440.17741@toltec.zanshin.com>
References: <29047814.1097666227044.JavaMail.www@wwinf3002>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

On Wed, 13 Oct 2004 pws@pwstephenson.fsnet.co.uk wrote:

> I can see the part of the code which is causing this: modline in the 
> function domenuselect is inconsistently handled.  At one point it gets 
> assigned just the combined prefix and suffix from the last completion, 
> but everywhere else it's assumed it's the whole line.

There's only one other assignment to it that I can see.

> However, I'm not quite sure what this is supposed to do.  Evidently it's 
> supposed to something special, not simply normal menu completion, but I 
> don't really know what.

I think what's supposed to happen is this:

You enter interactive completion (this may e.g. require two presses of TAB 
depending on your other menu completion/listing settings).  At this point, 
if you start typing the disambiguating characters, the menu list changes 
on the fly to show the changing subset (or superset, for corrections) of 
the possible completions that match, and backspace widens the list again.

This part all works fine.

If you type TAB again in this mode, though, it's not clear what should 
happen.  If you've already begun to disambiguate, typing TAB does nothing.  
The bug happens when you type TAB immediately after entering interactive 
completion, before any disambiguation has occurred.  I suspect in this 
case it's fine just to drop straight back into normal menulist completion 
and cancel interactive mode.  (Ideally that would happen even after the 
disambiguation has begun, too, rather than have TAB be a no-op there.)

> After fixing or blocking out the problem, it just does normal 
> menucompletion, i.e. the fact you're in ineractive completion doesn't 
> make a difference.

Fixing how?

