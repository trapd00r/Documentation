From zsh-workers-return-16306-mason-zsh=primenet.com.au@sunsite.dk Thu Dec 06 17:07:42 2001
Return-Path: <zsh-workers-return-16306-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16721 invoked from network); 6 Dec 2001 17:07:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 Dec 2001 17:07:42 -0000
Received: (qmail 13848 invoked by alias); 6 Dec 2001 17:07:36 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16306
Received: (qmail 13833 invoked from network); 6 Dec 2001 17:07:34 -0000
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <1011206170219.ZM21206@candle.brasslantern.com>
Date: Thu, 6 Dec 2001 17:02:18 +0000
In-Reply-To: <20011206112547.A806@corelli.new.ox.ac.uk>
Comments: In reply to Adam Spiers <adam@spiers.net>
        "bug in _tar?" (Dec  6, 11:25am)
References: <20011206112547.A806@corelli.new.ox.ac.uk>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Adam Spiers <adam@spiers.net>, zsh-workers@sunsite.dk
Subject: Re: bug in _tar?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Dec 6, 11:25am, Adam Spiers wrote:
} Subject: bug in _tar?

Almost certainly not a bug in _tar itself.

} The problem occurs when you have a word immediately after the cursor,
} i.e. with no space in between it and the cursor.

In this case zsh normally considers the stuff to the right of the cursor
to be part of the same word as what's to the left of the cursor.  Which
are you expecting: complete-in-word behavior or complete-prefix behavior?

(It sounds like you're expecting -prefix but getting -in-word.  Do you use
the _prefix completer?)

}   $ tar ztvf src/emacs-<TAB>lisp/
}   ---- archive file
}   emacs-21.1/             emacs-21.1.tar.gz       emacs-lisp-intro-1.05/
}   
} All good so far, but ...
} 
}   $ tar ztvf src/emacs-21.1.<TAB>lisp/
}   $ tar ztvf src
} 
} Suddenly everything vanishes.

I suspect this is a problem with your matcher specifications or with use
of the _approximate completer.  Try using <C-x ?> instead of <TAB> and
look at the debugging trace.

The source of the problem is going to be that "emacs-" is a prefix of two
directories which might (probably even do) contain "lisp" subdirectories,
whereas "emacs-21.1." is a prefix only of the tar.gz file name of which
the "lisp/" suffix can't possibly be a part.  Consequently there are no
matches, but rather than beeping, something is executing `compadd -U',
causing the current word to be replaced by the empty completion.

Sven would be the best person to address this ...

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

