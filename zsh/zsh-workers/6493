From zsh-workers-return-6493-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 07 10:59:58 1999
Return-Path: <zsh-workers-return-6493-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5541 invoked from network); 7 Jun 1999 10:59:57 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Jun 1999 10:59:57 -0000
Received: (qmail 13764 invoked by alias); 7 Jun 1999 10:59:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6493
Received: (qmail 13757 invoked from network); 7 Jun 1999 10:59:49 -0000
Date: Mon, 7 Jun 1999 12:59:44 +0200 (MET DST)
Message-Id: <199906071059.MAA06656@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Fri, 04 Jun 1999 16:29:33 +0200
Subject: Re: %e in correction prompt


Peter Stephenson wrote:

> I keep forgetting to mention it, but putting %e in
> ${compconfig[correct_prompt]} doesn't work any more, it always just
> disappears.  I get the same when I just run compinit from zsh -f.

Hugh. When did this happen?

(The same for _expand).

Bye
 Sven

diff -u oc/Core/_approximate Completion/Core/_approximate
--- oc/Core/_approximate	Fri Jun  4 14:40:43 1999
+++ Completion/Core/_approximate	Mon Jun  7 12:56:20 1999
@@ -153,7 +153,7 @@
 _comp_correct=1
 compstate[matcher]=-1
 
-_correct_prompt="${cfgps//\%e/1}"
+_correct_prompt="${cfgps//\\%e/1}"
 
 # We also need to set `extendedglob' and make the completion
 # code behave as if globcomplete were set.
@@ -188,7 +188,7 @@
   [[ "${#:-$PREFIX$SUFFIX}" -le _comp_correct+1 ]] && break
   (( _comp_correct++ ))
 
-  _correct_prompt="${cfgps//\%e/$_comp_correct}"
+  _correct_prompt="${cfgps//\\%e/$_comp_correct}"
 done
 
 compstate[matcher]="$compstate[total_matchers]"
diff -u oc/Core/_expand Completion/Core/_expand
--- oc/Core/_expand	Fri Jun  4 14:40:43 1999
+++ Completion/Core/_expand	Mon Jun  7 12:57:48 1999
@@ -132,7 +132,7 @@
   if [[ -z "$compconfig[expand_prompt]" ]]; then
     compadd -UQ $group _expand - "$exp[@]"
   else
-    compadd -UQ -X "${compconfig[expand_prompt]//\%o/$word}" \
+    compadd -UQ -X "${compconfig[expand_prompt]//\\%o/$word}" \
             $group _expand - "$exp[@]"
   fi
   [[ "$compconfig[expand_menu]" != *last* &&

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

