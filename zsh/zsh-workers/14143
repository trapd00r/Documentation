From zsh-workers-return-14143-mason-zsh=primenet.com.au@sunsite.dk Fri Apr 27 21:50:01 2001
Return-Path: <zsh-workers-return-14143-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5298 invoked from network); 27 Apr 2001 21:49:59 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Apr 2001 21:49:59 -0000
Received: (qmail 29556 invoked by alias); 27 Apr 2001 21:49:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14143
Received: (qmail 29543 invoked from network); 27 Apr 2001 21:49:53 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010427175451.ZM27056@candle.brasslantern.com>
Date: Fri, 27 Apr 2001 17:54:50 +0000
In-Reply-To: <200104271220.OAA05898@beta.informatik.hu-berlin.de>
Comments: In reply to Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
        "Re: cvs completion does not support partial path completion" (Apr 27,  2:20pm)
References: <200104271220.OAA05898@beta.informatik.hu-berlin.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: Re: cvs completion does not support partial path completion
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Apr 27,  2:20pm, Sven Wischnowsky wrote:
} Subject: Re: cvs completion does not support partial path completion
}
} Andrej Borsenkow wrote:
} 
} > Is "nice to have" in released version ...
} > 
} > bor@itsrm2% cvs diff S/M/t.c (meaning Src/Modules/termcap.c)
} > No matches for: `cvs command', `file', `directory', or `removed file'
} 
} As far as I can see, that directory handling would require re-thinking
} (or just placing a call to _files somewhere at the end as a catch-all
} case when the clever functions failed, but placing it somewhere where it
} won't get called more than once and not too early etc.).

It's not that bad ... at this point:

_cvs_modified_entries () {
  if _cvs_loadstat; then
      local expl match linedir realdir pat
      match=()
      : ${PREFIX:#(#b)(*/)(*)}
      linedir="$match[1]"
      realdir=${(e)~linedir}

Instead of using ${(e)~linedir) to get the realdir, tack /CVS on the end
and use _path_files to generate realdir, then lop off the CVS again and
proceed.

Of course "use _path_files to generate realdir" means editing _path_files
to accept the `-A array' option and pass it through to compadd ... and
fixing all the _cvs functions to handle an array of realdirs rather than
a single one.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

