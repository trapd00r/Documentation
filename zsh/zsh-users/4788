From zsh-users-return-4788-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 27 21:53:28 2002
Return-Path: <zsh-users-return-4788-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13073 invoked from network); 27 Mar 2002 21:53:28 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 27 Mar 2002 21:53:28 -0000
Received: (qmail 9039 invoked by alias); 27 Mar 2002 21:53:08 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4788
Received: (qmail 9027 invoked from network); 27 Mar 2002 21:53:06 -0000
From: "Will Sargent" <wsargent@atg.com>
To: <zsh-users@sunsite.dk>
Subject: Completing directories with special suffix
Date: Wed, 27 Mar 2002 13:52:19 -0800
Message-ID: <JMEGJPLJEICAFFFLHGPBGEAADAAA.wsargent@atg.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200
Importance: Normal

Hello all,

I'm trying to get the zsh code completion to expand out java directories and
application modules so that I have directory completion set up with the dot
instead of the slash.

As an example, I'd like to be able to do with java and a directory
/com/foo/bar containing a file Main.class

   java -classpath . com.foo.bar.Main

using the dot prefix to expand on com.f<tab>, if that makes any sense.

I also use ATG Dynamo heavily, so which uses application modules in the same
style.  I have a script for this, but it still expands things out with the /
tag.  It's almost what I want, but not quite; I'd also like it so that only
directories which contain a META-INF directory are considered.

So given a directory structure

    $DYNAMO_ROOT/
		DAS/
			META-INF/
			LDAP/
				META-INF/
				iPlanetDirectory/
					META-INF/
		DPS/
			META-INF/
		home/
			no meta inf dir here/

Then

  startDynamo -m DAS.LDAP.iPlanetDirectory

would be expanded out, but home wouldn't be on the possible list, and DPS
wouldn't have any child completions.

I've created a file called _modules with the following text

#autoload

# Because of the way that the files options are processed, need to pass in
# DYNAMO_ROOT and not $DYNAMO_HOME/..

# We also want to find files which contain a META-INF directory.
# We also want to be able to expand out sub-modules.

DYNAMO_ROOT=$DYNAMO_HOME/..

_files -/ -W DYNAMO_ROOT

but that's as far as I've gotten for now.

What should I change to get the code working like I want?

Will.



