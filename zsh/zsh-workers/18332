From zsh-workers-return-18332-mason-zsh=primenet.com.au@sunsite.dk Mon Mar 10 19:14:50 2003
Return-Path: <zsh-workers-return-18332-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3971 invoked from network); 10 Mar 2003 19:14:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 10 Mar 2003 19:14:49 -0000
Received: (qmail 21444 invoked by alias); 10 Mar 2003 19:14:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18332
Received: (qmail 21437 invoked from network); 10 Mar 2003 19:14:37 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 10 Mar 2003 19:14:37 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [192.54.253.222] by sunsite.dk (MessageWall 1.0.8) with SMTP; 10 Mar 2003 19:14:36 -0000
Received: by binome.blorf.net (Postfix, from userid 1000)
	id DF0E5E76F; Mon, 10 Mar 2003 11:14:26 -0800 (PST)
Date: Mon, 10 Mar 2003 11:14:26 -0800
From: Wayne Davison <wayned@users.sourceforge.net>
To: zsh-workers@sunsite.dk
Subject: parallel compilation fails
Message-ID: <20030310191426.GC11346@binome.blorf.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.4i

Since I'm a big fan of distcc these days, it saddens me that my favorite
shell fails to compile using parallel compilation (and thus, cannot
benefit from distcc) -- i.e. "make -j3" fails in the module-build rules
when some temp-file names get used at the same time in parallel threads.

There was some email back in 1996 on this subject, such as this one from
Zefram:

    http://www.zsh.org/mla/workers//1996/msg01930.html

Is this something that we think we can fix?  It looks like some of the
features from this old patch are there, and some are not.  Trying to
wrap my head around the module-make setup is hurting my brain, and I'd
rather avoid it if someone else is already familiar with what's going on
and can fix it easily.  If it's not fixable, what's the work-around?  To
do multiple makes?  I've done this:

    make prep       # Without this, the "make -j3 bin" fails.
    cd Src
    make -j3 bin
    make modules
    cd ..
    make -j3

This appears to work, but I don't know if it's safe or not.

..wayne..

