From zsh-workers-return-17682-mason-zsh=primenet.com.au@sunsite.dk Mon Sep 16 18:04:45 2002
Return-Path: <zsh-workers-return-17682-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6040 invoked from network); 16 Sep 2002 18:04:45 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 16 Sep 2002 18:04:45 -0000
Received: (qmail 19665 invoked by alias); 16 Sep 2002 18:04:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17682
Received: (qmail 19653 invoked from network); 16 Sep 2002 18:04:34 -0000
X-VirusChecked: Checked
From: Oliver Kiddle <okiddle@yahoo.co.uk>
To: Zsh workers <zsh-workers@sunsite.dk>
Subject: PATCH: _typeset
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-ID: <28958.1032199419.1@logica.com>
Date: Mon, 16 Sep 2002 19:04:06 +0100
Sender: kiddleo@logica.com
Message-Id: <E17r0EA-0007X7-00@bimbo.logica.co.uk>

The typeset completion was missing support for -H and -p. I also
changed the description for -h and for -i to integer. Also the
documentation missed off the -H option in the usage lines.

Oliver

Index: Completion/Zsh/Command/_typeset
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Command/_typeset,v
retrieving revision 1.1
diff -u -r1.1 _typeset
--- Completion/Zsh/Command/_typeset	2 Apr 2001 11:35:02 -0000	1.1
+++ Completion/Zsh/Command/_typeset	16 Sep 2002 18:00:11 -0000
@@ -18,10 +18,12 @@
   a '(-A -E -F -T -f -i)-a[specify that arguments refer to arrays]' \
   f '(-A -E -F -L -R -T -Z -a -g -h -i -l -r -x)-f[specify that arguments refer to functions]' \
   g '(-T -f)-+g[do not restrict parameter to local scope]' \
-  h '(-T -f)-+h[hide parameter]' \
+  h '(-T -f)-+h[hide specialness of parameter]'
+  H '(-T -f)-+H[hide value of parameter in listings]'
   i '(-A -E -F -T -f)-+i[represent internally as an integer]' \
   l '(-T -f)-l[convert the value to lowercase]' \
   m '(-A -E -F -T -i)-m[treat arguments as patterns]' \
+  p '-p[output parameters in form of calls to typeset]' \
   r '(-f)-+r[mark parameters as readonly]' \
   t '(-T)-+t[tag parameters and turn on execution tracing for functions]' \
   tf '(-T)-+t[turn on execution tracing for functions]' \
@@ -31,15 +33,18 @@
   up '-u[convert the value to uppercase]' \
   x '(-f)-+x[export parameter]' )
 
-use="AEFLRTUZafghilmrtux"
+use="AEFHLRTUZafghilmprtux"
 
 case ${service} in
-  float) use="EFghlrtux";;
+  float) use="EFHghlprtux";;
   functions)
     use="Umtu"
     func=f
   ;;
-  integer) use="ghilrtux" ;;
+  integer)
+    use="Hghilprtux"
+    allargs[i]='-i[specify arithmetic base for output]' \
+  ;;
   readonly) use="${use/r/}" ;;
   local) use="${use/f/}" ;&
   export) use="${${use/g/}/x/}" ;;
Index: Doc/Zsh/builtins.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/builtins.yo,v
retrieving revision 1.52
diff -u -r1.52 builtins.yo
--- Doc/Zsh/builtins.yo	3 Sep 2002 09:33:37 -0000	1.52
+++ Doc/Zsh/builtins.yo	16 Sep 2002 18:00:14 -0000
@@ -424,7 +424,7 @@
 If no var(job) is specified, resume the current job.
 )
 findex(float)
-item(tt(float) [ {tt(PLUS())|tt(-)}tt(EFghlprtux) ] [ var(name)[tt(=)var(value)] ... ])(
+item(tt(float) [ {tt(PLUS())|tt(-)}tt(EFHghlprtux) ] [ var(name)[tt(=)var(value)] ... ])(
 Equivalent to tt(typeset -E), except that options irrelevant to floating
 point numbers are not permitted.
 )
@@ -526,7 +526,7 @@
 )
 alias(history)(fc -l)
 findex(integer)
-item(tt(integer) [ {tt(PLUS())|tt(-)}tt(ghilprtux) ] [ var(name)[tt(=)var(value)] ... ])(
+item(tt(integer) [ {tt(PLUS())|tt(-)}tt(Hghilprtux) ] [ var(name)[tt(=)var(value)] ... ])(
 Equivalent to tt(typeset -i), except that options irrelevant to
 integers are not permitted.
 )
@@ -625,7 +625,7 @@
 endsitem()
 )
 findex(local)
-item(tt(local) [ {tt(PLUS())|tt(-)}tt(AEFLRUZahilprtux) [var(n)]] [ var(name)[tt(=)var(value)] ] ...)(
+item(tt(local) [ {tt(PLUS())|tt(-)}tt(AEFHLRUZahilprtux) [var(n)]] [ var(name)[tt(=)var(value)] ] ...)(
 Same as tt(typeset), except that the options tt(-g), and
 tt(-f) are not permitted.  In this case the tt(-x) option does not force
 the use of tt(-g), i.e. exported variables will be local to functions.
@@ -1080,7 +1080,7 @@
 findex(typeset)
 cindex(parameters, setting)
 cindex(parameters, declaring)
-xitem(tt(typeset) [ {tt(PLUS())|tt(-)}tt(AEFLRUZafghilprtuxm) [var(n)]] [ \
+xitem(tt(typeset) [ {tt(PLUS())|tt(-)}tt(AEFHLRUZafghilprtuxm) [var(n)]] [ \
 var(name)[tt(=)var(value)] ... ])
 item(tt(typeset) -T [ {tt(PLUS()|tt(-))}tt(LRUZrux) ] \
   var(SCALAR)[tt(=)var(value)] var(array))(


This e-mail and any attachment is for authorised use by the intended recipient(s) only.  It may contain proprietary material, confidential information and/or be subject to legal privilege.  It should not be copied, disclosed to, retained or used by, any other party.  If you are not an intended recipient then please promptly delete this e-mail and any attachment and all copies and inform the sender.  Thank you.

