From zsh-workers-return-26459-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 27 10:17:22 2009
Return-Path: <zsh-workers-return-26459-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18766 invoked from network); 27 Jan 2009 10:17:10 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 27 Jan 2009 10:17:10 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 12518 invoked from network); 27 Jan 2009 10:17:05 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Jan 2009 10:17:05 -0000
Received: (qmail 6519 invoked by alias); 27 Jan 2009 10:17:02 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26459
Received: (qmail 6508 invoked from network); 27 Jan 2009 10:17:01 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 27 Jan 2009 10:17:01 -0000
Received: from cluster-g.mailcontrol.com (cluster-g.mailcontrol.com [208.87.233.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id CF87180271F0
	for <zsh-workers@sunsite.dk>; Tue, 27 Jan 2009 11:16:58 +0100 (CET)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly11g.srv.mailcontrol.com (MailControl) with ESMTP id n0RAFrh4015015
	for <zsh-workers@sunsite.dk>; Tue, 27 Jan 2009 10:16:40 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 27 Jan 2009 10:16:34 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id n0RAGYRi016907
	for <zsh-workers@sunsite.dk>; Tue, 27 Jan 2009 10:16:34 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id n0RAGYX2016903
	for <zsh-workers@sunsite.dk>; Tue, 27 Jan 2009 10:16:34 GMT
Message-Id: <200901271016.n0RAGYX2016903@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: sourcing a sh file in zsh
In-reply-to: <200901270950.n0R9oijQ016648@news01.csr.com>
References: <BD9D2405-AD6A-4336-9C8A-85149165B6B8@gmail.com> <200901161939.54651.arvidjaar@newmail.ru> <090116102934.ZM22119@torch.brasslantern.com> <200901241859.30029.arvidjaar@gmail.com> <20090124173836.64403fdc@pws-pc> <090124152643.ZM24163@torch.brasslantern.com> <20090125213946.4c868e74@pws-pc> <20090126061819.GB54012@redoubt.spodhuis.org> <20090126122104.0e3013ba@news01> <20090126231630.GB18017@redoubt.spodhuis.org> <200901270950.n0R9oijQ016648@news01.csr.com>
Comments: In-reply-to Peter Stephenson <pws@csr.com>
   message dated "Tue, 27 Jan 2009 09:50:43 +0000."
Date: Tue, 27 Jan 2009 10:16:34 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 27 Jan 2009 10:16:34.0117 (UTC) FILETIME=[549B0750:01C98068]
X-Scanned-By: MailControl A_08_51_00 (www.mailcontrol.com) on 10.71.0.121
X-Virus-Scanned: ClamAV 0.92.1/8908/Tue Jan 27 09:23:41 2009 on bifrost
X-Virus-Status: Clean

Peter Stephenson wrote:
> I don't see why options should ever be read-only, and I don't see why
> executing a function that changes option values in the parent should be
> forbidden from doing so, given that this is explicitly supported zsh
> behaviour.  You always have enough rope to hang yourself with a
> shell---if you don't want native zsh behaviour seeping out, don't use a
> native zsh function, or be explicit with the "emulate -L"s.

I wasn't very clear about what I *do* think it should do:  that is
simply set and restore options for the new use of emulate, and do
exactly the same for functions marked for emulate behaviour.  (Detecting
when to set and when to use the emulate marking for functions is a bit
more subtle.)

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

