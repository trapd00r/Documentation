From zsh-users-return-12561-mason-zsh=primenet.com.au@sunsite.dk Wed Feb 13 18:34:16 2008
Return-Path: <zsh-users-return-12561-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3256 invoked from network); 13 Feb 2008 18:34:13 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Feb 2008 18:34:13 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 7085 invoked from network); 13 Feb 2008 18:33:57 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Feb 2008 18:33:57 -0000
Received: (qmail 28841 invoked by alias); 13 Feb 2008 18:33:48 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12561
Received: (qmail 28824 invoked from network); 13 Feb 2008 18:33:48 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 13 Feb 2008 18:33:48 -0000
Received: from flock1.newmail.ru (flock1.newmail.ru [82.204.219.207])
	by bifrost.dotsrc.org (Postfix) with SMTP id 1A7EA80482A1
	for <zsh-users@sunsite.dk>; Wed, 13 Feb 2008 19:33:37 +0100 (CET)
Received: (qmail 1261 invoked from network); 13 Feb 2008 18:33:36 -0000
Received: from unknown (HELO cooker.net) (arvidjaar@newmail.ru@91.77.252.164)
  by smtpd.newmail.ru with SMTP; 13 Feb 2008 18:33:36 -0000
From: Andrey Borzenkov <arvidjaar@newmail.ru>
To: zsh-users@sunsite.dk
Subject: Re: Phil's prompt is not working when LANG is set to UTF-8
Date: Wed, 13 Feb 2008 21:33:34 +0300
User-Agent: KMail/1.9.6 (enterprise 0.20071123.740460)
References: <20080211033116.GD19613@phoenix.nasreddine.info> <20080211150709.GA28841@localhost.localdomain> <20080211155200.0a8e9ecf@news01>
In-Reply-To: <20080211155200.0a8e9ecf@news01>
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart2265308.ZXuP96GZS1";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200802132133.35130.arvidjaar@newmail.ru>
X-Virus-Scanned: ClamAV 0.91.2/5800/Wed Feb 13 18:52:20 2008 on bifrost
X-Virus-Status: Clean

--nextPart2265308.ZXuP96GZS1
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

On Monday 11 February 2008, Peter Stephenson wrote:
>=20
> On Mon, 11 Feb 2008 16:07:09 +0100
> antho.charles@gmail.com wrote:
> > I didn't have this problem on Debian etch, but it appears when I
> > upgraded to lenny. It's the same problem: if I set LANG to a non utf8
> > encoding (fr_FR instead of fr_FR.UTF-8), RPROMPT is good, otherwise
> > it's partially on another line and the cusor is after RPROMPT.
> > (cf. http://tinyurl.com/3xjeqt)
>=20
> Sounds like it ought to be fairly reproducible, but it's not happening on
> Fedora 8 (and it still sounds suspiciously like the shell is getting duff
> information about the environment, though that's certainly not the only
> possibility).  I've tried adding multibyte characters to the command line
> and complicating the RPROMPT and even adding multibyte characters to that,
> but it still works OK.
>=20
> Are there any particular things on the command line, forms of RPROMPT etc.
> etc. that show this up?  (We really need something that narrows this down=
=2E)
>=20

I can reproduce it on Mandriva cooker with locale en_US.UTF-8 or ru_RU.UTF-=
8. It=20
does not matter whether there are UTF-8 characters on the screen (at least,=
 I am=20
not sure whether there are - en_US.UTF-8 should not emit any non-ASCII stri=
ngs=20
as far as I can tell).

I will try to find time on weekend to check more closely.

--nextPart2265308.ZXuP96GZS1
Content-Type: application/pgp-signature; name=signature.asc 
Content-Description: This is a digitally signed message part.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (GNU/Linux)

iEYEABECAAYFAkezN/4ACgkQR6LMutpd94zZYQCg06x1VlPaCSMzKkogUw1rKglR
onMAn0ZO/t2OZDkr2C7ngjieTVXDiPeu
=1H63
-----END PGP SIGNATURE-----

--nextPart2265308.ZXuP96GZS1--

