From zsh-workers-return-24600-mason-zsh=primenet.com.au@sunsite.dk Tue Feb 26 19:19:45 2008
Return-Path: <zsh-workers-return-24600-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18421 invoked from network); 26 Feb 2008 19:19:43 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Feb 2008 19:19:43 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 86979 invoked from network); 26 Feb 2008 19:19:36 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Feb 2008 19:19:36 -0000
Received: (qmail 26634 invoked by alias); 26 Feb 2008 19:19:33 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24600
Received: (qmail 26607 invoked from network); 26 Feb 2008 19:19:32 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 26 Feb 2008 19:19:32 -0000
Received: from mail.blastwave.org (mail.blastwave.org [147.87.98.10])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 60E9E8026E0B
	for <zsh-workers@sunsite.dk>; Tue, 26 Feb 2008 20:19:29 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by mail.blastwave.org (Postfix) with ESMTP id 472D426F2;
	Tue, 26 Feb 2008 20:19:28 +0100 (MET)
X-Virus-Scanned: amavisd-new at blastwave.org
Received: from mail.blastwave.org ([127.0.0.1])
	by localhost (enterprise.blastwave.org [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id EPluIQ-9N8Xj; Tue, 26 Feb 2008 20:19:20 +0100 (MET)
Received: from [192.168.1.102] (i577A594B.versanet.de [87.122.89.75])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.blastwave.org (Postfix) with ESMTP id 9F2582A9F;
	Tue, 26 Feb 2008 20:19:14 +0100 (MET)
In-Reply-To: <20080226180807.10cd1476@news01>
References: <8AABEECB-A9A6-43EA-BED2-4BE376CBE349@blastwave.org> <20080226141459.76dc362c@news01> <BD1EA7D6-C784-4ED9-9558-5B655CBC5096@blastwave.org> <20080226145741.6e74fc22@news01> <656429B3-438B-4ECF-85C4-04E38D837D1A@blastwave.org> <200802261610.m1QGAwJ3008939@news01.csr.com> <20080226180807.10cd1476@news01>
Mime-Version: 1.0 (Apple Message framework v753)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <3C810A28-FD80-4DE3-9E70-E48F35DB2525@blastwave.org>
Cc: zsh-workers@sunsite.dk
Content-Transfer-Encoding: 7bit
From: Dagobert Michelsen <dam@blastwave.org>
Subject: Re: * Re: Failed tests of zsh 4.3.5 in Solaris 10 w/Sun Studio 12 CC
Date: Tue, 26 Feb 2008 20:19:06 +0100
To: Peter Stephenson <pws@csr.com>
X-Mailer: Apple Mail (2.753)
X-Virus-Scanned: ClamAV 0.91.2/6003/Tue Feb 26 12:34:31 2008 on bifrost
X-Virus-Status: Clean

Hi Peter,

Am 26.02.2008 um 19:08 schrieb Peter Stephenson:
> Er, except that there are three

Four ;-)

> mistakes in those three lines of code, as
> Geoff pointed out.  I was lulled into a false sense of security  
> because
> this doesn't get compiled on my machine.  I tried it specially.
>
> Index: Src/utils.c
> ===================================================================
> RCS file: /cvsroot/zsh/zsh/Src/utils.c,v
> retrieving revision 1.178
> diff -u -r1.178 utils.c
> --- Src/utils.c	26 Feb 2008 16:19:34 -0000	1.178
> +++ Src/utils.c	26 Feb 2008 18:05:59 -0000
> @@ -4885,9 +4885,9 @@
>  		     * It shouldn't ever be NULL, but while we're
>  		     * being paranoid...
>  		     */
> -		    if (!codessetstr || !*codsetstr ||
> +		    if (!codesetstr || !*codesetstr ||
>  			!strcmp(codesetstr, "646"))
> -			codesetstr == "US-ASCII";
> +			codesetstr = "US-ASCII";
>      	    	    cd = iconv_open(nl_langinfo(CODESET), "UCS-4BE");

      	    	    cd = iconv_open(codesetstr, "UCS-4BE");

>  		    if (cd == (iconv_t)-1) {
>  			zerr("cannot do charset conversion (iconv failed)");

Do you have a clue about the other failing tests?


Best regards

   -- Dago

