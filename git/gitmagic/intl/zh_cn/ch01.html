<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 25 March 2009), see www.w3.org">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Git Magic - 第&nbsp;1&nbsp;章&nbsp;入门</title>
  <link rel="stylesheet" href="default.css" type="text/css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
  <link rel="home" href="index.html" title="Git 魔法">
  <link rel="up" href="index.html" title="Git 魔法">
  <link rel="prev" href="index.html" title="前言">
  <link rel="next" href="ch02.html" title=
  "第&nbsp;2&nbsp;章&nbsp;基本技巧">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
    <div class="toc">
      <ul>
<li><b>Git Magic</b></li>
        <li>
          <span class="preface"><a href="index.html">前言</a></span>

          <ul>
            <li><span class="section"><a href=
            "index.html#__2">致谢！</a></span></li>

            <li><span class="section"><a href=
            "index.html#__3">许可</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch01.html">1.
          入门</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch01.html#__5">工作是玩</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__6">版本控制</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__7">分布控制</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__8">一个误区</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__9">合并冲突</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch02.html">2.
          基本技巧</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch02.html#__11">保存状态</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__12">添加、删除、重命名</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__13">进阶撤销/重做</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__14">撤销</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__15">变更日志生成</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__16">下载文件</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__17">到最新</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__18">快速发布</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__19">我们已经做了什么？</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__20">练习</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch03.html">3.
          克隆周边</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch03.html#__22">计算机间同步</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__23">典型源码控制</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__24">封闭源码</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__25">裸仓库</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__26">推还是拽</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__27">项目分叉</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__28">终极备份</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__29">轻快多任务</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__30">游击版本控制</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_mercurial">Mercurial</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bazaar">Bazaar</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_git">我偏爱Git的原因</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch04.html">4.
          分支巫术</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch04.html#__32">老板键</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__33">肮脏的工作</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__34">快速修订</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__35">合并</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__36">不间断工作流</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__37">重组杂乱</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__38">管理分支</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__39">临时分支</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__40">按你希望的方式工作</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch05.html">5.
          关于历史</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch05.html#__42">我认错</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__43">更复杂情况</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__44">本地变更之后</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__45">重写历史</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__46">制造历史</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__47">哪儿错了？</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__48">谁让事情变糟了？</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__49">个人经验</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch06.html">6.
          多人Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch06.html#__50">我是谁？</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_ssh_http">Git在SSH,
            HTTP上</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_3">Git在随便什么上</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__51">补丁：全球货币</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__52">对不起，移走了</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__53">远端分支</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__54">多远端</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__55">我的喜好</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch07.html">7.
          Git大师技</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch07.html#__56">源码发布</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__57">提交变更</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__58">我的提交太大了！</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_git_5">索引：Git的中转区域</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_head">别丢了你的HEAD</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_head_2">HEAD捕猎</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_git_6">基于Git构建</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__59">大胆的特技</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__60">阻止坏提交</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch08.html">8.
          揭开面纱</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch08.html#__62">大象无形</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__63">数据完整性</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__64">智能</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__65">索引</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_git_7">Git的源起</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__66">对象数据库</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_blob">Blob对象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_tree">Tree对象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_commit">Commit对象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__67">没那么神</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch09.html">9. 附录 A:
          Git的缺点</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch09.html#_sha1">SHA1 的弱点</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_windows">微软 Windows</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__68">不相关的文件</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__69">谁在编辑什么？</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__70">文件历史</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__71">初始克隆</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__72">不稳定的项目</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__73">全局计数器</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__74">空子目录</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__75">初始提交</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__76">接口怪癖</a></span></li>
          </ul>
        </li>

        <li><span class="chapter"><a href="ch10.html">10. 附录 B:
        本指南的翻译</a></span></li>
      </ul>
    </div>
<div class="content">
  <div class="chapter" title="第&nbsp;1&nbsp;章&nbsp;入门">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title"><a name=
          "__4"></a>第&nbsp;1&nbsp;章&nbsp;入门</h2>
        </div>
      </div>
    </div>

    <p>我将用类比方式来介绍版本控制的概念。更严谨的解释参见 <a class="ulink" href=
    "http://en.wikipedia.org/wiki/Revision_control" target=
    "_top">维基百科版本修订控制条目</a>。</p>

    <div class="section" title="工作是玩">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__5"></a>工作是玩</h2>
          </div>
        </div>
      </div>

      <p>我从小就玩电脑游戏。相反，我只是在长大后才开始使用版本控制系统。我想我并不特
      殊，并且，对比两者工作方式可使这些概念更易解释，也易于理解。</p>

      <p>编写代码，或编辑文档和玩游戏差不多。在你做出了很多进展之后，你最好保存一下。
      去做这个，会点击你所信任的编辑器保存按钮就好了。</p>

      <p>但这将覆盖老版本。就像那些学校里玩的老游戏，只有一个存档：你确实可以保存，但
      你不能回到更老的状态了。这真让人扫兴，因为那个状态可能恰好保存了这个游戏特别
      有意思一关，说不定哪天你想再玩一下呢。或者更糟糕的，你当前的保存是个必败局， 这样你就不得不从头开始玩了。</p>
    </div>

    <div class="section" title="版本控制">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__6"></a>版本控制</h2>
          </div>
        </div>
      </div>

      <p>在编辑的时候，如果想保留旧版本，你可以将文件“另存为”一个不同的文件，或在保
      存之前将文件拷贝到别处。你可能压缩这些文件以节省空间。这是一个初级的靠手工的
      版本控制方式。游戏软件早就提高了这块，很多都提供多个基于时间戳的自动存档槽。</p>

      <p>让我们看看稍稍复杂的情况。比如你有很多放在一起的文件，比如项目源码，或网站文
      件。现在如你想保留旧版本，你不得不把整个目录存档。手工保存多个版本很不方便， 而且很快会耗费巨大。</p>

      <p>在一些电脑游戏里，一个存档真的包含在一个充满文件的目录里。这些游戏为玩家屏蔽
      了这些细节，并提供一个方便易用的界面来管理该目录的不同版本。</p>

      <p>版本控制系统也没有两样。两者提供友好的界面，来管理目录里的东西。你可以频繁保
      存，也可以之后加载任一保存。不像大多计算机游戏，版本控制系统通常精于节省存储
      空间。一般情况如果两个版本间只有少数文件的变更，每个文件的变更也不大，那就只
      存储差异的部分，而不是把全部拷贝的都保存下来，以节省存储空间。</p>
    </div>

    <div class="section" title="分布控制">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__7"></a>分布控制</h2>
          </div>
        </div>
      </div>

      <p>现在设想一个很难的游戏。太难打了，以至于世界各地很多骨灰级玩家决定组队，分享
      他们游戏存档以攻克它。Speedrun们就是实际中的例子：在同一个游戏里，玩家们分别
      攻克不同的等级，协同工作以创造惊人战绩。</p>

      <p>你如何搭建一个系统，使得他们易于得到彼此的存档？并易于上载新的存档？</p>

      <p>在过去，每个项目都使用中心式版本控制。某个服务器上放所有保存的游戏记录。其他
      人就不用了。每个玩家在他们机器上最多保留几个游戏记录。当一个玩家想更新进度时
      候，他们需要把最新进度从主服务器下载下来，玩一会儿，保存并上载到主服务器以供 其他人使用。</p>

      <p>假如一个玩家由于某种原因，想得到一个较旧版本的游戏进度怎么样？或许当前保存的
      游戏是一个注定的败局，因为某人在第三级忘记捡某个物品；他们希望能找到最近一个
      可以完成的游戏记录。或者他们想比较两个旧版本间的差异，来估算某个特定玩家干了 多少活。</p>

      <p>查看旧版本的理由有很多，但检查的办法都是一样的。他们必须去问中心服务器要那个
      旧版本的记录。需要的旧版本越多，和服务器的交互就越多。</p>

      <p>新一代的版本控制系统，Git就是其中之一，是分布式的，可以被认作广义上的中心式系
      统。从主服务器下载时玩家会得到所有保存的记录，而不仅是最新版。这看起来他们好 像把中心服务器做了个镜像。</p>

      <p>最初的克隆操作可能比较费时，特别当有很长历史的时，但从长远看这是值得的。一个
      显而易见的好处是，当查看一个旧版本时，不再需要和中心服务器通讯了。</p>
    </div>

    <div class="section" title="一个误区">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__8"></a>一个误区</h2>
          </div>
        </div>
      </div>

      <p>一个很常见的错误观念是，分布式系统不适合需要官方中心仓库的项目。这与事实并不
      相符。给谁照相也不会偷走他们的灵魂。类似地，克隆主仓库并不降低它的重要性。</p>

      <p>一般来说，一个中心版本控制系统能做的任何事，一个良好设计的分布式系统都能做得
      更好。网络资源总要比本地资源耗费更费。不过我们应该在稍后分析分布式方案的缺点，
      这样人们才不会按照习惯做出错误的比较。</p>

      <p>一个小项目或许只需要分布式系统提供的一小部分功能，但是，在项目很小的时候，应
      该用规划不好的系统？就好比说，在计算较小数目的时候应该使用罗马数字？</p>

      <p>而且，你的项目的增长可能会超出你最初的预期。从一开始就使用Git好似带着一把瑞士
      军刀，尽管你很多时候只是用它来开开瓶盖。某天你迫切需要一把改锥，你就会庆幸你 所有的不单单是一个启瓶器。</p>
    </div>

    <div class="section" title="合并冲突">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__9"></a>合并冲突</h2>
          </div>
        </div>
      </div>

      <p>对于这个话题，电脑游戏的类比显得不够用。那让我们再来看看文档编辑的情况吧。</p>

      <p>假设Alice在文档开头插入一行，并且Bob在文档末尾添加一行。他们都上传了他们的改
      动。大多数系统将自动给出一个合理的处理方式：接受且合并他们的改动，这样Alice和 Bob两人的改动都会生效。</p>

      <p>现在假设Alice和Bob对文件的同一行做了不同的改动。如果没有人工参与的话，这个冲
      突是无法解决的。第二个人在上载文件时，会收到 <span class=
      "emphasis"><em>合并冲突</em></span> 的通知，要么用一个人
      的改动覆盖另一个的，要么完全修订这一行。</p>

      <p>更复杂的情况也可能出现。版本控制系统自己处理相对简单的情况，把困难的情况留给
      人来处理。它们的行为通常是可配置的。</p>
    </div>
  </div><script type="text/javascript" src="find_selflink.js">
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1901330-2");
  pageTracker._initData();
  pageTracker._trackPageview();
  </script>
</div>
</div><div class="footer"><a href="/~blynn/">Ben Lynn</a></div>
</body>
</html>
