From zsh-workers-return-24509-mason-zsh=primenet.com.au@sunsite.dk Fri Feb 01 12:25:20 2008
Return-Path: <zsh-workers-return-24509-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23318 invoked from network); 1 Feb 2008 12:25:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Feb 2008 12:25:17 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 74755 invoked from network); 1 Feb 2008 12:25:12 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Feb 2008 12:25:11 -0000
Received: (qmail 22483 invoked by alias); 1 Feb 2008 12:25:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24509
Received: (qmail 22465 invoked from network); 1 Feb 2008 12:25:07 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 1 Feb 2008 12:25:07 -0000
Received: from prunille.vinc17.org (vinc17.pck.nerim.net [213.41.242.187])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 2A73D80482A1
	for <zsh-workers@sunsite.dk>; Fri,  1 Feb 2008 13:24:59 +0100 (CET)
Received: by prunille.vinc17.org (Postfix, from userid 501)
	id E5D9A1F08395; Fri,  1 Feb 2008 13:24:58 +0100 (CET)
Date: Fri, 1 Feb 2008 13:24:58 +0100
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-workers@sunsite.dk, Vadim Zeitlin <vz-zsh@zeitlins.org>,
	342347@bugs.debian.org
Subject: Re: svn commit completion
Message-ID: <20080201122458.GT17147@prunille.vinc17.org>
Mail-Followup-To: zsh-workers@sunsite.dk,
	Vadim Zeitlin <vz-zsh@zeitlins.org>, 342347@bugs.debian.org
References: <47A07DB2.7080604@cam.ac.uk> <2d460de70801310741x3b6796c6ib87d0323cc165ab2@mail.gmail.com> <20080131165506.CACC68029406@bifrost.dotsrc.org> <20080131170647.GA4876@scowler.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <20080131170647.GA4876@scowler.net>
X-Mailer-Info: http://www.vinc17.org/mutt/
User-Agent: Mutt/1.5.17-vl-r19795 (2008-01-17)
X-Virus-Scanned: ClamAV 0.91.2/5631/Fri Feb  1 11:41:51 2008 on bifrost
X-Virus-Status: Clean

On 2008-01-31 12:06:47 -0500, Clint Adams wrote:
> [moved to -workers]
> On Thu, Jan 31, 2008 at 05:55:06PM +0100, Vadim Zeitlin wrote:
> >  Actually "svn ci" does complete only modified (or added, removed) files
> > here (zsh 4.3.2 under Debian Linux), but the problem is that these files
> > are remembered by the completer in a global _cache_svn_status variable
> > which is never updated. I don't really know what's the best way of fixing
> > it but for now I've just done "precmd() { unset _cache_svn_status }" and
> > "svn ci" completes correctly all the time and not just the first one.

Note that this is not sufficient if you use another shell session
to call svn (I frequently do that).

> Repeating what I said at http://bugs.debian.org/342347 ,
> maybe a very short cache expiration is the way to go.

Yes, maybe. Or can't something like FAM[*] optionally be used when
supported? (Note: if it is used, it should be a run-time option,
as I'm not sure that FAM is OK with all NFS servers.)

[*] http://en.wikipedia.org/wiki/File_alteration_monitor

-- 
Vincent Lefèvre <vincent@vinc17.org> - Web: <http://www.vinc17.org/>
100% accessible validated (X)HTML - Blog: <http://www.vinc17.org/blog/>
Work: CR INRIA - computer arithmetic / Arenaire project (LIP, ENS-Lyon)

