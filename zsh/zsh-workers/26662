From zsh-workers-return-26662-mason-zsh=primenet.com.au@sunsite.dk Mon Mar 02 16:15:51 2009
Return-Path: <zsh-workers-return-26662-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22097 invoked from network); 2 Mar 2009 16:15:48 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 2 Mar 2009 16:15:48 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 24386 invoked from network); 2 Mar 2009 16:15:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 2 Mar 2009 16:15:42 -0000
Received: (qmail 12880 invoked by alias); 2 Mar 2009 16:15:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26662
Received: (qmail 12862 invoked from network); 2 Mar 2009 16:15:35 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 2 Mar 2009 16:15:35 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 40FEB8058F82
	for <zsh-workers@sunsite.dk>; Mon,  2 Mar 2009 17:15:32 +0100 (CET)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly46d.srv.mailcontrol.com (MailControl) with ESMTP id n22GFUio029493
	for <zsh-workers@sunsite.dk>; Mon, 2 Mar 2009 16:15:30 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 2 Mar 2009 16:15:29 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id n22GFTYx017496
	for <zsh-workers@sunsite.dk>; Mon, 2 Mar 2009 16:15:29 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id n22GFTKt017492
	for <zsh-workers@sunsite.dk>; Mon, 2 Mar 2009 16:15:29 GMT
Message-Id: <200903021615.n22GFTKt017492@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: zsh 4.3.9: Interrupted "tcsetattr" call problem, tiling-wm related
In-reply-to: <090302080140.ZM29940@torch.brasslantern.com>
References: <20090227161933.GE4173@shame.elexo.fr.local> <20090302102350.4fb8f638@news01> <090302080140.ZM29940@torch.brasslantern.com>
Comments: In-reply-to Bart Schaefer <schaefer@brasslantern.com>
   message dated "Mon, 02 Mar 2009 08:01:40 -0800."
Date: Mon, 02 Mar 2009 16:15:29 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 02 Mar 2009 16:15:29.0699 (UTC) FILETIME=[1ADB8F30:01C99B52]
X-Scanned-By: MailControl A_08_51_00 (www.mailcontrol.com) on 10.68.0.156
X-Virus-Scanned: ClamAV 0.92.1/9061/Mon Mar  2 10:28:18 2009 on bifrost
X-Virus-Status: Clean

Bart Schaefer wrote:
> On Mar 2, 10:23am, Peter Stephenson wrote:
> }
> } On Fri, 27 Feb 2009 17:20:25 +0100
> } Lionel Flandrin <lionel@svkt.org> wrote:
> } >   while (tcsetattr(SHTTY, TCSADRAIN, &ti->tio) == -1 && errno == EINTR);
> } 
> } That looks fine, I've committed it.  Thanks.
> 
> I wonder if queue_signals/unqueue_signals around the tcsetattr might be
> more appropriate?

That doesn't actually block the signal, it just marks that we should
queue any shell code activities.  We would still receive the signal, and
hence the system call would still fail with EINTR.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

