From zsh-workers-return-6351-mason-zsh=primenet.com.au@sunsite.auc.dk Wed May 26 06:26:21 1999
Return-Path: <zsh-workers-return-6351-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8631 invoked from network); 26 May 1999 06:26:20 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 May 1999 06:26:20 -0000
Received: (qmail 19749 invoked by alias); 26 May 1999 06:26:16 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6351
Received: (qmail 19742 invoked from network); 26 May 1999 06:26:15 -0000
Date: Wed, 26 May 1999 08:26:04 +0200 (MET DST)
Message-Id: <199905260626.IAA07430@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
CC: Glenn Trigg <glenn@aus.compgen.com>
In-reply-to: Sven Wischnowsky's message of Tue, 25 May 1999 10:39:24 +0200
	(MET DST)
Subject: Re: PATCH: was: Re: zsh bug


I wrote this patch:

> --- Src/zle_tricky.c	Tue May 25 10:32:35 1999
> +++ Src/zle_tricky.c.old	Mon May 10 13:21:55 1999
> @@ -1069,14 +1069,13 @@
>  	    we = ll;
>  	tt = (char *)line;
>  	if (tmp) {
> -	    linptr += tmp - (char *) line;
>  	    line = (unsigned char *)tmp;
>  	    ll = strlen((char *)line);
> -	    addedx = 0;
>  	}
>  	if (t0 != STRING && inwhat != IN_MATH) {
>  	    if (tmp) {
>  		tmp = NULL;
> +		linptr = (char *)line;
>  		lexrestore();
>  		goto start;
>  	    }

Err, Bart, Greg: sorry, but this patch is reversed, dunno how this
happened. Here is it the right way round.

Bye
 Sven

--- Src/zle_tricky.c.old	Mon May 10 13:21:55 1999
+++ Src/zle_tricky.c	Tue May 25 10:32:35 1999
@@ -1069,13 +1069,14 @@
 	    we = ll;
 	tt = (char *)line;
 	if (tmp) {
+	    linptr += tmp - (char *) line;
 	    line = (unsigned char *)tmp;
 	    ll = strlen((char *)line);
+	    addedx = 0;
 	}
 	if (t0 != STRING && inwhat != IN_MATH) {
 	    if (tmp) {
 		tmp = NULL;
-		linptr = (char *)line;
 		lexrestore();
 		goto start;
 	    }

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

