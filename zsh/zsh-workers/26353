From zsh-workers-return-26353-mason-zsh=primenet.com.au@sunsite.dk Sun Jan 18 11:52:40 2009
Return-Path: <zsh-workers-return-26353-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3667 invoked from network); 18 Jan 2009 11:52:36 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 Jan 2009 11:52:36 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 26951 invoked from network); 18 Jan 2009 11:52:33 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 Jan 2009 11:52:33 -0000
Received: (qmail 14191 invoked by alias); 18 Jan 2009 11:52:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26353
Received: (qmail 14176 invoked from network); 18 Jan 2009 11:52:28 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 18 Jan 2009 11:52:28 -0000
Received: from ey-out-2122.google.com (ey-out-2122.google.com [74.125.78.26])
	by bifrost.dotsrc.org (Postfix) with ESMTP id CD35580271F0
	for <zsh-workers@sunsite.dk>; Sun, 18 Jan 2009 12:52:16 +0100 (CET)
Received: by ey-out-2122.google.com with SMTP id 25so242609eya.3
        for <zsh-workers@sunsite.dk>; Sun, 18 Jan 2009 03:52:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=1xiUX4OXWW2jLcrLWwxRiUqMZbP80gXcbUJGQvlScCg=;
        b=c215MsFn57+PjjGtXjyIRBMmVrlWDIsR5tkCH/z6nzowlfhM7KWryK7UqYdB/OTTLo
         NogTnEX0RFDAKjf+pwj9ogePXiVn0FVxiGNFnLqtG7vv917fC1IxLmU0D5iKGjtMC5mD
         RigqPUc8XODbVmr+lkLMTv/xBCCtyeZNxy76c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=Ajz69EGywVdWqZ+tLBdR7sCphm7O5lB/zehHnNUIuUxzCfZM0R+ZXCkv0BH+2LI0oK
         zl+GCT+4pEpot8XuZcXvvwdP6QWekyk1fAqItReR7mWPv2/twI3h0Dt1mSIWX/igyqpl
         jkSv/iWbJ8vc5rZvssWgMQwglnh5S7e5mymxI=
MIME-Version: 1.0
Received: by 10.210.117.1 with SMTP id p1mr5739757ebc.180.1232279535845; Sun, 
	18 Jan 2009 03:52:15 -0800 (PST)
In-Reply-To: <200901181447.54147.arvidjaar@newmail.ru>
References: <200901081526.48797.arvidjaar@newmail.ru>
	 <200901081230.n08CUXTB010409@news01.csr.com>
	 <200901181447.54147.arvidjaar@newmail.ru>
Date: Sun, 18 Jan 2009 12:52:15 +0100
Message-ID: <237967ef0901180352o492d99a9k9e067fefec7dea83@mail.gmail.com>
Subject: Re: 4.3.9: frequent crashes in completion menu selection
From: Mikael Magnusson <mikachu@gmail.com>
To: zsh-workers@sunsite.dk
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Scanned: ClamAV 0.92.1/8874/Sun Jan 18 06:02:00 2009 on bifrost
X-Virus-Status: Clean

2009/1/18 Andrey Borzenkov <arvidjaar@newmail.ru>:
> On 8 =D1=8F=D0=BD=D0=B2=D0=B0=D1=80=D1=8F 2009 15:30:33 Peter Stephenson =
wrote:
>> Andrey Borzenkov wrote:
>> > I hit it quite often on Mandriva cooker; I do not see any obvious
>> > post-4.3.9 commits dealing with crashes in this area. This usually
>> > happens during menu selection browsing file system.
>>
>> There's probably not a cat's chance in hell of getting anywhere with
>> this (given the code it affects) unless it can be reproduced easily.
>
> The following seems to do it here:
>
> mkdir /tmp/u{1,2}/w{1,2}
> {pts/1}% zsh -f
> cooker% autoload compinit; compinit
> cooker% zmodload zsh/complist
> cooker% zstyle ':completion:*' menu 'select=3D0'
> cooker% bindkey -M menuselect "/" accept-and-infer-next-history
> cooker% setopt menucomplete
> cooker% zstyle ':completion:*' format Completing %d
> cooker% ls /tmp/uTAB
>
> Now you get menu selection; press two times '/' to get "Completing
> 'files'" (at /tmp/u1/w1/ line contents); now press undo (^_) until you
> get empty line; press RETURN; press 'ls /tmp/uTAB'. Zsh crashes.
>
> For some reasons crucial point is setting "format". Not only can I not
> make it crash without this; it seems to change the undo behaviour as
> well - pressing undo multiples times with and without "format" set
> cycles through *different* line contents.

While it doesn't explain the crash, I'm pretty sure that should be
zstyle ':completion:*' format 'Completing %d'

--=20
Mikael Magnusson

