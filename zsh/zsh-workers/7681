From zsh-workers-return-7681-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Sep 07 08:59:35 1999
Return-Path: <zsh-workers-return-7681-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10008 invoked from network); 7 Sep 1999 08:59:33 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Sep 1999 08:59:33 -0000
Received: (qmail 26600 invoked by alias); 7 Sep 1999 08:59:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7681
Received: (qmail 26593 invoked from network); 7 Sep 1999 08:59:28 -0000
Date: Tue, 7 Sep 1999 10:59:21 +0200 (MET DST)
Message-Id: <199909070859.KAA03781@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Adam Spiers's message of Mon, 6 Sep 1999 19:21:31 +0100
Subject: Re: PATCH: completion for perldoc


Adam Spiers wrote:

> Adam Spiers (adam@thelonious.new.ox.ac.uk) wrote:
> > _perldoc {
> >     _arguments -s \
> >         '-h:help:' \
> >         '(-q)-f:Perl built-in function:_perl_builtin_funcs' \
> >         '(-f)-q:Perl FAQ keyword:' \
> >         '*:Perl pod pages:_perl_pods'
> > }
> > 
> > _perl_pods {
> >     local nm="$compstate[nmatches]"
> > 
> >    _perl_modules
> >    _perl_basepods
> >    _path_files -J "Perl modules and .pods" -/ -g '*.(pod|pm)'
> > 
> >     [[ nm -ne compstate[nmatches] ]]
> > }
> 
> I forgot to say: this kills zsh :-(
>
> ...
> 
> If you need any more debugging info, let me know.  (Why are all the
> parameter lists empty?)

Yes I need more, namely the exact command line where you tried
completion. I've tested `perldoc' with completion after `-f', `-q',
and in a normal argument position and all this seems to work for me,
but I had to change `_perl_basepods' to use `whence -p basepod'
instead of `which ...' because I don't have `basepods'. I also had to
change `_perl_builtin_funcs' to use `command man ...' because I happen 
to have a function called `man'.

About the argument lists: did you really compile the beast with
debugging? (`-ggdb' in your Makefile, or at least `-g'?)

Otherwise the backtrace seems very fishy, because `comp_setunset'
doesn't call `runshfunc'.

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

