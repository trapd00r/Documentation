From zsh-workers-return-22679-mason-zsh=primenet.com.au@sunsite.dk Fri Sep 08 17:23:15 2006
Return-Path: <zsh-workers-return-22679-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28007 invoked from network); 8 Sep 2006 17:23:13 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.4 (2006-07-25) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 8 Sep 2006 17:23:13 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 7536 invoked from network); 8 Sep 2006 17:23:06 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 8 Sep 2006 17:23:06 -0000
Received: (qmail 15985 invoked by alias); 8 Sep 2006 17:13:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22679
Received: (qmail 11548 invoked from network); 8 Sep 2006 17:02:07 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 8 Sep 2006 17:02:07 -0000
Received: (qmail 28211 invoked from network); 8 Sep 2006 17:02:06 -0000
Received: from mailfe12.tele2.fr (HELO swip.net) (212.247.155.108)
  by a.mx.sunsite.dk with SMTP; 8 Sep 2006 17:01:53 -0000
X-T2-Posting-ID: mBXjJ9CYMpI3HGlT2s4LT8j3JzBVs7ioB0ePn7y7rgg=
X-Cloudmark-Score: 0.000000 []
Received: from [83.179.240.127] (HELO localhost)
  by mailfe12.swip.net (CommuniGate Pro SMTP 5.0.8)
  with ESMTP id 105481969 for zsh-workers@sunsite.dk; Fri, 08 Sep 2006 19:01:43 +0200
Date: Fri, 8 Sep 2006 19:01:42 +0200
From: "arno." <arno.@no-log.org>
To: zsh-workers@sunsite.dk
Subject: bug in zsh/system : `syserror ENOENT` doesn't work
Message-ID: <20060908170142.GA32049@localhost.localdomain>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="W/nzBZO5zC0uMSeA"
Content-Disposition: inline
User-Agent: Mutt/1.5.13 (2006-08-11)


--W/nzBZO5zC0uMSeA
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hi,

In module, zsh/system, some symbolic names are not recognized, but are=20
recognized otherwise by my system (Debian testing)

? zmodload zsh/system                                                      =
                                       =20
? syserror ENOENT
? echo $?                                                                  =
                        =20
2                                            =20

So, I have to refer to them with their number

? syserror E2  =20
No such file or directory
? syserror 2  =20
No such file or directory

errnos are defined on my system in /usr/include/asm-generic/errno.h
and that file contains the line :
#include <asm-generic/errno-base.h>

/usr/include/asm-generic/errno-base contains a few (about 30) errnos=20
definitions (for example, ENOENT is among them)

At compile time, /usr/include/asm-generic/errno.h is recognized as ERRNO_H
When Src/Modules/errnames1.awk parses it, it outputs errnames only from tha=
t file.
If I modify Src/Modules/Makefile by hand=20

$(AWK) -f $(sdir)/errnames1.awk /usr/include/asm-generic/errno.h /usr/inclu=
de/asm-generic/errno-base.h >errtmp.c; \

instead of

$(AWK) -f $(sdir)/errnames1.awk /usr/include/asm-generic/errno.h >errtmp.c;=
 \

that works, ENOENT and others are recognized

I don't known awk scripting, but may be it is possible to make=20
errnames1.awk recognize include directives and parse also the second=20
file ?
Hope that helps

arno

--W/nzBZO5zC0uMSeA
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)

iD8DBQFFAaH2iH9aBScBsrMRAg+MAJ4kCYkyaBSP5ZZht63v+eOSfWJrHACfQAe3
nz+qAupORSAS4pYtwi12ghk=
=WJkW
-----END PGP SIGNATURE-----

--W/nzBZO5zC0uMSeA--

