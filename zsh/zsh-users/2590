From zsh-users-return-2590-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Sep 09 12:53:16 1999
Return-Path: <zsh-users-return-2590-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10401 invoked from network); 9 Sep 1999 12:53:14 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 Sep 1999 12:53:14 -0000
Received: (qmail 620 invoked by alias); 9 Sep 1999 12:52:53 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 2590
Received: (qmail 611 invoked from network); 9 Sep 1999 12:52:52 -0000
Date: Thu, 9 Sep 1999 13:39:13 +0100
From: Adam Spiers <adam@thelonious.new.ox.ac.uk>
To: zsh users mailing list <zsh-users@math.gatech.edu>
Subject: simulation of dabbrev-expand
Message-ID: <19990909133913.A30055@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh users mailing list <zsh-users@math.gatech.edu>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.4i
X-URL: http://www.new.ox.ac.uk/~adam/
X-OS: Linux 2.2.9 i686

I still haven't successfully got 3.1.6-pws-* simulating
dabbrev-expand.  I'm using:

_history_complete_word () {
  local expl

  compstate[list]=
  compstate[insert]=menu

  _description -V expl 'history word'
#  compgen "$expl[@]" -Q -H 0 ''
  compgen -V 'history words' -Q -H 0 ''
}

zle -C _reverse_history_complete_word reverse-menu-complete _history_complete_word
bindkey '^[,' _reverse_history_complete_word

(I previously tried bindkey '^[,' reverse-menu-complete, but the
problem isn't with the reversing; see below)

It appears to always work fine when grabbing words from history added
by the current shell, but either doesn't work at all, or very
unreliably when you want to grab a word from the saved history.  This
is driving me up the wall, because dabbrev-expand is one of the
features I use most!  I'd be very grateful if someone can show what
I'm doing wrong.

Adam

P.S. Sorry for the pathetically lame preexec post.  I've read the
manual over so many times, I was /sure/ that I would have noticed a
preexec feature if it had existed.  Serves me right for not checking :-(

