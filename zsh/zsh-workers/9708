From zsh-workers-return-9708-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Feb 14 09:45:05 2000
Return-Path: <zsh-workers-return-9708-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2917 invoked from network); 14 Feb 2000 09:45:03 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 14 Feb 2000 09:45:03 -0000
Received: (qmail 27652 invoked by alias); 14 Feb 2000 09:44:52 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9708
Received: (qmail 27644 invoked from network); 14 Feb 2000 09:44:51 -0000
Date: Mon, 14 Feb 2000 10:44:50 +0100 (MET)
Message-Id: <200002140944.KAA09412@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Sun, 13 Feb 2000 18:43:06 +0000
Subject: Re: PATCH: 3.1.6-dev-18 AIX dependency fixes


Peter Stephenson wrote:

> ...
>
> There are other things --- for example, I suspect getting and setting of
> parameters internally needs a complete rethink --- but it's unrealistic to
> put a timetable on them.

Having done quite a bit of testing lately, I'd say: yes. It's
currently the slowest part of the shell, and used quite often.

> Since completion now appears to be pretty much stable, 4.0.1 could then
> appear without too many user-visible changes.  However, I think the
> wordcode stuff is going to continue to evolve anyway (rewrite parser to
> eliminate the old-style structs altogether, aim to eliminate
> HEAPALLOC/PERMALLOC by passing allocation strategy directly to appropriate
> constructors), and I don't think it would be a good idea to produce 4.0.1
> with the current hybrid state, though it won't matter for 3.1.7.

Well, I've written: a) a parser that immediatly produces the wordcode
(still recursive), b) a non-recursive execution code c) several
optimisations.

Unfortunately, b) doesn't seem to make things faster and probably less 
easy to read (I've only tested this on a Intel/Linux box yet, it may
be different on other machines). And, unfortunately, I overwrote the
patch for a) alone, so now I have it only for a) and c) together. I'll 
try to separate them again, but I don't know when I'll find the time.

And none of these needs to be in 3.1.7, of course.

Bye
 Sven

P.S.: c) is quite good, almost 30% faster than before.

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

