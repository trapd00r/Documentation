From zsh-workers-return-12190-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Jul 07 13:29:05 2000
Return-Path: <zsh-workers-return-12190-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1328 invoked from network); 7 Jul 2000 13:29:04 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Jul 2000 13:29:04 -0000
Received: (qmail 29811 invoked by alias); 7 Jul 2000 13:28:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12190
Received: (qmail 29804 invoked from network); 7 Jul 2000 13:28:55 -0000
Date: Fri, 7 Jul 2000 09:28:08 -0400
From: Gene Cohler <gene@bear.com>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: zsh-workers@sunsite.auc.dk
Subject: Re: Problem compiling 3.1.9 under HP-UX 10.20
Message-ID: <20000707092807.G29400@bear.com>
References: <0FX4007G6UV5CT@la-la.cambridgesiliconradio.com> <1000707053849.ZM28504@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.3.3i
In-Reply-To: <1000707053849.ZM28504@candle.brasslantern.com>; from schaefer@candle.brasslantern.com on Fri, Jul 07, 2000 at 05:38:49AM +0000



HPUX 10.20:
----------

I bumped into this earlier - under HPUX 10.20 and I 'fixed' the problem
by adding -D_XOPEN_SOURCE_EXTENDED. This is not defined it seems
using -Ae compiler flag (which does define _XOPEN_SOURCE)

The reason, quite obviously, is this code frag in /usr/include/netdb.h:

/*
 * Error return codes from gethostbyname() and gethostbyaddr()
 * (left in extern int h_errno).
 */

#ifdef _XOPEN_SOURCE_EXTENDED
extern int h_errno;
#endif


HPUX 11.00 
----------
 A brief glance suggests it may be different - but I haven't had a chance 
 yet to look into it properly. I will report back when I do.


On Fri, Jul 07, 2000 at 05:38:49AM +0000, Bart Schaefer wrote:
> On Jul 3,  6:49pm, Peter Stephenson wrote:
> } Subject: Re: Problem compiling 3.1.9 under HP-UX 10.20
> }
> } > Hi,
> } > 
> } > I've gotten zsh-3.1.9 to compile on my workstation, but only by
> } > excluding zftp.  The etc/MACHINES file doesn't state anything special
> } > about HP-UX.
> } > zftp.c:211: `h_errno' undeclared (first use in this function)
> } 
> } Finally I made some time to look at this.  From the information above,
> } this is the best I can do.
> 
> This patch has been bothering me ever since it appeared.
> 
> } +dnl Check for h_errno external variable
> } +AC_CACHE_CHECK(if we need our own h_errno,
> } +  zsh_cv_decl_h_errno_use_local,
> } +  [AC_TRY_LINK( ,[extern int h_errno; h_errno = 0;],
> } +  zsh_cv_decl_h_errno_use_local=no,
> } +  zsh_cv_decl_h_errno_use_local=yes)])
> 
> That's testing whether it's possible to *link with* h_errno; if it is,
> then we conclude that we need not declare it locally.
> 
> But the problem in zftp.c is that h_errno is not *declared* at compile
> time, not that it's not *defined* at link time.  That would indicate to
> me that zftp.c hasn't #included the correct header file.
> 
> So I don't understand how this patch could possibly solve the problem
> that was reported.  Has anybody actually tried it yet, *on HP-UX*?
> 
> -- 
> Bart Schaefer                                 Brass Lantern Enterprises
> http://www.well.com/user/barts              http://www.brasslantern.com
> 
> Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

-- 
  Gene Cohler
  Bear Stearns & Co.


***********************************************************************
Bear Stearns is not responsible for any recommendation, solicitation, 
offer or agreement or any information about any transaction, customer 
account or account activity contained in this communication.
***********************************************************************

