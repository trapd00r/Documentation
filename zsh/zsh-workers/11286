From zsh-workers-return-11286-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 09 19:33:09 2000
Return-Path: <zsh-workers-return-11286-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20736 invoked from network); 9 May 2000 19:33:08 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 May 2000 19:33:08 -0000
Received: (qmail 12654 invoked by alias); 9 May 2000 19:32:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11286
Received: (qmail 12603 invoked from network); 9 May 2000 19:32:51 -0000
To: zsh-workers@sunsite.auc.dk
Subject: closing stdin (Re: _make suppress error on OpenBSD.)
References: <hvoog6ggc41.fsf@serein.m17n.org>
MIME-Version: 1.0 (generated by SEMI 1.13.7 - "Awazu")
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@m17n.org>
Date: 10 May 2000 04:34:07 +0900
In-Reply-To: <hvoog6ggc41.fsf@serein.m17n.org>
 (Tanaka Akira's message of "09 May 2000 21:08:14 +0900")
Message-ID: <hvohfc7h61c.fsf@serein.m17n.org>
Lines: 24
User-Agent: T-gnus/6.14.1 (based on Gnus v5.8.3) (revision 16) SEMI/1.13.7 (Awazu) FLIM/1.13.2 (Kasanui) Emacs/20.6 (i686-pc-linux-gnu) MULE/4.0 (HANANOEN)

In article <hvoog6ggc41.fsf@serein.m17n.org>,
  Tanaka Akira <akr@m17n.org> writes:

> Z:akr@coulee% Src/zsh -f
> coulee% bindkey -e; autoload -U compinit; compinit -D
> coulee% make awk: i/o error occurred while closing /dev/stdin
>  input record number 366, file Makefile
>  source line number 1

I found same problem in zfcd_match.  It can easily fixed but I like
more fundamental fix.

This problem is caused by the one true awk behavior.  (OpenBSD comes
with the one true awk.)  The one true awk closes all file descriptors
which should be opened when exit and complain if it causes an error.
Of course, it assumes that stdin is opened.

http://cm.bell-labs.com/who/bwk/awk.tar.gz

However, we can suppress the error by modifying each awk invocation,
but I think that completion system should redirect stdin from
/dev/null instead of closing it.
-- 
Tanaka Akira

