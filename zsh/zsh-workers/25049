From zsh-workers-return-25049-mason-zsh=primenet.com.au@sunsite.dk Thu May 15 21:09:26 2008
Return-Path: <zsh-workers-return-25049-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 541 invoked from network); 15 May 2008 21:09:15 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 15 May 2008 21:09:15 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 87069 invoked from network); 15 May 2008 21:09:10 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 15 May 2008 21:09:10 -0000
Received: (qmail 9809 invoked by alias); 15 May 2008 21:09:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25049
Received: (qmail 9791 invoked from network); 15 May 2008 21:09:06 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 15 May 2008 21:09:06 -0000
Received: from mtaout01-winn.ispmail.ntl.com (mtaout01-winn.ispmail.ntl.com [81.103.221.47])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 7E9B98059114
	for <zsh-workers@sunsite.dk>; Thu, 15 May 2008 23:09:01 +0200 (CEST)
Received: from aamtaout02-winn.ispmail.ntl.com ([81.103.221.35])
          by mtaout01-winn.ispmail.ntl.com with ESMTP
          id <20080515211240.SKDF14647.mtaout01-winn.ispmail.ntl.com@aamtaout02-winn.ispmail.ntl.com>
          for <zsh-workers@sunsite.dk>; Thu, 15 May 2008 22:12:40 +0100
Received: from pws-pc ([81.107.40.67]) by aamtaout02-winn.ispmail.ntl.com
          with ESMTP
          id <20080515211141.WLJB17393.aamtaout02-winn.ispmail.ntl.com@pws-pc>
          for <zsh-workers@sunsite.dk>; Thu, 15 May 2008 22:11:41 +0100
Date: Thu, 15 May 2008 22:08:00 +0100
From: Peter Stephenson <p.w.stephenson@ntlworld.com>
To: zsh-workers <zsh-workers@sunsite.dk>
Subject: Re: %F doesn't work in format style
Message-ID: <20080515220800.6a91e574@pws-pc>
In-Reply-To: <237967ef0805151229r4955bacep64af7bb018bc16b@mail.gmail.com>
References: <237967ef0805151229r4955bacep64af7bb018bc16b@mail.gmail.com>
X-Mailer: Claws Mail 3.3.1 (GTK+ 2.12.5; x86_64-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: ClamAV 0.91.2/7131/Thu May 15 22:18:05 2008 on bifrost
X-Virus-Status: Clean

On Thu, 15 May 2008 21:29:25 +0200
"Mikael Magnusson" <mikachu@gmail.com> wrote:
> zstyle ':completion:*:corrections' format '%B---- %d (errors: %e)%b'
> works fine
> zstyle ':completion:*:corrections' format '%F{red}---- %f%d (errors: %e)%b'
> produces
> {red}---- corrections (errors: 2)
> (unformatted)
> 
> The manpage claims
>   This  string  may  also  contain  the  sequences
>   to specify output attributes, such as `%B', `%S' and `%{...%}'
> 
> Is %F such as %B? :) It's listed in the same section anyway.

This is all handled completely separately in zle_tricky.c for standard
completion formatting and yet again in complist.c when zsh/complist is
loaded.  Sven never reused code if there was any hope of creating
something at least marginally incompatible in another file.  Colours
should definitely be added to completion.  Ideally, in fact,
highlighting should be subtracted and done via the code I've moved into
the main shell, but as completion formatting doesn't handle full prompt
escapes that's not so easy.

-- 
Peter Stephenson <p.w.stephenson@ntlworld.com>
Web page now at http://homepage.ntlworld.com/p.w.stephenson/

