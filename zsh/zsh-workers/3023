From zsh-workers-request@euclid.skiles.gatech.edu Mon Mar 24 10:04:55 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 4815 invoked from network); 24 Mar 1997 10:04:54 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 24 Mar 1997 10:04:54 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id EAA15015; Mon, 24 Mar 1997 04:51:57 -0500 (EST)
Resent-Date: Mon, 24 Mar 1997 04:51:57 -0500 (EST)
Message-Id: <199703240954.KAA23113@hydra.ifh.de>
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: ZLE special parameters 
In-reply-to: "Zefram"'s message of "Sat, 22 Mar 1997 16:36:55 MET."
             <13344.199703221636@stone.dcs.warwick.ac.uk> 
Date: Mon, 24 Mar 1997 10:54:41 +0100
From: Peter Stephenson <pws@ifh.de>
Resent-Message-ID: <"dOKRU3.0.Yg3.ywaDp"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3023
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Zefram wrote:
> Incidentally, if I read the unset code correctly, a parameter created
> within a function using typeset can actually be removed by a nested
> function using unset, although it can't be removed by the function itself.
> Is this POSIX behaviour, desirable, neither or both?

This is probably wrong.  There was an exchange between Bart and me
about funny things with typeset and local variables some time ago.  It
needs rewriting.

I'm getting a core dump with the increment function: it's quite
possible I've missed some necessary intermediate patch, though; the
number pending is rather large at the moment.

% zle -N increment
% bindkey \^xi increment
% echo 38

Hitting ^xi twice gives a core dump.  Any modification of LBUFFER
seems to do this.  It's coming in makezleparams(); createparam() is
returning a NULL because the (oldpm && !(oldpm->flags & PM_UNSET))
test failed.  Oddly enough, it's always when zp->name is BUFFER even
if I only change LBUFFER.  Even if I am missing a patch, I worry about
relying on the parameter not already existing at this point.

-- 
Peter Stephenson <pws@ifh.de>       Tel: +49 33762 77366
WWW:  http://www.ifh.de/~pws/       Fax: +49 33762 77413
Deutsches Elektronen-Synchrotron --- Institut fuer Hochenergiephysik Zeuthen
DESY-IfH, 15735 Zeuthen, Germany.

