From zsh-users-return-14001-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 07 00:59:50 2009
Return-Path: <zsh-users-return-14001-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28791 invoked from network); 7 Apr 2009 00:59:46 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Apr 2009 00:59:46 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 1996 invoked from network); 7 Apr 2009 00:59:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Apr 2009 00:59:26 -0000
Received: (qmail 15187 invoked by alias); 7 Apr 2009 00:59:06 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14001
Received: (qmail 15173 invoked from network); 7 Apr 2009 00:59:05 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 7 Apr 2009 00:59:05 -0000
Received: from atom.smasher.org (atom.smasher.org [69.55.237.145])
	by bifrost.dotsrc.org (Postfix) with SMTP id 2128982D4B6A
	for <zsh-users@sunsite.dk>; Tue,  7 Apr 2009 02:58:51 +0200 (CEST)
Received: (qmail 34923 invoked by uid 1000); 7 Apr 2009 00:58:50 -0000
Message-ID: <20090407005850.34922.qmail@smasher.org>
cc: zsh-users@sunsite.dk
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
Date: Tue, 7 Apr 2009 12:58:48 +1200 (NZST)
From: Atom Smasher <atom@smasher.org>
In-Reply-To: <20090406100300.5c377728@news01>
MIME-Version: 1.0
OpenPGP: id=0xB88D52E4D9F57808; algo=1 (RSA); size=4096; url=http://atom.smasher.org/pgp.txt
References: <20090406082744.28853.qmail@smasher.org> <20090406100300.5c377728@news01>
Subject: Re: killed by signal
To: Peter Stephenson <pws@csr.com>
X-POM: The Moon is Waxing Gibbous (93% of Full)
X-Hashcash: 1:20:0904070058:pws@csr.com::NVLRubHxqMOn38qe:002g7y
X-Hashcash: 1:20:0904070058:zsh-users@sunsite.dk::3I+svRtdKix9Hrff:0000000000000
	0000000000000000000000003Qpy
X-Virus-Scanned: ClamAV 0.92.1/9209/Mon Apr  6 19:51:36 2009 on bifrost
X-Virus-Status: Clean

On Mon, 6 Apr 2009, Peter Stephenson wrote:

> $jobstates (from zsh/parameter) tells you.  If that's not the answer 
> you'll have to give more details about what you're actually trying to do 
> (which is often the way to get the most useful results).
===============

i can use the return status to figure out if a command was "terminated" by 
a signal, and which signal was the killer... 128+9 = 137 == KILL. i know 
the command immediately preceding the precmd was KILLed.

but if a command is suspended (TSTP; 20 on linux, 18 on freebsd) precmd 
will see a return status <128, which could be a "legal" value for a 
command to return indicating a particular failure. i'd like precmd to 
distinguish between a command that returns 18 or 20 (freebsd or linux, 
respectively), and a command that is suspended with ^Z.

specific example... on freebsd i can get a return status of 18 either by 
suspending a job with ^Z, or running:
 	zip -MM foo.zip no-such-file
  so the question is: how can the shell (can the shell?) tell that one of 
those was suspended with a signal (^Z, TSTP), and zip which is indicating 
a specific failure (zip: "File not found").

for a few seconds i thought the ERRNO might be useful, but it seems to not 
be.

thanks...


-- 
         ...atom

  ________________________
  http://atom.smasher.org/
  762A 3B98 A3C3 96C9 C6B7 582A B88D 52E4 D9F5 7808
  -------------------------------------------------

 	"Since trade ignores national boundaries and the manufacturer
 	 insists on having the world as a market, the flag of his
 	 nation must follow him, and the doors of the nations which
 	 are closed against him must be battered down. Concessions
 	 obtained by financiers must be safeguarded by ministers of
 	 state, even if the sovereignty of unwilling nations be
 	 outraged in the process. Colonies must be obtained or
 	 planted, in order that no useful corner of the world may be
 	 overlooked or left unused."
 		-- Woodrow Wilson,
 		President of the United States, 1919

