From zsh-workers-return-11442-mason-zsh=primenet.com.au@sunsite.auc.dk Wed May 17 13:11:59 2000
Return-Path: <zsh-workers-return-11442-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2710 invoked from network); 17 May 2000 13:11:58 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 17 May 2000 13:11:58 -0000
Received: (qmail 12618 invoked by alias); 17 May 2000 13:11:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11442
Received: (qmail 12611 invoked from network); 17 May 2000 13:11:49 -0000
Date: Wed, 17 May 2000 15:11:26 +0200 (MET DST)
Message-Id: <200005171311.PAA10585@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Bart Schaefer"'s message of Wed, 17 May 2000 09:46:06 +0000
Subject: Re: Why does ^X? behave differently than TAB?


Bart Schaefer wrote:

> This situation is a little baroque; I'm not sure I can give a simple case
> that reproduces it.
> 
> I have a script that uses a `select' loop, and I want completion at the
> prompt.  So I did this inside the script:
> 
> local curcontext=scriptname:::
> zstyle ':completion:scriptname:*' insert-tab no
> zstyle ':completion:scriptname:*' completer _script_completer
> _script_completer() { compcall -T -D }
> 
> The reason for the compcall is that this is an old script that uses a trick
> with compctl -T to force 3.0.x to complete something other than commands at
> the select prompt:
> 
> l=(list of things to complete)
> compctl -Tx 'p[1,-1]' -f - 'W[0,*]' -k l ${${ZSH_VERSION##3.0*}:+-tn}
> 
> I.e., complete from $l in the first word, otherwise complete file names.
> 
> This all works fine as long as I never press anything but TAB for completion;
> it even starts up menu-selection properly based on my other styles, etc.
> 
> However, if at any point after the first TAB, I press ^X? (_complete_debug)
> instead, I get command completion (which usually means a menu-select with
> 2198 choices, but sometimes it just asks if I really want to see all 2198
> possibilities).

I can't reproduce this. Does _complete_debug write its output file?
Can I see it?

Oh god, I hate compcall.

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

