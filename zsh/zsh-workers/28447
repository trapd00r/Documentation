From zsh-workers-return-28447-mason-zsh=primenet.com.au@zsh.org Wed Nov 24 23:54:08 2010
Return-Path: <zsh-workers-return-28447-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1346 invoked by alias); 24 Nov 2010 23:54:07 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28447
Received: (qmail 1436 invoked from network); 24 Nov 2010 23:53:46 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,SPF_HELO_PASS
	autolearn=ham version=3.3.1
Received-SPF: none (ns2.melb.primenet.com.au: domain at closedmail.com does not designate permitted sender hosts)
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <101124154951.ZM18369@torch.brasslantern.com>
Date: Wed, 24 Nov 2010 15:49:51 -0800
In-reply-to: <2A1FA6CC-8EE8-4E01-AE40-5F02F4F340AE@gmail.com>
Comments: In reply to Sorin Ionescu <sorin.ionescu@gmail.com>
 "Re: Mac OS X Prompt Bug" (Nov 24,  4:14pm)
References: <BAB9C52A-B68A-4B5A-99C2-F85B310B1380@gmail.com>
	<20101124153007.GF1727@prunille.vinc17.org>
	<9ADAD50F-12F2-4B0A-A494-F339583AEDEC@gmail.com>
	<alpine.LNX.2.01.1011241242320.2792@hp>
	<2A1FA6CC-8EE8-4E01-AE40-5F02F4F340AE@gmail.com>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: zsh-workers@zsh.org
Subject: Re: Mac OS X Prompt Bug
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii

On Nov 24,  4:14pm, Sorin Ionescu wrote:
}
} There is no /etc/zshprofile, /etc/zshrc or any other combination.
} /etc/profile is not sourced.
}
} I have found nothing in the output of zsh -l -x. Like I said, it's
} not a configuration issue. It's something in ZSH or Terminal.app or
} both. Nothing hooks on those functions. It's possible that ZSH outputs
} some sequences Terminal.app does not like and generates those lines.

Things that zsh might be doing when the window first opens include
closing and re-opening the standard I/O streams, reading the name
of the terminal device with ttyname(), setting the close-on-exec
flag on some descriptors, and reading the size of the terminal from
ioctl().  It might also repeat that last a few times if it receives
WINCH signals.

You could try putting a TRAPWINCH function in your ~/.zshenv file
to see if that's called when the blank lines are printed.  Otherwise
you're going to have to resort to some sort of debugger or system
call trace.

