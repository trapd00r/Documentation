From zsh-workers-return-22872-mason-zsh=primenet.com.au@sunsite.dk Fri Oct 13 00:13:06 2006
Return-Path: <zsh-workers-return-22872-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22225 invoked from network); 13 Oct 2006 00:13:02 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.6 (2006-10-03) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.6
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Oct 2006 00:13:02 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 92734 invoked from network); 13 Oct 2006 00:12:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2006 00:12:54 -0000
Received: (qmail 1437 invoked by alias); 13 Oct 2006 00:12:47 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22872
Received: (qmail 1428 invoked from network); 13 Oct 2006 00:12:46 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 13 Oct 2006 00:12:46 -0000
Received: (qmail 91891 invoked from network); 13 Oct 2006 00:12:46 -0000
Received: from mailfe09.tele2.fr (HELO swip.net) (212.247.155.12)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2006 00:12:44 -0000
X-T2-Posting-ID: mBXjJ9CYMpI3HGlT2s4LT8j3JzBVs7ioB0ePn7y7rgg=
X-Cloudmark-Score: 0.000000 []
Received: from [213.103.202.32] (HELO localhost)
  by mailfe09.swip.net (CommuniGate Pro SMTP 5.0.8)
  with ESMTPS id 130436062 for zsh-workers@sunsite.dk; Fri, 13 Oct 2006 02:12:43 +0200
Date: Fri, 13 Oct 2006 02:12:43 +0200
From: "arno." <arno.@no-log.org>
To: zsh-workers@sunsite.dk
Subject: bug: mutt completion doesn't complete address book
Message-ID: <20061013001243.GA32281@localhost.localdomain>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="KsGdsel6WgEHnImy"
Content-Disposition: inline
User-Agent: Mutt/1.5.13 (2006-08-11)


--KsGdsel6WgEHnImy
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hi,
when I try to use completion with mutt, it is supposed to display my=20
address book, but instead only completes with local addresses.

$mutt <TAB>
arno root games ...

That's because in Completion/Unix/_email_addresses
variable muttrc is defined with : muttrc=3D"~/.muttrc"
and ~ seems to be not expanded when used in :

plugins=3D(
    ${${(k)functions[(I)_email-*]#*-}:#(${(kj.|.)~files})}
    $files(Ne:'REPLY=3D( ${(k)files[(r)$REPLY]} ):')
)
and therefore, _email-mutt is not triggered.

When removing the double quotes, completion works fine.

On IRC, ft also pointed another solution :=20
use ${~muttrc} instead of $muttrc in :
 files=3D( MH ${MH:-~/.mh_profile} mutt $muttrc mush ~/.mushrc mail ${MAILR=
C:-~/.mailrc} pine ~/.addressbook )

arno


Index: Completion/Unix/Type/_email_addresses
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_email_addresses,v
retrieving revision 1.4
diff -u -r1.4 _email_addresses
--- Completion/Unix/Type/_email_addresses	8 Jun 2005 12:08:06 -0000	1.4
+++ Completion/Unix/Type/_email_addresses	13 Oct 2006 00:03:06 -0000
@@ -129,7 +129,7 @@
=20
   # get list of all plugins except any with missing config files
   if ! zstyle -s ":completion:${curcontext}:email-addresses" muttrc muttrc=
; then
-    [[ -e ~/mutt/muttrc ]] && muttrc=3D"~/mutt/muttrc" || muttrc=3D"~/.mut=
trc"
+    [[ -e ~/mutt/muttrc ]] && muttrc=3D~/mutt/muttrc || muttrc=3D~/.muttrc
   fi
   files=3D( MH ${MH:-~/.mh_profile} mutt $muttrc mush ~/.mushrc mail ${MAI=
LRC:-~/.mailrc} pine ~/.addressbook )
   plugins=3D(=20

--KsGdsel6WgEHnImy
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)

iD8DBQFFLtn7iH9aBScBsrMRAoGkAKCjarkLRkPEio9G9sl+Jme8JPTIgACfR3Ol
PNlqTqAMc3+gYCAV+D6Lqvk=
=MvE+
-----END PGP SIGNATURE-----

--KsGdsel6WgEHnImy--

