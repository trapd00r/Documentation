From zsh-workers-return-6102-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Apr 25 14:35:53 1999
Return-Path: <zsh-workers-return-6102-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7159 invoked from network); 25 Apr 1999 14:35:52 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Apr 1999 14:35:52 -0000
Received: (qmail 15952 invoked by alias); 25 Apr 1999 14:35:44 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6102
Received: (qmail 15945 invoked from network); 25 Apr 1999 14:35:42 -0000
To: zsh-workers@sunsite.auc.dk
Path: mason
From: mason@primenet.com.au (Geoff Wing)
Newsgroups: lists.zsh.workers
Subject: Re: yet another undesired 3.1.5-pws-15 change
Date: 25 Apr 1999 14:35:38 GMT
Organization: PrimeNet Computer Consultants
Lines: 30
Distribution: local
Message-ID: <slrn7i6a1p.6s3.mason@coral.primenet.com.au>
References: "Timothy J Luoma"'s message of "Fri, 23 Apr 1999 23:11:06 DFT." <9904251344.AA35300@ibmth.df.unipi.it>
Reply-To: mason@primenet.com.au
NNTP-Posting-Host: coral.primenet.com.au
X-Trace: coral.primenet.com.au 925050938 7044 203.43.15.2 (25 Apr 1999 14:35:38 GMT)
X-Complaints-To: usenet@coral.primenet.com.au
NNTP-Posting-Date: 25 Apr 1999 14:35:38 GMT
User-Agent: slrn/0.9.5.4 (UNIX)

Peter Stephenson <pws@ibmth.df.unipi.it> typed:
:Timothy J Luoma wrote:
:> There's still a problem with my PROMPT:
:> PROMPT='
:> ---------------------------------------- %t/%T  
:> ----------------------------------------
:> %S[OLDPWD: $OLDPWD]
:>    [PWD: %~]%s
:> %B%n$LOCAL_HOST%b $REMOTE_HOST
:> '
:> it produces an extra blank line at the end (unlike 3.1.4)
:
:I didn't dare fix this when I originally spotted it, but I think the answer
:is the following.  It doesn't have any immediately obvious ill effects.
:-	    if (lpromptw == 0)
:+	    if (lpromptw == 0 && lprompth == 1)
: 		zputs("\n", shout);	/* works with both hasam and !hasam */

This can't really work, can it.  Say your term width is 80 and your prompt
is 80 chars long, then lpromptw == 0 && lprompth == 2.  Now the cursor is
sitting at the right column and wants to be in the left column, but you've
just avoided putting it there and if you don't have automargin (hasam == 1)
then you're stuffed.  There needs to be a method to differentiate between
having your cursor at 0 and at 80 which probably isn't in there now but
shouldn't be hard to add.  I'll look at doing a patch for this now.

Regards,
-- 
Geoff Wing   <gcw@pobox.com>            Mobile : (Australia) 0413 431 874 <<<new
Work URL: http://www.primenet.com.au/   Ego URL: http://pobox.com/~gcw/

