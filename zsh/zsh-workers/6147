From zsh-workers-return-6147-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Apr 29 05:51:20 1999
Return-Path: <zsh-workers-return-6147-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14649 invoked from network); 29 Apr 1999 05:51:20 -0000
Received: from ns2.primenet.com.au (HELO primenet.com.au) (203.24.36.3)
  by ns1.primenet.com.au with SMTP; 29 Apr 1999 05:51:20 -0000
Received: (qmail 305 invoked from network); 29 Apr 1999 05:51:02 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns2.primenet.com.au with SMTP; 29 Apr 1999 05:51:02 -0000
Received: (qmail 17632 invoked by alias); 29 Apr 1999 05:49:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6147
Received: (qmail 17623 invoked from network); 29 Apr 1999 05:49:36 -0000
Message-Id: <199904290549.OAA26192@pop1.ngy.3web.ne.jp>
From: Tatsuo Furukawa <frkwtto@osk3.3web.ne.jp>
To: zsh-workers@sunsite.auc.dk
Subject: zsh hangs (3.0.6-pre-2, 3.1.5-pws-16)
Mime-Version: 1.0 (generated by tm-edit 7.52)
Content-Type: text/plain; charset=US-ASCII
Date: Thu, 29 Apr 1999 14:28:57 +0900
X-Dispatcher: impost version 0.99i (Apr. 6, 1997)
Lines: 72


Hello, zsh developers.  I really appreciate including "absolute cursor
move" patch.

But, I found another problem.

(Maybe) as you know, zsh-3.0.X is not set COLUMNS and LINE envionment
variable.  (But zsh-3.1.X does).  I am using zsh-3.0.X, and I want to
set them, so, I write "eval $(resize)" code in TRAPWINCH() function.
This is based on "archive/latest/4447" message.

This works almost well.  But sometime zsh hangs.  At last, I found the
positive proof.  Here is:


1. Write following in .zshrc

RPROMPT="(%l)"

function TRAPWINCH() {
        eval $(resize)
        echo;
        echo "resized";
        echo
} 


2. Start new terminal

    $ xterm &

3. Rlogin into localhost

    $ rlogin localhost

4. Change terminal size using mouse.

    Then "resized" message is displayed, and RPROMPT is displayed into
    'right' place.  (But why is "resized" message displayed twice?)

5. Exit.

    $ exit

    Then, you will return to origial shell.  

6. Execute following command.

    $  eval `resize`

7. zsh hangs. (T_T)


I tested the following situation:

    zsh:    3.0.6-pre-2
    OS:     HP-UX 10.20

    zsh:    3.0.6-pre-2
    OS:     Linux/Slackware 3.1

    zsh:    3.1.5-pws-16
    OS:     Linux/Slackware 3.1
    
zsh hangs in all case.


This plobrem is too difficult to fix for me.  Sorry for report only,
no patch.

-- 
Tatsuo Furukawa  (frkwtto@osk3.3web.ne.jp)

