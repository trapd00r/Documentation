From zsh-workers-request@math.gatech.edu Fri Dec 26 13:14:02 1997
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 21552 invoked from network); 26 Dec 1997 13:13:59 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 26 Dec 1997 13:13:59 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id HAA13102;
	Fri, 26 Dec 1997 07:58:55 -0500 (EST)
Resent-Date: Fri, 26 Dec 1997 07:58:55 -0500 (EST)
Sender: k@anna.in-berlin.de
To: zsh-workers@math.gatech.edu
Subject: Src/rlimits.awk does not work on old NeXTs
From: koenig@kulturbox.de (Andreas J. Koenig)
Date: 26 Dec 1997 13:58:46 +0100
In-Reply-To: Tuomo Pyhala's message of "Fri, 26 Dec 1997 01:00:15 +0200 (EET)"
Message-ID: <sfcpvmk5khl.fsf@anna.in-berlin.de>
Lines: 36
X-Mailer: Gnus v5.4.66/Emacs 19.34
Resent-Message-ID: <"fU3VD.0.fC3.Feweq"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3661
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

The awk that came with NeXTs was pretty dumb. It didn't even have a
useful manpage, so all I can do is to show you the error produced...

  awk -f ./rlimits.awk /usr/include/bsd/sys/resource.h > rlimits.h
  awk: syntax error near line 21
  awk: illegal statement near line 21

and a workaround that in fact does produce a fine rlimits.h on the
NeXT. This all happens on a NeXT 3.3.

*** /tmp/rlimits.awk.~1.1~	Fri Dec 26 13:41:36 1997
--- /tmp/rlimits.awk	Fri Dec 26 13:41:36 1997
***************
*** 18,24 ****
      # in this case I assume GNU libc resourcebits.h
      if (limnum == "") {
  	limnum = limidx++
! 	sub (",", "", limnam)
      }
      limrev[limnam] = limnum
      if (lim[limnum] == "") {
--- 18,26 ----
      # in this case I assume GNU libc resourcebits.h
      if (limnum == "") {
  	limnum = limidx++
! 	# sub (",", "", limnam)   # sub not known on NeXT
! 	split(limnam,limnamarr,",")
! 	limnam = limnamarr[1] limnamarr[2]
      }
      limrev[limnam] = limnum
      if (lim[limnum] == "") {


Hope this helps some, enjoy,
-- 
andreas

