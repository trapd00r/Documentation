From zsh-workers-return-6883-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Jun 27 16:45:52 1999
Return-Path: <zsh-workers-return-6883-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22782 invoked from network); 27 Jun 1999 16:45:49 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Jun 1999 16:45:49 -0000
Received: (qmail 2289 invoked by alias); 27 Jun 1999 16:45:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6883
Received: (qmail 2277 invoked from network); 27 Jun 1999 16:45:38 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <990627164528.ZM11299@candle.brasslantern.com>
Date: Sun, 27 Jun 1999 16:45:28 +0000
In-Reply-To: <9906271321.AA16977@ibmth.df.unipi.it>
Comments: In reply to Peter Stephenson <pws@ibmth.df.unipi.it>
        "Re: Final (?) info on signals/crashes when suspending "mutt" function" (Jun 27,  3:21pm)
References: <9906271321.AA16977@ibmth.df.unipi.it>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Peter Stephenson <pws@ibmth.df.unipi.it>, zsh-workers@sunsite.auc.dk
Subject: Re: Final (?) info on signals/crashes when suspending "mutt" function
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jun 27,  3:21pm, Peter Stephenson wrote:
} Subject: Re: Final (?) info on signals/crashes when suspending "mutt" func
}
} "Bart Schaefer" wrote:
} > The failure in case (1) is far less catastrophic than case (2), so I think
} > the right solution is to back off to the behavior from patch 6707
} 
} Somebody who's been looking at this will have to produce counter-patches
} for pws-24, I'm not going to attempt this myself on a wing and a prayer.

I spent several hours last night attempting it in 3.0.6 and have not been
having much luck.  I got it back to the point where suspending the mutt
function doesn't kill the parent, thing, but then it appears (from strace)
that bin_fg() is calling attachtty() with the parent shell's process ID
rather than that of the stopped job, which would mean that someplace that
I haven't found yet, the `gleader' of the job entry is set incorrectly.
(The effect of this is that mutt appears to come into the foreground, but
then gets a SIGTTIN and stops again as soon as it tries to read input.)

I fear I'm going to have to punt this to Sven.  I had really hoped to put
out a test 3.0.6 this weekend, but now it may have to wait a couple weeks.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

