From zsh-workers-return-14197-mason-zsh=primenet.com.au@sunsite.dk Wed May 02 08:57:45 2001
Return-Path: <zsh-workers-return-14197-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19861 invoked from network); 2 May 2001 08:57:44 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 May 2001 08:57:44 -0000
Received: (qmail 24760 invoked by alias); 2 May 2001 08:57:39 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14197
Received: (qmail 24749 invoked from network); 2 May 2001 08:57:39 -0000
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
Date: Wed, 2 May 2001 10:57:27 +0200 (MET DST)
Message-Id: <200105020857.KAA03759@beta.informatik.hu-berlin.de>
To: zsh-workers@sunsite.dk
Subject: Re: Use of named directories in completions broken.
In-Reply-To: <Tc0a88d01533c851c99@mailsweeper01.cambridgesiliconradio.com>

Peter Stephenson wrote:

> Still having problems with this...
> 
> % echo ~dev/<TAB>
> 
> does menu completion as expected.
> 
> % echo ~dev/sr<TAB>
> 
> should complete to ~dev/src/ but expands instead (then does completion on
> that the next time round).  Similar problem with plain ~/ .  Here's the
> _expand part of the trace for the first example.  Should that pattern on
> line 36 begin (~*/*| rather than (~*/| ?

Ouch.  Yes.

Bye
  Sven

Index: Completion/Base/Completer/_expand
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Base/Completer/_expand,v
retrieving revision 1.4
diff -u -r1.4 _expand
--- Completion/Base/Completer/_expand	2001/04/30 11:09:50	1.4
+++ Completion/Base/Completer/_expand	2001/05/02 08:57:18
@@ -33,7 +33,7 @@
 #  [[ "$word" = (\~*/|\$(|[=~#^+])[a-zA-Z0-9_\[\]]##[^a-zA-Z0-9_\[\]]|\$\{*\}?)[^\$\{\}\(\)\<\>?^*#~]# ]] &&
 
 zstyle -T ":completion:${curcontext}:" suffix &&
-  [[ "$word" = (\~*/|*\$(|[=~#^+])[a-zA-Z0-9_\[\]]##[^a-zA-Z0-9_\[\]]|*\$\{*\}?) &&
+  [[ "$word" = (\~*/*|*\$(|[=~#^+])[a-zA-Z0-9_\[\]]##[^a-zA-Z0-9_\[\]]|*\$\{*\}?) &&
      "${(e)word}" != *[][^*?\(\)\<\>\{\}\|]* ]] &&
   return 1
 

-- 
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

