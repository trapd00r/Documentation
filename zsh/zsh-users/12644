From zsh-users-return-12644-mason-zsh=primenet.com.au@sunsite.dk Wed Feb 27 12:53:52 2008
Return-Path: <zsh-users-return-12644-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8885 invoked from network); 27 Feb 2008 12:53:48 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 27 Feb 2008 12:53:48 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 71378 invoked from network); 27 Feb 2008 12:53:31 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Feb 2008 12:53:31 -0000
Received: (qmail 22642 invoked by alias); 27 Feb 2008 12:53:24 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12644
Received: (qmail 22628 invoked from network); 27 Feb 2008 12:53:24 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 27 Feb 2008 12:53:24 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [217.69.20.190])
	by bifrost.dotsrc.org (Postfix) with ESMTP id A3C7C8026E0B
	for <zsh-users@sunsite.dk>; Wed, 27 Feb 2008 13:53:18 +0100 (CET)
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly47d.srv.mailcontrol.com (MailControl) with ESMTP id m1RCr5EO021741
	for <zsh-users@sunsite.dk>; Wed, 27 Feb 2008 12:53:15 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 27 Feb 2008 12:52:06 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id m1RCq6s1009234
	for <zsh-users@sunsite.dk>; Wed, 27 Feb 2008 12:52:06 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id m1RCq6wd009231
	for <zsh-users@sunsite.dk>; Wed, 27 Feb 2008 12:52:06 GMT
Message-Id: <200802271252.m1RCq6wd009231@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: Portable zsh scripts
In-reply-to: <fq3lhr$fgj$1@ger.gmane.org>
References: <fq3lhr$fgj$1@ger.gmane.org>
Comments: In-reply-to Thorsten Kampe <thorsten@thorstenkampe.de>
   message dated "Wed, 27 Feb 2008 12:37:14 +0000."
Date: Wed, 27 Feb 2008 12:52:06 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 27 Feb 2008 12:52:06.0416 (UTC) FILETIME=[8EB49900:01C8793F]
X-Scanned-By: MailControl A-08-00-04 (www.mailcontrol.com) on 10.68.0.157
X-Virus-Scanned: ClamAV 0.91.2/6009/Wed Feb 27 12:24:23 2008 on bifrost
X-Virus-Status: Clean

Thorsten Kampe wrote:
> Hi,
> 
> I'm starting all my zsh scripts with...
> 
> #! /bin/zsh -f
> emulate -R zsh
> 
> ...in order to minimize any problems that might occur because other 
> systems have other zsh options set.
> 
> My question is: does it make sense to do it that way?
> 
> I'm especially uncertain about the "emulate -R zsh" and the -R 
> parameter because I don't fully understand what it does. Would 
> "emulate zsh" or "emulate -L zsh" or "emulate -RL zsh" be even better?

The -L flag is only useful in functions; in a script you're starting
a fresh shell so making the changes local to it isn't meaningful.

The -R flag forces it to set options that affect interactive usage but
not usually the syntax.  Typically you don't need to set these in
functions, though there are special cases where you do.  Since, again,
you're starting from scratch, adding -R will simply ensure that all the
options are in their default state for zsh.

So "emulate -R zsh" should work fine.  If /etc/zshenv isn't doing
anything nasty, however, it shouldn't be needed together with the -f
flag.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

