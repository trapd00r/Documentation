From zsh-workers-return-22157-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 12 09:23:37 2006
Return-Path: <zsh-workers-return-22157-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3547 invoked from network); 12 Jan 2006 09:23:35 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Jan 2006 09:23:35 -0000
Received: (qmail 75693 invoked from network); 12 Jan 2006 09:23:29 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Jan 2006 09:23:29 -0000
Received: (qmail 9171 invoked by alias); 12 Jan 2006 09:23:26 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22157
Received: (qmail 9159 invoked from network); 12 Jan 2006 09:23:25 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 12 Jan 2006 09:23:25 -0000
Received: (qmail 75407 invoked from network); 12 Jan 2006 09:23:25 -0000
Received: from cluster-c.mailcontrol.com (HELO rly05c.srv.mailcontrol.com) (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 12 Jan 2006 09:23:24 -0000
Received: from exchange03.csr.com (uuk202166.uk.customer.alter.net [62.189.241.194] (may be forged))
	by rly05c.srv.mailcontrol.com (MailControl) with ESMTP id k0C9NKIZ003953
	for <zsh-workers@sunsite.dk>; Thu, 12 Jan 2006 09:23:21 GMT
Received: from csr.com ([10.103.143.38]) by exchange03.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Thu, 12 Jan 2006 09:23:20 +0000
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: Another idea on how to insert illegal multibyte characters 
In-reply-to: <20060112034200.GB28221@dot.blorf.net> 
References: <20060112034200.GB28221@dot.blorf.net>
Date: Thu, 12 Jan 2006 09:23:19 +0000
From: Peter Stephenson <pws@csr.com>
Message-ID: <EXCHANGE03YFhwWJr5700002900@exchange03.csr.com>
X-OriginalArrivalTime: 12 Jan 2006 09:23:20.0043 (UTC) FILETIME=[D3D9C3B0:01C61759]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-05-40-01 (www.mailcontrol.com) on 10.67.0.115

Wayne Davison wrote:
> Here's another idea on how filenames with illegal byte sequences could
> be inserted in the command line:  insert a $'\321' string for each one.

That ought to work quite well, although to do it completely consistently
you'd have to worry about quoting, which is difficult at that point
inside zle.  Filenames aren't usually quoted, except using backslashes,
so this will work most of the time, but every now and then it won't.
I certainly think it's good enough for now.

The completion system is a bit more quoting aware: it knows whether or
not it needs to insert a backslash before special characters because of
quotes earlier on the line.  Ideally it should handle unprintable
characters at the same point where it tries to do that.  That doesn't
need to be done at the same time, though.  (I would hope it could be
done independently and prevent the equivalent code inside zle kicking
in.)

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


Your mail client is unable to display the latest news from CSR. To access our news copy this link into a web browser:  http://www.csr.com/email_sig.html

