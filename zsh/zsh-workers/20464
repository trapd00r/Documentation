From zsh-workers-return-20464-mason-zsh=primenet.com.au@sunsite.dk Thu Oct 07 09:37:56 2004
Return-Path: <zsh-workers-return-20464-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23870 invoked from network); 7 Oct 2004 09:37:55 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Oct 2004 09:37:55 -0000
Received: (qmail 15011 invoked from network); 7 Oct 2004 09:37:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Oct 2004 09:37:49 -0000
Received: (qmail 3270 invoked by alias); 7 Oct 2004 09:37:34 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20464
Received: (qmail 3253 invoked from network); 7 Oct 2004 09:37:33 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Oct 2004 09:37:33 -0000
Received: (qmail 14713 invoked from network); 7 Oct 2004 09:37:33 -0000
Received: from lhuumrelay3.lnd.ops.eu.uu.net (62.189.58.19)
  by a.mx.sunsite.dk with SMTP; 7 Oct 2004 09:37:31 -0000
Received: from MAILSWEEPER01.csr.com (mailhost1.csr.com [62.189.183.235])
	by lhuumrelay3.lnd.ops.eu.uu.net (8.11.0/8.11.0) with ESMTP id i979bVv08450
	for <zsh-workers@sunsite.dk>; Thu, 7 Oct 2004 09:37:31 GMT
Received: from EXCHANGE02.csr.com (unverified [192.168.137.45]) by MAILSWEEPER01.csr.com
 (Content Technologies SMTPRS 4.3.12) with ESMTP id <T6c7f5ed927c0a88d0199c@MAILSWEEPER01.csr.com> for <zsh-workers@sunsite.dk>;
 Thu, 7 Oct 2004 10:36:30 +0100
Received: from news01.csr.com ([192.168.143.38]) by EXCHANGE02.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Thu, 7 Oct 2004 10:39:43 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.12.11/8.12.11) with ESMTP id i979bRwK027281
	for <zsh-workers@sunsite.dk>; Thu, 7 Oct 2004 10:37:27 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.12.11/8.12.11/Submit) with ESMTP id i979bRaK027278
	for <zsh-workers@sunsite.dk>; Thu, 7 Oct 2004 10:37:27 +0100
Message-Id: <200410070937.i979bRaK027278@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: bug with for and time 
In-reply-to: <20041006175328.GB87634@dan.emsphone.com> 
References: <41616CDC.8020701@codesourcery.com> <200410041610.i94GAl92005952@news01.csr.com> <20041005113848.6f3715bd@buddha.localdomain.de> <20041005181820.GC30419@dan.emsphone.com> <20041006134818.089f5218@buddha.localdomain.de> <200410061706.i96H6LTO010315@news01.csr.com> <20041006175328.GB87634@dan.emsphone.com>
Date: Thu, 07 Oct 2004 10:37:26 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 07 Oct 2004 09:39:43.0981 (UTC) FILETIME=[937A49D0:01C4AC51]
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

Dan Nelson wrote:
> In the last episode (Oct 06), Peter Stephenson said:
> > This has never been great.  There appear to be two problems.
> 
> Actually it _was_ great back in zsh 2.5, which did use getrusage().  It
> was dropped in zsh 3.0 for some reason.  My TIMEFMT is still set to
> "U:%U S:%S E:%E CPU:%P Faults:%F Swaps:%W" as a reminder to put it back
> in (not a very effective reminder I guess).

I can vaguely remember that the getrusage() fields which didn't
correspond to times were dropped when we switched to autoconf, simply
because it became hard to test for all the fields.  I didn't notice
getrusage() disappearing entirely then, but it certainly must have at
some point.

I suppose this will give us a base for putting them back, with suitable
configuration tests.  Here's what we're aiming at (from 2.5.03):

TIMEFMT
       The format of process time reports with the time keyword.
       The default is "%E real  %U  user   %S  system   %P  %J".
       Recognizes the following escape sequences:

        %U     CPU seconds spent in user mode.
        %S     CPU seconds spent in kernel mode.
        %E     Elapsed time in seconds.
        %P     The CPU percentage, computed as (%U+%S)/%E.
        %W     Number of times the process was swapped.
        %X     The average amount in (shared) text space used in
               Kbytes.
        %D     The average amount in (unshared) data/stack space
               used in Kbytes.
        %K     The total space used (%X+%D) in Kbytes.
        %M     The  maximum memory the process had in use at any
               time in Kbytes.
        %F     The number of major page faults (page  needed  to
               be brought from disk).
        %R     The number of minor page faults.
        %I     The number of input operations.
        %O     The number of output operations.
        %r     The number of socket messages received.
        %s     The number of socket messages sent.
        %k     The number of signals received.
        %w     Number of voluntary context switches (waits).
        %c     Number of involuntary context switches.
        %J     The name of this job.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 692070


**********************************************************************
This email and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this email in error please notify
the system manager.

This footnote also confirms that this email message has been swept by
MIMEsweeper for the presence of computer viruses.

www.mimesweeper.com
**********************************************************************

