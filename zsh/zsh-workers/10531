From zsh-workers-return-10531-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Apr 06 08:27:10 2000
Return-Path: <zsh-workers-return-10531-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7905 invoked from network); 6 Apr 2000 08:27:08 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Apr 2000 08:27:08 -0000
Received: (qmail 19266 invoked by alias); 6 Apr 2000 08:26:41 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10531
Received: (qmail 19259 invoked from network); 6 Apr 2000 08:26:40 -0000
Date: Thu, 6 Apr 2000 10:26:33 +0200 (MET DST)
Message-Id: <200004060826.KAA06418@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Wed, 05 Apr 2000 20:21:08 +0100
Subject: Re: Still problems with scriptname (presumably)


Peter Stephenson wrote:

> Sven Wischnowsky wrote:
> > You'll have noticed that my patch (still not committed) doesn't change 
> > $0, it just keeps that from being used as the `name' for printing
> > errors and warnings.
> > 
> > So... ;-)
> > 
> > (I'd be in favour of using the patch, the current behaviour looks so weird.)
> 
> Aha.  Confusion is a wonderful thing.  Yes, as far as internal management
> of names goes that would be fine.  It's explicitly separate from argzero
> anyway, because of the [no]functionargzero bodge, and I've taken to using
> `print -P %N' to get function names in messages, so your patch would seem
> to be a sensible way forward.

Well then...

Bye
 Sven

Index: Src/init.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/init.c,v
retrieving revision 1.1.1.51
diff -u -r1.1.1.51 init.c
--- Src/init.c	2000/03/23 04:22:57	1.1.1.51
+++ Src/init.c	2000/04/06 08:26:07
@@ -222,6 +222,7 @@
 		cmd = *argv;
 		opts[INTERACTIVE] &= 1;
 		opts[SHINSTDIN] = 0;
+		scriptname = ztrdup("zsh");
 	    } else if (**argv == 'o') {
 		if (!*++*argv)
 		    argv++;

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

