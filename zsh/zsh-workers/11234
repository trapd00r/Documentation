From zsh-workers-return-11234-mason-zsh=primenet.com.au@sunsite.auc.dk Sat May 06 17:34:59 2000
Return-Path: <zsh-workers-return-11234-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19443 invoked from network); 6 May 2000 17:34:58 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 May 2000 17:34:58 -0000
Received: (qmail 8219 invoked by alias); 6 May 2000 17:34:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11234
Received: (qmail 8189 invoked from network); 6 May 2000 17:34:49 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000506173443.ZM6244@candle.brasslantern.com>
Date: Sat, 6 May 2000 17:34:42 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: History still coredumping after "print -s" during completion
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

This is with Wayne's 11171.  Is this just part of "the lines are not
immediately available yet" or is it a different bug?

Change the "print -zR" in _complete_debug to "print -sR".  Then:

zagzig<2> ls <C-x?><C-n>
Trace output left in /tmp/zsh6093ls2
Completing file
stamp-h.in      Etc/            Test/           config.status*  Src/          
xtrace.err      Completion/     config.cache    Makefile                      
BUILD           Functions/      config.h        stamp-h                       
xtrace.tmp/     Config/         config.log      Doc/                          
zsh: Segmentation fault (core dumped)

(gdb) where
#0  0x80a02c2 in metadiffer (s=0x0, r=0x811aea0 "ls ", len=3)
    at ../../zsh-3.1.6/Src/utils.c:2552
#1  0x80d9741 in zle_goto_hist (ev=2, n=1, skipdups=1)
    at ../../../zsh-3.1.6/Src/Zle/zle_hist.c:492
#2  0x80d8e75 in downhistory (args=0x8100f24)
    at ../../../zsh-3.1.6/Src/Zle/zle_hist.c:266
#3  0x80d8ce9 in downlineorhistory (args=0x8100f24)
    at ../../../zsh-3.1.6/Src/Zle/zle_hist.c:210
#4  0x80decf4 in execzlefunc (func=0x80fed90, args=0x8100f24)
    at ../../../zsh-3.1.6/Src/Zle/zle_main.c:647
#5  0x80de8bd in zleread (lp=0x811ae80 "%m%(#.#.%1v)%h%(#.#.%2v) ", rp=0x0, 
    flags=3) at ../../../zsh-3.1.6/Src/Zle/zle_main.c:564
#6  0x806d03e in inputline () at ../../zsh-3.1.6/Src/input.c:265
#7  0x806cf31 in ingetc () at ../../zsh-3.1.6/Src/input.c:210
#8  0x80663e8 in ihgetc () at ../../zsh-3.1.6/Src/hist.c:242
#9  0x8071e04 in gettok () at ../../zsh-3.1.6/Src/lex.c:621
#10 0x80715a5 in yylex () at ../../zsh-3.1.6/Src/lex.c:337
#11 0x8084cb4 in parse_event () at ../../zsh-3.1.6/Src/parse.c:421
#12 0x806a71f in loop (toplevel=1, justonce=0)
    at ../../zsh-3.1.6/Src/init.c:121
#13 0x804a660 in main (argc=1, argv=0xbffff6a0)
    at ../../zsh-3.1.6/Src/main.c:86

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

