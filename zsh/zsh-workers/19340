From zsh-workers-return-19340-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 06 15:48:28 2004
Return-Path: <zsh-workers-return-19340-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10903 invoked from network); 6 Jan 2004 15:48:27 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 Jan 2004 15:48:27 -0000
Received: (qmail 7342 invoked by alias); 6 Jan 2004 15:48:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19340
Received: (qmail 24957 invoked from network); 6 Jan 2004 15:46:38 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 6 Jan 2004 15:46:38 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [141.211.50.48] by sunsite.dk (MessageWall 1.0.8) with SMTP; 6 Jan 2004 15:46:38 -0000
Received: from login1.sph.umich.edu (login1.sph.umich.edu [141.211.50.49])
	by sph.umich.edu (8.12.9/8.12.6) with ESMTP id i06Fk9BV000399
	for <zsh-workers@sunsite.dk>; Tue, 6 Jan 2004 10:46:09 -0500 (EST)
Received: from localhost (scs@localhost)
	by login1.sph.umich.edu (8.12.9/8.12.6) with ESMTP id i06FkWJV021974
	for <zsh-workers@sunsite.dk>; Tue, 6 Jan 2004 10:46:33 -0500 (EST)
X-Authentication-Warning: login1.sph.umich.edu: scs owned process doing -bs
Date: Tue, 6 Jan 2004 10:46:32 -0500 (EDT)
From: Steve Simmons <scs@umich.edu>
X-X-Sender: scs@login1.sph.umich.edu
To: zsh-workers@sunsite.dk
Subject: zsh not running .zshrc when 'script' command used?
Message-ID: <Pine.GSO.4.40.0401061034550.20638-100000@login1.sph.umich.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I'm having an odd problem with zsh when using the UNIX script command.
For those who've not used it before, script takes some ptys and starts
a new shell running.  stdin and stdout appear to be just what they
were before the script command was invoked, but all your stdin/out/err
traffic is logged to a file.  When you exit the shell, you're returned
to your previous shell and all your activity is logged to a file
named 'typescript.'

I've noticed two odd things with zsh when using script.  First, the
.zshrc file is not read when the shell starts.  Putting echo commands
in my .zshrc confirms this.  Other symptoms include SHLVL not being
updated - my PS1 setting is done by a
    export PS1="%S: ${LOGNAME}@${HOSTNAME} {$SHLVL/%!}:;%s "
and it displays the same SHLVL even though $SHLVL is 2 in the
script subshell.  Yes, I know how to work around this and have done
so.  I'd prefer, tho, not to work around it for every setting in .zshrc
that isn't inherited by subshells.

Second, if I try to get a kerberos ticket (v4), I get:

    $ klog
    Unable to login because can't read password from terminal.

I'm not sure this is the same issue or not.

This occurs with 4.0.6 on freebsd, 4.1.1 on solaris 2.7, and 3.0.6 on
solaris 8.

Feel free to ask for clarifying symptoms, testing, etc.

Thanks,

Steve Simmons

