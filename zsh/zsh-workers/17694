From zsh-workers-return-17694-mason-zsh=primenet.com.au@sunsite.dk Thu Sep 19 09:53:51 2002
Return-Path: <zsh-workers-return-17694-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21097 invoked from network); 19 Sep 2002 09:53:50 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 19 Sep 2002 09:53:50 -0000
Received: (qmail 3358 invoked by alias); 19 Sep 2002 09:53:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17694
Received: (qmail 3342 invoked from network); 19 Sep 2002 09:53:38 -0000
From: "David Gómez" <david@pleyades.net>
Date: Thu, 19 Sep 2002 11:52:49 +0200
To: zsh-workers@sunsite.dk
Subject: Using zsh in gcc compilation
Message-ID: <20020919095249.GA16831@fargo>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
User-Agent: Mutt/1.3.28i

Hi all,

I cannot get to compile successfully gcc 3.2 using zsh as my main shell. I'm
sure the problem is caused by zsh becaused i tried to compile with bash and the
problem goes away.

I hope maybe some of you could give some hints about what is causing this
problem. This is the situation:

/bin/sh is pointing to the zsh binary

zsh options that are activated:

nohistbeep
histexpiredupsfirst
nomultios
rmstarsilent
shinstdin
shwordsplit

These are the last lines of the compilation, when a parse error is given when
the libgcc_s_on is going to be linked:

{ nm -pg  libgcc/on/_muldi3.o libgcc/on/_negdi2.o libgcc/on/_lshrdi3.o libgcc/on
/_ashldi3.o libgcc/on/_ashrdi3.o libgcc/on/_ffsdi2.o libgcc/on/_clz.o libgcc/on/
_cmpdi2.o libgcc/on/_ucmpdi2.o libgcc/on/_floatdidf.o libgcc/on/_floatdisf.o lib
gcc/on/_fixunsdfsi.o libgcc/on/_fixunssfsi.o libgcc/on/_fixunsdfdi.o libgcc/on/_
fixdfdi.o libgcc/on/_fixunssfdi.o libgcc/on/_fixsfdi.o libgcc/on/_fixxfdi.o libg
cc/on/_fixunsxfdi.o libgcc/on/_floatdixf.o libgcc/on/_fixunsxfsi.o libgcc/on/_fi
xtfdi.o libgcc/on/_fixunstfdi.o libgcc/on/_floatditf.o libgcc/on/_clear_cache.o 
libgcc/on/_trampoline.o libgcc/on/__main.o libgcc/on/_exit.o libgcc/on/_absvsi2.
o libgcc/on/_absvdi2.o libgcc/on/_addvsi3.o libgcc/on/_addvdi3.o libgcc/on/_subv
si3.o libgcc/on/_subvdi3.o libgcc/on/_mulvsi3.o libgcc/on/_mulvdi3.o libgcc/on/_
negvsi2.o libgcc/on/_negvdi2.o libgcc/on/_ctors.o libgcc/on/_divdi3.o libgcc/on/
_moddi3.o libgcc/on/_udivdi3.o libgcc/on/_umoddi3.o libgcc/on/_udiv_w_sdiv.o lib
gcc/on/_udivmoddi4.o  libgcc/on/unwind-dw2.o libgcc/on/unwind-dw2-fde-glibc.o li
bgcc/on/unwind-sjlj.o; echo %%; \
  cat ../../gcc-3.2/gcc/libgcc-std.ver ../../g
cc-3.2/gcc/config/libgcc-glibc.ver | sed -e "/^[ 	]*#/d" -e 's/^%\(if\|else\|eli
f\|endif\|define\)/#\1/' \
  | ./xgcc -B./ -B/usr/i686-pc-linux-gnu/bin/ -isyste
m /usr/i686-pc-linux-gnu/include -isystem /usr/i686-pc-linux-gnu/sys-include -O2
  -DIN_GCC    -W -Wall -Wwrite-strings -Wstrict-prototypes -Wmissing-prototypes 
-isystem ./include  -fPIC -g -DHAVE_GTHR_DEFAULT -DIN_LIBGCC2 -D__GCC_FLOAT_NOT_
NEEDED  -I. -I. -I../../gcc-3.2/gcc -I../../gcc-3.2/gcc/. -I../../gcc-3.2/gcc/co
nfig -I../../gcc-3.2/gcc/../include  -on -E -xassembler-with-cpp -; \
} | gawk -
f ../../gcc-3.2/gcc/mkmap-symver.awk  > libgcc/on/tmp-libgcc.map
mv libgcc/on/tm
p-libgcc.map libgcc/on/libgcc.map
./xgcc -B./ -B/usr/i686-pc-linux-gnu/bin/ -isy
stem /usr/i686-pc-linux-gnu/include -isystem /usr/i686-pc-linux-gnu/sys-include 
-O2  -DIN_GCC    -W -Wall -Wwrite-strings -Wstrict-prototypes -Wmissing-prototyp
es -isystem ./include  -fPIC -g -DHAVE_GTHR_DEFAULT -DIN_LIBGCC2 -D__GCC_FLOAT_N
OT_NEEDED  -shared -nodefaultlibs -Wl,--soname=libgcc_s_on.so.1 -Wl,--version-sc
ript=libgcc/on/libgcc.map -o libgcc_s_on.so.1  -on  libgcc/on/_muldi3.o libgcc/o
n/_negdi2.o libgcc/on/_lshrdi3.o libgcc/on/_ashldi3.o libgcc/on/_ashrdi3.o libgc
c/on/_ffsdi2.o libgcc/on/_clz.o libgcc/on/_cmpdi2.o libgcc/on/_ucmpdi2.o libgcc/
on/_floatdidf.o libgcc/on/_floatdisf.o libgcc/on/_fixunsdfsi.o libgcc/on/_fixuns
sfsi.o libgcc/on/_fixunsdfdi.o libgcc/on/_fixdfdi.o libgcc/on/_fixunssfdi.o libg
cc/on/_fixsfdi.o libgcc/on/_fixxfdi.o libgcc/on/_fixunsxfdi.o libgcc/on/_floatdi
xf.o libgcc/on/_fixunsxfsi.o libgcc/on/_fixtfdi.o libgcc/on/_fixunstfdi.o libgcc
/on/_floatditf.o libgcc/on/_clear_cache.o libgcc/on/_trampoline.o libgcc/on/__ma
in.o libgcc/on/_exit.o libgcc/on/_absvsi2.o libgcc/on/_absvdi2.o libgcc/on/_addv
si3.o libgcc/on/_addvdi3.o libgcc/on/_subvsi3.o libgcc/on/_subvdi3.o libgcc/on/_
mulvsi3.o libgcc/on/_mulvdi3.o libgcc/on/_negvsi2.o libgcc/on/_negvdi2.o libgcc/
on/_ctors.o libgcc/on/_divdi3.o libgcc/on/_moddi3.o libgcc/on/_udivdi3.o libgcc/
on/_umoddi3.o libgcc/on/_udiv_w_sdiv.o libgcc/on/_udivmoddi4.o  libgcc/on/unwind
-dw2.o libgcc/on/unwind-dw2-fde-glibc.o libgcc/on/unwind-sjlj.o -lc && rm -f lib
gcc_s_on.so && ln -s libgcc_s_on.so.1 libgcc_s_on.so
/usr/bin/ld:libgcc/on/libgc c.map:1: parse error in VERSION script
collect2: ld returned 1 exit status
make[3]: *** [on/libgcc_s_on.so] Error 1
make[3]: Leaving directory `/home/huma/src/gccobj/gcc'
make[2]: *** [libgcc.a] Error 2
make[2]: Leaving directory `/home/huma/src/gccobj/gcc'
make[1]: *** [stage1_build] Error 2
make[1]: Leaving directory


This error seems to happens because an additional '-on' is added to the xgcc
line and the output doesn't go to standard output, so we have an empty
libgcc.map, but i have no idea which zsh feature could be causing this.

Thanks,

-- 
David Gómez

"The question of whether computers can think is just like the question of
 whether submarines can swim." -- Edsger W. Dijkstra

