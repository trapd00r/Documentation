From zsh-workers-return-19424-mason-zsh=primenet.com.au@sunsite.dk Mon Feb 16 10:22:20 2004
Return-Path: <zsh-workers-return-19424-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29119 invoked from network); 16 Feb 2004 10:22:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 16 Feb 2004 10:22:19 -0000
Received: (qmail 9983 invoked by alias); 16 Feb 2004 10:22:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19424
Received: (qmail 9959 invoked from network); 16 Feb 2004 10:22:11 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 16 Feb 2004 10:22:11 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [165.165.163.9] by sunsite.dk (MessageWall 1.0.8) with SMTP; 16 Feb 2004 10:22:9 -0000
Received: from [192.168.1.174] (appleseed.ractech.co.za [192.168.1.174])
	by r2d2.ractech.co.za (8.11.6/8.11.6) with ESMTP id i1GAM1b88724;
	Mon, 16 Feb 2004 12:22:01 +0200 (SAST)
	(envelope-from marius@e.co.za)
In-Reply-To: <22466.1076849305@athlon>
References: <C1A391A0-5DF8-11D8-AEA2-000A958FBAFE@e.co.za> <22466.1076849305@athlon>
Mime-Version: 1.0 (Apple Message framework v612)
Content-Type: text/plain; charset=US-ASCII; format=flowed
Message-Id: <D0EC3F5A-6069-11D8-AF48-000A958FBAFE@e.co.za>
Content-Transfer-Encoding: 7bit
Cc: zsh-workers@sunsite.dk
From: Marius van Wyk <marius@e.co.za>
Subject: Re: ZSH 4.1.1 Coredump bug 
Date: Mon, 16 Feb 2004 12:21:00 +0200
To: Oliver Kiddle <okiddle@yahoo.co.uk>
X-Mailer: Apple Mail (2.612)


On 15 Feb 2004, at 14:48, Oliver Kiddle wrote:

> Marius van Wyk wrote:
>> [marius@boa-constructor /home/marius]$ zsh -f
>> boa-constructor% compctl -f -x 'p[2]' -s "`/bin/ls /bin`" --open
>> Segmentation fault (core dumped)
>
> This should fix it.

I updated the file, then did a 'make clean; make'
Then I ran zsh again, and entered:

~> compctl -f -x 'p[2]' -s "`/bin/ls /bin`" --open

Same thing. SIGSEGV.
Strange.

Me.

>
> Index: Src/Zle/compctl.c
> ===================================================================
> RCS file: /cvsroot/zsh/zsh/Src/Zle/compctl.c,v
> retrieving revision 1.16
> diff -u -r1.16 compctl.c
> --- Src/Zle/compctl.c	13 Nov 2003 14:34:38 -0000	1.16
> +++ Src/Zle/compctl.c	15 Feb 2004 12:29:35 -0000
> @@ -857,7 +857,7 @@
>  		}
>  		break;
>  	    default:
> -		if (!first && (**argv == '-' || **argv == '+'))
> +		if (!first && (**argv == '-' || **argv == '+') && !argv[0][1])
>  		    (*argv)--, argv--, ready = 1;
>  		else {
>  		    zwarnnam(name, "bad option: -%c", NULL, **argv);
>
-- 
Director,
Tangible Business Software

