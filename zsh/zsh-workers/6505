From zsh-workers-return-6505-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 07 13:15:42 1999
Return-Path: <zsh-workers-return-6505-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14941 invoked from network); 7 Jun 1999 13:15:41 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Jun 1999 13:15:41 -0000
Received: (qmail 27971 invoked by alias); 7 Jun 1999 13:15:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6505
Received: (qmail 27964 invoked from network); 7 Jun 1999 13:15:19 -0000
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: "Peter Stephenson" <pws@ibmth.df.unipi.it>,
        "Zsh hackers list" <zsh-workers@sunsite.auc.dk>
Subject: RE: Function installation 
Date: Mon, 7 Jun 1999 17:14:36 +0400
Message-ID: <000f01beb0e7$b0ac04f0$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2314.1300
In-Reply-To: <9906071222.AA30021@ibmth.df.unipi.it>
Importance: Normal

>
> The stuff only gets put into fpath when you run compinit because it knows
> the path to compinit, which it wouldn't if it were a function; you'd have
> to give it the -f option.  So the nettle of deciding where the things are
> has to be grasped anyway.  But this is all supposed to be handled
> seamlessly by running compinstall.  At least with the function
> installation
> stuff, you get a sensible default $fpath, which compinstall will check.
>

Is it different attitude, or something I'm hopelessly missing?

I have a feeling, that new completion is still being considered as
experimental by most of zsh-workers. I see it as inherent part of future
zsh. And that is exactly what I want to avoid - running compinstall for
every new user.

What is the point of it anyway? The functions are already there in
system-wide location. Zsh already knows where they are. The path is already
in fpath. Why would I need to run yet another intialisation function?

About the "nettle of deciding" - Zsh *does* know where they are (from
configure). I don't insist on function or builtin - but let's give users a
parameter COMPINIT that holds full pathname of compinit. That would provide
for quite portable rc

[[ -n "$COMPINIT" ]] && $COMPINIT ...

that will automatically cover installation without new completion as well.


> One thing's been niggling at me:  if there's a central function
> repository,
> and the user has their own functions, then compinit.dump has to
> be somewhere
> else, probably not in the same directory as compinit.  It looks like
> compinit will need to be a bit smarter about working this out.
>

As Sven suggested, put it in $HOME by default. But there is more intricate
problem - what, if I'd like to override default functions? Is it enough to
put user-defined directory before system-wide in fpath?

/andrej

