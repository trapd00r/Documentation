From zsh-users-return-14125-mason-zsh=primenet.com.au@sunsite.dk Sun May 17 04:44:18 2009
Return-Path: <zsh-users-return-14125-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22968 invoked from network); 17 May 2009 04:44:05 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 May 2009 04:44:05 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 38544 invoked from network); 17 May 2009 04:43:47 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 May 2009 04:43:47 -0000
Received: (qmail 4319 invoked by alias); 17 May 2009 04:43:30 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14125
Received: (qmail 4304 invoked from network); 17 May 2009 04:43:29 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 17 May 2009 04:43:29 -0000
Received: from atom.smasher.org (atom.smasher.org [69.55.237.145])
	by bifrost.dotsrc.org (Postfix) with SMTP id 1CA4780271EA
	for <zsh-users@sunsite.dk>; Sun, 17 May 2009 06:43:25 +0200 (CEST)
Received: (qmail 15334 invoked by uid 1000); 17 May 2009 04:43:23 -0000
Message-ID: <20090517044323.15333.qmail@smasher.org>
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
Date: Sun, 17 May 2009 16:43:23 +1200 (NZST)
From: Atom Smasher <atom@smasher.org>
MIME-Version: 1.0
OpenPGP: id=0xB88D52E4D9F57808; algo=1 (RSA); size=4096; url=http://atom.smasher.org/pgp.txt
Subject: runaway zselect
To: zsh-users@sunsite.dk
X-POM: The Moon is Waning Gibbous (52% of Full)
X-Hashcash: 1:20:0905170443:zsh-users@sunsite.dk::9AezXgWcx60WuuAg:0000000000000
	0000000000000000000000001PUZ
X-Virus-Scanned: ClamAV 0.94.2/9365/Sat May 16 14:41:29 2009 on bifrost
X-Virus-Status: Clean

i would expect zselect to return an error and stop the while loop when "w" 
stops producing output. instead i'm seeing an infinite loop of blank 
lines, after "w" finishes:

while zselect -r 0
do
   read -r foo
   print -r -- $foo
done < <( w )

same thing reading from a coproc with "done <& p"

the weird thing is that i have it working as desired (reading from a 
coproc) in a script, but i can't reproduce it outside of the script... the 
weirder thing is that i can get this working when i test it:
 	sysread -i 0 -o 1 -t 200 <& p
  but in the script mentioned above, it fails:
 	coprocess: bad file descriptor

any ideas? thanks...


-- 
         ...atom

  ________________________
  http://atom.smasher.org/
  762A 3B98 A3C3 96C9 C6B7 582A B88D 52E4 D9F5 7808
  -------------------------------------------------

 	"People have so manipulated the concept of freedom that it
 	 finally boils down to the right of the stronger and richer to
 	 take from the weaker and poorer whatever they still have."
 		-- Theodor Adorno

