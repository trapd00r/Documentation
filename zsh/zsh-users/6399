From zsh-users-return-6399-mason-zsh=primenet.com.au@sunsite.dk Mon Jul 14 19:53:32 2003
Return-Path: <zsh-users-return-6399-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12773 invoked from network); 14 Jul 2003 19:53:31 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 14 Jul 2003 19:53:31 -0000
Received: (qmail 9680 invoked by alias); 14 Jul 2003 19:51:04 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6399
Received: (qmail 9661 invoked from network); 14 Jul 2003 19:51:04 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 14 Jul 2003 19:51:04 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [68.55.195.109] by sunsite.dk (MessageWall 1.0.8) with SMTP; 14 Jul 2003 19:51:3 -0000
Received: by mithrandir.aperiodic.net (Postfix, from userid 1000)
	id 11C30C084E; Mon, 14 Jul 2003 15:51:02 -0400 (EDT)
Date: Mon, 14 Jul 2003 15:51:02 -0400
From: Phil!Gregory <phil_g@pobox.com>
To: zsh-users@sunsite.dk
Subject: Re: $? being clobbered?
Message-ID: <20030714195102.GA9287@mithrandir.aperiodic.net>
Mail-Followup-To: zsh-users@sunsite.dk
References: <20030714173555.GA4352@mithrandir.aperiodic.net> <1030714192541.ZM6620@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <1030714192541.ZM6620@candle.brasslantern.com>
X-Uptime-Bragging: aragorn: 3 days, 13:00:29.53
X-message-flag: You're using Outlook?  I highly recommend changing mail programs.
User-Agent: Mutt/1.5.4i

* Bart Schaefer <schaefer@brasslantern.com> [2003-07-14 19:25 +0000]:
> There's code in the precmd handler to preserve and restore $? but nothing
> similar is done during prompt expansion.

I think my best approach is to move all program execution to precmd.

> Is there some reason to execute the command every time the prompt is
> printed?  That is, does the command change from one prompt to the next?

Yes, because it's actually $(echoti cub $COLUMNS) and I wish it to
work even when the terminal is resized.

> I feel compelled to remark that moving 80 columns left seems an odd way of
> achieving 'setopt promptcr'.

...which is even on by default.  The existing stuff is left over from my
old bash prompt; didn't realize zsh did it for me.  (Actually, the full
code did a clear-to-end-of-display, too, which zsh also appears to do by
default.)

I still have an invocation of apm while I'll have to move.

-- 
...computer contrarian of the first order... / http://aperiodic.net/phil/
PGP: 026A27F2  print: D200 5BDB FC4B B24A 9248  9F7A 4322 2D22 026A 27F2
--- --
Too many people are thinking of security instead of opportunity.  They
seem more afraid of life than death.
                       -- James F. Byrnes
---- --- --

