From zsh-users-return-8746-mason-zsh=primenet.com.au@sunsite.dk Sat Apr 23 23:47:06 2005
Return-Path: <zsh-users-return-8746-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23927 invoked from network); 23 Apr 2005 23:47:05 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Apr 2005 23:47:05 -0000
Received: (qmail 22100 invoked from network); 23 Apr 2005 23:46:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Apr 2005 23:46:59 -0000
Received: (qmail 9355 invoked by alias); 23 Apr 2005 23:46:51 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8746
Received: (qmail 9343 invoked from network); 23 Apr 2005 23:46:50 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 23 Apr 2005 23:46:50 -0000
Received: (qmail 21131 invoked from network); 23 Apr 2005 23:46:50 -0000
Received: from zproxy.gmail.com (64.233.162.198)
  by a.mx.sunsite.dk with SMTP; 23 Apr 2005 23:46:46 -0000
Received: by zproxy.gmail.com with SMTP id 13so863974nzp
        for <zsh-users@sunsite.dk>; Sat, 23 Apr 2005 16:46:45 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:reply-to:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=cOBh88WSx/jXrugxz5sfk7X5FXUHw8KrJfiFJlrtvarNh5kPU8wsXbRrVHjkluolW7RtA1GlVUyu1XBJ809yUOOayX1lcAHbAEY6obUqO6Ao6JYlG4pVQgU1RWbyZRdsjtRV3uW9Joeh8xHSWkGQVmJcfC8m6Q3yg7/UXkFS0qQ=
Received: by 10.36.12.2 with SMTP id 2mr393084nzl;
        Sat, 23 Apr 2005 16:46:44 -0700 (PDT)
Received: by 10.36.20.7 with HTTP; Sat, 23 Apr 2005 16:46:44 -0700 (PDT)
Message-ID: <237967ef050423164619588c97@mail.gmail.com>
Date: Sun, 24 Apr 2005 01:46:44 +0200
From: Mikael Magnusson <mikachu@gmail.com>
Reply-To: Mikael Magnusson <mikachu@gmail.com>
To: Andrey Borzenkov <arvidjaar@newmail.ru>
Subject: Re: Speeding up ZSH startup
Cc: zsh-users@sunsite.dk, Meino Christian Cramer <Meino.Cramer@gmx.de>
In-Reply-To: <200504231254.54270.arvidjaar@newmail.ru>
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <20050423.082943.74746308.Meino.Cramer@gmx.de>
	 <200504231254.54270.arvidjaar@newmail.ru>
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=6.0 tests=AWL,BAYES_00,RCVD_BY_IP 
	autolearn=ham version=3.0.2
X-Spam-Hits: -2.3

sorry if gmail messes up the To: and Cc: here...

On 4/23/05, Andrey Borzenkov <arvidjaar@newmail.ru> wrote:
> On Saturday 23 April 2005 10:29, Meino Christian Cramer wrote:
> > Hi,
> >
> >  I am at the very beginning of dvinig deeper into the wonderful world
> >  of ZSH :O)...
> >
> >  I want to speed up the start of zsh on my Linux system.
> >  WIth "zsh -x" I figured out what file are loaded when and I found no
> >  abnormal things (reloading and such...). The different fiel, which
> >  got loaded are of "normal" size (so nothing VERY big...).
> >
> >  Is there any other things or tricks I can try to make starting zsh a
> >  little faster ?
> >
>=20
> If you use "new" completion (compinit) then the slowest part is reading a=
nd
> parsing all completion functions.
>=20
> You can speed it up by precompiling; see zcompile and function autoloadin=
g in
> Zsh manuals.
>=20
> I do something like
>=20
> for i in $fpath; do
>   zcompile $i $i/*(N)
> done

I have this function that i call from time to time manually as root
and my user (the one for my user doesn't have the systemwide files),

src () {
=09autoload -U zrecompile
=09[ -f ~/.zshrc ] && zrecompile -p ~/.zshrc
=09[ -f ~/.zlogout ] && zrecompile -p ~/.zlogout
=09[ -f ~/.zlogin ] && zrecompile -p ~/.zlogin
=09[ -f ~/.zcompdump ] && zrecompile -p ~/.zcompdump
=09[ -f /etc/profile ] && zrecompile -p /etc/profile
=09[ -f /etc/profile.env ] && zrecompile -p /etc/profile.env
=09for a in $fpath
=09do
=09=09[ -d $a ] && zrecompile -p $a.zwc $a/*
=09done
}

> and wrapper function that checks modification time to automatically recom=
pile
> if needed.
>=20
> >  For example: Are there feature known, which are better to be
> >  activated at last/at first...
> >
>=20
> it depends on your rc files actually. Ubuntu ships zero rc files for zsh =
and
> startup is very fast :)
>=20
> -andrey
>=20
>=20
>=20


--=20
Mikael Magnusson

