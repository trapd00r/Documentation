From zsh-workers-request@euclid.skiles.gatech.edu  Wed Nov 13 00:05:55 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id AAA11234 for <mason@primenet.com.au>; Wed, 13 Nov 1996 00:05:50 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id HAA02117; Tue, 12 Nov 1996 07:40:13 -0500 (EST)
Resent-Date: Tue, 12 Nov 1996 07:40:13 -0500 (EST)
Message-Id: <199611121240.NAA28664@hydra.ifh.de>
X-Authentication-Warning: hydra.ifh.de: Host pws@localhost didn't use HELO protocol
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: zle_refresh trial patch (and unrelated bug) 
In-reply-to: ""Bart Schaefer""'s message of "Sat, 09 Nov 1996 09:09:35 MET."
             <961109090936.ZM20100@candle.brasslantern.com> 
Date: Tue, 12 Nov 1996 13:40:10 +0100
From: Peter Stephenson <pws@ifh.de>
Resent-Message-ID: <"kzwGm3.0._W.j07Yo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2376
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

"Bart Schaefer" wrote:
> 	builtin let fun == 0 && eval function "$var"
> 
> Ah, I see -- I did accept-line once before, which changed "(( fun == 0 ))"
> into "builtin let fun == 0", which is not being parsed correctly.

Nor will it ever be --- that's quite a serious bug.  `let' needs to
get each expression as one single argument, so it should be
   builtin let "fun == 0"
and I'm pretty sure it was until not all that long ago.

In fact, Zoltan has improved the lexing of ((...)) so that it's no
longer quite the same as a double quoted expression, so that my
original hack of turning the former into the latter for ease of
reconstructing the text is not quite so appropriate.

> Either the output of "functions" needs to get fixed for this case, or
> (probably better) the parser has to make "==" a reserved word so it is
> not interpeted as "$(which -p '=')".

This won't help here, but maybe == is common enough as a test to have
a special case anyway.

*** Src/subst.c~	Thu Oct 10 12:05:11 1996
--- Src/subst.c	Tue Nov 12 13:31:18 1996
***************
*** 371,377 ****
  	    *namptr = dyncat(hom, ptr);
  	    return 1;
  	}
!     } else if (*str == Equals && isset(EQUALS) && str[1]) {   /* =foo */
  	char sav, *pp, *cnam;
  
  	for (pp = str + 1; !isend2(*pp); pp++);
--- 371,378 ----
  	    *namptr = dyncat(hom, ptr);
  	    return 1;
  	}
!     } else if (*str == Equals && isset(EQUALS) && str[1]
! 	       && str[1] != Equals) {   /* =foo */
  	char sav, *pp, *cnam;
  
  	for (pp = str + 1; !isend2(*pp); pp++);

-- 
Peter Stephenson <pws@ifh.de>       Tel: +49 33762 77366
WWW:  http://www.ifh.de/~pws/       Fax: +49 33762 77413
Deutches Electronen-Synchrotron --- Institut fuer Hochenergiephysik Zeuthen
DESY-IfH, 15735 Zeuthen, Germany.

