From zsh-workers-return-20283-mason-zsh=primenet.com.au@sunsite.dk Tue Aug 24 12:54:55 2004
Return-Path: <zsh-workers-return-20283-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27167 invoked from network); 24 Aug 2004 12:54:54 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 24 Aug 2004 12:54:54 -0000
Received: (qmail 96977 invoked from network); 24 Aug 2004 12:54:48 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 24 Aug 2004 12:54:48 -0000
Received: (qmail 26738 invoked by alias); 24 Aug 2004 12:54:36 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20283
Received: (qmail 26729 invoked from network); 24 Aug 2004 12:54:36 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by 130.225.247.90 with SMTP; 24 Aug 2004 12:54:36 -0000
Received: (qmail 95609 invoked from network); 24 Aug 2004 12:52:37 -0000
Received: from caraldi.com (HELO oxyd.caraldi.com) (195.137.249.52)
  by a.mx.sunsite.dk with SMTP; 24 Aug 2004 12:52:36 -0000
Received: from anyware12.anyware (unknown [84.96.21.10])
	by oxyd.caraldi.com (Postfix) with ESMTP id 0663B206E
	for <zsh-workers@sunsite.dk>; Tue, 24 Aug 2004 14:52:33 +0200 (CEST)
Received: by anyware12.anyware (Postfix, from userid 615)
	id 992C16AC8; Tue, 24 Aug 2004 14:52:27 +0200 (CEST)
Date: Tue, 24 Aug 2004 14:52:27 +0200
From: Jean-Baptiste Quenot <jb.quenot@caraldi.com>
To: zsh-workers@sunsite.dk
Subject: [PATCH] ant completion
Message-ID: <20040824125225.GA1713@anyware12.anyware>
Mail-Followup-To: Jean-Baptiste Quenot <jb.quenot@caraldi.com>,
	zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="dDRMvlgZJXvWKvBx"
Content-Disposition: inline
User-Agent: Mutt/1.5.6i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_40 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0


--dDRMvlgZJXvWKvBx
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

Dear workers,

Please find  attached a  patch for  ant completion.   The current
ant  completion  script  only  works when  the  "name"  attribute
immediately follows the "target" element name.

In  the following  example, zsh  only offers  completion for  the
'othertarget' target:

<target name='othertarget'/>
<target depends='othertarget' name='mytarget'/>

Best regards,
-- 
Jean-Baptiste Quenot
http://caraldi.com/jbq/

--dDRMvlgZJXvWKvBx
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename=zsh-ant-comp-patch

--- _ant.orig	Tue Aug 24 14:40:26 2004
+++ _ant	Tue Aug 24 14:51:38 2004
@@ -86,7 +86,7 @@
 	buildfile=${(v)opt_args[(I)(-f|-file|-buildfile)]:-build.xml}
       fi
       if [[ -f $buildfile ]]; then
-	targets=( $(sed -n 's/ *<target name=["'"'"']\([^"'"'"']*\)["'"'"'].*/\1/p' < $buildfile) )
+	targets=( $(sed -n 's/ *<target[^>]*name=["'"'"']\([^"'"'"']*\)["'"'"'].*/\1/p' < $buildfile) )
 	_wanted targets expl target compadd -a targets && ret=0
       else
 	_message -e targets target

--dDRMvlgZJXvWKvBx--

