From zsh-users-return-11402-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 16 12:57:55 2007
Return-Path: <zsh-users-return-11402-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8917 invoked from network); 16 Apr 2007 12:57:52 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 Apr 2007 12:57:52 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 37397 invoked from network); 16 Apr 2007 12:57:46 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Apr 2007 12:57:46 -0000
Received: (qmail 21816 invoked by alias); 16 Apr 2007 12:57:34 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11402
Received: (qmail 21807 invoked from network); 16 Apr 2007 12:57:33 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 16 Apr 2007 12:57:33 -0000
Received: (qmail 36055 invoked from network); 16 Apr 2007 12:57:33 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 16 Apr 2007 12:57:30 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly27c.srv.mailcontrol.com (MailControl) with ESMTP id l3GCoKxw030234
	for <zsh-users@sunsite.dk>; Mon, 16 Apr 2007 13:57:24 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 16 Apr 2007 13:55:23 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.8/8.13.4) with ESMTP id l3GCtNTS011377
	for <zsh-users@sunsite.dk>; Mon, 16 Apr 2007 13:55:23 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.8/8.13.8/Submit) with ESMTP id l3GCtKF5011374
	for <zsh-users@sunsite.dk>; Mon, 16 Apr 2007 13:55:23 +0100
Message-Id: <200704161255.l3GCtKF5011374@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: pushing a string in the cut&paste stack 
In-reply-to: <9fda5e550704160530p7e478483i4e8021a9e199ce23@mail.gmail.com> 
References: <9fda5e550704160530p7e478483i4e8021a9e199ce23@mail.gmail.com>
Comments: In-reply-to "Giulio Bottazzi" <giulio.bottazzi@gmail.com>
   message dated "Mon, 16 Apr 2007 14:30:14 +0200."
Date: Mon, 16 Apr 2007 13:55:19 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 16 Apr 2007 12:55:23.0574 (UTC) FILETIME=[7F45C560:01C78026]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.67.0.137

"Giulio Bottazzi" wrote:
> I would like to know how can I push a string in the cut&paste stack of
> zle. In practice, I would like to have a shell function, name it
> "copythis", such that
> 
> > copythis "blabla"
> 
> will insert the string "blabla" in the stack, so that can later
> recover it using the ctrl-y/alt-y mechanism (emacs key map).

If you have a recent version of the shell, you can do this:

zle-line-init () {
  if [[ -n $copy_this ]]
  then
    CUTBUFFER=$copy_this
    copy_this=
  fi
}
zle -N zle-line-init
copythis() { copy_this="$*"; }

It's that complicated because CUTBUFFER only exists as a special
parameter once the line editor has started.

If you want to manipulate the editing stack (save the old value of the
the cut buffer onto the kill ring in the way the kill commands do) you
will need to use the array kill_ring.  See the function kill-word-match
distributed with the shell for an example.  (One day I should make it so
that copy-region-as-kill can take a string argument when called from an
editor widget.)

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

To get further information regarding CSR, please visit our Investor Relations page at http://ir.csr.com/csr/about/overview

