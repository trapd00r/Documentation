From zsh-workers-return-9075-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Dec 16 08:35:03 1999
Return-Path: <zsh-workers-return-9075-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3749 invoked from network); 16 Dec 1999 08:35:03 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 16 Dec 1999 08:35:03 -0000
Received: (qmail 9470 invoked by alias); 16 Dec 1999 08:34:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9075
Received: (qmail 9463 invoked from network); 16 Dec 1999 08:34:57 -0000
Date: Thu, 16 Dec 1999 09:34:56 +0100 (MET)
Message-Id: <199912160834.JAA11625@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Wed, 15 Dec 1999 20:31:27 +0000
Subject: Re: PATCH: 3.1.6-pws-11: Completion suggestions + fixes + sorting tags


Peter Stephenson wrote:

> Sven Wischnowsky wrote:
> > > 2. I don't really like the way ZLS_COLORS is sidelined.  There doesn't seem
> > >    to be any point in it if you're using new completion.  Perhaps if it's
> > >    set when completion is initialised it could be set to the default for
> > >    the list-colors style.
> > 
> > Hm, my bad English shows... There doesn't seem to be a point in what?
> 
> Currently (well... a week ago, and a week is a long time in completion), if
> you set ZLS_COLORS and use completion, ZLS_COLORS gets stomped on.  I was
> suggesting that compinit might instead save it as the list-colors default,
> if that's not already set; this can of course be overridden.  (It's nice
> that styles don't care whether or not the module they refer to has been
> initialised, unlike assoc arrays.)

Ah yes. I had thought about that, too. Then I thought that this
wouldn't work if ZLS_COLO(|U)RS get set up after compinit is loaded
and wanted to think some more about this. This then I forgot to do.

Why not...

Bye
 Sven

diff -ru ../z.old/Completion/Core/compinit Completion/Core/compinit
--- ../z.old/Completion/Core/compinit	Thu Dec 16 09:24:05 1999
+++ Completion/Core/compinit	Thu Dec 16 09:32:17 1999
@@ -478,7 +478,7 @@
 zstyle ':completion:correct'  max-errors    '2' numeric
 zstyle ':completion:correct'  prompt        'correct to:'
 zstyle ':completion:*'        completer     '_complete'
-zstyle ':completion*:default' list-colors   no=0 fi=0 di=0 ln=0 pi=0 so=0 bd=0 cd=0 ex=0
+zstyle ':completion*:default' list-colors   "${(s.:.)ZLS_COLORS:-${ZLS_COLOURS:-no=0:fi=0:di=0:ln=0:pi=0:so=0:bd=0:cd=0:ex=0}}"
 zstyle ':completion:*' tag-order 'arguments values' options \
                                  globbed-files directories all-files
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

