From zsh-users-return-13154-mason-zsh=primenet.com.au@sunsite.dk Sat Aug 23 20:50:37 2008
Return-Path: <zsh-users-return-13154-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10593 invoked from network); 23 Aug 2008 20:50:35 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Aug 2008 20:50:35 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 1083 invoked from network); 23 Aug 2008 20:49:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Aug 2008 20:49:59 -0000
Received: (qmail 3903 invoked by alias); 23 Aug 2008 20:49:22 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13154
Received: (qmail 3893 invoked from network); 23 Aug 2008 20:49:21 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 23 Aug 2008 20:49:21 -0000
Received: from ug-out-1314.google.com (ug-out-1314.google.com [66.249.92.174])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 13751801E2B4
	for <zsh-users@sunsite.dk>; Sat, 23 Aug 2008 22:49:17 +0200 (CEST)
Received: by ug-out-1314.google.com with SMTP id 29so350853ugo.18
        for <zsh-users@sunsite.dk>; Sat, 23 Aug 2008 13:49:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:subject:date
         :user-agent:mime-version:content-type:content-transfer-encoding
         :content-disposition:message-id;
        bh=HOb3jv+ZPZZhrZBYKhOE1t3Xt9AdfR/1FghI6lojfW4=;
        b=sgmG4qBxNTM1mFcSUzNDWDXOllQc/N15eJClBRZYb+wDua2QfUxg0dryQpwHPGoxr2
         zDPU5P63oB0ETozMQ0vigqjTBt+t1A3gQvuZHE7Fr76VaDTapjlFjRj2hm57uDDR+K/M
         6c6mlR4zFvgUoLvBTAF9xNpnYeQehORrGGEBw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=from:to:subject:date:user-agent:mime-version:content-type
         :content-transfer-encoding:content-disposition:message-id;
        b=J2hhWx0eihvcNdI4ptvbTGt/gLLEyi9bhpgcpjgfHf4c6PUcRG4zZV+lgQ5wWCpzzM
         BygV4N2z6yB1OAz/MPbZ5J2kmCIyJ4TgWrR12sDVc8e7d2dlOO3O/pRIdfBo9GZnn3XZ
         VMbJPWSOg17dIuQdg/swC9gGCUlYKAnpVeD5I=
Received: by 10.67.115.3 with SMTP id s3mr818698ugm.68.1219524556839;
        Sat, 23 Aug 2008 13:49:16 -0700 (PDT)
Received: from ?192.168.1.2? ( [87.123.250.201])
        by mx.google.com with ESMTPS id k2sm2584196ugf.1.2008.08.23.13.49.15
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 23 Aug 2008 13:49:16 -0700 (PDT)
From: "=?iso-8859-1?q?xRaich=5Bo=5D=B2x?=" <raichoo@googlemail.com>
To: zsh-users@sunsite.dk
Subject: Weird reset-prompt behavior
Date: Sat, 23 Aug 2008 22:49:13 +0200
User-Agent: KMail/1.9.7
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
Message-Id: <200808232249.13582.raichoo@googlemail.com>
X-Virus-Scanned: ClamAV 0.92.1/8079/Sat Aug 23 18:49:14 2008 on bifrost
X-Virus-Status: Clean

Hi,
I'm pretty new to zsh so i don't know if this is already known, but i=20
discovered a pretty weird behavior when resetting the prompt and rprompt

I did something like this:

zle-line-init zle-keymap-select()
{
        RPROMPT=3D${${KEYMAP/vicmd/-- COMMAND --}/main/}
        PROMPT=3D${${KEYMAP/main/$SAVEDPROMPT}/vicmd/}
        zle reset-prompt
}

zle -N zle-line-init
zle -N zle-keymap-select

the odd thing is that the rprompt only gets resetted after hitting ctrl-c=20
(after hitting that once it works flawless). I could work around this by=20
setting transientrprompt but on a fresh shell i need to issue at least one=
=20
command otherwise rprompt does not reset.

Regards,
Bj=F6rn

