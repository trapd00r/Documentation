From zsh-workers-return-14944-mason-zsh=primenet.com.au@sunsite.dk Sat Jun 16 06:48:30 2001
Return-Path: <zsh-workers-return-14944-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10760 invoked from network); 16 Jun 2001 06:48:28 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 16 Jun 2001 06:48:28 -0000
Received: (qmail 20084 invoked by alias); 16 Jun 2001 06:47:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14944
Received: (qmail 20068 invoked from network); 16 Jun 2001 06:47:57 -0000
To: zsh-workers@sunsite.auc.dk
Path: mason
From: mason@primenet.com.au (Geoff Wing)
X-Newsgroups: lists.zsh.workers
Subject: Re: PATCH: 4.1.0: mkstemp
Date: Sat, 16 Jun 2001 06:48:17 +0000 (UTC)
Organization: PrimeNet Computer Consultants
Lines: 29
Message-ID: <9gevfh$abj$1@coral.primenet.com.au>
References: <20010615231436.CD4541428B@pwstephenson.fsnet.co.uk> <Pine.LNX.4.33L2.0106151654030.8874-100000@phong.blorf.net>
Reply-To: mason@primenet.com.au
NNTP-Posting-Host: coral.primenet.com.au
X-Trace: coral.primenet.com.au 992674097 10611 203.43.15.2 (16 Jun 2001 06:48:17 GMT)
X-Complaints-To: usenet@coral.primenet.com.au
NNTP-Posting-Date: Sat, 16 Jun 2001 06:48:17 +0000 (UTC)
User-Agent: slrn/0.9.7.0 (NetBSD)

Wayne Davison <wayned@users.sourceforge.net> typed:
: On Sat, 16 Jun 2001, Peter Stephenson wrote:
:> gcc has taken to complaining about using mktemp() instead of mkstemp().
: Since mkstemp() returns a file handle, not a file name, I reverted the
: code in util.c back to how it was.

Of course, given it's just about certain to be immediately clobbered by
the following lines . . . .
Peter did that around 10pm on a Friday night; he must have just come
back from the pub.  Oops :-)

....
+#ifdef HAVE_MKSTEMP
+    ret = ((char *) mkstemp(dyncat(unmeta(s), "XXXXXX")));
 #ifdef HAVE__MKTEMP
     /* Zsh uses mktemp() safely, so silence the warnings */
     ret = ((char *) _mktemp(dyncat(unmeta(s), "XXXXXX")));
 #else
     ret = ((char *) mktemp(dyncat(unmeta(s), "XXXXXX")));
+#endif
 #endif
     unqueue_signals();
....

Regards,
-- 
Geoff Wing : <gcw@pobox.com>
Rxvt Stuff : <gcw@rxvt.org>
Zsh Stuff  : <gcw@zsh.org>

