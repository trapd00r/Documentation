From zsh-workers-return-7704-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Sep 07 22:26:29 1999
Return-Path: <zsh-workers-return-7704-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23150 invoked from network); 7 Sep 1999 22:26:24 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Sep 1999 22:26:24 -0000
Received: (qmail 4701 invoked by alias); 7 Sep 1999 22:26:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7704
Received: (qmail 4694 invoked from network); 7 Sep 1999 22:26:18 -0000
Date: Tue, 7 Sep 1999 18:26:17 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: [3.1.6-pws-3] make distclean behavior more appropriate to task
Message-ID: <19990907182617.B28749@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.4i

--- zsh-3.1.6.pws3.orig/Makefile.in
+++ zsh-3.1.6.pws3/Makefile.in
@@ -96,7 +96,9 @@
 @CLEAN_MK@
 
 distclean-here:
-	rm -f Makefile config.h config.status config.log config.cache stamp-h
+	@cd Completion && $(MAKE) $(MAKEDEFS) $@
+	@cd Functions && $(MAKE) $(MAKEDEFS) $@
+	rm -f Makefile config.h config.status config.log config.cache stamp-h Config/defs.mk
 
 realclean-here:
 	cd $(sdir) && rm -f config.h.in stamp-h.in configure
--- zsh-3.1.6.pws3.orig/Completion/Makefile.in
+++ zsh-3.1.6.pws3/Completion/Makefile.in
@@ -52,13 +52,14 @@
 
 # ========== DEPENDENCIES FOR CLEANUP ==========
 
-@CLEAN_MK@
-
 mostlyclean-here:
 
 distclean-here:
+	rm -f Makefile
 
 realclean-here:
+
+@CLEAN_MK@
 
 # ========== DEPENDENCIES FOR MAINTENANCE ==========
 
--- zsh-3.1.6.pws3.orig/Doc/Makefile.in
+++ zsh-3.1.6.pws3/Doc/Makefile.in
@@ -205,18 +205,18 @@
 
 # ========== DEPENDENCIES FOR CLEANUP ==========
 
-@CLEAN_MK@
-
 clean-here:
 	rm -f *.html *.info* *.dvi *.ps
 	rm -f *.aux *.cp *.cps *.fn *.fns *.ky *.log
 	rm -f *.pg *.pgs *.toc *.tp *.tps *.vr *.vrs
 
-distclean-here:
-	rm -f Makefile
+distclean-here: clean-here
+	rm -f Makefile *.1 *.texi
 
-realclean-here:
-	cd $(sdir) && rm -f version.yo *.1 *.texi ../META-FAQ
+realclean-here: distclean-here
+	cd $(sdir) && rm -f version.yo ../META-FAQ
+
+@CLEAN_MK@
 
 # ========== DEPENDENCIES FOR MAINTENANCE ==========
 
--- zsh-3.1.6.pws3.orig/Functions/Makefile.in
+++ zsh-3.1.6.pws3/Functions/Makefile.in
@@ -52,13 +52,14 @@
 
 # ========== DEPENDENCIES FOR CLEANUP ==========
 
-@CLEAN_MK@
-
 mostlyclean-here:
 
 distclean-here:
+	rm -f Makefile
 
 realclean-here:
+
+@CLEAN_MK@
 
 # ========== DEPENDENCIES FOR MAINTENANCE ==========

