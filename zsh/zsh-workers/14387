From zsh-workers-return-14387-mason-zsh=primenet.com.au@sunsite.dk Fri May 18 18:17:15 2001
Return-Path: <zsh-workers-return-14387-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29150 invoked from network); 18 May 2001 18:17:14 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 May 2001 18:17:14 -0000
Received: (qmail 29006 invoked by alias); 18 May 2001 18:17:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14387
Received: (qmail 28977 invoked from network); 18 May 2001 18:17:02 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010518181629.ZM17512@candle.brasslantern.com>
Date: Fri, 18 May 2001 18:16:29 +0000
In-Reply-To: <1010518173439.ZM14970@candle.brasslantern.com>
Comments: In reply to "Bart Schaefer" <schaefer@candle.brasslantern.com>
        "PATCH: Icky little array slice assignment bug" (May 18,  5:34pm)
References: <1010518173439.ZM14970@candle.brasslantern.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: Re: PATCH: Icky little array slice assignment bug
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

I wrote:
}
} That is, there's a phantom element at the right end of an array but not at
} the left, so you can "push" but not "unshift" elements -- an attempt to
} insert at the beginning of the array clobbers the first element.

Looking back at the ChangeLog-Release for several of the patches related
to 11677 caused me to try this:

zagzig% a[1,0]=(a b c)
zagzig% echo $a
a b c
zagzig% a[1,0]=(x y z)
zagzig% echo $a
x y z a b c

Well, whaddya know; you CAN do an "unshift", you just have to use a
seemingly-impossible range to accomplish it.

However, it demonstrates that my first patch didn't cover all cases (so
I have not committed it yet):

zagzig% a=(a b c)
zagzig% a[2,(R)q]=x
zagzig% echo $a
a x a b c
zagzig% a[3,(R)q]=y
zagzig% echo $a
a x y a x a b c

I'm not quite sure what to do about this.  Wayne?

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

