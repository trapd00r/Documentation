From zsh-workers-request@math.gatech.edu  Wed Oct 18 01:12:19 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.net.au (8.7/8.7) with SMTP id BAA23129 for <mason@werple.mira.net.au>; Wed, 18 Oct 1995 01:12:01 +1000 (EST)
Received: from euclid (euclid.skiles.gatech.edu) by gatech.edu with SMTP id AA22393
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Tue, 17 Oct 1995 11:03:08 -0400
Received: by euclid (5.x/SMI-SVR4)
	id AA12095; Tue, 17 Oct 1995 11:01:37 -0400
Resent-Date: Tue, 17 Oct 1995 16:02:16 +0100 (MET)
Old-Return-Path: <hzoli@cs.elte.hu>
From: Zoltan Hidvegi  <hzoli@cs.elte.hu>
Message-Id: <199510171502.QAA27274@bolyai.cs.elte.hu>
Subject: Re: still bugs with 8-bit chars :-(
To: carlos@snfep1.if.usp.br (Carlos Carvalho)
Date: Tue, 17 Oct 1995 16:02:16 +0100 (MET)
Cc: zsh-workers@math.gatech.edu (zsh-workers)
In-Reply-To: <199510171246.KAA01877@snfep1.if.usp.br> from "Carlos Carvalho" at Oct 17, 95 10:46:07 am
X-Mailer: ELM [version 2.4 PL24]
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-Id: <"d45hh2.0.vy2.GLyWm"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/463
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Carlos Carvalho wrote:
> 
> The problem with accented chars still exist, and this time also in
> completion. If you try to complete the file "revalida\347\343o.tex"
> (the \??? are the ascii spelling of the octal codes) it starts to
> complete all files in the directory.
> 
> If you type the name directly such as in "tex revalida\347\343o.tex",
> zsh cuts it before the first accented char, and thinks that "o.tex" is
> another command.
> 
> This is after applying Peter's patch.

This works for me with 2.6-beta11-test9-hzoli11.  2.6-beta11-test9 should also
work.

However, Peter's patch is not perfect, since it uses a cast from char to
unsignec char, which is broken with some compilers.  Here is a fix for that.
If you have a buggy compiler, this may be your problem.

Bye,
  Zoltan

*** 1.2	1995/10/10 18:20:38
--- Src/input.c	1995/10/17 14:57:56
***************
*** 109,115 ****
  	if (inbufleft) {
  	    inbufleft--;
  	    inbufct--;
! 	    return lastc = (int)(unsigned char)*inbufptr++;
  	}
  	/*
  	 * No characters in input buffer.
--- 109,115 ----
  	if (inbufleft) {
  	    inbufleft--;
  	    inbufct--;
! 	    return lastc = STOUC(*inbufptr++);
  	}
  	/*
  	 * No characters in input buffer.

