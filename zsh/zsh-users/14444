From zsh-users-return-14444-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 30 22:39:07 2009
Return-Path: <zsh-users-return-14444-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2851 invoked from network); 30 Sep 2009 22:39:04 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 30 Sep 2009 22:39:04 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 25321 invoked from network); 30 Sep 2009 22:38:53 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 30 Sep 2009 22:38:53 -0000
Received: (qmail 10977 invoked by alias); 30 Sep 2009 22:38:43 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14444
Received: (qmail 10964 invoked from network); 30 Sep 2009 22:38:42 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 30 Sep 2009 22:38:42 -0000
Received: from web65610.mail.ac4.yahoo.com (web65610.mail.ac4.yahoo.com [76.13.9.78])
	by bifrost.dotsrc.org (Postfix) with SMTP id B0F6E808ECB9
	for <zsh-users@sunsite.dk>; Thu,  1 Oct 2009 00:38:24 +0200 (CEST)
Received: (qmail 63114 invoked by uid 60001); 30 Sep 2009 22:38:22 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1254350302; bh=+AANR6vHfxv0bED3o0E6nxyCQKTiQq7veTypjP34o74=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:Cc:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=je+9FBUvQNKhQ/0dXbffUU7+eDDTBSRWKtygbLpt7aJYMTHOClvTEvsFpNHiop6ue+uLkXpYk0/sMvGvlCX3umVxYTtZCvXax/2tTZzDk34K9vpjwanGdeg5sbJpvIVMVCk51lSmouhtsua3NQyjW1BeBLMkFjEdMVCAMEQaUAo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:Cc:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=d2MV1Qeyk1PcbwUz88HgiF+GOvRTuU8zA/I3V3ghnxGK4xMFKcVh5BJ1hhbYcGwPTLiKzDWgaJZ8BF1d+TE4v63sKGAxrw4nvUTd4bb92yiUMgh7he2uCaFPD2IZ5YVfAT9hDQcUqoCkQy9iVaeaU2dqyirxC07TzHZbmtWjw7o=;
Message-ID: <862273.62410.qm@web65610.mail.ac4.yahoo.com>
X-YMail-OSG: s3PjvAEVM1k5p72u_duG1VS.MStbJDm.rQDKoImvsMIccrva9_UA6ZKy0TgY5zkit_MiSQbkVqMrcL5yDt1DJ5.AIeBmq8MDSBQH0cgZK1wH37IP_3NBWX4RMAbhh7m5TZHFVlc7HUkyPaSUHJOQjLyqFzoO6hroxbILUEUxQHeRQlMOvifiD_coHRx6o45bWlSzk0fi52Jjw7LzTg5ToLW9PmlbBfKk1tX_QpSYdqfPWGzuMVWsc7AeM32Kt6Rg_yD.IpZ6EbdvT9eZfcgNoh42LOPnbFOc2kDyWekh69kJnn2vYqRi0w5Z14Mizq_zpVSEPe4lCuKMPIuWBMaosP_ACyCS8mBTsKb6.to8KLD00t7E5S3pFagd6fC2lLcN2d5XUw37K8EIRP0FjEJpmWaDsMTF
Received: from [77.251.55.98] by web65610.mail.ac4.yahoo.com via HTTP; Wed, 30 Sep 2009 15:38:22 PDT
X-Mailer: YahooMailClassic/7.0.14 YahooMailWebService/0.7.347.3
Date: Wed, 30 Sep 2009 15:38:22 -0700 (PDT)
From: Guido van Steen <gvsteen@yahoo.com>
Subject: Re: matlab-history-beginning-search-backward
To: Peter Stephenson <p.w.stephenson@ntlworld.com>
Cc: zsh-users@sunsite.dk
In-Reply-To: <20090930205339.7dbad268@pws-pc>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Scanned: ClamAV 0.94.2/9856/Wed Sep 30 14:27:30 2009 on bifrost
X-Virus-Status: Clean

Hi Peter, =0A=0AAwesome! This works exactly like what I had in mind. As an =
exercise for myself I may try to add some cursor handling. =0A=0AThank you =
very, very much!!! =0A=0AGuido =0A=0A--- On Wed, 9/30/09, Peter Stephenson =
<p.w.stephenson@ntlworld.com> wrote:=0A=0A> From: Peter Stephenson <p.w.ste=
phenson@ntlworld.com>=0A> Subject: Re: matlab-history-beginning-search-back=
ward=0A> To: zsh-users@sunsite.dk=0A> Date: Wednesday, September 30, 2009, =
9:53 PM=0A> On Wed, 30 Sep 2009 09:52:10 -0700=0A> (PDT)=0A> Guido van Stee=
n <gvsteen@yahoo.com>=0A> wrote:=0A> > I use the "history-beginning-search-=
backward" widget=0A> quite=0A> > frequently. It searches for commands in th=
e command=0A> history that START=0A> > WITH "LBUFFER". =0A> >=0A> > I like =
this behaviour. It is simple and it keeps my=0A> attention fixed on=0A> > o=
ne line. What I don't like about the widget is that=0A> ONLY searches for=
=0A> > commands that start with "LBUFFER". Instead I would=0A> prefer a sim=
ilar=0A> > widget that searches for commands in the command=0A> history, in=
 such a way=0A> > that "LBUFFER" is a SUBSTRING of these commands.=0A> =0A>=
 (I moved this to zsh-users.)=0A> =0A> This seemed to work.=A0 I stole a lo=
t of it from=0A> history-beginning-search-menu.=A0 It implements forward=0A=
> and backward=0A> searches, so you can do something like=0A> =0A> zle -N h=
istory-substring-search-forward=0A> history-substring-search-backward=0A> z=
le -N history-substring-search-backward=0A> bindkey '\ep' history-substring=
-search-backward=0A> bindkey '\en' history-substring-search-forward=0A> =0A=
> At this point, it is traditional for people to say it's=0A> absolutely=0A=
> crucial that the cursor be posititioned etc. etc...=0A> =0A> pws=0A> =0A>=
 =0A> # history-substring-search-backward=0A> # can also be used for the wi=
dget=0A> history-substring-search-forward.=0A> =0A> emulate -L zsh=0A> seto=
pt extendedglob=0A> =0A> zmodload -i zsh/parameter=0A> =0A> local search=3D=
$LBUFFER MATCH MBEGIN MEND=0A> =0A> typeset -g ZLE_HISTORY_SUBSTRING_MATCH=
=0A> =0A> if [[ $LASTWIDGET =3D history-substring-search-* ]]; then=0A> =A0=
 # here's one I prepared earlier=0A> =A0 search=3D$ZLE_HISTORY_SUBSTRING_MA=
TCH=0A> else=0A> =A0 # We need to quote metacharacters in the search=0A> st=
ring=0A> =A0 # since they are otherwise active in the reverse=0A> subscript=
.=0A> =A0 # We need to avoid quoting other characters since=0A> they aren't=
=0A> =A0 # and just stay quoted, rather annoyingly.=0A> =A0=0A> search=3D${=
LBUFFER//(#m)[\][()\\*?#<>~^]/\\$MATCH}=0A> =A0 ZLE_HISTORY_SUBSTRING_MATCH=
=3D$search=0A> fi=0A> =0A> local -aU matches=0A> matches=3D(${(kon)history[=
(R)*${search}*]})=0A> =0A> # Filter out any match that's the same as the or=
iginal.=0A> # Note this isn't a pattern this time.=0A> matches=3D(${matches=
:#${LBUFFER}})=0A> =0A> (( ${#matches} )) || return 1=0A> =0A> if [[ $WIDGE=
T =3D *forward* ]]; then=0A> =A0 eval "matches=3D(\${matches:#<-$HISTNO>})"=
=0A> =A0 (( ${#matches} )) || return 1=0A> =A0 HISTNO=3D${matches[1]}=0A> e=
lse=0A> =A0 eval "matches=3D(\${matches:#<$HISTNO->})"=0A> =A0 (( ${#matche=
s} )) || return 1=0A> =A0 HISTNO=3D${matches[-1]}=0A> fi=0A> =0A=0A=0A     =
 

