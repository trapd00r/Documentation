From zsh-users-return-8971-mason-zsh=primenet.com.au@sunsite.dk Tue Jun 07 09:26:59 2005
Return-Path: <zsh-users-return-8971-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4018 invoked from network); 7 Jun 2005 09:26:58 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Jun 2005 09:26:58 -0000
Received: (qmail 38411 invoked from network); 7 Jun 2005 09:26:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Jun 2005 09:26:52 -0000
Received: (qmail 2870 invoked by alias); 7 Jun 2005 09:26:42 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8971
Received: (qmail 2852 invoked from network); 7 Jun 2005 09:26:41 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Jun 2005 09:26:41 -0000
Received: (qmail 37306 invoked from network); 7 Jun 2005 09:26:41 -0000
Received: from mailhost1.csr.com (HELO MAILSWEEPER01.csr.com) (81.105.217.43)
  by a.mx.sunsite.dk with SMTP; 7 Jun 2005 09:26:35 -0000
Received: from exchange03.csr.com (unverified [10.100.137.60]) by MAILSWEEPER01.csr.com
 (Content Technologies SMTPRS 4.3.12) with ESMTP id <T7162bd60320a6c8d01618@MAILSWEEPER01.csr.com> for <zsh-users@sunsite.dk>;
 Tue, 7 Jun 2005 10:24:42 +0100
Received: from news01.csr.com ([10.103.143.38]) by exchange03.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Tue, 7 Jun 2005 10:26:46 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.1/8.12.11) with ESMTP id j579QWvY022319
	for <zsh-users@sunsite.dk>; Tue, 7 Jun 2005 10:26:32 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.1/8.13.1/Submit) with ESMTP id j579QW1R022316
	for <zsh-users@sunsite.dk>; Tue, 7 Jun 2005 10:26:32 +0100
Message-Id: <200506070926.j579QW1R022316@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: Avoid LDAP hit during completion 
In-reply-to: <FFF88236-D978-451E-8149-E994EFAB420F@mac.com> 
References: <FFF88236-D978-451E-8149-E994EFAB420F@mac.com>
Date: Tue, 07 Jun 2005 10:26:31 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 07 Jun 2005 09:26:46.0194 (UTC) FILETIME=[0642A920:01C56B43]
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

Chris Wong wrote:
> For some reason, whenever I start a zsh shell, the first completion  
> will trigger many many LDAP lookup.
> 
> % cd foo<TAB>
> 
> As soon as I hit TAB, the shell appears as frozen, but at the  
> background, it's hitting the LDAP server of my company network.  This  
> will go one for a couple minutes, at least.  tcpdump and top revealed  
> that mystery to me.

Are you using the new completion system (with compinit)?  The best way
of tracking this down would be to see what the completion scripts are
doing.  You can arrange this with

_comp_setup="$_comp_setup
setopt xtrace"

This produces a huge amount of output so is useless for normal
completion but you should be able to see where the shell is pausing for
a long time.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


**********************************************************************
This email and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this email in error please notify
the system manager.

**********************************************************************

