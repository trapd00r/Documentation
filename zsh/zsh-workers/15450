From zsh-workers-return-15450-mason-zsh=primenet.com.au@sunsite.dk Sun Jul 22 16:04:25 2001
Return-Path: <zsh-workers-return-15450-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3251 invoked from network); 22 Jul 2001 16:04:24 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Jul 2001 16:04:24 -0000
Received: (qmail 2088 invoked by alias); 22 Jul 2001 16:04:17 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15450
Received: (qmail 2077 invoked from network); 22 Jul 2001 16:04:16 -0000
X-Authentication-Warning: localhost.free.fr: lefevre set sender to vincent@vinc17.org using -f
Date: Sun, 22 Jul 2001 17:33:20 +0200
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-workers@sunsite.dk
Cc: Vincent Lefevre <vincent@vinc17.org>
Subject: Re: [4.0.2 bug] commands not written to history
Message-ID: <20010722173320.A1043@ay.free.fr>
Mail-Followup-To: Vincent Lefevre <vincent@vinc17.org>,
	zsh-workers@sunsite.dk
References: <20010629163348.A9632@greux.loria.fr> <20010721154449.A1971@ay.free.fr> <1010721183220.ZM8456@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <1010721183220.ZM8456@candle.brasslantern.com>
User-Agent: Mutt/1.3.19i
X-Mailer-Info: http://www.vinc17.org/mutt_eng.html

On Sat, Jul 21, 2001 at 18:32:20 +0000, Bart Schaefer wrote:
> Because zsh writes the history before calling TRAPEXIT, the `unsaved' file
> should always be empty.  If it is not, then INC_APPEND_HISTORY is causing
> an error when the history is written at exit time.

This isn't true here:

ay:~/.zhist-debug> cat unsaved.845                                    <17:29:25
: 995810482:0;
ay:~/.zhist-debug> tail -n 5 complete.845                             <17:29:39
: 995761699:0;tail .tin/posted
: 995762334:0;tail -n 45 .tin/posted >| ~out/addposted
: 995797911:12567;startx
: 995810481:1;halt
: 0:995797910;
ay:~/.zhist-debug> tail -n 5 histfile.845                             <17:29:48
: 995810431:0;ll ~out
: 995810450:0;cd out
: 995810455:0;zip -ru ../file.zip *
: 995810458:0;cd
: 995810467:0;tail -n 45 .tin/posted >| ~out/addposted

ay:~/.zhist-debug> cat unsaved.949                                    <17:31:36
: 995810477:0;
ay:~/.zhist-debug> tail -n 5 complete.949                             <17:31:39
: 995761695:0;cd
: 995761699:0;tail .tin/posted
: 995762334:0;tail -n 45 .tin/posted >| ~out/addposted
: 995797911:0;startx
: 0:995797922;
ay:~/.zhist-debug> tail -n 5 histfile.949                             <17:31:42
: 995810431:0;ll ~out
: 995810450:0;cd out
: 995810455:0;zip -ru ../file.zip *
: 995810458:0;cd
: 995810467:0;tail -n 45 .tin/posted >| ~out/addposted

-- 
Vincent Lefèvre <vincent@vinc17.org> - Web: <http://www.vinc17.org/> - 100%
validated HTML - Acorn Risc PC, Yellow Pig 17, Championnat International des
Jeux Mathématiques et Logiques, TETRHEX, etc.
Work: CR INRIA - computer arithmetic / SPACES project at LORIA

