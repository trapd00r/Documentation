From zsh-workers-return-6788-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jun 22 16:34:50 1999
Return-Path: <zsh-workers-return-6788-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27449 invoked from network); 22 Jun 1999 16:34:47 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Jun 1999 16:34:47 -0000
Received: (qmail 10082 invoked by alias); 22 Jun 1999 16:34:28 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6788
Received: (qmail 10073 invoked from network); 22 Jun 1999 16:34:26 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <990622163343.ZM29267@candle.brasslantern.com>
Date: Tue, 22 Jun 1999 16:33:43 +0000
In-Reply-To: <006601bebca3$780f1ca0$21c9ca95@mow.siemens.ru>
Comments: In reply to "Andrej Borsenkow" <borsenkow.msk@sni.de>
        "BUG: Impossible TIOCGWINSZ rows/cols" (Jun 22,  3:36pm)
References: <006601bebca3$780f1ca0$21c9ca95@mow.siemens.ru>
X-Mailer: Z-Mail (5.0.0 30July97)
To: "Andrej Borsenkow" <borsenkow.msk@sni.de>,
        "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>
Subject: Re: BUG: Impossible TIOCGWINSZ rows/cols
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jun 22,  3:36pm, Andrej Borsenkow wrote:
} Subject: BUG: Impossible TIOCGWINSZ rows/cols
}
} I just got it (with all patches):
} 
} BUG: Impossible TIOCGWINSZ rows
} BUG: Impossible TIOCGWINSZ cols
} 
} This is using dtterm under TED 4.2.

This means (as you might guess) that my new LINES/COLUMNS code expected
to be able to read the terminal size from the tty driver and got back a
non-positive value (probably zero).  I knew this sometimes occured on Sun
and BSD operating systems back when I was using them regularly, but I was
not sure it still did.

The code grabs the termcap (terminfo) rows/cols values in this case, or
uses 24/80 if the term database doesn't have values.

If (1) this happens only on startup and not when you resize the window,
and (2) the LINES/COLUMNS values you're getting are correct, then you can
just ignore the message.  (You get the warning only if you compile with
debugging.)  If (1) is false, I'm not sure what to do; the only reasonable
thing may be to take out the debug warning and simply ignore the problem.
If (2) is false, you'll have to compensate in your startup files by using
the dtterm equivalent of `eval $(resize)`.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

