From zsh-workers-request@euclid.skiles.gatech.edu  Wed Nov 20 08:11:28 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.6/8.7.3) with ESMTP id IAA09180 for <mason@primenet.com.au>; Wed, 20 Nov 1996 08:11:25 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id PAA08423; Tue, 19 Nov 1996 15:53:07 -0500 (EST)
Resent-Date: Tue, 19 Nov 1996 15:53:07 -0500 (EST)
Message-Id: <m0vPxFP-00008PC@aglaia.aball.DE>
Subject: vi mode weird when editing previous history entries
To: zsh-workers@math.gatech.edu
Date: Tue, 19 Nov 1996 21:58:20 +0100 (MET)
From: Thorsten Meinecke <kaefer@aglaia.aball.DE>
Organization: none. Location: Berlin, Germany
X-Mailer: ELM [version 2.4 PL23]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"sZqUO3.0.U32.ouXao"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2432
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

This bug is around a little longer, I've seen it in zsh-3.0.0 too.
The effect of it is twofold (maybe there are two separate bugs in-
stead):
- it either zaps the current buffer (after movement commands) or
- it dumps core when attempting deletions with certain movements
  commands.

To reproduce it, you'll need a none-empty history.  Scroll up into
an old history entry, say with up-history (or other history key
commands -- `!' and expand-or-complete won't do), enter vi-cmd-mode
and do vi-set-mark, optionally followed by movements and then do
vi-goto-mark.  Key order:

  vi-cmd-mode               ^[
  up-history                ^P
  vi-set-mark               ma
  vi-goto-mark              `a

The current buffer: is gone.  Doesn't happen when editing a new
buffer freshly filled by typing or one filled by bang expansion.

Now try to vi-delete with vi-goto-mark as movement command.  NOT!
There is at least one similar sequence that violates segmentation:

  up-line-or-history        ^[[A (bound to a cursor key)
  vi-cmd-mode               ^[
  vi-delete                 d
  end-of-buffer-or-history  \M-x end-of-buffer-or-history

I don't think it's something system-specific.  Regards,
--Thorsten

