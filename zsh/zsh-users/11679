From zsh-users-return-11679-mason-zsh=primenet.com.au@sunsite.dk Sat Jul 28 19:00:44 2007
Return-Path: <zsh-users-return-11679-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14798 invoked from network); 28 Jul 2007 19:00:42 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 28 Jul 2007 19:00:42 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 46241 invoked from network); 28 Jul 2007 19:00:29 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 Jul 2007 19:00:29 -0000
Received: (qmail 15610 invoked by alias); 28 Jul 2007 19:00:21 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11679
Received: (qmail 15501 invoked from network); 28 Jul 2007 19:00:19 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 28 Jul 2007 19:00:19 -0000
Received: (qmail 44391 invoked from network); 28 Jul 2007 19:00:19 -0000
Received: from cavecanem.ucsc.edu (128.114.150.237)
  by a.mx.sunsite.dk with SMTP; 28 Jul 2007 19:00:15 -0000
Received: from cavecanem.ucsc.edu (localhost [127.0.0.1])
	by cavecanem.ucsc.edu (8.13.6/8.13.5) with ESMTP id l6SJ0Mc4006476;
	Sat, 28 Jul 2007 12:00:22 -0700 (PDT)
Received: (from web@localhost)
	by cavecanem.ucsc.edu (8.13.6/8.13.1/Submit) id l6SJ0Jf7006442;
	Sat, 28 Jul 2007 12:00:19 -0700 (PDT)
X-Authentication-Warning: cavecanem.ucsc.edu: web set sender to wgscott@chemistry.ucsc.edu using -f
Received: from 66.167.127.80
        (SquirrelMail authenticated user wgscott)
        by mail.acg.ucsc.edu with HTTP;
        Sat, 28 Jul 2007 12:00:19 -0700 (PDT)
Message-ID: <38952.66.167.127.80.1185649219.squirrel@mail.acg.ucsc.edu>
In-Reply-To: <200707282223.41165.arvidjaar@newmail.ru>
References: <f8fj85$9ud$1@sea.gmane.org>
    <200707282223.41165.arvidjaar@newmail.ru>
Date: Sat, 28 Jul 2007 12:00:19 -0700 (PDT)
Subject: Re: the konsole title bar
From: "William Scott" <wgscott@chemistry.ucsc.edu>
To: "Andrey Borzenkov" <arvidjaar@newmail.ru>
Cc: zsh-users@sunsite.dk, linux_milano@yahoo.it
User-Agent: SquirrelMail/1.4.6
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal



Andrey Borzenkov wrote:
> On Saturday 28 July 2007, pol wrote:
>> I am using the following command in /etc/zsh/zshrc to change the title
>> bar
>> and tab bar according to the current directory:
>>
>> precmd () {
>>      tab_lable="$PWD:h:t/$PWD:t"
>>      rlength="20"   # number of characters to appear before truncation
>> from
>> the left
>>
>>     dcop "$KONSOLE_DCOP_SESSION" renameSession
>> "$tab_lable[-$rlength,-1]"
>>
>>     }
>>
>> When running vim, the running command is added to  <current dir>, in the
>> title and tab names.
>> However, as vim has been closed, title bar and tab name take the form:
>> <current dir> Konsole <current dir>
>
> may be you mean <current dir> - <current dir> - Konsole
>
> at least that is what I get in such case.
>
>>
>> That is not what expected
>>
>> What is wrong?
>>
>
> There are session name and window title. Some programs do set window
> title;
> this is relatively portable in the sense it works on xterm and derivatives
> as
> well as konsole and even cygwin as far as I remember. Windows title set
> this
> way comes before session name.
>
> what you could do
>
> a) configure all programs you use to no set window title. This may be
> impossible (e.g. sometimes I log in remotely in a system where I simply do
> not have any way to turn this off).
>
> b) set session name to some "innocent" fixed string and use window title
> instead yourself. Setting session name to empty string gives ugly:
>
> <your window title> - - Konsole
>
> may be it is possible to turn session name and Konsole off completely but
> I
> cannot find it.
>
> Oh, and you set window title with
>
>   print -nP -u2 '\033]0;<your title goes here>\a
>


A bit of explanation:  I recognized what he has as something I wrote --
complete with the spelling error I made.

I wrote it for iTerm ons OS X primarily, in which

\e]1  ( or \033]1 )  puts stuff in the tab

and

\e]2  puts stuff in the title bar.

This is specific to iTerm and AFAIK doesn't work with any of the other
tabbed terminal emulators (if it does, it is just by chance).

I like to have the full directory in the title bar and the last and
penultimate directory in the tab.

The problem is with Konsole, \e]1 doesn't put stuff in the tab, but

 dcop "$KONSOLE_DCOP_SESSION" renameSession  foo

does this.  Unfortunately, it also puts the same junk in the title bar,
which I had not even noticed before today, since I hardly ever use konsole
these days (very rarely on OS X and I use xfce4 these days on linux,
including whatever the terminal is that comes with that).

I use the same startup scripts on linux as OS X, and have these available
on a web page in case anyone else wants them, so I am presuming that is
where this originated.



