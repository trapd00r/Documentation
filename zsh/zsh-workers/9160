From zsh-workers-return-9160-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Dec 27 03:05:22 1999
Return-Path: <zsh-workers-return-9160-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8907 invoked from network); 27 Dec 1999 03:05:17 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Dec 1999 03:05:17 -0000
Received: (qmail 25446 invoked by alias); 27 Dec 1999 03:05:02 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9160
Received: (qmail 25422 invoked from network); 27 Dec 1999 03:05:02 -0000
Date: Sun, 26 Dec 1999 22:05:00 -0500
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: make _deb_packages handle -J
Message-ID: <19991226220500.A842@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0i

At some point _dpkg started passing '-J -default-' to _deb_packages,
and _deb_packages didn't like it.  Since this is intended as a temporary
solution, the option is not being passed along to compadd.

The result is that _apt and _dpkg will both work with _deb_packages.

Index: Completion/Debian/_deb_packages
===================================================================
RCS file: /cvs/zsh/zsh/Completion/Debian/_deb_packages,v
retrieving revision 1.1.1.3
diff -u -r1.1.1.3 _deb_packages
--- Completion/Debian/_deb_packages	1999/11/15 12:01:48	1.1.1.3
+++ Completion/Debian/_deb_packages	1999/12/27 02:52:55
@@ -1,6 +1,15 @@
 #autoload
 
+local opt caopts
+
 # Usage: _deb_packages installed|uninstalled|avail
+while getopts "J:" opt; do
+  case "$opt" in
+     J) caopts="-J $OPTARG"
+        shift 2			# presume that -J -default- are the first args
+        ;;
+  esac
+done
 
 if (( ! $+_deb_cache_dpkg_get_selections )); then
   _deb_cache_dpkg_get_selections=(

