From zsh-workers-return-10456-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Apr 04 09:50:08 2000
Return-Path: <zsh-workers-return-10456-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10537 invoked from network); 4 Apr 2000 09:50:06 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 4 Apr 2000 09:50:06 -0000
Received: (qmail 11700 invoked by alias); 4 Apr 2000 09:49:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10456
Received: (qmail 11692 invoked from network); 4 Apr 2000 09:49:50 -0000
Date: Tue, 4 Apr 2000 11:49:42 +0200 (MET DST)
Message-Id: <200004040949.LAA05373@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Sat, 01 Apr 2000 21:26:10 +0100
Subject: Re: Completion issues


Peter Stephenson wrote:

> ...
> 
> Tail-ender:  this is a real bug:
>   % zsh -f
>   % autoload -U compinit; compinit -D
>   % zstyle ':completion:*' completer _expand _complete
>   % zstyle ':<TAB>
>            ^this gets replaced by an character from the upper end of
>             ISO-8859-1 which I didn't particularly want to see.

We need to copy the quoted prefix/suffix when putting them into the
cline.


I've update the ChangeLog for the stuff from yesterday... but rcs2log
is completely unusable for me because it takes ages (so long that I
haven't let it run until the end). Is there a tool to get a ChangeLog
entry template from a diff? Or do I have to write that myself?

Bye
 Sven

Index: Src/Zle/compcore.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/compcore.c,v
retrieving revision 1.2
diff -u -r1.2 compcore.c
--- Src/Zle/compcore.c	2000/04/01 20:49:48	1.2
+++ Src/Zle/compcore.c	2000/04/04 09:42:00
@@ -1982,7 +1982,7 @@
 	    sl = tsl;
 	}
 	if (qisl) {
-	    Cline qsl = bld_parts(qisuf, qisl, qisl, NULL);
+	    Cline qsl = bld_parts(dupstring(qisuf), qisl, qisl, NULL);
 
 	    qsl->flags |= CLF_SUF;
 	    qsl->suffix = qsl->prefix;
@@ -2065,7 +2065,7 @@
 	    line = p;
 	}
 	if (qipl) {
-	    Cline lp, p = bld_parts(qipre, qipl, qipl, &lp);
+	    Cline lp, p = bld_parts(dupstring(qipre), qipl, qipl, &lp);
 
 	    lp->next = line;
 	    line = p;

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

