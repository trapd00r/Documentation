From zsh-workers-request@math.gatech.edu Sat Jun 06 00:58:01 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24404 invoked from network); 6 Jun 1998 00:58:00 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 6 Jun 1998 00:58:00 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id UAA08516;
	Fri, 5 Jun 1998 20:53:45 -0400 (EDT)
Resent-Date: Fri, 5 Jun 1998 20:53:03 -0400 (EDT)
X-Face: 3su_O5R!|})4gc|&nXdVILe~2hIncsaJF_<Oc-Jh^/CMkcS<hf^xDqKMy*k"_g5l>TC>rnR
 NA0Aj<M}5Wt'(7ed8SwQYk-hVi2lG\mkc2$h/Kg706R%]c(14w:>-u\*nln*:ktY!d+[%K()Q|1*-U
 [+xczKd$Xev:F#3'rFgot\l.I+w>DQ%:%HOyZ]EgFw@0[gMFsR-E`Hs~tjkc>y.<T7~KVE0-$=ca5]
 LEV[[CXa(!|P:Y--3j|)%&B,FVU(-DDBBHU%aRKLrtO>i#y<55R_CScR
To: zsh-users@math.gatech.edu
Subject: Patch for the previous bug
From: David Hedbor <david@hedbor.org>
Mime-Version: 1.0 (generated by tm-edit 7.106)
Content-Type: text/plain; charset=US-ASCII
Date: 05 Jun 1998 17:53:27 -0700
Message-ID: <86iumf9wqg.fsf@animearchive.org>
Lines: 23
X-Mailer: Gnus v5.6.5/Emacs 19.34
Resent-Message-ID: <"Tz8cr2.0.L42.kB9Ur"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1579
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

This patch fixes the problem I reported earlier. If it's the desired
way to do it or not, I don't know. :-)

*** builtin.c   Fri Jun  5 17:48:52 1998
--- builtin.c~  Sun May 31 03:26:12 1998
***************
*** 1587,1592 ****
            if (PM_TYPE(pm->flags) != PM_ARRAY) {
                if (pm->flags & PM_EXPORTED) {
!                 if (!pm->env && (asg->value || getsparam(asg->name)))
!                   pm->env = addenv(asg->name, (asg->value) ? asg->value : getsparam(asg->name));
                } else if (pm->env) {
                    delenv(pm->env);
--- 1587,1592 ----
            if (PM_TYPE(pm->flags) != PM_ARRAY) {
                if (pm->flags & PM_EXPORTED) {
!                   if (!pm->env)
!                       pm->env = addenv(asg->name, (asg->value) ? asg->value : getsparam(asg->name));
                } else if (pm->env) {
                    delenv(pm->env);

-- 
David Hedbor

