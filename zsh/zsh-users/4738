From zsh-users-return-4738-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 06 17:17:16 2002
Return-Path: <zsh-users-return-4738-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1671 invoked from network); 6 Mar 2002 17:17:15 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 Mar 2002 17:17:15 -0000
Received: (qmail 29318 invoked by alias); 6 Mar 2002 17:16:59 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4738
Received: (qmail 29302 invoked from network); 6 Mar 2002 17:16:57 -0000
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <1020306171427.ZM23019@candle.brasslantern.com>
Date: Wed, 6 Mar 2002 17:14:27 +0000
In-Reply-To: <15493.54613.934394.25215@wischnow.berkom.de>
Comments: In reply to Sven Wischnowsky <wischnow@berkom.de>
        "Re: segfault when overriding complete-word then trying to use tab completion" (Mar  6,  9:37am)
References: <20020301001623.GA3551@stu163.keble.ox.ac.uk> 
	<1020301092621.ZM18214@candle.brasslantern.com> 
	<20020301123241.GA9242@stu163.keble.ox.ac.uk> 
	<1020301163650.ZM18718@candle.brasslantern.com> 
	<20020301172505.GA11135@stu163.keble.ox.ac.uk> 
	<15493.54613.934394.25215@wischnow.berkom.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Sven Wischnowsky <wischnow@berkom.de>, zsh-users@sunsite.dk
Subject: Re: segfault when overriding complete-word then trying to use tab completion
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Mar 6,  9:37am, Sven Wischnowsky wrote:
} Subject: Re: segfault when overriding complete-word then trying to use tab
}
} I still can't reproduce it.

I can, but only in 4.0.1, not in 4.0.4 (so far) nor 4.1.x.

The problem is that .complete-word is a completion widget, but it's being
called from a function installed as a normal widget with `zle -N'.  This
confuses the completion code somehow -- I haven't got a sensible stack
trace -- but it appears in 4.1.x as though calling `zle .complete-word'
from a normal widget will bypass the new completion system and always
invoke compctl.

In 4.0.1, on the other hand, it appears to depend on the order in which
one runs `compinit' and `zle -N'.  Sometimes it invokes compctl and all
works well, other times it tries to invoke new completion and blows up.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

