From zsh-workers-request@euclid.skiles.gatech.edu  Sun Nov 10 22:00:48 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id WAA04278 for <mason@primenet.com.au>; Sun, 10 Nov 1996 22:00:46 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id FAA27002; Sun, 10 Nov 1996 05:58:30 -0500 (EST)
Resent-Date: Sun, 10 Nov 1996 05:58:30 -0500 (EST)
Date: Sun, 10 Nov 1996 13:59:34 +0300 (MOW)
From: Andrej Borsenkow <borsenkow.msk@sni.de>
X-Sender: bor@itsrm1.mow.sni.de
Reply-To: borsenkow.msk@sni.de
To: Zoltan Hidvegi <hzoli@cs.elte.hu>
cc: Zsh workers list <zsh-workers@math.gatech.edu>
Subject: Re: zsh-3.1 development: dynamic modules
In-Reply-To: <199611062138.WAA21625@bolyai.cs.elte.hu>
Message-ID: <Pine.SV4.3.95.961110134620.4246B-100000@itsrm1.mow.sni.de>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Resent-Message-ID: <"-ad6x3.0.qb6.LLRXo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2363
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu


I tried it on Sinix 5.42. It is SVR4-derived system with -ldl library. At
least Perl 5.003 DynaLoad works O.K.

There are many problems about autoconf, but it could be solved in future.
The crucial problem is:

  on some systems (our at least; I take it to be true for other SVR4 as
  well) the statically linked symbols are *not* available to dynamic
  loader. I am not aware of any options to change it. Applied to 
  ZSH it means, that `addbuiltin' command (when called from loaded module)
  *is not found* :-(

Note, that Perl is built as two parts - "startup" command and library,
which contains actual Perl code. I think, the above problem is one reason
for it. Giving long development cycle of Perl, it probably the only
portable solution.

It means, that ZSH should be splitted in small kernel and (probably
several) dynamically loaded modules. At least those sysmbols, which need
to be accessable from modules, should be in dyna part. But I think, if
such rewrite is ever necessary, it would be nice to modularize code; as
example, whole zle_* part could probably be made separate module (and
loaded only in interactive shell).

BTW code of Tcl 7.5 is in *.so library as well.

I would be glad to here, that I am wrong.

greetings

-------------------------------------------------------------------------
Andrej Borsenkow 		Fax:   +7 (095) 252 01 05
SNI ITS Moscow			Tel:   +7 (095) 252 13 88

NERV:  borsenkow.msk		E-Mail: borsenkow.msk@sni.de
-------------------------------------------------------------------------


