From zsh-workers-return-27230-mason-zsh=primenet.com.au@sunsite.dk Mon Aug 24 08:55:46 2009
Return-Path: <zsh-workers-return-27230-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18190 invoked from network); 24 Aug 2009 08:55:33 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 24 Aug 2009 08:55:33 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 3710 invoked from network); 24 Aug 2009 08:47:25 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 24 Aug 2009 08:47:25 -0000
Received: (qmail 2424 invoked by alias); 24 Aug 2009 08:47:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 27230
Received: (qmail 2400 invoked from network); 24 Aug 2009 08:47:18 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 24 Aug 2009 08:47:18 -0000
Received: from cluster-g.mailcontrol.com (cluster-g.mailcontrol.com [208.87.233.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 29B72810A3B6
	for <zsh-workers@sunsite.dk>; Mon, 24 Aug 2009 10:47:11 +0200 (CEST)
Received: from dalamsexb02.AMERICAS.ROOT.PRI ([65.208.56.47])
	by rly18g.srv.mailcontrol.com (MailControl) with ESMTP id n7O8jUmC009768
	for <zsh-workers@sunsite.dk>; Mon, 24 Aug 2009 09:47:06 +0100
Received: from SJOAMSEXB01.AMERICAS.ROOT.PRI ([10.110.12.58]) by dalamsexb02.AMERICAS.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 24 Aug 2009 03:44:08 -0500
Received: from cameurexb01.EUROPE.ROOT.PRI ([10.100.137.61]) by SJOAMSEXB01.AMERICAS.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 24 Aug 2009 01:43:37 -0700
Received: from news01.csr.com ([10.99.50.25]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 24 Aug 2009 09:43:58 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id n7O8hr2Q017607
	for <zsh-workers@sunsite.dk>; Mon, 24 Aug 2009 09:43:53 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id n7O8hrBC017603
	for <zsh-workers@sunsite.dk>; Mon, 24 Aug 2009 09:43:53 +0100
Message-Id: <200908240843.n7O8hrBC017603@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: PATCH: first go at directory info in completion.
In-reply-to: <237967ef0908220955y4b9b0e54wf65ffce8a1fda402@mail.gmail.com>
References: <19348.1250591605@csr.com> <dbfc82860908180451k176e8bf4y853d335dc240a99c@mail.gmail.com> <200908181200.n7IC0ooX020205@news01.csr.com> <20090818145540.GE9893@prunille.vinc17.org> <237967ef0908220955y4b9b0e54wf65ffce8a1fda402@mail.gmail.com>
Comments: In-reply-to Mikael Magnusson <mikachu@gmail.com>
   message dated "Sat, 22 Aug 2009 18:55:26 +0200."
Date: Mon, 24 Aug 2009 09:43:53 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 24 Aug 2009 08:43:58.0769 (UTC) FILETIME=[05B1F210:01CA2497]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-09-22-00 (www.mailcontrol.com) on 10.71.0.128
X-Virus-Scanned: ClamAV 0.94.2/9729/Sun Aug 23 23:10:46 2009 on bifrost
X-Virus-Status: Clean

Mikael Magnusson wrote:
> I imagine you could make it use (an array of?) function hooks that
> you can define yourself, like is done for precmd and friends. In the
> meantime I made a quick hack to use xattrs via the z*attr commands I
> added a while back.

Generic functions for directory information shouldn't be a big deal.
They can then use any available caching mechanism they feel like.

> I also noticed that when in this long list format, all coloring from
> file types and etc is lost, is there any way to have both? (without
> doing the fabled rewrite).

I think it will have to split the arguments to "compadd" into two,
passing the dirinfo parts with the -J or -V replaced appropriately.  To
do this with a minimum of duplication it would probably be best to make
_list_files responsible for running compadd by passing the compadd
arguments down.  It can then run it twice when necessary.

(This is the sort of addition rewriting won't help you with unless you
explicitly make sure it does, which is why I'm suspicious of the idea of
a rewrite as some kind of panacea for everything.  It would make it more
maintainable, but that's basically all.)

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


'member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom'

