From zsh-workers-return-15657-mason-zsh=primenet.com.au@sunsite.dk Fri Aug 17 16:06:12 2001
Return-Path: <zsh-workers-return-15657-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1448 invoked from network); 17 Aug 2001 16:06:11 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 17 Aug 2001 16:06:11 -0000
Received: (qmail 9068 invoked by alias); 17 Aug 2001 16:06:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15657
Received: (qmail 9056 invoked from network); 17 Aug 2001 16:06:03 -0000
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: Shell exits on bad coproc redirection 
In-reply-to: "Bart Schaefer"'s message of "Fri, 17 Aug 2001 15:42:51 -0000."
             <1010817154252.ZM14094@candle.brasslantern.com> 
Date: Fri, 17 Aug 2001 17:05:24 +0100
Message-ID: <2306.998064324@csr.com>
From: Peter Stephenson <pws@csr.com>

Bart Schaefer wrote:
> The problem seems to be a combination of these two items (ChangeLog-3.1):
> 
> 1999-10-10  Bart Schaefer  <schaefer@zsh.org>
> 
>         * Src/exec.c: Plug lead of a copy of the coproc input descriptor.
> 
> (ahem, that should say "leak").
> 
> Sun May 18 18:57:08 1997  Zolt<E1>n Hidv<E9>gi  <hzoli@cs.elte.hu>
> 
>         * Src/builtin.c, Src/exec.c, Src/init.c, Src/signals.c, Src/jobs.c:
>           Do not handle SIGPIPE specially for shells with job control
> 
> Anybody remember why we stopped handling SIGPIPE?  Is Zoltan still out there
> anywhere?

Presumably that's the root of the near-discussion we had just before the
last release:

>> There's the SIGPIPE issue from 12223 (only partly fixed by 12222?).
>
> I haven't thought about this since, but after jogging my memory by reading
> 12223, 12222 is good enough for the real problem, and the rest was just my
> paranoia.  The issue was that if a `tee' spawned by a multio exits early,
> the parent shell will get SIGPIPE and exit, too; but that's probably not a
> bug.

Multios and coprocs are pretty similar in this respect.  I'm not
particularly attached to `probably not a bug'; I would probably trade it in
for `seems to reflect the current intention of the code' in return for a go
on your playstation.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070


**********************************************************************
The information transmitted is intended only for the person or
entity to which it is addressed and may contain confidential 
and/or privileged material. 
Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by 
persons or entities other than the intended recipient is 
prohibited.  
If you received this in error, please contact the sender and 
delete the material from any computer.
**********************************************************************

