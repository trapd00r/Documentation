From zsh-users-return-10953-mason-zsh=primenet.com.au@sunsite.dk Tue Nov 07 20:48:24 2006
Return-Path: <zsh-users-return-10953-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12991 invoked from network); 7 Nov 2006 20:48:19 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Nov 2006 20:48:19 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 76186 invoked from network); 7 Nov 2006 20:48:10 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Nov 2006 20:48:10 -0000
Received: (qmail 26948 invoked by alias); 7 Nov 2006 20:48:03 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 10953
Received: (qmail 26938 invoked from network); 7 Nov 2006 20:48:03 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Nov 2006 20:48:03 -0000
Received: (qmail 75098 invoked from network); 7 Nov 2006 20:48:03 -0000
Received: from ug-out-1314.google.com (66.249.92.172)
  by a.mx.sunsite.dk with SMTP; 7 Nov 2006 20:48:00 -0000
Received: by ug-out-1314.google.com with SMTP id k3so1147376ugf
        for <zsh-users@sunsite.dk>; Tue, 07 Nov 2006 12:47:59 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=EzYUBJCV1bLLyuvyIm33jrCrD8jEjKOqEoFIHd3yOadEJ/wHtG8wKC+wPEdO8ks8/P+BILmBgbEDmHha9Upxc2ax5JFYKpPmeHyc72LNbslIVW2190soyRKOqzONsGBamJY81CSLFC9qjZDyMBDW+YMiqyHyziuJQmYuddliRK4=
Received: by 10.78.69.7 with SMTP id r7mr5402634hua.1162930741056;
        Tue, 07 Nov 2006 12:19:01 -0800 (PST)
Received: by 10.78.194.3 with HTTP; Tue, 7 Nov 2006 12:19:01 -0800 (PST)
Message-ID: <5db995410611071219q77820cfeg931ac950f744a276@mail.gmail.com>
Date: Wed, 8 Nov 2006 01:49:01 +0530
From: chesss <testingagain@gmail.com>
To: chesss <testingagain@gmail.com>, zsh-users@sunsite.dk
Subject: Re: persistant Directory history?
In-Reply-To: <20061107145231.GA8117@let.rug.nl>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <5db995410611060845y53f673e6je029a9c60659f116@mail.gmail.com>
	 <20061107145231.GA8117@let.rug.nl>

Finally this worked for me  just perfect :)  . i got it from
http://www.zsh.org/mla/users/2006/msg00173.html

DIRSTACKSIZE=20
if [[ -f ~/.zdirs ]] && [[ ${#dirstack[*]} -eq 0 ]]; then
dirstack=( $(< ~/.zdirs) )
popd > /dev/null
fi
precmd() {
dirs -l >! ~/.zdirs # added -l
}
cd

The only problem with the above was that a new shell would start with
the last directory. So I added the extra 'cd' at the end :D
Thanks all

On 11/7/06, Francisco Borges <f.borges@rug.nl> wrote:
> : On Mon, Nov 06, 2006 at 10:15PM +0530, chesss wrote:
>
> > Basically I want to save the directory stack automatically and have
> > ctrl+r like history..
> > Possible?
>
> I really wish the zsh-devs would include something for this in Zsh.
> After I started having a persistent dirstack, I really had to wonder how
> I had lived without it for so long :-)
>
> Turns out there is a lot of people with custom ways to implement it.
>
> [...]
>
> As Stephane pointed out, all you need to do is to somehow set the
> dirstack variable when you log in.
>
> But I rather rewrite the zsh_dir_file everytime I change dirs. instead
> of only after logout. Also (making a long story short) right after
> login, just setting $OLDPWD won't allow you to use
>
> % cd -
>
> so I force the shell to visit the first dir in the stack to be able to
> have this.
>
> #-------------------------------------------------
> # http://www.zsh.org/mla/users/2006/msg00173.html
> # Adding a (rather primitive) dirstack history
> DIRSTACKSIZE=20
> if [[ -f ~/.zdirs ]] && [[ ${#dirstack[*]} -eq 0 ]]; then
>     dirstack=( ${(uf)"$(< ~/.zdirs)"} )
>     # "cd -" won't work after login by just setting $OLDPWD, so
>     cd $dirstack[0] && cd - > /dev/null
> fi
> chpwd() { dirs -pl >! ~/.zdirs }
> #-------------------------------------------------
>
> My 2 cents on the topic....
>
> Cheers,
> --
> Francisco Borges
>
>

