From zsh-users-return-13907-mason-zsh=primenet.com.au@sunsite.dk Sat Mar 14 17:29:29 2009
Return-Path: <zsh-users-return-13907-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25331 invoked from network); 14 Mar 2009 17:29:14 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Mar 2009 17:29:14 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 14239 invoked from network); 14 Mar 2009 17:26:57 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Mar 2009 17:26:57 -0000
Received: (qmail 15595 invoked by alias); 14 Mar 2009 17:26:39 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13907
Received: (qmail 15579 invoked from network); 14 Mar 2009 17:26:39 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 14 Mar 2009 17:26:39 -0000
Received: from vms173009pub.verizon.net (vms173009pub.verizon.net [206.46.173.9])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 4FD0680307F8
	for <zsh-users@sunsite.dk>; Sat, 14 Mar 2009 18:26:36 +0100 (CET)
Received: from torch.brasslantern.com ([96.249.201.13])
 by vms173009.mailsrvcs.net
 (Sun Java(tm) System Messaging Server 6.3-7.04 (built Sep 26 2008; 32bit))
 with ESMTPA id <0KGI00H3GB3WAN8A@vms173009.mailsrvcs.net> for
 zsh-users@sunsite.dk; Sat, 14 Mar 2009 12:26:25 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n2EHQJvJ012377	for
 <zsh-users@sunsite.dk>; Sat, 14 Mar 2009 10:26:19 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n2EHQIND012376	for zsh-users@sunsite.dk; Sat,
 14 Mar 2009 10:26:18 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <090314102618.ZM12375@torch.brasslantern.com>
Date: Sat, 14 Mar 2009 10:26:18 -0700
In-reply-to: <20090314081817.60846.qmail@smasher.org>
Comments: In reply to Atom Smasher <atom@smasher.org>
 "background job status update" (Mar 14,  9:18pm)
References: <20090314081817.60846.qmail@smasher.org>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: zsh-users@sunsite.dk
Subject: Re: background job status update
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii
X-Virus-Scanned: ClamAV 0.92.1/9107/Sat Mar 14 06:25:15 2009 on bifrost
X-Virus-Status: Clean

On Mar 14,  9:18pm, Atom Smasher wrote:
} Subject: background job status update
}
} if i start a job in the background such as:
}  	sleep 30 &
}   i get a status report sent to stderr as expected:
}  	[1] 1234
}   but when the job exits, i get this to my terminal:
}  	[1]  + done       sleep 30
} 
} i would expect both of those messages to be sent to stderr.

Funny, I'd expect both to be sent to the terminal.

The problem is that spawnjob() doesn't go through printjob() to format
the output of "[1] 1234" (silly aside: as I was testing this, process
IDs on my machine passed through "12345") and instead simply writes
directly to stderr.  I think at the very least it should be using the
special shout (shell output) file pointer, which is what printjob()
does during all job control operations thereafter.

I'm not sure why it doesn't just use printjob(); probably historic from
when both of those functions were simpler.

} why is the 
} second message sent to my terminal? how can i direct it to stderr?

You can't.

All you can do is suppress it by unsetopt monitor or by starting the
background job in a subshell, or delay it by unsetopt notify.

