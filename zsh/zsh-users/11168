From zsh-users-return-11168-mason-zsh=primenet.com.au@sunsite.dk Wed Jan 31 21:04:58 2007
Return-Path: <zsh-users-return-11168-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25537 invoked from network); 31 Jan 2007 21:04:53 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 31 Jan 2007 21:04:53 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 24979 invoked from network); 31 Jan 2007 21:04:45 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 31 Jan 2007 21:04:45 -0000
Received: (qmail 822 invoked by alias); 31 Jan 2007 21:04:37 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11168
Received: (qmail 812 invoked from network); 31 Jan 2007 21:04:36 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 31 Jan 2007 21:04:36 -0000
Received: (qmail 23895 invoked from network); 31 Jan 2007 21:04:36 -0000
Received: from smtpout0191.sc1.he.tucows.com (HELO n064.sc1.he.tucows.com) (64.97.136.191)
  by a.mx.sunsite.dk with SMTP; 31 Jan 2007 21:04:29 -0000
Received: from sc.homeunix.net (82.26.163.123) by n064.sc1.he.tucows.com (7.2.069.1)
        id 45B641500009F2F0; Wed, 31 Jan 2007 21:03:53 +0000
Received: from chazelas by sc.homeunix.net with local (Exim 3.36 #1 (Debian))
	id 1HCMcM-0003jK-00; Wed, 31 Jan 2007 21:03:46 +0000
Date: Wed, 31 Jan 2007 21:03:46 +0000
From: Stephane Chazelas <Stephane_Chazelas@yahoo.fr>
To: Daniel Qarras <dqarras@yahoo.com>
Cc: Zsh Users List <zsh-users@sunsite.dk>
Subject: Re: zsh handling of non-standard if-evaluations
Message-ID: <20070131210345.GB9255@sc.homeunix.net>
Mail-Followup-To: Daniel Qarras <dqarras@yahoo.com>,
	Zsh Users List <zsh-users@sunsite.dk>
References: <20070131172324.GA9255@sc.homeunix.net> <388703.9886.qm@web36811.mail.mud.yahoo.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <388703.9886.qm@web36811.mail.mud.yahoo.com>
User-Agent: Mutt/1.5.6i
Sender: Stephane Chazelas <stephane_chazelas@yahoo.fr>

On Wed, Jan 31, 2007 at 11:37:45AM -0800, Daniel Qarras wrote:
> Hi,
> 
> I'm asking this silly question off-line..
> 
> > In anycase, there's no much point using typeset or set or
> > non-Bourne syntax in /etc/profile (though you sometimes find
> > things like export var=value which is not Bourne and interpreted
> > differently by bash/ksh/pdksh/zsh).
> 
> Do you mean that these are different:
> 
> var=value
> export val
> 
> and
> 
> export var=value
> 
> ?
> 
> I've always wondered why people use that two-line version if the
> one-line version does excatly the same thing, would this be the
> explanation?
[...]

I beleive they use the two line versions for backward
compatibility. The Bourne shell doesn't know about the one line
one which was introduced by ksh.

It's important to know that

export var=value

does two things: assign a value to a shell variable, and mark
that variable for export. Some people just think export is the
command to assign shell variable and just litter the environment
of the commands they run. You only put in the environment
variables that may be useful to commands that you *execute* or
any of the ones they may execute themselves.

But what I was thinking of is that

the "export" command  is not parsed the same by bash and zsh for
instance. Not even by AT&T ksh and pdksh.

In pdksh and zsh, it is parsed just as any other simple command
(as POSIX would seem to require)

That's why for instance.

export var=$other_var

is not correct (in sh emulation for zsh) because the expansion
of $other_var is subject to word splitting and filename
expansion, so must be quoted as in any other command:

export "var=$other_var"

While in bash or AT&T ksh, it's very unclear how it is parsed
(and same goes for their declare/typeset...), it's a bit like a
builtin command and an assignment flag at the same time.

For instance, you can do

var="a *"
export $var

and that will export the "a" variable and one variable per file
in the current directory.

you can even do

export a=(1 2)

without getting a syntax error (while echo a=(1 2) gives you
one).

var="a=A B"
export $var

will export a=A and B while

var="A B"
export a=$var
will export a='A B'

...

-- 
Stéphane

