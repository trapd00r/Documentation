From zsh-workers-return-8079-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Sep 27 22:07:09 1999
Return-Path: <zsh-workers-return-8079-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23417 invoked from network); 27 Sep 1999 22:07:08 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Sep 1999 22:07:08 -0000
Received: (qmail 25649 invoked by alias); 27 Sep 1999 22:07:00 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8079
Received: (qmail 25642 invoked from network); 27 Sep 1999 22:06:59 -0000
Date: Mon, 27 Sep 1999 17:06:47 -0500
From: Dan Nelson <dnelson@emsphone.com>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: Juhapekka Tolvanen <juhtolv@st.jyu.fi>, zsh-workers@sunsite.auc.dk
Subject: Re: Weird behaviour with certain PS1-sequences
Message-ID: <19990927170647.A5674@dan.emsphone.com>
References: <Pine.LNX.4.10.9909272206190.23771-100000@verso.st.jyu.fi> <990927195733.ZM17681@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0pre2i
In-Reply-To: <990927195733.ZM17681@candle.brasslantern.com>
X-OS: FreeBSD 4.0-CURRENT

In the last episode (Sep 27), Bart Schaefer said:
> On Sep 27, 10:14pm, Juhapekka Tolvanen wrote:
> > If I have this in .zshrc or give this in command line, shell goes
> > to endless loop. Terminal is all blank and Ctrl-c and Ctrl-z does
> > not help at all.
> > 
> > export PS1='%h|%l|%n@%m:%/ %# '
> 
> I can't reproduce this on Linux.  I've tried various prompt-related
> setopts with no change in the behavior.

I can reproduce this easily with zsh 3.0.6 or 3.1.6 on FreeBSD (2.2.6
and 4.0).  The TERM variable has to be set to a 'dumb'-style terminal,
or blank.  I thought I could reproduce it on Solaris 2.6 but it doesn't
seem to be cooperating right now.

% zsh -f
% PROMPT="%m %n %/ %%"
dan dan /home/dan % TERM=dumb
dan dan /home/dan % 
                    ^ blanks start here and don't stop

Oddly enough, "%m%n%/" doesn't trigger the bug. "%m  %n" does. "%m %n"
does not.

Termcap entry for 'dumb':

dumb|un|unknown:am:co#80:do=^J:

-- 
	Dan Nelson
	dnelson@emsphone.com

