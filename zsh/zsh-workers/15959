From zsh-workers-return-15959-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 08 00:28:29 2001
Return-Path: <zsh-workers-return-15959-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2162 invoked from network); 8 Oct 2001 00:28:29 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Oct 2001 00:28:29 -0000
Received: (qmail 14661 invoked by alias); 8 Oct 2001 00:28:23 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15959
Received: (qmail 14648 invoked from network); 8 Oct 2001 00:28:22 -0000
User-Agent: Microsoft-Entourage/9.0.1.3108
Date: Sun, 07 Oct 2001 17:28:17 -0700
Subject: Re: zsh 4.0.2 (powerpc-apple-darwin1.4)
From: Chris Gehlker <gehlker@fastq.com>
To: Zefram <zefram@fysh.org>
CC: <zsh-workers@sunsite.dk>
Message-ID: <B7E64131.1E52C%gehlker@fastq.com>
In-Reply-To: <20011008001533.A7577@fysh.org>
Mime-version: 1.0
Content-type: text/plain; charset="US-ASCII"
Content-transfer-encoding: 7bit

On 10/7/01 4:15 PM, "Zefram" <zefram@fysh.org> wrote:

>>> configure goes to some effort to avoid using the -s flag where that
>>> wouldn't work.
> 
> But it only makes that effort when it's likely to need it, which is when
> it's doing dynamic module loading.  The configure output you provided
> showed that it didn't find any dynamic linking facilities that it
> could use.
> 
> Why did you have to remove the -s flags?  With -s left in, did it fail
> to build, or did you get an executable that didn't work?  What error
> messages were produced?

The compiler barfed on the -s. It produced pages of output without so much
as a warning. Then, as you  can see below, it hit the -s and stopped with an
error message. I'm pasting the last  few lines of make's output below. The
rest looks uninteresting but I'll send it if you want.


cc -c -I.  -DHAVE_CONFIG_H -Wall -Wno-implicit -Wmissing-prototypes -O2 -o
main.o ./main.c
( echo '#!'; cat builtin.syms compat.syms cond.syms exec.syms glob.syms
hashtable.syms hist.syms init.syms input.syms jobs.syms lex.syms
linklist.syms loop.syms math.syms mem.syms module.syms options.syms
params.syms parse.syms pattern.syms prompt.syms signals.syms signames.syms
string.syms subst.syms text.syms utils.syms watch.syms  | sed -n
'/^X/{s/^X//;p;}' | sort -u ) > zsh.export
rm -f zsh
cc  -s  -o zsh main.o  `cat stamp-modobjs`   -lm  -lc
/usr/bin/ld: warning unused multiple definitions of symbol _glob
glob.o definition of _glob in section (__TEXT,__text)
/usr/lib/libm.dylib(glob.o) unused definition of _glob
/usr/bin/ld: can't use -s with input files containg indirect symbols (output
file must contain at least global symbols, for maximum stripping use -x)
make[1]: *** [zsh] Error 1
make: *** [all] Error 1

The compiler docs say it's GNU 2.7.2 with certain extensions to support
Objective C and AltiVec instructions.

As always, feel free to ask if I can provide more help.

-Chris
-- 
Adults are obsolete children.
-Dr. Seuss, humorist, illustrator, and author (1904-1991)


