From zsh-users-return-2211-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Mar 11 08:34:00 1999
Return-Path: <zsh-users-return-2211-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16672 invoked from network); 11 Mar 1999 08:33:58 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 11 Mar 1999 08:33:58 -0000
Received: (qmail 16352 invoked by alias); 11 Mar 1999 08:33:03 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 2211
Received: (qmail 16343 invoked from network); 11 Mar 1999 08:33:02 -0000
Date: Thu, 11 Mar 1999 09:32:56 +0100 (MET)
Message-Id: <199903110832.JAA17980@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-users@sunsite.auc.dk
In-reply-to: mason@primenet.com.au's message of 11 Mar 1999 01:48:29 GMT
Subject: Re: how does setopt -m work?


mason@primenet.com.au wrote:

> Sweth Chandramouli <sweth@astaroth.nit.gwu.edu> typed:
> :	the subject pretty much says it all; what am i missing
> :here:
> :(astaroth/2)~: setopt -m "auto_r*"
> :(astaroth/3)~: setopt 
> :interactive
> :monitor
> :norcs
> :shinstdin
> :zle
> 
> It's probably a bug that it doesn't rip out the underscores when
> doing its matching.  ``setopt -m "autor*"'' will work.  The other
> thing to check would be case sensitivity.

Maybe, yes.

Bye
 Sven

--- os/options.c	Mon Mar  8 09:06:26 1999
+++ Src/options.c	Thu Mar 11 09:29:20 1999
@@ -522,11 +522,20 @@
 	/* Globbing option (-m) set. */
 	while (*args) {
 	    Comp com;
+	    char *s, *t;
+
+	    t = p = dupstring(*args);
+	    while (*t)
+		if (*t == '_')
+		    chuck(t);
+		else {
+		    *t = tulower(*t);
+		    t++;
+		}
 
 	    /* Expand the current arg. */
-	    tokenize(*args);
-	    if (!(com = parsereg(*args))) {
-		untokenize(*args);
+	    tokenize(s);
+	    if (!(com = parsereg(s))) {
 		zwarnnam(nam, "bad pattern: %s", *args, 0);
 		continue;
 	    }

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

