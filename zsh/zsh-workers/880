From hzoli@cs.elte.hu Sun Mar 31 09:59:43 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id JAA09196 for <mason@werple.mira.net.au>; Sun, 31 Mar 1996 09:59:41 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id SAA16606; Sat, 30 Mar 1996 18:48:13 -0500 (EST)
Resent-Date: Sat, 30 Mar 1996 18:48:13 -0500 (EST)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199603302237.XAA01310@hzoli.ppp.cs.elte.hu>
Subject: compctl -x 'n[-1,*]' bugfix
To: zsh-workers@math.gatech.edu (Zsh hacking and development)
Date: Sat, 30 Mar 1996 23:37:19 +0100 (MET)
X-Mailer: ELM [version 2.4ME+ PL11 (25)]
MIME-Version: 1.0
Content-Type: application/pgp; format=text; x-action=sign
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"DT4ky2.0.O34.yWSNn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/880
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1767
Status: O

-----BEGIN PGP SIGNED MESSAGE-----

% compctl -x 'n[-1,*]' -f -- foo
% foo bar\*@_<TAB>

will complete all files from the current directory, ignoring the `@'
character (or any other character after the `*').

This fix is already contained in beta13-hzoli13.

Bye,

Zoltan

 rcsdiff -qc -kk -r1.22 -r1.23 zle_tricky.c
 *** zle_tricky.c
 --- zle_tricky.c	1996/03/05 00:19:30	1.23
 ***************
 *** 1586,1602 ****
   
   /**/
   int
 ! getcpat(char *str, int cpatindex, char *cpat, int class)
   {
 !     char *s, *t, *p;
       int d = 0;
   
 !     if (!str || !*str)
   	return -1;
   
       cpat = rembslash(cpat);
   
 !     str = ztrdup(str);
       untokenize(str);
       if (!cpatindex)
   	cpatindex++, d = 0;
 --- 1586,1602 ----
   
   /**/
   int
 ! getcpat(char *wrd, int cpatindex, char *cpat, int class)
   {
 !     char *str, *s, *t, *p;
       int d = 0;
   
 !     if (!wrd || !*wrd)
   	return -1;
   
       cpat = rembslash(cpat);
   
 !     str = ztrdup(wrd);
       untokenize(str);
       if (!cpatindex)
   	cpatindex++, d = 0;
 ***************
 *** 1617,1623 ****
   	}
   	if (!class && !*p && !--cpatindex) {
   	    zsfree(str);
 ! 	    return (int)(t - str);
   	}
       }
       zsfree(str);
 --- 1617,1627 ----
   	}
   	if (!class && !*p && !--cpatindex) {
   	    zsfree(str);
 ! 	    t += wrd - str;
 ! 	    for (d = 0; --t >= wrd;)
 ! 		if (! INULL(*t))
 ! 		    d++;
 ! 	    return d;
   	}
       }
       zsfree(str);

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3i
Charset: noconv

iQCUAwUBMV23mgupSCiLN749AQFcJgP4iuLHDCC2FDjRXZCCK9/xYC9J451Uuqty
f1wRyrFa6Y4GtNYP8f5YEgPdxQ0YM0sXqwxArpWCn4holxeL/iG4chfFVbUc+QMy
AeClPjoJxMlg84GwrQyZqPy4XbzMJLPwskE9HLLWlk6h+xzf2JCVHS9PjvwaFD7g
lRTCuEg3yg==
=dfzR
-----END PGP SIGNATURE-----
