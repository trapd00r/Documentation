From zsh-workers-request@euclid.skiles.gatech.edu Thu Feb 27 17:45:01 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 13590 invoked from network); 27 Feb 1997 17:44:59 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 27 Feb 1997 17:44:59 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id MAA17047; Thu, 27 Feb 1997 12:29:00 -0500 (EST)
Resent-Date: Thu, 27 Feb 1997 12:28:11 -0500 (EST)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <970227093554.ZM19634@candle.brasslantern.com>
Date: Thu, 27 Feb 1997 09:35:54 -0800
In-Reply-To: "Alain Caron" <alainc@nortel.ca>
        "Re: problem with GNU Emacs shell mode" (Feb 27,  9:37am)
References: <199702271502.KAA09977@euclid.skiles.gatech.edu>
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: "Alain Caron" <alainc@nortel.ca>, zsh-users@math.gatech.edu
Subject: Re: problem with GNU Emacs shell mode
Cc: jrj@chsft.com
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"eREpF2.0.F94.hGS5p"@euclid>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/726
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Feb 27,  9:37am, Alain Caron wrote:
} Subject: Re: problem with GNU Emacs shell mode
}
} Emacs sets the EMACS environment variable to "t" in shell buffers.
} 
} Maybe ZSH should also kick its "I'm-inside-emacs" initialization when
} the EMACS variable is set to "t".

This might be good, but how do we decide whether to do it when EMACS
is set to something other than `t'?

Terminal mode sets the EMACS variable to the emacs version number plus
the term-mode version number, and sets the terminal type to "eterm".
The eterm type works better when zle is off, too (but a better fix is
to reset TERM=vt100 and leave zle on).

} Another solution, is to put sthe following in your .zshrc
} 
} if [[ "$EMACS" == "t" ]]; then
} 
}   # initialization for an emacs shell-buffer
} 
}   unsetopt zle
}   ...
} 
} fi
} 
} I prefer this solution to the ones you proposed but this probably is a
} matter of taste.

I prefer the pre-startup reset of TERM only because zsh might change to
do or require something in addition to unset zle when running inside emacs
(e.g., it would be nice if zsh knew not to print ^G characters in its
correction prompts, and not to expect cbreak mode to work -- but those
restrictions don't apply to term-mode).

-- 
Bart Schaefer                             Brass Lantern Enterprises
http://www.well.com/user/barts            http://www.nbn.com/people/lantern

