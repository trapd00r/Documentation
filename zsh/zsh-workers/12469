From zsh-workers-return-12469-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Aug 01 17:04:50 2000
Return-Path: <zsh-workers-return-12469-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5448 invoked from network); 1 Aug 2000 17:04:48 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Aug 2000 17:04:48 -0000
Received: (qmail 5955 invoked by alias); 1 Aug 2000 17:03:45 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12469
Received: (qmail 5840 invoked from network); 1 Aug 2000 17:03:43 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000801170332.ZM30820@candle.brasslantern.com>
Date: Tue, 1 Aug 2000 17:03:32 +0000
In-Reply-To: <20000801173152.A9212@thelonious.new.ox.ac.uk>
Comments: In reply to Adam Spiers <adam@spiers.net>
        "PATCH: completion caching layer" (Aug  1,  5:31pm)
References: <200007270800.KAA15656@beta.informatik.hu-berlin.de> 
	<20000801173152.A9212@thelonious.new.ox.ac.uk>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Adam Spiers <adam@spiers.net>, zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: completion caching layer
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Aug 1,  5:31pm, Adam Spiers wrote:
} Subject: PATCH: completion caching layer
}
} +findex(_retrieve_cache)
} +item(tt(_retrieve_cache) var(cache_identifier))(
} +This function retrieves completion information from the file given by
} +var(cache_identifier), stored in a directory specified by the
} +tt(cache-path) style (defaults to tt(~/.zsh/cache)).

I'd prefer that the cache location be relative to $ZDOTDIR rather than
relative to $HOME, and that it not be two levels removed, e.g. use
$ZDODTIR/.zcompcache/ rather than ~/.zsh/cache/.  That'd be consistent
with e.g. .zcompdump.

(Also, selfishly, I'm already using ~/.zsh/ for something else and I don't
want this stepping in it.)

} +  # grr, doesn't work, so we have to roll our own
} +#  typeset "$@[2,-1]" > "$_cache_dir/$_cache_ident"

Isn't

    typeset +g "$@[2,-1]" > "$_cache_dir/$_cache_ident"

what you want?  Or maybe

    while (($# > 1)); do
      shift
      ${(P)=1:+typeset $1}
    done > "$_cache_dir/$_cache_ident"

would be more accurate?

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

