Delivered-To: mason-zsh@primenet.com.au
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <990130101934.ZM12642@candle.brasslantern.com>
Date: Sat, 30 Jan 1999 10:19:34 -0800
In-Reply-To: <9901301316.AA64877@ibmth.df.unipi.it>
Comments: In reply to Peter Stephenson <pws@ibmth.df.unipi.it>
        "PATCH: 3.1.5-pws-5++: typeset -T fixlet" (Jan 30,  2:16pm)
References: <9901301316.AA64877@ibmth.df.unipi.it>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Peter Stephenson <pws@ibmth.df.unipi.it>,
        zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: PATCH: 3.1.5-pws-5++: typeset -T fixlet
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailing-List: <zsh-workers@sunsite.auc.dk> 5124

On Jan 30,  2:16pm, Peter Stephenson wrote:
} Subject: PATCH: 3.1.5-pws-5++: typeset -T fixlet
}
} --- Src/params.c.tied2	Fri Jan 29 17:36:10 1999
} +++ Src/params.c	Sat Jan 30 14:02:11 1999
} @@ -1501,7 +1501,7 @@
}  	if (!(v = getvalue(&s, 1)))
}  	    createparam(t, PM_SCALAR);
}  	else if (PM_TYPE(v->pm->flags) == PM_ARRAY &&
} -		 !(v->pm->flags & PM_SPECIAL) && unset(KSHARRAYS)) {
} +		 !(v->pm->flags & (PM_SPECIAL|PM_TIED)) && unset(KSHARRAYS)) {
}  	    unsetparam(t);
}  	    createparam(t, PM_SCALAR);
}  	    v = NULL;

This hunk failed for me because Peter's copy of the source STILL doesn't
have the change from

 	else if (PM_TYPE(v->pm->flags) == PM_ARRAY &&
to
 	else if ((PM_TYPE(v->pm->flags) & (PM_ARRAY|PM_HASHED)) &&

Peter, is there some reason you keep leaving this out?  I keep sending
patches for it every time you do another -pws-N release, but it never
makes it into your source code.  If it'd be wrong for some reason, I'd
sure like to know why.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

