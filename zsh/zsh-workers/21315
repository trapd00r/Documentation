From zsh-workers-return-21315-mason-zsh=primenet.com.au@sunsite.dk Tue Jun 07 14:39:27 2005
Return-Path: <zsh-workers-return-21315-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27236 invoked from network); 7 Jun 2005 14:39:25 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Jun 2005 14:39:25 -0000
Received: (qmail 86011 invoked from network); 7 Jun 2005 14:39:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Jun 2005 14:39:19 -0000
Received: (qmail 4752 invoked by alias); 7 Jun 2005 14:39:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21315
Received: (qmail 4743 invoked from network); 7 Jun 2005 14:39:13 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Jun 2005 14:39:13 -0000
Received: (qmail 85618 invoked from network); 7 Jun 2005 14:39:13 -0000
Received: from cluster-e.mailcontrol.com (HELO rly16e.srv.mailcontrol.com) (217.79.216.190)
  by a.mx.sunsite.dk with SMTP; 7 Jun 2005 14:39:04 -0000
Received: from iris.logica.co.uk (iris.logica.co.uk [158.234.9.163])
	by rly16e.srv.mailcontrol.com (MailControl) with ESMTP id j57Ecte5023305
	for <zsh-workers@sunsite.dk>; Tue, 7 Jun 2005 15:38:55 +0100
Received: from trentino.logica.co.uk ([158.234.142.59])
	by iris.logica.co.uk (8.12.3/8.12.3/Debian -4) with ESMTP id j57EcsKM000931
	for <zsh-workers@sunsite.dk>; Tue, 7 Jun 2005 15:38:55 +0100
Received: from trentino.groupinfra.com (localhost [127.0.0.1])
	by trentino.logica.co.uk (Postfix) with ESMTP id 96B8848809
	for <zsh-workers@sunsite.dk>; Tue,  7 Jun 2005 16:38:54 +0200 (CEST)
X-VirusChecked: Checked
X-StarScan-Version: 5.0.7; banners=.,-,-
In-reply-to: <2817.1117730651@trentino.groupinfra.com> 
From: Oliver Kiddle <okiddle@yahoo.co.uk>
References: <20050602132519.GA10266@localhost.localdomain> <1050602152831.ZM12324@candle.brasslantern.com> <2817.1117730651@trentino.groupinfra.com>
To: zsh-workers@sunsite.dk
Subject: Re: PATCH: expl not always local 
Date: Tue, 07 Jun 2005 16:38:53 +0200
Message-ID: <23330.1118155133@trentino.groupinfra.com>
X-Scanned-By: MailControl A-05-01-01 (www.mailcontrol.com)
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-1.5 required=6.0 tests=AWL,BAYES_00,LONGWORDS 
	autolearn=no version=3.0.2
X-Spam-Hits: -1.5

On 2 Jun, I wrote:
> These various type functions should do stuff like the following:
> 
>   local expl
>   _wanted things expl 'thing' compadd -a "$@" - things
> 
> Note the single `-' after the "$@". That ensures that any passed
> explanation takes precendence over the one defined here ("thing"). Many
> of the functions don't do that however. In part because the single dash
> feature wasn't there originally.

I've gone through all the Type/ functions and fixed them in this
respect. I've also searched through the many calling functions to check
that they all pass sane descriptions to the modified Type/ functions.
Mostly they do: many of the fixes just change a description from plural
to singular form.

Oliver

Index: Completion/AIX/Command/_floppy
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Command/_floppy,v
retrieving revision 1.1
diff -u -r1.1 _floppy
--- Completion/AIX/Command/_floppy	2 Apr 2001 12:18:35 -0000	1.1
+++ Completion/AIX/Command/_floppy	7 Jun 2005 14:20:20 -0000
@@ -2,4 +2,4 @@
 
 local expl
 
-_wanted floppyfiles expl 'files on floppy' compadd - ${$(dosdir)[1,-5]:l}
+_wanted floppyfiles expl 'file on floppy' compadd - ${$(dosdir)[1,-5]:l}
Index: Completion/AIX/Command/_lsdev
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Command/_lsdev,v
retrieving revision 1.1
diff -u -r1.1 _lsdev
--- Completion/AIX/Command/_lsdev	2 Apr 2001 12:19:08 -0000	1.1
+++ Completion/AIX/Command/_lsdev	7 Jun 2005 14:20:20 -0000
@@ -5,33 +5,33 @@
 _arguments -C \
   '(-P)-C[list info about device in customized devices object class]' \
   '(-C -l)-P[list info about device in predefined object class]' \
-  '-c[specify a device class]:device class:->class' \
-  '-f[read flags from file]:files:_files' \
-  '-F[specify output format]:format:->columnname' \
+  '-c[specify a device class]:device class:->classes' \
+  '-f[read flags from file]:file:_files' \
+  '-F[specify output format]:format:->columnnames' \
   '-H[display headers above columns]' \
   '-h[display command usage]' \
   '(-P)-l[specify device logical name]:device logical name' \
-  '-r[display set of values in a column]:columnname:->columnname' \
+  '-r[display set of values in a column]:column name:->columnnames' \
   '(-P)-S[specify a device state]:device state:(Available Defined Stopped)' \
-  '-s[specify a device subclass]:device subclass:->subclass' \
-  '-t[specify a device type name]:device type name:->devtype' && return 0
+  '-s[specify a device subclass]:device subclass:->subclasses' \
+  '-t[specify a device type name]:device type name:->devtypes' && return 0
 
 case $state in
-  class)
-    _wanted devclass expl 'device class names' \
+  classes)
+    _wanted devclasses expl 'device class name' \
         compadd - $(lsdev ${words[(r)-[CP]]:--P} -r class)
   ;;
-  subclass)
-    _wanted devsubclass expl 'device subclass names' \
+  subclasses)
+    _wanted devsubclasses expl 'device subclass name' \
         compadd - $(lsdev ${words[(r)-[CP]]:--P} -r subclass)
   ;;
-  devtype)
-    _wanted devtype expl 'device type names' \
+  devtypes)
+    _wanted devtypes expl 'device type name' \
         compadd - $(lsdev ${words[(r)-[CP]]:--P} -r type)
   ;;
-  columnname)
+  columnnames)
     [[ $words[CURRENT-1] = -F ]] && compset -P '*[^a-zA-Z]'
-    _wanted devcolumnname expl 'column names' \
+    _wanted devcolumnnames expl 'column name' \
         compadd - ${(s: :)words[(r)-C]:+name status location} \
 	  class subclass description type
   ;;
Index: Completion/AIX/Command/_lslv
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Command/_lslv,v
retrieving revision 1.1
diff -u -r1.1 _lslv
--- Completion/AIX/Command/_lslv	2 Apr 2001 12:19:25 -0000	1.1
+++ Completion/AIX/Command/_lslv	7 Jun 2005 14:20:20 -0000
@@ -5,4 +5,4 @@
   '(-p)-l[list physical volumes in logical volume]' \
   '(-p)-m[list partition numbers]' \
   '-n[accesses information from the descriptor area of physical volume]:pv:_physical_volumes' \
-  '1:lv:_logical_volumes'
+  '1:lv: _logical_volumes'
Index: Completion/AIX/Command/_lsvg
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Command/_lsvg,v
retrieving revision 1.1
diff -u -r1.1 _lsvg
--- Completion/AIX/Command/_lsvg	2 Apr 2001 12:19:56 -0000	1.1
+++ Completion/AIX/Command/_lsvg	7 Jun 2005 14:20:20 -0000
@@ -7,4 +7,4 @@
   '(-o -n -M -p)-l[list logical volumes in volume group]' \
   '(-o -n -l -p)-M[list mapping of physical and logical partition numbers]' \
   '(-o -n -l -M)-p[list physical volumes used by volume group]' \
-  '*:volume groups:_volume_groups'
+  '*:volume group:_volume_groups'
Index: Completion/AIX/Type/_logical_volumes
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Type/_logical_volumes,v
retrieving revision 1.2
diff -u -r1.2 _logical_volumes
--- Completion/AIX/Type/_logical_volumes	25 Jul 2001 12:18:23 -0000	1.2
+++ Completion/AIX/Type/_logical_volumes	7 Jun 2005 14:20:20 -0000
@@ -11,5 +11,5 @@
 else
   disp=()
 fi
-_wanted logicalvolumes expl 'logical volumes' \
+_wanted logicalvolumes expl 'logical volume' \
     compadd "$disp[@]" "$@" - "$names[@]"
Index: Completion/AIX/Type/_object_classes
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Type/_object_classes,v
retrieving revision 1.2
diff -u -r1.2 _object_classes
--- Completion/AIX/Type/_object_classes	21 Jan 2004 13:53:28 -0000	1.2
+++ Completion/AIX/Type/_object_classes	7 Jun 2005 14:20:20 -0000
@@ -3,4 +3,4 @@
 local expl
 
 _wanted objectclasses expl 'object class' \
-   _files -W ${ODMDIR:-/etc/objrepos} -g '^*.vc(-.)'
+   _files -W ${ODMDIR:-/etc/objrepos} -g '^*.vc(-.)' "$@" -
Index: Completion/AIX/Type/_physical_volumes
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Type/_physical_volumes,v
retrieving revision 1.1
diff -u -r1.1 _physical_volumes
--- Completion/AIX/Type/_physical_volumes	2 Apr 2001 12:17:59 -0000	1.1
+++ Completion/AIX/Type/_physical_volumes	7 Jun 2005 14:20:20 -0000
@@ -3,4 +3,4 @@
 local expl
 
 _wanted physicalvolumes expl 'physical volume' \
-    compadd - $(lsdev -C -c disk -S a -F name)
+    compadd "$@" - $(lsdev -C -c disk -S a -F name)
Index: Completion/AIX/Type/_volume_groups
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/AIX/Type/_volume_groups,v
retrieving revision 1.1
diff -u -r1.1 _volume_groups
--- Completion/AIX/Type/_volume_groups	2 Apr 2001 12:18:15 -0000	1.1
+++ Completion/AIX/Type/_volume_groups	7 Jun 2005 14:20:20 -0000
@@ -2,4 +2,4 @@
 
 local expl
 
-_wanted physicalvolumes expl 'physical volume' compadd - $(lsvg)
+_wanted volumegroups expl 'volume group' compadd "$@" - $(lsvg)
Index: Completion/Darwin/Type/_mac_applications
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Darwin/Type/_mac_applications,v
retrieving revision 1.2
diff -u -r1.2 _mac_applications
--- Completion/Darwin/Type/_mac_applications	12 Nov 2004 11:47:42 -0000	1.2
+++ Completion/Darwin/Type/_mac_applications	7 Jun 2005 14:20:20 -0000
@@ -3,4 +3,5 @@
 _retrieve_mac_apps
 
 local expl
-_wanted commands expl 'Mac OS X application' compadd -- "${(@)${_mac_apps[@]:t}%.app}"
+_wanted commands expl 'Mac OS X application' \
+    compadd "$@" - "${(@)${_mac_apps[@]:t}%.app}"
Index: Completion/Debian/Command/_bug
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Debian/Command/_bug,v
retrieving revision 1.4
diff -u -r1.4 _bug
--- Completion/Debian/Command/_bug	31 Jul 2003 15:26:14 -0000	1.4
+++ Completion/Debian/Command/_bug	7 Jun 2005 14:20:20 -0000
@@ -14,8 +14,7 @@
   '(-B --bts)'{-B,--bts=}'[use alternate BTS]:system:(debian gnome kde tdyc kde-debian)'
   '(-l --ldap)'{-l,--ldap}'[enable LDAP support]'
   '(-l --ldap)--no-ldap[disable LDAP support]'
-  '(--http_proxy)--proxy=:proxyhost:_hosts'
-  '(--proxy)--http_proxy=:proxyhost:_hosts'
+  '(--proxy --http_proxy)'--{http_,}'proxy=:proxy host:_hosts'
 )
 
 case "$service" in
Index: Completion/Unix/Command/_gs
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_gs,v
retrieving revision 1.2
diff -u -r1.2 _gs
--- Completion/Unix/Command/_gs	16 Apr 2002 07:48:46 -0000	1.2
+++ Completion/Unix/Command/_gs	7 Jun 2005 14:20:20 -0000
@@ -15,7 +15,7 @@
     '-q[quiet startup]' \
     '-g-[set device size]:device size (<width>x<height>):' \
     '-r-[set resolution]:resolution (<val> or <x>x<y>):' \
-    '-I[add search paths]:search paths:_dir_list' \
+    '-I[add to library file search path]:directory:_dir_list' \
     \*-{d,D}'-[define name with definition]:def:->dname' \
     \*-{s,S}'-[define name with value]:def:->sname' \
     '*:PostScript or PDF file:_pspdf' && ret=0
Index: Completion/Unix/Command/_imagemagick
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_imagemagick,v
retrieving revision 1.7
diff -u -r1.7 _imagemagick
--- Completion/Unix/Command/_imagemagick	26 Feb 2004 12:57:21 -0000	1.7
+++ Completion/Unix/Command/_imagemagick	7 Jun 2005 14:20:20 -0000
@@ -49,7 +49,7 @@
       '*-filter:filter type for resizing:(Point Box Triangle Hermite Hanning Hamming Blackman Gaussian Quadratic Cubic Catrom Mitchell Lanczos Bessel Sinc)' \
       '*-flip[vertical mirror image]' \
       '*-flop[horizontal mirror image]' \
-      '*-font:_x_font' \
+      '*-font:font:_x_font' \
       '*-foreground:color:_x_color' \
       '*-frame:border dimensions (<width>x<height>+<out>+<in>)' \
       '*-gamma[gamma correction level]:gamma correction level (<n> or <red>/<green>/<blue>)' \
@@ -84,7 +84,7 @@
       '*-shared_memory' \
       '*-sharpen:sharpening factor (0.0 - 99.9%%)' \
       '*-size:image size (<width>x<height>+<offset>)' \
-      '*-text_font:_x_font' \
+      '*-text_font:font:_x_font' \
       '*-texture:background texture image:_imagemagick' \
       '*-title:image title' \
       '*-treedepth:color reduction tree depth' \
@@ -117,7 +117,7 @@
       '*-depth:image depth:(8 16)' \
       '*-display:display:_x_display' \
       '*-dither[apply dithering]' \
-      '*-font:_x_font' \
+      '*-font:font:_x_font' \
       '*-foreground:color:_x_color' \
       '*-gamma[gamma correction level]:gamma correction level (<n> or <red>/<green>/<blue>)' \
       '*+gamma[gamma correction level (don'\''t change pixels)]:gamma correction level (<n> or <red>/<green>/<blue>)' \
@@ -138,7 +138,7 @@
       '*-scenes:image scene number' \
       '*-shared_memory' \
       '*-size:image size (<width>x<height>+<offset>)' \
-      '*-text_font:_x_font' \
+      '*-text_font:font:_x_font' \
       '*-title:image title' \
       '*-treedepth:color reduction tree depth' \
       '*-trim' \
Index: Completion/Unix/Command/_java
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_java,v
retrieving revision 1.15
diff -u -r1.15 _java
--- Completion/Unix/Command/_java	20 Nov 2004 17:35:03 -0000	1.15
+++ Completion/Unix/Command/_java	7 Jun 2005 14:20:21 -0000
@@ -27,7 +27,7 @@
 
 jdb)
   jdb_args=(
-    '-host[specify hostname to connect]:hostname:_hosts'
+    '-host[specify host to connect to]:host:_hosts'
     '-password[specify password]:password:'
   )
   ;&
@@ -140,7 +140,7 @@
     '-bootclasspath[specify path for bootstrap class files]:bootstrap class path:->bootstrapclasspath' \
     '-old[generate old JDK1.0-style header files]' \
     '-force[force output]' \
-    '*:fully qualified classname:_java_class -m main ${(kv)opt_args[(i)-classpath]}' && return 0
+    '*:class:_java_class -m main ${(kv)opt_args[(i)-classpath]}' && return 0
   ;;
 
 javap)
@@ -187,7 +187,7 @@
 
 rmiregistry)
   if (( CURRENT == 2 )); then
-    _wanted ports expl 'port to listen' _ports && return
+    _wanted ports expl 'port to listen on' _ports && return
   else
     _message 'no more arguments'
   fi
Index: Completion/Unix/Command/_last
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_last,v
retrieving revision 1.1
diff -u -r1.1 _last
--- Completion/Unix/Command/_last	25 Jun 2001 18:52:14 -0000	1.1
+++ Completion/Unix/Command/_last	7 Jun 2005 14:20:21 -0000
@@ -10,8 +10,8 @@
 	'-i[display IP]' \
 	'-o[read old-format wtmp]' \
 	'-x[display shutdown/runlevel entries]' \
-	'-h[hostname]:_hosts' \
+	'-h[hostname]:host:_hosts' \
 	'-s[report duration in seconds]' \
-	'-t[tty]:tty:' \
+	'-t[tty]:tty' \
 	'-w[widen duration field]' \
 	'*:user:_users'
Index: Completion/Unix/Command/_links
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_links,v
retrieving revision 1.8
diff -u -r1.8 _links
--- Completion/Unix/Command/_links	26 Feb 2004 12:57:21 -0000	1.8
+++ Completion/Unix/Command/_links	7 Jun 2005 14:20:21 -0000
@@ -11,10 +11,10 @@
   '(-help)-driver[graphics driver to use]:graphics driver:->graphics_drivers' \
   '(-help)-dump[dump the page as pure text]' \
   '(-help)-format-cache-size[number of formatted document pages cached]:pages:' \
-  '(-help)-ftp-proxy[host and port number of the FTP proxy, or blank]:hostport:_hosts' \
+  '(-help)-ftp-proxy[specify ftp proxy server]:proxy:->proxies' \
   '(-help)-g[run in graphics mode rather than plain text mode]' \
   '-help[prints the help screen]' \
-  '(-help)-http-proxy[host and port number of the HTTP proxy, or blank]:hostport:_hosts' \
+  '(-help)-http-proxy[specify web proxy server]:proxy:->proxies' \
   '(-help)-image-cache-size[image cache memory]:kilobytes:' \
   '(-help)-max-connections[maximum number of concurrent connections]:max:' \
   '(-help)-max-connections-to-host[maximum number of concurrent connection to a given host]:max:' \
@@ -35,6 +35,15 @@
     vals=(${=${${${(f)"$(_call_program links-graphics-drivers links -driver help 2>&1)"}[-1]}//','/''}} )
     _describe -t links-graphics-drivers 'graphics driver' vals && ret=0
   ;;
+  proxies)
+    local suf=-S:
+    if compset -P '*:'; then
+      _message -e ports 'port number'
+    else
+      compset -S ':*' && suf= 
+      _hosts $suf && ret=0
+    fi
+  ;;  
 esac
 
 return ret
Index: Completion/Unix/Command/_lsof
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_lsof,v
retrieving revision 1.1
diff -u -r1.1 _lsof
--- Completion/Unix/Command/_lsof	7 Jan 2003 08:48:32 -0000	1.1
+++ Completion/Unix/Command/_lsof	7 Jun 2005 14:20:21 -0000
@@ -27,7 +27,7 @@
   '(-s)-o[list file offset]' \
   '-O[avoid overheads of bypassing potential blocking]' \
   '-P[inhibit conversion of port numbers to port names]' \
-  '-p[list files for specified processes]:processes:_pids' \
+  '-p[list files for specified processes]:process ID:_pids' \
   '-r[repeat listing endlessly]::delay (seconds)' \
   '+r[repeat listing until no files listed]::delay (seconds)' \
   '-R[list parent PID]' \
@@ -35,7 +35,7 @@
   '-S[specify timeout for kernel functions that might deadlock]:timeout (seconds)' \
   '-T[select reporting of TCP/TPI info]::info type:((q\:queue\ length\ reporting s\:state\ reporting w\:window\ size\ reporting))' \
   '(+w -w)-t[terse output]' \
-  '-u[list files owned by specified users]:user list:_users' \
+  '-u[list files owned by specified users]:user:_users -S,' \
   '-U[list Unix domain socket files]' \
   '(-)-v[list version info]' \
   '-V[indicate unsuccessfully searched for items]' \
Index: Completion/Unix/Command/_mount
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_mount,v
retrieving revision 1.20
diff -u -r1.20 _mount
--- Completion/Unix/Command/_mount	11 May 2005 09:27:10 -0000	1.20
+++ Completion/Unix/Command/_mount	7 Jun 2005 14:20:21 -0000
@@ -552,10 +552,10 @@
   irix*)
     args=( -s
       '-a[mount all filesystems in /etc/fstab]'
-      '-b[mount all filesystems in /etc/fstab except those listed]:list of directories:_dir_list -s,'
+      '-b[mount all filesystems in /etc/fstab except those listed]:mount point:_dir_list -s,'
       '-c[check any dirty filesystems before mounting]'
       "-f[fake a new /etc/mtab entry, but don't mount any filesystems]"
-      '-h[mount all filesystems associated with host]:hostnames:_hosts'
+      '-h[mount all filesystems associated with host]:host:_hosts'
       '-n[mount filesystem without making entry in /etc/mtab]'
       '-o[specify file system options]:file system option:->fsopt'
       '-p[print list of mounted filesystems in format suitable for /etc/fstab]'
@@ -681,8 +681,8 @@
     irix*)
       args=(
 	'-a[unmount all mounted file systems]'
-	'-b[unmount all filesystems in /etc/fstab except those listed]:list of directories:_dir_list -s,'
-	'-h[unmount all filesystems associated with host]:hostnames:_hosts'
+	'-b[unmount all filesystems in /etc/fstab except those listed]:mount point:_dir_list -s,'
+	'-h[unmount all filesystems associated with host]:host:_hosts'
 	'-k[kill all processes with files open on filesystems before unmounting]'
 	'-t[unmount all filesystems of specified type]:file system type:_file_systems'
 	'-v[verbose]'
@@ -709,7 +709,7 @@
 	'(*)-a[unmount all mounted file systems]'
 	'-A[unmount all mounted file systems except the root]'
 	'-f[force unmount]'
-	'-h[unmount all filesystems associated with host]:hostnames:_hosts'
+	'-h[unmount all filesystems associated with host]:host:_hosts'
 	'-t[unmount all filesystems of specified type]:file system type:->fslist'
 	'-v[verbose mode]'
 	'*:dev or dir:->udevordir'
Index: Completion/Unix/Command/_perldoc
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_perldoc,v
retrieving revision 1.3
diff -u -r1.3 _perldoc
--- Completion/Unix/Command/_perldoc	13 Feb 2004 18:42:26 -0000	1.3
+++ Completion/Unix/Command/_perldoc	7 Jun 2005 14:20:21 -0000
@@ -49,9 +49,9 @@
           _files -g "*.(pod|pm)(-.)" && ret=0
     else
       _alternative \
-	'modules:: _perl_modules' \
-	'pods:: _perl_basepods' \
-	'files:Perl modules and .pods:_files -g "*.(pod|pm)(-.)"' && ret=0
+	'modules:module: _perl_modules' \
+	'pods:base pod: _perl_basepods' \
+	'files:module or .pod file:_files -g "*.(pod|pm)(-.)"' && ret=0
     fi
   ;;
 esac
Index: Completion/Unix/Command/_user_admin
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_user_admin,v
retrieving revision 1.5
diff -u -r1.5 _user_admin
--- Completion/Unix/Command/_user_admin	31 Jul 2003 15:26:14 -0000	1.5
+++ Completion/Unix/Command/_user_admin	7 Jun 2005 14:20:21 -0000
@@ -18,7 +18,7 @@
     '(-D)-e+[specify expiration date]:expiration date (YYYY-MM-DD)'
     '(-D)-f+[specify inactive days]:inactive days'
     '(-D)-g+[initial group]:initial group:_groups'
-    '(-D)-G+[supplementary groups]:supplementary groups:_groups -S,'
+    '(-D)-G+[supplementary groups]:supplementary group:_groups -S,'
     "(-D)-s+[shell]:shell:( $shells /bin/false )"
     '(-D -M)-m[create home directory]'
     '(-D)-u[uid]:uid'
@@ -60,7 +60,7 @@
   else
     args=( $args[@]
       '-n[specify new group name]:new group name'
-      ':group name:_groups'
+      ':group:_groups'
     )
   fi
 fi
Index: Completion/Unix/Command/_yp
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_yp,v
retrieving revision 1.3
diff -u -r1.3 _yp
--- Completion/Unix/Command/_yp	16 Apr 2002 07:48:46 -0000	1.3
+++ Completion/Unix/Command/_yp	7 Jun 2005 14:20:21 -0000
@@ -1,6 +1,6 @@
 #compdef ypcat ypmatch yppasswd ypwhich ypset ypserv ypbind yppush yppoll ypxfr domainname
 
-local curcontext="$curcontext" line state ret=1
+local curcontext="$curcontext" line state expl ret=1
 typeset -A opt_args
 
 if (( ! $+_yp_cache_maps )); then
@@ -40,8 +40,8 @@
   _arguments -C \
     '(-V2)-V1[bind version 1 servers]' \
     '(-V1)-V2[bind version 2 servers]' \
-    '-d[specify domain]:domain name:' \
-    '-h[specify host]:set binding on host:_hosts' \
+    '-d[specify domain]:domain name' \
+    '-h[set NIS binding on specified host]:host:_hosts' \
     ':server:_hosts' && ret=0
     ;;
 ypserv)
@@ -64,16 +64,16 @@
 yppoll)
   _arguments -C \
     '-d[specify domain]:domain name:' \
-    '-h[specify host]:ask server on host:_hosts' \
+    '-h[ask specified yp server]:host:_hosts' \
     ':map name:->map' && ret=0
   ;;
 ypxfr)
   _arguments -C \
     '-a[specify database routines]:database routines:((b\:btree d\:dbm/ndbm h\:hash))' \
     '-f[force transfer]' \
-    '-c[don'"'"'t clear current map]' \
+    "-c[don't clear current map]" \
     '-d[specify domain]:domain name:' \
-    '-h[specify host]:get map from host:_hosts' \
+    '-h[get map from specified host instead of master]:host:_hosts' \
     '-C[call back]:transaction ID: :program number: :IP address: :port number:' \
     ':map name:->map' && ret=0
   ;;
@@ -86,8 +86,6 @@
 [[ "$state" = keymap ]] && _message -e keys 'key'
 
 if [[ "$state" = map* ]]; then
-  local expl
-
   if [[ $+opt_args[-t] -eq 0 && "$state" != maponly ]]; then
     _tags maps nicknames
   else
Index: Completion/Unix/Command/_zdump
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_zdump,v
retrieving revision 1.2
diff -u -r1.2 _zdump
--- Completion/Unix/Command/_zdump	26 Oct 2001 13:05:46 -0000	1.2
+++ Completion/Unix/Command/_zdump	7 Jun 2005 14:20:21 -0000
@@ -2,4 +2,4 @@
 
 _arguments '-v[lowest possible]' \
            '-c[cutoff]:cutoff year:' \
-           '*:timezone:_time_zone'
+           '*:time zone:_time_zone'
Index: Completion/Unix/Type/_dir_list
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_dir_list,v
retrieving revision 1.3
diff -u -r1.3 _dir_list
--- Completion/Unix/Type/_dir_list	14 Mar 2002 15:54:41 -0000	1.3
+++ Completion/Unix/Type/_dir_list	7 Jun 2005 14:20:21 -0000
@@ -4,6 +4,8 @@
 #  -s <sep> to specify the separator (default is a colon)
 #  -S       to say that the separator should be added as a suffix (instead
 #           of the default slash)
+# any description passed should apply to an individual directory and not
+# to the entire list
 
 local sep=: dosuf suf
 
@@ -24,4 +26,4 @@
   suf=()
 fi
 
-_files "$suf[@]" -r "${sep}"' /\t\t\-' -/ "$@"
+_directories "$suf[@]" -r "${sep}"' /\t\t\-' "$@"
Index: Completion/Unix/Type/_domains
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_domains,v
retrieving revision 1.1
diff -u -r1.1 _domains
--- Completion/Unix/Type/_domains	2 Apr 2001 11:37:24 -0000	1.1
+++ Completion/Unix/Type/_domains	7 Jun 2005 14:20:21 -0000
@@ -17,4 +17,4 @@
 fi
 
 _wanted domains expl domain \
-    compadd -M 'm:{a-zA-Z}={A-Za-z} r:|.=* r:|=*' "$@" -a domains
+    compadd -M 'm:{a-zA-Z}={A-Za-z} r:|.=* r:|=*' -a "$@" - domains
Index: Completion/Unix/Type/_file_systems
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_file_systems,v
retrieving revision 1.3
diff -u -r1.3 _file_systems
--- Completion/Unix/Type/_file_systems	11 May 2005 09:27:10 -0000	1.3
+++ Completion/Unix/Type/_file_systems	7 Jun 2005 14:20:21 -0000
@@ -12,7 +12,7 @@
     [[ -r /proc/filesystems ]] &&
         fss=( $fss ${$(</proc/filesystems)#nodev} )
     [[ -r /etc/filesystems ]] &&
-        fss=( $fss ${$(</etc/filesystems)#nodev} )
+        fss=( $fss ${$(</etc/filesystems)#\*} )
   ;;
   osf*) fss=( advfs ufs nfs mfs cdfs ) ;;
   solaris*) fss=( ufs nfs hsfs s5fs pcfs cachefs tmpfs ) ;;
@@ -26,7 +26,7 @@
   ;;
 esac
 
-_wanted fstypes expl 'file system type' compadd "$@" -M 'L:|no=' -a fss
+_wanted fstypes expl 'file system type' compadd "$@" -M 'L:|no=' -a "$@" - fss
 
 
  
Index: Completion/Unix/Type/_groups
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_groups,v
retrieving revision 1.4
diff -u -r1.4 _groups
--- Completion/Unix/Type/_groups	3 Mar 2004 11:05:46 -0000	1.4
+++ Completion/Unix/Type/_groups	7 Jun 2005 14:20:21 -0000
@@ -21,4 +21,4 @@
   groups=( "$_cache_groups[@]" )
 fi
 
-_wanted groups expl group compadd "$@" -a groups
+_wanted groups expl group compadd -a "$@" - groups
Index: Completion/Unix/Type/_hosts
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_hosts,v
retrieving revision 1.3
diff -u -r1.3 _hosts
--- Completion/Unix/Type/_hosts	18 Feb 2004 12:45:40 -0000	1.3
+++ Completion/Unix/Type/_hosts	7 Jun 2005 14:20:21 -0000
@@ -18,4 +18,4 @@
 fi
 
 _wanted hosts expl host \
-    compadd -M 'm:{a-zA-Z}={A-Za-z} r:|.=* r:|=*' "$@" -a hosts
+    compadd -M 'm:{a-zA-Z}={A-Za-z} r:|.=* r:|=*' -a "$@" - hosts
Index: Completion/Unix/Type/_java_class
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_java_class,v
retrieving revision 1.4
diff -u -r1.4 _java_class
--- Completion/Unix/Type/_java_class	25 Apr 2003 11:19:09 -0000	1.4
+++ Completion/Unix/Type/_java_class	7 Jun 2005 14:20:21 -0000
@@ -20,5 +20,5 @@
   fi
 done
 
-_wanted classes expl 'java class' compadd "$@" -M 'r:|.=* r:|=*' -a c
+_wanted classes expl 'java class' compadd "$@" -M 'r:|.=* r:|=*' -a - c
 
Index: Completion/Unix/Type/_locales
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_locales,v
retrieving revision 1.2
diff -u -r1.2 _locales
--- Completion/Unix/Type/_locales	12 Mar 2003 18:55:38 -0000	1.2
+++ Completion/Unix/Type/_locales	7 Jun 2005 14:20:21 -0000
@@ -9,4 +9,4 @@
   locales=( /usr/lib/locale/*(:t) )
 fi
 
-_wanted locales expl locale compadd "$@" -a locales
+_wanted locales expl locale compadd -a "$@" - locales
Index: Completion/Unix/Type/_perl_basepods
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_perl_basepods,v
retrieving revision 1.2
diff -u -r1.2 _perl_basepods
--- Completion/Unix/Type/_perl_basepods	24 Apr 2003 12:39:52 -0000	1.2
+++ Completion/Unix/Type/_perl_basepods	7 Jun 2005 14:20:21 -0000
@@ -29,4 +29,4 @@
 
 local expl
 
-_wanted pods expl 'perl base pods' compadd -a - _perl_basepods
+_wanted pods expl 'perl base pod' compadd -a "$@" - _perl_basepods
Index: Completion/Unix/Type/_perl_modules
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_perl_modules,v
retrieving revision 1.3
diff -u -r1.3 _perl_modules
--- Completion/Unix/Type/_perl_modules	14 Jan 2004 16:56:38 -0000	1.3
+++ Completion/Unix/Type/_perl_modules	7 Jun 2005 14:20:21 -0000
@@ -18,9 +18,6 @@
 #   modules which don't begin with an uppercase letter).
 
 _perl_modules () {
-  local opts
-  zparseopts -D -a opts S: q
-
   # Set a sensible default caching policy.  This has to be done inside
   # this function otherwise we wouldn't know the context for the style.
   local update_policy
@@ -87,7 +84,7 @@
 
   local expl
 
-  _wanted modules expl 'Perl modules' compadd "$opts[@]" -a $perl_modules
+  _wanted modules expl 'Perl module' compadd "$@" -a - $perl_modules
 }
 
 _perl_modules_caching_policy () {
Index: Completion/Unix/Type/_pids
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_pids,v
retrieving revision 1.2
diff -u -r1.2 _pids
--- Completion/Unix/Type/_pids	12 Mar 2003 18:55:38 -0000	1.2
+++ Completion/Unix/Type/_pids	7 Jun 2005 14:20:21 -0000
@@ -38,7 +38,7 @@
 fi
 
 _wanted processes expl 'process ID' \
-    compadd "$@" "$desc[@]" "$all[@]" -a pids && ret=0
+    compadd "$@" "$desc[@]" "$all[@]" -a - pids && ret=0
 
 if [[ -n "$all" ]]; then
   zstyle -s ":completion:${curcontext}:processes" insert-ids out || out=menu
Index: Completion/Unix/Type/_ports
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_ports,v
retrieving revision 1.1
diff -u -r1.1 _ports
--- Completion/Unix/Type/_ports	2 Apr 2001 11:40:48 -0000	1.1
+++ Completion/Unix/Type/_ports	7 Jun 2005 14:20:21 -0000
@@ -9,4 +9,4 @@
   ports=( "$_cache_ports[@]" )
 fi
 
-_wanted ports expl port compadd "$@" -a ports
+_wanted ports expl port compadd -a "$@" - ports
Index: Completion/Unix/Type/_printers
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_printers,v
retrieving revision 1.5
diff -u -r1.5 _printers
--- Completion/Unix/Type/_printers	18 Feb 2004 12:45:40 -0000	1.5
+++ Completion/Unix/Type/_printers	7 Jun 2005 14:20:21 -0000
@@ -4,7 +4,7 @@
 
 if (( $+commands[lsallq] )); then
   # Use AIX's command to list print queues
-  _wanted printers expl printer compadd $(lsallq)
+  _wanted printers expl printer compadd "$@" - $(lsallq)
   return
 fi
 
@@ -56,7 +56,7 @@
   disp=()
 fi
 _wanted printers expl printer \
-    compadd "$disp[@]" - "${(@)_lp_cache%%:*}" && return 0
+    compadd "$@" "$disp[@]" - "${(@)_lp_cache%%:*}" && return 0
 
 (( $+_lp_alias_cache )) || return 1
 
@@ -67,6 +67,6 @@
   disp=()
 fi
 _wanted printers expl printer \
-    compadd "$disp[@]" - "${(@)_lp_alias_cache%%:*}" && return 0
+    compadd "$@" "$disp[@]" - "${(@)_lp_alias_cache%%:*}" && return 0
 
 return 1
Index: Completion/Unix/Type/_services
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_services,v
retrieving revision 1.3
diff -u -r1.3 _services
--- Completion/Unix/Type/_services	15 Jan 2004 17:00:29 -0000	1.3
+++ Completion/Unix/Type/_services	7 Jun 2005 14:20:21 -0000
@@ -7,18 +7,12 @@
   alls=( ${(f)"$(LANGUAGE=C LANG=C LC_ALL=C chkconfig --list)"} )
   inits=( ${${${alls[1,(r)xinetd based*]}[1,-2]}/%[[:space:]]*/} )
   xinetds=( ${${${${alls[(r)xinetd based*,-1]}[2,-1]}/#[[:space:]]#}/%:*} )
+
+  _alternative \
+    'init:init service:compadd -a inits' \
+    'xinetd:xinetd service:compadd -a xinetds' && ret=0
 else
-  inits=( /etc/init.d/*(-*:t) )
+  _wanted services expl service compadd "$@" - /etc/init.d/*(-*:t) && ret=0
 fi
 
-_tags init xinetd
-
-while _tags; do
-  _requested init expl 'init services' \
-    compadd  -a inits && ret=0
-  _requested xinetd expl 'xinetd services' \
-    compadd  -a xinetds && ret=0
-  (( ret )) || break
-done
-
-return $ret
+return ret
Index: Completion/Unix/Type/_tex
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_tex,v
retrieving revision 1.3
diff -u -r1.3 _tex
--- Completion/Unix/Type/_tex	21 Jan 2004 13:53:29 -0000	1.3
+++ Completion/Unix/Type/_tex	7 Jun 2005 14:20:21 -0000
@@ -3,4 +3,4 @@
 local expl
 
 _description files expl 'TeX or LaTeX file'
-_files "$expl[@]" -g '*.(tex|TEX|texinfo|texi)(-.)'
+_files "$@" "$expl[@]" -g '*.(tex|TEX|texinfo|texi)(-.)'
Index: Completion/Unix/Type/_texi
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_texi,v
retrieving revision 1.2
diff -u -r1.2 _texi
--- Completion/Unix/Type/_texi	21 Jan 2004 13:53:29 -0000	1.2
+++ Completion/Unix/Type/_texi	7 Jun 2005 14:20:21 -0000
@@ -3,4 +3,4 @@
 local expl
 
 _description files expl 'texinfo file'
-_files "$expl[@]" -g '*.(texinfo|texi)(-.)'
+_files "$@" "$expl[@]" -g '*.(texinfo|texi)(-.)'
Index: Completion/Unix/Type/_time_zone
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_time_zone,v
retrieving revision 1.5
diff -u -r1.5 _time_zone
--- Completion/Unix/Type/_time_zone	13 Mar 2002 09:28:05 -0000	1.5
+++ Completion/Unix/Type/_time_zone	7 Jun 2005 14:20:21 -0000
@@ -6,4 +6,4 @@
   _zoneinfo_dirs=( /usr/{share,lib,share/lib}/{zoneinfo*,locale/TZ}(/) )
 fi
 
-_wanted time-zones expl 'time zone' _files -W _zoneinfo_dirs
+_wanted time-zones expl 'time zone' _files -W _zoneinfo_dirs "$@" -
Index: Completion/Unix/Type/_users
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_users,v
retrieving revision 1.4
diff -u -r1.4 _users
--- Completion/Unix/Type/_users	12 Mar 2003 18:55:38 -0000	1.4
+++ Completion/Unix/Type/_users	7 Jun 2005 14:20:21 -0000
@@ -3,6 +3,6 @@
 local expl users
 
 zstyle -a ":completion:${curcontext}:" users users &&
-    _wanted users expl user compadd "$@" -a users && return 0
+    _wanted users expl user compadd "$@" -a - users && return 0
 
-_wanted users expl user compadd "$@" -k userdirs
+_wanted users expl user compadd "$@" -k - userdirs
Index: Completion/X/Type/_x_cursor
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/X/Type/_x_cursor,v
retrieving revision 1.1
diff -u -r1.1 _x_cursor
--- Completion/X/Type/_x_cursor	2 Apr 2001 12:09:08 -0000	1.1
+++ Completion/X/Type/_x_cursor	7 Jun 2005 14:20:21 -0000
@@ -15,4 +15,4 @@
 fi
 
 _wanted cursors expl 'cursor name' \
-    compadd "$@" -M 'm:-=_ r:|_=*' -a _cursor_cache
+    compadd "$@" -M 'm:-=_ r:|_=*' -a - _cursor_cache
Index: Completion/X/Type/_x_extension
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/X/Type/_x_extension,v
retrieving revision 1.1
diff -u -r1.1 _x_extension
--- Completion/X/Type/_x_extension	2 Apr 2001 12:09:42 -0000	1.1
+++ Completion/X/Type/_x_extension	7 Jun 2005 14:20:21 -0000
@@ -9,11 +9,11 @@
 if [[ "$1" = -a ]]; then
   shift
 
-  _wanted extensions expl 'X extensions' \
+  _wanted extensions expl 'X extension' \
       compadd "$@" -M 'm:{a-z}={A-Z} r:|-=* r:|=*' - all "$_xe_cache[@]"
 else
   [[ "$1" = - ]] && shift
 
-  _wanted extensions expl 'X extensions' \
-      compadd "$@" -M 'm:{a-z}={A-Z} r:|-=* r:|=*' -a _xe_cache
+  _wanted extensions expl 'X extension' \
+      compadd "$@" -M 'm:{a-z}={A-Z} r:|-=* r:|=*' -a - _xe_cache
 fi
Index: Completion/X/Type/_x_font
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/X/Type/_x_font,v
retrieving revision 1.1
diff -u -r1.1 _x_font
--- Completion/X/Type/_x_font	2 Apr 2001 12:09:59 -0000	1.1
+++ Completion/X/Type/_x_font	7 Jun 2005 14:20:21 -0000
@@ -13,4 +13,4 @@
 fi
 
 _wanted fonts expl font \
-    compadd -M 'r:|-=* r:|=*' "$@" -S '' -a _font_cache
+    compadd -M 'r:|-=* r:|=*' "$@" -S '' -a - _font_cache
Index: Completion/X/Type/_x_keysym
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/X/Type/_x_keysym,v
retrieving revision 1.1
diff -u -r1.1 _x_keysym
--- Completion/X/Type/_x_keysym	2 Apr 2001 12:10:29 -0000	1.1
+++ Completion/X/Type/_x_keysym	7 Jun 2005 14:20:21 -0000
@@ -19,4 +19,4 @@
 fi
 
 _wanted keysyms expl 'key symbol' \
-    compadd "$@" -M 'm:{a-z}={A-Z} r:|-=* r:|=*' -a _keysym_cache
+    compadd "$@" -M 'm:{a-z}={A-Z} r:|-=* r:|=*' -a - _keysym_cache
Index: Completion/Zsh/Command/_print
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Command/_print,v
retrieving revision 1.3
diff -u -r1.3 _print
--- Completion/Zsh/Command/_print	22 Nov 2002 11:49:02 -0000	1.3
+++ Completion/Zsh/Command/_print	7 Jun 2005 14:20:21 -0000
@@ -25,7 +25,7 @@
   '(-n -l -N -f -s -z)-a[with -c/-C, print arguments across before down]' \
   '(-n -l -N -f -C -s -z)-c[print arguments in columns]' \
   '(-n -l -N -f -c -s -z)-C+[print arguments in specified number of columns]:columns' \
-  '(-s -p -z)-u+[specify file-descriptor to print arguments to]:file-descriptor:_file_descriptors' \
+  '(-s -p -z)-u+[specify file descriptor to print arguments to]:file descriptor:_file_descriptors' \
   '(-s -p -u)-z[push arguments onto editing buffer stack]' \
   '-D[substitute any arguments which are named directories using ~ notation]' \
   '-P[perform prompt expansion]' \
Index: Completion/Zsh/Command/_read
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Command/_read,v
retrieving revision 1.5
diff -u -r1.5 _read
--- Completion/Zsh/Command/_read	17 Feb 2003 10:08:02 -0000	1.5
+++ Completion/Zsh/Command/_read	7 Jun 2005 14:20:21 -0000
@@ -17,5 +17,5 @@
   '(-e)-E[input read is echoed]' \
   '(-q -z -p)-s[suppress terminal echoing]' \
   '-A[first name is taken as an array]' \
-  '(-q -z -p)-u+[specify file-descriptor to read from]:file-descriptor:_file_descriptors' \
+  '(-q -z -p)-u+[specify file descriptor to read from]:file descriptor:_file_descriptors' \
   $pflag '1:varprompt:_vars -qS\?' '*:vars:_vars'
Index: Completion/Zsh/Command/_unhash
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Command/_unhash,v
retrieving revision 1.2
diff -u -r1.2 _unhash
--- Completion/Zsh/Command/_unhash	3 Sep 2003 14:05:07 -0000	1.2
+++ Completion/Zsh/Command/_unhash	7 Jun 2005 14:20:21 -0000
@@ -6,7 +6,7 @@
   '(-a -f -s *)-d[remove named directories]:*:named directory:->nameddir' \
   '(-d -f -s *)-a[remove aliases]:*:alias:_aliases' \
   '(-a -d -f *)-s[remove suffix aliases]:*:suffix alias:_aliases -s s' \
-  '(-d -a -s *)-f[remove functions]:*:function:_functions' \
+  '(-d -a -s *)-f[remove functions]:*:shell function:_functions' \
   '-m[treat arguments as patterns]' \
   '(-a -d -f -m)*:command: _command_names -e' && return 0
 
Index: Completion/Zsh/Type/_arrays
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_arrays,v
retrieving revision 1.1
diff -u -r1.1 _arrays
--- Completion/Zsh/Type/_arrays	2 Apr 2001 11:18:22 -0000	1.1
+++ Completion/Zsh/Type/_arrays	7 Jun 2005 14:20:21 -0000
@@ -2,4 +2,4 @@
 
 local expl
 
-_wanted arrays expl array _parameters "$@" -g '*array*'
+_wanted arrays expl array _parameters "$@" - -g '*array*'
Index: Completion/Zsh/Type/_file_descriptors
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_file_descriptors,v
retrieving revision 1.3
diff -u -r1.3 _file_descriptors
--- Completion/Zsh/Type/_file_descriptors	19 Oct 2001 10:28:08 -0000	1.3
+++ Completion/Zsh/Type/_file_descriptors	7 Jun 2005 14:20:21 -0000
@@ -21,9 +21,9 @@
   fi
 
   if (( $list[(I)* $sep ?*] )); then
-    _wanted file-descriptors expl 'file descriptors' compadd "$@" -d list -a fds
+    _wanted file-descriptors expl 'file descriptor' compadd "$@" -d list -a - fds
     return
   fi
 fi
 
-_wanted file-descriptors expl 'file descriptors' compadd "$@" -a fds
+_wanted file-descriptors expl 'file descriptor' compadd -a "$@" - fds
Index: Completion/Zsh/Type/_functions
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_functions,v
retrieving revision 1.2
diff -u -r1.2 _functions
--- Completion/Zsh/Type/_functions	20 Apr 2004 12:11:16 -0000	1.2
+++ Completion/Zsh/Type/_functions	7 Jun 2005 14:20:21 -0000
@@ -2,4 +2,4 @@
 
 local expl
 
-_wanted functions expl 'shell function' compadd "$@" -k functions
+_wanted functions expl 'shell function' compadd -k "$@" - functions
Index: Completion/Zsh/Type/_jobs_bg
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_jobs_bg,v
retrieving revision 1.1
diff -u -r1.1 _jobs_bg
--- Completion/Zsh/Type/_jobs_bg	2 Apr 2001 11:20:53 -0000	1.1
+++ Completion/Zsh/Type/_jobs_bg	7 Jun 2005 14:20:21 -0000
@@ -1,3 +1,3 @@
 #compdef bg
 
-_jobs -s
+_jobs -s "$@"
Index: Completion/Zsh/Type/_jobs_fg
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_jobs_fg,v
retrieving revision 1.2
diff -u -r1.2 _jobs_fg
--- Completion/Zsh/Type/_jobs_fg	11 Apr 2001 21:47:18 -0000	1.2
+++ Completion/Zsh/Type/_jobs_fg	7 Jun 2005 14:20:21 -0000
@@ -1,3 +1,3 @@
 #compdef disown fg
 
-_jobs
+_jobs "$@"
Index: Completion/Zsh/Type/_limits
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_limits,v
retrieving revision 1.2
diff -u -r1.2 _limits
--- Completion/Zsh/Type/_limits	1 Nov 2001 15:41:40 -0000	1.2
+++ Completion/Zsh/Type/_limits	7 Jun 2005 14:20:21 -0000
@@ -2,4 +2,4 @@
 
 local expl
 
-_wanted limits expl 'process limits' compadd ${${(f)"$(limit)"}%% *}
+_wanted limits expl 'process limit' compadd "$@" - ${${(f)"$(limit)"}%% *}
Index: Completion/Zsh/Type/_options
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_options,v
retrieving revision 1.1
diff -u -r1.1 _options
--- Completion/Zsh/Type/_options	2 Apr 2001 11:19:47 -0000	1.1
+++ Completion/Zsh/Type/_options	7 Jun 2005 14:20:21 -0000
@@ -5,4 +5,4 @@
 local expl
 
 _wanted zsh-options expl 'zsh option' \
-    compadd "$@" -M 'B:[nN][oO]= M:_= M:{A-Z}={a-z}' -k options
+    compadd "$@" -M 'B:[nN][oO]= M:_= M:{A-Z}={a-z}' -k - options
Index: Completion/Zsh/Type/_options_set
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_options_set,v
retrieving revision 1.1
diff -u -r1.1 _options_set
--- Completion/Zsh/Type/_options_set	2 Apr 2001 11:21:27 -0000	1.1
+++ Completion/Zsh/Type/_options_set	7 Jun 2005 14:20:21 -0000
@@ -7,4 +7,4 @@
 local expl
 
 _wanted zsh-options expl 'set zsh option' \
-    compadd "$@" -M 'B:[nN][oO]= M:_= M:{A-Z}={a-z}' -a _options_set
+    compadd "$@" -M 'B:[nN][oO]= M:_= M:{A-Z}={a-z}' -a - _options_set
Index: Completion/Zsh/Type/_options_unset
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_options_unset,v
retrieving revision 1.1
diff -u -r1.1 _options_unset
--- Completion/Zsh/Type/_options_unset	2 Apr 2001 11:21:44 -0000	1.1
+++ Completion/Zsh/Type/_options_unset	7 Jun 2005 14:20:21 -0000
@@ -1,10 +1,10 @@
 #autoload
 
 # Complete all unset options. This relies on `_main_complete' to store the
-# names of the options that were set when it was called in the array
-# `_options_set'.
+# names of the options that were unset when it was called in the array
+# `_options_unset'.
 
 local expl
 
 _wanted zsh-options expl 'unset zsh option' \
-    compadd "$@" -M 'B:[nN][oO]= M:_= M:{A-Z}={a-z}' -a _options_unset
+    compadd "$@" -M 'B:[nN][oO]= M:_= M:{A-Z}={a-z}' -a - _options_unset




This e-mail and any attachment is for authorised use by the intended recipient(s) only. It may contain proprietary material, confidential information and/or be subject to legal privilege. It should not be copied, disclosed to, retained or used by, any other party. If you are not an intended recipient then please promptly delete this e-mail and any attachment and all copies and inform the sender. Thank you.

