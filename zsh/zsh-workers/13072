From zsh-workers-return-13072-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Oct 24 07:54:53 2000
Return-Path: <zsh-workers-return-13072-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17825 invoked from network); 24 Oct 2000 07:54:51 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Oct 2000 07:54:51 -0000
Received: (qmail 29781 invoked by alias); 24 Oct 2000 07:54:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13072
Received: (qmail 29774 invoked from network); 24 Oct 2000 07:54:45 -0000
Date: Tue, 24 Oct 2000 09:53:28 +0200 (MET DST)
Message-Id: <200010240753.JAA23042@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: =?iso-8859-1?Q?Thomas_K=F6hler?='s message of Mon, 23 Oct 2000
	17:12:14 +0200
Subject: Re: zsh-3.1.9-dev-6 crashes occassionally


Thomas Koehler wrote:

> ...
> 
> > > #0  0x401011cb in free () from /lib/libc.so.6
> > > (gdb) bt
> > > #0  0x401011cb in free () from /lib/libc.so.6
> > > #1  0x40101053 in free () from /lib/libc.so.6
> > > #2  0x807613e in zsfree ()
> > > #3  0x80925e3 in freearray ()
> > > #4  0x807cd66 in arrsetfn ()
> > > #5  0x807cc82 in stdunsetfn ()
> > > #6  0x807cb5a in unsetparam_pm ()
> > > #7  0x807de6d in endparamscope ()
> > > #8  0x8065a49 in scanhashtable ()
> > > #9  0x807dd8f in endparamscope ()
> > > #10 0x8060304 in runshfunc ()
> > > #11 0x4021f682 in comp_setunset () from /usr/lib/zsh/3.1.9-dev-6/zsh/co=
> mple=3D
> > > te.so
> >=20
> > Hm. This seems to suggest that there is some trouble with unsetting
> > the special completion parameters. $words, I guess. We already fixed
> > some problems with it some time ago, but that was before 3.1.9.
> >=20
> > I'll try to stare some more at the code, but can't promise anything.

After looking again: no this is probably not $words, but a normal
array (otherwise it would have called compunsetfn()).

But the whole stack trace shows that his zsh is heavily optimised
(comp_setunset() doesn't call runshfunc()), so this is little or no
help at all.

This is almost certainly a memory corruption problem, something is
writing into memory allocated for a parameter and when that parameter
is freed...

> Could my whole .zshrc be of any help?
> ~> wc -l .zshrc
>     625 .zshrc

Dunno, you can send it to me and I'll give it a try, but I don't know
when I'll find the time.


Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

