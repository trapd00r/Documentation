From zsh-workers-return-21231-mason-zsh=primenet.com.au@sunsite.dk Thu May 05 22:27:50 2005
Return-Path: <zsh-workers-return-21231-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19821 invoked from network); 5 May 2005 22:27:49 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 5 May 2005 22:27:49 -0000
Received: (qmail 46388 invoked from network); 5 May 2005 22:27:43 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 May 2005 22:27:43 -0000
Received: (qmail 7915 invoked by alias); 5 May 2005 22:27:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21231
Received: (qmail 7901 invoked from network); 5 May 2005 22:27:36 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 May 2005 22:27:36 -0000
Received: (qmail 45632 invoked from network); 5 May 2005 22:27:36 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 5 May 2005 22:27:32 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 6F30C70046; Thu,  5 May 2005 18:27:30 -0400 (EDT)
Date: Thu, 5 May 2005 18:27:30 -0400
From: Clint Adams <clint@zsh.org>
To: Jesse W <jessw@netwood.net>
Cc: zsh-workers@sunsite.dk
Subject: Re: small dpkg completion update patch
Message-ID: <20050505222730.GA27236@scowler.net>
Mail-Followup-To: Jesse W <jessw@netwood.net>, zsh-workers@sunsite.dk
References: <841710F4-BCFB-11D9-8F80-000A957CB0EE@netwood.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <841710F4-BCFB-11D9-8F80-000A957CB0EE@netwood.net>
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

> for dpkg-query evetually, so this is also sort of a training for me in 
> the process of creating and sending in patches for zsh.  If I've done 
> anything wrong, please let me know.  The patch is included below.

The changes to _dpkg are good, but your mail program seems to have
mangled the patch.  Next time you might want to try sending it as an
attachment instead of putting it inline.

Here's what I'm committing.

Index: Completion/Debian/Command/_dpkg
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Debian/Command/_dpkg,v
retrieving revision 1.11
diff -u -r1.11 _dpkg
--- Completion/Debian/Command/_dpkg	19 Apr 2005 17:01:50 -0000	1.11
+++ Completion/Debian/Command/_dpkg	5 May 2005 22:23:28 -0000
@@ -2,9 +2,14 @@
 
 local _dpkg_deb_actions _dpkg_common_actions _dpkg_actions _dpkg_options
 local _dpkg_options_recursive _dpkg_actions_install _dpkg_actions_record_avail
+local _dpkg_deb_only_actions
 local curcontext="$curcontext" context state line expl ret
 typeset -A opt_args
 
+_dpkg_deb_only_actions=(
+  '(--show -W)'{--show,-W}'[show package info]:Debian package:_files -g \*.u\#deb'
+)
+
 _dpkg_deb_actions=(
   '(--build -b)'{--build,-b}'[build archive]:directory:_files -/'
   '(--contents -c)'{--contents,-c}'[list contents]:Debian package:_files -g "*.u#deb(-.)"'
@@ -84,6 +89,7 @@
 
   dpkg-deb)
     _arguments "$_dpkg_deb_actions[@]" \
+	"$_dpkg_deb_only_actions[@]" \
 	"$_dpkg_common_actions[@]" && return 0
   ;;
   dpkg-reconfigure)

