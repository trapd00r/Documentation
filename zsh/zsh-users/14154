From zsh-users-return-14154-mason-zsh=primenet.com.au@sunsite.dk Thu May 21 10:28:50 2009
Return-Path: <zsh-users-return-14154-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11913 invoked from network); 21 May 2009 10:28:45 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 21 May 2009 10:28:45 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 77519 invoked from network); 21 May 2009 10:28:32 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 21 May 2009 10:28:32 -0000
Received: (qmail 8549 invoked by alias); 21 May 2009 10:28:14 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14154
Received: (qmail 8534 invoked from network); 21 May 2009 10:28:13 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 21 May 2009 10:28:13 -0000
Received: from atom.smasher.org (atom.smasher.org [69.55.237.145])
	by bifrost.dotsrc.org (Postfix) with SMTP id A50118027106
	for <zsh-users@sunsite.dk>; Thu, 21 May 2009 12:27:57 +0200 (CEST)
Received: (qmail 91702 invoked by uid 1000); 21 May 2009 10:27:55 -0000
Message-ID: <20090521102755.91698.qmail@smasher.org>
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
Date: Thu, 21 May 2009 22:27:53 +1200 (NZST)
From: Atom Smasher <atom@smasher.org>
In-Reply-To: <20090521074103.GN27141@prunille.vinc17.org>
MIME-Version: 1.0
OpenPGP: id=0xB88D52E4D9F57808; algo=1 (RSA); size=4096; url=http://atom.smasher.org/pgp.txt
References: <e7db6e960905190954j7be72739p6b521bca8e90fe7f@mail.gmail.com>
 <20090519200217.35368.qmail@smasher.org> <20090521074103.GN27141@prunille.vinc17.org>
Subject: Re: prompt and ssh
To: zsh-users@sunsite.dk
X-POM: The Moon is Waning Crescent (13% of Full)
X-Hashcash: 1:20:0905211027:zsh-users@sunsite.dk::zMNabFQ8o/ds6HMA:0000000000000
	0000000000000000000000000hSh
X-Virus-Scanned: ClamAV 0.94.2/9377/Thu May 21 04:57:18 2009 on bifrost
X-Virus-Status: Clean

On Thu, 21 May 2009, Vincent Lefevre wrote:

>> you can test for SSH_CONNECTION, SSH_CLIENT, or SSH_TTY on the far 
>> side. i would recommend SSH_CONNECTION.
>
> But this will not work well if you use "screen". For instance:
> 1. Connect to host remote_host by ssh.
> 2. Start a screen session. SSH_CONNECTION is inherited and the prompt
>   will say that you are connected by ssh (this is what you want).
> 3. Later, log on the machine directly (without ssh) and recall the
>   screen session. SSH_CONNECTION is still set (as the environment
>   doesn't change in the recalled shell) and the prompt will still
>   say that you are connected by ssh, while you are not.
================

that's a limitation of screen. whatever environment is available when a 
session starts will always be with that session.

you ~could~ manually un/set SSH_* and then re-source the zshrc...?


-- 
         ...atom

  ________________________
  http://atom.smasher.org/
  762A 3B98 A3C3 96C9 C6B7 582A B88D 52E4 D9F5 7808
  -------------------------------------------------

 	"Since trade ignores national boundaries and the manufacturer
 	 insists on having the world as a market, the flag of his
 	 nation must follow him, and the doors of the nations which
 	 are closed against him must be battered down. Concessions
 	 obtained by financiers must be safeguarded by ministers of
 	 state, even if the sovereignty of unwilling nations be
 	 outraged in the process. Colonies must be obtained or
 	 planted, in order that no useful corner of the world may be
 	 overlooked or left unused."
 		-- Woodrow Wilson,
 		President of the United States, 1919

