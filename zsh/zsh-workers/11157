From zsh-workers-return-11157-mason-zsh=primenet.com.au@sunsite.auc.dk Thu May 04 15:34:13 2000
Return-Path: <zsh-workers-return-11157-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5676 invoked from network); 4 May 2000 15:34:12 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 4 May 2000 15:34:12 -0000
Received: (qmail 4479 invoked by alias); 4 May 2000 15:34:01 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11157
Received: (qmail 4438 invoked from network); 4 May 2000 15:33:57 -0000
To: zsh-workers@sunsite.auc.dk
Subject: _requested problem?
MIME-Version: 1.0 (generated by SEMI 1.13.7 - "Awazu")
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@m17n.org>
Date: 05 May 2000 00:34:56 +0900
Message-ID: <hvopur2pbvj.fsf@serein.m17n.org>
Lines: 36
User-Agent: T-gnus/6.14.1 (based on Gnus v5.8.3) (revision 16) SEMI/1.13.7 (Awazu) FLIM/1.13.2 (Kasanui) Emacs/20.6 (i686-pc-linux-gnu) MULE/4.0 (HANANOEN)

Z(4):akr@serein% Src/zsh -f
serein% bindkey -e; autoload -U compinit; compinit -D; compdef _tst tst
serein% _tst () {
function> local expl ret=1
function> _tags a b 
function> while _tags; do
function while> _requested a expl aa compadd a && ret=0
function while> _requested b expl bb compadd b && ret=0
function while> (( $ret )) || break
function while> done
function> }
serein% zstyle :completion::complete:tst:: tag-order a
serein% tst b<TAB>

I think this should complete `bb' but it doesn't.

Is this fix correct?

Index: Completion/Core/_requested
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_requested,v
retrieving revision 1.4
diff -u -r1.4 _requested
--- Completion/Core/_requested	2000/04/25 11:00:06	1.4
+++ Completion/Core/_requested	2000/05/04 15:32:56
@@ -9,7 +9,7 @@
 
 if comptags -R "$1"; then
   if [[ $# -gt 3 ]]; then
-    _all_labels - "$gopt" "$@"
+    _all_labels - "$gopt" "$@" || return 1
   elif [[ $# -gt 1 ]]; then
     _description "$gopt" "$@"
   fi
-- 
Tanaka Akira

