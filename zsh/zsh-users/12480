From zsh-users-return-12480-mason-zsh=primenet.com.au@sunsite.dk Fri Jan 25 18:02:07 2008
Return-Path: <zsh-users-return-12480-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11524 invoked from network); 25 Jan 2008 18:02:05 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 25 Jan 2008 18:02:05 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 36738 invoked from network); 25 Jan 2008 18:01:38 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 25 Jan 2008 18:01:38 -0000
Received: (qmail 15189 invoked by alias); 25 Jan 2008 18:01:28 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12480
Received: (qmail 15171 invoked from network); 25 Jan 2008 18:01:27 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 25 Jan 2008 18:01:27 -0000
Received: from vms173003pub.verizon.net (vms173003pub.verizon.net [206.46.173.3])
	by bifrost.dotsrc.org (Postfix) with ESMTP id EFBFA80190F6
	for <zsh-users@sunsite.dk>; Fri, 25 Jan 2008 19:01:23 +0100 (CET)
Received: from torch.brasslantern.com ([71.121.18.67])
 by vms173003.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0JV700KRXOF91UV3@vms173003.mailsrvcs.net> for
 zsh-users@sunsite.dk; Fri, 25 Jan 2008 11:54:46 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id m0PHvXja020875; Fri,
 25 Jan 2008 09:57:34 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id m0PHvXgH020874; Fri, 25 Jan 2008 09:57:33 -0800
Date: Fri, 25 Jan 2008 09:57:33 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: idea for new feature (was: Re: sticky-note and zle bindings)
In-reply-to: <2d460de70801250132n1692f74cn78d3fdc40da88b9@mail.gmail.com>
To: "Robert Knight" <robertknight@gmail.com>, zsh-users@sunsite.dk
Message-id: <080125095733.ZM20873@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <13ed09c00801241017x1cd7c454lcbf9156b6bccd9bb@mail.gmail.com>
	<2d460de70801241209u63a33fe6ufb8f396bff440dc6@mail.gmail.com>
	<2d460de70801241254v52d8a9c4he75e450f2f2bd29e@mail.gmail.com>
	<13ed09c00801241354g306f5aaay4d9e6f22c1622ec7@mail.gmail.com>
	<2d460de70801241522y47611d27k2e60c132fea1f01d@mail.gmail.com>
	<13ed09c00801241857n2b1613f0m2d74fd12a90135cc@mail.gmail.com>
	<2d460de70801250132n1692f74cn78d3fdc40da88b9@mail.gmail.com>
Comments: In reply to "Richard Hartmann" <richih.mailinglist@gmail.com>
 "Re: idea for new feature (was: Re: sticky-note and zle bindings)" (Jan 25,
 10:32am)
X-Virus-Scanned: ClamAV 0.91.2/5550/Fri Jan 25 08:02:45 2008 on bifrost
X-Virus-Status: Clean

(I never saw the original message from Robert Knight and it's not in the
list archives.)

On Jan 25, 10:32am, Richard Hartmann wrote:
} Subject: Re: idea for new feature (was: Re: sticky-note and zle bindings)
}
} On Jan 25, 2008 3:57 AM, Robert Knight <robertknight@gmail.com> wrote:
} 
} > There is a misunderstanding.  By "end the session", I meant ending a
} > session and removing all data associated with it.  An analogy would be
} > the option not to save the tabs in a web browser when closing it.
} > Saving the session state would be the default behavior which would
} > occur when logging out of the X session or closing the shell by
} > sending SIGHUP for example.

Shells are slightly different beasts than other applications.  If I
explicitly exit from a shell, I'm done with whatever that shell was
doing, and if I were to then start a new shell I wouldn't want it to
return to the context of the the last shell I exited; the chances are
very good that the new thing I'll be doing has nothing to do with
the last thing.

OTOH if my shell *windows* in a GUI environment are disconnected, or
the shell is killed by HUP, I probably didn't intentionally exit and I'd
like the state restored, to the extent possible, when the GUI resumes.
That applies whether the GUI session is exited abnormally or when I
choose "Log Out" from a menu.

This implies that commands in the .zlogout or equivalent need to be
able to determine what caused the shell to exit:  builtin command,
user-generated EOF (ctrl-D), real EOF on stdin, HUP signal, etc.

It also implies that the shell needs a way to tell the GUI environment
NOT to attempt, independently, to restore current directory, etc.
 
} One thing that would need to be decided is which sessions to delete
} first. Oldest overall, oldest upate, smallest footprint, largest
} footprint all have their respective merrits. Probably another option

Scriptable.  Don't bother trying to define this in the shell itself.

} Another thing to note is that some people would probably want to keep
} the respective histories seperate, other would want to merge them on
} session 'detach', still others would probably want to merge the
} information on explicit session destruction.
} Option one could be done by hand by the route of
}   .zsh_history.$SHELL_SESSION_COOKIE
} the others would probably, again, need options.

Again scriptable.

See Util/reporter in the zsh source distribution for examples of how to
dump out various shell state.

