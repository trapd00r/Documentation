From zsh-users-return-6641-mason-zsh=primenet.com.au@sunsite.dk Sat Oct 04 23:18:35 2003
Return-Path: <zsh-users-return-6641-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22294 invoked from network); 4 Oct 2003 23:18:34 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 4 Oct 2003 23:18:34 -0000
Received: (qmail 9097 invoked by alias); 4 Oct 2003 23:18:20 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6641
Received: (qmail 9084 invoked from network); 4 Oct 2003 23:18:20 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 4 Oct 2003 23:18:20 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [216.27.138.216] by sunsite.dk (MessageWall 1.0.8) with SMTP; 4 Oct 2003 23:18:19 -0000
Received: from home.acholado.net (localhost.localdomain [127.0.0.1])
	by home.acholado.net (8.12.8/8.12.8) with ESMTP id h94NIJWp002368
	for <zsh-users@sunsite.dk>; Sat, 4 Oct 2003 19:18:19 -0400
Received: (from ljz@localhost)
	by home.acholado.net (8.12.8/8.12.8/Submit) id h94NIJ3k002366;
	Sat, 4 Oct 2003 19:18:19 -0400
X-Authentication-Warning: home.acholado.net: ljz set sender to ljz@asfast.com using -f
To: zsh-users@sunsite.dk
Subject: Re: Emulating 'locate'
References: <20031001221753.GA23189@DervishD>
	<1031002023639.ZM22046@candle.brasslantern.com>
	<20031002080358.GA23230@DervishD> <m365j6watm.fsf@asfast.com>
	<20031004104844.GA50@DervishD> <m3oewxru4k.fsf@asfast.com>
	<1031004163727.ZM28731@candle.brasslantern.com>
	<m3isn4ol1q.fsf@asfast.com>
	<1031004224016.ZM29064@candle.brasslantern.com>
From: Lloyd Zusman <ljz@asfast.com>
Reply-To: ljz@asfast.com
Date: Sat, 04 Oct 2003 19:18:19 -0400
In-Reply-To: <1031004224016.ZM29064@candle.brasslantern.com> (Bart
 Schaefer's message of "Sat, 4 Oct 2003 22:40:16 +0000")
Message-ID: <m365j4oamc.fsf@asfast.com>
User-Agent: Gnus/5.1003 (Gnus v5.10.3) Emacs/21.2 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Sender: Lloyd Zusman <ljz@asfast.com>

Bart Schaefer <schaefer@brasslantern.com> writes:

> On Oct 4,  3:33pm, Lloyd Zusman wrote:
> }
> } [ ... ]
> }
> For certain searches, "find -depth" might actually be faster.  Zsh
> always does breadth-first globbing, even when asked to sort the final
> results depth-first.

I guess that comes into play when I want to find something that happens
to be buried deep inside of a directory tree, where the parents directories
have lots of files.


> } [ ... ]
> } 
> } Well, using this alias causes the argv indices to be off by one in the
> } shell function: $0 becomes 'noglob', argv[1] becomes 'xlocate', etc.
>
> If you're seeing that, then you've accidentally created a function named
> "noglob" that has the same body as "xlocate".  Try this:
>
> 	alias foo='bar foo'
> 	foo() { echo $0 }
> 	functions bar
> 	functions foo
>
> Note that "foo()" is considered to be "in the command position" and thus
> the alias expands and you get
>
> 	bar foo () { echo $0 }
>
> which defines two functions, "bar" and "foo" with identical bodies.  I'd
> wager that you created the alias, then changed the definition of xlocate,
> and ended up with a function named "noglob".

Yep.  That's exactly what happened.  Thank you.  I kept re-invoking
". /etc/zshrc" to test some changes to my function as I was developing
it.  The alias command "alias xlocate='noglob xlocate'" was then in
effect the next time I sourced /etc/zshrc.

Therefore, prior to the function definition, I now do this:

  { unalias xlocate; unfunction xlocate } 2>/dev/null

But besides that, would another way to prevent this problem be to always
define functions with "function foo" instead of "foo()"?


-- 
 Lloyd Zusman
 ljz@asfast.com

