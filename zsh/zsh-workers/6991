From zsh-workers-return-6991-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jul 06 17:20:13 1999
Return-Path: <zsh-workers-return-6991-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2987 invoked from network); 6 Jul 1999 17:20:11 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Jul 1999 17:20:11 -0000
Received: (qmail 13475 invoked by alias); 6 Jul 1999 17:19:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6991
Received: (qmail 13464 invoked from network); 6 Jul 1999 17:19:52 -0000
To: zsh-workers@sunsite.auc.dk
Path: mason
From: mason@primenet.com.au (Geoff Wing)
X-Newsgroups: lists.zsh.workers
Subject: PATCH: pws-25: configure for NetBSD
Date: 6 Jul 1999 17:19:44 GMT
Organization: PrimeNet Computer Consultants
Lines: 30
Distribution: local
Message-ID: <slrn7o4elg.2nm.mason@coral.primenet.com.au>
Reply-To: mason@primenet.com.au
NNTP-Posting-Host: coral.primenet.com.au
X-Trace: coral.primenet.com.au 931281584 2903 203.43.15.2 (6 Jul 1999 17:19:44 GMT)
X-Complaints-To: usenet@coral.primenet.com.au
NNTP-Posting-Date: 6 Jul 1999 17:19:44 GMT
User-Agent: slrn/0.9.5.6 (UNIX)

Heyla,
for NetBSD: handle both ELF and a.out

--- configure.in.org	Tue Jun 15 21:33:46 1999
+++ configure.in	Wed Jul  7 02:58:22 1999
@@ -1171,8 +1171,10 @@
   DL_EXT="${DL_EXT=so}"
   if test $zsh_cv_sys_elf = yes; then
     DLLD="${DLLD=$CC}"
+    DLLDARG="${LDARG}"
   else
     DLLD="${DLLD=ld}"
+    DLLDARG=""
   fi
   if test -n "$GCC"; then
     DLCFLAGS="${DLCFLAGS=-fpic}"
@@ -1188,7 +1190,7 @@
     linux*|irix*|osf*) DLLDFLAGS="${DLLDFLAGS=-shared}" ;;
     sunos*)       DLLDFLAGS="${DLLDFLAGS=-assert nodefinitions}" ;;
     sysv4*|esix*) DLLDFLAGS="${DLLDFLAGS=-G $ldflags}" ;;
-    netbsd*)      DLLDFLAGS="${DLLDFLAGS=-x -shared --whole-archive}" ;;
+    netbsd*)      DLLDFLAGS="${DLLDFLAGS=${DLLDARG}-x -shared --whole-archive}" ;;
     aix*)         DLLDFLAGS="${DLLDFLAGS=-G -bexpall -lc}" ;;
     solaris*|sysv4*|esix*) DLLDFLAGS="${DLLDFLAGS=-G}" ;;
   esac

-- 
Geoff Wing : <gcw@pobox.com>     Work URL: http://www.primenet.com.au/
Rxvt Stuff : <gcw@rxvt.org>      Ego URL : http://pobox.com/~gcw/
Zsh Stuff  : <gcw@zsh.org>       Phone   : (Australia) 0413 431 874

