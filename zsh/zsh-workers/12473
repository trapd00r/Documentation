From zsh-workers-return-12473-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Aug 01 23:38:17 2000
Return-Path: <zsh-workers-return-12473-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8853 invoked from network); 1 Aug 2000 23:38:16 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Aug 2000 23:38:16 -0000
Received: (qmail 10319 invoked by alias); 1 Aug 2000 23:37:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12473
Received: (qmail 10312 invoked from network); 1 Aug 2000 23:37:10 -0000
Date: Wed, 2 Aug 2000 00:37:07 +0100
From: Adam Spiers <adam@spiers.net>
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: completion caching layer
Message-ID: <20000802003707.A12849@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh-workers@sunsite.auc.dk
References: <200007270800.KAA15656@beta.informatik.hu-berlin.de> <20000801173152.A9212@thelonious.new.ox.ac.uk> <1000801170332.ZM30820@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0.1i
In-Reply-To: <1000801170332.ZM30820@candle.brasslantern.com>; from schaefer@candle.brasslantern.com on Tue, Aug 01, 2000 at 05:03:32PM +0000
X-Home-Page: http://www.new.ox.ac.uk/~adam/
X-OS: RedHat Linux

Bart Schaefer (schaefer@candle.brasslantern.com) wrote:
> On Aug 1,  5:31pm, Adam Spiers wrote:
> } Subject: PATCH: completion caching layer
> }
> } +findex(_retrieve_cache)
> } +item(tt(_retrieve_cache) var(cache_identifier))(
> } +This function retrieves completion information from the file given by
> } +var(cache_identifier), stored in a directory specified by the
> } +tt(cache-path) style (defaults to tt(~/.zsh/cache)).
> 
> I'd prefer that the cache location be relative to $ZDOTDIR rather than
> relative to $HOME, and that it not be two levels removed, e.g. use
> $ZDODTIR/.zcompcache/ rather than ~/.zsh/cache/.  That'd be consistent
> with e.g. .zcompdump.

Sure, change applied, so will appear in the commit.  Makes no
difference to me; I already had

  zstyle ':completion::complete:*' cache-path ~/.zsh/cache/$HOST

in my .zshrc because my home directory is mounted via NFS so I need a
different cache path for each machine (for perldoc and rpm at least).

> } +  # grr, doesn't work, so we have to roll our own
> } +#  typeset "$@[2,-1]" > "$_cache_dir/$_cache_ident"
> 
> Isn't
> 
>     typeset +g "$@[2,-1]" > "$_cache_dir/$_cache_ident"

Ah, +g!  I was looking for that.

> what you want?  Or maybe
> 
>     while (($# > 1)); do
>       shift
>       ${(P)=1:+typeset $1}
>     done > "$_cache_dir/$_cache_ident"
> 
> would be more accurate?

Is that better than what you suggested via private mail?

