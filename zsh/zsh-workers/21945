From zsh-workers-return-21945-mason-zsh=primenet.com.au@sunsite.dk Fri Oct 28 17:29:44 2005
Return-Path: <zsh-workers-return-21945-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26647 invoked from network); 28 Oct 2005 17:29:42 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 28 Oct 2005 17:29:42 -0000
Received: (qmail 67112 invoked from network); 28 Oct 2005 17:29:36 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 Oct 2005 17:29:36 -0000
Received: (qmail 28090 invoked by alias); 28 Oct 2005 17:29:34 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21945
Received: (qmail 28081 invoked from network); 28 Oct 2005 17:29:34 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 28 Oct 2005 17:29:34 -0000
Received: (qmail 66817 invoked from network); 28 Oct 2005 17:29:34 -0000
Received: from cluster-d.mailcontrol.com (HELO rly30d.srv.mailcontrol.com) (217.69.20.190)
  by a.mx.sunsite.dk with SMTP; 28 Oct 2005 17:29:33 -0000
Received: from exchange03.csr.com (mailhost1.csr.com [81.105.217.43])
	by rly30d.srv.mailcontrol.com (MailControl) with ESMTP id j9SHTUbW030374
	for <zsh-workers@sunsite.dk>; Fri, 28 Oct 2005 18:29:30 +0100
Received: from news01.csr.com ([10.103.143.38]) by exchange03.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Fri, 28 Oct 2005 18:31:50 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.1/8.12.11) with ESMTP id j9SHTTjf025795
	for <zsh-workers@sunsite.dk>; Fri, 28 Oct 2005 18:29:29 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.1/8.13.1/Submit) with ESMTP id j9SHTSGm025792
	for <zsh-workers@sunsite.dk>; Fri, 28 Oct 2005 18:29:29 +0100
Message-Id: <200510281729.j9SHTSGm025792@news01.csr.com>
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: unpatch: rationalise multibyte output
Date: Fri, 28 Oct 2005 18:29:28 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 28 Oct 2005 17:31:50.0325 (UTC) FILETIME=[7ABEDE50:01C5DBE5]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-05-40-01 (www.mailcontrol.com) on 10.68.0.140
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

I've patched the shell supposedly to arrange for all the remaining shell
output to recognize multibyte characters.  Most non-multibyte functions are
simply replaced by the corresponding multibyte ones.  However,
nicechar() is retained in case we couldn't identify a wide character in
a multibyte string so need to deal with a byte at a time.

I was too lazy to patch this into my non-multibyte build, but when I
commit this and can get CVS to do it for me I'll do that and fix up any
fallout.

I was going to post this but I forgot to commit the MULTIBYTE_SUPPORT
fix first so I'll just commit both directly.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


This message has been scanned for viruses by BlackSpider MailControl - www.blackspider.com

