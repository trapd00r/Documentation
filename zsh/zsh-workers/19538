From zsh-workers-return-19538-mason-zsh=primenet.com.au@sunsite.dk Thu Mar 04 20:36:28 2004
Return-Path: <zsh-workers-return-19538-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24604 invoked from network); 4 Mar 2004 20:36:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 4 Mar 2004 20:36:26 -0000
Received: (qmail 23375 invoked by alias); 4 Mar 2004 20:36:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19538
Received: (qmail 23362 invoked from network); 4 Mar 2004 20:36:09 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 4 Mar 2004 20:36:09 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [192.94.73.20] by sunsite.dk (MessageWall 1.0.8) with SMTP; 4 Mar 2004 20:36:7 -0000
Received: from sdf.lonestar.org (IDENT:pda@sdf.lonestar.org [192.94.73.1])
	by sdf.lonestar.org (8.12.10/8.12.10) with ESMTP id i24Ka1RT010472
	for <zsh-workers@sunsite.dk>; Thu, 4 Mar 2004 20:36:02 GMT
Received: (from pda@localhost)
	by sdf.lonestar.org (8.12.10/8.12.8/Submit) id i24Ka1EY026378
	for zsh-workers@sunsite.dk; Thu, 4 Mar 2004 20:36:01 GMT
Date: Thu, 4 Mar 2004 20:36:01 +0000
From: Paul Ackersviller <pda@freeshell.org>
To: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: 4.2.0-pre-1 on HP-UX 11.11
Message-ID: <20040304203601.GB19409@sdf>
Mail-Followup-To: Zsh hackers list <zsh-workers@sunsite.dk>
References: <20040304031907.GC18901@sdf> <18831.1078402874@csr.com>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="opJtzjQTFsWo+cga"
Content-Disposition: inline
In-Reply-To: <18831.1078402874@csr.com>
User-Agent: Mutt/1.4.2.1i


--opJtzjQTFsWo+cga
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

On Thu, Mar 04, 2004 at 12:21:14PM +0000, Peter Stephenson wrote:
> Paul Ackersviller wrote:
> > cc: "configure", line 9234: error 1584: Inconsistent type declaration: "gettimeofday".
> > cc: "configure", line 9234: error 1584: Inconsistent type declaration: "select".
> 
> It should show the failed program, too --- you should have a chunk
> beginning:
> 
> configure: failed program was:
> 
> Without this we don't have enough to go on.

I've attached the portion in question of my config.log -- I don't
understand why it appears to be trying signatures of char (*)().

> We desperately need developers (or at least configure experts) with
> access to HPUX and AIX.  Otherwise we're stuck with tricks like:

I'm far from a configure expert, but I'd be willing to do what I can.
However I have no AIX access, only HP-UX 11.11 and 11.00 (although the
latter box may not stay around long).

BTW, I tried dynamic-loading some pieces of zsh, which is by default
all configured off on HP-UX.  It looks to work on 11.11.

> #ifdef __hpux
> #undef HAVE_SELECT
> #undef HAVE_GETTIMEOFDAY
> #define HAVE_SELECT 1
> #define HAVE_GETTIMEOFDAY 1
> #endif
> 
> which is horrible but might at least work.  (If you want to try it,
> stick it at the end of Src/system.h and see if it now configures and
> builds from scratch.)

Yes, this does, but when resorting to that wouldn't it be best to make
it version-specific?  Unfortunately I don't see any suitable macros.

> By the way, it's possible the same problem exists with HAVE_POLL: it
> should use poll() as an alternative to select().

No, it seems to be finding poll() alright, although I editted that
portion out of the attached log file.

--opJtzjQTFsWo+cga
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="config.log"

configure:9134: checking for gettimeofday
configure:9184: cc -o conftest  -O   conftest.c -lnsl -lcurses -lHcurses -lm  -lc >&5
cc: "configure", line 9234: error 1584: Inconsistent type declaration: "gettimeofday".
cc: "configure", line 9241: warning 604: Pointers are not assignment-compatible.
cc: "configure", line 9250: warning 605: Illegal pointer combination for !=.
configure:9187: $? = 1
configure: failed program was:
| #line 9139 "configure"
| /* confdefs.h.  */
| 
| #define PACKAGE_NAME ""
| #define PACKAGE_TARNAME ""
| #define PACKAGE_VERSION ""
| #define PACKAGE_STRING ""
| #define PACKAGE_BUGREPORT ""
| #define MACHTYPE "hppa2.0w"
| #define VENDOR "hp"
| #define OSTYPE "hpux11.11"
| #define GLOBAL_ZSHENV "/etc/zshenv"
| #define GLOBAL_ZSHRC "/etc/zshrc"
| #define GLOBAL_ZPROFILE "/etc/zprofile"
| #define GLOBAL_ZLOGIN "/etc/zlogin"
| #define GLOBAL_ZLOGOUT "/etc/zlogout"
| #define RESTRICTED_R 1
| #define CONFIG_LOCALE 1
| #define PROTOTYPES 1
| #define HAVE_ALLOCA_H 1
| #define HAVE_ALLOCA 1
| #define HAVE_UNION_INIT 1
| #define HAVE_VARIABLE_LENGTH_ARRAYS 1
| #define HAVE_DIRENT_H 1
| #define STDC_HEADERS 1
| #define TIME_WITH_SYS_TIME 1
| #define HAVE_SYS_WAIT_H 1
| #define HAVE_SYS_TYPES_H 1
| #define HAVE_SYS_STAT_H 1
| #define HAVE_STDLIB_H 1
| #define HAVE_STRING_H 1
| #define HAVE_MEMORY_H 1
| #define HAVE_STRINGS_H 1
| #define HAVE_INTTYPES_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_SYS_TIME_H 1
| #define HAVE_SYS_TIMES_H 1
| #define HAVE_TERMIO_H 1
| #define HAVE_TERMIOS_H 1
| #define HAVE_SYS_PARAM_H 1
| #define HAVE_STRING_H 1
| #define HAVE_MEMORY_H 1
| #define HAVE_LIMITS_H 1
| #define HAVE_FCNTL_H 1
| #define HAVE_SYS_UTSNAME_H 1
| #define HAVE_SYS_RESOURCE_H 1
| #define HAVE_LOCALE_H 1
| #define HAVE_ERRNO_H 1
| #define HAVE_STDIO_H 1
| #define HAVE_STDLIB_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_UTMP_H 1
| #define HAVE_UTMPX_H 1
| #define HAVE_SYS_TYPES_H 1
| #define HAVE_PWD_H 1
| #define HAVE_GRP_H 1
| #define HAVE_POLL_H 1
| #define HAVE_SYS_MMAN_H 1
| #define HAVE_NETINET_IN_SYSTM_H 1
| #define HAVE_LANGINFO_H 1
| #define HAVE_WCHAR_H 1
| #define HAVE_STDDEF_H 1
| #define HAVE_SYS_STROPTS_H 1
| #define HAVE_DLFCN_H 1
| #define HAVE_DL_H 1
| #define HAVE_LIBM 1
| #define HAVE_CURSES_H 1
| #define HAVE_TERM_H 1
| #define RETSIGTYPE void
| #define ZSH_64_BIT_TYPE long long
| #define ZSH_64_BIT_UTYPE unsigned long long
| #define HAVE_STRUCT_TIMEZONE 1
| #define HAVE_STRUCT_UTMP 1
| #define HAVE_STRUCT_UTMPX 1
| #define HAVE_STRUCT_UTMP_UT_HOST 1
| #define HAVE_STRUCT_UTMPX_UT_HOST 1
| #define HAVE_STRUCT_UTMPX_UT_TV 1
| #define HAVE_STRUCT_DIRENT_D_INO 1
| #define HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID 1
| /* end confdefs.h.  */
| /* System header to define __stub macros and hopefully few prototypes,
|     which can conflict with char gettimeofday (); below.
|     Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
|     <limits.h> exists even on freestanding compilers.  */
| #ifdef __STDC__
| # include <limits.h>
| #else
| # include <assert.h>
| #endif
| /* Override any gcc2 internal prototype to avoid an error.  */
| #ifdef __cplusplus
| extern "C"
| {
| #endif
| /* We use char because int might match the return type of a gcc2
|    builtin and then its argument prototype would still apply.  */
| char gettimeofday ();
| /* The GNU C library defines this for functions which it implements
|     to always fail with ENOSYS.  Some functions are actually named
|     something starting with __ and the normal name is an alias.  */
| #if defined (__stub_gettimeofday) || defined (__stub___gettimeofday)
| choke me
| #else
| char (*f) () = gettimeofday;
| #endif
| #ifdef __cplusplus
| }
| #endif
| 
| int
| main ()
| {
| return f != gettimeofday;
|   ;
|   return 0;
| }
configure:9204: result: no
configure:9134: checking for select
configure:9184: cc -o conftest  -O   conftest.c -lnsl -lcurses -lHcurses -lm  -lc >&5
cc: "configure", line 9234: error 1584: Inconsistent type declaration: "select".
cc: "configure", line 9241: warning 604: Pointers are not assignment-compatible.
cc: "configure", line 9250: warning 605: Illegal pointer combination for !=.
configure:9187: $? = 1
configure: failed program was:
| #line 9139 "configure"
| /* confdefs.h.  */
| 
| #define PACKAGE_NAME ""
| #define PACKAGE_TARNAME ""
| #define PACKAGE_VERSION ""
| #define PACKAGE_STRING ""
| #define PACKAGE_BUGREPORT ""
| #define MACHTYPE "hppa2.0w"
| #define VENDOR "hp"
| #define OSTYPE "hpux11.11"
| #define GLOBAL_ZSHENV "/etc/zshenv"
| #define GLOBAL_ZSHRC "/etc/zshrc"
| #define GLOBAL_ZPROFILE "/etc/zprofile"
| #define GLOBAL_ZLOGIN "/etc/zlogin"
| #define GLOBAL_ZLOGOUT "/etc/zlogout"
| #define RESTRICTED_R 1
| #define CONFIG_LOCALE 1
| #define PROTOTYPES 1
| #define HAVE_ALLOCA_H 1
| #define HAVE_ALLOCA 1
| #define HAVE_UNION_INIT 1
| #define HAVE_VARIABLE_LENGTH_ARRAYS 1
| #define HAVE_DIRENT_H 1
| #define STDC_HEADERS 1
| #define TIME_WITH_SYS_TIME 1
| #define HAVE_SYS_WAIT_H 1
| #define HAVE_SYS_TYPES_H 1
| #define HAVE_SYS_STAT_H 1
| #define HAVE_STDLIB_H 1
| #define HAVE_STRING_H 1
| #define HAVE_MEMORY_H 1
| #define HAVE_STRINGS_H 1
| #define HAVE_INTTYPES_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_SYS_TIME_H 1
| #define HAVE_SYS_TIMES_H 1
| #define HAVE_TERMIO_H 1
| #define HAVE_TERMIOS_H 1
| #define HAVE_SYS_PARAM_H 1
| #define HAVE_STRING_H 1
| #define HAVE_MEMORY_H 1
| #define HAVE_LIMITS_H 1
| #define HAVE_FCNTL_H 1
| #define HAVE_SYS_UTSNAME_H 1
| #define HAVE_SYS_RESOURCE_H 1
| #define HAVE_LOCALE_H 1
| #define HAVE_ERRNO_H 1
| #define HAVE_STDIO_H 1
| #define HAVE_STDLIB_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_UTMP_H 1
| #define HAVE_UTMPX_H 1
| #define HAVE_SYS_TYPES_H 1
| #define HAVE_PWD_H 1
| #define HAVE_GRP_H 1
| #define HAVE_POLL_H 1
| #define HAVE_SYS_MMAN_H 1
| #define HAVE_NETINET_IN_SYSTM_H 1
| #define HAVE_LANGINFO_H 1
| #define HAVE_WCHAR_H 1
| #define HAVE_STDDEF_H 1
| #define HAVE_SYS_STROPTS_H 1
| #define HAVE_DLFCN_H 1
| #define HAVE_DL_H 1
| #define HAVE_LIBM 1
| #define HAVE_CURSES_H 1
| #define HAVE_TERM_H 1
| #define RETSIGTYPE void
| #define ZSH_64_BIT_TYPE long long
| #define ZSH_64_BIT_UTYPE unsigned long long
| #define HAVE_STRUCT_TIMEZONE 1
| #define HAVE_STRUCT_UTMP 1
| #define HAVE_STRUCT_UTMPX 1
| #define HAVE_STRUCT_UTMP_UT_HOST 1
| #define HAVE_STRUCT_UTMPX_UT_HOST 1
| #define HAVE_STRUCT_UTMPX_UT_TV 1
| #define HAVE_STRUCT_DIRENT_D_INO 1
| #define HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID 1
| /* end confdefs.h.  */
| /* System header to define __stub macros and hopefully few prototypes,
|     which can conflict with char select (); below.
|     Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
|     <limits.h> exists even on freestanding compilers.  */
| #ifdef __STDC__
| # include <limits.h>
| #else
| # include <assert.h>
| #endif
| /* Override any gcc2 internal prototype to avoid an error.  */
| #ifdef __cplusplus
| extern "C"
| {
| #endif
| /* We use char because int might match the return type of a gcc2
|    builtin and then its argument prototype would still apply.  */
| char select ();
| /* The GNU C library defines this for functions which it implements
|     to always fail with ENOSYS.  Some functions are actually named
|     something starting with __ and the normal name is an alias.  */
| #if defined (__stub_select) || defined (__stub___select)
| choke me
| #else
| char (*f) () = select;
| #endif
| #ifdef __cplusplus
| }
| #endif
| 
| int
| main ()
| {
| return f != select;
|   ;
|   return 0;
| }
configure:9204: result: no

--opJtzjQTFsWo+cga--

