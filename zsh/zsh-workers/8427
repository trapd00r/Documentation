From zsh-workers-return-8427-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Oct 26 13:35:58 1999
Return-Path: <zsh-workers-return-8427-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8862 invoked from network); 26 Oct 1999 13:35:52 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 Oct 1999 13:35:52 -0000
Received: (qmail 21165 invoked by alias); 26 Oct 1999 13:35:39 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8427
Received: (qmail 21142 invoked from network); 26 Oct 1999 13:35:38 -0000
Subject: Re: PATCH: completion
In-Reply-To: <3815A627.19C7F2A@u.genie.co.uk> from Oliver Kiddle at "Oct 26, 1999  2: 1:27 pm"
To: opk@u.genie.co.uk (Oliver Kiddle)
Date: Tue, 26 Oct 1999 14:35:14 +0100 (BST)
Cc: zsh-workers@sunsite.auc.dk
X-Mailer: ELM [version 2.4ME+ PL48 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Message-Id: <E11g6ks-0004Mi-00@crucigera.fysh.org>
From: Zefram <zefram@fysh.org>

Oliver Kiddle wrote:
>Note that all the .o files have two dots (e.g. modentry..o) when
>building on
>AIX. This is probably a mistake somewhere but it has always compiled
>happily so
>I've never bothered.

This should probably be documented in the development guide or somewhere.

In the very first dynamic linking patches, all objects were ".o",
as usual.  However, objects need to be compiled with different options
when they're in a module than from when they're linked into the main
executable.  After changing the list of compiled-in modules, it was
necessary to remove all the objects.  So we changed it so that objects
to be linked into modules got the suffix "..o", so that both lots of
object files could coexist, and even when you don't need both lots to
exist at once it avoids a lot of potential confusion.

The module install directory was changed from $prefix/lib/zsh
to $prefix/lib/zsh/$ZSH_VERSION at the same time, for similar
confusion-avoidance reasons (plus coexistence of multiple installed zsh
versions).  Ever since then, I've been glad that we got that right from
the start.  I hate to think, if we hadn't done these two things, how many
support queries we'd be answering where it turned out that people had got
the wrong objects linked together.  (This is all related to the principle
of least surprise; I'm going to dub it the "principle of least support".)

-zefram

