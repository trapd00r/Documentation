From zsh-workers-return-14788-mason-zsh=primenet.com.au@sunsite.dk Thu Jun 07 13:35:34 2001
Return-Path: <zsh-workers-return-14788-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 638 invoked from network); 7 Jun 2001 13:35:33 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Jun 2001 13:35:33 -0000
Received: (qmail 24078 invoked by alias); 7 Jun 2001 13:35:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14788
Received: (qmail 24060 invoked from network); 7 Jun 2001 13:35:08 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: <zsh-workers@sunsite.dk>
Subject: RE: Modules dependencies RE: PATCH: zftp/tcp abstraction
Date: Thu, 7 Jun 2001 17:35:11 +0400
Message-ID: <000801c0ef56$acea3530$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200
In-Reply-To: <200106071316.PAA27682@beta.informatik.hu-berlin.de>



> -----Original Message-----
> From: Sven Wischnowsky [mailto:wischnow@informatik.hu-berlin.de]
> Sent: Thursday, June 07, 2001 5:17 PM
> To: zsh-workers@sunsite.dk
> Subject: Re: Modules dependencies RE: PATCH: zftp/tcp abstraction
>
>
> Zefram wrote:
>
> > ...
> >
> > Neither of my solutions is completely satisfactory, but it now
> seems that
> > we are making sufficient use of interdependent modules that we need some
> > form of implicit dependencies.
>
> I've thought about this, too, when I started working with modules.  On
> systems supporting RTLD_LAZY it should be possible to have the setup_
> function call back the core to load needed modules, shouldn't it?
>

And if we could use ELF on all plattforms we could just add dependencies to
a section in ELF file.

No, I believe, the simplest solution is to have modele.dep for every
module.so. There may be some other things to put into (think about
autoloaded stuff - it would enable you to just drop module into directory
and let zsh scan $module_path on startup to add autoloaded objects) so
general name module.def might be better. We may even use .mdd file directly
but parsing it may be tricky.

Incidentally, this is what libtool does, so it is probably no the worst
solution :-)

One question - I do not quite understand logic in load_module. It looks like

if module not found
  load module
load module

One of these 'load module' looks redundant?

-andrej

