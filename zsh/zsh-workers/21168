From zsh-workers-return-21168-mason-zsh=primenet.com.au@sunsite.dk Sat Apr 23 20:20:02 2005
Return-Path: <zsh-workers-return-21168-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3995 invoked from network); 23 Apr 2005 20:20:01 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Apr 2005 20:20:01 -0000
Received: (qmail 21174 invoked from network); 23 Apr 2005 20:19:55 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Apr 2005 20:19:55 -0000
Received: (qmail 5261 invoked by alias); 23 Apr 2005 20:19:53 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21168
Received: (qmail 5247 invoked from network); 23 Apr 2005 20:19:52 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 23 Apr 2005 20:19:52 -0000
Received: (qmail 20900 invoked from network); 23 Apr 2005 20:19:52 -0000
Received: from zoidberg.org (HELO cthulhu.zoidberg.org) (213.133.99.5)
  by a.mx.sunsite.dk with SMTP; 23 Apr 2005 20:19:48 -0000
Received: from zoidberg (3ece4e6e.datahighways.de [::ffff:62.206.78.110])
  (IDENT: tobias, AUTH: PLAIN tobias, TLS: TLSv1/SSLv3,256bits,AES256-SHA)
  by cthulhu.zoidberg.org with esmtp; Sat, 23 Apr 2005 22:19:46 +0200
  id 0282A0D8.426AADE2.00003035
Date: Sat, 23 Apr 2005 22:19:44 +0200
From: Tobias Gruetzmacher <tobias@portfolio16.de>
To: zsh-workers@sunsite.dk
Subject: PATCH: Cleaner envrionment after some completions
Message-ID: <20050423201944.GA23939@portfolio16.de>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="=_cthulhu.zoidberg.org-12341-1114287586-0001-2"
Content-Disposition: inline
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

This is a MIME-formatted message.  If you see this text it means that your
E-mail software does not support MIME-formatted messages.

--=_cthulhu.zoidberg.org-12341-1114287586-0001-2
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

this patch makes some internal variables of completions where I noticed
this behavior local to the completion function. This makes the "set"
output more readable again. The patch also hides the vales of the
package cache for apt, since I don't think it helps anyone to see the
names of all 21241 Debian packes when calling "set". This might also be
useful for other variables of the completion system, like _comps,
_services and _comp_setup.

Greetings Tobi

-- 
GPG-Key 0xE2BEA341 - signed/encrypted mail preferred
My, oh so small, homepage: http://portfolio16.de/
http://www.fli4l.de/ - ISDN- & DSL-Router on one disk!
eegistered FLI4L-User #00000003

--=_cthulhu.zoidberg.org-12341-1114287586-0001-2
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="clean-env.patch"

--- orig/Completion/Debian/Command/_apt
+++ mod/Completion/Debian/Command/_apt
@@ -57,8 +57,8 @@
 
   local short_seq false true bool bool_prefix intlevel word word1 nul qnul match
   local comp_bool comp_intlevel comp_configfile comp_arbitem comp_long comp_opt
-  local comp_release
-  local regex_short regex_long regex_all
+  local comp_release comp_long_prefix comp_short
+  local regex_short regex_long regex_all regex_long_prefix
 
   regex_all=( \( "$@" \) )
 


--- orig/Completion/Debian/Type/_deb_packages
+++ mod/Completion/Debian/Type/_deb_packages
@@ -103,6 +103,8 @@
 
   _deb_packages_update_$pkgset
 
+  typeset -gH $cachevar
+
   _tags packages && compadd "$expl[@]" - "${(@P)cachevar}"
 }
 


--- orig/Completion/Unix/Command/_mount
+++ mod/Completion/Unix/Command/_mount
@@ -40,7 +40,11 @@
 # are below these table.
 
 local curcontext="$curcontext" state line suf ret=1
-local args deffs=iso9660 tmp typeops=-t _nfs_access _nfs_ufs
+local args deffs=iso9660 tmp typeops=-t _fs_any _nfs_access _fs_nfs _nfs_ufs \
+_fs_ufs _fs_efs _fs_iso9660 _fs_cachefs _fs_s5fs _fs_tmpfs _fs_pcfs _fs_hsfs \
+_fs_advfs _fs_cdfs _fs_affs _fs_ext2 _fs_fat _fs_ext3 _fs_msdos _fs_umsdos \
+_fs_vfat _fs_hpfs _fs_ntfs _fs_reiserfs _fs_smbfs _fs_xfs _fs_std _fs_devfs \
+_fs_fdesc _fs_kernfs _fs_linprocfs _fs_procfs
 
 typeset -A opt_args
 


--- orig/Completion/Unix/Command/_subversion
+++ mod/Completion/Unix/Command/_subversion
@@ -63,7 +63,7 @@
   local cmd
 
   if (( ! $+_svn_cmds )); then
-    typeset -gA _svn_cmds
+    typeset -A _svn_cmds
     _svn_cmds=(
       ${=${(f)${${"$(LC_MESSAGES=C _call_program commands svn help)"#l#*Available subcommands:}%%Subversion is a tool*}}/(#s)[[:space:]]#(#b)([a-z]##)[[:space:]]#(\([a-z, ?]##\))#/$match[1] :$match[1]${match[2]:+:${${match[2]//[(),]}// /:}}:}
     )




--=_cthulhu.zoidberg.org-12341-1114287586-0001-2--

