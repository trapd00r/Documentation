From zsh-users-return-12486-mason-zsh=primenet.com.au@sunsite.dk Sat Jan 26 15:19:44 2008
Return-Path: <zsh-users-return-12486-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27281 invoked from network); 26 Jan 2008 15:19:42 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Jan 2008 15:19:42 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 61450 invoked from network); 26 Jan 2008 15:19:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Jan 2008 15:19:26 -0000
Received: (qmail 21572 invoked by alias); 26 Jan 2008 15:19:16 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12486
Received: (qmail 21553 invoked from network); 26 Jan 2008 15:19:16 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 26 Jan 2008 15:19:16 -0000
Received: from an-out-0708.google.com (an-out-0708.google.com [209.85.132.241])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 5CCCF80190F6
	for <zsh-users@sunsite.dk>; Sat, 26 Jan 2008 16:19:10 +0100 (CET)
Received: by an-out-0708.google.com with SMTP id c14so281110anc.13
        for <zsh-users@sunsite.dk>; Sat, 26 Jan 2008 07:19:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=ySBWt13/POMHU3QmOsyKhQ5I2e2Ds3W5sNT3mF6vnn4=;
        b=LFNU1rkb3EG5s9nRspl2q7U5gx4eBEb59KW5mNmvnQiw3dSCKqoGjjTzzqpFTwJoFNShHELUrknz6FeZRexGUb2tz4aiqislNwnoZhkMsbzKtlr9pnsWRLd37OnhrjBhzQaNJAQEzQc0gF16GlkCbq63aEhvJ9rca8O/SQ1A9cs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=NXw6Q+LJ6T+0lZt+qXdratrDGjJYJeUO/iaFTsWEHlVYtbFj1U/bkqrSBlniEjLdP+e6Y6O0korvnMNpVVV+ElqqKO0RaAU981dQRYEdGrpYLWa0bpiD2rJRCDWRqwrn3DL//3jMdFxqmPPXGmHiJTkj7zcD0JBhMJbaG4f/+sw=
Received: by 10.101.68.19 with SMTP id v19mr7091902ank.4.1201360749915;
        Sat, 26 Jan 2008 07:19:09 -0800 (PST)
Received: by 10.100.143.1 with HTTP; Sat, 26 Jan 2008 07:19:09 -0800 (PST)
Message-ID: <2d460de70801260719h594ded7ey88ca32c20bae6fdd@mail.gmail.com>
Date: Sat, 26 Jan 2008 16:19:09 +0100
From: "Richard Hartmann" <richih.mailinglist@gmail.com>
To: "Bart Schaefer" <schaefer@brasslantern.com>
Subject: Re: idea for new feature (was: Re: sticky-note and zle bindings)
Cc: "Robert Knight" <robertknight@gmail.com>, zsh-users@sunsite.dk, 
	bastian@kde.org
In-Reply-To: <080125095733.ZM20873@torch.brasslantern.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <13ed09c00801241017x1cd7c454lcbf9156b6bccd9bb@mail.gmail.com>
	 <2d460de70801241209u63a33fe6ufb8f396bff440dc6@mail.gmail.com>
	 <2d460de70801241254v52d8a9c4he75e450f2f2bd29e@mail.gmail.com>
	 <13ed09c00801241354g306f5aaay4d9e6f22c1622ec7@mail.gmail.com>
	 <2d460de70801241522y47611d27k2e60c132fea1f01d@mail.gmail.com>
	 <13ed09c00801241857n2b1613f0m2d74fd12a90135cc@mail.gmail.com>
	 <2d460de70801250132n1692f74cn78d3fdc40da88b9@mail.gmail.com>
	 <080125095733.ZM20873@torch.brasslantern.com>
X-Virus-Scanned: ClamAV 0.91.2/5562/Sat Jan 26 12:34:23 2008 on bifrost
X-Virus-Status: Clean

On Jan 25, 2008 6:57 PM, Bart Schaefer <schaefer@brasslantern.com> wrote:


> Shells are slightly different beasts than other applications.  If I
> explicitly exit from a shell, I'm done with whatever that shell was
> doing, and if I were to then start a new shell I wouldn't want it to
> return to the context of the the last shell I exited; the chances are
> very good that the new thing I'll be doing has nothing to do with
> the last thing.

That is only true for local shells. Remote shells should offer a way
to resume. Speaking of which, is OpenSSH able to pass environment
variables from the local to the remote session?


> OTOH if my shell *windows* in a GUI environment are disconnected, or
> the shell is killed by HUP, I probably didn't intentionally exit and I'd
> like the state restored, to the extent possible, when the GUI resumes.
> That applies whether the GUI session is exited abnormally or when I
> choose "Log Out" from a menu.

Even if there is no HUP and I cleanly exit a remote session, I would
probably want to restore session state, sometimes. A cheap way to
emulate screen, so to say.


> This implies that commands in the .zlogout or equivalent need to be
> able to determine what caused the shell to exit:  builtin command,
> user-generated EOF (ctrl-D), real EOF on stdin, HUP signal, etc.

If the user can choose which set of conditions should have what effect
then yes, this would help quite a lot.


> It also implies that the shell needs a way to tell the GUI environment
> NOT to attempt, independently, to restore current directory, etc.

[XDG_]SHELL_SESSION_HANDLER or some such?
Could be 'shell', 'terminal', 'both' or a parseable list/an array?


> Scriptable.  Don't bother trying to define this in the shell itself.
[...]
> Again scriptable.

The shell should probably offer hooks and options for the script to use,
but yes, that is basically what I meant.


> See Util/reporter in the zsh source distribution for examples of how to
> dump out various shell state.

Will do, thanks :)


Richard

