From zsh-workers-return-9301-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jan 12 19:01:09 2000
Return-Path: <zsh-workers-return-9301-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10637 invoked from network); 12 Jan 2000 19:01:08 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 12 Jan 2000 19:01:08 -0000
Received: (qmail 24623 invoked by alias); 12 Jan 2000 19:01:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9301
Received: (qmail 24616 invoked from network); 12 Jan 2000 19:01:03 -0000
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: PATCH: better function version handling
Date: Wed, 12 Jan 2000 19:03:08 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E128T0t-0008O5-00.2000-01-12-19-00-59@cmailg3.svr.pol.co.uk>

The version in the function installation directory should be interpreted at
compile time, not configure time, since you don't have to reconfigure for a
version number change.  This doesn't actually affect anyone that recompiles
a new version from scratch each time, but it's logically more correct (and
affects me).

Index: configure.in
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/configure.in,v
retrieving revision 1.13
diff -u -r1.13 configure.in
--- configure.in	2000/01/07 22:46:44	1.13
+++ configure.in	2000/01/12 18:48:11
@@ -213,11 +213,12 @@
 undefine([fndir])dnl
 AC_ARG_ENABLE(fndir,
 [  --enable-fndir=DIR         where functions go (default DATADIR/zsh/functions)],
+dnl ${VERSION} to be determined at compile time.
 [if test $enableval = yes; then
-  fndir=${datadir}/${tzsh_name}/${VERSION}/functions
+  fndir=${datadir}/${tzsh_name}/'${VERSION}'/functions
 else
   fndir="$enableval"
-fi], [fndir=${datadir}/${tzsh_name}/${VERSION}/functions])
+fi], [fndir=${datadir}/${tzsh_name}/'${VERSION}'/functions])
 
 undefine([function_subdirs])
 AC_ARG_ENABLE(function-subdirs,

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

