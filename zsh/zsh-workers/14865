From zsh-workers-return-14865-mason-zsh=primenet.com.au@sunsite.dk Tue Jun 12 16:14:38 2001
Return-Path: <zsh-workers-return-14865-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29875 invoked from network); 12 Jun 2001 16:14:37 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 12 Jun 2001 16:14:37 -0000
Received: (qmail 23368 invoked by alias); 12 Jun 2001 16:14:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14865
Received: (qmail 23337 invoked from network); 12 Jun 2001 16:14:09 -0000
To: "Bart Schaefer" <schaefer@candle.brasslantern.com>
cc: zsh-workers@sunsite.dk
Subject: Re: fatal flaw zsh 4.0.1 on irix 6.3 & 6.5: suspend "ls -l|less" then resume hangs
References: <200106120815.KAA02209@beta.informatik.hu-berlin.de> <yehy9qxkakg.fsf@water.cs.brown.edu> <1010612154026.ZM24394@candle.brasslantern.com>
From: Timothy Miller <tsm@cs.brown.edu>
Date: 12 Jun 2001 12:13:26 -0400
In-Reply-To: "Bart Schaefer"'s message of "Tue, 12 Jun 2001 15:40:26 +0000"
Message-ID: <yehu21lk76h.fsf@water.cs.brown.edu>
Lines: 26
User-Agent: Gnus/5.0802 (Gnus v5.8.2) XEmacs/21.1 (Big Bend)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Tue, 12 Jun 2001 15:40:26 +0000, "Bart Schaefer" <schaefer@candle.brasslantern.com> wrote:
> On Jun 12, 11:00am, Timothy Miller wrote:
> }
> } I can't type fast enough to suspend cat before it exits!
> 
> Use "ls -lR / | cat" and I bet you'll have time.

Yes, I thought of something like that shortly after I sent the email...what
comes of sending too rapidly...anyway, if I do that, it hangs on the first
suspend.

irix 6.3, zsh 4.0.1 -f,  ls -lR /|cat, then suspend:

  F S      UID   PID  PPID  PGID   SID  C PRI NI  P    SZ:RSS      WCHAN    STIME TTY     TIME CMD
 b0 S      tsm 13962 13961 13962 13905  0  60 20  *   394:114   c06afbc0 11:55:29 ttyq13  0:01 ls -lR / 
 b0 T      tsm 13963 13961 13963 13905  0  60 20  *    45:25           - 11:55:29 ttyq13  0:00 cat 
 b0 S      tsm 13961 13905 13961 13905  0  39 20  *   732:297   8039d510 11:55:26 ttyq13  0:00 zsh-4.0.1 -f 

zsh asleep syscall 166, all sigs held but 1, 9, 18, 23
ls asleep on syscall 5, no sigs held/pending
cat stopped, no sigs held/pending

just found more authoritative info on syscall numbers; syscall 4 is read(),
syscall 5 is write(), syscall 166 is sigsuspend(), which makes much more
sense.
   Tim

