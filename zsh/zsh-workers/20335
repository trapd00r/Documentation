From zsh-workers-return-20335-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 08 20:27:51 2004
Return-Path: <zsh-workers-return-20335-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6735 invoked from network); 8 Sep 2004 20:27:49 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 8 Sep 2004 20:27:49 -0000
Received: (qmail 38457 invoked from network); 8 Sep 2004 20:27:43 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 8 Sep 2004 20:27:43 -0000
Received: (qmail 14171 invoked by alias); 8 Sep 2004 20:27:31 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20335
Received: (qmail 14161 invoked from network); 8 Sep 2004 20:27:31 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 8 Sep 2004 20:27:31 -0000
Received: (qmail 37668 invoked from network); 8 Sep 2004 20:26:32 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 8 Sep 2004 20:26:31 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 1A05F7004C; Wed,  8 Sep 2004 16:26:34 -0400 (EDT)
Date: Wed, 8 Sep 2004 16:26:33 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Cc: Hugo Haas <hugo@larve.net>, 270632-forwarded@bugs.debian.org
Subject: Re: Bug#270632: zsh: Completion and spaces
Message-ID: <20040908202633.GA3130@scowler.net>
References: <20040908115321.GA2417@larve.net> <20040908180950.GC25987@scowler.net> <20040908194101.GD2775@larve.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20040908194101.GD2775@larve.net>
User-Agent: Mutt/1.5.6+20040722i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-4.9 required=6.0 tests=BAYES_00 autolearn=no 
	version=2.63
X-Spam-Hits: -4.9

> Oh, you're right. It's not insert-last-word which is the culprit, but
> smart-insert-last-word.
> 
> I have done:
> 
>   autoload smart-insert-last-word
>   zle -N insert-last-word smart-insert-last-word
> 
> With this, you should be able to witness the problem.

Is this the correct fix?

Index: Functions/Zle/smart-insert-last-word
===================================================================
RCS file: /cvsroot/zsh/zsh/Functions/Zle/smart-insert-last-word,v
retrieving revision 1.2
diff -u -r1.2 smart-insert-last-word
--- Functions/Zle/smart-insert-last-word	27 Jan 2003 16:41:17 -0000	1.2
+++ Functions/Zle/smart-insert-last-word	8 Sep 2004 20:25:14 -0000
@@ -86,5 +86,5 @@
 	fi
     done
 fi
-LBUFFER[lcursor+1,cursor+1]=$lastcmd[-NUMERIC]
+LBUFFER[lcursor+1,cursor+1]=" $lastcmd[-NUMERIC]"
 _ilw_cursor=$CURSOR

