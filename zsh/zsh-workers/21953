From zsh-workers-return-21953-mason-zsh=primenet.com.au@sunsite.dk Sat Oct 29 21:22:28 2005
Return-Path: <zsh-workers-return-21953-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10469 invoked from network); 29 Oct 2005 21:22:26 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 Oct 2005 21:22:26 -0000
Received: (qmail 83187 invoked from network); 29 Oct 2005 21:22:20 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 Oct 2005 21:22:20 -0000
Received: (qmail 27914 invoked by alias); 29 Oct 2005 21:22:17 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21953
Received: (qmail 27905 invoked from network); 29 Oct 2005 21:22:16 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 29 Oct 2005 21:22:16 -0000
Received: (qmail 82853 invoked from network); 29 Oct 2005 21:22:16 -0000
Received: from stripped.disjoint.net (69.12.152.17)
  by a.mx.sunsite.dk with SMTP; 29 Oct 2005 21:22:15 -0000
Received: from stripped.disjoint.net (localhost.disjoint.net [127.0.0.1])
	by stripped.disjoint.net (8.13.3/8.13.3) with ESMTP id j9TLLvPv058435;
	Sat, 29 Oct 2005 14:21:57 -0700 (PDT)
	(envelope-from satwell@stripped.disjoint.net)
Received: (from satwell@localhost)
	by stripped.disjoint.net (8.13.3/8.13.3/Submit) id j9TLLuQk058434;
	Sat, 29 Oct 2005 14:21:56 -0700 (PDT)
	(envelope-from satwell)
Date: Sat, 29 Oct 2005 14:21:56 -0700
From: Steve Atwell <satwell@disjoint.net>
To: Peter Stephenson <p.w.stephenson@ntlworld.com>
Cc: Steve Atwell <satwell@disjoint.net>, zsh-workers@sunsite.dk
Subject: Re: FreeBSD process substitution bug
Message-ID: <20051029212156.GA57823@stripped.disjoint.net>
References: <20051029070656.GA77326@stripped.disjoint.net> <200510291002.j9TA2Q5P003942@pwslaptop.csr.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Disposition: inline
In-Reply-To: <200510291002.j9TA2Q5P003942@pwslaptop.csr.com>
User-Agent: Mutt/1.4.2.1i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.0.4

On Sat, Oct 29, 2005 at 11:02:26AM +0100, Peter Stephenson wrote:
>Steve Atwell wrote:
>> % cat <(date)
>> cat: /dev/fd/11: No such file or directory
>> 
>> This happens to me on FreeBSD 5.4 with zsh 4.2.5 built with default 
>> configure options.
>
>That suggests there's something wrong with the following configure test:
>any idea what?  You should find it works if you #undef PATH_DEV_FD in
>config.h.

I did a little more investigation and found the problem.  FreeBSD 5.x by 
default only provides file descriptors 0, 1, and 2 for the current 
process in /dev/fd.  If you want to be able to access other file 
descriptors, you have to mount the special fdescfs filesystem on 
/dev/fd.  The configure test to see if zsh can use /dev/fd succeeds 
because it only tests /dev/fd/0.

-- 
Steve Atwell <satwell@disjoint.net>

