From zsh-workers-return-26300-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 13 10:09:45 2009
Return-Path: <zsh-workers-return-26300-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23215 invoked from network); 13 Jan 2009 10:09:42 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Jan 2009 10:09:42 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 6796 invoked from network); 13 Jan 2009 10:09:34 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Jan 2009 10:09:34 -0000
Received: (qmail 29456 invoked by alias); 13 Jan 2009 10:09:28 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26300
Received: (qmail 29439 invoked from network); 13 Jan 2009 10:09:27 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 13 Jan 2009 10:09:27 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 1E2D68028ACA
	for <zsh-workers@sunsite.dk>; Tue, 13 Jan 2009 11:09:23 +0100 (CET)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly44d.srv.mailcontrol.com (MailControl) with ESMTP id n0DA9Jqh018042
	for <zsh-workers@sunsite.dk>; Tue, 13 Jan 2009 10:09:20 GMT
Received: from news01 ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 13 Jan 2009 10:09:19 +0000
Date: Tue, 13 Jan 2009 10:09:13 +0000
From: Peter Stephenson <pws@csr.com>
To: zsh-workers@sunsite.dk
Subject: Re: Getting the CVS revision of Zsh
Message-ID: <20090113100913.3f27795b@news01>
In-Reply-To: <a0600100ac591d5879871@kba.biglobe.ne.jp>
References: <2d460de70901090301h6b309a7cm19c5ebfec989ff2c@mail.gmail.com>
	<200901091121
 .n09BLVvZ006382@news01.csr.com>
	<2d460de70901090348t3ea9e25fi29a7165ee42ae5
 e5@mail.gmail.com>
	<200901091158.n09BwPii006839@news01.csr.com>
	<2d460de7090
 1090441i7ef1795bs42ed98fe0f33c9ba@mail.gmail.com>
	<200901091258.n09CwS7T007
 471@news01.csr.com>
	<2d460de70901090507i7c3179e4u1e2def459f214566@mail.gmai
 l.com>
	<20090109201333.5dcc8fdb@pws-pc>
	<a0600100ac591d5879871@kba.biglobe.ne.jp>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 13 Jan 2009 10:09:19.0545 (UTC) FILETIME=[FFCC1A90:01C97566]
X-Scanned-By: MailControl A_08_51_00 (www.mailcontrol.com) on 10.68.0.154
X-Virus-Scanned: ClamAV 0.92.1/8857/Tue Jan 13 08:35:27 2009 on bifrost
X-Virus-Status: Clean

On Tue, 13 Jan 2009 14:25:11 +0900
"Jun T." <takimoto-j@kba.biglobe.ne.jp> wrote:
> At 20:13 +0000 09.1.9, Peter Stephenson wrote:
> > +patchlevel.h: $(sdir_top)/ChangeLog
> > +	{ \
> > +	  echo -n "#define ZSH_PATCHLEVEL "; \
> 
> This does not work on MacOSX 10.5 (Leopard), because sh's builtin
> echo does not accept the option '-n':

OK, how about

Index: Src/zsh.mdd
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/zsh.mdd,v
retrieving revision 1.20
diff -u -r1.20 zsh.mdd
--- Src/zsh.mdd	9 Jan 2009 20:31:23 -0000	1.20
+++ Src/zsh.mdd	13 Jan 2009 10:08:06 -0000
@@ -42,11 +42,9 @@
 	echo '#define ZSH_VERSION "'$(VERSION)'"' > $@
 
 patchlevel.h: $(sdir_top)/ChangeLog
-	{ \
-	  echo -n "#define ZSH_PATCHLEVEL "; \
-	  sed -ne 's/^\* *\$$''Revision: \(.*\) ''\$$/"\1"/p' \
-	  $(sdir_top)/ChangeLog; \
-	} >patchlevel.h
+	sed -ne \
+	's/^\* *\$$''Revision: \(.*\) ''\$$/#define ZSH_PATCHLEVEL "\1"/p' \
+	$(sdir_top)/ChangeLog >patchlevel.h
 
 zshcurses.h: ../config.h
 	@if test x$(ZSH_CURSES_H) != x; then \



-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

