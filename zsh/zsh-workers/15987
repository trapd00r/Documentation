From zsh-workers-return-15987-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 08 16:30:57 2001
Return-Path: <zsh-workers-return-15987-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 474 invoked from network); 8 Oct 2001 16:30:56 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Oct 2001 16:30:56 -0000
Received: (qmail 11039 invoked by alias); 8 Oct 2001 16:30:48 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15987
Received: (qmail 11025 invoked from network); 8 Oct 2001 16:30:47 -0000
X-VirusChecked: Checked
Sender: kiddleo@cav.logica.co.uk
Message-ID: <3BC1D497.44BC9E6A@yahoo.co.uk>
Date: Mon, 08 Oct 2001 17:30:15 +0100
From: Oliver Kiddle <okiddle@yahoo.co.uk>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.2.15 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: zsh-workers@sunsite.dk
Subject: compilation on IRIX 5
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

netinet/in_systm.h on IRIX 5 doesn't protect against being included
twice so it being included in both tcp.c and tcp.h results in an error.
Is it really necessary to duplicate this bit? Something like this patch
is necessary for compilation on IRIX 5.

When I changed the chmod in the C02 test for MacOS X I feared that it
would cause a problem elsewhere. It seems IRIX overloads the numbers
somehow for some `mandatory locking' feature. So I'll change that test
again once I've been able to check that I'm not breaking the test on
MacOS X again. That'll be whenever the sourceforge compilefarm comes
back up.

Oliver

Index: Src/Modules/tcp.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Modules/tcp.c,v
retrieving revision 1.17
diff -u -r1.17 tcp.c
--- Src/Modules/tcp.c   2001/10/08 07:19:35     1.17
+++ Src/Modules/tcp.c   2001/10/08 16:25:52
@@ -35,22 +35,6 @@
  */
 #include "tcp.h"
 
-/*
- * For some reason, configure doesn't always detect netinet/in_systm.h.
- * On some systems, including linux, this seems to be because gcc is
- * throwing up a warning message about the redefinition of
- * __USE_LARGEFILE.  This means the problem is somewhere in the
- * header files where we can't get at it.  For now, revert to
- * not including this file only on systems where we know it's missing.
- * Currently this is just cygwin.
- */
-#ifndef __CYGWIN__
-# include <netinet/in_systm.h>
-#endif
-#include <netinet/in.h>
-#include <netinet/ip.h>
-#include <arpa/inet.h>
-
 /* it's a TELNET based protocol, but don't think I like doing this */
 #include <arpa/telnet.h>

_____________________________________________________________________
This message has been checked for all known viruses by the 
MessageLabs Virus Scanning Service. For further information visit
http://www.messagelabs.com/stats.asp

