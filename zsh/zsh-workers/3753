From zsh-workers-request@math.gatech.edu Sun Feb 01 07:10:54 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 29173 invoked from network); 1 Feb 1998 07:10:52 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 1 Feb 1998 07:10:52 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id BAA16756;
	Sun, 1 Feb 1998 01:41:44 -0500 (EST)
Resent-Date: Sun, 1 Feb 1998 01:41:44 -0500 (EST)
Message-Id: <199802010316.DAA17515@twinklestar.demon.co.uk>
From: wez@twinklestar.demon.co.uk (Wez Furlong)
Date: Sun, 1 Feb 1998 03:16:02 +0000
X-Mailer: Mail User's Shell (7.2.6 beta(3) 11/17/96)
To: zsh-workers@math.gatech.edu
Subject: Zle bug
Resent-Message-ID: <"LxR2O3.0.l54.da1rq"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3753
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hi,

I am reporting a bug that is present in zsh 3.1.2 and also 3.1.2-zefram3.
I have mentioned it before (when 3.1.2 was first released) but it does not
appear to have been addressed.

Here's a demonstration:

% > zsh -f
% > echo $ZSH_VERSION
3.0.5
% > bindkey  '\e[A'   up-line-or-search
% > who
wez      tty3     Feb  1 00:37
root     tty4     Feb  1 00:42
root     tty2     Jan 31 16:51
wez      tty5     Feb  1 01:42
% > ls
Admin              Personal           UNI                root
Amiga              Povray             Wez-Crontab        spambounce.tar.gz
Dave               Src                mail.vim           tmp
PCMCIA             Stuff              mbox
% > w

At this point I press cursor up

% > who

This is correct.

And here is the bug, with 3.1.2:

% > zsh -f
% > echo $ZSH_VERSION
3.1.2
% > bindkey  '\e[A'   up-line-or-search
% > who
wez      tty3     Feb  1 00:37
root     tty4     Feb  1 00:42
root     tty2     Jan 31 16:51
wez      tty5     Feb  1 01:42
% > ls
Admin              Personal           UNI                root
Amiga              Povray             Wez-Crontab        spambounce.tar.gz
Dave               Src                mail.vim           tmp
PCMCIA             Stuff              mbox
% > w

Pressing cursor up produces a beep.

% > w


This is a feature which I use a lot, and it's a shame it is missing/broken. I
have tested this on the following:

Linux twinklestar 2.0.31 #4 Thu Dec 18 14:19:38 GMT 1997 m68k

And an SGI IRIX 5.3 system - we have had several older versions of zsh which
work correctly, but both builds of 3.1.2 and 3.1.2-zefram3 exhibit the broken
behaviour.

While on the subject of IRIX and zeframs baseline version, there were a couple
changes needed in order for the build to be successful. I had applied zeframs
diff, and the build diff to correct the bashisms (which failed on about 5
hunks - I tried the systems default patch, and the latest gnu patch - the gnu
version failed less hunks than the other).

After applying those hunks manually, I then had to edit Src/signames.awk and
Builtins/rlimits.awk and change the references to 034 to 042, as gawk (3.x)
was producing \^ (or something similar) instead of ". Note, however, that
042 is octal for 34 which is the ascii code for ". 034 is the ascii code for
FS, which is not really what is wanted. This could be a portability of
{g,m,n}awk issue - interpretation of different radices.

I hope you can sort out the zle thing, and also fix the build setup (I had to
get autoconf (for autoheader) which required gnu m4, and then apply patches by
hand etc. etc.) - the zefram version was very difficult to build on the
semi-stock IRIX setup.

I also hope this is a ``useful'' bug report. :-)

Thanks,

Wez.

--
Wez Furlong                        Undergrad - Electronic Systems Engineering
                                           http://www.twinklestar.demon.co.uk
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

