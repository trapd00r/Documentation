From zsh-workers-return-13261-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Dec 13 15:49:49 2000
Return-Path: <zsh-workers-return-13261-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24418 invoked from network); 13 Dec 2000 15:49:47 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Dec 2000 15:49:47 -0000
Received: (qmail 1622 invoked by alias); 13 Dec 2000 15:49:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13261
Received: (qmail 1615 invoked from network); 13 Dec 2000 15:49:42 -0000
Date: Wed, 13 Dec 2000 17:49:37 +0200
From: "Nadav Har'El" <nyh@math.technion.ac.il>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: zsh-workers@sunsite.auc.dk
Subject: Re: Bug in zsh 3.0.8
Message-ID: <20001213174937.A23159@leeor.math.technion.ac.il>
References: <20001213161430.A18626@leeor.math.technion.ac.il> <1001213153858.ZM11850@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2i
In-Reply-To: <1001213153858.ZM11850@candle.brasslantern.com>; from schaefer@candle.brasslantern.com on Wed, Dec 13, 2000 at 03:38:58PM +0000
Hebrew-Date: 16 Kislev 5761

On Wed, Dec 13, 2000, Bart Schaefer wrote about "Re: Bug in zsh 3.0.8":
> On Dec 13,  4:14pm, Nadav Har'El wrote:
> } 
> } /home/nyh$ cat /tmp/z.z
> } echo $ZSH_VERSION
> } let 'a[3]=2'
> } let 'a[3]=2'
> } /home/nyh$ zsh /tmp/z.z
> } 3.0.8
> } zsh: segmentation fault  zsh /tmp/z.z
> 
> I can't reproduce the crash here.  Further, a[3] gets set to 2 for me.
> 
> Does it happen to you with "zsh -f /tmp/z.z"?  If not, we need to know
> what your startup files are changing.

It also happens with zsh -f. My system is Redhat 7.0, with the vanilla zsh:
/home/nyh$ uname -a
Linux tigger.haifa.radware.co.il 2.2.16-22 #2 Wed Oct 4 10:49:01 IDT 2000 i686 unknown
/home/nyh$ rpm -qf /bin/zsh
zsh-3.0.8-3


> 
> Can you generate a stack trace, e.g. with gdb or dbx, and send it to us?

I'll try to compile zsh from sources to get a good stack-trace. So far I
only managed to get it from a non-stripped but non-"-g" binary I had lying
around, and got the following:
(gdb) r -f /tmp/z.z
Starting program: /usr/local/bin/zsh -f /tmp/z.z
3.0.8

Program received signal SIGSEGV, Segmentation fault.
0x806e0a5 in setiparam ()
(gdb) where
#0  0x806e0a5 in setiparam ()
#1  0x806a05d in setvar ()
#2  0x806b45f in op ()
#3  0x806b95f in mathparse ()
#4  0x806b60d in mathevall ()
#5  0x806b72f in matheval ()
#6  0x8054129 in bin_let ()
#7  0x804aa23 in execbuiltin ()
#8  0x80588a5 in execcmd ()
#9  0x8056930 in execpline2 ()
#10 0x80560d6 in execpline ()
#11 0x8055d33 in execlist ()
#12 0x8062f6c in loop ()
#13 0x8062ddc in main ()
#14 0x4005ae51 in __libc_start_main (main=0x8062cc0 <main>, argc=3, 
    ubp_av=0xbffffa44, init=0x8049ad4 <_init>, fini=0x809014c <_fini>, 
    rtld_fini=0x4000e264 <_dl_fini>, stack_end=0xbffffa3c)
    at ../sysdeps/generic/libc-start.c:111

If this is not enough information, I can compile it again with -g and
send you more information (and/or try to debug it myself).

Thanks!
	Nadav.

-- 
Nadav Har'El                        |   Wednesday, Dec 13 2000, 16 Kislev 5761
nyh@math.technion.ac.il             |-----------------------------------------
Phone: +972-53-245868, ICQ 13349191 |Computers are like air conditioners.
http://nadav.harel.org.il           |Both stop working if you open windows.

