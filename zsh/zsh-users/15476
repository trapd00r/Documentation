From zsh-users-return-15476-mason-zsh=primenet.com.au@zsh.org Sun Oct 24 04:40:33 2010
Return-Path: <zsh-users-return-15476-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17015 invoked by alias); 24 Oct 2010 04:40:33 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15476
Received: (qmail 9187 invoked from network); 24 Oct 2010 04:40:32 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: **
X-Spam-Status: No, score=2.2 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,RCVD_IN_NJABL_PROXY,RCVD_IN_SORBS_HTTP,
	RCVD_IN_SORBS_SOCKS autolearn=no version=3.3.1
Received-SPF: none (ns1.primenet.com.au: domain at sauria.com does not designate permitted sender hosts)
DomainKey-Signature: a=rsa-sha1; c=nofws; d=sauria.com; h=from:content-type
	:content-transfer-encoding:subject:date:message-id:to:
	mime-version; q=dns; s=sauria.com; b=AHfXifYY9wQ0CMVkBXKWweizH0R
	m5cI3VqWZT4tup4DNfTGCgV+4rkM688tnr4zw3lkHsxdX+eKf+WJkU2VcsIygeIY
	5IWUvF8YeLFvPE7B2n5Jdhu9joyiupjq3mF8dj4JUTGVSnAdhKCqoYTJ7XTNY2D3
	8HyepgdX6XF4Mp1s=
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=sauria.com; h=from
	:content-type:content-transfer-encoding:subject:date:message-id
	:to:mime-version; s=sauria.com; bh=OGVYZmlK6KJ/pPA85+U1slkjLw0=;
	 b=IglZf+ukqFyeh1vTJLSpjTgJaHd0VFYs/LNr3iiETTZ+n2y8xSXVlP8G6m7vN
	+PrNQihJgvbGMNN2IbxTc6Qk/moEwwcr6tUlGBv6nJ+grbVW6uWQUkp77sJjg+KD
	bPU36E8AxN0C2o3E4RL7FuK/Z/33OtbqVPMGuH0riIjxEk=
From: Ted Leung <twleung@sauria.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: Trouble with completion for a function
Date: Sat, 23 Oct 2010 21:14:56 -0700
Message-Id: <9B716C6F-B5EA-444E-999F-EE39DC5286F8@sauria.com>
To: zsh-users@zsh.org
Mime-Version: 1.0 (Apple Message framework v1081)
X-Mailer: Apple Mail (2.1081)

Hi,

I'm trying to write a completion for a function.  I only want the =
function arguments to be taken from the directory stack.

Here's the function

zq () {
  # function zq -- cd, qualified by searching the dirstack.
  #  take only the LAST (=3D=3D most recent) directory that matches.  =
NoIC.
  #  zq_dest=3D$( dh | grep "$1" | tail -1 )
  zq_dest=3D$( dirs -v | grep "$1" | head -1 )
  set -- $=3Dzq_dest
#  echo pushd ${(j:\ :)argv[2,${#argv}]}
  eval pushd "${(j:\ :)argv[2,${#argv}]}"
}

Here's the zstyle command that I think should be working

zstyle ':completion:*:*:zq:*:*' tag-order directory-stack

If I type  'zq ' and then c-x h, I get:

tags in context :completion::complete:zq::
    all-files  (_files _default (eval))

Could someone please give me some advice on what I am doing wrong, or =
how to debug this further?

Thanks in advance,

Ted Leung=

