From zsh-users-return-11079-mason-zsh=primenet.com.au@sunsite.dk Tue Dec 12 10:48:06 2006
Return-Path: <zsh-users-return-11079-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21975 invoked from network); 12 Dec 2006 10:47:59 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Dec 2006 10:47:59 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 68478 invoked from network); 12 Dec 2006 10:47:48 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Dec 2006 10:47:48 -0000
Received: (qmail 26068 invoked by alias); 12 Dec 2006 10:47:38 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11079
Received: (qmail 26059 invoked from network); 12 Dec 2006 10:47:37 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 12 Dec 2006 10:47:37 -0000
Received: (qmail 67214 invoked from network); 12 Dec 2006 10:47:37 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 12 Dec 2006 10:47:34 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly09c.srv.mailcontrol.com (MailControl) with ESMTP id kBCAjS6u013466
	for <zsh-users@sunsite.dk>; Tue, 12 Dec 2006 10:47:29 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 12 Dec 2006 10:43:58 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.8/8.13.4) with ESMTP id kBCAhuoJ005875
	for <zsh-users@sunsite.dk>; Tue, 12 Dec 2006 10:43:56 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.8/8.13.8/Submit) with ESMTP id kBCAhuaT005871
	for <zsh-users@sunsite.dk>; Tue, 12 Dec 2006 10:43:56 GMT
Message-Id: <200612121043.kBCAhuaT005871@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh users <zsh-users@sunsite.dk>
Subject: Re: confusing passage in zshexpn(1) 
In-reply-to: <20061212002156.GC2399@fsst.voodoo.lan> 
References: <20061212002156.GC2399@fsst.voodoo.lan>
Comments: In-reply-to Frank Terbeck <ft@bewatermyfriend.de>
   message dated "Tue, 12 Dec 2006 01:21:56 +0100."
Date: Tue, 12 Dec 2006 10:43:55 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 12 Dec 2006 10:43:58.0747 (UTC) FILETIME=[6DE9E6B0:01C71DDA]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-07-06-80 (www.mailcontrol.com) on 10.67.0.119

Frank Terbeck wrote:
> Hi list,
> 
> Someone on IRC wondered about a problem with the following passage in
> zshexpn(1):
> 
> [snip]
>  x##    (Requires EXTENDED_GLOB to be set.) Matches one or more occur-
>         rences of the pattern x. This operator has high precedence;
>         '12##' is equivalent to '1(2##)', rather than '(12)##'. No
>         more than two active '#' characters may appear together.
> [snap]
> 
> Because of this part of the manual he tried this:
> % setopt EXTENDED_GLOB; touch 12222; echo 1(2##)
> zsh: unknown file attribute
> 
> That's because of the trailing parentheses in the globbing pattern.
> But the manual suggests that this should work.

Well, as Bart pointed out, no it doesn't, it's indicating precedence of
interpretation and nowhere says it's in the form you need to match a
file under every possible circumstance.  But it's easy to add a
cautionary note.

> How could the fact be included, that this pattern is okay to use in
> the following position?
> 
> [snip]
> % file=12222
> % [[ ${file} == 1(2##) ]] && print match.
> match.

Do you mean you're suggesting this as an alternative example that would
actually work?  I think I'll just stick with the warning note---it's
cleaner to write this as 12## anyway, without the parentheses.  That's
why you don't fall over the glob qualifier problem in practice:  you
only need the parentheses when there are #'s after them.

By the way, if you feel yourself susceptible to problems like this,
you can set both NO_BARE_GLOB_QUAL and EXTENDED_GLOB and use (#q...) for
glob qualifiers.

Index: Doc/Zsh/expn.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/expn.yo,v
retrieving revision 1.74
diff -u -r1.74 expn.yo
--- Doc/Zsh/expn.yo	7 Nov 2006 22:47:07 -0000	1.74
+++ Doc/Zsh/expn.yo	12 Dec 2006 10:34:23 -0000
@@ -1504,7 +1504,8 @@
 Matches one or more occurrences of the pattern var(x).
 This operator has high precedence; `tt(12##)' is equivalent to `tt(1(2##))',
 rather than `tt((12)##)'.  No more than two active `tt(#)' characters may
-appear together.
+appear together.  (Note the potential clash with glob qualifiers in the
+form `tt(1(2##))' which should therefore be avoided.)
 )
 enditem()
 subsect(ksh-like Glob Operators)

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

