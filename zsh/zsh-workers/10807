From zsh-workers-return-10807-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Apr 18 12:25:26 2000
Return-Path: <zsh-workers-return-10807-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28357 invoked from network); 18 Apr 2000 12:25:24 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 Apr 2000 12:25:24 -0000
Received: (qmail 10392 invoked by alias); 18 Apr 2000 12:24:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10807
Received: (qmail 10382 invoked from network); 18 Apr 2000 12:24:28 -0000
Date: Tue, 18 Apr 2000 14:23:47 +0200 (MET DST)
Message-Id: <200004181223.OAA10448@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Tue, 18 Apr 2000 12:54:31 +0100
Subject: PATCH: Re: colonic _values with paths


Peter Stephenson wrote:

> This is rather minor, but I happened to notice.
> 
> _values always adds a suffix `:' when it's dealing with colon-separated
> arrays. 

You mean `_value'. We have both of them. In the same directory.
Terribly irritating.

> This is actually pretty annoying if the elements of the array are
> paths, when you'd prefer to have the usual `/' and add a `:' by hand where
> necessary.  How about only adding the `:' if the element doesn't already
> contain a `/' or initial `~'?  Or suppose I get in the habit of using
> `typeset -T' and adding things to real arrays?  Maybe the second
> alternative is better.

I wasn't sure which is better... this makes it insert the `/' as
usual. Unfortunately I can't think of a good way to make it add a `/'
for directories and a `:' for other files.

But at least this also makes the colon remove the slash.

Bye
 Sven

Index: Completion/Base/_value
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Base/_value,v
retrieving revision 1.2
diff -u -r1.2 _value
--- Completion/Base/_value	2000/04/17 08:22:44	1.2
+++ Completion/Base/_value	2000/04/18 12:23:09
@@ -23,7 +23,7 @@
        [[ "$PREFIX$SUFFIX" = *:* ]]; then
       compset -P '*:'
       compset -S ':*'
-      _default -qS: "$@"
+      _default -r '\-\n\t /:' "$@"
     else
       _default "$@"
     fi
@@ -46,7 +46,7 @@
   elif compset -P '-R'; then
     compset -P '*:'
     compset -S ':*'
-    _files -/ -S/ -r ' :' "$@"
+    _files -/ -S/ -r '\n\t\- /:' "$@"
   else
     _default "$@"
   fi

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

