From zsh-workers-return-16443-mason-zsh=primenet.com.au@sunsite.dk Mon Jan 14 10:25:06 2002
Return-Path: <zsh-workers-return-16443-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20478 invoked from network); 14 Jan 2002 10:25:04 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 14 Jan 2002 10:25:04 -0000
Received: (qmail 29462 invoked by alias); 14 Jan 2002 10:24:52 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16443
Received: (qmail 29403 invoked from network); 14 Jan 2002 10:24:50 -0000
From: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
To: "'Chmouel Boudjnah'" <chmouel@mandrakesoft.com>
Cc: "'Zsh hackers list'" <zsh-workers@sunsite.dk>
Subject: RE: PATCH: _urpmi update
Date: Mon, 14 Jan 2002 13:23:49 +0300
Message-ID: <000f01c19ce5$8e8cf1d0$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_0010_01C19CFE.B3DA29D0"
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.3416
In-Reply-To: <m366658d0o.fsf@giants.mandrakesoft.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2600.0000
Importance: Normal

This is a multi-part message in MIME format.

------=_NextPart_000_0010_01C19CFE.B3DA29D0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

> Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru> writes:
> 
> > It seems that urpmi rewrite has stabilized so this syncs completion
with
> > current version. I stopped attempts to support several urpmi
versions
> > because it has been changing too rapidly and we do not have this
> > completion in any released mandrake version as yet.
> >
> > Chmouel, if it looks O.K. please add to cooker?
> 
> yup look ok...

small fix (mostly for urpmi.addmedia --distrib)

-andrej


------=_NextPart_000_0010_01C19CFE.B3DA29D0
Content-Type: application/octet-stream;
	name="_urpmi.diff"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename="_urpmi.diff"

Index: Completion/Mandrake/Command/_urpmi=0A=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=0A=
RCS file: /cvsroot/zsh/zsh/Completion/Mandrake/Command/_urpmi,v=0A=
retrieving revision 1.3=0A=
diff -u -r1.3 _urpmi=0A=
--- Completion/Mandrake/Command/_urpmi	2002/01/13 13:11:18	1.3=0A=
+++ Completion/Mandrake/Command/_urpmi	2002/01/14 10:23:07=0A=
@@ -13,27 +13,21 @@=0A=
 _urpmi() {=0A=
     local state context line ret=3D1=0A=
     typeset -A opt_args=0A=
-    local update_policy=0A=
 =0A=
-    zstyle -s ":completion:*:*:urpmi:*" cache-policy update_policy=0A=
-    if [[ -z "$update_policy" ]]; then=0A=
-	zstyle ":completion:*:*:urpmi:*" cache-policy _urpmi_cache_policy=0A=
-    fi=0A=
-=0A=
     case "$service" in=0A=
 	urpmi.addmedia )=0A=
 	    _arguments -A '-*' \=0A=
 		"(--wget)--curl[use curl to retrieve distant files]" \=0A=
-		"--distrib[automatically create all media from an installation =
medium]" \=0A=
+		"(:)--distrib[automatically create all media from an installation =
medium]:media URL:->media_url" \=0A=
 		"--update[mark as update media]" \=0A=
 		"(--curl)--wget[use wget to retrieve distant files]" \=0A=
 		"-c[clean headers cache directory]" \=0A=
 		"-f[force generation of hdlist files]" \=0A=
 		"-h[try to find and use synthesis or hdlist file]" \=0A=
-		":name of media: " \=0A=
-		":media URL:->media_url" \=0A=
-		": :(with)" \=0A=
-		":relative path to hdlist file: " \=0A=
+		"(--distrib):name of media: " \=0A=
+		"(--distrib):media URL:->media_url" \=0A=
+		"(--distrib): :(with)" \=0A=
+		"(--distrib):relative path to hdlist file: " \=0A=
 	     && ret=3D0=0A=
 	;;=0A=
 	urpmi.removemedia )=0A=
@@ -120,5 +114,12 @@=0A=
 =0A=
     return $ret=0A=
 }=0A=
+=0A=
+local update_policy=0A=
+=0A=
+zstyle -s ":completion:*:*:urpmi:*" cache-policy update_policy=0A=
+if [[ -z "$update_policy" ]]; then=0A=
+    zstyle ":completion:*:*:urpmi:*" cache-policy =
_urpmi_cache_policy=0A=
+fi=0A=
 =0A=
 _urpmi "$@"=0A=

------=_NextPart_000_0010_01C19CFE.B3DA29D0--

