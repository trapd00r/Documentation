From zsh-workers-return-19755-mason-zsh=primenet.com.au@sunsite.dk Sun Apr 11 22:41:04 2004
Return-Path: <zsh-workers-return-19755-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6769 invoked from network); 11 Apr 2004 22:41:03 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 11 Apr 2004 22:41:03 -0000
Received: (qmail 4231 invoked by alias); 11 Apr 2004 22:40:52 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19755
Received: (qmail 4165 invoked from network); 11 Apr 2004 22:40:51 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 11 Apr 2004 22:40:51 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 11 Apr 2004 22:40:51 -0000
Received: (qmail 26808 invoked from network); 11 Apr 2004 22:40:51 -0000
Received: from ns1.primenet.com.au (HELO primenet.com.au) (@203.24.36.2)
  by a.mx.sunsite.dk with SMTP; 11 Apr 2004 22:40:48 -0000
Received: (qmail 25229 invoked by uid 8); 11 Apr 2004 22:40:39 -0000
To: zsh-workers@sunsite.dk
Path: not-for-mail
From: Geoff Wing <mason@primenet.com.au>
X-Newsgroups: lists.zsh.workers
Subject: Re: Crash of 4.2.0-dev-1
Date: Sun, 11 Apr 2004 22:40:39 +0000 (UTC)
Organization: PrimeNet Computer Consultants
Lines: 44
Message-ID: <slrnc7jib7.567.mason@g.primenet.com.au>
References: <slrnc7hv93.g5j.mason@g.primenet.com.au> <1040411160938.ZM17940@candle.brasslantern.com>
Reply-To: mason@primenet.com.au
NNTP-Posting-Host: sparkles.primenet.com.au
X-Trace: coral.primenet.com.au 1081723239 29560 203.43.15.10 (11 Apr 2004 22:40:39 GMT)
X-Complaints-To: usenet@coral.primenet.com.au
NNTP-Posting-Date: Sun, 11 Apr 2004 22:40:39 +0000 (UTC)
User-Agent: slrn/0.9.8.0 (NetBSD)
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

Bart Schaefer <schaefer@brasslantern.com> typed:
: On Apr 11,  8:09am, Geoff Wing wrote:
[...]
:     autoload +X -k kshtest
[...]
:} I don't understand why this is the correct error
:
: Because files loaded with kshautoload have to contain the full function
: definition, like so:
:
:     kshtest() {
: 	print "Running kshtest"
: 	unfunction kshtest
:     }

OK, according to the manual zshbuiltins(1) in autoload:

 ... With ksh-style autoloading, the contents of the file will not be
     executed immediately.  Instead, the function created will contain
     the contents of the file ...

I read this to mean the function created has as its body the contents of
the file and as such it wasn't strictly necessary to define the function
itself (guess I wasn't paying too much attention).  Oh, and now I've just
read further down (Oops).

: Whereas zsh expects it to have been defined as:
:
:     kshtest () {
: 	kshtest () {
: 	    print "Running kshtest"
: 	    unfunction kshtest
: 	}
: 	kshtest "$@"
:     }

This is what I get.

It's all working fine for me.  I'll try it without the zsh-mem stuff to
see if that's been avoiding the problem for me. 

Regards,
-- 
Geoff Wing

