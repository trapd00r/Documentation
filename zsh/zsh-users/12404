From zsh-users-return-12404-mason-zsh=primenet.com.au@sunsite.dk Wed Jan 09 12:41:01 2008
Return-Path: <zsh-users-return-12404-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23798 invoked from network); 9 Jan 2008 12:40:52 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 9 Jan 2008 12:40:52 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 48691 invoked from network); 9 Jan 2008 12:40:29 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 Jan 2008 12:40:29 -0000
Received: (qmail 12621 invoked by alias); 9 Jan 2008 12:40:17 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12404
Received: (qmail 12603 invoked from network); 9 Jan 2008 12:40:16 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 9 Jan 2008 12:40:16 -0000
Received: from virusfilter.dotsrc.org (bifrost [127.0.0.1])
	by spamfilter.dotsrc.org (Postfix) with ESMTP id 50A698058FF2
	for <zsh-users@sunsite.dk>; Wed,  9 Jan 2008 13:40:14 +0100 (CET)
Received: from cluster-g.mailcontrol.com (cluster-g.mailcontrol.com [85.115.41.190])
	by bifrost.dotsrc.org (Postfix) with ESMTP
	for <zsh-users@sunsite.dk>; Wed,  9 Jan 2008 13:40:13 +0100 (CET)
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly12g.srv.mailcontrol.com (MailControl) with ESMTP id m09CchSh016517
	for <zsh-users@sunsite.dk>; Wed, 9 Jan 2008 12:39:59 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Wed, 9 Jan 2008 12:39:48 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.1/8.13.4) with ESMTP id m09CdnFZ003128
	for <zsh-users@sunsite.dk>; Wed, 9 Jan 2008 12:39:49 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.1/8.14.1/Submit) with ESMTP id m09CdmR9003125
	for <zsh-users@sunsite.dk>; Wed, 9 Jan 2008 12:39:48 GMT
Message-Id: <200801091239.m09CdmR9003125@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: [ -f glob ]
In-reply-to: <20080109091335.49226.qmail@smasher.org>
References: <20080109091335.49226.qmail@smasher.org>
Comments: In-reply-to Atom Smasher <atom@smasher.org>
   message dated "Wed, 09 Jan 2008 22:13:32 +1300."
Date: Wed, 09 Jan 2008 12:39:48 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 09 Jan 2008 12:39:48.0926 (UTC) FILETIME=[B8E2CDE0:01C852BC]
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.71.0.122
X-Virus-Scanned: ClamAV using ClamSMTP

Atom Smasher wrote:
> here's a weird one...
> 
> this is part of a sanity test on line 369 of my zshrc (link below):
>      [ -f /usr/{share,lib,share/lib}/{zoneinfo,locale/TZ}/${TZ} ]

This is broken: -f expectes exactly one argument and you're giving it an
expression that expands to multiple arguments.  The [ ... ] form of
tests isn't recommended anyway, because the arguments aren't parsed
properly so this sort of error will be hidden.  But it's not at all
clear what you're trying to do.  I think you're looking to see if at
least one of the files in the expansion exists, in which case try
expanding the expression and using a null glob:

files=(/usr/{share,lib,share/lib}/{zoneinfo,locale/TZ}/${TZ}(N))
if (( ${#files} )); then
  # stuff
fi

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

