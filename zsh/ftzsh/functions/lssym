emulate -L zsh
#setopt localoptions xtrace

local file ret

if [[ -z "$1" ]]; then
    printf 'Usage: %s <file(s)>\n' "$0"
    return 1
fi

for file in "$@"; do
    (
     while [[ -h "$file" ]]; do
        ls -l "$file"
        builtin cd -q "${file:h}"
        file="$(readlink "${file:t}")"
     done
     ls -l "$file"
    )
    ret=$?
done
return $ret
