From zsh-workers-return-16034-mason-zsh=primenet.com.au@sunsite.dk Sun Oct 14 16:51:21 2001
Return-Path: <zsh-workers-return-16034-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20408 invoked from network); 14 Oct 2001 16:51:21 -0000
Received: from unknown (HELO sunsite.dk) (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 14 Oct 2001 16:51:21 -0000
Received: (qmail 6231 invoked by alias); 14 Oct 2001 16:51:13 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16034
Received: (qmail 6190 invoked from network); 14 Oct 2001 16:51:11 -0000
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <1011014165107.ZM6322@candle.brasslantern.com>
Date: Sun, 14 Oct 2001 16:51:07 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: _path_files problem: completion for "cvs commit" has stopped working
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

I apologize for not noticing this sooner, as it appears to date back to
July -- Sven's change to _path_files in 15389.

In 4.0.1 up through the head of the -patches branch, I can do this:

schaefer[502] cvs commit Completion/Unix/Command/_m<TAB>
schaefer[502] cvs commit Completion/Unix/Command/_mount

That is, it completes to exactly the file that has changed, ignoring all
the other _m* files in Completion/Unix/Command/.

In 4.1.0-dev-2, I get this:

schaefer<504> cvs commit Completion/Unix/Command/_m<TAB>                          
Completing file
_mount         _modutils*     _mail          _mh                         
_man           _mutt          _mysql_utils   _make                       

Needless to say, I don't like this at all.  The _complete_debug traces are
identical up to this point:

@@ -903,11 +905,11 @@
 : _all_labels:39:while else; _path_files -J directories -X Completing directory -g *~(*/|)CVS(/)
 : _path_files:6; local linepath realpath donepath prepath testpath exppath skips skipped
 : _path_files:7; local tmp1 tmp2 tmp3 tmp4 i orig eorig pre suf tpre tsuf opre osuf cpre
-: _path_files:8; local pats haspats ignore pfxsfx sopt gopt opt sdirs ignpar cfopt listsfx
+: _path_files:8; local pats haspats ignore pfx pfxsfx sopt gopt opt sdirs ignpar cfopt listsfx
 : _path_files:9; local nm=0 menu matcher mopts sort match mid accex fake
 : _path_files:11; typeset -U prepaths exppaths
 : _path_files:13; exppaths=( ) 
-: _path_files:17; zparseopts -a mopts P:=pfxsfx S:=pfxsfx q=pfxsfx r:=pfxsfx R:=pfxsfx W:=prepaths F:=ignore M+:=matcher J+: V+: X+: 1: 2: n: f=tmp1 /=tmp1 g+:-=tmp1
+: _path_files:17; zparseopts -a mopts P:=pfx S:=pfxsfx q=pfxsfx r:=pfxsfx R:=pfxsfx W:=prepaths F:=ignore M+:=matcher J+: V+: X+: 1 2 n f=tmp1 /=tmp1 g+:-=tmp1
 : _path_files:22; sopt=-g 
 : _path_files:23; ((  1  ))
 : _path_files:23:cmdand; haspats=yes 


-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

