From zsh-workers-return-11743-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 05 01:19:14 2000
Return-Path: <zsh-workers-return-11743-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6987 invoked from network); 5 Jun 2000 01:19:13 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 5 Jun 2000 01:19:13 -0000
Received: (qmail 15928 invoked by alias); 5 Jun 2000 01:19:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11743
Received: (qmail 15920 invoked from network); 5 Jun 2000 01:19:02 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000605011855.ZM20257@candle.brasslantern.com>
Date: Mon, 5 Jun 2000 01:18:55 +0000
In-Reply-To: <m2itvpteye.fsf@vador.mandrakesoft.com>
Comments: In reply to Chmouel Boudjnah <chmouel@mandrakesoft.com>
        "PATCH: complete rpm --{resign,addsign} in local" (Jun  4,  9:37pm)
References: <m2itvpteye.fsf@vador.mandrakesoft.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: complete rpm --{resign,addsign} in local
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jun 4,  9:37pm, Chmouel Boudjnah wrote:
} Subject: PATCH: complete rpm --{resign,addsign} in local
}
} --{rebuild,recompile} is always local files :
                                  ^^^^^

} +  --{resign,addsign}':*:RPM package:->package_file' \
                                         ^^^^^^^^^^^^

The package_file state will complete remote files via ftp URLs, as well as
local files.  If it really is the case that you can only rebuild a local
package file, the _rpm machine needs another state.

Meanwhile, it ought to complete http URLs as well as ftp.

Index: Completion/Linux/_rpm
===================================================================
@@ -211,12 +211,12 @@
         _files -g \*.spec && ret=0
     ;;
   package_file)
-    if compset -P ftp://; then
+    if compset -P '(f|ht)tp://'; then
       _hosts -S/ && ret=0
     else
       _alternative \
           'files:RPM package file:_files -g \*.\(\#i\)rpm' \
-          'prefixes:ftp URL prefix:compadd ftp://' && ret=0
+          'prefixes:URL prefix:compadd ftp:// http://' && ret=0
     fi
     ;;
   package_src)

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

