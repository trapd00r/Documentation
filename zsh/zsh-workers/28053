From zsh-workers-return-28053-mason-zsh=primenet.com.au@zsh.org Tue Jun 22 11:40:29 2010
Return-Path: <zsh-workers-return-28053-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13190 invoked by alias); 22 Jun 2010 11:40:29 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28053
Received: (qmail 8130 invoked from network); 22 Jun 2010 11:40:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_LOW,
	SPF_HELO_PASS autolearn=ham version=3.3.1
Received-SPF: none (ns1.primenet.com.au: domain at csr.com does not designate permitted sender hosts)
Date: Tue, 22 Jun 2010 12:02:42 +0100
From: Peter Stephenson <Peter.Stephenson@csr.com>
To: zsh-workers@zsh.org
Subject: Re: zsh doesn't load HISTFILE from readonly directory
Message-ID: <20100622120242.20875de4@csr.com>
In-Reply-To: <20100617170730.63c0bcde@csr.com>
References: <slrni19mjh.hil.joerg@alea.gnuu.de>
	<20100614150521.068ec280@csr.com>
	<20100614151626.185ba382@csr.com>
	<20100617170730.63c0bcde@csr.com>
Organization: Cambridge Silicon Radio
X-Mailer: Claws Mail 3.7.6 (GTK+ 2.18.9; i686-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 22 Jun 2010 11:02:47.0285 (UTC) FILETIME=[72A12250:01CB11FA]
X-Scanned-By: MailControl A_09_40_00 (www.mailcontrol.com) on 10.71.0.124

On Thu, 17 Jun 2010 17:07:30 +0100
Peter Stephenson <Peter.Stephenson@csr.com> wrote:
> > > Or should
> > > we simply issue a warning when and continue any time we can't lock
> > > the file?
> > 
> > So, as long as we narrow this to make a check for why we couldn't
> > create the lock (EACCES in this case) maybe this is the right way to
> > go after all?
> > 
> > We still need to decide when we should print an error.  I would be
> > tempted to do it every time.
> 
> This prints an error when fc fails, but not when interactive history
> fails.  It probably wants careful looking over:  note the change of
> meaning in return values from file locking.

I've committed this, so watch for oddities to do with history reading and
writing.

(I also committed a change to _zstyle by mistake which is harmless but
currently useless.  It should become more useful after I post some new
shell functions.)

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

