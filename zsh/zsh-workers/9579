From zsh-workers-return-9579-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Feb 05 07:00:07 2000
Return-Path: <zsh-workers-return-9579-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10835 invoked from network); 5 Feb 2000 07:00:06 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 5 Feb 2000 07:00:06 -0000
Received: (qmail 16247 invoked by alias); 5 Feb 2000 06:59:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9579
Received: (qmail 16239 invoked from network); 5 Feb 2000 06:59:55 -0000
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: _deb_packages cache problem
MIME-Version: 1.0 (generated by AKEMI 1.13.2 - =?ISO-2022-JP?B?Ig==?=
 =?ISO-2022-JP?B?GyRCQTA0Y0s8GyhCIg==?=)
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 05 Feb 2000 15:59:53 +0900
Message-ID: <rsq3dr8uoba.fsf@crane.jaist.ac.jp>
Lines: 20
User-Agent: Chao-gnus/6.12.5 AKEMI/1.13.2 (=?ISO-2022-JP?B?GyRCQTAbKEI=?=
 =?ISO-2022-JP?B?GyRCNGNLPBsoQg==?=) FLAM-DOODLE/1.12.6
 (=?ISO-2022-JP?B?GyRCM3cbKEI=?= 10R4.0/5.0) Emacs/20.4
 (sparc-sun-solaris2.6) MULE/4.0 (HANANOEN)

_deb_packages was testing a wrong variable for cache.

Index: Completion/Debian/_deb_packages
===================================================================
RCS file: /projects/zsh/zsh/Completion/Debian/_deb_packages,v
retrieving revision 1.1.1.8
diff -u -r1.1.1.8 _deb_packages
--- Completion/Debian/_deb_packages	2000/02/03 17:22:43	1.1.1.8
+++ Completion/Debian/_deb_packages	2000/02/05 06:54:52
@@ -3,7 +3,7 @@
 # Usage: _deb_packages expl... avail|installed|uninstalled
 
 _deb_packages_update_avail () {
-  if (( ! $+_deb_packages_cache_uninstalled )); then
+  if (( ! $+_deb_packages_cache_avail )); then
     _deb_packages_cache_avail=(
       ${(f)"$(apt-cache dumpavail | awk '/^Package:/ { print $2 }')"}
     )
-- 
Tanaka Akira

