From zsh-workers-return-17944-mason-zsh=primenet.com.au@sunsite.dk Sat Nov 16 03:13:50 2002
Return-Path: <zsh-workers-return-17944-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12244 invoked from network); 16 Nov 2002 03:13:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 16 Nov 2002 03:13:49 -0000
Received: (qmail 24990 invoked by alias); 16 Nov 2002 03:13:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17944
Received: (qmail 24982 invoked from network); 16 Nov 2002 03:13:39 -0000
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <1021116031310.ZM10476@candle.brasslantern.com>
Date: Sat, 16 Nov 2002 03:13:10 +0000
In-Reply-To: <23083.1037361354@csr.com>
Comments: In reply to Peter Stephenson <pws@csr.com>
        "Re: ulimit strangeness" (Nov 15, 11:55am)
References: <23083.1037361354@csr.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: ulimit strangeness
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Nov 15, 11:55am, Peter Stephenson wrote:
} Subject: Re: ulimit strangeness
}
} "Bart Schaefer" wrote:
} > It looks like this has something to do with the convoluted #ifdef that
} > prevents duplicate case labels in rlimits.c when both RLIMIT_RSS and
} > RLIMIT_VMEM are defined, but I haven't yet figured out what to fix.
} 
} My guess is the test `RLIMIT_RSS != RLIMIT_VMEM' is incorrectly failing
} in the preprocessor, i.e. it thinks RLIMIT_RSS == RLIMIT_VMEM owing to
} the way the definitions are laid out.

No, it's this, in Src/system.h:

/* we use the SVR4 constant instead of the BSD one */
#if !defined(RLIMIT_NOFILE) && defined(RLIMIT_OFILE)
# define RLIMIT_NOFILE RLIMIT_OFILE
#endif
#if !defined(RLIMIT_VMEM) && defined(RLIMIT_AS)
# define RLIMIT_VMEM RLIMIT_AS
#endif

So RLIMIT_VMEM *is* defined, and is not the same as RLIMIT_RSS, and ...

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

