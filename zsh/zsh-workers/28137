From zsh-workers-return-28137-mason-zsh=primenet.com.au@zsh.org Sun Aug 08 16:35:33 2010
Return-Path: <zsh-workers-return-28137-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15087 invoked by alias); 8 Aug 2010 16:35:33 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28137
Received: (qmail 25609 invoked from network); 8 Aug 2010 16:35:30 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_NONE
	autolearn=ham version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at ntlworld.com designates 81.103.221.47 as permitted sender)
From: Peter Stephenson <p.w.stephenson@ntlworld.com>
To: zsh-workers@zsh.org (Zsh hackers list)
Subject: PATCH: icky typo in zsh-mime-handler
X-Mailer: MH-E 8.2; nmh 1.3; GNU Emacs 23.1.1
Date: Sun, 08 Aug 2010 17:35:20 +0100
Message-ID: <3156.1281285320@pws-pc>
X-Cloudmark-Analysis: v=1.1 cv=3ENABmdyEd/Fm7fR7+mZIuMDn6+IErAeEhlfWBImZFk= c=1 sm=0 a=976nfR7wXooA:10 a=DogomfpGjd0A:10 a=NLZqzBF-AAAA:8 a=DF7hch6L9crdqDq7FtoA:9 a=ljeYP3hcLnWbyJ1n1k607lhIHJ0A:4 a=_dQi-Dcv4p4A:10 a=HpAAvcLHHh0Zw7uRqdWCyQ==:117

This made handlers with special characters in (in particular quotes)
fail.  Not sure how this didn't get picked up (but quite clearly my
fault).

Index: Functions/MIME/zsh-mime-handler
===================================================================
RCS file: /cvsroot/zsh/zsh/Functions/MIME/zsh-mime-handler,v
retrieving revision 1.12
diff -p -u -r1.12 zsh-mime-handler
--- Functions/MIME/zsh-mime-handler	23 May 2010 19:54:03 -0000	1.12
+++ Functions/MIME/zsh-mime-handler	8 Aug 2010 16:32:11 -0000
@@ -188,9 +188,9 @@ if [[ $handler = *%s* ]]; then
       # Probably we ought not even to handle multiple
       # arguments, but at least the error message ought
       # to make it obvious what's going on.
-      zformat -f command $handler s:"$argv[0]"
+      zformat -f command $handler s:"$argv[1]"
     else
-      zformat -f command $handler s:"${(q)argv[0]}"
+      zformat -f command $handler s:"${(q)argv[1]}"
     fi
     if (( list )); then
       execargs=(${(Q)${(z)command}} ${argv[1,-1]})

-- 
Peter Stephenson <p.w.stephenson@ntlworld.com>
Web page now at http://homepage.ntlworld.com/p.w.stephenson/

