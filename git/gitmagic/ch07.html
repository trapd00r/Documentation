<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Git Magic - Chapter&nbsp;7.&nbsp;Git Grandmastery</title>
  <link rel="stylesheet" href="default.css" type="text/css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
  <link rel="home" href="index.html" title="Git Magic">
  <link rel="up" href="index.html" title="Git Magic">
  <link rel="prev" href="ch06.html" title=
  "Chapter&nbsp;6.&nbsp;Multiplayer Git">
  <link rel="next" href="ch08.html" title=
  "Chapter&nbsp;8.&nbsp;Secrets Revealed">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
    <div class="toc">
      <ul>
<li><b>Git Magic</b></li>
        <li>
          <span class="preface"><a href=
          "index.html">Preface</a></span>

          <ul>
            <li><span class="section"><a href=
            "index.html#_thanks">Thanks!</a></span></li>

            <li><span class="section"><a href=
            "index.html#_license">License</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch01.html">1.
          Introduction</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch01.html#_work_is_play">Work is Play</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_version_control">Version
            Control</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_distributed_control">Distributed
            Control</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_a_silly_superstition">A Silly
            Superstition</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_merge_conflicts">Merge
            Conflicts</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch02.html">2. Basic
          Tricks</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch02.html#_saving_state">Saving State</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_add_delete_rename">Add, Delete,
            Rename</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_advanced_undo_redo">Advanced
            Undo/Redo</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_reverting">Reverting</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_changelog_generation">Changelog
            Generation</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_downloading_files">Downloading
            Files</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_the_bleeding_edge">The Bleeding
            Edge</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_instant_publishing">Instant
            Publishing</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_what_have_i_done">What Have I
            Done?</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_exercise">Exercise</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch03.html">3. Cloning
          Around</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch03.html#_sync_computers">Sync
            Computers</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_classic_source_control">Classic Source
            Control</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_secret_source">Secret
            Source</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bare_repositories">Bare
            repositories</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_push_versus_pull">Push versus
            pull</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_forking_a_project">Forking a
            Project</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_ultimate_backups">Ultimate
            Backups</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_light_speed_multitask">Light-Speed
            Multitask</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_guerilla_version_control">Guerilla Version
            Control</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_mercurial">Mercurial</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bazaar">Bazaar</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_why_i_use_git">Why I use
            Git</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch04.html">4. Branch
          Wizardry</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch04.html#_the_boss_key">The Boss Key</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_dirty_work">Dirty Work</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_quick_fixes">Quick Fixes</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_merging">Merging</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_uninterrupted_workflow">Uninterrupted
            Workflow</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_reorganizing_a_medley">Reorganizing a
            Medley</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_managing_branches">Managing
            Branches</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_temporary_branches">Temporary
            Branches</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_work_how_you_want">Work How You
            Want</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch05.html">5. Lessons of
          History</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch05.html#_i_stand_corrected">I Stand
            Corrected</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_8230_and_then_some">… And Then
            Some</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_local_changes_last">Local Changes
            Last</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_rewriting_history">Rewriting
            History</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_making_history">Making
            History</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_where_did_it_all_go_wrong">Where Did It All
            Go Wrong?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_who_made_it_all_go_wrong">Who Made It All
            Go Wrong?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_personal_experience">Personal
            Experience</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch06.html">6. Multiplayer
          Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch06.html#_who_am_i">Who Am I?</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_over_ssh_http">Git Over SSH,
            HTTP</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_over_anything">Git Over
            Anything</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_patches_the_global_currency">Patches: The
            Global Currency</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_sorry_we_8217_ve_moved">Sorry, We’ve
            Moved</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_remote_branches">Remote
            Branches</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_multiple_remotes">Multiple
            Remotes</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_my_preferences">My
            Preferences</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch07.html">7. Git
          Grandmastery</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch07.html#_source_releases">Source
            Releases</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_commit_what_changed">Commit What
            Changed</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_my_commit_is_too_big">My Commit Is Too
            Big!</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_the_index_git_8217_s_staging_area">The
            Index: Git’s Staging Area</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_don_8217_t_lose_your_head">Don’t Lose Your
            HEAD</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_head_hunting">HEAD-hunting</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_building_on_git">Building On
            Git</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_daring_stunts">Daring
            Stunts</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_preventing_bad_commits">Preventing Bad
            Commits</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch08.html">8. Secrets
          Revealed</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch08.html#_invisibility">Invisibility</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_integrity">Integrity</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_intelligence">Intelligence</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_indexing">Indexing</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_git_8217_s_origins">Git’s
            Origins</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_the_object_database">The Object
            Database</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_blobs">Blobs</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_trees">Trees</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_commits">Commits</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_indistinguishable_from_magic">Indistinguishable
            From Magic</a></span></li>
          </ul>
        </li>

        <li>
          <span class="appendix"><a href="apa.html">A. Git
          Shortcomings</a></span>

          <ul>
            <li><span class="section"><a href=
            "apa.html#_sha1_weaknesses">SHA1
            Weaknesses</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_microsoft_windows">Microsoft
            Windows</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_unrelated_files">Unrelated
            Files</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_who_8217_s_editing_what">Who’s Editing
            What?</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_file_history">File History</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_initial_clone">Initial Clone</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_volatile_projects">Volatile
            Projects</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_global_counter">Global
            Counter</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_empty_subdirectories">Empty
            Subdirectories</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_initial_commit">Initial
            Commit</a></span></li>

            <li><span class="section"><a href=
            "apa.html#_interface_quirks">Interface
            Quirks</a></span></li>
          </ul>
        </li>

        <li><span class="appendix"><a href="apb.html">B.
        Translating This Guide</a></span></li>
      </ul>
    </div>
<div class="content">
  <div class="chapter" title=
  "Chapter&nbsp;7.&nbsp;Git Grandmastery">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title"><a name=
          "_git_grandmastery"></a>Chapter&nbsp;7.&nbsp;Git
          Grandmastery</h2>
        </div>
      </div>
    </div>

    <p>By now, you should be able to navigate the <span class=
    "strong"><strong>git help</strong></span> pages and understand
    almost everything. However, pinpointing the exact command
    required to solve a given problem can be tedious. Perhaps I can
    save you some time: below are some recipes I have needed in the
    past.</p>

    <div class="section" title="Source Releases">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="_source_releases"></a>Source
            Releases</h2>
          </div>
        </div>
      </div>

      <p>For my projects, Git tracks exactly the files I’d like to
      archive and release to users. To create a tarball of the
      source code, I run:</p>
      <pre class="literallayout">
$ git archive --format=tar --prefix=proj-1.2.3/ HEAD
</pre>
    </div>

    <div class="section" title="Commit What Changed">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_commit_what_changed"></a>Commit What Changed</h2>
          </div>
        </div>
      </div>

      <p>Telling Git when you’ve added, deleted and renamed files
      is troublesome for certain projects. Instead, you can
      type:</p>
      <pre class="literallayout">
$ git add .
$ git add -u
</pre>

      <p>Git will look at the files in the current directory and
      work out the details by itself. Instead of the second add
      command, run <code class="literal">git commit -a</code> if
      you also intend to commit at this time. See <span class=
      "strong"><strong>git help ignore</strong></span> for how to
      specify files that should be ignored.</p>

      <p>You can perform the above in a single pass with:</p>
      <pre class="literallayout">
$ git ls-files -d -m -o -z | xargs -0 git update-index --add --remove
</pre>

      <p>The <span class="strong"><strong>-z</strong></span> and
      <span class="strong"><strong>-0</strong></span> options
      prevent ill side-effects from filenames containing strange
      characters. As this command adds ignored files, you may want
      to use the <code class="literal">-x</code> or <code class=
      "literal">-X</code> option.</p>
    </div>

    <div class="section" title="My Commit Is Too Big!">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_my_commit_is_too_big"></a>My Commit Is Too Big!</h2>
          </div>
        </div>
      </div>

      <p>Have you neglected to commit for too long? Been coding
      furiously and forgotten about source control until now? Made
      a series of unrelated changes, because that’s your style?</p>

      <p>No worries. Run:</p>
      <pre class="literallayout">
$ git add -p
</pre>

      <p>For each edit you made, Git will show you the hunk of code
      that was changed, and ask if it should be part of the next
      commit. Answer with "y" or "n". You have other options, such
      as postponing the decision; type "?" to learn more.</p>

      <p>Once you’re satisfied, type</p>
      <pre class="literallayout">
$ git commit
</pre>

      <p>to commit precisely the changes you selected (the
      <span class="emphasis"><em>staged</em></span> changes). Make
      sure you omit the <span class=
      "strong"><strong>-a</strong></span> option, otherwise Git
      will commit all the edits.</p>

      <p>What if you’ve edited many files in many places? Reviewing
      each change one by one becomes frustratingly mind-numbing. In
      this case, use <span class="strong"><strong>git add
      -i</strong></span>, whose interface is less straightforward,
      but more flexible. With a few keystrokes, you can stage or
      unstage several files at a time, or review and select changes
      in particular files only. Alternatively, run <span class=
      "strong"><strong>git commit --interactive</strong></span>
      which automatically commits after you’re done.</p>
    </div>

    <div class="section" title="The Index: Git’s Staging Area">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_the_index_git_8217_s_staging_area"></a>The Index:
            Git’s Staging Area</h2>
          </div>
        </div>
      </div>

      <p>So far we have avoided Git’s famous <span class=
      "emphasis"><em>index</em></span>, but we must now confront it
      to explain the above. The index is a temporary staging area.
      Git seldom shuttles data directly between your project and
      its history. Rather, Git first writes data to the index, and
      then copies the data in the index to its final
      destination.</p>

      <p>For example, <span class="strong"><strong>commit
      -a</strong></span> is really a two-step process. The first
      step places a snapshot of the current state of every tracked
      file into the index. The second step permanently records the
      snapshot now in the index. Committing without the
      <span class="strong"><strong>-a</strong></span> option only
      performs the second step, and only makes sense after running
      commands that somehow change the index, such as <span class=
      "strong"><strong>git add</strong></span>.</p>

      <p>Usually we can ignore the index and pretend we are reading
      straight from and writing straight to the history. On this
      occasion, we want finer control, so we manipulate the index.
      We place a snapshot of some, but not all, of our changes into
      the index, and then permanently record this carefully rigged
      snapshot.</p>
    </div>

    <div class="section" title="Don’t Lose Your HEAD">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_don_8217_t_lose_your_head"></a>Don’t Lose Your
            HEAD</h2>
          </div>
        </div>
      </div>

      <p>The HEAD tag is like a cursor that normally points at the
      latest commit, advancing with each new commit. Some Git
      commands let you move it. For example:</p>
      <pre class="literallayout">
$ git reset HEAD~3
</pre>

      <p>will move the HEAD three commits back. Thus all Git
      commands now act as if you hadn’t made those last three
      commits, while your files remain in the present. See the help
      page for some applications.</p>

      <p>But how can you go back to the future? The past commits
      know nothing of the future.</p>

      <p>If you have the SHA1 of the original HEAD then:</p>
      <pre class="literallayout">
$ git reset 1b6d
</pre>

      <p>But suppose you never took it down? Don’t worry: for
      commands like these, Git saves the original HEAD as a tag
      called ORIG_HEAD, and you can return safe and sound with:</p>
      <pre class="literallayout">
$ git reset ORIG_HEAD
</pre>
    </div>

    <div class="section" title="HEAD-hunting">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_head_hunting"></a>HEAD-hunting</h2>
          </div>
        </div>
      </div>

      <p>Perhaps ORIG_HEAD isn’t enough. Perhaps you’ve just
      realized you made a monumental mistake and you need to go
      back to an ancient commit in a long-forgotten branch.</p>

      <p>By default, Git keeps a commit for at least two weeks,
      even if you ordered Git to destroy the branch containing it.
      The trouble is finding the appropriate hash. You could look
      at all the hash values in <code class=
      "literal">.git/objects</code> and use trial and error to find
      the one you want. But there’s a much easier way.</p>

      <p>Git records every hash of a commit it computes in
      <code class="literal">.git/logs</code>. The subdirectory
      <code class="literal">refs</code> contains the history of all
      activity on all branches, while the file <code class=
      "literal">HEAD</code> shows every hash value it has ever
      taken. The latter can be used to find hashes of commits on
      branches that have been accidentally lopped off.</p>

      <p>The reflog command provides a friendly interface to these
      log files. Try</p>
      <pre class="literallayout">
$ git reflog
</pre>

      <p>Instead of cutting and pasting hashes from the reflog,
      try:</p>
      <pre class="literallayout">
$ git checkout "@{10 minutes ago}"
</pre>

      <p>Or checkout the 5th-last visited commit via:</p>
      <pre class="literallayout">
$ git checkout "@{5}"
</pre>

      <p>See the “Specifying Revisions” section of <span class=
      "strong"><strong>git help rev-parse</strong></span> for
      more.</p>

      <p>You may wish to configure a longer grace period for doomed
      commits. For example:</p>
      <pre class="literallayout">
$ git config gc.pruneexpire "30 days"
</pre>

      <p>means a deleted commit will only be permanently lost once
      30 days have passed and <span class="strong"><strong>git
      gc</strong></span> is run.</p>

      <p>You may also wish to disable automatic invocations of
      <span class="strong"><strong>git gc</strong></span>:</p>
      <pre class="literallayout">
$ git config gc.auto 0
</pre>

      <p>in which case commits will only be deleted when you run
      <span class="strong"><strong>git gc</strong></span>
      manually.</p>
    </div>

    <div class="section" title="Building On Git">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_building_on_git"></a>Building On Git</h2>
          </div>
        </div>
      </div>

      <p>In true UNIX fashion, Git’s design allows it to be easily
      used as a low-level component of other programs, such as GUI
      and web interfaces, alternative command-line interfaces,
      patch managements tools, importing and conversion tools and
      so on. In fact, some Git commands are themselves scripts
      standing on the shoulders of giants. With a little tinkering,
      you can customize Git to suit your preferences.</p>

      <p>One easy trick is to use built-in Git aliases to shorten
      your most frequently used commands:</p>
      <pre class="literallayout">
$ git config --global alias.co checkout
$ git config --global --get-regexp alias  # display current aliases
alias.co checkout
$ git co foo                              # same as 'git checkout foo'
</pre>

      <p>Another is to print the current branch in the prompt, or
      window title. Invoking</p>
      <pre class="literallayout">
$ git symbolic-ref HEAD
</pre>

      <p>shows the current branch name. In practice, you most
      likely want to remove the "refs/heads/" and ignore
      errors:</p>
      <pre class="literallayout">
$ git symbolic-ref HEAD 2&gt; /dev/null | cut -b 12-
</pre>

      <p>The <code class="literal">contrib</code> subdirectory is a
      treasure trove of tools built on Git. In time, some of them
      may be promoted to official commands. On Debian and Ubuntu,
      this directory lives at <code class=
      "literal">/usr/share/doc/git-core/contrib</code>.</p>

      <p>One popular resident is <code class=
      "literal">workdir/git-new-workdir</code>. Via clever
      symlinking, this script creates a new working directory whose
      history is shared with the original repository:</p>
      <pre class="literallayout">
$ git-new-workdir an/existing/repo new/directory
</pre>

      <p>The new directory and the files within can be thought of
      as a clone, except since the history is shared, the two trees
      automatically stay in sync. There’s no need to merge, push,
      or pull.</p>
    </div>

    <div class="section" title="Daring Stunts">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="_daring_stunts"></a>Daring
            Stunts</h2>
          </div>
        </div>
      </div>

      <p>These days, Git makes it difficult for the user to
      accidentally destroy data. But if you know what you are
      doing, you can override safeguards for common commands.</p>

      <p><span class="strong"><strong>Checkout</strong></span>:
      Uncommitted changes cause checkout to fail. To destroy your
      changes, and checkout a given commit anyway, use the force
      flag:</p>
      <pre class="literallayout">
$ git checkout -f HEAD^
</pre>

      <p>On the other hand, if you specify particular paths for
      checkout, then there are no safety checks. The supplied paths
      are quietly overwritten. Take care if you use checkout in
      this manner.</p>

      <p><span class="strong"><strong>Reset</strong></span>: Reset
      also fails in the presence of uncommitted changes. To force
      it through, run:</p>
      <pre class="literallayout">
$ git reset --hard 1b6d
</pre>

      <p><span class="strong"><strong>Branch</strong></span>:
      Deleting branches fails if this causes changes to be lost. To
      force a deletion, type:</p>
      <pre class="literallayout">
$ git branch -D dead_branch  # instead of -d
</pre>

      <p>Similarly, attempting to overwrite a branch via a move
      fails if data loss would ensue. To force a branch move,
      type:</p>
      <pre class="literallayout">
$ git branch -M source target  # instead of -m
</pre>

      <p>Unlike checkout and reset, these two commands defer data
      destruction. The changes are still stored in the .git
      subdirectory, and can be retrieved by recovering the
      appropriate hash from <code class="literal">.git/logs</code>
      (see "HEAD-hunting" above). By default, they will be kept for
      at least two weeks.</p>

      <p><span class="strong"><strong>Clean</strong></span>: Some
      git commands refuse to proceed because they’re worried about
      clobbering untracked files. If you’re certain that all
      untracked files and directories are expendable, then delete
      them mercilessly with:</p>
      <pre class="literallayout">
$ git clean -f -d
</pre>

      <p>Next time, that pesky command will work!</p>
    </div>

    <div class="section" title="Preventing Bad Commits">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_preventing_bad_commits"></a>Preventing Bad
            Commits</h2>
          </div>
        </div>
      </div>

      <p>Stupid mistakes pollute my repositories. Most frightening
      are missing files due to a forgotten <span class=
      "strong"><strong>git add</strong></span>. Lesser
      transgressions are trailing whitespace and unresolved merge
      conflicts: though harmless, I wish these never appeared on
      the public record.</p>

      <p>If only I had bought idiot insurance by using a
      <span class="emphasis"><em>hook</em></span> to alert me about
      these problems:</p>
      <pre class="literallayout">
$ cd .git/hooks
$ cp pre-commit.sample pre-commit  # Older Git versions: chmod +x pre-commit
</pre>

      <p>Now Git aborts a commit if useless whitespace or
      unresolved merge conflicts are detected.</p>

      <p>For this guide, I eventually added the following to the
      beginning of the <span class=
      "strong"><strong>pre-commit</strong></span> hook to guard
      against absent-mindedness:</p>
      <pre class="literallayout">
if git ls-files -o | grep '\.txt$'; then
  echo FAIL! Untracked .txt files.
  exit 1
fi
</pre>

      <p>Several git operations support hooks; see <span class=
      "strong"><strong>git help hooks</strong></span>. We activated
      the sample <span class=
      "strong"><strong>post-update</strong></span> hook earlier
      when discussing Git over HTTP. This runs whenever the head
      moves. The sample post-update script updates files Git needs
      for communication over Git-agnostic transports such as
      HTTP.</p>
    </div>
  </div><script type="text/javascript" src="find_selflink.js">
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1901330-2");
  pageTracker._initData();
  pageTracker._trackPageview();
  </script>
</div>
</div><div class="footer"><a href="/~blynn/">Ben Lynn</a></div>
</body>
</html>
