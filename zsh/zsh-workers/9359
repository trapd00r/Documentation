From zsh-workers-return-9359-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jan 19 01:10:24 2000
Return-Path: <zsh-workers-return-9359-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15188 invoked from network); 19 Jan 2000 01:10:23 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Jan 2000 01:10:23 -0000
Received: (qmail 15275 invoked by alias); 19 Jan 2000 01:10:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9359
Received: (qmail 15268 invoked from network); 19 Jan 2000 01:10:10 -0000
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: apt-cache search <TAB>
MIME-Version: 1.0 (generated by AKEMI 1.13.2 - =?ISO-2022-JP?B?Ig==?=
 =?ISO-2022-JP?B?GyRCQTA0Y0s8GyhCIg==?=)
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 19 Jan 2000 10:10:03 +0900
Message-ID: <rsq901m989g.fsf@crane.jaist.ac.jp>
Lines: 38
User-Agent: Chao-gnus/6.12.5 AKEMI/1.13.2 (=?ISO-2022-JP?B?GyRCQTAbKEI=?=
 =?ISO-2022-JP?B?GyRCNGNLPBsoQg==?=) FLAM-DOODLE/1.12.6
 (=?ISO-2022-JP?B?GyRCM3cbKEI=?= 10R4.0/5.0) Emacs/20.4
 (sparc-sun-solaris2.6) MULE/4.0 (HANANOEN)

I found that `apt-cache search <TAB>' prints `no more arguments'.
But it takes a pattern as an argument.

Also, this removes debugging code from _regex_arguments.

Index: Completion/Debian/_apt
===================================================================
RCS file: /projects/zsh/zsh/Completion/Debian/_apt,v
retrieving revision 1.1.1.17
diff -u -r1.1.1.17 _apt
--- Completion/Debian/_apt	1999/12/27 21:22:24	1.1.1.17
+++ Completion/Debian/_apt	2000/01/19 01:04:35
@@ -419,7 +419,7 @@
     /$'dumpavail\0'/ \| \
     /$'unmet\0'/ \| \
     /$'check\0'/ \| \
-    /$'search\0'/ \| \
+    /$'search\0'/ /$'[^\0]#\0'/ :'_message "pattern"' \| \
     /$'show\0'/ /$'[^\0]#\0'/ :'_deb_packages "$expl_packages[@]" avail' \# \| \
     /$'depends\0'/ \| \
     /"[]"/ :'_tags actions && compadd "$expl_action[@]" help add gencaches showpkg stats dump dumpavail unmet check search show depends'
Index: Completion/Base/_regex_arguments
===================================================================
RCS file: /projects/zsh/zsh/Completion/Base/_regex_arguments,v
retrieving revision 1.1.1.13
diff -u -r1.1.1.13 _regex_arguments
--- Completion/Base/_regex_arguments	1999/12/28 12:19:07	1.1.1.13
+++ Completion/Base/_regex_arguments	2000/01/19 01:04:34
@@ -77,7 +77,6 @@
       if [[ "$_ra_line[_ra_p1 + 1, -1]" = *$'\''\0'\''* ]]; then
 	_message "parse failed before current word"
       else
-	: $#PREFIX - $#_ra_line + $_ra_p1 : $_ra_p2
 	_ra_left="$_ra_line[_ra_p1 + 1, _ra_p2]"
 	_ra_right="$_ra_line[_ra_p2 + 1, -1]"
 	compset -p $(( $#PREFIX - $#_ra_line + $_ra_p1 ))
-- 
Tanaka Akira

