From zsh-workers-return-23762-mason-zsh=primenet.com.au@sunsite.dk Thu Aug 16 10:41:29 2007
Return-Path: <zsh-workers-return-23762-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20147 invoked from network); 16 Aug 2007 10:41:24 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 Aug 2007 10:41:24 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 66253 invoked from network); 16 Aug 2007 10:41:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Aug 2007 10:41:17 -0000
Received: (qmail 21984 invoked by alias); 16 Aug 2007 10:41:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23762
Received: (qmail 17963 invoked from network); 16 Aug 2007 09:59:33 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 16 Aug 2007 09:59:33 -0000
Received: (qmail 40198 invoked from network); 16 Aug 2007 09:59:32 -0000
Received: from rsm.demon.co.uk (HELO mail.marples.name) (80.177.111.50)
  by a.mx.sunsite.dk with SMTP; 16 Aug 2007 09:59:27 -0000
Received: from [10.73.1.31] (uberlaptop.marples.name [10.73.1.31])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))
	(No client certificate requested)
	by mail.marples.name (Postfix) with ESMTP id 5EAD2190038
	for <zsh-workers@sunsite.dk>; Thu, 16 Aug 2007 10:59:25 +0100 (BST)
Subject: [PATCH] Fix configure.ac to not to treate [ ] as quotes when using
	them in case
From: Roy Marples <roy@marples.name>
To: zsh-workers@sunsite.dk
Content-Type: multipart/mixed; boundary="=-MNYENb50C/ENAswW0+R8"
Date: Thu, 16 Aug 2007 10:59:23 +0100
Message-Id: <1187258364.1408.4.camel@uberlaptop.development.ltl>
Mime-Version: 1.0
X-Mailer: Evolution 2.10.2 


--=-MNYENb50C/ENAswW0+R8
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Hi list.

Attached is a patch to fix configure on FreeBSD.
This is needed as it uses a shell case statement to test for specific
FreeBSD versions. When run through autotools, it strips the [ ] bit as
it thinks they are quotes.

This fixes Gentoo bug #188930.
http://bugs.gentoo.org/show_bug.cgi?id=188930

Thanks

Roy Marples

PS - I'm not subscribed to this list, so email me directly if you have
queries.

--=-MNYENb50C/ENAswW0+R8
Content-Disposition: attachment; filename=zsh-4.3.4-configure-changequote.patch
Content-Type: text/x-patch; name=zsh-4.3.4-configure-changequote.patch; charset=UTF-8
Content-Transfer-Encoding: 7bit

diff -ur a/configure.ac b/configure.ac
--- a/configure.ac	2007-01-05 13:58:04 +0000
+++ b/configure.ac	2007-08-16 09:17:29 +0100
@@ -2249,6 +2249,10 @@
   zsh_cv_sys_elf=yes,
   zsh_cv_sys_elf=no,
   zsh_cv_sys_elf=yes)])
+  
+  # We use [0-9]* in case statements, so need to change quoting
+  changequote(, )
+
   DL_EXT="${DL_EXT=so}"
   if test x$zsh_cv_sys_elf = xyes; then
     case "$host" in
@@ -2352,6 +2356,10 @@
       esac
     ;;
   esac
+
+  # Done with our shell code, so restore autotools quoting
+  changequote([, ])
+  
   AC_CACHE_CHECK(if your dlsym() needs a leading underscore,
    zsh_cv_func_dlsym_needs_underscore,
    [echo failed >conftestval && cat >conftest.c <<EOM

--=-MNYENb50C/ENAswW0+R8--

