From zsh-users-return-6812-mason-zsh=primenet.com.au@sunsite.dk Tue Nov 25 08:18:25 2003
Return-Path: <zsh-users-return-6812-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9172 invoked from network); 25 Nov 2003 08:18:24 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 25 Nov 2003 08:18:24 -0000
Received: (qmail 7834 invoked by alias); 25 Nov 2003 08:18:03 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6812
Received: (qmail 7757 invoked from network); 25 Nov 2003 08:18:02 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 25 Nov 2003 08:18:02 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [219.55.112.42] by sunsite.dk (MessageWall 1.0.8) with SMTP; 25 Nov 2003 8:18:1 -0000
Received: from smile.house (smile.house [192.168.0.5])
	by juhp.dyndns.org (Postfix) with ESMTP id 2257B3B8003
	for <zsh-users@sunsite.dk>; Tue, 25 Nov 2003 17:18:00 +0900 (JST)
Received: from smile.house (localhost.house [127.0.0.1])
	by smile.house (Postfix) with ESMTP id C94ACCC428
	for <zsh-users@sunsite.dk>; Tue, 25 Nov 2003 17:17:59 +0900 (JST)
Date: Tue, 25 Nov 2003 17:17:59 +0900
Message-ID: <m3d6bgq2tk.wl%petersen@redhat.com>
From: Jens Petersen <petersen@redhat.com>
To: Zsh-users <zsh-users@sunsite.dk>
Subject: problem building zsh in background
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.4 (Hosorogi) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 14) (Reasonable Discussion) (i386-redhat-linux)
X-Face: 64N,SZ}bM~X-HZK0w(B)t]7rZ}7_bNq^}A%e7_;~lN3nVJ,50%>pW7y^=\\sy2w\"7?cu}g@t#JRW\\4kvSY8i%OMorx`_I]/5+~db.s\\H!)|YE.y#-sFk#]iYRU/w+({~_l-c1uS)s<KHR^vv$2e{OV6K~1S@^g4GxF`R@0HbB_/Y,0^cEHEFSR0iwdyXwJ,c[7a^2$A_5.x:7C5)^O[,w\\Ayq2foSPJ)BPKz2C2V95sQ!`8Zn+?Su(@Ht}>%;72$Nmv>U)ZeyLBdF#c-i.ECMy9>twG+9Ln$<vWho^=@SrMU6w
MIME-Version: 1.0 (generated by SEMI 1.14.4 - "Hosorogi")
Content-Type: text/plain; charset=US-ASCII

Any comments on this bug report:
<https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=102042>?

It seems easy to reproduce with both 4.0.7 and 4.1.1: eg

% rm -rf zsh-4.0.7
% tar tar jxf zsh-4.0.7.tar.bz2
% cd zsh-4.0.7
% ./configure &
:
:
checking if kill(pid, 0) returns ESRCH correctly... yes
checking if POSIX sigsuspend() works... yes
checking if tcsetpgrp() actually works...
[1]  + suspended (tty output)  ./configure


In the above report Roland McGrath comments "The zsh
configure script runs a program that does tcsetpgrp on fd 0
(stdin), which is broken in multiple ways.  If the input
were redirected then the test would give a false negative.
Since the input is your terminal and the job is in the
background, it rightly gets SIGTTOU for trying to perform
tcsetpgrp.  The only way a test of this nature can be safe
is if it's done on a specially created pty, e.g. in the
child of a forkpty call, but using ptys is not fully
portable so zsh is kind of stuck here."

Anyone looked into this before?

Jens

