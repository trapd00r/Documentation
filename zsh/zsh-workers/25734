From zsh-workers-return-25734-mason-zsh=primenet.com.au@sunsite.dk Tue Sep 23 18:02:25 2008
Return-Path: <zsh-workers-return-25734-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28616 invoked from network); 23 Sep 2008 18:02:22 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Sep 2008 18:02:22 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 72986 invoked from network); 23 Sep 2008 18:02:16 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Sep 2008 18:02:16 -0000
Received: (qmail 11543 invoked by alias); 23 Sep 2008 18:02:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25734
Received: (qmail 11526 invoked from network); 23 Sep 2008 18:02:10 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 23 Sep 2008 18:02:10 -0000
Received: from wa-out-1112.google.com (wa-out-1112.google.com [209.85.146.176])
	by bifrost.dotsrc.org (Postfix) with ESMTP id B187E80307AB
	for <zsh-workers@sunsite.dk>; Tue, 23 Sep 2008 20:02:03 +0200 (CEST)
Received: by wa-out-1112.google.com with SMTP id v27so1424734wah.21
        for <zsh-workers@sunsite.dk>; Tue, 23 Sep 2008 11:02:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to
         :subject:cc:in-reply-to:mime-version:content-type
         :content-transfer-encoding:content-disposition:references;
        bh=RSSFCo72xK9lS+MAyobbhxV64snJ3E3pLgUG0MlvcFc=;
        b=OUlQkRovOkm0ODWKdXeCeGqZxxi9olRgW6muq9advemEhghFbkSS79xojDVvFbJ1GA
         Z3JbbUPjyxdp6qZXILsW7HrMQRJAywNViRykXB8Z+t9GW/gNpyUQm4KwP5rbhIhYAhiM
         2z0LFB0gsF8bklvq4NmGOSMhHedSXze197Lv8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:cc:in-reply-to:mime-version
         :content-type:content-transfer-encoding:content-disposition
         :references;
        b=qYQAFvIhZkBiuagOGN+FWdkDTHYtNHXjyLtqkKv4hUUM1iIetJNe7Pcf0HyXH88rzh
         bN3XYzC0Px4d2S3TPyrYrkbGe/rtCttmmONrG0uXlLPpz5bLfzfayIHTcVq+PWDBVEK3
         AtHvMd33nLPFDBhFZ6hxogayytdmGqtnEJcS0=
Received: by 10.114.124.1 with SMTP id w1mr6764037wac.57.1222192921347;
        Tue, 23 Sep 2008 11:02:01 -0700 (PDT)
Received: by 10.114.159.2 with HTTP; Tue, 23 Sep 2008 11:02:01 -0700 (PDT)
Message-ID: <6cd6de210809231102y15863b2cwa0aaf04412a886d1@mail.gmail.com>
Date: Tue, 23 Sep 2008 14:02:01 -0400
From: "Rocky Bernstein" <rocky.bernstein@gmail.com>
To: "Peter Stephenson" <pws@csr.com>
Subject: Re: fc (history) requires zsh is interactive? Why can't interactive toggled?
Cc: "Zsh hackers list" <zsh-workers@sunsite.dk>
In-Reply-To: <20080923094249.073acbaa@news01>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <6cd6de210809211737o564e47a4jf7f92ada4cd970dc@mail.gmail.com>
	 <20080922130602.4746e4d1@news01>
	 <6cd6de210809220658x26698b78ga08f95eaa42644c@mail.gmail.com>
	 <200809221425.m8MEPcWg015191@news01.csr.com>
	 <6cd6de210809222031n12743897l3e4474593a9a780a@mail.gmail.com>
	 <20080923094249.073acbaa@news01>
X-Virus-Scanned: ClamAV 0.92.1/8316/Tue Sep 23 11:40:56 2008 on bifrost
X-Virus-Status: Clean

Many thanks!

(If you are in a hurry the rest can be safely skipped.)

I think for those who care about such things -- attaching to a running
non-interactive script and setting up an interactive terminal with
history--  this will be an improvement. No doubt this is a very small
(if not negligible) number. So for those who don't, I don't think the
change will be a drag.

I see a typo in dump history in B06fc.ztst: "dump history" => "dump
when history". I've been writing English just about all of my life and
I still manage to bungle sentences like this.

However sometime before a release I should add more fc test cases, in
addition to any issues that arise down the line. I suspect that (and
dread the time when)  folks take issue with how history is handled in
zshdb (or not handled) and how it interacts when there is interactive
history in the debugged the program.

But with more test cases and more coverage, hopefully we will come to
a better understanding in how this or some particular change effects
things and more confidence that making changes of this kind while
assuring it doesn't break things for others.

So thanks again.

On Tue, Sep 23, 2008 at 4:42 AM, Peter Stephenson <pws@csr.com> wrote:
> On Mon, 22 Sep 2008 23:31:51 -0400
> "Rocky Bernstein" <rocky.bernstein@gmail.com> wrote:
>> I removed the interact test and played around with fc and don't see
>> any difference.
>
> I'm really only concerned with the non-interactive behaviour, which
> probably only you have probed, so if you're happy with it there's probably
> nothing major to worry about.
>
>> Attached should be a two-line patch to #ifdef this code out. Apply it.
>> If people find problems in fc as a result of this change, I'll fix
>> these. If we get to a release and people for whatever reason feel the
>> that life was better disallowing fc unless in interactive mode, then
>> it is a matter of deleting two lines and you have the old behavior.
>
> It seems unlikely that will be necessary if you haven't fallen over
> anything horrible.
>
>> I will also remove the interactive flag on zshdb as another means of
>> getting test coverage there with a program that uses fc without
>> interactive mode set.
>>
>> And to show good faith in fixing whatever bugs come up, attached is a
>> test in an new "fc" file for the bug I recently discovered which by
>> the way has nothing to do with whether or not interactive is set.
>
> Thanks, both very useful.  I've committed both the changes.
>
> --
> Peter Stephenson <pws@csr.com>                  Software Engineer
> CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
> Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070
>

