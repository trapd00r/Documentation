From zsh-users-return-14661-mason-zsh=primenet.com.au@zsh.org Fri Dec 18 11:21:37 2009
Return-Path: <zsh-users-return-14661-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28641 invoked by alias); 18 Dec 2009 11:21:37 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14661
Received: (qmail 22108 invoked from network); 18 Dec 2009 11:21:35 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-3.0 required=5.0 tests=AWL,BAYES_00,
	RCVD_IN_DNSWL_LOW,SPF_HELO_PASS autolearn=ham version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at csr.com does not designate permitted sender hosts)
Message-Id: <200912181121.nBIBLIf9005083@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@zsh.org
Subject: Re: Force file completion when hitting TAB twice
In-reply-to: <20091218104616.49dafffa@news01>
References: <20091217175808.2e860888@abz8111lx.eurac.edu> <20091218104616.49dafffa@news01>
Comments: In-reply-to Peter Stephenson <pws@csr.com>
   message dated "Fri, 18 Dec 2009 10:46:16 +0000."
Date: Fri, 18 Dec 2009 11:21:18 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 18 Dec 2009 11:21:20.0936 (UTC) FILETIME=[39954A80:01CA7FD4]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-09-22-10 (www.mailcontrol.com) on 10.68.0.116

Peter Stephenson wrote:
> zstyle ':completion:*' completer _complete _complete-failed
                                                      ^
Sorry, obvious typo here:  that should be an underscore.  Tried the
following explicitly to make sure it did what I expected:


_complete_failed() {
  # Only complete if first attempt at completion failed.
  # Usage:
  #   zstyle ':completion:*' completer _complete _complete-failed
  #   zstyle ':completion:complete-failed:*' completer <your-completers>

  if [[ $LASTWIDGET = *complete* && -z $_complete_failed_active ]]; then
    local _complete_failed_active=1
    local -a completers
    local curcontext="complete-failed:::"
    _main_complete "${completers[@]}"
  fi
}
zstyle ':completion:*' completer _complete _complete_failed
zstyle ':completion:complete-failed:*' completer _files


-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

