From zsh-workers-return-20931-mason-zsh=primenet.com.au@sunsite.dk Sat Mar 05 07:56:21 2005
Return-Path: <zsh-workers-return-20931-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1122 invoked from network); 5 Mar 2005 07:56:20 -0000
Received: from ns2.primenet.com.au (HELO primenet.com.au) (?S1p+kN65Mk+cDNthy05gHeEEbNt3NiHW?@203.24.36.3)
  by ns1.primenet.com.au with (DHE-RSA-AES256-SHA encrypted) SMTP; 5 Mar 2005 07:56:20 -0000
Received: (qmail 28786 invoked from network); 5 Mar 2005 06:06:13 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns2.melb.primenet.com.au with SMTP; 5 Mar 2005 06:06:13 -0000
Received: (qmail 16576 invoked from network); 5 Mar 2005 06:05:07 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 Mar 2005 06:05:06 -0000
Received: (qmail 29113 invoked by alias); 5 Mar 2005 06:05:00 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20931
Received: (qmail 29099 invoked from network); 5 Mar 2005 06:05:00 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 Mar 2005 06:05:00 -0000
Received: (qmail 15484 invoked from network); 5 Mar 2005 06:05:00 -0000
Received: from tantale.fifi.org (64.81.251.130)
  by a.mx.sunsite.dk with SMTP; 5 Mar 2005 06:04:55 -0000
Received: from ceramic.fifi.org (Debian-exim@ceramic.fifi.org [64.81.251.131])
	by tantale.fifi.org (8.9.3p2/8.9.3/Debian 8.9.3-21) with ESMTP id WAA05394;
	Fri, 4 Mar 2005 22:04:50 -0800
Received: from phil by ceramic.fifi.org with local (Exim 4.34)
	id 1D7SPC-0003n8-42; Fri, 04 Mar 2005 22:04:50 -0800
To: Alexey Tourbin <at@altlinux.ru>
Cc: zsh-workers@sunsite.dk
Subject: Re: Fwd: why does zsh hate Perl, or vice versa?
References: <20050305045117.GJ16875@solemn.turbinal.org>
Mail-Copies-To: nobody
From: Philippe Troin <phil@fifi.org>
Date: 04 Mar 2005 22:04:50 -0800
In-Reply-To: <20050305045117.GJ16875@solemn.turbinal.org>
Message-ID: <87u0nqbpbx.fsf@ceramic.fifi.org>
Lines: 41
User-Agent: Gnus/5.09 (Gnus v5.9.0) Emacs/21.2
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

Alexey Tourbin <at@altlinux.ru> writes:

> JFYI
> 
> ----- Forwarded message from "Randal L. Schwartz" <merlyn@stonehenge.com> -----
> 
> Date: 19 Feb 2005 09:43:50 -0800
> From: merlyn@stonehenge.com (Randal L. Schwartz)
> Subject: why does zsh hate Perl, or vice versa?
> To: perl5-porters@perl.org
> Message-ID: <861xbc30o9.fsf@blue.stonehenge.com>
> User-Agent: Gnus/5.09 (Gnus v5.9.0) Emacs/21.3
> 
> 
> system("zsh") fires up a child zsh just fine.  But when
> the zsh exits, the Perl process is suspended!
> 
> Repeat by:
> 
> prompt$ perl
> print "one: "; <STDIN>;
> system "zsh";
> print "two: "; <STDIN>;
> ^D
> one: foo                <<<=== I typed "foo"
> subprompt$ date         <<<=== this is the subshell
> Sat Feb 19 09:39:19 PST 2005
> subprompt$ exit
> two: zsh: suspended (tty input)  perl
> prompt$ fg              <<<=== note we came back to outer shell prompt!
> [1]  + continued  perl
> bar                     <<<=== note the print worked, wasn't hung until read
> prompt$
> 
> Is it a problem with zsh, or system(), or some complex interaction?

This was an old bug (zsh forgot to reset the original tty foreground
process group after having created its own process group), it is fixed
in current CVS and I believe in 4.2.0.

Phil.

