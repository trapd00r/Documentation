From zsh-workers-return-9818-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Feb 21 12:56:42 2000
Return-Path: <zsh-workers-return-9818-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16841 invoked from network); 21 Feb 2000 12:56:41 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 21 Feb 2000 12:56:41 -0000
Received: (qmail 7236 invoked by alias); 21 Feb 2000 12:56:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9818
Received: (qmail 7229 invoked from network); 21 Feb 2000 12:56:35 -0000
Message-ID: <38B135F9.6F9EC0FD@fokus.gmd.de>
Date: Mon, 21 Feb 2000 13:56:25 +0100
From: Raimo Ihle <ihle@fokus.gmd.de>
X-Mailer: Mozilla 4.7 [en] (WinNT; I)
X-Accept-Language: en
MIME-Version: 1.0
To: zsh-workers@sunsite.auc.dk
Subject: Bug when compiling with CYGWIN (fix included)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Hello,

Thank you people for this nice shell. The Pragmatic Programmer Book
advised me to take a look at it. I hope this is the right place to
submit bug reports to.

Just compiled ZSh 3.1.6 which I hope is current, using CYGWIN B20 / NT4
/ egcs 2.91.57.

./configure && make gives:

gcc -c -I.  -DHAVE_CONFIG_H -Wall -Wno-implicit -Wmissing-prototypes
-O2  -o builtin.o builtin.c
builtin.c: In function `fixdir':
builtin.c:1085: `s0' undeclared (first use in this function)
builtin.c:1085: (Each undeclared identifier is reported only once
builtin.c:1085: for each function it appears in.)
make[2]: *** [builtin.o] Error 1
make[1]: *** [modobjs] Error 2
make: *** [all] Error 1

I suppose this happens because:

builtin.c (1063):

#ifdef __CYGWIN
    char *s0 = src;
#endif

builtin.c (1083):

#ifdef __CYGWIN__
     /* allow leading // under cygwin */
     if (src == s0 && src[1] == '/')
  *dest++ = *src++;
#endif


In my cygwin __CYGWIN__  is set, but not __CYGWIN (typo?).

To fix this problem: exchange in line 1063 __CYGWIN for __CYGWIN_ .

Thanks for your effort,
keep up the good work!
Raimo.

