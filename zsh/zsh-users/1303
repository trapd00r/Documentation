From zsh-workers-request@math.gatech.edu Sun Feb 01 15:16:52 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 6020 invoked from network); 1 Feb 1998 15:16:51 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 1 Feb 1998 15:16:51 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id JAA19576;
	Sun, 1 Feb 1998 09:59:34 -0500 (EST)
Resent-Date: Sun, 1 Feb 1998 09:59:13 -0500 (EST)
Message-ID: <swordfish.886345217@student.cs.york.ac.uk>
From: opk101@cs.york.ac.uk (Oliver Kiddle)
Date: Sun, 1 Feb 1998 14:50:40 +0000
X-Mailer: Mail User's Shell (7.2.6 beta(3) 11/17/96)
To: zsh-users@math.gatech.edu
Resent-Message-ID: <"4eYZl.0.In4.0t8rq"@math>
Resent-From: zsh-users@math.gatech.edu
Subject: Unidentified subject!
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1303
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

>From opk101 Sun Feb  1 14:37:39 1998
From: opk101@cs.york.ac.uk (Oliver Kiddle)
Date: Sun, 1 Feb 1998 14:37:39 +0000
In-Reply-To: borsenkow.msk@sni.de
       "Re: Completion on cd" (Feb  1, 12:53pm)
To: zsh-users@math.gatech.edu
Subject: Re: Completion on cd

On Feb 1, 12:53pm, borsenkow.msk@sni.de wrote:

> On Fri, 30 Jan 1998, Oliver Kiddle wrote:
> > % cd .netscape/[tab]
> >  -- All the *files* and directories in .netscape/ (not starting ".") are
> >  -- listed! I'd have expected it to complete to "cd .netscape/plugins/"

> I cannot reproduce it. compctl -/ cd correctly lists only directories,
> with or without . May be, it depends on some options settings; try zsh -f.

I ran zsh -f, put the cd compctl in and found the problem did not exist. 
I then added everything in my setup files a block at a time, checking
for the problem after each block so that I could try to determine where
the problem was being introduced.

I tracked the problem down to this line:

compctl -Tx 'C[0,*/*]' -f - 's[~]' -k users -S/ \
        - 'c[-1,-display]' -k hostnames -S':0 '

My first thought was that I had done something stupid when writing this
compctl but the troublesome part of it (the first line) was taken
directly from the Z Shell Guide (Edition 2.1.10, Chapter 18, Page 89 or
Edition 3.1.1, Chapter 19, Page 95)

There are a few thousand users at the university so I want this
completion to I attempted to find a better solution. My solution was
the following:

compctl -Tx 's[~] C[0,[^/]#]' -k users -S/

There may well be a problem with this though it seems to work and I
can't see any nasty suprises but I would strongly suggest that the
manual is changed so that nobody else has this problem. 

Note that the problem with cd ..[tab] beeping as opposed to completing
to cd ../ is still there.

Oliver Kiddle

PS Ignore my comment about the patch for the -Y option in my last
e-mail: when testing it I had forgotten that I was still running zsh
3.0.1 from an earlier test.


-- 
 __
/  \|.   _ _  |_/. _| _|| _     E-mail: opk101@cs.york.ac.uk
\__/||\/(-|   | \|(_|(_||(-        Web: http://www.york.ac.uk/~opk101/

