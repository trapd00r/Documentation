From zsh-users-return-8345-mason-zsh=primenet.com.au@sunsite.dk Mon Jan 10 10:46:43 2005
Return-Path: <zsh-users-return-8345-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9190 invoked from network); 10 Jan 2005 10:46:42 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 10 Jan 2005 10:46:42 -0000
Received: (qmail 42741 invoked from network); 10 Jan 2005 10:46:37 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 10 Jan 2005 10:46:37 -0000
Received: (qmail 10070 invoked by alias); 10 Jan 2005 10:45:46 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8345
Received: (qmail 10056 invoked from network); 10 Jan 2005 10:45:44 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 10 Jan 2005 10:45:44 -0000
Received: (qmail 39535 invoked from network); 10 Jan 2005 10:44:45 -0000
Received: from mailhost1.csr.com (HELO MAILSWEEPER01.csr.com) (81.105.217.43)
  by a.mx.sunsite.dk with SMTP; 10 Jan 2005 10:44:42 -0000
Received: from exchange03.csr.com (unverified [10.100.137.60]) by MAILSWEEPER01.csr.com
 (Content Technologies SMTPRS 4.3.12) with ESMTP id <T6e68a1455e0a6c8d012dc@MAILSWEEPER01.csr.com> for <zsh-users@sunsite.dk>;
 Mon, 10 Jan 2005 10:43:22 +0000
Received: from news01.csr.com ([10.103.143.38]) by exchange03.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 10 Jan 2005 10:46:49 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.1/8.12.11) with ESMTP id j0AAikch003768
	for <zsh-users@sunsite.dk>; Mon, 10 Jan 2005 10:44:46 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.1/8.13.1/Submit) with ESMTP id j0AAikYc003765
	for <zsh-users@sunsite.dk>; Mon, 10 Jan 2005 10:44:46 GMT
Message-Id: <200501101044.j0AAikYc003765@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users <zsh-users@sunsite.dk>
Subject: Re: Expansions with glob_complete ignore no_case_glob 
In-reply-to: <200501082341.04828.cht@chello.at> 
References: <200501082341.04828.cht@chello.at>
Date: Mon, 10 Jan 2005 10:44:45 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 10 Jan 2005 10:46:49.0811 (UTC) FILETIME=[B04D7230:01C4F701]
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

Christian Taylor wrote:
> Hi! I'm running zsh 4.2.1 under Linux, and I've observed the following 
> unexpected behaviour:
> 
> With glob_complete set, the menu-completion of a glob pattern should contain 
> the same matches that would be inserted if glob_complete was not set (except 
> that a '*' is added at the end of the pattern). However, the menu-completion 
> always globs case-sensitive, even if no_case_glob is set. Only including (#i)
>  
> in the pattern causes the menu-completion to ignore case.

Yes, this is deliberate for patterns.  As you've spotted, glob_complete
doesn't do filename generation.  This means NO_CASE_GLOB doesn't apply:

CASE_GLOB <D>
       Make globbing (filename generation)  sensitive  to  case.   Note
       that  other  uses  of patterns are always sensitive to case.  If
       the option is unset, the presence of any character which is spe-
       cial  to  filename generation will cause case-insensitive match-
       ing.  For example, cvs(/) can match the directory CVS  owing  to
       the   presence   of   the   globbing  flag  (unless  the  option
       BARE_GLOB_QUAL is unset).

To control case-sensitivity in completion you need to use the more
sophisticated "match control" feature:

zstyle ':completion:*' matcher-list '' 'm:{a-zA-Z}={A-Za-z}'

This version tries completion without case conversion, then with, and
replaces the value on the command line with the value generated by
completion.  This is normally correct, but you can choose instead to
have the version on the command line left alone by using "M:" at the
start instead.

See the description of the matcher-list style in the zshcompsys manual
and the Matching Control section in the zshcompwid manual.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


**********************************************************************
This email and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this email in error please notify
the system manager.

This footnote also confirms that this email message has been swept by
MIMEsweeper for the presence of computer viruses.

www.mimesweeper.com
**********************************************************************

