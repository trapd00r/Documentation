From zsh-workers-return-23805-mason-zsh=primenet.com.au@sunsite.dk Thu Aug 30 08:57:37 2007
Return-Path: <zsh-workers-return-23805-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4631 invoked from network); 30 Aug 2007 08:57:28 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 30 Aug 2007 08:57:28 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 23114 invoked from network); 30 Aug 2007 08:57:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 30 Aug 2007 08:57:22 -0000
Received: (qmail 11959 invoked by alias); 30 Aug 2007 08:57:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23805
Received: (qmail 11950 invoked from network); 30 Aug 2007 08:57:19 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 30 Aug 2007 08:57:18 -0000
Received: (qmail 22825 invoked from network); 30 Aug 2007 08:57:18 -0000
Received: from vinc17.pck.nerim.net (HELO prunille.vinc17.org) (213.41.242.187)
  by a.mx.sunsite.dk with SMTP; 30 Aug 2007 08:57:12 -0000
Received: by prunille.vinc17.org (Postfix, from userid 501)
	id AA81B18ACCD1; Thu, 30 Aug 2007 10:57:11 +0200 (CEST)
Date: Thu, 30 Aug 2007 10:57:11 +0200
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-workers@sunsite.dk
Subject: zsh 4.3.4 crashes in prompt-related code under Mac OS X
Message-ID: <20070830085711.GH27290@prunille.vinc17.org>
Mail-Followup-To: zsh-workers@sunsite.dk
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
X-Mailer-Info: http://www.vinc17.org/mutt/
User-Agent: Mutt/1.5.16-vl-r18739 (2007-08-28)

zsh 4.3.4 sometimes crashes in prompt-related code under Mac OS X.
Each time, this happens when I did a "ssh <some machine>" and the
ssh connection is (automatically) closed. Note in case this is
important: "ssh" is a zsh function here.

Here's crash information (with backtrace):

Date/Time:      2007-08-24 19:57:42.979 +0200
OS Version:     10.4.10 (Build 8R218)
Report Version: 4

Command: zsh
Path:    /opt/local/bin/zsh
Parent:  iTerm [329]

Version: ??? (???)

PID:    860
Thread: 0

Exception:  EXC_BAD_ACCESS (0x0001)
Codes:      KERN_PROTECTION_FAILURE (0x0002) at 0x00000008

Thread 0 Crashed:
0   libSystem.B.dylib   0x90006328 free + 72
1   zsh                 0x00071640 preprompt + 224
2   zsh                 0x0002ac30 loop + 160
3   zsh                 0x0002dc5c zsh_main + 636
4   zsh                 0x0000209c _start + 760
5   zsh                 0x00001da0 start + 48


Date/Time:      2007-08-24 19:57:58.318 +0200
OS Version:     10.4.10 (Build 8R218)
Report Version: 4

Command: zsh
Path:    /opt/local/bin/zsh
Parent:  iTerm [329]

Version: ??? (???)

PID:    920
Thread: 0

Exception:  EXC_BAD_ACCESS (0x0001)
Codes:      KERN_PROTECTION_FAILURE (0x0002) at 0x00000000

Thread 0 Crashed:
0   zsh         0x0006e890 wcs_nicechar + 848
1   zsh         0x0005ab0c stradd + 236
2   zsh         0x0005c78c putpromptchar + 3340
3   zsh         0x0005d44c promptexpand + 316
4   zsh         0x000096fc bin_print + 860
5   zsh         0x00002ce4 execbuiltin + 1588
6   zsh         0x00018014 execcmd + 9812
7   zsh         0x00018618 execpline2 + 408
8   zsh         0x00018a60 execpline + 576
9   zsh         0x000196b8 execlist + 808
10  zsh         0x00019bf8 execcursh + 184
11  zsh         0x00017b40 execcmd + 8576
12  zsh         0x00018618 execpline2 + 408
13  zsh         0x00018a60 execpline + 576
14  zsh         0x000196b8 execlist + 808
15  zsh         0x00019c64 execode + 68
16  zsh         0x00019d88 runshfunc + 264
17  zsh         0x0001a14c doshfunc + 892
18  zsh         0x00069bbc callhookfunc + 124
19  zsh         0x00071688 preprompt + 296
20  zsh         0x0002ac30 loop + 160
21  zsh         0x0002dc5c zsh_main + 636
22  zsh         0x0000209c _start + 760
23  zsh         0x00001da0 start + 48


Date/Time:      2007-08-24 19:59:12.824 +0200
OS Version:     10.4.10 (Build 8R218)
Report Version: 4

Command: zsh
Path:    /opt/local/bin/zsh
Parent:  iTerm [329]

Version: ??? (???)

PID:    980
Thread: 0

Exception:  EXC_BAD_ACCESS (0x0001)
Codes:      KERN_PROTECTION_FAILURE (0x0002) at 0x00000008

Thread 0 Crashed:
0   libSystem.B.dylib   0x90006328 free + 72
1   zsh                 0x00071640 preprompt + 224
2   zsh                 0x0002ac30 loop + 160
3   zsh                 0x0002dc5c zsh_main + 636
4   zsh                 0x0000209c _start + 760
5   zsh                 0x00001da0 start + 48


Date/Time:      2007-08-29 17:01:28.197 +0200
OS Version:     10.4.10 (Build 8R218)
Report Version: 4

Command: zsh
Path:    /opt/local/bin/zsh
Parent:  iTerm [25726]

Version: ??? (???)

PID:    26140
Thread: 0

Exception:  EXC_BAD_ACCESS (0x0001)
Codes:      KERN_PROTECTION_FAILURE (0x0002) at 0x00000000

Thread 0 Crashed:
0   zsh         0x0006e890 wcs_nicechar + 848
1   zsh         0x0005ab0c stradd + 236
2   zsh         0x0005c78c putpromptchar + 3340
3   zsh         0x0005d44c promptexpand + 316
4   zsh         0x000096fc bin_print + 860
5   zsh         0x00002ce4 execbuiltin + 1588
6   zsh         0x00018014 execcmd + 9812
7   zsh         0x00018618 execpline2 + 408
8   zsh         0x00018a60 execpline + 576
9   zsh         0x000196b8 execlist + 808
10  zsh         0x00019bf8 execcursh + 184
11  zsh         0x00017b40 execcmd + 8576
12  zsh         0x00018618 execpline2 + 408
13  zsh         0x00018a60 execpline + 576
14  zsh         0x000196b8 execlist + 808
15  zsh         0x00019c64 execode + 68
16  zsh         0x00019d88 runshfunc + 264
17  zsh         0x0001a14c doshfunc + 892
18  zsh         0x00069bbc callhookfunc + 124
19  zsh         0x00071688 preprompt + 296
20  zsh         0x0002ac30 loop + 160
21  zsh         0x0002dc5c zsh_main + 636
22  zsh         0x0000209c _start + 760
23  zsh         0x00001da0 start + 48

-- 
Vincent Lefèvre <vincent@vinc17.org> - Web: <http://www.vinc17.org/>
100% accessible validated (X)HTML - Blog: <http://www.vinc17.org/blog/>
Work: CR INRIA - computer arithmetic / Arenaire project (LIP, ENS-Lyon)

