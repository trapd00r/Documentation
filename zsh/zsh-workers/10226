From zsh-workers-return-10226-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Mar 24 11:56:14 2000
Return-Path: <zsh-workers-return-10226-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10595 invoked from network); 24 Mar 2000 11:56:09 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Mar 2000 11:56:09 -0000
Received: (qmail 5279 invoked by alias); 24 Mar 2000 11:55:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10226
Received: (qmail 5267 invoked from network); 24 Mar 2000 11:55:55 -0000
Date: Fri, 24 Mar 2000 12:55:52 +0100 (MET)
Message-Id: <200003241155.MAA25903@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 24 Mar 2000 20:02:30 +0900
Subject: Re: a directory `a#'.


Tanaka Akira wrote:

> Z(2):akr@is27e1u11% Src/zsh -f
> is27e1u11% bindkey -e; autoload -U compinit; compinit -D; compdef _tst tst
> is27e1u11% mkdir a\#
> is27e1u11% touch a\#/b
> is27e1u11% ls a\#/ 
> 
> This inserts a space rather than `b '.

Small quoting problem when testing for ambiguity.

Bye
 Sven

diff -ru ../z.old/Completion/Core/_path_files Completion/Core/_path_files
--- ../z.old/Completion/Core/_path_files	Fri Mar 24 12:23:16 2000
+++ Completion/Core/_path_files	Fri Mar 24 12:54:58 2000
@@ -417,9 +418,9 @@
     # Next we see if this component is ambiguous.
 
     if [[ "$tmp3" = */* ]]; then
-       tmp4=$tmp1[(I)^${tmp1[1]%%/*}/*]
+       tmp4=$tmp1[(I)^${(q)tmp1[1]%%/*}/*]
     else
-       tmp4=$tmp1[(I)^${tmp1[1]}]
+       tmp4=$tmp1[(I)^${(q)tmp1[1]}]
     fi
 
     if [[ "$tpre" = */* ]]; then

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

