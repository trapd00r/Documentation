From zsh-workers-return-22782-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 27 17:09:33 2006
Return-Path: <zsh-workers-return-22782-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5150 invoked from network); 27 Sep 2006 17:09:30 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.5 (2006-08-29) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 27 Sep 2006 17:09:30 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 9988 invoked from network); 27 Sep 2006 17:09:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Sep 2006 17:09:22 -0000
Received: (qmail 12539 invoked by alias); 27 Sep 2006 17:09:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22782
Received: (qmail 12530 invoked from network); 27 Sep 2006 17:09:18 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 27 Sep 2006 17:09:18 -0000
Received: (qmail 9658 invoked from network); 27 Sep 2006 17:09:18 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 27 Sep 2006 17:09:16 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly14c.srv.mailcontrol.com (MailControl) with ESMTP id k8RH96WU031518
	for <zsh-workers@sunsite.dk>; Wed, 27 Sep 2006 18:09:06 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Wed, 27 Sep 2006 18:09:05 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.7/8.13.4) with ESMTP id k8RH96e6031797
	for <zsh-workers@sunsite.dk>; Wed, 27 Sep 2006 18:09:06 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.7/8.13.7/Submit) with ESMTP id k8RH95U7031794
	for <zsh-workers@sunsite.dk>; Wed, 27 Sep 2006 18:09:06 +0100
Message-Id: <200609271709.k8RH95U7031794@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: PATCH: Set index of first non-option argument in _arguments 
In-reply-to: <200609271629.k8RGTkll031019@news01.csr.com> 
References: <200609271629.k8RGTkll031019@news01.csr.com>
Comments: In-reply-to Peter Stephenson <pws@csr.com>
   message dated "Wed, 27 Sep 2006 17:29:46 +0100."
Date: Wed, 27 Sep 2006 18:09:05 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 27 Sep 2006 17:09:06.0005 (UTC) FILETIME=[A384A850:01C6E257]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-07-04-02 (www.mailcontrol.com) on 10.67.0.124

Peter Stephenson wrote:
> One thing that's annoyed me about _arguments (let's stick at that for now,
> shall we?) is that although it, or rather the comparguments builtin,
> knows perfectly well where the first argument after the options
> started, it won't tell you.  This makes it unnecessarily difficult to
> handle commands with subcommands with different arguments (such as cvs
> or svn); you basically have to reparse the command line yourself to do
> it properly.

To be scrupulous:  that's not entirely true.  There's an option
*::: to limit the words in the completion array to just the arguments.
However, that's not necessarily flexible enough.  What probably would
have been would be looking at the context which should be set to
include argument-N, and that N is just CURRENT - NORMARG + 1.

Still, I've done it now.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

