From zsh-workers-return-8966-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Dec 09 10:40:40 1999
Return-Path: <zsh-workers-return-8966-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3591 invoked from network); 9 Dec 1999 10:40:39 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 Dec 1999 10:40:39 -0000
Received: (qmail 27875 invoked by alias); 9 Dec 1999 10:39:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8966
Received: (qmail 27126 invoked from network); 9 Dec 1999 10:34:34 -0000
Date: Thu, 9 Dec 1999 10:34:02 GMT
Message-Id: <199912091034.KAA20200@mango.dublin.iona.ie>
From: zefram@fysh.org
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: correct HTML manual installation

Clint Adams wrote:
>I assume since there's no mention of it in Zefram's list of changes,
>that this was an unintentional omission in 8950.

Sorry.  The unintentional omission was from the list of changes.
I removed the HTML installation because it required a $(htmldir) which
wasn't set anywhere: I concluded that it can't have actually been used
by anyone, and so removed it rather than doing more name transform
stuff for it.  But now that I have a bit more time, here's a patch to
do it properly.  This should be applied INSTEAD of Clint's 8958/8959/8960.

-zefram

diff -cr ../zsh-/Config/defs.mk.in ./Config/defs.mk.in
*** ../zsh-/Config/defs.mk.in	Wed Dec  8 19:58:26 1999
--- ./Config/defs.mk.in	Thu Dec  9 10:17:36 1999
***************
*** 39,45 ****
--- 39,47 ----
  MODDIR          = $(libdir)/$(tzsh)/$(VERSION)
  infodir         = @infodir@
  mandir          = @mandir@
+ datadir         = @datadir@
  fndir           = @fndir@
+ htmldir         = $(datadir)/$(tzsh)/htmldoc
  
  # compilation
  CC              = @CC@
***************
*** 77,82 ****
--- 79,85 ----
  MAKEDEFS = \
  prefix='$(prefix)' exec_prefix='$(exec_prefix)' bindir='$(bindir)' \
  libdir='$(libdir)' MODDIR='$(MODDIR)' infodir='$(infodir)' mandir='$(mandir)' \
+ datadir='$(datadir)' fndir='$(fndir)' htmldir='$(htmldir)' \
  CC='$(CC)' CPPFLAGS='$(CPPFLAGS)' DEFS='$(DEFS)' CFLAGS='$(CFLAGS)' \
  LDFLAGS='$(LDFLAGS)' EXTRA_LDFLAGS='$(EXTRA_LDFLAGS)' \
  DLCFLAGS='$(DLCFLAGS)' DLLDFLAGS='$(DLLDFLAGS)' \
diff -cr ../zsh-/Doc/Makefile.in ./Doc/Makefile.in
*** ../zsh-/Doc/Makefile.in	Wed Dec  8 19:58:26 1999
--- ./Doc/Makefile.in	Thu Dec  9 10:22:57 1999
***************
*** 210,215 ****
--- 210,226 ----
  	rm -f $(DESTDIR)$(infodir)/$(tzsh).info
  	rm -f $(DESTDIR)$(infodir)/$(tzsh).info-[1-9]*
  
+ # install HTML manual
+ install.html: zsh_toc.html
+ 	$(sdir_top)/mkinstalldirs $(DESTDIR)$(htmldir)
+ 	for file in zsh_*.html; do \
+ 	    $(INSTALL_DATA) $$file $(DESTDIR)$(htmldir) || exit 1; \
+ 	done
+ 
+ # uninstall HTML manual
+ uninstall.html:
+ 	rm -f $(DESTDIR)$(htmldir)/zsh_*.html
+ 
  # ========== DEPENDENCIES FOR CLEANUP ==========
  
  clean-here:
diff -cr ../zsh-/Makefile.in ./Makefile.in
*** ../zsh-/Makefile.in	Wed Dec  8 20:29:33 1999
--- ./Makefile.in	Thu Dec  9 10:13:43 1999
***************
*** 59,65 ****
  install-strip:
  	$(MAKE) install STRIPFLAGS="-s"
  
! # install/uninstall everything (except info)
  install: install.bin install.modules install.man install.fns
  uninstall: uninstall.bin uninstall.modules uninstall.man uninstall.fns
  
--- 59,65 ----
  install-strip:
  	$(MAKE) install STRIPFLAGS="-s"
  
! # install/uninstall most things
  install: install.bin install.modules install.man install.fns
  uninstall: uninstall.bin uninstall.modules uninstall.man uninstall.fns
  
***************
*** 82,87 ****
--- 82,91 ----
  
  # install/uninstall just the info pages
  install.info uninstall.info:
+ 	@cd Doc && $(MAKE) $(MAKEDEFS) $@
+ 
+ # install/uninstall just the HTML manual
+ install.html uninstall.html:
  	@cd Doc && $(MAKE) $(MAKEDEFS) $@
  
  # ========== DEPENDENCIES FOR TESTING ==========
END

