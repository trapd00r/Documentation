From zsh-workers-return-10578-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Apr 07 12:25:10 2000
Return-Path: <zsh-workers-return-10578-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21990 invoked from network); 7 Apr 2000 12:25:08 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Apr 2000 12:25:08 -0000
Received: (qmail 29446 invoked by alias); 7 Apr 2000 12:24:30 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10578
Received: (qmail 29433 invoked from network); 7 Apr 2000 12:24:29 -0000
Message-ID: <38EDD337.DC2B6B18@u.genie.co.uk>
Date: Fri, 07 Apr 2000 13:23:19 +0100
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.72 [en] (Win95; I)
X-Accept-Language: en
MIME-Version: 1.0
To: dfavor@corridor.com
CC: Zsh workers <zsh-workers@sunsite.auc.dk>
Subject: Re: How-to AIX + dynamic zsh?
References: <200004061122.FAA18235@corridor.com> <38EC792D.6AFD430A@u.genie.co.uk> <38EC9FF3.B12EE9BE@austin.ibm.com> <38ECA546.107A6D91@u.genie.co.uk> <38ECAE56.97D758B3@austin.ibm.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

"David R. Favor" wrote:
>  
> It appears that configure is failing due to a missing alloca.h, which of
> course doesn't exist on AIX.

Yes, though judging by the messsage below that accompanies that failure,
it certainly seems to be the fact that it thinks you have a cross-compiler
which is causing the problem later.

> checking whether getpgrp takes no argument... configure: error: cannot check getpgrp if cross compiling

> Let me know if you can do an 'lslpp -f | more' and search for alloca.h and
> find one.

I don't have one anywhere - either by searching for it or looking with lslpp.

You probably want to try to find the part of configure which it runs
to determine if you are using a cross-compiler. From looking here it
seems that it compiles a small program ( main(){return(0); } and runs
it to determine if it is a cross-compiler. Something is causing it to
fail. The test looks something like:

if (./conftest; exit) 2>/dev/null; then
  ac_cv_prog_cc_cross=no
else
  ac_cv_prog_cc_cross=yes
fi

It would have to be that the compile has succeeded but running
./conftest fails here. You might be able to edit parts of configure
here to see what is happening. For a start, removing the redirection to
/dev/null might help.

> > In the meantime, you should be able to create a cache (config.cache)
> > file which tells configure that you don't have a cross-compiler and it
> > should then atleast compile.
> I've never done this. Take a look at the attached files and let me know
> how to get around this.

It seems that configure doesn't use the cache for the initial basic
tests so you can't do that but what you can do is edit the configure
script and change any line which reads ac_cv_prog_cc_cross=no to
assign 'yes' to it instead. That should trick it and allow you to
carry on with building zsh but it is probably still worth
investigating why it thinks you have a cross-compiler in the first
place - it might be a problem which affects later configure checks.

> checking host system type... powerpc-ibm-aix4.3.3.0
I'm using rs6000-ibm-aix3.2.5 so I guess there will be a few differences.

> configure:1140: checking whether the C compiler (xlc -ma -O2 -qmaxmem=16384 -s) is a cross-compiler
            ^^^^
Incase you didn't notice this number might be a useful cross-
reference to in the configure script.

Oliver Kiddle

