From zsh-users-return-11482-mason-zsh=primenet.com.au@sunsite.dk Mon May 14 17:25:12 2007
Return-Path: <zsh-users-return-11482-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28553 invoked from network); 14 May 2007 17:25:10 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.0 (2007-05-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=no
	version=3.2.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 May 2007 17:25:10 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 19763 invoked from network); 14 May 2007 17:25:02 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 May 2007 17:25:02 -0000
Received: (qmail 19943 invoked by alias); 14 May 2007 17:24:54 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11482
Received: (qmail 19934 invoked from network); 14 May 2007 17:24:54 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 May 2007 17:24:54 -0000
Received: (qmail 18487 invoked from network); 14 May 2007 17:24:54 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 14 May 2007 17:24:50 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly26c.srv.mailcontrol.com (MailControl) with ESMTP id l4EHOeL3010676
	for <zsh-users@sunsite.dk>; Mon, 14 May 2007 18:24:44 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 14 May 2007 18:24:43 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.8/8.13.4) with ESMTP id l4EHOhLR028313
	for <zsh-users@sunsite.dk>; Mon, 14 May 2007 18:24:43 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.8/8.13.8/Submit) with ESMTP id l4EHOh4K028310
	for <zsh-users@sunsite.dk>; Mon, 14 May 2007 18:24:43 +0100
Message-Id: <200705141724.l4EHOh4K028310@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: Renaming thingy 
In-reply-to: <20070514170239.GC6929@solfire> 
References: <20070514170239.GC6929@solfire>
Comments: In-reply-to meino.cramer@gmx.de
   message dated "Mon, 14 May 2007 19:02:39 +0200."
Date: Mon, 14 May 2007 18:24:43 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 14 May 2007 17:24:43.0652 (UTC) FILETIME=[C2FEFC40:01C7964C]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.67.0.136

meino.cramer@gmx.de wrote:
> Hi,
> 
>  I have a directory tree with different directories
>  on different levels.
>  There are files scattered around there, some of then
>  are named *.JPG.
>  I want to rename them, starting at the root of that tree
>  to *.jpg.
>  Furthermore some of the directories contain spaces in
>  their names. I want to replace the spaces by underscores.
> 
>  Is there a compact way to accomplish this with zsh?

Do it in two stages.


autoload -U zmv
zmv '(**/)(*).JPG' '$1$2.jpg'
zmv '(**/)(*)(#q/)' '$1${2// /_}'


This is guaranteed to be depth first.  So first it renames .JPG files,
then it renames directories starting with the end component.  This
should mean all the generated "mv"s operate on existing file names.

I think.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

To get further information regarding CSR, please visit our Investor Relations page at http://ir.csr.com/csr/about/overview

