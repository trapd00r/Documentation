From zsh-users-return-7903-mason-zsh=primenet.com.au@sunsite.dk Sun Aug 22 23:05:38 2004
Return-Path: <zsh-users-return-7903-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2552 invoked from network); 22 Aug 2004 23:05:37 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 22 Aug 2004 23:05:37 -0000
Received: (qmail 46087 invoked from network); 22 Aug 2004 23:05:31 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 22 Aug 2004 23:05:31 -0000
Received: (qmail 21235 invoked by alias); 22 Aug 2004 23:04:48 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7903
Received: (qmail 21225 invoked from network); 22 Aug 2004 23:04:48 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by 130.225.247.90 with SMTP; 22 Aug 2004 23:04:48 -0000
Received: (qmail 44331 invoked from network); 22 Aug 2004 23:03:32 -0000
Received: from unknown (HELO moonbase.zanshin.com) (167.160.213.139)
  by a.mx.sunsite.dk with SMTP; 22 Aug 2004 23:03:29 -0000
Received: from toltec.zanshin.com (toltec.zanshin.com [64.84.47.166])
	by moonbase.zanshin.com (8.12.11/8.12.11) with ESMTP id i7MN3N8Q030997
	for <zsh-users@sunsite.dk>; Sun, 22 Aug 2004 16:03:23 -0700
Date: Sun, 22 Aug 2004 16:03:23 -0700 (PDT)
From: Bart Schaefer <schaefer@brasslantern.com>
Reply-To: zsh-users@sunsite.dk
To: zsh-users@sunsite.dk
Subject: Re: Tip of the day: previous command output
In-Reply-To: <20040822212126.GN7841@ay.vinc17.org>
Message-ID: <Pine.LNX.4.61.0408221538560.5997@toltec.zanshin.com>
References: <20040819085812.GL22962@localhost> <Pine.LNX.4.61.0408190748530.9464@toltec.zanshin.com>
 <20040819164250.GA21575@spiegl.de> <Pine.LNX.4.61.0408190956440.9464@toltec.zanshin.com>
 <20040820121202.GA31466@spiegl.de> <20040820145032.GH13530@ay.vinc17.org>
 <Pine.LNX.4.61.0408200905300.27591@toltec.zanshin.com> <20040822212126.GN7841@ay.vinc17.org>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

On Sun, 22 Aug 2004, Vincent Lefevre wrote:

> On 2004-08-20 21:25:47 -0700, Bart Schaefer wrote:
> > 
> > Or you can get menu completion with
> > 
> >   zstyle ':completion:*' insert-kept menu
> 
> I was talking about another kind of menu (which could be useful for
> standard completion too). For instance, there could be a cursor for
> the (standard zsh) menu, or perhaps a number, to be able to choose
> one or several word candidates.
> 
> $ echo [TAB]
> [ab] ef  ij
>  cd  gh  kl

How is does this differ from menu selection?

Starting from my previous post, you need only add:

    zmodload -i zsh/complist
    zstyle ':completion:insert-kept-result:*' menu yes select

Then load something into $kept e.g. with "keep", and then type whatever 
keystrokes you have insert-kept-result bound to.

If that doesn't correspond to the behavior you're describing above, then 
there's something I'm still not understanding.

> or
> 
> $ echo [TAB]
> 1 ab  3 ef  5 ij
> 2 cd  4 gh  6 kl
>
> then typing some key followed by the number would insert the word.

Numbering the possible matches is difficult, if not impossible, without 
changing the guts of the completion C code, because the labels that may be 
shown along with each match are assigned to the _possible_ matches, not to 
the _actual_ matches.  E.g. when completing files, compadd may be given 
the name of every file in the directory, and then the completion internals 
winnows them down to the names that actually fit the prefix or suffix 
that's already on the line.  So the numbers to show cannot be known until 
immediately before the list is displayed, and hence can't be passed to
compadd by user-definable functions.

However, someone more ambitious than I might alter the complist module to 
provide this display and some corresponding menuselect keymap bindings.  
A question would be, what do you expect to happen when the list is too 
long to fit on one screen?

