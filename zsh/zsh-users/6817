From zsh-users-return-6817-mason-zsh=primenet.com.au@sunsite.dk Thu Nov 27 10:30:56 2003
Return-Path: <zsh-users-return-6817-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13002 invoked from network); 27 Nov 2003 10:30:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 27 Nov 2003 10:30:54 -0000
Received: (qmail 741 invoked by alias); 27 Nov 2003 10:30:33 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6817
Received: (qmail 671 invoked from network); 27 Nov 2003 10:30:32 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 27 Nov 2003 10:30:32 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [219.55.112.42] by sunsite.dk (MessageWall 1.0.8) with SMTP; 27 Nov 2003 10:30:32 -0000
Received: from smile.house (smile.house [192.168.0.5])
	by juhp.dyndns.org (Postfix) with ESMTP
	id 2B3983B8003; Thu, 27 Nov 2003 19:30:30 +0900 (JST)
Received: from smile.house (localhost.house [127.0.0.1])
	by smile.house (Postfix) with ESMTP
	id 0D122CC210; Thu, 27 Nov 2003 19:30:30 +0900 (JST)
Date: Thu, 27 Nov 2003 19:30:30 +0900
Message-ID: <m3y8u26r3t.wl%petersen@redhat.com>
From: Jens Petersen <petersen@redhat.com>
To: Philippe Troin <phil@fifi.org>
Cc: Zsh-users <zsh-users@sunsite.dk>
Subject: Re: problem building zsh in background
In-Reply-To: <m365h68uk6.wl%petersen@redhat.com>
References: <m3d6bgq2tk.wl%petersen@redhat.com>
	<87d6bgrxml.fsf@ceramic.fifi.org>
	<m3vfp7o6c8.wl%petersen@redhat.com>
	<877k1ngcp5.fsf@ceramic.fifi.org>
	<m365h68uk6.wl%petersen@redhat.com>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.4 (Hosorogi) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 14) (Reasonable Discussion) (i386-redhat-linux)
X-Face: 64N,SZ}bM~X-HZK0w(B)t]7rZ}7_bNq^}A%e7_;~lN3nVJ,50%>pW7y^=\\sy2w\"7?cu}g@t#JRW\\4kvSY8i%OMorx`_I]/5+~db.s\\H!)|YE.y#-sFk#]iYRU/w+({~_l-c1uS)s<KHR^vv$2e{OV6K~1S@^g4GxF`R@0HbB_/Y,0^cEHEFSR0iwdyXwJ,c[7a^2$A_5.x:7C5)^O[,w\\Ayq2foSPJ)BPKz2C2V95sQ!`8Zn+?Su(@Ht}>%;72$Nmv>U)ZeyLBdF#c-i.ECMy9>twG+9Ln$<vWho^=@SrMU6w
MIME-Version: 1.0 (generated by SEMI 1.14.4 - "Hosorogi")
Content-Type: text/plain; charset=US-ASCII

>>>>> "juhp" == Jens Petersen <petersen@redhat.com> writes:

>>>>> "PT" == Philippe Troin <phil@fifi.org> writes:

    >>> >> works... yes checking if tcsetpgrp() actually
    >>> >> works...  [1] + suspended (tty output)
    >>> >> ./configure
    >>>
    PT> Check-out the thread at
    PT> http://www.zsh.org/mla/workers/2003/msg00895.html

Ok, I have no problems with the first weaker patch, but with
the second patch (msg00896.html) when there is no tty I see:

:
checking if kill(pid, 0) returns ESRCH correctly... yes
checking if POSIX sigsuspend() works... yes
checking if tcsetpgrp() actually works... notty
configure: error: no controlling tty
% 

This can be reproduced easily with zsh and nohup:
a) in new terminal, go to a clean tree and run:

  % nohup ./configure &!
  % Ctrl-d   # (ie close the terminal)

b) Then in another terminal "tail -f" nohup.out...

For now I applied the first patch in zsh-4.0.7-2.

Jens

