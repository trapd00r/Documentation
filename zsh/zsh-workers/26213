From zsh-workers-return-26213-mason-zsh=primenet.com.au@sunsite.dk Wed Dec 31 09:33:04 2008
Return-Path: <zsh-workers-return-26213-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21164 invoked from network); 31 Dec 2008 09:32:59 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 31 Dec 2008 09:32:59 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 1261 invoked from network); 31 Dec 2008 09:32:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 31 Dec 2008 09:32:49 -0000
Received: (qmail 18229 invoked by alias); 31 Dec 2008 09:32:43 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26213
Received: (qmail 18217 invoked from network); 31 Dec 2008 09:32:43 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 31 Dec 2008 09:32:43 -0000
Received: from mail.michael-prokop.at (mail.michael-prokop.at [88.198.6.110])
	by bifrost.dotsrc.org (Postfix) with ESMTP id C34FC80308BE
	for <zsh-workers@sunsite.dk>; Wed, 31 Dec 2008 10:32:39 +0100 (CET)
Received: from mail.michael-prokop.at (grmlvrs [127.0.0.1])
	by mail.michael-prokop.at (Postfix) with ESMTP id 059523BC038
	for <zsh-workers@sunsite.dk>; Wed, 31 Dec 2008 10:32:39 +0100 (CET)
Received: by mail.michael-prokop.at (Postfix, from userid 5001)
	id EC4043BC03A; Wed, 31 Dec 2008 10:32:38 +0100 (CET)
Received: from localhost (grmlvrs [127.0.0.1])
	by mail.michael-prokop.at (Postfix) with ESMTP id B6EAF3BC038
	for <zsh-workers@sunsite.dk>; Wed, 31 Dec 2008 10:32:32 +0100 (CET)
Date: Wed, 31 Dec 2008 10:32:32 +0100
From: Michael Prokop <news@michael-prokop.at>
To: zsh-workers@sunsite.dk
Subject: Re: Segfault on really long paths
Message-ID: <2008-12-31T10-10-40@devnull.michael-prokop.at>
Reply-To: Michael Prokop <zsh@michael-prokop.at>
Mail-Followup-To: zsh-workers@sunsite.dk
References: <2d460de70812291619y5b32aadcu733cf06c9d197e1f@mail.gmail.com> <200812300706.08353.arvidjaar@newmail.ru>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="28wbjzzu+2Xmo01Z"
Content-Disposition: inline
In-Reply-To: <200812300706.08353.arvidjaar@newmail.ru>
X-URL: http://michael-prokop.at/
X-GPG-Key-ID: 0x37E272E8
X-GPG-Key: http://www.michael-prokop.at/gpg
X-GPG-Fingerprint: 04AE E62C 9502 CD34 A7DA 857B D8DF 53FB 37E2 72E8
User-Agent: Mutt/1.5.13 (2006-08-11)
X-Virus-Scanned: ClamAV using ClamSMTP
X-Virus-Scanned: ClamAV 0.92.1/8816/Wed Dec 31 08:18:10 2008 on bifrost
X-Virus-Status: Clean


--28wbjzzu+2Xmo01Z
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

* Andrey Borzenkov <arvidjaar@newmail.ru> [20081230 05:06]:
> On =D0=92=D1=82=D0=BE=D1=80=D0=BD=D0=B8=D0=BA 30 =D0=B4=D0=B5=D0=BA=D0=B0=
=D0=B1=D1=80=D1=8F 2008 03:19:51 Richard Hartmann wrote:

> > richih@adamantium ~ % for i in {1..1000}; do mkdir 0123456789; cd
> > 0123456789; done
> > [1]    24398 segmentation fault  zsh
> > richih@adamantium ~ %

> > It would be better to throw an error than to segfault.

> Does not do here (Mandriva cooker):

> cooker% /bin/pwd > /tmp/foo
> cooker% wc /tmp/foo
>     1     1 11018 /tmp/foo
> cooker% echo $ZSH_VERSION
> 4.3.6-dev-0

> glibc-2.8-1.20080520.5mnb2

> Are you sure it is zsh and not (g)libc segfaulting?

At least Bash (3.2.39) doesn't segfault. I can see several:

| cd: error retrieving current directory: getcwd: cannot access parent dire=
ctories: File name too long

messages while running but bash doesn't segfault.

Zsh (version 4.3.6 here) receives several EINVAL on readlink()
(using libc 2.7 of Debian/unstable). Then I can see lots of
(uncatched?) ENAMETOOLONG (not mentioning chdir() and stat64())
which seem to cause the segfault in zsh.

regards,
-mika-
--=20
 ,'"`.         http://michael-prokop.at/
(  grml.org -=C2=BB Linux Live-CD for texttool-users and sysadmins
 `._,'         http://grml.org/

--28wbjzzu+2Xmo01Z
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFJWzww2N9T+zficugRAsPMAJ9qO5ouE3m8CtO7pX6150QlsrmO3ACfVGg9
wtq9eucMC94o7kxiM4ggJS0=
=q0ux
-----END PGP SIGNATURE-----

--28wbjzzu+2Xmo01Z--

