From zsh-workers-return-15159-mason-zsh=primenet.com.au@sunsite.dk Thu Jun 28 11:10:33 2001
Return-Path: <zsh-workers-return-15159-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3263 invoked from network); 28 Jun 2001 11:10:32 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 28 Jun 2001 11:10:32 -0000
Received: (qmail 25685 invoked by alias); 28 Jun 2001 11:09:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15159
Received: (qmail 25659 invoked from network); 28 Jun 2001 11:09:38 -0000
Sender: kiddleo
Message-ID: <3B3B109C.D28E3C7C@u.genie.co.uk>
Date: Thu, 28 Jun 2001 12:10:20 +0100
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.2.15 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: zsh-workers@sunsite.dk
Subject: PATCH: _vnc
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

It seems that vnc display numbers can be greater than 9. Also Debian
installs the vncviewer as xvncviewer and we can now do a better job of
completing the arguments to the -encodings parameter.

I'll apply this to both branches because it is a bug fix.

Oliver

Index: Completion/X/Command/_vnc
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/X/Command/_vnc,v
retrieving revision 1.2
diff -u -r1.2 _vnc
--- Completion/X/Command/_vnc   2001/05/08 11:48:14     1.2
+++ Completion/X/Command/_vnc   2001/06/28 11:05:09
@@ -1,7 +1,7 @@
-#compdef vncserver vncviewer
+#compdef vncserver vncviewer xvncviewer
 
 local displays args
-displays=( ~/.vnc/$HOST:?.pid(N:r:t:s/$HOST//) )
+displays=( ~/.vnc/$HOST:<->.pid(N:r:t:s/$HOST//) )
 displays=( \\${^displays} ) 
 
 case $service in
@@ -19,10 +19,9 @@
       - help \
        '-help'
   ;;
-  vncviewer) 
-    # should allow list for -encodings
+  *vncviewer) 
     _xt_arguments -shared -viewonly -fullscreen -bgr233 -owncmap -truecolour \
-      '-encodings:encodings:(copyrect hextile corre rre raw)' \
+      '-encodings:encodings:_values -s " " copyrect hextile corre rre raw' \
       '-depth:depth' \
       '-passwd:file:_files' \
       '(1)-listen:display number' \

