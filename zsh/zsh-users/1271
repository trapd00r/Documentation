From zsh-workers-request@math.gatech.edu Sat Jan 24 09:31:30 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 7011 invoked from network); 24 Jan 1998 09:31:28 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 24 Jan 1998 09:31:28 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id EAA23517;
	Sat, 24 Jan 1998 04:15:17 -0500 (EST)
Resent-Date: Sat, 24 Jan 1998 04:14:39 -0500 (EST)
Message-ID: <19980123222236.60814@picard.franken.de>
Date: Fri, 23 Jan 1998 22:22:36 +0100
From: =?iso-8859-1?Q?Thomas_K=F6hler?= <jean-luc@picard.franken.de>
To: zsh-users@math.gatech.edu
Subject: man compctl
References: <E0xucM7-00074S-00@oak73.doc.ic.ac.uk> <82hg6zowz8.fsf@y.idonex.se>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Mailer: Mutt 0.73
X-Disclaimer: Linux rulez
X-Operating-System: Linux picard 2.0.32
X-linuxger-url: http://www.linuxger.de/
X-ixthys-url: http://home.pages.de/~ixthys/
Resent-Message-ID: <"ocnQb3.0.Ck5._3Roq"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1271
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hello all,
here's my completion for manpages.

# completion for manpages

####
# if ~/tmp/_man_ is too old then remove it and create a new one later
find ~/tmp -mtime 14 -name "_man_" -exec rm -f {} \;

createman () {
   echo "creating ~/tmp/_man_"
   find /usr/man -type f > ~/tmp/_man_
   find /usr/local/man -type f >> ~/tmp/_man_
   find /usr/X11R6/man -type f >> ~/tmp/_man_
   sed -e "s/.*\///" -e "s/\.gz//" -e "s/\.[^.]*$//" ~/tmp/_man_ | sort | uniq > ~/tmp/_man2_
   rm -f ~/tmp/_man_
   (for i in `cat ~/tmp/_man2_` ; do echo -n "$i " ; done) > ~/tmp/_man_
   rm -f ~/tmp/_man2_
}
if [ ! -f ~/tmp/_man_ ] ; then createman ; fi
####
man_pages=(`cat ~/tmp/_man_`)
compctl -f -k man_pages man

Remarks:
the first part (#### - ####) should better be put in a cron job or in
your .zlogout (if you don't have access to crontab) - it may take some
time to process those finds :-)

CU,
Thomas

-- 
  -- Thomas Köhler   Email:  jean-luc@picard.franken.de
          <><                     jean-luc@mayn.de
   IRC: jeanluc  Channels:  #star_trek #linuxger #ixthys #knf
             WWW: http://home.pages.de/~jeanluc/

