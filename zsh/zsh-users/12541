From zsh-users-return-12541-mason-zsh=primenet.com.au@sunsite.dk Mon Feb 11 13:38:34 2008
Return-Path: <zsh-users-return-12541-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11632 invoked from network); 11 Feb 2008 13:38:31 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Feb 2008 13:38:31 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 62358 invoked from network); 11 Feb 2008 13:38:20 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Feb 2008 13:38:20 -0000
Received: (qmail 17884 invoked by alias); 11 Feb 2008 13:38:12 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12541
Received: (qmail 17865 invoked from network); 11 Feb 2008 13:38:11 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 11 Feb 2008 13:38:11 -0000
Received: from mal35-2-82-225-70-234.fbx.proxad.net (mal35-2-82-225-70-234.fbx.proxad.net [82.225.70.234])
	by bifrost.dotsrc.org (Postfix) with ESMTP id D20E180482A3
	for <zsh-users@sunsite.dk>; Mon, 11 Feb 2008 14:38:04 +0100 (CET)
Received: from localhost (server.nasreddine.info [127.0.0.1])
	by mal35-2-82-225-70-234.fbx.proxad.net (Postfix) with ESMTP id B7A5F23BFB;
	Mon, 11 Feb 2008 14:38:03 +0100 (CET)
X-Virus-Scanned: amavisd-new at nasreddine.com
Received: from mal35-2-82-225-70-234.fbx.proxad.net ([127.0.0.1])
	by localhost (server.nasreddine.info [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id pKH-gFCgNjh7; Mon, 11 Feb 2008 14:37:54 +0100 (CET)
Received: from phoenix.nasreddine.info (phoenix.nasreddine.info [192.168.1.3])
	by mal35-2-82-225-70-234.fbx.proxad.net (Postfix) with ESMTP id DD09A23BF8;
	Mon, 11 Feb 2008 14:37:53 +0100 (CET)
Date: Mon, 11 Feb 2008 14:37:43 +0100
From: Wael Nasreddine <mla@nasreddine.com>
To: Peter Stephenson <pws@csr.com>
Cc: zsh-users@sunsite.dk
Subject: Re: Phil's prompt is not working when LANG is set to UTF-8
Message-ID: <20080211133743.GA28384@phoenix.nasreddine.info>
References: <20080211033116.GD19613@phoenix.nasreddine.info> <237967ef0802102301i71dcd71erb1a2993a7f0bd643@mail.gmail.com> <20080211092021.GC6965@phoenix.nasreddine.info> <20080211130707.7d45f6af@news01>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="ReaqsoxgOBHFXBhH"
Content-Disposition: inline
In-Reply-To: <20080211130707.7d45f6af@news01>
X-OS: Linux 2.6.24-tuxonice i686
X-Editor: VIM - Vi IMproved 7.1 (2007 May 12, compiled Feb  4 2008 15:13:47)
X-PGP-Key: http://wael.nasreddine.com/files/Wael_Nasreddine.asc
User-Agent: Mutt/1.5.16 (2007-06-09)
X-Virus-Scanned: ClamAV 0.91.2/5771/Mon Feb 11 13:29:55 2008 on bifrost
X-Virus-Status: Clean


--ReaqsoxgOBHFXBhH
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Mon, Feb 11, 2008 at 01:07:07PM +0000, Peter Stephenson <pws@csr.com> wr=
ote:
> On Mon, 11 Feb 2008 10:20:21 +0100
> Wael Nasreddine <mla@nasreddine.com> wrote:
> > Oh I'm sorry I forgot to mention that this only happens on consoles not=
 in X
> > emulators ( /dev/tty1 etc... ) I have also the combination of
> > rxvt-unicode/zsh/UTF-8 and it works fine but on the console it's too me=
ssy so
> > I'm deprived of consoles ATM.

> > Anyway my zsh version is 4.3.5

> I suspect the right thing to do here might be either to "unsetopt
> multibyte" or "export LC_ALL=3DC".  It sounds like the combination of
> the console and the C library aren't doing the stuff the shell needs
> to support multibyte characters.  If that's not the problem, please send
> more detail about your settings and environment and what works and what
> doesn't work.

> (That last sentence applies to everybody.  Zsh runs in some very different
> environments.  We could *always* do with knowing what that is, even
> if it turns out not to be relevant.  If it applies in lots of
> different environments, please say so---as many people already do.)

Thank you for your reply, but, set/unsetting multibyte opt has no
effect but as said before when LANG is set to utf8 it doesn't work,
for now I use LANG=3Den_US (iso-8859-1) it does work this way though I
don't want to stick with this encoding, anyway here's some more
info for you.

My current setup is Gentoo, 2.6.24, I thought it was irrelevant
because as I said before I tried it on both Linux and Unix, I tried
Arch Linux, Ubuntu, Gentoo, Frugalware, FreeBSD etc.. All with the
same result, so I know that the problem comes from somewhere in my
profile, an incompatibility or something I'm not sure.

=2Ezshrc and all the files that it includes:
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.zshrc?view=3Dco
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.zsh/alias?view=
=3Dco
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.zsh/bindkey?vi=
ew=3Dco
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.zsh/opts?view=
=3Dco  <-- where all opts are set.
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.zsh/prompts/ph=
ils?view=3Dlog
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.shells/alias?v=
iew=3Dlog
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.shells/autolau=
nch?view=3Dlog
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.shells/colors?=
view=3Dlog
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.shells/exports=
?view=3Dlog <-- where I define the LANG.
    http://wael.nasreddine.com/cgi-bin/viewvc.cgi/trunk/etc/.shells/functio=
ns?view=3Dlog

Just to try and save you some time reading all those files here's the
output of:
setopt: http://nopaste.nasreddine.com/fed365b5cb.html
env: http://nopaste.nasreddine.com/4d004fdb39.html


Thank you.

--=20
Wael Nasreddine
http://wael.nasreddine.com
PGP: 1024D/C8DD18A2 06F6 1622 4BC8 4CEB D724  DE12 5565 3945 C8DD 18A2

=2E: An infinite number of monkeys typing into GNU emacs,
   would never make a good program. (L. Torvalds 1995) :.

--ReaqsoxgOBHFXBhH
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)

iD8DBQFHsE+nVWU5RcjdGKIRApcvAJ0SCKjSiWLmX6NNzdkt6e0mdN5HwQCfcfjn
bAgltLHVW1LWrXr7jdXzqvc=
=rYSV
-----END PGP SIGNATURE-----

--ReaqsoxgOBHFXBhH--

