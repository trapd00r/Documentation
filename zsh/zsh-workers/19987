From zsh-workers-return-19987-mason-zsh=primenet.com.au@sunsite.dk Fri May 28 05:41:59 2004
Return-Path: <zsh-workers-return-19987-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18671 invoked from network); 28 May 2004 05:41:58 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.86)
  by ns1.primenet.com.au with SMTP; 28 May 2004 05:41:58 -0000
Received: (qmail 9028 invoked from network); 28 May 2004 05:41:10 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 May 2004 05:41:10 -0000
Received: (qmail 24590 invoked by alias); 28 May 2004 05:40:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19987
Received: (qmail 24574 invoked from network); 28 May 2004 05:40:44 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 28 May 2004 05:40:41 -0000
Received: (qmail 7745 invoked from network); 28 May 2004 05:40:41 -0000
Received: from web51109.mail.yahoo.com (206.190.39.130)
  by a.mx.sunsite.dk with SMTP; 28 May 2004 05:40:29 -0000
Message-ID: <20040528054001.36732.qmail@web51109.mail.yahoo.com>
Received: from [63.201.35.238] by web51109.mail.yahoo.com via HTTP; Thu, 27 May 2004 22:40:01 PDT
Date: Thu, 27 May 2004 22:40:01 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: Re: zsh 4.2.0 dumping core on completion attempt
To: Thorsten Kampe <thorsten@thorstenkampe.de>, zsh-workers@sunsite.dk
Cc: zsh-users@sunsite.dk
In-Reply-To: <1kfucegia4ux3.dlg@thorstenkampe.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 1.5

--- Thorsten Kampe <thorsten@thorstenkampe.de> wrote:
> I have no idea how to use "valgrind".
It's not necessary, but if you could provide valgrind output that would be
groovy and might be helpful.

Also, if you look back at my original mail the sample script does a touch
command to put some sample files in the bug directory.  This is important
because it limits the matches to a well-defined set that is viewable in your
mail message, to anyone who might try to reproduce the bug.

In your sample script, you complete in the command position.  This causes zsh
to try complete a command/alias/function/etc.  The  problem is that each system
has a different set of commands in the path.   As reader a of your message, 
I don't know what commands/etc zsh is trying to match "_f" with.

When debugging matching spec problems, it is important to see what matches zsh
is trying to apply the specs to.

Though I did try to reproduce your problem on several of my machines,  and some
had no problem.  Cygwin gave me this error:
alternative:69: command not found: _suffix_alias_files

I was able to reproduce the problem on a rh box within gdb and got this stack
trace. (Note: _f worked fine for me, this is stack trace for completing "_x")
#0  strncmp (s1=0x402cbbe4 "xmmap", s2=0x0, n=1)
    at ../sysdeps/generic/strncmp.c:65
#1  0x40246179 in cmp_anchors (o=0x402be3e8, n=0x402bc618, join=1)
    at compmatch.c:1393
#2  0x40247b8a in join_clines (o=0x402bc618, n=0x402be3e8) at compmatch.c:2088
#3  0x40240dc1 in add_match_data (alt=0, str=0x402cbc08 "gkb_xmmap",
    orig=0x402abf28 "gkb_xmmap", line=0x402be3e8, ipre=0x40017428 "",
    ripre=0x0, isuf=0x40017430 "", pre=0x0, prpre=0x0, ppre=0x0, pline=0x0,
    psuf=0x0, sline=0x0, suf=0x0, flags=0, exact=0) at compcore.c:2488
#4  0x4023faa2 in addmatches (dat=0xbfff9910, argv=0x402a21ec)
    at compcore.c:2113
#5  0x40236f51 in bin_compadd (name=0x40299478 "compadd", argv=0xbfff99a4,
    ops=0xbfff99f0, func=0) at complete.c:636
#6  0x08053086 in execbuiltin (args=0x402993e8, bn=0x40250530) at builtin.c:439

Hope that helps if anyone wants to take a look.

> % cat zsh.exe.stackdump
> Exception: STATUS_ACCESS_VIOLATION at eip=610D3BE2
> eax=0000005F ebx=00000000 ecx=00000000 edx=0A1016C3 esi=0A1016C3
    --- rest deleted
This stackdump you provided sheds little or no light on the problem.  You
should only a send stack dump/trace if it can provide a stack trace with
function names (with line numbers, arguments, etc would be even nicer.)  A
stack trace full of register values and a hexdump doesn't provide much, if
anything.  Someone tracking the problem would be more productive looking at the
source code, than trying to decode a bunch of numbers.
 
See the stack trace I've included for an example of one that is more
informative.  You may not have a debug version of zsh, so it would be
impossible for you to provide a good trace.  You should report you are seeing a
crash like you did. 
I should have been a little clearer, when asking for the trace.

--- Peter Stephenson <pws@csr.com> wrote:
> Nobody is really supporting the core completion code at present, so the
> hopeful tone suggesting somebody might look at this is possibly
> misplaced.  However, it could well be simply a NULL pointer which needs
That's too bad. Though, folks, like Oliver, have been fixing completion
problems.  So I'm sorry if I gave the misimpression that any bugs would be
fixed.  Though having a reproducible case would make it a lot easier for anyone
who wanted to try.  This mail is archived, so if there is someone later, they
could try.

-FR.


	
		
__________________________________
Do you Yahoo!?
Friends.  Fun.  Try the all-new Yahoo! Messenger.
http://messenger.yahoo.com/ 

