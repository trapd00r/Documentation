Date: Wed, 5 Apr 2006 10:55:34 +0100
From: Peter Stephenson <pws@csr.com>
To: zsh-workers@sunsite.dk, 359992-forwarded@bugs.debian.org
Subject: Re: [ramk@cse.iitm.ernet.in: Bug#359992: zsh: Enable use of IP
 addresses and multiple host files in _hosts]
Message-Id: <20060405105534.56c82809.pws@csr.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Status: RO
X-Seq: zsh-workers 22402

Clint Adams <schizo@debian.org> wrote:
> From: "R.Ramkumar" <ramk@cse.iitm.ernet.in>
>
> The current _hosts completion does not use IP addresses, and
> completes using host names alone. This patch optionally enables the
> inclusion of IP addresses by a boolean style (the default behaviour
> is unchanged). Further, currently only ~/.ssh/known_hosts file is
> read. Added /etc/ssh/known_hosts to this list, if present. Further,
> observing that any plain list of hostnames would anyway be
> parseable, and that ~"`id -nu`"/.ssh/known_hosts and not
> ~/.ssh/known_hosts might be readable under sudo environments, made
> the list of known host files customizable (defaulting to the two
> files initially specified). Here is the patch:

I'll commit this with the following documentation.

Index: Doc/Zsh/compsys.yo
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Zsh/compsys.yo,v
retrieving revision 1.186
diff -u -r1.186 compsys.yo
--- Doc/Zsh/compsys.yo	20 Mar 2006 11:06:24 -0000	1.186
+++ Doc/Zsh/compsys.yo	5 Apr 2006 09:52:52 -0000
@@ -1665,6 +1665,13 @@
 that unlike the tt(ALWAYS_LAST_PROMPT) option this is independent of the
 numeric prefix argument.
 )
+kindex(known-hosts-files)
+item(tt(known-hosts-files))(
+This style should contain a list of files to search for host names and
+(if the tt(use-ip) style is set) IP addresses in a format compatible with
+ssh tt(known_hosts) files.  If it is not set, the files
+tt(/etc/ssh/ssh_known_hosts) and tt(~/.ssh/known_hosts) are used.
+)
 kindex(list, completion style)
 item(tt(list))(
 This style is used by the tt(_history_complete_word) bindable command.
@@ -2498,6 +2505,16 @@
 However, the tt(compctl) version will be tried if tt(foo) only uses
 default completion.
 )
+kindex(use-ip, completion style)
+item(tt(use-ip))(
+By default, the function tt(_hosts) that completes host names strips
+IP addresses from entries read from host databases such as NIS and
+ssh files.  If this style is true, the corresponding IP addresses
+can be completed as well.  This style is not use in any context
+where the tt(hosts) style is set; note also it must be set before
+the cache of host names is generated (typically the first completion
+attempt).
+)
 kindex(use-perl, completion style)
 item(tt(use-perl))(
 Various parts of the function system use awk to extract words from

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

