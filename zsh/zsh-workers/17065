From zsh-workers-return-17065-mason-zsh=primenet.com.au@sunsite.dk Thu May 02 18:43:55 2002
Return-Path: <zsh-workers-return-17065-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17202 invoked from network); 2 May 2002 18:42:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 2 May 2002 18:42:19 -0000
Received: (qmail 22491 invoked by alias); 2 May 2002 18:41:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17065
Received: (qmail 22467 invoked from network); 2 May 2002 18:41:57 -0000
Date: Thu, 2 May 2002 14:42:57 -0400
From: "joel w. reed" <jreed@ddiworld.com>
To: zsh-workers@sunsite.dk
Subject: [PATCH]always show complete list
Message-ID: <20020502184257.GA29797@ddiworld.com>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="JP+T4n/bALQSJXh8"
Content-Disposition: inline
User-Agent: Mutt/1.3.25i


--JP+T4n/bALQSJXh8
Content-Type: multipart/mixed; boundary="0OAP2g/MAC+5xKAE"
Content-Disposition: inline


--0OAP2g/MAC+5xKAE
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

this patch adds a config option LISTALWAYS that if set, makes=20
zsh-4.0.4 always show the complete list if the completion=20
resulted in only a partial completion (to help the user decide
what to type next w/o the need for another TAB).

lets say i have a directory with 2 entries:

  opal-3.0.4
  opal-4.0=20

my patched zsh will show the following after i type 'cd oTAB'

(%:~/src) cd opal-   =20
opal-3.0.4/  opal-4.0/

zsh is great. thanks.

jr

--=20
------------------------------------------------------------
Joel W. Reed                                    412-257-3881
--------All the simple programs have been written.----------


--0OAP2g/MAC+5xKAE
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="LISTALWAYS.patch"
Content-Transfer-Encoding: quoted-printable

--- Src/options.c.orig	Mon Jun 25 12:31:19 2001
+++ Src/options.c	Tue Apr 30 15:16:15 2002
@@ -146,6 +146,7 @@ static struct optname optns[] =3D {
 {NULL, "kshglob",             OPT_EMULATE|OPT_KSH,       KSHGLOB},
 {NULL, "kshoptionprint",      OPT_EMULATE|OPT_KSH,	 KSHOPTIONPRINT},
 {NULL, "kshtypeset",          OPT_EMULATE|OPT_KSH,	 KSHTYPESET},
+{NULL, "listalways",	      OPT_ALL,			 LISTALWAYS},
 {NULL, "listambiguous",	      OPT_ALL,			 LISTAMBIGUOUS},
 {NULL, "listbeep",	      OPT_ALL,			 LISTBEEP},
 {NULL, "listpacked",	      0,			 LISTPACKED},
--- Src/Zle/compresult.c.orig	Mon May 28 07:42:00 2001
+++ Src/Zle/compresult.c	Tue Apr 30 15:17:48 2002
@@ -806,9 +806,9 @@ do_ambiguous(void)
 	 * prefix was inserted, return now, bypassing the list-displaying  *
 	 * code.  On the way, invalidate the list and note that we don't   *
 	 * want to enter an AUTO_MENU imediately.                          */
-	if ((uselist =3D=3D 3 ||
+	if (!isset(LISTALWAYS) && ((uselist =3D=3D 3 ||
 	     (!uselist && isset(BASHAUTOLIST) && isset(LISTAMBIGUOUS))) &&
-	    la) {
+	    la)) {
 	    int fc =3D fromcomp;
=20
 	    invalidatelist();
--- Src/zsh.h.orig	Tue Apr 30 15:34:12 2002
+++ Src/zsh.h	Tue Apr 30 15:15:29 2002
@@ -1384,6 +1384,7 @@ enum {
     KSHGLOB,
     KSHOPTIONPRINT,
     KSHTYPESET,
+    LISTALWAYS,
     LISTAMBIGUOUS,
     LISTBEEP,
     LISTPACKED,

--0OAP2g/MAC+5xKAE--

--JP+T4n/bALQSJXh8
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.6 (GNU/Linux)
Comment: For info see http://www.gnupg.org

iD8DBQE80Yixx8bVY5wogAYRAraLAJ442Yql45rhjxd6C81oD4RgiP+YIQCeJWhR
Y5D45w0eFj3fHkELXMG8/2s=
=2uyj
-----END PGP SIGNATURE-----

--JP+T4n/bALQSJXh8--

