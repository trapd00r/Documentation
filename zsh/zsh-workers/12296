From zsh-workers-return-12296-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jul 18 08:31:29 2000
Return-Path: <zsh-workers-return-12296-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5575 invoked from network); 18 Jul 2000 08:31:29 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 Jul 2000 08:31:29 -0000
Received: (qmail 9576 invoked by alias); 18 Jul 2000 08:31:23 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12296
Received: (qmail 9569 invoked from network); 18 Jul 2000 08:31:21 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000718083115.ZM23044@candle.brasslantern.com>
Date: Tue, 18 Jul 2000 08:31:15 +0000
In-Reply-To: <Pine.LNX.4.21.0007172256410.9316-100000@phong.blorf.net>
Comments: In reply to Wayne Davison <wayned@users.sourceforge.net>
        "Re: PATCH: Re: adding a toplevel zsh.spec.in file" (Jul 17, 11:15pm)
References: <Pine.LNX.4.21.0007172256410.9316-100000@phong.blorf.net>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Subject: How to distribute skeleton zshrc etc. (Re: PATCH: Re: adding a toplevel zsh.spec.in file)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jul 17, 11:15pm, Wayne Davison wrote:
} Subject: Re: PATCH: Re: adding a toplevel zsh.spec.in file
}
} I think that RedHat/Mandrake would do well to remove all the alias,
} setopt, and similar setup that is going on in these /etc files and
} move it into the skel files that get installed for new users.

The problem with this approach is that the skel files are installed
only when a new user is created, but the package for zsh is an add-on
that can be installed or deinstalled independently.  How do you update
all the users' copies of the skel files when a new version of the zsh
package is installed?  How do you "distribute" skel files to existing
users when zsh is added for the first time?

You can't simply set ZDOTDIR=/etc/skel in /etc/zshenv, that would mess up
a user who has compiled his own copy of zsh (not to mention effectively
making *all* the RCs read-only).  Perhaps a test in /etc/zshrc (or some
similar place that survives the latest proposed changes) for whether any
of the ~/.z{sh{env,rc},profile,login} files exists, and if none do, then
symlink them all from /etc/skel ...

Perhaps zsh should ignore the value of ZDOTDIR until after ~/.zshenv has
been sourced, but also source $ZDOTDIR/.zshenv if no ~/.zshenv exists ...
I hesitate to suggest this because it might actually break my current
personal zsh configuration, but it ought to be a little harder than it
is for a sysadmin to accidentally bypass all user-writable files.  Hmm,
perhaps do the delayed-ZDOTDIR thing only for un-restricted shells?

I'm obviously thinking "out loud" here.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

