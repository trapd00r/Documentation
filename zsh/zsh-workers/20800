From zsh-workers-return-20800-mason-zsh=primenet.com.au@sunsite.dk Tue Feb 08 01:11:07 2005
Return-Path: <zsh-workers-return-20800-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21270 invoked from network); 8 Feb 2005 01:11:06 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 8 Feb 2005 01:11:06 -0000
Received: (qmail 97379 invoked from network); 8 Feb 2005 01:11:00 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 8 Feb 2005 01:11:00 -0000
Received: (qmail 12105 invoked by alias); 8 Feb 2005 01:10:53 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20800
Received: (qmail 12087 invoked from network); 8 Feb 2005 01:10:52 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 8 Feb 2005 01:10:52 -0000
Received: (qmail 96996 invoked from network); 8 Feb 2005 01:10:15 -0000
Received: from ip-66-80-62-153.dsl.sca.megapath.net (HELO ripple.fruitbat.org) (66.80.62.153)
  by a.mx.sunsite.dk with SMTP; 8 Feb 2005 01:10:10 -0000
Received: (from daemon@localhost)
	by ripple.fruitbat.org (8.10.2/8.8.8/PAC-1.3) id j1818cW14026;
	Mon, 7 Feb 2005 17:08:38 -0800
Received: from ming.fruitbat.org(192.168.1.2) by ripple.fruitbat.org via smap (V2.1/2.1+anti-relay+anti-spam)
	id xma014024; Mon, 7 Feb 05 17:08:36 -0800
Received: from ming.fruitbat.org (IDENT:202@ming.fruitbat.org [192.168.1.2])
	by ming.fruitbat.org (8.12.10/8.10.2/PAC-1.6) with ESMTP id j1818Y8p026431;
	Mon, 7 Feb 2005 17:08:34 -0800
Date: Mon, 7 Feb 2005 17:08:34 -0800 (PST)
From: "Peter A. Castro" <doctor@fruitbat.org>
To: Oliver Kiddle <okiddle@yahoo.co.uk>
cc: Zsh workers <zsh-workers@sunsite.dk>
Subject: Re: iconv issues, 4.2 branch
In-Reply-To: <8918.1107777705@trentino.logica.co.uk>
Message-ID: <Pine.LNX.4.58.0502071656320.17079@ming.fruitbat.org>
References: <8918.1107777705@trentino.logica.co.uk>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

On Mon, 7 Feb 2005, Oliver Kiddle wrote:

> Having been away, I've not really followed the autoconf issues with
> detecting iconv on Cygwin and Mac OS X but I thought I should mention
> that GNU gettext comes with a file normally installed as
> /usr/share/aclocal/iconv.m4. If someone wants to look at it, it might do
> a better job of handling the different situations. It also detects the
> varying prototypes which currently causes compiler warnings on some
> systems.

Thanks for the hint!  This seems like just the thing to use, instead of
the current method for finding iconv()/libiconv().

> I didn't use it at the time because it seemed overkill. It also appeared

>From the looks of it, it's along the lines of what I was originally
hacking into configure.ac, but didn't really want to spend lots of time
tweeking it to prefection.

> to assume that iconv was essential, printing messages like "consider
> installing GNU libiconv". This isn't really appropriate for zsh given
> that, in many cases, \u/\U will work without needing iconv
> (specifically  __STDC_ISO_10646__ plus wctomb and wchar_t available). So
> it may just be that some ideas can be taken from iconv.m4.

It doesn't really seem to imply that iconv is essential (the word
"consider" doesn't mean mandatory).  It also doesn't look like it would
stop configure if iconv isn't found (haven't tried it yet, so don't know
for sure, but I don't see anything obvious in the code).  It does appear
to provide a way to disable searching for iconv (via
--without-libiconv-prefix).  I'll play with this a bit and see if it
might be a more complete method of searching for iconv under Linux and
Cygwin.

Thanks again!

> Also, I've got a question about the zsh-4_2-patches branch? What is the
> plan: is all the unicode stuff going to form a 4.3.0 release once ready
> for testing with further 4.2.x releases coming on the 4_2 branch. It'd
> be useful to know just what sort of changes we should be applying to
> both branches and which only to HEAD.
>
> Oliver

-- 
Peter A. Castro <doctor@fruitbat.org> or <Peter.Castro@oracle.com>
	"Cats are just autistic Dogs" -- Dr. Tony Attwood

