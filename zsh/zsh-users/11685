From zsh-users-return-11685-mason-zsh=primenet.com.au@sunsite.dk Sun Jul 29 06:34:16 2007
Return-Path: <zsh-users-return-11685-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12071 invoked from network); 29 Jul 2007 06:34:14 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 Jul 2007 06:34:14 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 81029 invoked from network); 29 Jul 2007 06:34:08 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 Jul 2007 06:34:08 -0000
Received: (qmail 26789 invoked by alias); 29 Jul 2007 06:34:01 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11685
Received: (qmail 26773 invoked from network); 29 Jul 2007 06:34:01 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 29 Jul 2007 06:34:01 -0000
Received: (qmail 79856 invoked from network); 29 Jul 2007 06:34:00 -0000
Received: from flock1.newmail.ru (82.204.219.207)
  by a.mx.sunsite.dk with SMTP; 29 Jul 2007 06:33:57 -0000
Received: (qmail 32038 invoked from network); 29 Jul 2007 06:33:55 -0000
Received: from unknown (HELO cooker.net) (arvidjaar@newmail.ru@91.76.105.182)
  by smtpd.newmail.ru with SMTP; 29 Jul 2007 06:33:55 -0000
From: Andrey Borzenkov <arvidjaar@newmail.ru>
To: zsh-users@sunsite.dk
Subject: Re: the konsole title bar
Date: Sun, 29 Jul 2007 10:33:53 +0400
User-Agent: KMail/1.9.7
Cc: Paolo Massimo <paolo.m.pumilia.gnarini@gmail.com>,
 "William Scott" <wgscott@chemistry.ucsc.edu>,
 linux_milano@yahoo.it
References: <f8fj85$9ud$1@sea.gmane.org> <38952.66.167.127.80.1185649219.squirrel@mail.acg.ucsc.edu> <200707290051.25148.paolo.m.pumilia.gnarini@gmail.com>
In-Reply-To: <200707290051.25148.paolo.m.pumilia.gnarini@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart5854073.Woz8ggeMIB";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200707291033.54644.arvidjaar@newmail.ru>

--nextPart5854073.Woz8ggeMIB
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

On Sunday 29 July 2007, Paolo Massimo wrote:
> On Saturday 28 July 2007 21:00:19 William Scott wrote:
> >  dcop "$KONSOLE_DCOP_SESSION" renameSession  foo
> > does this.  Unfortunately, it also puts the same junk in the title bar,
>
> That is not an issue, having the same string on the title bar anf the tab
> is good.
> The problem is that string increases ita length by doubling the current
> directory name and adding 'Konsole', after the vim session has been close=
d.
> Thank you for having written the original script, anyway.
>
> I have tried to change titles by the command
>    print -nP -u2 '\033]0;\a'
>
> as Andrey Borzenkov suggested, yet closing the vim session yields the same
> result.
>

I still cannot exactly reproduce your result, but this is what I am using f=
or=20
precmd:

precmd () {
        print -Pn "\e]0;\a"
        dcop $KONSOLE_DCOP_SESSION renameSession "$(print -nP -u1 '%n@%m:
%$__prompt_dir_len<...<%~')"
}

where __prompt_dir_len is computed somewhere else. The first line ensures a=
ny=20
existing window titile is cleared. May be you have something else that=20
changes title after pecmd is run?

--nextPart5854073.Woz8ggeMIB
Content-Type: application/pgp-signature; name=signature.asc 
Content-Description: This is a digitally signed message part.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (GNU/Linux)

iD8DBQBGrDTSR6LMutpd94wRApaBAJ91EQn1A4G0j5c4uZ2rvmAsWZKUtACeJsvL
l1rbrk8DdmfoOOi5Z22+HYI=
=OdA9
-----END PGP SIGNATURE-----

--nextPart5854073.Woz8ggeMIB--

