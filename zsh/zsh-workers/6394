From zsh-workers-return-6394-mason-zsh=primenet.com.au@sunsite.auc.dk Mon May 31 18:34:02 1999
Return-Path: <zsh-workers-return-6394-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13091 invoked from network); 31 May 1999 18:34:01 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 31 May 1999 18:34:01 -0000
Received: (qmail 29639 invoked by alias); 31 May 1999 18:33:53 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6394
Received: (qmail 29631 invoked from network); 31 May 1999 18:33:51 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <990531183346.ZM5712@candle.brasslantern.com>
Date: Mon, 31 May 1999 18:33:45 +0000
In-Reply-To: <199905311312.PAA18094@beta.informatik.hu-berlin.de>
Comments: In reply to Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
        "Re: forwarded bug report" (May 31,  3:12pm)
References: <199905311312.PAA18094@beta.informatik.hu-berlin.de> 
	<rsqiu99cnj9.fsf@crane.jaist.ac.jp>
In-Reply-To: <rsqiu99cnj9.fsf@crane.jaist.ac.jp>
Comments: In reply to Tanaka Akira <akr@jaist.ac.jp>
        "Re: forwarded bug report" (May 31, 11:38pm)
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: forwarded bug report
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On May 31,  3:12pm, Sven Wischnowsky wrote:
} Subject: Re: forwarded bug report
} 
} Markus F.X.J. Oberhumer wrote:
} >   compctl -s "\$(cat [tT]his-file-does-not-exist)" foo
} 
} When expanding the -s-string, we explicitly switch NULL_GLOB on so
} that `compctl -s "*.c \$(< foo)"' works without producing an error if
} there is no `*.c'.

That's not the only reason, is it?  We want the list of completion matches
to be empty when the glob pattern fails; if the only concern was for the
error, we could use NO_NOMATCH instead.

} Of course, this makes it fail in cases like the one above... (where
} the cat tries to start reading and never finishes).
} 
} Does anyone have an idea how we could make this safe?

Seems as if we need a variant of NULL_GLOB that actually replaces the
unmatched patterns with empty strings, rather than deleting them from the
command entirely.

On May 31, 11:38pm, Tanaka Akira wrote:
} Subject: Re: forwarded bug report
}
} I think that zsh can prevents hanging by redirecting stdin to /dev/null.

That's probably a good idea, but it doesn't solve the more general problem
of commands being invoked with a different-than-expected number of args.

(Providing a closed stdin as if <&- might be a better idea for most cases,
though it causes "cat" to complain about bad file descriptors.)

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

