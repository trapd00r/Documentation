From zsh-workers-return-14800-mason-zsh=primenet.com.au@sunsite.dk Fri Jun 08 10:54:17 2001
Return-Path: <zsh-workers-return-14800-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21163 invoked from network); 8 Jun 2001 10:54:17 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Jun 2001 10:54:17 -0000
Received: (qmail 29238 invoked by alias); 8 Jun 2001 10:53:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14800
Received: (qmail 29224 invoked from network); 8 Jun 2001 10:53:55 -0000
X-VirusChecked: Checked
Sender: kiddleo@cav.logica.co.uk
Message-ID: <3B20AEB3.B258BD5F@yahoo.co.uk>
Date: Fri, 08 Jun 2001 11:53:39 +0100
From: Oliver Kiddle <okiddle@yahoo.co.uk>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.2.15 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
CC: Timo Aaltonen <tjaalton@cc.hut.fi>, zsh-workers@sunsite.dk
Subject: Re: AIX-problem: the main module won't link statically
References: <001501c0eff2$70ad3ee0$21c9ca95@mow.siemens.ru>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Andrej Borsenkow wrote:
> 
> Yes. AFAIK currently none of zsh developers works on AIX. Oliver, could you
> comment on this?

I haven't used AIX since I left my old job last August and that was AIX
3.2 on old pre-PowerPC hardware so I probably can't be much help. The
main thing I should point out though is that I don't think it should be
building a libzsh-..so - it should be able to stick that all in the zsh
binary. At least if I remember correctly that was how it always was but
I may be wrong. I'd be suprised if that has changed in 4.3 because my
3.2 compiled binaries used to work on AIX 4.2 (we had a couple of 4.2
machines which didn't have a C compiler).

The arguments to the link don't look very familiar - I don't recognise
-bexpall and I don't like the look of the strip (-s) flag when linking a
shared library. The warning about the entry point makes me suspicious
that it is trying to link the library as a binary not as a shared
library. Make sure you don't have the any environment variables like
CFLAGS, LDFLAGS etc set (or $CC including arguments) or if any of these
are set from a config.site script. Try a clean build and we might then
be able to work something out by looking through config.log and similar
files.

Basically, my guess is that something has gone wrong in one of the
configure tests. Did you have any of the previous 3.1.X versions working
with dynamic linking?

Timo Aaltonen wrote:

> It works statically (test nr C02 failed though).. but it is weird

Is this the [[ -N ... ]] test - it often fails when run on an NFS
mounted partition. There are also a few expected failures if you run the
tests as root.

Oliver

_____________________________________________________________________
This message has been checked for all known viruses by the 
MessageLabs Virus Scanning Service. For further information visit
http://www.messagelabs.com/stats.asp

