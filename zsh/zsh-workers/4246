From zsh-workers-request@math.gatech.edu Wed Jul 22 22:13:14 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22011 invoked from network); 22 Jul 1998 22:13:13 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 22 Jul 1998 22:13:13 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id SAA16110;
	Wed, 22 Jul 1998 18:03:14 -0400 (EDT)
Resent-Date: Wed, 22 Jul 1998 18:03:14 -0400 (EDT)
Message-Id: <199807222203.SAA16095@math.gatech.edu>
From: Wesley Darlington <w.darlington@am.qub.ac.uk>
Subject: Segfault in zsh on linux/alpha
To: zsh-workers@math.gatech.edu
Date: Wed, 22 Jul 98 23:05:10 BST
Mailer: Elm [revision: 70.85]
Resent-Message-ID: <"CfH7w.0.fx3.X6cjr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4246
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hi folks,

We have a linux/alpha box - a 533MHz 21164 PC164LX motherboard running
Redhat 5.1 with a vanilla redhat 2.0.34 kernel. I found that the default
zsh supplied with redhat dumped core if I use the `read' command, viz:

thunder-1-% zsh
thunder% read something
df
Segmentation fault (core dumped)
Exit 139
thunder-2-% rpm -q zsh
zsh-3.0.5-3
thunder-3-%

I downloaded zsh-3.1.4.tar.gz and compiled it: ./configure, make.
When I run Src/zsh, it too segfaults when I use the read builtin,
although much quicker than the default redhat zsh and without waiting
for input.

What is most interesting, is that if I set CFLAGS to nothing "", ie.
no optimisation, the problem goes away. The gcc is egcs-2.90.27.
When I compile with -O2, the default, then the problem is there.

I don't subscribe to zsh-workers; I just thought y'all might be
interested in this. It sounds more like a bug in egcs than in zsh,
but... ;-)

Regards,
Wesley Darlington,                      
Dept of Applied Maths,               No `Office 97' documents please.
Queen's University of Belfast.            Free the X11R6 Four!
(01232) T 273911 F 239182

