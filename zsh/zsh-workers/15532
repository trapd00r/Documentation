From zsh-workers-return-15532-mason-zsh=primenet.com.au@sunsite.dk Mon Jul 30 14:53:17 2001
Return-Path: <zsh-workers-return-15532-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16002 invoked from network); 30 Jul 2001 14:53:15 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Jul 2001 14:53:15 -0000
Received: (qmail 4831 invoked by alias); 30 Jul 2001 14:53:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15532
Received: (qmail 4819 invoked from network); 30 Jul 2001 14:53:09 -0000
Date: Mon, 30 Jul 2001 15:53:07 +0100
From: Adam Spiers <adam@spiers.net>
To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Subject: instant core dump with latest CVS
Message-ID: <20010730155307.A16163@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
X-Home-Page: http://www.new.ox.ac.uk/~adam/
X-OS: RedHat Linux

My newly-compiled zsh core-dumps as soon as you run it.  With -x:

  +/nfs-home/adams/.zshrc:269> promptinit
  +promptinit:9> prompt_themes=( )
  +promptinit:10> typeset -gU prompt_themes
  +promptinit:11> typeset -g prompt_theme
  +promptinit:192> [[ -o kshautoload ]]
  +promptinit:192> promptinit
  +promptinit:1> emulate -L zsh
  +promptinit:2> setopt extendedglob
  +promptinit:3> local ppath= name theme
  zsh: 15701 segmentation fault (core dumped)  ~/local/bin/zsh -x

Here's the lengthy stack trace; hopefully it will be enough to track
it down.

#0  0x400e318f in strlen (str=0x40292f54 <Address 0x40292f54 out of bounds>)
    at ../sysdeps/i386/strlen.c:27
#1  0x80a903f in dupstring (s=0x40292f54 <Address 0x40292f54 out of bounds>) at string.c:39
#2  0x809d39f in ecgetstr (s=0xbfffe2f0, dup=2, tok=0xbfffdf74) at parse.c:2130
#3  0x809d542 in ecgetlist (s=0xbfffe2f0, num=2860, dup=2, tok=0xbfffdfec) at parse.c:2189
#4  0x8084fbb in execfor (state=0xbfffe2f0, do_exec=0) at loop.c:86
#5  0x8066538 in execcmd (state=0xbfffe2f0, input=0, output=0, how=2, last1=2) at exec.c:2241
#6  0x80631bb in execpline2 (state=0xbfffe2f0, pcode=451, how=2, input=0, output=0, last1=0)
    at exec.c:1192
#7  0x806274f in execpline (state=0xbfffe2f0, slcode=60418, how=2, last1=0) at exec.c:982
#8  0x8062183 in execlist (state=0xbfffe2f0, dont_change_job=1, exiting=0) at exec.c:826
#9  0x8061ea4 in execode (p=0x80e2430, dont_change_job=1, exiting=0) at exec.c:729
#10 0x8069470 in runshfunc (prog=0x80e2430, wrap=0x0, name=0x401a9888 "promptinit")
    at exec.c:3459
#11 0x806926f in doshfunc (name=0x80e2480 "promptinit", prog=0x80e2430, doshargs=0x401a9830,
    flags=0, noreturnval=0) at exec.c:3390
#12 0x8068c38 in execshfunc (shf=0x80e2468, args=0x401a9830) at exec.c:3200
#13 0x8066711 in execcmd (state=0xbfffe740, input=0, output=0, how=18, last1=2)
    at exec.c:2283
#14 0x80631bb in execpline2 (state=0xbfffe740, pcode=12355, how=18, input=0, output=0,
    last1=0) at exec.c:1192
#15 0x806274f in execpline (state=0xbfffe740, slcode=4098, how=18, last1=0) at exec.c:982
#16 0x8062183 in execlist (state=0xbfffe740, dont_change_job=1, exiting=0) at exec.c:826
#17 0x8061ea4 in execode (p=0x80e2370, dont_change_job=1, exiting=0) at exec.c:729
#18 0x8068ce2 in execautofn (state=0xbfffea30, do_exec=0) at exec.c:3228
#19 0x8066538 in execcmd (state=0xbfffea30, input=0, output=0, how=18, last1=2)
    at exec.c:2241
#20 0x80631bb in execpline2 (state=0xbfffea30, pcode=3, how=18, input=0, output=0, last1=0)
    at exec.c:1192
#21 0x806274f in execpline (state=0xbfffea30, slcode=3074, how=18, last1=0) at exec.c:982
#22 0x8062183 in execlist (state=0xbfffea30, dont_change_job=1, exiting=0) at exec.c:826
#23 0x8061ea4 in execode (p=0x80e8c70, dont_change_job=1, exiting=0) at exec.c:729
#24 0x8069470 in runshfunc (prog=0x80e8c70, wrap=0x0, name=0x401a9680 "promptinit")
    at exec.c:3459
#25 0x806926f in doshfunc (name=0x80e2160 "", prog=0x80e8c70, doshargs=0x401a9648,
    flags=8704, noreturnval=0) at exec.c:3390
#26 0x8068c38 in execshfunc (shf=0x80e2130, args=0x401a9648) at exec.c:3200
#27 0x8066711 in execcmd (state=0xbffff160, input=0, output=0, how=2, last1=2) at exec.c:2283
#28 0x80631bb in execpline2 (state=0xbffff160, pcode=17283, how=2, input=0, output=0,
    last1=0) at exec.c:1192
#29 0x806274f in execpline (state=0xbffff160, slcode=3074, how=2, last1=0) at exec.c:982
#30 0x8062183 in execlist (state=0xbffff160, dont_change_job=1, exiting=0) at exec.c:826
#31 0x8086238 in execif (state=0xbffff160, do_exec=0) at loop.c:503
#32 0x8066538 in execcmd (state=0xbffff160, input=0, output=0, how=2, last1=2) at exec.c:2241
#33 0x80631bb in execpline2 (state=0xbffff160, pcode=17027, how=2, input=0, output=0,
    last1=0) at exec.c:1192
#34 0x806274f in execpline (state=0xbffff160, slcode=115714, how=2, last1=0) at exec.c:982
#35 0x8062183 in execlist (state=0xbffff160, dont_change_job=1, exiting=0) at exec.c:826
#36 0x8061ea4 in execode (p=0x80e6040, dont_change_job=1, exiting=0) at exec.c:729
#37 0x807a91b in source (s=0xbffff1e0 "/nfs-home/adams/.zshrc") at init.c:996
#38 0x807ac02 in sourcehome (s=0x80bd7b3 ".zshrc") at init.c:1044
#39 0x807a63d in run_init_scripts () at init.c:908
#40 0x807b4d4 in zsh_main (argc=1, argv=0xbffff424) at init.c:1204
#41 0x8051854 in main (argc=1, argv=0xbffff424) at ./main.c:37
#42 0x4007fb5c in __libc_start_main (main=0x8051840 <main>, argc=1, ubp_av=0xbffff424,
    init=0x8050d50 <_init>, fini=0x80bafe0 <_fini>, rtld_fini=0x4000d634 <_dl_fini>,
    stack_end=0xbffff41c) at ../sysdeps/generic/libc-start.c:129

