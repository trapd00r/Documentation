From zsh-workers-return-21537-mason-zsh=primenet.com.au@sunsite.dk Wed Jul 27 11:58:38 2005
Return-Path: <zsh-workers-return-21537-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6606 invoked from network); 27 Jul 2005 11:58:35 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 27 Jul 2005 11:58:35 -0000
Received: (qmail 31559 invoked from network); 27 Jul 2005 11:58:30 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Jul 2005 11:58:29 -0000
Received: (qmail 15175 invoked by alias); 27 Jul 2005 11:58:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21537
Received: (qmail 15163 invoked from network); 27 Jul 2005 11:58:26 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 27 Jul 2005 11:58:26 -0000
Received: (qmail 31274 invoked from network); 27 Jul 2005 11:58:26 -0000
Received: from smtp4.uk.deuba.com (HELO imr4.srv.uk.deuba.com) (160.83.34.15)
  by a.mx.sunsite.dk with SMTP; 27 Jul 2005 11:58:22 -0000
Received: from loninmrp1.uk.db.com by imr4.srv.uk.deuba.com 
         id j6RBwLBF006030; Wed, 27 Jul 2005 12:58:21 +0100 (BST)
Received: from db.com by loninmrp1.uk.db.com 
         id j6RBwH9l010223; Wed, 27 Jul 2005 12:58:20 +0100
Message-ID: <42E776D8.80906@db.com>
Date: Wed, 27 Jul 2005 13:58:16 +0200
From: Andreas Pistoor <andreas.pistoor@db.com>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; de-AT; rv:1.4.2) Gecko/20040220
X-Accept-Language: de, de-at, en, en-us
MIME-Version: 1.0
To: zsh-workers@sunsite.dk
Subject: Wrong build on SunOS 5.8 or bug in zsh?
X-Enigmail-Version: 0.76.8.0
X-Enigmail-Supports: pgp-inline, pgp-mime
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.0.4

Hello,
we switched from ksh to zsh, when our main application was ported from
AIX on ppc to Linux/Gnu on ia32. Later we introduced zsh-only-code into
our scripts and ported our application for a new customer to SunOS 5.8
on sparc.
On Linux, AIX and our develop-SunOS the zsh works fine, but on our
SunOS-production-machines some long running scripts, which starts many
subjobs and waits for them, get from time to time a signal SIGBUS (or
maybe SIGILL or SIGSEGV, I am not sure about older events). Sometimes
this signal was resent while the zsh was in the code to buffer a
previous signal in its internal list, resulting in overflowing this list
and locking the shell. At other times, the signal was traped and resent
while trying to exit the shell in that trap, also locking the shell. The
last time, now without the traps on that signals, a subshell called by
$( ... ) exited.
In production, at most nights 5 such longrunning scripts are running and
around once in a month such a signal is recieved.
As we can not reproduce the problem on our development machine, I ask,
whether you have some knowledge about problems of the zsh on SunOS and
Sparc. We are now using zsh-4.2.5 which were compiled with gcc-3.3.2 and
configure-options --enable-libs=/usr/local/lib/libiconv.so
--prefix=$PWD//usr.
To check for heap-problems, I tried bcheck (a script on top of RTC, a
runtimechecker of the heap, of the Sun-compiler and -debugger), which
told, it would disable the errorchecking, as there was an internal RTC
error in memmap.c and some lock was broken in malloc.c, and own
testroutines as malloc, realloc, calloc and free, which did not found
problems.

Thank you for your time
Andreas Pistoor
Softwaredeveloper in Germany


