From zsh-workers-return-5462-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Feb 22 09:38:17 1999
Return-Path: <zsh-workers-return-5462-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19777 invoked from network); 22 Feb 1999 09:38:15 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Feb 1999 09:38:15 -0000
Received: (qmail 27026 invoked by alias); 22 Feb 1999 09:37:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5462
Received: (qmail 27019 invoked from network); 22 Feb 1999 09:37:55 -0000
Message-Id: <9902220921.AA11759@ibmth.df.unipi.it>
To: probin@qnx.com, zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: zsh on QNX4 
In-Reply-To: ""Philippe Robin""'s message of "Fri, 19 Feb 1999 14:15:04 NFT."
             <000001be5c12$3f07e000$089d9e9f@philippe.qssl> 
Date: Mon, 22 Feb 1999 10:21:57 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>

"Philippe Robin" wrote:
> I got zsh running on QNX 4.25 operating system. I have included the few
> modifications I did to get it to work at the end of this mail if you want to
> incorporate this...

This looks pretty easy to include, but it ought to be decided
automatically.  It's possible to put ad hoc code in configure if necessary,
though if there were some predefined preprocessor symbol that would be
better.

> #define GETPGRP_VOID

Does the configure test for this not work?  You should get something like

checking whether getpgrp takes no argument... yes

and config.log should say why it failed, if it did.

> #ifdef QNX
>     oxtabs = 0;
> #else
>     oxtabs = ((SGTTYFLAG & SGTABTYPE) == SGTABTYPE);
> #endif

Is it enough to test
#if defined(SGTTYFLAG) && defined(SGTABTYPE)
?

> #  ifdef OXTABS
>     ti.tio.c_oflag &= ~OXTABS;
> #  else
> //    ti.tio.c_oflag &= ~XTABS;
> #  endif
> # endif
> //    ti.tio.c_oflag |= ONLCR;

Likewise, can we just test directly for these flags being defined?

> #ifndef QNX
> char *
> zgetcwd(void)
> {
>     return getcwd(NULL, 0);
> }
> #else

This looks like something we need a preprocessor definition for.  If there
really isn't one (_QNX_, _QNX, __QNX__, ...?) the system as printed out
when configure starts should be enough to work on.

> halloc() is already defined on QNX with the following prototype:

That's an annoyance, but we can easily rename it to zhalloc().

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

