From zsh-users-return-3419-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Sep 12 05:21:24 2000
Return-Path: <zsh-users-return-3419-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12121 invoked from network); 12 Sep 2000 05:21:23 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 12 Sep 2000 05:21:23 -0000
Received: (qmail 12851 invoked by alias); 12 Sep 2000 05:20:36 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3419
Received: (qmail 12843 invoked from network); 12 Sep 2000 05:20:35 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000912052009.ZM5715@candle.brasslantern.com>
Date: Tue, 12 Sep 2000 05:20:08 +0000
In-Reply-To: <200009111436.KAA02215@soup.ads.apexinc.com>
Comments: In reply to "E. Jay Berkenbilt" <ejb@ql.org>
        "3.1.9 completion problems: automounter" (Sep 11, 10:36am)
References: <200009111436.KAA02215@soup.ads.apexinc.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: "E. Jay Berkenbilt" <ejb@ql.org>, zsh-users@sunsite.auc.dk
Subject: Re: 3.1.9 completion problems: automounter
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Sep 11, 10:36am, E. Jay Berkenbilt wrote:
} Subject: 3.1.9 completion problems: automounter
}
} I'd like to know whether there is a way to get zsh to try to access
} /home/sysadmin before deciding that there are no completions that
} start from it.

Hmm.  I've just been playing with zsh on a machine at work that has an
automounted directory, and I can't reproduce the behavior you described.
If I type

zsh% ls /host/hostname<TAB>

I get a feep.  But if instead I type

zsh% ls /host/hostname/<TAB>

with the trailing slash, the mount happens and I get completions.  This
happens both with and without the new completion system loaded.  With
old-style completion, I get the following strace output, starting from
the point at which the TAB I typed is read:

read(10, "\t", 1)                       = 1
fcntl(0, F_DUPFD, 10)                   = 11
close(0)                                = 0
access("/bin/ls", X_OK)                 = 0
stat("/bin/ls", {st_mode=S_IFREG|0755, st_size=43024, ...}) = 0
open("/misc/moonbase/", O_RDONLY|O_NONBLOCK|O_DIRECTORY) = 0
fstat(0, {st_mode=S_IFDIR|0755, st_size=1024, ...}) = 0

So zsh *does* try to access the directory before deciding that it does
not exist.  Does open("/home/sysadmin/", ...) fail on your system?

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

