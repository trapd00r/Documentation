From zsh-workers-return-15964-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 08 07:13:35 2001
Return-Path: <zsh-workers-return-15964-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21015 invoked from network); 8 Oct 2001 07:13:34 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Oct 2001 07:13:34 -0000
Received: (qmail 23308 invoked by alias); 8 Oct 2001 07:13:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15964
Received: (qmail 23291 invoked from network); 8 Oct 2001 07:13:28 -0000
From: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
To: zsh-workers@sunsite.dk
Subject: PATCH: SOCKLEN_T in tcp.c
Date: Mon, 8 Oct 2001 11:12:54 +0400
Message-ID: <001401c14fc8$a6803c80$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.2627
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2600.0000
Importance: Normal

While it is pretty harmless in connect() it may be an issue in
setsockopt() (alignment and such). In any case, why we create configure
tests when we do not use them? :-)

-andrej

Index: Src/Modules/tcp.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Modules/tcp.c,v
retrieving revision 1.16
diff -u -r1.16 tcp.c
--- Src/Modules/tcp.c   2001/10/02 02:35:01     1.16
+++ Src/Modules/tcp.c   2001/10/08 07:08:31
@@ -355,7 +355,8 @@
 static int
 bin_ztcp(char *nam, char **args, char *ops, int func)
 {
-    int herrno, err=1, destport, force=0, verbose=0, test=0,
targetfd=0, len;
+    int herrno, err=1, destport, force=0, verbose=0, test=0,
targetfd=0;
+    SOCKLEN_T  len;
     char **addrp, *desthost, *localname, *remotename, **dargs;
     struct hostent *zthost = NULL, *ztpeer = NULL;
     struct servent *srv;

