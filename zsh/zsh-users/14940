From zsh-users-return-14940-mason-zsh=primenet.com.au@zsh.org Tue Mar 16 00:13:37 2010
Return-Path: <zsh-users-return-14940-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 487 invoked by alias); 16 Mar 2010 00:13:36 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14940
Received: (qmail 17508 invoked from network); 16 Mar 2010 00:13:24 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at vinc17.org does not designate permitted sender hosts)
Date: Tue, 16 Mar 2010 01:13:19 +0100
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-users@zsh.org
Subject: Re: zsh sometimes freezes when completing a command
Message-ID: <20100316001319.GC1761@prunille.vinc17.org>
Mail-Followup-To: zsh-users@zsh.org
References: <20100315101546.GA28047@prunille.vinc17.org>
 <100315085820.ZM6723@torch.brasslantern.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <100315085820.ZM6723@torch.brasslantern.com>
X-Mailer-Info: http://www.vinc17.org/mutt/
User-Agent: Mutt/1.5.20-6061-vl-r35499 (2010-03-08)

On 2010-03-15 08:58:20 -0700, Bart Schaefer wrote:
> } I've run gdb on the current process. Here's the backtrace:
> } 
> } (gdb) bt
> } #0  0x00007fe80de60b1f in poll () from /lib/libc.so.6
> } #1  0x00007fe80853811d in ldap_result () from /usr/lib/libldap_r-2.4.so.2
> 
> So what's causing the "freeze" is that zsh is waiting for the LDAP
> server to time out.

It seems to never time out. I suspect a bug. This occurs from time to
time. After zsh has frozen, I can do the same completion from another
zsh instance on the same machine, and the completion is immediate.

I have:

zstyle ':completion:*:complete:-command-:*' tag-order 'commands builtins functions aliases suffix-aliases reserved-words jobs parameters' '*'

and the complete help says:

tags in context :completion::complete:-command-::
    commands executables builtins functions aliases suffix-aliases reserved-words jobs parameters  (_alternative _command_names _autocd (eval)) 
    commands                                                                                       (_path_commands _alternative _command_names _autocd (eval)) 
    jobs                                                                                           (_jobs _alternative _command_names _autocd (eval)) 
    parameters                                                                                     (_parameters _alternative _command_names _autocd (eval)) 
    named-directories                                                                              (_alternative _cd _autocd (eval)) 
    users named-directories directory-stack                                                        (_tilde _alternative _cd _autocd (eval)) 
    users                                                                                          (_users _tilde _alternative _cd _autocd (eval))

I wonder why zsh tries to complete on users.

-- 
Vincent Lefèvre <vincent@vinc17.net> - Web: <http://www.vinc17.net/>
100% accessible validated (X)HTML - Blog: <http://www.vinc17.net/blog/>
Work: CR INRIA - computer arithmetic / Arénaire project (LIP, ENS-Lyon)

