From zsh-workers-return-14089-mason-zsh=primenet.com.au@sunsite.dk Wed Apr 25 12:55:33 2001
Return-Path: <zsh-workers-return-14089-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3680 invoked from network); 25 Apr 2001 12:55:32 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Apr 2001 12:55:32 -0000
Received: (qmail 4790 invoked by alias); 25 Apr 2001 12:55:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14089
Received: (qmail 4770 invoked from network); 25 Apr 2001 12:55:17 -0000
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
Date: Wed, 25 Apr 2001 11:03:45 +0200 (MET DST)
Message-Id: <200104250903.LAA03520@beta.informatik.hu-berlin.de>
To: zsh-workers@sunsite.dk
Subject: PATCH: compfiles

The other one from the debian bug list (I had almost forgotten).

The mistake is so embarrassing, I almost don't dare to show you the patch.

It showed up (sometimes) when completing files with a long prefix.


I'm going to commit this one and when sunsite comes up again, I'll
change the number in the ChangeLog.

Bye
  Sven

Index: Src/Zle/computil.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/computil.c,v
retrieving revision 1.48
diff -u -r1.48 computil.c
--- Src/Zle/computil.c	2001/04/17 09:52:32	1.48
+++ Src/Zle/computil.c	2001/04/25 09:01:40
@@ -3261,7 +3261,7 @@
 	if (haswilds(t))
 	    return;
     }
-    add = (char *) zhalloc(sizeof(compprefix) * 2 + 1);
+    add = (char *) zhalloc(strlen(compprefix) * 2 + 1);
     for (s = compprefix, t = add; *s; s++) {
 	if (*s != '\\' || !s[1] || s[1] == '*' || s[1] == '?' ||
 	    s[1] == '<' || s[1] == '>' || s[1] == '(' || s[1] == ')' ||

-- 
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

