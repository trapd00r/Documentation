From zsh-users-return-14258-mason-zsh=primenet.com.au@sunsite.dk Sun Jul 26 11:05:22 2009
Return-Path: <zsh-users-return-14258-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26312 invoked from network); 26 Jul 2009 11:05:07 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 26 Jul 2009 11:05:07 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 39156 invoked from network); 26 Jul 2009 11:04:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Jul 2009 11:04:42 -0000
Received: (qmail 5178 invoked by alias); 26 Jul 2009 11:03:58 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14258
Received: (qmail 5154 invoked from network); 26 Jul 2009 11:03:57 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 26 Jul 2009 11:03:57 -0000
Received: from smtp110.mail.ukl.yahoo.com (smtp110.mail.ukl.yahoo.com [77.238.184.48])
	by bifrost.dotsrc.org (Postfix) with SMTP id 6C1648027106
	for <zsh-users@sunsite.dk>; Sun, 26 Jul 2009 13:03:51 +0200 (CEST)
Received: (qmail 49879 invoked from network); 26 Jul 2009 11:03:51 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Date:From:To:Cc:Subject:Message-ID:Mail-Followup-To:References:MIME-Version:Content-Type:Content-Disposition:In-Reply-To:User-Agent;
  b=f7amwGnGKI2fNC/1LHJRR0vi0daAEA3yGDD9LTOjTau5u+2vyl4bYMHtqT0o7RehZ3MU2QC1lrzi7Ui0kvQLMzlyWcO+ktBoL2ynvJu1o3rlLTByFDkZ7pOPeULHZUTOnrgP/bnD/NH+LAyrDaxPTeR66ajHozzkoJ5E07M/R48=  ;
Received: from unknown (HELO seebyte.com) (stephane_chazelas@78.105.235.196 with login)
  by smtp110.mail.ukl.yahoo.com with SMTP; 26 Jul 2009 11:03:51 -0000
X-Yahoo-SMTP: UETkiwKswBCC9bX5uJ2yis03J2tKBqQX.pJ.0Bnx
X-YMail-OSG: kGG4.bAVM1n0DV9rxvZaqU8lTxngvXmHwcJOOvqZYWLvkctZfPsT8TRLpSmLDEjerUSUp1RWo9aIBHBJJw48hiXXW9C2vZjzbPOpEjOSys3K.riJxLcAP7Qf.Af3VzsgbKVPM3xDzZosPNLIoA9YPKh3MF9TZVlgqyLk.CITWwkK5u6rm7JJUwacEJ.4lQAR.Pq52gEopdzxZLAibDQ7uCCG_.AK99Ys0zI5XZkSs0zNQWWN8H16.z38IHPx0n24e1uJD.XaQ1uPbJ6x7ZVWXc_qhk9No8bezTiYhJoFPl5zyVrdn1kp
X-Yahoo-Newman-Property: ymail-3
Date: Sun, 26 Jul 2009 12:03:49 +0100
From: Stephane Chazelas <stephane_chazelas@yahoo.fr>
To: Bart Schaefer <schaefer@brasslantern.com>
Cc: spiralofhope <spiralofhope@gmail.com>, zsh-users@sunsite.dk
Subject: Re: making `cd` work unquoted
Message-ID: <chaz20090726110349.GA5452@seebyte.com>
Mail-Followup-To: Bart Schaefer <schaefer@brasslantern.com>,
	spiralofhope <spiralofhope@gmail.com>, zsh-users@sunsite.dk
References: <20090725091008.7af5b873@gmail.com> <090725111722.ZM23913@torch.brasslantern.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <090725111722.ZM23913@torch.brasslantern.com>
User-Agent: Mutt/1.5.16 (2007-09-19)
X-Virus-Scanned: ClamAV 0.94.2/9615/Sun Jul 26 09:20:40 2009 on bifrost
X-Virus-Status: Clean

2009-07-25 11:17:22 -0700, Bart Schaefer:
> On Jul 25,  9:10am, spiralofhope wrote:
> }
> } I'm trying to make a function which will accept this:
> }   cd foo bar baz
> } and have it acted upon as:
> }   cd "foo bar baz"
> } 
> } So far, I've run into a few snags.
> } 
> } I don't see how I can make a 'cd' function which will refer to the
> } 'cd' builtin.  Not a big deal, I could call the function 'ccd'.
> 
> cd() { builtin cd "$*" }
> 
> } I can't do something simple like cd "$@"
> 
> "$@" is the same as "$1" "$2" "$3" ...
> 
> "$*" is the same as "$1 $2 $3 ..."
[...]

Strictly speaking, in "$*", the positional parameters are joined
with the first character of $IFS (or with nothing if $IFS is
empty or with a space if $IFS is unset). So that's "space"
unless $IFS is modified.

So, I'd rather do:

cd() { local IFS=' '; builtin cd "$*"; }

Another problem is that "cd" alone, to get into one's home
directory becomes cd "" which does not nothing.

cd() {
  emulate -L zsh
  [[ $# -eq 1 && -z $1 ]] || builtin cd ${(j: :)*}
}

Note that even after that,

cd foo   bar baz

won't cd into "foo   bar baz" but into "foo bar baz".

You may want to check for options as well.

It's dangerous to rebind existing commands as then you end up
getting used to it and shooting yourself in the foot when on
another system or other shell.

I'd recommand to use another name like "mycd" or "c".

Another approach could be to add a key binding that quotes
Everything from the second word (or from the first non-option
argument). So that you would visually see what happens and could
apply it to any other command.

-- 
Stephane

