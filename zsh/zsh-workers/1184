From kaefer@aglaia.snafu.DE Mon May 27 12:45:03 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id MAA05484 for <mason@werple.mira.net.au>; Mon, 27 May 1996 12:45:00 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id WAA21110; Sun, 26 May 1996 22:31:10 -0400 (EDT)
Resent-Date: Sun, 26 May 1996 22:31:10 -0400 (EDT)
Message-Id: <m0uNsCu-00008oC@aglaia.snafu.DE>
Subject: Re: seg fault on $(dgqhghdqwdhqwjq) : beta19
To: zsh-workers@math.gatech.edu
Date: Mon, 27 May 1996 04:38:55 +0200 (MET DST)
In-Reply-To: <199605270113.DAA01134@hzoli.ppp.cs.elte.hu> from "Zoltan Hidvegi" at May 27, 96 03:13:45 am
From: Thorsten Meinecke <kaefer@aglaia.snafu.DE>
Organization: none. Location: Berlin, Germany
X-Mailer: ELM [version 2.4 PL23]
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
Resent-Message-ID: <"cqeNu3.0.j95.jFHgn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1184
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 703
Status: O

> > res1% $(wekdwqw)
> > zsh: command not found: wekdwqw
> > zsh: 21441 segmentation fault  $(wekdwqw)
> 
> It always happens when prefork() in execcmd() removes all arguments.
> Eg. $foo triggers the bug if foo is not set.

zsh's child dies in execute(), exec.c:243, when it tries to access
the empty argument list.  But there's more to this than only that:

The exit code doesn't make sense when command substitution happens
in command position, eg.

  % ./zsh -fc '$(true); echo $?'
  139
  % ./zsh -fc '$(false); echo $?'
  139

Both bash and pd-ksh say `0' and '1' here, respectively.  They both
give an exit code of `127' if the command isn't found.  What's the
Right Thing?

Regards,
--Thorsten


