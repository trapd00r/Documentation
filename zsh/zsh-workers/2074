From zsh-workers-request@euclid.skiles.gatech.edu  Mon Aug 26 10:52:21 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id KAA06325 for <mason@primenet.com.au>; Mon, 26 Aug 1996 10:52:18 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id UAA22418; Sun, 25 Aug 1996 20:49:34 -0400 (EDT)
Resent-Date: Sun, 25 Aug 1996 20:49:34 -0400 (EDT)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <960825175026.ZM16431@candle.brasslantern.com>
Date: Sun, 25 Aug 1996 17:50:26 -0700
In-Reply-To: Zoltan Hidvegi <hzoli@cs.elte.hu>
        "Re: Reliable zsh-3.0.0 core dump" (Aug 26,  1:59am)
References: <199608252359.BAA30725@hzoli.ppp.cs.elte.hu>
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (4.0b.729 29jul96)
To: Zoltan Hidvegi <hzoli@cs.elte.hu>
Subject: Re: Reliable zsh-3.0.0 core dump
Cc: zsh-workers@math.gatech.edu
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"Xli8w2.0.9U5.TIF8o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2074
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Aug 26,  1:59am, Zoltan Hidvegi wrote:
} Subject: Re: Reliable zsh-3.0.0 core dump
}
} > I can't get a core dump either if I use --enable-zsh-mem ... only with
} > the system malloc.  I hadn't tried zsh-mem before.
} 
} Did you try --enable-zsh-{debug,mem{,-debug},secure-free}?

Yes; they produced no warnings, and of course the core dump didn't
happen even with nothing more than --enable-zsh-mem, so ...

} The patch below fixes a bug which may cause that.

No such luck.  I still get a core dump.

} While testing this I
} also discovered that pipe synchronization was really necessary.

Can you say a bit about why (and maybe add a comment to the code!)?

} > In the second case, the built-in alias of run-help to man expanded before
} > help was invoked; in the first case it did not.  I think it should be
} > consistent (and I think the first case is how it should work, i.e. don't
} > expand the alias, but that's less important).
} > 
} > Or is this intentional and simply not documented?
} 
} It is half-intentional.  When the current word for completion is requested
} from the lexer alias expansion is disabled for that word which is good and
} reasonable.  The same mechanism is used by run-help.

I agree that alias expansion should be disabled for the current word; I
just think it should also be disabled for run-help no matter what word
is "current."  For run-help's purposes only the word in command position
is interesting.


-- 
Bart Schaefer                             Brass Lantern Enterprises
http://www.well.com/user/barts            http://www.nbn.com/people/lantern

New male in /home/schaefer:
>N  2 Justin William Schaefer  Sat May 11 03:43  53/4040  "Happy Birthday"

