From zsh-workers-return-23146-mason-zsh=primenet.com.au@sunsite.dk Sat Feb 03 01:15:24 2007
Return-Path: <zsh-workers-return-23146-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25908 invoked from network); 3 Feb 2007 01:15:19 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Feb 2007 01:15:19 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 20810 invoked from network); 3 Feb 2007 01:15:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Feb 2007 01:15:13 -0000
Received: (qmail 10357 invoked by alias); 3 Feb 2007 01:15:09 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23146
Received: (qmail 10347 invoked from network); 3 Feb 2007 01:15:08 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 3 Feb 2007 01:15:08 -0000
Received: (qmail 20450 invoked from network); 3 Feb 2007 01:15:08 -0000
Received: from smtp.hrz.tu-freiberg.de (HELO smtp.tu-freiberg.de) (139.20.64.64)
  by a.mx.sunsite.dk with SMTP; 3 Feb 2007 01:15:02 -0000
Received: from localhost (localhost [127.0.0.1])
	by smtp.tu-freiberg.de (Postfix) with ESMTP id E34B08D673
	for <zsh-workers@sunsite.dk>; Sat,  3 Feb 2007 02:15:01 +0100 (CET)
X-Virus-Scanned: amavisd-new at tu-freiberg.de
Received: from smtp.tu-freiberg.de ([127.0.0.1])
	by localhost (smtp.tu-freiberg.de [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 9MzaMiGqlIs9 for <zsh-workers@sunsite.dk>;
	Sat,  3 Feb 2007 02:14:58 +0100 (CET)
Received: from pollux.tribut.de (h-165-47.stunet.tu-freiberg.de [139.20.165.47])
	by smtp.tu-freiberg.de (Postfix) with ESMTP id AF3208D66C
	for <zsh-workers@sunsite.dk>; Sat,  3 Feb 2007 02:14:58 +0100 (CET)
Received: from pollux.tribut.de (pollux.tribut.de [127.0.0.1])
	by pollux.tribut.de (Postfix) with ESMTP id B7E8F5E8038
	for <zsh-workers@sunsite.dk>; Sat,  3 Feb 2007 02:14:58 +0100 (CET)
From: Felix Eckhofer <felix@tribut.de>
To: zsh-workers@sunsite.dk
Subject: Segfault in CVS when in interactive mode
Date: Sat, 3 Feb 2007 02:14:47 +0100
User-Agent: KMail/1.9.6
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart2712302.0ZumyUba6R";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200702030214.58090.felix@tribut.de>

--nextPart2712302.0ZumyUba6R
Content-Type: multipart/mixed;
  boundary="Boundary-01=_II+wFWoArIHiS48"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

--Boundary-01=_II+wFWoArIHiS48
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Hi again.

The Computer-Gods don't seem to like me today. While trying to use the=20
CVS version to investigate another problem (i'll write another mail in=20
a second) I ran into this segfault. The exact thing happend to me=20
before I applied the patch from earlier today so I'm starting to think=20
this might be a x64 specific issue.

Steps to reproduce:
  1) Open the menu completion interactive mode (not inc. search)
  2) Press any of [a-z]

Again, the backtrace is attached. Unfortunately I was unable to find why=20
this actually fails so I hope one of you might be able to reproduce it.=20
If you need any further information... you know where to ask :)


regards,
felix
=2D-=20
felix_eckhofer  *  [fli4l-/eis-team]  *  ICQ#_59008162

"Ein Betriebssystem sie zu knechten, sie alle zu finden,
 ins Dunkle zu treiben und ewig zu binden..."

--Boundary-01=_II+wFWoArIHiS48
Content-Type: application/octet-stream;
  name="zsh_segfault_doinsert.gdb-log"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename="zsh_segfault_doinsert.gdb-log"

GNU gdb 6.4.90-debian
Copyright (C) 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain condition=
s.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu"...Using host libthread_db lib=
rary "/lib/libthread_db.so.1".

(gdb) run
Starting program: /usr/local/bin/zsh=20

Program received signal SIGSEGV, Segmentation fault.
0x00002b568b0dba1c in doinsert (zstr=3D0x7fff205b5f4c, len=3D1) at zle_misc=
=2Ec:54
54		    zleline[zlecs++] =3D *s;
(gdb) bt
#0  0x00002b568b0dba1c in doinsert (zstr=3D0x7fff205b5f4c, len=3D1) at zle_=
misc.c:54
#1  0x00002b568b0dbabe in selfinsert (args=3D0x2b568b204420) at zle_misc.c:=
71
#2  0x00002b568b54db32 in domenuselect (dummy=3D0x2b568b439848, dat=3D0x7ff=
f205b64a0)
    at complist.c:2540
#3  0x0000000000460caf in runhookdef (h=3D0x2b568b439848, d=3D0x7fff205b64a=
0) at module.c:1876
#4  0x00002b568b31cfb8 in after_complete (dummy=3D0x2b568b203fd8, dat=3D0x7=
fff205b6540)
    at compcore.c:515
#5  0x0000000000460d19 in runhookdef (h=3D0x2b568b203fd8, d=3D0x7fff205b654=
0) at module.c:1882
#6  0x00002b568b0e9246 in docomplete (lst=3D0) at zle_tricky.c:869
#7  0x00002b568b0e796a in expandorcomplete (args=3D0x2b568b204420) at zle_t=
ricky.c:315
#8  0x00002b568b0e7531 in completecall (args=3D0x2b568b204420) at zle_trick=
y.c:208
#9  0x00002b568b0d91fc in execzlefunc (func=3D0x2b568b200fd0, args=3D0x2b56=
8b204420, set_bindk=3D0)
    at zle_main.c:1253
#10 0x00002b568b0d8714 in zlecore () at zle_main.c:1019
#11 0x00002b568b0d8e56 in zleread (lp=3D0x5cbe00, rp=3D0x5cbd38, flags=3D3,=
 context=3D0)
    at zle_main.c:1173
#12 0x0000000000446ce4 in inputline () at input.c:278
#13 0x0000000000446b71 in ingetc () at input.c:214
#14 0x000000000043c3c4 in ihgetc () at hist.c:240
#15 0x0000000000450605 in gettok () at lex.c:630
#16 0x000000000044fe43 in yylex () at lex.c:345
#17 0x000000000046de67 in parse_event () at parse.c:451
#18 0x000000000044388f in loop (toplevel=3D1, justonce=3D0) at init.c:128
#19 0x00000000004466bb in zsh_main (argc=3D1, argv=3D0x7fff205b6c58) at ini=
t.c:1347
#20 0x000000000040dc03 in main (argc=3D1, argv=3D0x7fff205b6c58) at ./main.=
c:93
(gdb) bt full
#0  0x00002b568b0dba1c in doinsert (zstr=3D0x7fff205b5f4c, len=3D1) at zle_=
misc.c:54
	s =3D (ZLE_STRING_T) 0x7fff205b5f4c
	c1 =3D 107
	neg =3D 0
	m =3D 0
	count =3D 1
#1  0x00002b568b0dbabe in selfinsert (args=3D0x2b568b204420) at zle_misc.c:=
71
	tmp =3D 107
#2  0x00002b568b54db32 in domenuselect (dummy=3D0x2b568b439848, dat=3D0x7ff=
f205b64a0)
    at complist.c:2540
	l =3D 3
	saveline =3D 0x0
	savell =3D 0
	savecs =3D 0
	s =3D (Menustack) 0x2b568ad7c278
	p =3D (Cmatch **) 0x651280
	pg =3D (Cmgroup *) 0x6270c0
	cmd =3D (Thingy) 0x2b568b201638
	do_last_key =3D 0
	u =3D (Menustack) 0x2b568ad7c278
	i =3D 1
	acc =3D 0
	wishcol =3D 0
	setwish =3D 0
	oe =3D 0
	wasnext =3D 0
	space =3D 41
	lbeg =3D 0
	step =3D 1
	wrap =3D 0
	pl =3D 1
	broken =3D 0
	first =3D 0
	nolist =3D 0
	mode =3D 1
	modecs =3D 3
	modell =3D 3
	modelen =3D 7
	wasmeta =3D 1
	s =3D 0x629ce0 "interactive"
	status =3D "interactive: []\000\v\000\000\000\000\000\000\000`Hc", '\0' <r=
epeats 22 times>, "\220=D7\212V+\000\000=E0=D7c\000\000\000\000\000\220d[ =
=FF\177\000\000c=CD1\213V+\000\000\000\000\000\000\000\000\000\000=F0\211b\=
000\000\000\000\000=F0K^\000\000\000\000\000H8\024\000\000\000\000\001\001\=
000\000\000\002\000\000\000\002\000\000\000\002\000\000"
	modeline =3D 0x2b568ad792d0 "cd "
	fdat =3D (Chdata) 0x7fff205b64a0
	lastsearch =3D 0x0
#3  0x0000000000460caf in runhookdef (h=3D0x2b568b439848, d=3D0x7fff205b64a=
0) at module.c:1876
	p =3D (LinkNode) 0x60a190
	r =3D 11094
#4  0x00002b568b31cfb8 in after_complete (dummy=3D0x2b568b203fd8, dat=3D0x7=
fff205b6540)
    at compcore.c:515
	cdat =3D {matches =3D 0x634ec0, num =3D 8, nmesg =3D 0, cur =3D 0x0}
	ret =3D 11094
#5  0x0000000000460d19 in runhookdef (h=3D0x2b568b203fd8, d=3D0x7fff205b654=
0) at module.c:1882
No locals.
#6  0x00002b568b0e9246 in docomplete (lst=3D0) at zle_tricky.c:869
	s =3D 0x63d960 "=D0=D7c"
	ol =3D 0x0
	olst =3D 4
	chl =3D 0
	ne =3D 0
	ocs =3D 3
	ret =3D 0
	dat =3D {0, 0}
	active =3D 1
#7  0x00002b568b0e796a in expandorcomplete (args=3D0x2b568b204420) at zle_t=
ricky.c:315
	ret =3D 11094
#8  0x00002b568b0e7531 in completecall (args=3D0x2b568b204420) at zle_trick=
y.c:208
No locals.
#9  0x00002b568b0d91fc in execzlefunc (func=3D0x2b568b200fd0, args=3D0x2b56=
8b204420, set_bindk=3D0)
    at zle_main.c:1253
	atcurhist =3D 1
	wflags =3D 134
	r =3D 0
	ret =3D 0
	w =3D (Widget) 0x6006d0
	save_bindk =3D (Thingy) 0x2b568b200fd0
#10 0x00002b568b0d8714 in zlecore () at zle_main.c:1019
No locals.
#11 0x00002b568b0d8e56 in zleread (lp=3D0x5cbe00, rp=3D0x5cbd38, flags=3D3,=
 context=3D0)
    at zle_main.c:1173
	s =3D 0x0
	old_errno =3D 0
	tmout =3D 0
	initthingy =3D (Thingy) 0x0
#12 0x0000000000446ce4 in inputline () at input.c:278
	flags =3D 3
	ingetcline =3D 0x0
	ingetcpmptl =3D (char **) 0x5cbe00
	ingetcpmptr =3D (char **) 0x5cbd38
	context =3D 0
#13 0x0000000000446b71 in ingetc () at input.c:214
	lastc =3D 0
#14 0x000000000043c3c4 in ihgetc () at hist.c:240
	c =3D 2
#15 0x0000000000450605 in gettok () at lex.c:630
	c =3D 0
	d =3D 0
	peekfd =3D -1
	peek =3D 0
#16 0x000000000044fe43 in yylex () at lex.c:345
No locals.
#17 0x000000000046de67 in parse_event () at parse.c:451
No locals.
#18 0x000000000044388f in loop (toplevel=3D1, justonce=3D0) at init.c:128
	prog =3D (Eprog) 0x7fff205b6ae0
#19 0x00000000004466bb in zsh_main (argc=3D1, argv=3D0x7fff205b6c58) at ini=
t.c:1347
	t =3D (char **) 0x7fff205b6c60
	t0 =3D 157
#20 0x000000000040dc03 in main (argc=3D1, argv=3D0x7fff205b6c58) at ./main.=
c:93
No locals.
(gdb) quit =08=1B[K
The program is running.  Exit anyway? (y or n)=20
--Boundary-01=_II+wFWoArIHiS48--

--nextPart2712302.0ZumyUba6R
Content-Type: application/pgp-signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)

iD8DBQBFw+IS6iGZQSR3yvgRAiK9AKCeoU0SsJY2gHTRpxEHlm4Zc1oQZACeO+Bk
I+KwgrBNLg/E6XW+f08gH0k=
=f9Ao
-----END PGP SIGNATURE-----

--nextPart2712302.0ZumyUba6R--

