From zsh-workers-return-27476-mason-zsh=primenet.com.au@zsh.org Mon Dec 07 16:40:52 2009
Return-Path: <zsh-workers-return-27476-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23764 invoked by alias); 7 Dec 2009 16:40:52 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27476
Received: (qmail 3967 invoked from network); 7 Dec 2009 16:40:50 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at closedmail.com does not designate permitted sender hosts)
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <091207073954.ZM9818@torch.brasslantern.com>
Date: Mon, 07 Dec 2009 07:39:54 -0800
In-reply-to: <20091207170336.c417efe1.einars@gmail.com>
Comments: In reply to Einar Lielmanis <einars@gmail.com>
 "zsh deep freeze (probably autocompletion-related)" (Dec  7,  5:03pm)
References: <20091207170336.c417efe1.einars@gmail.com>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: zsh-workers@zsh.org
Subject: Re: zsh deep freeze (probably autocompletion-related)
MIME-version: 1.0
Content-type: text/plain; charset=iso-8859-1
Content-transfer-encoding: quoted-printable

On Dec 7,  5:03pm, Einar Lielmanis wrote:
}
} Steps to reproduce:
}=20
} "rm ./\" [enter] [tab]
}=20
} zsh freezes hard and cannot be terminated; kill -9 ir required.

I get a crash rather than a freeze.

Program received signal SIGSEGV, Segmentation fault.
0x080bfe09 in chuck (str=3D0xb7d37000 "$\003\001 \020")
    at ../../zsh-4.0/Src/utils.c:1795
1795        while ((str[0] =3D str[1]))
(gdb) where
#0  0x080bfe09 in chuck (str=3D0xb7d37000 "$\003\001 \020")
    at ../../zsh-4.0/Src/utils.c:1795
#1  0x08131568 in get_comp_string ()
    at ../../../zsh-4.0/Src/Zle/zle_tricky.c:1259
#2  0x0812ff58 in docomplete (lst=3D0)
    at ../../../zsh-4.0/Src/Zle/zle_tricky.c:659
#3  0x0812f395 in completeword (args=3D0x816d01c)
    at ../../../zsh-4.0/Src/Zle/zle_tricky.c:232
#4  0x0812f2b9 in completecall (args=3D0x816d01c)
    at ../../../zsh-4.0/Src/Zle/zle_tricky.c:208
#5  0x08121bbc in execzlefunc (func=3D0x815b3f0, args=3D0x816d01c, set_bind=
k=3D0)
    at ../../../zsh-4.0/Src/Zle/zle_main.c:1312
#6  0x08121263 in zlecore () at ../../../zsh-4.0/Src/Zle/zle_main.c:1050
#7  0x08121817 in zleread (lp=3D0x816ddc8, rp=3D0x0, flags=3D3, context=3D1)
    at ../../../zsh-4.0/Src/Zle/zle_main.c:1213
#8  0x081235a8 in zle_main_entry (cmd=3D1, ap=3D0xbfeee6e4 "\221=E1C")
    at ../../../zsh-4.0/Src/Zle/zle_main.c:1866
#9  0x0807df9c in zleentry (cmd=3D1) at ../../zsh-4.0/Src/init.c:1305
#10 0x0807e7c7 in inputline () at ../../zsh-4.0/Src/input.c:278

(gdb) up
#1  0x08131568 in get_comp_string ()
    at ../../../zsh-4.0/Src/Zle/zle_tricky.c:1259
1259                    chuck(tt + zlemetacs - wb - qsub);
(gdb) p tt
$3 =3D 0xb7d33898 "./x"
(gdb) p zlemetacs
$4 =3D 7
(gdb) p wb
$5 =3D 3
(gdb) p qsub
$6 =3D 0

Looks like zlemetacs is too large.

