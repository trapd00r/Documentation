From zsh-workers-return-14036-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 19 15:55:24 2001
Return-Path: <zsh-workers-return-14036-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13110 invoked from network); 19 Apr 2001 15:55:23 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Apr 2001 15:55:23 -0000
Received: (qmail 11585 invoked by alias); 19 Apr 2001 15:55:16 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14036
Received: (qmail 11573 invoked from network); 19 Apr 2001 15:55:15 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
Date: Thu, 19 Apr 2001 19:55:12 +0400 (MSD)
From: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
X-X-Sender:  <bor@itsrm2.mow.siemens.ru>
To: <zsh-workers@sunsite.dk>
Subject: Re: PATCH: reduce unnecessary linking
In-Reply-To: <Pine.SV4.4.33.0104191848070.27005-100000@itsrm2.mow.siemens.ru>
Message-ID: <Pine.SV4.4.33.0104191951420.28844-100000@itsrm2.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 19 Apr 2001, Andrej Borsenkow wrote:

> >
> > -AC_CHECK_LIB(socket, socket)
> > +AC_CHECK_LIB(socket, socket, [LIBS_SOCKET="-lsocket"
> > +AC_DEFINE(HAVE_LIBSOCKET)])
> >
>
> No, that won't do. I (being on SVR4) need '-lsocket -lnsl' for any
> networking code (what our Solaris fellas say?) Moreover, I *do* need them
> both in *main* module and not in any DSO (else some funny effects may
> happen).
>

And actually on my system it is very hard (near to impossible) to link
shared module with (dynamic) library. Basically, in

cc -G -o foo.so ... -lbar

any -lbar is simply ignored. So, you cannot link zftp with -lsocket while
omitting -lsocket for main module.


> I really suggest that this patch should be hold off till 4.0.1 release. It
> is just too dangerous and can break too much.
>

And in any case - this optimisation should be used only for systems that
are known to support it.

-andrej

