From zsh-workers-return-21795-mason-zsh=primenet.com.au@sunsite.dk Sat Oct 01 20:28:48 2005
Return-Path: <zsh-workers-return-21795-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24 invoked from network); 1 Oct 2005 20:28:44 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Oct 2005 20:28:44 -0000
Received: (qmail 63177 invoked from network); 1 Oct 2005 20:28:38 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2005 20:28:38 -0000
Received: (qmail 7264 invoked by alias); 1 Oct 2005 20:28:36 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21795
Received: (qmail 7254 invoked from network); 1 Oct 2005 20:28:35 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 1 Oct 2005 20:28:35 -0000
Received: (qmail 62942 invoked from network); 1 Oct 2005 20:28:35 -0000
Received: from ns9.hostinglmi.net (213.194.149.146)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2005 20:28:33 -0000
Received: from 212.red-80-35-44.staticip.rima-tde.net ([80.35.44.212] helo=localhost)
	by ns9.hostinglmi.net with esmtpa (Exim 4.52)
	id 1ELnyF-0002sf-IY; Sat, 01 Oct 2005 22:28:35 +0200
Date: Sat, 1 Oct 2005 22:28:56 +0200
From: DervishD <zsh@dervishd.net>
To: Bart Schaefer <schaefer@brasslantern.com>
Cc: Peter Stephenson <pws@csr.com>, zsh-workers@sunsite.dk
Subject: Re: Exception handling and "trap" vs. TRAPNAL()
Message-ID: <20051001202856.GA134@DervishD>
Mail-Followup-To: Bart Schaefer <schaefer@brasslantern.com>,
	Peter Stephenson <pws@csr.com>, zsh-workers@sunsite.dk
References: <20050929200741.GA1156@DervishD> <20050930124130.45eb0463.pws@csr.com> <20051001153756.GA12183@DervishD> <1051001183818.ZM27904@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <1051001183818.ZM27904@candle.brasslantern.com>
User-Agent: Mutt/1.4.2.1i
Organization: DervishD
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - ns9.hostinglmi.net
X-AntiAbuse: Original Domain - sunsite.dk
X-AntiAbuse: Originator/Caller UID/GID - [0 0] / [47 12]
X-AntiAbuse: Sender Address Domain - dervishd.net
X-Source: 
X-Source-Args: 
X-Source-Dir: 
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

    Hi Bart :)

 * Bart Schaefer <schaefer@brasslantern.com> dixit:
> On Oct 1,  5:37pm, DervishD wrote:
> } Subject: Re: Exception handling and "trap" vs. TRAPNAL()
> }
> }     Hi Peter :)
> }  * Peter Stephenson <pws@csr.com> dixit:
> } > Add some "print"s to the trap to see when it's triggering.
> } 
> }     The trap is triggering just in the "false" statement, and the
> } TRAPZERR works perfectly, it's the "trap" kind which is failing.
> I ran this with "set -x" (much better than inserting print statements)

    I did exactly the same, and the "trap" didn't caused the always
block to run but the TRAPZERR bit did.

> } Can I do anything to make it work (except patching zsh)?
> I don't think so.

    Well, then I'll use explicit throw commands instead of ZERR. The
code will be a bit messier but I'll try to use TRAPZERR whenever
possible until the ¿bug? is fixed. I am still not sure whether this
is a bug or a feature:

    trap 'false' DEBUG

    true
    [[ $? -eq 1 ]] && print "What?"

    This snippet doesn't print anything, and won't do even if using
TRAPDEBUG and "return 1" instead of "false". So ignoring errors from
inline traps make those traps and the TRAPNAL ones semantically
identical (TRAPNAL is a function, but its return value seems to be
ignored). Apart from this, I cannot think of a reason :?

    Raúl Núñez de Arenas Coronado

-- 
Linux Registered User 88736 | http://www.dervishd.net
http://www.pleyades.net & http://www.gotesdelluna.net
It's my PC and I'll cry if I want to...

