From wayne@clari.net Tue Jul 16 03:04:15 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id DAA00755 for <mason@werple.mira.net.au>; Tue, 16 Jul 1996 03:04:12 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id MAA17284; Mon, 15 Jul 1996 12:52:14 -0400 (EDT)
Resent-Date: Mon, 15 Jul 1996 12:52:14 -0400 (EDT)
Message-Id: <199607151650.JAA03012@bebop.clari.net>
To: zsh-workers@math.gatech.edu
Subject: patch for no rlimit
Date: Mon, 15 Jul 1996 09:50:55 -0700
From: Wayne Davison <wayne@clari.net>
Resent-Message-ID: <"S4UjX1.0._D4.-Sdwn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1656
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 813
Status: OR

I finally recompiled zsh on an old SCO system (which I don't use that much)
and had to #ifdef a call to setlimits() to get it to compile.  I also put
an #ifdef around an unused variable in init.c to remove a warning.

..wayne..
---8<------8<------8<------8<---cut here--->8------>8------>8------>8---
Index: exec.c
@@ -1686,8 +1686,10 @@
 	    }
 	    if (type == SIMPLE) {
 		closem(1);
+#ifdef HAVE_GETRLIMIT
 		if (!forked)
 		    setlimits(NULL);
+#endif
 		execute((Cmdnam) hn, cflags & BINF_DASH);
 	    } else {		/* ( ... ) */
 		list_pipe = 0;
Index: init.c
@@ -466,7 +466,9 @@
     struct passwd *pswd;
     struct timezone dummy_tz;
     char *ptr;
+#ifdef HAVE_GETRLIMIT
     int i;
+#endif
 
     noeval = 0;
     curhist = 0;
---8<------8<------8<------8<---cut here--->8------>8------>8------>8---


