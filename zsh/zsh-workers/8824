From zsh-workers-return-8824-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Nov 30 15:46:50 1999
Return-Path: <zsh-workers-return-8824-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3328 invoked from network); 30 Nov 1999 15:46:49 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Nov 1999 15:46:49 -0000
Received: (qmail 26021 invoked by alias); 30 Nov 1999 15:46:23 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8824
Received: (qmail 26006 invoked from network); 30 Nov 1999 15:46:23 -0000
Date: Tue, 30 Nov 1999 10:46:21 -0500
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: partial program transform support
Message-ID: <19991130104621.C28014@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0i

Well, I'm talking too much.  This puts some use to the AC_ARG_PROGRAM
already in configure.in.

I actually wanted to do this for the info files, but that would involve
making .yo.in files and replacing what now says "zsh.info" and so on,
so I thought I'd start with the simple stuff and give people a
chance to be horrified.

--- Src/Makefile.in     1999/11/19 09:26:30     1.1.1.14
+++ Src/Makefile.in     1999/11/30 15:35:20
@@ -42,6 +42,9 @@
 sdir_src      = $(sdir)
 dir_src       = .
 
+transform=@program_transform_name@
+tzsh=`echo zsh | sed '$(transform)'`
+
 # ========= DEPENDENCIES FOR BUILDING ==========
 
 LINK        = $(CC) $(LDFLAGS) $(EXELDFLAGS) $(EXTRA_LDFLAGS) -o $@
@@ -159,14 +162,14 @@
 # install binary, creating install directory if necessary
 install.bin-here: zsh install.bin-@L@
        $(sdir_top)/mkinstalldirs $(DESTDIR)$(bindir)
-       $(INSTALL_PROGRAM) $(STRIPFLAGS) zsh $(DESTDIR)$(bindir)/zsh-$(VERSION)
-       if test -f $(DESTDIR)$(bindir)/zsh; then \
-           rm -f $(DESTDIR)$(bindir)/zsh.old; \
-           $(LN) $(DESTDIR)$(bindir)/zsh $(DESTDIR)$(bindir)/zsh.old; \
+       $(INSTALL_PROGRAM) $(STRIPFLAGS) zsh $(DESTDIR)$(bindir)/$(tzsh)-$(VERSION)
+       if test -f $(DESTDIR)$(bindir)/$(tzsh); then \
+           rm -f $(DESTDIR)$(bindir)/$(tzsh).old; \
+           $(LN) $(DESTDIR)$(bindir)/$(tzsh) $(DESTDIR)$(bindir)/$(tzsh).old; \
        else :; fi
-       rm -f $(DESTDIR)$(bindir)/zsh.new
-       $(LN) $(DESTDIR)$(bindir)/zsh-$(VERSION) $(DESTDIR)$(bindir)/zsh.new
-       mv $(DESTDIR)$(bindir)/zsh.new $(DESTDIR)$(bindir)/zsh
+       rm -f $(DESTDIR)$(bindir)/$(tzsh).new
+       $(LN) $(DESTDIR)$(bindir)/$(tzsh)-$(VERSION) $(DESTDIR)$(bindir)/$(tzsh).new
+       mv $(DESTDIR)$(bindir)/$(tzsh).new $(DESTDIR)$(bindir)/$(tzsh)
 
 install.bin-N:
 install.bin-L: $(LIBZSH)
@@ -175,7 +178,7 @@
 
 # uninstall binary
 uninstall.bin-here: uninstall.bin-@L@
-       rm -f $(DESTDIR)$(bindir)/zsh-$(VERSION) $(DESTDIR)$(bindir)/zsh
+       rm -f $(DESTDIR)$(bindir)/$(tzsh)-$(VERSION) $(DESTDIR)$(bindir)/$(tzsh)
 
 uninstall.bin-N:
 uninstall.bin-L:

