From zsh-workers-return-12949-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Oct 10 15:48:54 2000
Return-Path: <zsh-workers-return-12949-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1127 invoked from network); 10 Oct 2000 15:48:53 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 10 Oct 2000 15:48:53 -0000
Received: (qmail 11971 invoked by alias); 10 Oct 2000 15:47:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12949
Received: (qmail 11963 invoked from network); 10 Oct 2000 15:47:46 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1001010154740.ZM28763@candle.brasslantern.com>
Date: Tue, 10 Oct 2000 15:47:39 +0000
In-Reply-To: <200010101504.RAA25484@beta.informatik.hu-berlin.de>
Comments: In reply to Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
        "Re: Global-alias problem with _expand" (Oct 10,  5:04pm)
References: <200010101504.RAA25484@beta.informatik.hu-berlin.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: Global-alias problem with _expand
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Oct 10,  5:04pm, Sven Wischnowsky wrote:
} 
} Bart Schaefer wrote:
} 
} > By redirecting stderr on the eval?
} 
} Sigh.

I've been wondering whether _main_complete shouldn't do something like

[[ -t 2 ]] && exec 2>/dev/null

The problem of course is that there's no way to guarantee that the FD is
restored properly when the function exits.  ZLE itself closes and then
later restores stdin, so the `exec </dev/null' is safe, but anything that
triggers a zerr() can potentially prevent the function from restoring any
other FDs.

Maybe we've finally got a good enough handle on the zerr/zwarn thing that
we don't need to worry about this ... but I do anyway.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

