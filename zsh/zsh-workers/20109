From zsh-workers-return-20109-mason-zsh=primenet.com.au@sunsite.dk Sun Jun 27 17:38:31 2004
Return-Path: <zsh-workers-return-20109-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26545 invoked from network); 27 Jun 2004 17:38:30 -0000
Received: from odin.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.85)
  by ns1.primenet.com.au with SMTP; 27 Jun 2004 17:38:30 -0000
Received: (qmail 29815 invoked from network); 27 Jun 2004 18:47:47 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Jun 2004 18:47:47 -0000
Received: (qmail 6721 invoked by alias); 27 Jun 2004 17:38:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20109
Received: (qmail 6711 invoked from network); 27 Jun 2004 17:38:14 -0000
Received: from odin.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.85)
  by sunsite.dk with SMTP; 27 Jun 2004 17:38:14 -0000
Received: (qmail 29578 invoked from network); 27 Jun 2004 18:47:38 -0000
Received: from cmailm2.svr.pol.co.uk (195.92.193.210)
  by a.mx.sunsite.dk with SMTP; 27 Jun 2004 18:47:37 -0000
Received: from modem-123.blue-mandarin.dialup.pol.co.uk ([62.136.237.123] helo=pwstephenson.fsnet.co.uk)
	by cmailm2.svr.pol.co.uk with esmtp (Exim 4.14)
	id 1BedbW-0008T1-HR; Sun, 27 Jun 2004 18:38:11 +0100
Received: by pwstephenson.fsnet.co.uk (Postfix, from userid 501)
	id 94612865D; Sun, 27 Jun 2004 13:45:50 -0400 (EDT)
Received: from pwstephenson.fsnet.co.uk (localhost [127.0.0.1])
	by pwstephenson.fsnet.co.uk (Postfix) with ESMTP
	id 77C23865B; Sun, 27 Jun 2004 18:45:50 +0100 (BST)
To: zsh-workers@sunsite.dk
Cc: 255788-forwarded@bugs.debian.org
Subject: Re: Bug#255788: $'' does not work after <<< 
In-reply-to: "Bart Schaefer"'s message of "Sun, 27 Jun 2004 10:04:45 PDT."
             <Pine.LNX.4.60.0406270942350.19831@toltec.zanshin.com> 
Date: Sun, 27 Jun 2004 18:45:49 +0100
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <20040627174550.94612865D@pwstephenson.fsnet.co.uk>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=BAYES_50,RCVD_IN_SORBS 
	autolearn=no version=2.63
X-Spam-Hits: 1.5

Bart Schaefer wrote:
> > I guess the print-like behaviour of $'...'  is the only thing we do
> > want, right?
> 
> That's apparently how bash has implemented it.  Strictly speaking, I think 
> zsh had the here-string feature first so we're now modifying the zsh 
> feature to match an extension to it that was made by bash, but it seems 
> like a reasonable extension.

But this bit is about here documents, not here strings...

> > '...' has no special effect, and "..." does $-style and
> > `-style expansions which we don't want.
> 
> Now you're talking about the contents of the here-document, rather than
> the value of the end markers?

... and I was talking about the end marker: it seemed to be the
conclusion of what you were saying that in:

cat <<$foo
...
cat <<$'a\tb'
...
cat <<"$(echo hello)"

the \t in the middle case was exanded, but the $ in the other two
weren't.  I haven't even thought about changing anything to do with the
contents.

> > Hmm, we also need to decide whether this applies to here strings.  My 
> > view would be that they get the full expansion treatment, since they are 
> > essentially a command argument, not a glorified end marker.  But I'm 
> > sure you'll let me know if I'm wrong.
> 
> I agree with you with one caveat - consider this from bash:
> 
> [schaefer]$ string="a word with    spaces in it"
> [schaefer]$ cat <<< $string
> a word with spaces in it
> [schaefer]$ 
> 
> I'd have expected "the full expansion treatment" to mean (in bash) that 
> the value of $bar was word-split on spaces, producing "<<< a" and "word" 
> etc. ... but in the case of a here-string, it gets taken as part of the 
> redirection expression, then split, and then pasted back together again 
> (which is even odder, from bash).  So I'm not sure exactly what parse bash 
> is applying to here-strings.

I don't think that's our problem.  We consistently use singsub() for
cases like this and I can't see why we shouldn't here.

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Work: pws@csr.com
Web: http://www.pwstephenson.fsnet.co.uk

