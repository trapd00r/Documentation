From zsh-workers-return-22219-mason-zsh=primenet.com.au@sunsite.dk Sat Feb 11 11:05:39 2006
Return-Path: <zsh-workers-return-22219-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9279 invoked from network); 11 Feb 2006 11:05:35 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Feb 2006 11:05:35 -0000
Received: (qmail 19151 invoked from network); 11 Feb 2006 11:05:29 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Feb 2006 11:05:29 -0000
Received: (qmail 8304 invoked by alias); 11 Feb 2006 11:05:26 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22219
Received: (qmail 8293 invoked from network); 11 Feb 2006 11:05:25 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 11 Feb 2006 11:05:25 -0000
Received: (qmail 18912 invoked from network); 11 Feb 2006 11:05:25 -0000
Received: from ns9.hostinglmi.net (213.194.149.146)
  by a.mx.sunsite.dk with SMTP; 11 Feb 2006 11:05:24 -0000
Received: from 212.red-80-35-44.staticip.rima-tde.net ([80.35.44.212]:35705 helo=localhost)
	by ns9.hostinglmi.net with esmtpa (Exim 4.52)
	id 1F7sZC-0003ng-LD; Sat, 11 Feb 2006 12:05:26 +0100
Date: Sat, 11 Feb 2006 12:06:30 +0100
From: DervishD <zsh@dervishd.net>
To: Andrey Borzenkov <arvidjaar@newmail.ru>
Cc: Zsh-workers <zsh-workers@sunsite.dk>
Subject: Re: [SOLVED] Libtool/zsh quoting problem: a zsh... bug?
Message-ID: <20060211110630.GA13442@DervishD>
Mail-Followup-To: Andrey Borzenkov <arvidjaar@newmail.ru>,
	Zsh-workers <zsh-workers@sunsite.dk>
References: <20060209233201.GA5875@fargo> <20060211093607.GD10579@DervishD> <200602111321.48602.arvidjaar@newmail.ru>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <200602111321.48602.arvidjaar@newmail.ru>
User-Agent: Mutt/1.4.2.1i
Organization: DervishD
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - ns9.hostinglmi.net
X-AntiAbuse: Original Domain - sunsite.dk
X-AntiAbuse: Originator/Caller UID/GID - [0 0] / [47 12]
X-AntiAbuse: Sender Address Domain - dervishd.net
X-Source: 
X-Source-Args: 
X-Source-Dir: 

    Hi Andrey :)

 * Andrey Borzenkov <arvidjaar@newmail.ru> dixit:
> On Saturday 11 February 2006 12:36, DervishD wrote:
> >
> >     The problem is that zsh does word splitting in this construct:
> >
> >     ${1+"$@"}
> >
> 
> See this thread:
> <http://www.zsh.org/mla/workers/2002/msg00542.html>; there was an
> attempt to fix it in 16949 but apparently it was incomplete and
> never went in.

    Thanks for the information, Alexey :)))
 
> >     I don't know if this can be considered a zsh bug or not. The SUS
> > standard says that field splitting is done after parameter expansion,
> > so I think it should be done on the above expansion. Unfortunately,
> > Bash doesn't seem to do it.
> 
> bash is right and zsh is not.

    Could you please point me to where the standard says that the
splitting shouldn't be done after that particular expansion? I've
been searching with no success :((( The only thing I've found is that
when a parameter expansion occurs in double quotes, field splitting
shall not be done in the result, except for "@".

    The problem is that libtool doesn't use "${1+... but just $1+...,
without quotes, so the splitting *should* be done. That's why I think
bash is wrong here and zsh is right.

    Anyway, if the people at autoconf used the "alias -g" solution,
libtool people could, too...

> >     I'm thinking about submitting a patch to the libtool people, with
> > something like this:
> >
> >     alias -g '${1+"$@"}'='"$@"'
> >
> The funny part of it is that autoconf includes exactly the above
> workaround since quoted thread; this is also documented in autoconf
> info.

    Oops O:))) The funny part here is that I've studied autoconf code
(and of course its documentation) and I've completely missed this...
I spent almost three hours trying to catch the bug :((((

> >     I know, that's a dirty hack, but I cannot think about any other
> > fix (except "fixing" zsh itself, although I'm not sure this is a
> > bug).
> >
> >     Any suggestion???
> 
> Fix a bug in zsh :)

    Easy to say, difficult to do XD I'm not familiar with the code
and if I try to fix this I'm sure I'm going to break a lot of things,
unfortunately :((((

    Thanks for your help, Alexey :))))

    Raúl Núñez de Arenas Coronado

-- 
Linux Registered User 88736 | http://www.dervishd.net
http://www.pleyades.net & http://www.gotesdelluna.net
It's my PC and I'll cry if I want to... RAmen!

