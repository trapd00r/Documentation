From zsh-workers-return-12768-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Sep 07 08:38:21 2000
Return-Path: <zsh-workers-return-12768-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17972 invoked from network); 7 Sep 2000 08:38:19 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Sep 2000 08:38:19 -0000
Received: (qmail 19028 invoked by alias); 7 Sep 2000 08:38:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12768
Received: (qmail 19021 invoked from network); 7 Sep 2000 08:38:03 -0000
Date: Thu, 7 Sep 2000 10:38:00 +0200 (MET DST)
Message-Id: <200009070838.KAA01743@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Wed, 6 Sep 2000 19:15:56 +0400
Subject: PATCH: RE: Trivial patches for FreeBSD


Andrej Borsenkow wrote:

> > -  compadd "$@" - /modules/*.ko(:t) && ret=0
> > +  compadd "$@" - /boot/kernel/*.ko(:t) /modules/*.ko(:t) && ret=0
> 
> Should not this be
> 
> compadd "$@" - /boot/kernel/*.ko(N:t) /modules/*.ko(N:t) && ret=0
> 
> ??

That sounds reasonable. I've changed in some other places, too (anyone 
who uses _mailboxes please check my work there).

Bye
 Sven

Index: Completion/Bsd/_bsd_pkg
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Bsd/_bsd_pkg,v
retrieving revision 1.3
diff -u -r1.3 _bsd_pkg
--- Completion/Bsd/_bsd_pkg	2000/08/01 08:26:40	1.3
+++ Completion/Bsd/_bsd_pkg	2000/09/07 08:37:32
@@ -7,7 +7,7 @@
   paths=( "${(@)${(@s.:.)PKG_PATH}:#}" )
   _files "$@" -g \*.tgz && ret=0
   (( $#path )) && _files "$@" -W paths -g \*.tgz && ret=0
-  compadd "$@" - /usr/ports/packages/All/*.tgz && ret=0
+  compadd "$@" - /usr/ports/packages/All/*.tgz(N) && ret=0
 
   return ret
 }
@@ -37,7 +37,7 @@
 	'-d[remove empty directories]' \
 	'-f[force deinstallation]' \
         '-p:prefix directory:_files -/' \
-        '*:package to deinstall:compadd - /var/db/pkg/*(\:t)'
+        '*:package to deinstall:compadd - /var/db/pkg/*(N\:t)'
     ;;
 
   pkg_info)
@@ -57,10 +57,10 @@
 	'-R[show list list of installed requiring packages]' \
 	'-m[show mtree files]' \
 	'-L[show full pathnames of files]' \
-        '-e[test if package is installed]:package name:compadd - /var/db/pkg/*(\:t)' \
+        '-e[test if package is installed]:package name:compadd - /var/db/pkg/*(N\:t)' \
         '-l:prefix directory:_files -/' \
         '-t:mktemp template:_files -/' \
-        '(-a)*:package name:compadd - /var/db/pkg/*(\:t)'
+        '(-a)*:package name:compadd - /var/db/pkg/*(N\:t)'
     ;;
   esac
 }
Index: Completion/Bsd/_kld
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Bsd/_kld,v
retrieving revision 1.3
diff -u -r1.3 _kld
--- Completion/Bsd/_kld	2000/09/06 15:15:32	1.3
+++ Completion/Bsd/_kld	2000/09/07 08:37:32
@@ -4,7 +4,7 @@
 _kld_module() {
   local ret=1
 
-  compadd "$@" - /boot/kernel/*.ko(:t) /modules/*.ko(:t) && ret=0
+  compadd "$@" - /boot/kernel/*.ko(N:t) /modules/*.ko(N:t) && ret=0
   _files "$@" -g \*.ko && ret=0
 
   return ret
Index: Completion/User/_gcc
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/User/_gcc,v
retrieving revision 1.1.1.5
diff -u -r1.1.1.5 _gcc
--- Completion/User/_gcc	2000/03/23 04:19:29	1.1.1.5
+++ Completion/User/_gcc	2000/09/07 08:37:32
@@ -274,7 +274,7 @@
   ;;
 library)
   _wanted libraries expl library \
-      compadd - ${^=LD_LIBRARY_PATH:-/usr/lib /usr/local/lib}/lib*.(a|so*)(:t:fr:s/lib//) && ret=0
+      compadd - ${^=LD_LIBRARY_PATH:-/usr/lib /usr/local/lib}/lib*.(a|so*)(N:t:fr:s/lib//) && ret=0
   ;;
 esac
 
Index: Completion/User/_gdb
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/User/_gdb,v
retrieving revision 1.4
diff -u -r1.4 _gdb
--- Completion/User/_gdb	2000/04/11 07:57:57	1.4
+++ Completion/User/_gdb	2000/09/07 08:37:32
@@ -4,13 +4,13 @@
 
 [[ "$PREFIX" = --* ]] &&
     _arguments -- '*=(CORE|SYM)FILE:core file:_files' \
-		  '*=EXECFILE:executable:_files \*\(-\*\)' \
-		  '*=TTY:terminal device:compadd /dev/tty\*' && return 0
+		  '*=EXECFILE:executable:_files -g \*\(-\*\)' \
+		  '*=TTY:terminal device:compadd /dev/tty\*\(N\)' && return 0
 
 if compset -P '-(cd|directory)='; then
   _files -/
 elif compset -P '-tty='; then
-  _wanted devices expl 'terminal device' compadd - /dev/tty*
+  _wanted devices expl 'terminal device' compadd - /dev/tty*(N)
 elif compset -P '-(exec|se)='; then
   _description files expl executable
   _files "$expl[@]" -g '*(-*)'
Index: Completion/User/_mailboxes
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/User/_mailboxes,v
retrieving revision 1.5
diff -u -r1.5 _mailboxes
--- Completion/User/_mailboxes	2000/08/01 08:27:18	1.5
+++ Completion/User/_mailboxes	2000/09/07 08:37:32
@@ -74,10 +74,10 @@
     _mutt_cache=( ${=${(M)${(f)"$(<${~muttrc})"}:#mailboxes *}#mailboxes *} )
 
 
-  _mbox_cache=( ${~maildirectory}/*(^/) )
-  _pine_cache=( ${~pinedirectory}/**/*(.) )
+  _mbox_cache=( ${~maildirectory}/*(N^/) )
+  _pine_cache=( ${~pinedirectory}/**/*(N.) )
 
-  dirboxes=( ${~maildirectory}/*(/) )
+  dirboxes=( ${~maildirectory}/*(N/) )
 
   while (( $#dirboxes )); do
     i=${dirboxes[1]}
@@ -87,7 +87,7 @@
     elif j=( "$i"/<1-> ) && [[ -n "$j" ]]; then
       _mh_cache=( "${_mh_cache[@]}" "$i" )
     else
-      _mbox_cache=( "${_mbox_cache[@]}" "$i"/*(.) )
+      _mbox_cache=( "${_mbox_cache[@]}" "$i"/*(N.) )
       dirboxes=( $dirboxes "$i"/*(/) )
     fi
   done
Index: Completion/User/_zdump
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/User/_zdump,v
retrieving revision 1.1.1.2
diff -u -r1.1.1.2 _zdump
--- Completion/User/_zdump	2000/03/24 00:01:58	1.1.1.2
+++ Completion/User/_zdump	2000/09/07 08:37:32
@@ -1,7 +1,7 @@
 #compdef zdump
 
 if (( ! $+_zoneinfo_dirs )); then
-  _zoneinfo_dirs=(/usr/share/zoneinfo*(/) /usr/lib/zoneinfo*(/) /usr/share/lib/zoneinfo*(/))
+  _zoneinfo_dirs=( /usr/{share,lib,share/lib}/zoneinfo*(N/) )
 fi
 
 _arguments '-v[lowest possible]' \

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

