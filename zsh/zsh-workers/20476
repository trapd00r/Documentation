From zsh-workers-return-20476-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 13 05:40:39 2004
Return-Path: <zsh-workers-return-20476-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12735 invoked from network); 13 Oct 2004 05:40:38 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Oct 2004 05:40:38 -0000
Received: (qmail 79753 invoked from network); 13 Oct 2004 05:40:33 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2004 05:40:33 -0000
Received: (qmail 22560 invoked by alias); 13 Oct 2004 05:40:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20476
Received: (qmail 22546 invoked from network); 13 Oct 2004 05:40:18 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 13 Oct 2004 05:40:18 -0000
Received: (qmail 79377 invoked from network); 13 Oct 2004 05:40:18 -0000
Received: from dsl3-63-249-88-2.cruzio.com (HELO binome.blorf.net) (63.249.88.2)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2004 05:40:17 -0000
Received: by binome.blorf.net (Postfix, from userid 1000)
	id BCE6D7031; Tue, 12 Oct 2004 22:40:15 -0700 (PDT)
Date: Tue, 12 Oct 2004 22:40:15 -0700
From: Wayne Davison <wayned@users.sourceforge.net>
To: zsh-workers@sunsite.dk
Subject: characters not added in _rsync completion
Message-ID: <20041013054015.GA824@blorf.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.6+20040722i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

I've noticed something strange in the _rsync completion in 4.2.1 (I
tested both the debian packaged version of 4.2.1 and the latest CVS):
zsh sometimes fails to add all the common characters that it should
when completing an ambiguous option.  For example:

zsh -f
autoload -U compinit
compinit
rsync --bl<TAB>

The characters "ock" should be added (since the "--block" prefix is
common to both the listed completions), but nothing is added (the user
must either type more characters to remove the ambiguity, or cycle
through the matches with more TAB presses).

Other completions that fail to add common characters:

rsync --ch<TAB>    # should add "ecksum"
rsync --com<TAB>   # should add "p"
rsync --li<TAB>    # should add "nk"
rsync --no<TAB>    # should add "-"
rsync --par<TAB>   # should add "tial"
rsync --ti<TAB>    # should add "me"

(Note that two of those require a very recent rsync that has the
--checksum-seed and --partial-dir options, otherwise there would
be only one option to complete.)

However, most other options behave in the expected manner:

rsync --ba<TAB>    # adds "ckup"
rsync --del<TAB>   # adds "ete"
rsync --exc<TAB>   # adds "lude"
rsync --ig<TAB>    # adds "nore-"
rsync --inc<TAB>   # adds "lude"
rsync --v<TAB>     # adds "er"

Would anyone care to look into this?

..wayne..

