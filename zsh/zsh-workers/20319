From zsh-workers-return-20319-mason-zsh=primenet.com.au@sunsite.dk Sun Sep 05 17:34:26 2004
Return-Path: <zsh-workers-return-20319-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24648 invoked from network); 5 Sep 2004 17:34:25 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 5 Sep 2004 17:34:25 -0000
Received: (qmail 74509 invoked from network); 5 Sep 2004 17:34:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 Sep 2004 17:34:17 -0000
Received: (qmail 20621 invoked by alias); 5 Sep 2004 17:34:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20319
Received: (qmail 20607 invoked from network); 5 Sep 2004 17:34:03 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 Sep 2004 17:34:03 -0000
Received: (qmail 73591 invoked from network); 5 Sep 2004 17:33:04 -0000
Received: from cmailm3.svr.pol.co.uk (195.92.193.19)
  by a.mx.sunsite.dk with SMTP; 5 Sep 2004 17:33:02 -0000
Received: from modem-144.keyhole-angel.dialup.pol.co.uk ([62.137.34.144] helo=pwstephenson.fsnet.co.uk)
	by cmailm3.svr.pol.co.uk with esmtp (Exim 4.14)
	id 1C40sv-0007wL-4V
	for zsh-workers@sunsite.dk; Sun, 05 Sep 2004 18:33:01 +0100
Received: by pwstephenson.fsnet.co.uk (Postfix, from userid 501)
	id A29CB8634; Sun,  5 Sep 2004 13:36:28 -0400 (EDT)
Received: from pwstephenson.fsnet.co.uk (localhost [127.0.0.1])
	by pwstephenson.fsnet.co.uk (Postfix) with ESMTP id 8156B85AF
	for <zsh-workers@sunsite.dk>; Sun,  5 Sep 2004 18:36:28 +0100 (BST)
To: zsh-workers@sunsite.dk
Subject: Re: Test Failures from latest CVS 
In-reply-to: "Bart Schaefer"'s message of "Sat, 04 Sep 2004 09:38:26 PDT."
             <Pine.LNX.4.61.0409040927360.1742@toltec.zanshin.com> 
Date: Sun, 05 Sep 2004 18:36:27 +0100
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <20040905173628.A29CB8634@pwstephenson.fsnet.co.uk>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 1.5

Bart Schaefer wrote:
> The scriptname has to be changed before the string to be eval'd is parsed. 
> Peter tried (or so I presume) to fix a long-standing bug that scriptname 
> would not be restored properly on a parse error, by delaying the change 
> rather than by explicitly restoring; but also neglected to restore ineval 
> to its previous state in the same circumstance.

Thanks, that looks better.

> (Is there a reason not to 
> assign lastval in that case also?  It could simplify the code structure.)

I don't think there's a reason *not* to; it's just not necessary because
in any case on return from bin_eval it gets set to the 1 we just
returned.

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Work: pws@csr.com
Web: http://www.pwstephenson.fsnet.co.uk

