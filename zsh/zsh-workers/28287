From zsh-workers-return-28287-mason-zsh=primenet.com.au@zsh.org Fri Sep 24 04:44:19 2010
Return-Path: <zsh-workers-return-28287-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14957 invoked by alias); 24 Sep 2010 04:44:19 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28287
Received: (qmail 26218 invoked from network); 24 Sep 2010 04:44:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at benizi.com designates 64.130.10.15 as permitted sender)
Date: Fri, 24 Sep 2010 00:43:50 -0400 (EDT)
From: "Benjamin R. Haskell" <zsh@benizi.com>
To: Zsh Workers <zsh-workers@zsh.org>
Subject: Re: !!$ unitialized at first prompt
In-Reply-To: <alpine.LNX.2.01.1009232317460.4754@hp>
Message-ID: <alpine.LNX.2.01.1009240037470.4754@hp>
References: <alpine.LNX.2.01.1009232317460.4754@hp>
User-Agent: Alpine 2.01 (LNX 1266 2009-07-14)
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed

On Fri, 24 Sep 2010, Benjamin R. Haskell wrote:

> # but it also doesn't expand to the correct value:
> # (without an intervening command)
> second-shell$ echo x!{$}y
> quote><ctrl-c>
> echo xb'y
>

The words are definitely split wrong.  Not just '$':

first-shell$ echo 'a b' 'c d'
a b c d
first-shell$ <ctrl-d>

second-shell$ !!0-2
echo 'a b'
a b

> [...]
> Reproducible with HISTFILE=/tmp/testhist ZDOTDIR=/nonexistent zsh -f.
                                                                     ^^
('-f' should be '-d' -- took me a while to figure out why -f was 
preventing history from being saved -- finally found the mention in the 
manual.)

-- 
Best,
Ben

