From zsh-workers-return-28709-mason-zsh=primenet.com.au@zsh.org Sat Feb 05 17:46:45 2011
Return-Path: <zsh-workers-return-28709-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29726 invoked by alias); 5 Feb 2011 17:46:45 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28709
Received: (qmail 27965 invoked from network); 5 Feb 2011 17:46:34 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_NONE
	autolearn=ham version=3.3.1
Received-SPF: none (ns1.primenet.com.au: domain at closedmail.com does not designate permitted sender hosts)
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <110205094611.ZM26274@torch.brasslantern.com>
Date: Sat, 05 Feb 2011 09:46:11 -0800
In-reply-to: <AANLkTindKuTD9-AEmxX0Q_CKAykVNO04HMmA26Pq7q0J@mail.gmail.com>
Comments: In reply to cheer_xiao <xiaqqaix@gmail.com>
 "Re: Slow completion when using aptitude" (Feb  5,  5:30pm)
References: <AANLkTimtzJnpA=_QQgz4bSYZEjHydCSh6PLMKzFtwueS@mail.gmail.com>
	<AANLkTimYBY7nA_FCXTA8n-ukYwBxnobmoUNowJ6kxaGz@mail.gmail.com>
	<AANLkTikAKmnTt+9o5ibUGevk+m=rZJg9WrxV1WP+hX6w@mail.gmail.com>
	<AANLkTinYiKLp11GTOKaMb_8BTPKvjP+U6won9V4BFHxk@mail.gmail.com>
	<87oc74dpuy.fsf@ft.bewatermyfriend.org>
	<AANLkTimKPLUHcHj_aZciwNLDt_+noEW0G=PEdYSVEL9b@mail.gmail.com>
	<87d3njemu9.fsf@ft.bewatermyfriend.org>
	<110126090508.ZM2111@torch.brasslantern.com>
	<110126092944.ZM2205@torch.brasslantern.com>
	<AANLkTinQW1fYGBhX4u8NFniFYN6y6FPr-wgaDHbF8U1j@mail.gmail.com>
	<110129211610.ZM21714@torch.brasslantern.com>
	<AANLkTimKbEbEjzW07wwqmFzV67EZQx5ngdY0vhZjzks2@mail.gmail.com>
	<110129231514.ZM21967@torch.brasslantern.com>
	<AANLkTimEpSx5H5WUWN1RtmJYG1C0wqNKUFM=vTV5N_7U@mail.gmail.com>
	<AANLkTi=PxzNVGxac5v64UZ4Sa_JwFXAdhxnxrpx_3gtw@mail.gmail.com>
	<110130160220.ZM15815@torch.brasslantern.com>
	<AANLkTi=QAqQxr5dj0mokCgt5Vs=Bm4Eec+E8+AicHrrJ@mail.gmail.com>
	<110203065608.ZM21224@torch.brasslantern.com>
	<AANLkTinfzf6gM5Z83_+iQqkc+QVzGGKa3yqbPTa+Wm3A@mail.gmail.com>
	<110203193315.ZM22047@torch.brasslantern.com>
	<AANLkTim5C-WAJE61ba58NQm5Ny+-U2RUFuK3FoKDNYUA@mail.gmail.com>
	<AANLkTi=dC-3NUrqAy2Zzq9Ode+QhpvhSB+MYMBqpHqs=@mail.gmail.com>
	<AANLkTiknoa94izacxEZjjnvma+oPaKO5LPiw_LSks0Mw@mail.gmail.com>
	<110203202907.ZM22434@torch.brasslantern.com>
	<110204070416.ZM23211@torch.brasslantern.com>
	<AANLkTindKuTD9-AEmxX0Q_CKAykVNO04HMmA26Pq7q0J@mail.gmail.com>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: zsh-workers@zsh.org
Subject: Re: Slow completion when using aptitude
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii

On Feb 5,  5:30pm, cheer_xiao wrote:
}
} Well, the fix is here, simpler than I thought. You missed a line here:
}  cachevar=_deb_packages_cache_uninstalled

Yeah, as soon as you said the package list hadn't changed when the
_dep -> _deb typo got fixed, I realized I'd failed to copy that
assignment from the original function.

} On the other hand, I think the performance can be further improved. A
} delay of 1s is good enough for me but not good enough for some.

There are a whole slew of completion functions that take 1s or more, so
if there are people who are unhappy with this one, they're going to be
unhappy in general.  My response would be, consider how long it would
take to get the same information if you didn't have the completion.

Also the second and subsequent times you use it in the same shell, it
should be as fast as it's theoretically possible for it to be without a
C-code level optimization deeper in compsys, because the arrays will
all have been populated already.

