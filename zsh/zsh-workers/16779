From zsh-workers-return-16779-mason-zsh=primenet.com.au@sunsite.dk Thu Mar 07 13:57:07 2002
Return-Path: <zsh-workers-return-16779-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10662 invoked from network); 7 Mar 2002 13:57:06 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 7 Mar 2002 13:57:06 -0000
Received: (qmail 10041 invoked by alias); 7 Mar 2002 13:56:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16779
Received: (qmail 10029 invoked from network); 7 Mar 2002 13:56:58 -0000
Date: Thu, 7 Mar 2002 13:55:56 +0000
From: Adam Spiers <adam@spiers.net>
To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Subject: PATCH: _mysqldiff
Message-ID: <20020307135556.C30741@corelli.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
X-URL: http://tigerpig.org/
X-OS: RedHat Linux
Sender: "Adam Spiers,,07775562717,020 88 30 30 35" <adam@corelli.new.ox.ac.uk>

This adds completion for my mysqldiff utility (see
<http://adamspiers.org/computing/mysqldiff/>).

Index: Completion/Unix/Command/.distfiles
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/.distfiles,v
retrieving revision 1.20
diff -u -r1.20 .distfiles
--- Completion/Unix/Command/.distfiles	7 Mar 2002 13:36:38 -0000	1.20
+++ Completion/Unix/Command/.distfiles	7 Mar 2002 13:54:47 -0000
@@ -16,5 +16,5 @@
 _diff         _gs           _make         _psutils      _tin	_apm  _mail
 _last         _loadkeys     _modutils     _ruby         _sysctl _links _samba
 _user_admin   _rsync        _arping	  _spamassassin _mtools       _ifconfig
-_fsh          _chkconfig    _cdcd         _irssi
+_fsh          _chkconfig    _cdcd         _irssi        _mysqldiff
 '
Index: Completion/Unix/Command/_mysqldiff
===================================================================
RCS file: Completion/Unix/Command/_mysqldiff
diff -N Completion/Unix/Command/_mysqldiff
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ Completion/Unix/Command/_mysqldiff	7 Mar 2002 13:54:47 -0000
@@ -0,0 +1,31 @@
+#compdef mysqldiff
+
+local curcontext="$curcontext" state line expl
+typeset -A opt_args
+
+_mysqldiff () {
+  _arguments -s \
+    {-h{,1,2},--host{,1,2}=}':server hostname:_mysql_hosts' \
+    {-p{,1,2},--password{,1,2}=}':server password: ' \
+    {-u{,1,2},--user{,1,2}=}':server username:_mysql_users' \
+    {-s{,1,2},--socket{,1,2}=}':server socket:_directories' \
+    {-d,--debug=}':debugging level (default 1):(1 2 3 4 5 6 7 8)' \
+    {-i,--tolerant}':ignore DEFAULT and formatting changes: ' \
+    {-k,--keep-old-tables}":don\'t output DROP TABLE commands: " \
+    {-n,--no-old-defs}"[don't output old defs as comments]" \
+    {-o,--only-both}'[only output changes for tables in both databases]' \
+    {-t,--table-re}':restrict comparisons to tables matching a regexp: ' \
+    {-A,--apply}':interactively patch database1 to match database2: ' \
+    {-\?,--help}'[display usage]' \
+    {1,2}':MySQL database:_mysql_db_or_file'
+}
+
+
+_mysql_db_or_file () {
+  _alternative \
+    'databases:MySQL databases:_mysql_databases' \
+    'files:MySQL database definition files:_files -g \*.\(my\|\)sql'
+}
+
+_mysql_utils
+_mysqldiff "$@"

