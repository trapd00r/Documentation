From zsh-workers-return-24599-mason-zsh=primenet.com.au@sunsite.dk Tue Feb 26 18:12:42 2008
Return-Path: <zsh-workers-return-24599-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18824 invoked from network); 26 Feb 2008 18:12:28 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Feb 2008 18:12:28 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 54164 invoked from network); 26 Feb 2008 18:12:25 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Feb 2008 18:12:25 -0000
Received: (qmail 9590 invoked by alias); 26 Feb 2008 18:12:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24599
Received: (qmail 9574 invoked from network); 26 Feb 2008 18:12:21 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 26 Feb 2008 18:12:21 -0000
Received: from wr-out-0506.google.com (wr-out-0506.google.com [64.233.184.232])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 352268026E0B
	for <zsh-workers@sunsite.dk>; Tue, 26 Feb 2008 19:12:14 +0100 (CET)
Received: by wr-out-0506.google.com with SMTP id c49so3446920wra.21
        for <zsh-workers@sunsite.dk>; Tue, 26 Feb 2008 10:12:13 -0800 (PST)
Received: by 10.141.86.14 with SMTP id o14mr3563393rvl.148.1204049532085;
        Tue, 26 Feb 2008 10:12:12 -0800 (PST)
Received: by 10.141.44.9 with HTTP; Tue, 26 Feb 2008 10:12:12 -0800 (PST)
Message-ID: <19e566510802261012n2d50e0cam8106c4e2e2c930f8@mail.gmail.com>
Date: Tue, 26 Feb 2008 20:12:12 +0200
From: "=?UTF-8?Q?=C4=B0smail_D=C3=B6nmez?=" <ismail@namtrac.org>
To: "Peter Stephenson" <pws@csr.com>
Subject: Re: * Re: Failed tests of zsh 4.3.5 in Solaris 10 w/Sun Studio 12 CC
Cc: zsh-workers@sunsite.dk, "Dagobert Michelsen" <dam@blastwave.org>
In-Reply-To: <20080226180807.10cd1476@news01>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <8AABEECB-A9A6-43EA-BED2-4BE376CBE349@blastwave.org>
	 <20080226141459.76dc362c@news01>
	 <BD1EA7D6-C784-4ED9-9558-5B655CBC5096@blastwave.org>
	 <20080226145741.6e74fc22@news01>
	 <656429B3-438B-4ECF-85C4-04E38D837D1A@blastwave.org>
	 <200802261610.m1QGAwJ3008939@news01.csr.com>
	 <20080226180807.10cd1476@news01>
X-Virus-Scanned: ClamAV 0.91.2/6003/Tue Feb 26 12:34:31 2008 on bifrost
X-Virus-Status: Clean

Hi,

On Tue, Feb 26, 2008 at 8:08 PM, Peter Stephenson <pws@csr.com> wrote:
> On Tue, 26 Feb 2008 16:10:58 +0000
>  Peter Stephenson <pws@csr.com> wrote:
>  > +                 if (!codessetstr || !*codsetstr ||
>  > +                     !strcmp(codesetstr, "646"))
>  > +                     codesetstr == "US-ASCII";
>
>  Er, except that there are three mistakes in those three lines of code, as
>  Geoff pointed out.  I was lulled into a false sense of security because
>  this doesn't get compiled on my machine.  I tried it specially.
>
>  Index: Src/utils.c
>  ===================================================================
>  RCS file: /cvsroot/zsh/zsh/Src/utils.c,v
>  retrieving revision 1.178
>  diff -u -r1.178 utils.c
>  --- Src/utils.c 26 Feb 2008 16:19:34 -0000      1.178
>  +++ Src/utils.c 26 Feb 2008 18:05:59 -0000
>  @@ -4885,9 +4885,9 @@
>                      * It shouldn't ever be NULL, but while we're
>                      * being paranoid...
>                      */
>  -                   if (!codessetstr || !*codsetstr ||
>  +                   if (!codesetstr || !*codesetstr ||
>                         !strcmp(codesetstr, "646"))
>  -                       codesetstr == "US-ASCII";
>  +                       codesetstr = "US-ASCII";
>                     cd = iconv_open(nl_langinfo(CODESET), "UCS-4BE");
>                     if (cd == (iconv_t)-1) {
>                         zerr("cannot do charset conversion (iconv failed)");

Yeah my patch did the same. Thanks.

-- 
Never learn by your mistakes, if you do you may never dare to try again

