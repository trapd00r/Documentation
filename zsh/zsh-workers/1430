From hzoli@cs.elte.hu Mon Jun 24 22:16:57 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id WAA28512 for <mason@werple.mira.net.au>; Mon, 24 Jun 1996 22:15:17 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id HAA01294; Mon, 24 Jun 1996 07:58:32 -0400 (EDT)
Resent-Date: Mon, 24 Jun 1996 07:58:32 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199606241157.NAA02656@bolyai.cs.elte.hu>
Subject: Re: read broken in beta21
To: A.Main@dcs.warwick.ac.uk (Zefram)
Date: Mon, 24 Jun 1996 13:57:53 +0200 (MET DST)
Cc: zsh-workers@math.gatech.edu
In-Reply-To: <22461.199606211716@stone.dcs.warwick.ac.uk> from Zefram at "Jun 21, 96 06:16:10 pm"
Organization: Dept. of Comp. Sci., Eotvos University, Budapest, Hungary
Phone: (36 1)2669833 ext: 2667, home phone: (36 1) 2752368
X-Mailer: ELM [version 2.4ME+ PL16 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"tLTWA1.0.8K.eBepn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1430
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1315
Status: OR

> It appears that the changes to bin_read in beta21 have introduced a
> bug.  Trailing non-whitespace IFS characters on the input line are
> appended to the last parameter being set, instead of removed.  This
> change has broken a script of mine.  Or does POSIX require this?  sh
> matches zsh's previous behaviour.

What is sh?  On Linux, sh is bash which matches zsh's new behaviour.  Other
sh's.  Here is what POSIX says:

 The line shall be split into fields (see the definition in 3.1.3) as in
 the shell (see 3.6.5); the first field shall be assigned to the first
 variable var, the second field to the second variable var, etc.  If there
 are fewer var operands specified than there are fields, the leftover
 fields and their intervening separators shall be assigned to the last
 var. If there are fewer fields than vars, the remaining vars shall be set
 to empty strings.

So it is clear that the `intervening separators' should be assigned to the
last parameter.  A non-whitespace IFS character is always a separator so it
should not be removed.  bash and pdksh behaves as zsh while ksh93 removes
training non-whitespace IFS characters (which is wrong if I interpret POSIX
correctly).  This also means that trailing IFS-whitespaces should be
removed as these are not and intervening separarators.

Zoltan


