From zsh-users-return-11572-mason-zsh=primenet.com.au@sunsite.dk Fri Jun 15 20:25:54 2007
Return-Path: <zsh-users-return-11572-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21273 invoked from network); 15 Jun 2007 20:25:52 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00,MISSING_MID
	autolearn=ham version=3.2.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 15 Jun 2007 20:25:52 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 74138 invoked from network); 15 Jun 2007 20:25:44 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 15 Jun 2007 20:25:44 -0000
Received: (qmail 24372 invoked by alias); 15 Jun 2007 20:25:37 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11572
Received: (qmail 24362 invoked from network); 15 Jun 2007 20:25:36 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 15 Jun 2007 20:25:36 -0000
Received: (qmail 72851 invoked from network); 15 Jun 2007 20:25:36 -0000
Received: from sunset.tt-solutions.com (HELO smtp.tt-solutions.com) (82.238.156.189)
  by a.mx.sunsite.dk with SMTP; 15 Jun 2007 20:25:32 -0000
Received: from nightfall ([192.168.17.76])
	by smtp.tt-solutions.com with esmtp (Exim 4.63)
	(envelope-from <vz-zsh@zeitlins.org>)
	id 1HzIMN-0006Pf-UF
	for zsh-users@sunsite.dk; Fri, 15 Jun 2007 22:25:31 +0200
Date: Fri, 15 Jun 2007 22:25:31 +0200
From: Vadim Zeitlin <vz-zsh@zeitlins.org>
Subject: how to customize _all_matches use?
To: zsh-users@sunsite.dk
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII
Content-Disposition: INLINE
X-Mailer: Mahogany 0.67.0 'Constance', running under Windows Server 2003 (build 3790, Service Pack 1)

 Hello,

 I'd like to have a key binding which would complete all matches which I
would get by pressing TAB at once. AFAICS from the manual/user guide, this
is what the all-matches completer is for and so, following the examples
there, I tried to do the following:

	% zle -C all-matches complete-word _generic
	% bindkey '^Xa' all-matches
	% zstyle ':completion:all-matches:*' completer _all_matches

However this doesn't seem to work:

	% ls
	bar  baz  foo
	% ls ^Xa # nothing happens

I do get the behaviour I want if I do

	% zstyle ':completion:all-matches:*' completer _all_matches _complete

but with one extremely annoying side-effect:

	% ls ^Xa
	% ls bar baz foo # this is the same line completed by the shell
	bar baz foo
	bar  baz  foo

i.e. although I do get all the completions I also get *2* lists of them
below. I would understand it if I was getting 1 line because I use
MENU_COMPLETE (and no other non-default completion options), but where does
the second one come from? Also, I'd like to not see anything at all if
possible. So what am I doing wrong?


 And, of course, I don't really want to have this behaviour so much for ls
as for other commands where the completion can't be replaced with just '*'.
For example, it would be very useful to have for "cvs diff" for which I use

	zstyle ':completion::complete:cvs-diff:argument-rest:' \
		tag-order existing-files removed-files directories

so that pressing TAB after "cvs di" normally completes only the modified
files. But pressing ^Xa also completes the sub-directories -- is there any
way I could avoid this?

 Thanks in advance for any help!
VZ

P.S. If it matters, I'm using 4.3.2 under Debian Linux

