From zsh-workers-request@euclid.skiles.gatech.edu Thu Jan 02 09:52:17 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 712 invoked from network); 2 Jan 1997 09:52:14 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 2 Jan 1997 09:52:14 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id EAA25650; Thu, 2 Jan 1997 04:56:34 -0500 (EST)
Resent-Date: Thu, 2 Jan 1997 04:56:34 -0500 (EST)
From: Zefram <zefram@dcs.warwick.ac.uk>
Message-Id: <21024.199701020957@stone.dcs.warwick.ac.uk>
Subject: header dependencies
To: zsh-workers@math.gatech.edu (Z Shell workers mailing list)
Date: Thu, 2 Jan 1997 09:57:30 +0000 (GMT)
X-Patch: 174
X-Loop: zefram@dcs.warwick.ac.uk
X-Stardate: [-31]8667.07
X-US-Congress: Moronic fuckers
Content-Type: text
Resent-Message-ID: <"n5cZh2.0.jG6.IPuoo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2697
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

This patch corrects the dependencies for headers, and also fixes a couple
of header inclusions to match.

 -zefram

 *** Src/Makefile.in	1997/01/01 05:04:58	1.29
 --- Src/Makefile.in	1997/01/01 05:53:22
 ***************
 *** 110,116 ****
   
   # headers included in distribution
   DIST_HDRS = globals.h hashtable.h prototypes.h signals.h \
 ! system.h zsh.h ztype.h Zle/zle.h
   
   # zsh headers necessary for compilation
   HDRS = $(DIST_HDRS) signames.h @RLIMITS_SRC_H@ ../config.h
 --- 110,116 ----
   
   # headers included in distribution
   DIST_HDRS = globals.h hashtable.h prototypes.h signals.h \
 ! system.h zsh.h ztype.h
   
   # zsh headers necessary for compilation
   HDRS = $(DIST_HDRS) signames.h @RLIMITS_SRC_H@ ../config.h
 *** Src/params.c	1996/12/31 17:08:46	1.26
 --- Src/params.c	1997/01/01 05:47:32
 ***************
 *** 31,36 ****
 --- 31,38 ----
   
   #include "zsh.h"
   
 + #include "version.h"
 + 
   static Param argvparam;
   
   /* Set up parameter hash table.  This will add predefined  *
 *** Src/zsh.h	1996/12/31 17:08:48	1.39
 --- Src/zsh.h	1997/01/01 05:47:01
 ***************
 *** 1272,1278 ****
   /* Shared header files */
   /***********************/
   
 - #include "version.h"
   #include "signals.h"
   #include "prototypes.h"
   #include "globals.h"
 --- 1272,1277 ----
 *** Src/Modules/Makefile.in	1997/01/01 05:05:03	1.13
 --- Src/Modules/Makefile.in	1997/01/01 06:04:53
 ***************
 *** 99,110 ****
 --- 99,119 ----
   .c.pro:
   	$(SED) -n -f $(srcdir)/../makepro.sed $< > $@
   
 + ZHDRS = ../globals.h ../hashtable.h ../prototypes.h ../rlimits.h \
 + ../signals.h ../signames.h ../system.h ../zsh.h ../ztype.h ../../config.h
 + 
   # generated prototypes
   PROTO = example.pro files.pro
   
   # target modules
   MODULES = example.so files.so
   
 + # object files
 + OBJS = example.o files.o
 + DOBJS = example..o files..o
 + 
 + ALLOBJS = $(OBJS) $(DOBJS)
 + 
   # ========= DEPENDENCIES FOR BUILDING ==========
   
   # default target
 ***************
 *** 113,118 ****
 --- 122,129 ----
   modules: shobjs
   
   shobjs: $(MODULES)
 + 
 + $(ALLOBJS): $(ZHDRS)
   
   proto: $(PROTO)
   
 *** Src/Zle/Makefile.in	1997/01/01 05:05:04	1.13
 --- Src/Zle/Makefile.in	1997/01/01 05:56:11
 ***************
 *** 98,103 ****
 --- 98,106 ----
   .c.pro:
   	$(SED) -n -f $(srcdir)/../makepro.sed $< > $@
   
 + ZHDRS = ../globals.h ../hashtable.h ../prototypes.h ../rlimits.h \
 + ../signals.h ../signames.h ../system.h ../zsh.h ../ztype.h ../../config.h
 + 
   # generated prototypes
   PROTO = zle_bindings.pro zle_hist.pro zle_keymap.pro zle_main.pro zle_misc.pro \
   zle_move.pro zle_refresh.pro zle_tricky.pro zle_utils.pro zle_vi.pro \
 ***************
 *** 129,135 ****
   zle.so: $(ZLEDOBJS)
   	$(DLLINK) $(ZLEDOBJS)
   
 ! $(ALLOBJS): $(HDRS)
   
   $(HDRS): proto
   
 --- 132,138 ----
   zle.so: $(ZLEDOBJS)
   	$(DLLINK) $(ZLEDOBJS)
   
 ! $(ALLOBJS): $(HDRS) $(ZHDRS)
   
   $(HDRS): proto
   
 *** Src/Zle/compctl.c	1996/12/24 17:07:34	1.4
 --- Src/Zle/compctl.c	1997/01/01 06:12:25
 ***************
 *** 30,35 ****
 --- 30,36 ----
    */
   
   #include "zle.h"
 + #include "compctl.pro"
   
   #define COMP_LIST	(1<<0)	/* -L */
   #define COMP_COMMAND	(1<<1)	/* -C */
 *** Src/Zle/zle.h	1996/12/26 19:13:32	1.4
 --- Src/Zle/zle.h	1997/01/01 05:50:04
 ***************
 *** 518,524 ****
   
   /* prototypes */
   
 ! #include "compctl.pro"
   #include "zle_hist.pro"
   #include "zle_keymap.pro"
   #include "zle_main.pro"
 --- 518,524 ----
   
   /* prototypes */
   
 ! #include "zle_bindings.pro"
   #include "zle_hist.pro"
   #include "zle_keymap.pro"
   #include "zle_main.pro"

-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBMsoBg3D/+HJTpU/hAQFg3QQAgtz5njt4kPStvRGwsxoUEgUVWlVb6m+G
b1+dZOhYNJlp5tkMdjfLs6VQJkg+U8C/vTnGAw2jzlIeh0PAxoZ0TFODBeYULGej
d0Pu5WFNPHRb6l5MmRA+rcGwcd/cq7cVwWaX/j+e95TWN2N79NqneOgC7WOFGum7
Pto/VCmXEaw=
=e0TJ
-----END PGP SIGNATURE-----

