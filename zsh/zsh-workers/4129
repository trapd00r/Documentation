From zsh-workers-request@math.gatech.edu Tue Jun 16 18:16:07 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9320 invoked from network); 16 Jun 1998 18:16:06 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 16 Jun 1998 18:16:06 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id OAA02206;
	Tue, 16 Jun 1998 14:01:41 -0400 (EDT)
Resent-Date: Tue, 16 Jun 1998 14:01:41 -0400 (EDT)
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <980616110244.ZM10475@candle.brasslantern.com>
Date: Tue, 16 Jun 1998 11:02:43 -0700
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@math.gatech.edu
Subject: cvsaddp and cvsremovep in compctl-examples
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"5P7hF1.0.PY.4ChXr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4129
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

The number of pipelines and external commands involved is silly, especially
when most of what they do is already done by cvstargets.

cvsremovep() {
    cvstargets
    setopt localoptions extendedglob
    local omit
    omit=(*(D))
    eval 'reply=( ${reply:#('${(j:|:)omit}')} )'
}

cvsaddp() {
    cvstargets
    setopt localoptions extendedglob
    local all omit
    all=(*(D))
    omit=( $reply $=cvsignore )
    [[ -r ~/.cvsignore ]] && omit=( $omit $(<~/.cvsignore) )
    [[ -r .cvsignore ]] && omit=( $omit $(<.cvsignore) )
    eval 'reply=( ${all:#('${(j:|:)omit}')} )' 
}

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

