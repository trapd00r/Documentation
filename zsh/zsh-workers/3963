From zsh-workers-request@math.gatech.edu Sun May 10 20:23:23 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8640 invoked from network); 10 May 1998 20:23:21 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 10 May 1998 20:23:21 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id QAA09615;
	Sun, 10 May 1998 16:18:50 -0400 (EDT)
Resent-Date: Sun, 10 May 1998 16:18:50 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199805102019.PAA08850@hzoli.home>
Subject: PATCH: Functions/checkmail
To: zsh-workers@math.gatech.edu (Zsh hacking and development)
Date: Sun, 10 May 1998 15:19:13 -0500 (CDT)
X-Mailer: ELM [version 2.4ME+ PL31 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"pop7E3.0.AM2.fkWLr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3963
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Zero length files always have access time not later than modification
time, therefore checkmail always reported zero length folders as new.
This patch should also be applied to 3.0.5.

Zoltan


*** Functions/checkmail.orig	Tue Feb 11 08:23:47 1997
--- Functions/checkmail	Sun May 10 15:14:20 1998
***************
*** 22,28 ****
  		if (($#file)) then
  			checkmail "${^file}\?$message"
  		fi
! 	elif test -N "$file"; then  # this also sets $_ to $file
  		print -r -- "${(e)message:-You have new mail.}"
  	fi
  done
--- 22,28 ----
  		if (($#file)) then
  			checkmail "${^file}\?$message"
  		fi
! 	elif test -s "$file" -a -N "$file"; then  # this also sets $_ to $file
  		print -r -- "${(e)message:-You have new mail.}"
  	fi
  done

