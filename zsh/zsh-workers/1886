From zsh-workers-request@euclid.skiles.gatech.edu  Fri Aug  2 11:27:17 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id LAA01873 for <mason@primenet.com.au>; Fri, 2 Aug 1996 11:27:13 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id VAA17974; Thu, 1 Aug 1996 21:21:49 -0400 (EDT)
Resent-Date: Thu, 1 Aug 1996 21:21:49 -0400 (EDT)
Message-Id: <199608020120.DAA19010@hera.cuci.nl>
From: srb@cuci.nl (Stephen R. van den Berg)
Date: Fri, 2 Aug 1996 03:20:32 +0200
In-Reply-To: Zefram's message as of 1996 Aug 2 Fri  1:59.
       <19720.199608020100@stone.dcs.warwick.ac.uk>
To: Zefram <A.Main@dcs.warwick.ac.uk>
Subject: Re: Procmail rejects zsh as being "broken"
Cc: zsh-workers@math.gatech.edu
Resent-Message-ID: <"e9ZrW1.0.mO4.iWL0o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1886
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Zefram <A.Main@dcs.warwick.ac.uk> wrote:
>I always set SHELL to /bin/sh explicitly in Makefiles.  GNU standards
>recommend this too.  This is really an example of the now deeply

Well, it's not that easy.
For a real POSIX environment, you could simply omit setting SHELL, since
the make utility will *always* set it to a /bin/sh compatible shell.

For non-posix environments, it gets a bit tricky.  Some makes set it,
some don't, some makes export the SHELL assignment to the environment,
some don't.  Then there is the possibility that the /bin/sh is a buggy
implementation with way too many bugs (some vendors delivered this
with their system).  So the users typically went and got themselves
a different shell (like pdksh, bash, zsh, whatever).  Now, if the
user is using that as his loginshell, and the shell is Bourne shell
compatible, then we'll try to use that one first.

Which is exactly why I was bothering with the zsh (in case it was more
/bin/sh compatible than the original /bin/sh installed on the system; why
wouldn't they replace the /bin/sh with a link to zsh, well, lots of
reasons: he's not the sysadmin, company policy, etc.).

>>+	*[zc]sh*) echo "Warning: really perverted make detected"; SHELL="";;

>Wouldn't it be better to do the feature tests, ignoring the name in
>$SHELL?  Maybe some perverted admin has a copy of sh under the name
>zsh.

Feature tests are difficult to make comprehensive.

>  Or even better, just use /bin/sh, which is Bourne-compatible
>everywhere, rather than accepting whatever $SHELL happens to be.

Not such a good idea, see above.
-- 
Sincerely,                                                          srb@cuci.nl
           Stephen R. van den Berg (AKA BuGless).
Auto repair rates: basic labor $40/hour; if you wait, $60; if you watch, $80;
if you ask questions, $100; if you help, $120; if you laugh, $140.

