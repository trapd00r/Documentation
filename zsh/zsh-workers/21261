From zsh-workers-return-21261-mason-zsh=primenet.com.au@sunsite.dk Mon May 16 02:11:11 2005
Return-Path: <zsh-workers-return-21261-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28691 invoked from network); 16 May 2005 02:11:11 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 May 2005 02:11:11 -0000
Received: (qmail 64663 invoked from network); 16 May 2005 02:11:05 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 May 2005 02:11:05 -0000
Received: (qmail 5090 invoked by alias); 16 May 2005 02:11:02 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21261
Received: (qmail 5065 invoked from network); 16 May 2005 02:11:01 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 16 May 2005 02:11:01 -0000
Received: (qmail 64414 invoked from network); 16 May 2005 02:11:01 -0000
Received: from vms048pub.verizon.net (206.46.252.48)
  by a.mx.sunsite.dk with SMTP; 16 May 2005 02:10:57 -0000
Received: from candle.brasslantern.com ([4.11.1.68])
 by vms048.mailsrvcs.net (Sun Java System Messaging Server 6.2 HotFix 0.04
 (built Dec 24 2004)) with ESMTPA id <0IGK0040H8Q7WGG0@vms048.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Sun, 15 May 2005 21:10:56 -0500 (CDT)
Received: from candle.brasslantern.com (IDENT:schaefer@localhost [127.0.0.1])
	by candle.brasslantern.com (8.12.11/8.12.11) with ESMTP id j4G2As2i025852;
 Sun, 15 May 2005 19:10:54 -0700
Received: (from schaefer@localhost)	by candle.brasslantern.com
 (8.12.11/8.12.11/Submit) id j4G2AqwI025851; Sun, 15 May 2005 19:10:52 -0700
Date: Mon, 16 May 2005 02:10:52 +0000
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: problem using $$
In-reply-to: <20050513165519.GC11723@logix-tt.com>
To: Rico Schiekel <rico.schiekel@logix-tt.com>, zsh-workers@sunsite.dk
Message-id: <1050516021052.ZM25850@candle.brasslantern.com>
MIME-version: 1.0
X-Mailer: Z-Mail (5.0.0 30July97)
Content-type: text/plain; charset=us-ascii
References: <20050513165519.GC11723@logix-tt.com>
Comments: In reply to Rico Schiekel <rico.schiekel@logix-tt.com>
 "problem using $$" (May 13,  6:55pm)
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

On May 13,  6:55pm, Rico Schiekel wrote:
}
} | ps aux | grep " $mp "
} | ps aux | grep "start.osd" | grep -v "grep" | grep -v " $mp "
} 
} |b fire      4128  0.0  0.1  2708 1324 pts/4    R+   18:33   0:00 /bin/zsh ./test.zsh
} |c fire      4172  0.0  0.1  2708 1332 pts/4    R+   18:33   0:00 /bin/zsh ./test.zsh
} 
} - first call:
}    why is the process id from the second ps [c] other than the process
}    id from the first ps [b] and $$ [a] ?

I think that's because your script is buggy.  The third call to grep in
the [c] case should not have the "-v" option.

After getting rid of the stray "-v", try using "ps alx" rather than "aux".
That will allow you to grep the $mp out of both the PID and PPID columns
and thereby see the parent/child relationship among the shells.

} |2 fire      4216  0.0  0.0     0    0 pts/4    R+   18:33   0:00 [test.zsh]
} 
} - second call:
}    and what is "[test.zsh]" [2]

The ps output has square brackets like that for a child process when the
original process has fork()ed but has not done an execv() in the child.
This means that the "ps" is running soon enough to catch zsh after it
has forked, but before it has finished starting up one of the greps that
appear later in the pipeline.  Vagaries of process scheduling.

}    and why has it got another pid (4216) than $$ (4173) [1] ?

Because your script ran 'grep -v " 4173 "'.

