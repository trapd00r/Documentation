From zsh-workers-request@math.gatech.edu Tue Sep 15 21:06:56 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26246 invoked from network); 15 Sep 1998 21:06:55 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 15 Sep 1998 21:06:55 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id RAA21389;
	Tue, 15 Sep 1998 17:00:18 -0400 (EDT)
Resent-Date: Tue, 15 Sep 1998 16:56:33 -0400 (EDT)
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <980915135929.ZM3723@candle.brasslantern.com>
Date: Tue, 15 Sep 1998 13:59:29 -0700
In-Reply-To: <AF4C1F8C5306D111AD5F0000F8662ED3053088BA@RED-MSG-41>
Comments: In reply to Amol Deshpande <amold@MICROSOFT.com>
        "RE: zsh for win32 - installation of zshrc" (Sep 15, 11:00am)
References: <AF4C1F8C5306D111AD5F0000F8662ED3053088BA@RED-MSG-41>
X-Mailer: Z-Mail Lite (5.0.0 30July97)
To: ZShell Users List <zsh-users@math.gatech.edu>
Subject: Re: zsh for win32 - installation of zshrc
Cc: amol@blarg.net
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"UcZat.0._B5.1Ij_r"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1804
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Sep 15, 11:00am, Amol Deshpande wrote:
> Subject: RE: zsh for win32 - installation of zshrc
> 
> > (I also put in HOME=$HOMEDRIVE$HOMEPATH; what was the reason
> > for not defaulting $HOME from this on NT 4+ ?)
> > 
> each user is guaranteed to get a different $USERPROFILE, while I don't think
> the $HOMEPATH changes unless you specifically set it for each user.

Ah, this is correct; it appears to default to \ if not explicitly assigned
by the administrator.  So here's what I have now:

[[ -n "$HOMEPATH" ]] && export HOME="$HOMEDRIVE$HOMEPATH"
[[ -z "$ZDOTDIR" && "$HOMEPATH" == [\\/] ]] && ZDOTDIR="$USERPROFILE"

This makes ~ sensible for users whose HOMEPATH is set e.g. from the user
account manager, while looking for init files in the USERPROFILE for any
user that doesn't have a useful HOMEPATH.

A couple of other remarks about using zsh on NT:

"setopt correct" is worthless because it uses the full file name (e.g.
"foo.exe") when trying to correct the spelling of a command ("foo") and
therefore complains about nearly everything except builtins.  (This is
probably fixable by playing with hash/unhash commands.)

"setopt winnt_ignore_case winnt_lame_path_fix" seems to be a pretty good
idea.  I'm not sure exactly when "winnt_convert_backslash" is important.

