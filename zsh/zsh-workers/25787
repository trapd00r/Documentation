From zsh-workers-return-25787-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 01 06:07:12 2008
Return-Path: <zsh-workers-return-25787-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8482 invoked from network); 1 Oct 2008 06:07:01 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Oct 2008 06:07:01 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 91656 invoked from network); 1 Oct 2008 06:06:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2008 06:06:52 -0000
Received: (qmail 1903 invoked by alias); 1 Oct 2008 06:06:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25787
Received: (qmail 1879 invoked from network); 1 Oct 2008 06:06:36 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 1 Oct 2008 06:06:36 -0000
Received: from vms172071pub.verizon.net (vms172071pub.verizon.net [206.46.172.71])
	by bifrost.dotsrc.org (Postfix) with ESMTP id CA4D38030847
	for <zsh-workers@sunsite.dk>; Wed,  1 Oct 2008 08:06:30 +0200 (CEST)
Received: from torch.brasslantern.com ([96.238.220.215])
 by vms172071.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0K8100540QAGU113@vms172071.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Wed, 01 Oct 2008 01:06:17 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id m9166FSN032709; Tue,
 30 Sep 2008 23:06:15 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id m9166EVl032708; Tue, 30 Sep 2008 23:06:14 -0700
Date: Tue, 30 Sep 2008 23:06:14 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Strange parsing bug(?)
In-reply-to: <2d460de70809301756j71effaa9waa6b1a1d0736d9b9@mail.gmail.com>
To: "Richard Hartmann" <richih.mailinglist@gmail.com>,
 "Zsh hackers list" <zsh-workers@sunsite.dk>
Message-id: <080930230614.ZM32707@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <2d460de70809301756j71effaa9waa6b1a1d0736d9b9@mail.gmail.com>
Comments: In reply to "Richard Hartmann" <richih.mailinglist@gmail.com>
 "Strange parsing bug(?)" (Oct  1,  2:56am)
X-Virus-Scanned: ClamAV 0.92.1/8363/Wed Oct  1 05:24:25 2008 on bifrost
X-Virus-Status: Clean

On Oct 1,  2:56am, Richard Hartmann wrote:
}
} Of course, I might have stumbled onto a hidden feature, but if that
} is the case, I would argue that this is extremely against the
} expectation of most users.

It's not a hidden feature, but it is a feature.  Doc says:

   If the shell encounters the character sequence `!"' in the input,
   the history mechanism is temporarily disabled until the current list
   (see *Note Shell Grammar::) is fully parsed. The `!"' is removed
   from the input, and any subsequent `!' characters have no special
   significance.

If you don't want ! to be a history character, setopt nobanghist.  If
you do want it to be a history character, then ... get used to using
single quotes instead of double, I guess, because history doesn't
expand in single quotes.

(Aside:  I think it's actually the first character of $histchars and
then a double quote that has this effect, so the doc could be better.)

