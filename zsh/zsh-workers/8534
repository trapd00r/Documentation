From zsh-workers-return-8534-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Nov 04 09:47:27 1999
Return-Path: <zsh-workers-return-8534-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2920 invoked from network); 4 Nov 1999 09:47:26 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 4 Nov 1999 09:47:26 -0000
Received: (qmail 27974 invoked by alias); 4 Nov 1999 09:47:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8534
Received: (qmail 27967 invoked from network); 4 Nov 1999 09:47:18 -0000
Date: Thu, 4 Nov 1999 10:47:15 +0100 (MET)
Message-Id: <199911040947.KAA11871@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Wed, 3 Nov 1999 20:07:05 +0300
Subject: Re: Once more: "Do you wish to see all xxx possibilities?"


Andrej Borsenkow wrote:

> I still do not understand, when it is printed. Looking in Zle/compresult.c:
> 
>     /* Maybe we have to ask if the user wants to see the list. */
>     if ((!minfo.cur || !minfo.asked) &&
> 	((complistmax && listdat.nlist > complistmax) ||
> 	 (!complistmax && listdat.nlines >= lines))) {
> 
> It means, that it should ask if either complistmax is set (value of
> $compconfig[list_max]?) or number of lines exceeds $LINES. It seems, that Zsh
> sometimes gets incorrect count in listdat.nlines. Consider:

Many years ago, documentation was invented:

  LISTMAX
     In the line editor, the number of filenames to list without asking
     first.  If set to zero, the shell asks only if the top of the
     listing would scroll off the screen.

Even though `filenames' is definitely the wrong word here, I think it
should be clear enough.

And that's what the test you quoted above does. `complistmax' is the
atoi() of the value of `$compconfig[list_max]'. So, we ask if either
that is non-zero and the number of matches is larger than that value
or if the value is zero and the number of lines needed for the list is 
larger that the screen height.

In other words: if you only want the list if it fits on the screen,
set `LISTMAX=0'.

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

