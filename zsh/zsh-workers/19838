From zsh-workers-return-19838-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 27 14:39:28 2004
Return-Path: <zsh-workers-return-19838-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29651 invoked from network); 27 Apr 2004 14:39:28 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 27 Apr 2004 14:39:28 -0000
Received: (qmail 23928 invoked by alias); 27 Apr 2004 14:39:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19838
Received: (qmail 23917 invoked from network); 27 Apr 2004 14:39:07 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 27 Apr 2004 14:39:07 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 27 Apr 2004 14:39:6 -0000
Received: (qmail 1761 invoked from network); 27 Apr 2004 14:39:06 -0000
Received: from moonbase.zanshin.com (root@167.160.213.139)
  by a.mx.sunsite.dk with SMTP; 27 Apr 2004 14:39:04 -0000
Received: from aztec.zanshin.com (IDENT:schaefer@aztec.zanshin.com [167.160.213.132])
	by moonbase.zanshin.com (8.12.11/8.12.11) with ESMTP id i3REd0dY032494
	for <zsh-workers@sunsite.dk>; Tue, 27 Apr 2004 07:39:00 -0700
Date: Tue, 27 Apr 2004 07:39:00 -0700 (PDT)
From: Bart Schaefer <schaefer@zanshin.com>
To: zsh-workers@sunsite.dk
Subject: The file-sort style is broken
Message-ID: <Pine.LNX.4.44.0404270718520.10119-100000@aztec.zanshin.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

schaefer[512] echo $^fpath/_zip(N)
/usr/share/zsh/4.2.0/functions/_zip
schaefer[513] unzip -<TAB>
No matches for `zip file'

(Huh?  Why is it trying to complete a zip file after a hyphen, rather
than completing options?)

schaefer[513] ls                                                          
editor_1.5.zip     orbit-root/               vmware-root/
fileNEelW2         orbit-schaefer/           vmware-schaefer/
fileaVYCCS         samba/                    zsh30810unzip1
filemmnASt         scrollkeeper-tempfile.0*  zsh31261unzip1
kde-schaefer/      scrollkeeper-tempfile.1*
ksocket-schaefer/  ssh-vmCQ7238/
schaefer[514] unzip <TAB>
No matches for `zip file'

(Well, that's obviously wrong -- there's a .zip file right there.  I try
it with "zsh -f" and it works.  OK, start deleting my zstyles, one by
one ... a few commands later ...)

schaefer[516] zstyle -d ':completion:*' file-sort modification
schaefer[517] unzip -<TAB>
Completing option
-C   -- match filenames case-insensitively
(etc. etc.)
schaefer[517] unzip <TAB>
Completing zip file
editor_1.5.zip     orbit-root/        ssh-vmCQ7238/                       
kde-schaefer/      orbit-schaefer/    vmware-root/                        
ksocket-schaefer/  samba/             vmware-schaefer/

Here's a snippet from the _complete_debug output:

: _path_files:126:then else for elif-then; tmp2=( '(#i)*.(zip|[ejw]ar)(om#q-.)' )

See where the "om" has been inserted?  Bad, very bad.  However, that does
not explain why completing options doesn't work, does it?  Or does it?

