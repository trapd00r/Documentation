From zsh-workers-request@math.gatech.edu  Wed Oct 18 16:07:42 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.net.au (8.7/8.7) with SMTP id QAA28709 for <mason@werple.mira.net.au>; Wed, 18 Oct 1995 16:07:29 +1000 (EST)
Received: from euclid (euclid.skiles.gatech.edu) by gatech.edu with SMTP id AA22423
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Wed, 18 Oct 1995 02:03:16 -0400
Received: by euclid (5.x/SMI-SVR4)
	id AA03039; Wed, 18 Oct 1995 02:01:43 -0400
Resent-Date: Wed, 18 Oct 1995 01:59:14 -0400
Old-Return-Path: <coleman@math.gatech.edu>
Message-Id: <9510180559.AA25070@redwood.skiles.gatech.edu>
X-Mailer: exmh version 1.6.4 10/10/95
To: zsh-workers@math.gatech.edu
Subject: global zlogout and .zlogout
In-Reply-To: Your message of "Wed, 06 Sep 1995 18:37:31 +0200."
             <199509061637.SAA02444@bolyai.cs.elte.hu> 
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Date: Wed, 18 Oct 1995 01:59:14 -0400
From: Richard Coleman <coleman@math.gatech.edu>
Resent-Message-Id: <"Aw1GU1.0.Pl.7X9Xm"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/473
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> > I've just grabed Zoltan's release, after MANY trials :-( Without
> > ncftp's nifty appending get I wouldn't have managed...
> > 
> > I noticed that the global zlogout is not sourced if NORCS is set. I
> > think this is wrong, it should always be executed, just like the
> > global zshenv.
> 
> I think that the same holds for the vanilla beta10.  zlogout should be
> executed if zlogin (or zprofile) executed on login.  Currently zlogout
> executed only on exit from login shells if NO_RCS is not set.

I'm going back through old mail, so I was looking at this problem
again.  I'm want to know what everyone this is the most usual
behavoir.

Currently in the zsh baseline, the global zlogout is only
executed for a login shell if NO_RCS is not set and the shell is
interactive.  This is definitely wrong.  My first reaction is to have
the global zlogout always executed (regardless of NO_RCS) when a login
shell is exiting.  This is the way the global zlogin file is handled.

Also, I now realize another potential problem.  When the init scripts
are sourced when the shell is starting up, there is a hack (setting the
sourcelevel to 32768) that prevents an error in these scripts from tripping
ERREXIT.  This same should probably apply to the global zlogout and .zlogout.

What does everyone think?

rc

