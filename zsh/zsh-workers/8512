From zsh-workers-return-8512-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Nov 03 10:08:19 1999
Return-Path: <zsh-workers-return-8512-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19255 invoked from network); 3 Nov 1999 10:08:18 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 3 Nov 1999 10:08:18 -0000
Received: (qmail 14673 invoked by alias); 3 Nov 1999 10:08:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8512
Received: (qmail 14665 invoked from network); 3 Nov 1999 10:08:07 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <991103100758.ZM12900@candle.brasslantern.com>
Date: Wed, 3 Nov 1999 10:07:58 +0000
In-Reply-To: <199911030804.JAA00408@beta.informatik.hu-berlin.de>
Comments: In reply to Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
        "Re: PATCH: completion cleanup" (Nov  3,  9:04am)
References: <199911030804.JAA00408@beta.informatik.hu-berlin.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: completion cleanup
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Nov 3,  9:04am, Sven Wischnowsky wrote:
} Subject: Re: PATCH: completion cleanup
}
} [...] after adding the `funcstack' parameter, I made the parameter
} module be loaded in `compinit' because I wanted to make sure that this 
} parameter is always correct (if the module is loaded when there are
} already functions currently being executed, these functions will be
} missing from `funcstack').
} 
} So, Felix Rosencrantz wrote:
} 
} > Once I got a good build, I found that the compinit function fails
} > because it calls "zmodload -i parameter".  Zsh reports "bad option:-i".
} 
} Ouch, hadn't thought of that.

Simple workaround appended.

} I think the static linked version of `zmodload' should be quiet (and
} do nothing) if the module we attempt to load is linked in and should
} barf otherwise.

I agree ... and that relates back to my previous comment, that it ought
to be possible to have modules that are linked in but not yet "loaded".
That's going to require some serious thought.

Index: Completion/Core/compinit
===================================================================
@@ -115,7 +115,7 @@
 
 # Loading it now ensures that the `funcstack' parameter is always correct.
 
-zmodload -i parameter
+: $funcstack
 
 # This function is used to register or delete completion functions. For
 # registering completion functions, it is invoked with the name of the

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

