From zsh-workers-return-8954-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Dec 08 21:24:24 1999
Return-Path: <zsh-workers-return-8954-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27128 invoked from network); 8 Dec 1999 21:24:23 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Dec 1999 21:24:23 -0000
Received: (qmail 19938 invoked by alias); 8 Dec 1999 21:24:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8954
Received: (qmail 19931 invoked from network); 8 Dec 1999 21:24:14 -0000
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: PATCH: 3.1.6-pws-10: Initial testing stuff 
In-reply-to: ""Bart Schaefer""'s message of "Tue, 07 Dec 1999 22:53:27 GMT."
             <991207225327.ZM14560@candle.brasslantern.com> 
Date: Wed, 08 Dec 1999 21:24:30 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E11voZC-0001fu-00.1999-12-08-21-24-08@mail6.svr.pol.co.uk>

"Bart Schaefer" wrote:
> On Dec 7, 10:12pm, Peter Stephenson wrote:
> } Subject: PATCH: 3.1.6-pws-10: Initial testing stuff
> }
> } The test driver script is Test/ztst.zsh; run `make tests' in
> } Test to run the test(s).
> 
> It might be reasonable to change this to "make check" which is what is
> expected for packages configured with "automake" (which zsh isn't, but
> just for consistency).

Even better: there are already targets for `check' and `test' in the top
level directory, which I didn't notice, so it uses both those (and not
`tests').  Moving them below the installation section is better, however,
since we need the modules to have been installed.  I should make that
clearer somewhere in the Test directory itself.

After checking it in locally, I realised I didn't know a way of diffing
that against the version before the check in.  Is it necessary to supply a
tag every time you commit?

Index: Makefile.in
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/Makefile.in,v
retrieving revision 1.6
diff -u -r1.6 Makefile.in
--- Makefile.in	1999/12/08 20:04:46	1.6
+++ Makefile.in	1999/12/08 20:29:33
@@ -46,9 +46,6 @@
 	  (cd $$subdir && $(MAKE) $(MAKEDEFS) $@) || exit 1; \
 	done
 
-check test:
-	@echo zsh test suite not available yet
-
 # prepare module configuration
 prep:
 	@cd Src && $(MAKE) $(MAKEDEFS) $@
@@ -86,6 +83,10 @@
 # install/uninstall just the info pages
 install.info uninstall.info:
 	@cd Doc && $(MAKE) $(MAKEDEFS) $@
+
+# ========== DEPENDENCIES FOR TESTING ==========
+check test:
+	cd Test ; $(MAKE) check
 
 # ========== DEPENDENCIES FOR CLEANUP ==========
 
Index: Etc/zsh-development-guide
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/Etc/zsh-development-guide,v
retrieving revision 1.3
retrieving revision 1.4
diff -u -r1.3 -r1.4
--- Etc/zsh-development-guide	1999/12/07 22:18:16	1.3
+++ Etc/zsh-development-guide	1999/12/08 20:08:27	1.4
@@ -60,7 +60,7 @@
   e.g. `expect').
 
 * The directory is not part of the usual process of building and
-  installation.  To run the tests, go to Test and `make test'.  Please
+  installation.  To run the tests, go to Test and `make check'.  Please
   report any errors with all the usual information about the zsh version
   and the system you are using.
 
Index: Test/Makefile.in
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/Test/Makefile.in,v
retrieving revision 1.1
diff -u -r1.1 Makefile.in
--- Test/Makefile.in	1999/12/07 22:18:16	1.1
+++ Test/Makefile.in	1999/12/08 20:29:46
@@ -40,7 +40,7 @@
 
 # ========== DEPENDENCIES FOR TESTING ==========
 
-tests:
+check test:
 	for f in *.ztst; do \
 	  ../Src/zsh ztst.zsh $$f; \
 	done

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

