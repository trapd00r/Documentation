From zsh-workers-return-14189-mason-zsh=primenet.com.au@sunsite.dk Tue May 01 17:24:56 2001
Return-Path: <zsh-workers-return-14189-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4016 invoked from network); 1 May 2001 17:24:55 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 May 2001 17:24:55 -0000
Received: (qmail 17716 invoked by alias); 1 May 2001 17:24:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14189
Received: (qmail 17702 invoked from network); 1 May 2001 17:24:49 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
Date: Tue, 1 May 2001 21:24:46 +0400 (MSD)
From: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
X-X-Sender:  <bor@itsrm2.mow.siemens.ru>
To: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: Termcap saga
In-Reply-To: <Tc0a88d01534069d8da@mailsweeper01.cambridgesiliconradio.com>
Message-ID: <Pine.SV4.4.33.0105012119290.27756-100000@itsrm2.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Tue, 1 May 2001, Peter Stephenson wrote:

> After updating and reconfiguring from scratch on cygwin with
> --disable-dynamic I now get
>
> Modules/termcap.o(.text+0xad): undefined reference to `_imp__tgetnum'
> Modules/termcap.o(.text+0xf1): undefined reference to `_imp__tgetflag'
> Modules/termcap.o(.text+0x134): undefined reference to `_imp__tgetstr'
> Modules/termcap.o(.text+0x27c): undefined reference to `_imp__tputs'
> Modules/termcap.o(.text+0x2ff): undefined reference to `_imp__tgoto'
> Modules/termcap.o(.text+0x30d): undefined reference to `_imp__tputs'
> Modules/termcap.o(.text+0x594): undefined reference to `_imp__tgetnum'
> Modules/termcap.o(.text+0x5e1): undefined reference to `_imp__tgetflag'
> Modules/termcap.o(.text+0x654): undefined reference to `_imp__tgetstr'
> Modules/termcap.o(.text+0xd0f): undefined reference to `_imp__tgetflag'
> Modules/termcap.o(.text+0xdb7): undefined reference to `_imp__tgetnum'
> Modules/termcap.o(.text+0xe42): undefined reference to `_imp__tgetstr'
>
> What do I do about this?  The link line is
>
> gcc -g   -o zsh.exe main.o zsh.res.o `cat stamp-modobjs`   -ltermcap -lm -L/g/bc01/bc01/devHost/HostStack -lzframe -lc
>
> (the extra library I added is irrelevant here).  Somehow the termcap module
> seems to think it has to import the symbols, which in this case it doesn't.

Well, on Monday I recompiled on cygwin, but without --disable-synamic. The
above symbols look O.K. to me - they belong to termcap (IIRC terminfo
versions are called tigetnum etc). What version of Cygwin and utilities
are you using?


> config.modules has
>
> name=zsh/termcap modfile=Src/Modules/termcap.mdd link=static auto=yes load=yes
> name=zsh/terminfo modfile=Src/Modules/terminfo.mdd link=static auto=yes load=yes
>

Unless you forced ncurses, it should not link terminfo. It did not in my
case (yesterday). But I did not do clean reconfigure - just make in build
directory (it did run config.status --recheck). I will be able to check on
Thursday.

> I haven't been following all this closely enough to see where the problem
> might be.  Should terminfo really be being linked if curses isn't in use?
>

No. I repeat, it did not (until recently) for me. But the above does not
look like terminfo stuff.

-andrej

