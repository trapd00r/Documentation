From zsh-workers-return-27687-mason-zsh=primenet.com.au@zsh.org Mon Feb 08 11:24:07 2010
Return-Path: <zsh-workers-return-27687-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22967 invoked by alias); 8 Feb 2010 11:24:07 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27687
Received: (qmail 5714 invoked from network); 8 Feb 2010 11:24:04 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-3.0 required=5.0 tests=AWL,BAYES_00,
	RCVD_IN_DNSWL_LOW,SPF_HELO_PASS autolearn=ham version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at csr.com does not designate permitted sender hosts)
Date: Mon, 8 Feb 2010 10:50:12 +0000
From: Peter Stephenson <pws@csr.com>
To: Roy Marples <roy@NetBSD.org>
Cc: zsh-workers@zsh.org
Subject: Re: termcap/terminfo includes
Message-ID: <20100208105012.6417d49d@news01>
In-Reply-To: <4B6EA9B1.4030001@NetBSD.org>
References: <4B6EA9B1.4030001@NetBSD.org>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 08 Feb 2010 10:50:12.0202 (UTC) FILETIME=[7D361CA0:01CAA8AC]
X-Scanned-By: MailControl A-09-22-10 (www.mailcontrol.com) on 10.71.1.141
Status: RO
X-Status: A
Content-Length: 1521
Lines: 31

On Sun, 07 Feb 2010 11:53:21 +0000
Roy Marples <roy@NetBSD.org> wrote:
> NetBSD recently gained terminfo and zsh is now failing to build.
> The exact error is due to a zsh definition vs our curses.h underscore() 
> function.
> 
> Looking through the code, I see no reason why either termcap or terminfo 
> code should include curses header as no curses calls are made.
> Also, it is an unsafe assumption that either curses.h or term.h pulls in 
> termcap.h for the function decs.

Nothing is a safe assumption with the terminal headers, which took years to
get to compile cleanly on multiple systems with very different interactions
between the headers.  The result isn't logical but without actually trying
changes on heaps of systems (which I don't have access to) we're stuck with
that.  In particular removing lots of #ifdef tests for things probed by
configure isn't safe.

Please could you send a minimal change to fix your problem?  A generic
solution is obviously better (though fraught for the reasons above) but
we'll certainly make do with a system-specific test.

Thanks.

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

