From pws@ibmth.df.unipi.it Wed Jul 14 16:48:00 1999
Message-Id: <9907120826.AA26606@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: PATCH: pws-25: final completion things
Date: Mon, 12 Jul 1999 10:26:45 +0200
From: Peter Stephenson <pws@ibmth.df.unipi.it>
Status: RO

I was doing a final sort out of completion before 3.1.6-test-1, and came
across these.  compinstall should add the directory to the end of $fpath,
like compinit now does, so that functions can be overridden; and what
happened to _use_lo and _history_complete_word?  I don't remember removing
them deliberately.

--- Completion/Commands/_history_complete_word.cx	Mon Jul 12 10:15:52 1999
+++ Completion/Commands/_history_complete_word	Mon Jul 12 10:15:47 1999
@@ -0,0 +1,2 @@
+#compdef -k complete-word \e/
+compgen -Q -H 0 ''
--- Completion/Core/compinstall.cx	Sat Jul  3 13:04:47 1999
+++ Completion/Core/compinstall	Mon Jul 12 10:24:56 1999
@@ -136,7 +136,7 @@
 
 # Check if this is in fpath already, else put it there (with ~'s expanded).
 _ci_f=${~_ci_fdir}
-[[ -z ${fpath[(r)$_ci_f]} ]] && fpath=($_ci_f $fpath)
+[[ -z ${fpath[(r)$_ci_f]} ]] && fpath=($fpath $_ci_f)
 
 # Contract $HOME to ~ in the parameter to be used for writing.
 _ci_fdir=${_ci_fdir/#$HOME/\~}
@@ -183,7 +183,7 @@
 fi
 
 _ci_lines="${_ci_lines}_compdir=$_ci_fdir
-[[ -z \$fpath[(r)\$_compdir] ]] && fpath=(\$_compdir \$fpath)
+[[ -z \$fpath[(r)\$_compdir] ]] && fpath=(\$fpath \$_compdir)
 autoload -U compinit
 compinit"
 [[ $_ci_dtype != standard ]] && _ci_lines="${_ci_lines} $_ci_dumpfile"
--- Completion/User/_use_lo.cx	Mon Jul 12 10:16:14 1999
+++ Completion/User/_use_lo	Mon Jul 12 10:16:04 1999
@@ -0,0 +1,10 @@
+#compdef gls gdiff
+
+# This is for GNU-like commands which understand the --help option,
+# but which do not otherwise require special completion handling.
+
+if [[ $PREFIX = --* ]]; then
+  _long_options
+else
+  _default
+fi
--- Doc/Zsh/compsys.yo.cx	Mon Jul 12 09:49:19 1999
+++ Doc/Zsh/compsys.yo	Mon Jul 12 10:23:58 1999
@@ -846,6 +846,9 @@
 tt(expandword_substitute) key if defined overrides the
 tt(expand_substitute) key.
 )
+item(tt(_history_complete_word) (\e/))(
+Complete words from the shell's command history.
+)
 item(tt(_most_recent_file (^Xm)))(
 Complete the name of the most recently modified file matching the pattern
 on the command line (which may be blank).  If given a numeric argument

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

