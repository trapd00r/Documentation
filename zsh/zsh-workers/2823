From zsh-workers-request@euclid.skiles.gatech.edu Mon Jan 27 21:24:34 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 22846 invoked from network); 27 Jan 1997 21:24:33 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 27 Jan 1997 21:24:33 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id QAA04351; Mon, 27 Jan 1997 16:16:13 -0500 (EST)
Resent-Date: Mon, 27 Jan 1997 16:16:13 -0500 (EST)
Message-Id: <m0voxzo-000X3aC@lorelei.approve.se>
From: hoh@approve.se (Goran Larsson)
Subject: time builtin
To: zsh-workers@math.gatech.edu
Date: Mon, 27 Jan 1997 21:49:40 +0100 (MET)
X-Mailer: ELM [version 2.4 PL23]
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
Resent-Message-ID: <"xE7_B3.0.w31.SiHxo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2823
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

I just observed this broken behaviour in 3.0.0 and 3.1.0.
The real time reported by builtin time (%E) is almost
always less than %U + %S. A quick test shows that this
behaviour is not present in 2.6-beta13.

Now printtime() in 2.6-beta13 had this code:

    if (percent > 100)
        percent = 100;   /* just to make it look right */

but that was removed in 3.0.0. Reinserting those two lines
in 3.0.0 obviously ``fixes'' the problem, or perhaps it is
more accurate to say that it hides the real problem again.

Is it possible to fix this, or are the times here just to
close to the resolution provided by the kernel?

$ echo $ZSH_VERSION
3.0.0
$ echo $OSTYPE
sunos4.1.4
$ echo $TIMEFMT
%*E real  %*U user  %*S system  %P (%J)
$ 
$ time ls
adapter.gif     hpdat
0.048 real  0.017 user  0.033 system  103% (ls)
adapter.gif     hpdat
$ time ls
adapter.gif     hpdat
0.001 real  0.000 user  0.017 system  2810% (ls)
$ time ls
adapter.gif     hpdat
0.048 real  0.017 user  0.033 system  103% (ls)
$ time ls
adapter.gif     hpdat
0.001 real  0.017 user  0.000 system  2692% (ls)
$ time ls
adapter.gif     hpdat
0.021 real  0.033 user  0.017 system  236% (ls)
$ time ls
adapter.gif     hpdat
0.001 real  0.000 user  0.033 system  5555% (ls)
$ time ls
adapter.gif     hpdat
0.035 real  0.000 user  0.033 system  93% (ls)
$ time ls
adapter.gif     hpdat
0.001 real  0.000 user  0.017 system  2741% (ls)
$ 

-- 
 Goran Larsson                mailto:hoh @ approve . se
 I was an atheist,            http://home1.swipnet . se/%7Ew-12153/
 until I found out I was God.

