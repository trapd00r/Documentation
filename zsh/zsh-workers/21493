From zsh-workers-return-21493-mason-zsh=primenet.com.au@sunsite.dk Tue Jul 19 08:55:42 2005
Return-Path: <zsh-workers-return-21493-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12171 invoked from network); 19 Jul 2005 08:55:40 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 19 Jul 2005 08:55:40 -0000
Received: (qmail 61384 invoked from network); 19 Jul 2005 08:55:34 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 19 Jul 2005 08:55:34 -0000
Received: (qmail 4982 invoked by alias); 19 Jul 2005 08:55:31 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21493
Received: (qmail 4972 invoked from network); 19 Jul 2005 08:55:30 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 19 Jul 2005 08:55:30 -0000
Received: (qmail 61119 invoked from network); 19 Jul 2005 08:55:30 -0000
Received: from master.altlinux.ru (HELO master.altlinux.org) (62.118.250.235)
  by a.mx.sunsite.dk with SMTP; 19 Jul 2005 08:55:26 -0000
Received: from solemn.turbinal.org (localhost.localdomain [127.0.0.1])
	by master.altlinux.org (Postfix) with ESMTP id 06AABE4998
	for <zsh-workers@sunsite.dk>; Tue, 19 Jul 2005 12:55:24 +0400 (MSD)
Received: by solemn.turbinal.org (Postfix, from userid 500)
	id 14C028CF01; Tue, 19 Jul 2005 12:54:29 +0400 (MSD)
Date: Tue, 19 Jul 2005 12:54:29 +0400
From: Alexey Tourbin <at@altlinux.ru>
To: zsh-workers@sunsite.dk
Subject: Re: recent zsh-4.3.0 snapshot hangs
Message-ID: <20050719085429.GA24898@solemn.turbinal.org>
Mail-Followup-To: zsh-workers@sunsite.dk
References: <20050718084900.GZ3337@solemn.turbinal.org> <20050718092122.GB3337@solemn.turbinal.org> <200507180947.j6I9lToX020826@news01.csr.com> <20050718101756.GD3337@solemn.turbinal.org> <1050718152936.ZM5991@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="WIyZ46R2i8wDzkSu"
Content-Disposition: inline
In-Reply-To: <1050718152936.ZM5991@candle.brasslantern.com>
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-0.9 required=5.0 tests=AWL,BAYES_20 autolearn=ham 
	version=3.0.4


--WIyZ46R2i8wDzkSu
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Mon, Jul 18, 2005 at 03:29:36PM +0000, Bart Schaefer wrote:
> On Jul 18,  2:17pm, Alexey Tourbin wrote:
> }
> } Here is strace log for HOSTNAME=3D`/bin/hostname`:
> }=20
> } pause(
>=20
> What platform is this?  (Linux, but can you be more specific?  Is it
> multiprocessor or otherwise using an SMP kernel?)

$ uname -rms
Linux 2.4.20-alt7-up i686
$ rpm -q glibc
glibc-2.3.3.200406160000-alt1
$

> Unless your config.h defines BROKEN_POSIX_SIGSUSPEND, there's only
> one call to pause() in the sources, in signal_suspend().

One important thing I didn't realize until now: the whole build process
was run under strace(1).  (Don't ask me why.  (In short, this was
build-time dependency analysis.))

So I tend to blame strace now, since it does some clever mangling
which affects process control behaviour, which in turn could affect
configure tests:

	If the parent process decides to wait(2) for a child
	that  is  currently  being  traced,  it is suspended
	until an appropriate child process either terminates
	or  incurs a signal that would cause it to terminate
	(as determined from the child's current signal  dis-
	position).

Now I'm trying to find out the exact reason.

--WIyZ46R2i8wDzkSu
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFC3L/FfBKgtDjnu0YRAkZ7AKDBunm7krJnjz8hvG/WA3oHaw0NXgCdHXuY
BvboUu/X0yTmu0QNHq6u3mE=
=447v
-----END PGP SIGNATURE-----

--WIyZ46R2i8wDzkSu--

