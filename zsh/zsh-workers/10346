From zsh-workers-return-10346-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Mar 31 04:49:06 2000
Return-Path: <zsh-workers-return-10346-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16172 invoked from network); 31 Mar 2000 04:49:01 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 31 Mar 2000 04:49:01 -0000
Received: (qmail 8689 invoked by alias); 31 Mar 2000 04:48:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10346
Received: (qmail 8670 invoked from network); 31 Mar 2000 04:48:40 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000331044833.ZM10292@candle.brasslantern.com>
Date: Fri, 31 Mar 2000 04:48:33 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Test of whether to rebuild zshpaths.h in zsh.mdd
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

There's code in zsh.mdd that constructs zshpaths.h.tmp and then compares
it to zshpaths.h, to avoid rebuilding zshpaths.h if the configuration
appears not to have changed.

I don't think that extra test is necessary any longer.  Other dependencies
are now handled better, so the number of cases where zshpaths.h will be
"unnecessarily" rebuilt are much fewer, and only init.c gets recompiled
(and zsh relinked) when zshpaths.h changes.

I bring this up because there are some cases where zshpaths.h does not get
rebuilt when I would prefer that it did.  I mentioned a while ago that the
"configure --prefix=something ; make ; make prefix=otherthing install"
sequence seemed to have stopped working:  I discovered that it works after
a "make clean" because that removes zshpaths.h, whereas a plain "make" may
leave zshpaths.h unchanged even if its dependencies have changed -- only
to later (unwantedly) rebuild it at install time, with the new $prefix.

Would anyone object to removing the "if cmp -s zshpaths.h zshpaths.h.tmp"
test from zsh.mdd?

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

