From zsh-workers-return-26664-mason-zsh=primenet.com.au@sunsite.dk Tue Mar 03 00:20:16 2009
Return-Path: <zsh-workers-return-26664-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20026 invoked from network); 3 Mar 2009 00:20:03 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Mar 2009 00:20:03 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 60242 invoked from network); 3 Mar 2009 00:19:55 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Mar 2009 00:19:55 -0000
Received: (qmail 22947 invoked by alias); 3 Mar 2009 00:19:49 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26664
Received: (qmail 22931 invoked from network); 3 Mar 2009 00:19:48 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 3 Mar 2009 00:19:48 -0000
Received: from mail-gx0-f178.google.com (mail-gx0-f178.google.com [209.85.217.178])
	by bifrost.dotsrc.org (Postfix) with ESMTP id C05DD8058F82
	for <zsh-workers@sunsite.dk>; Tue,  3 Mar 2009 01:19:43 +0100 (CET)
Received: by gxk26 with SMTP id 26so4986759gxk.21
        for <zsh-workers@sunsite.dk>; Mon, 02 Mar 2009 16:19:43 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=V45tEkii1rz1SD1VeRpZlAZerENvPs/W0G3+yuxkbvU=;
        b=xcx7aHLtoY2wroE+ks/WuN5MF5xo9PZXS6TnGQfsGJWPUDoBqoA3h5naq4aC+qwPFl
         8hlSYAdd44Himnf9QZmEEnOaGN4leEL8dQm6mbXPGkFK+YWWIN26+67n0slvIGG6orKj
         OPcTUYLgivri0s1xxva4YK/fbzX2wetUvMetE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        b=PaklQhy7qGaz7eTgCmMG0Vd+gbiQXvZtts9ywpdEdAKEPX2TtT1/CyhMHvnv8nwI+1
         V7c/mmbhPVhiTH9jM77sEX6I5saNOgQu3b64Zb1TjAPCRYinG9XFIff6U8B5A6tfxEDH
         J9SawR9G3rfe25+RS3YaRmrKvp3uqChhlDhFk=
MIME-Version: 1.0
Sender: ethersoft@gmail.com
Received: by 10.100.125.14 with SMTP id x14mr1415410anc.104.1236039582927; 
	Mon, 02 Mar 2009 16:19:42 -0800 (PST)
Date: Mon, 2 Mar 2009 19:19:42 -0500
X-Google-Sender-Auth: fbddf86062aa8347
Message-ID: <20a807210903021619h2b045423s641d4c69aa75cbfd@mail.gmail.com>
Subject: New D01 test failure
From: Vin Shelton <acs@alumni.princeton.edu>
To: Zsh hackers list <zsh-workers@sunsite.dk>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: ClamAV 0.92.1/9061/Mon Mar  2 10:28:18 2009 on bifrost
X-Virus-Status: Clean

Greetings!

With today's CVS update:

P ChangeLog
P Completion/Unix/Command/_django
P Completion/Unix/Command/_gnupod
P Doc/Zsh/builtins.yo
P Doc/Zsh/calsys.yo
P Doc/Zsh/prompt.yo
P Src/builtin.c
P Src/utils.c

I'm seeing a new failure in the prompt expansion test.  This is on a
kubuntu 8.4 fully updated x86 system.

Details below.

Regards,
  Vin

Running test: Dates produced by prompt escapes
ZTST_test: expecting status: 0
Input: /tmp/zsh.ztst.in.22378, output: /tmp/zsh.ztst.out.22378, error:
/tmp/zsh.ztst.terr.22378
ZTST_execchunk: status 0
ZTST_test: test produced standard output:
Date `03/2/09' is not in the form `DD/MM/YYYY'
Date `09-03-2' is not in the form `YY-MM-DD'
ZTST_test: and standard error:
(eval):14: bad math expression: operand expected at `'
(eval):14: bad math expression: operand expected at `!= 2 '
*** /tmp/zsh.ztst.out.22378     Mon Mar  2 19:16:04 2009
--- /tmp/zsh.ztst.tout.22378    Mon Mar  2 19:16:04 2009
***************
*** 0 ****
--- 1,2 ----
+ Date `03/2/09' is not in the form `DD/MM/YYYY'
+ Date `09-03-2' is not in the form `YY-MM-DD'
Test /opt/src/zsh-2009-03-02/Test/D01prompt.ztst failed: output
differs from expected as shown above for:
  LC_ALL=C
  date1=$(print -P %w)
  date2=$(print -P %W)
  date3=$(print -P %D)
  if [[ $date1 != [A-Z][a-z][a-z][[:blank:]]##[0-9]## ]]; then
    print "Date \`$date1' is not in the form \`Day DD' (e.g. \`Mon 1'"
  fi
  if [[ $date2 != [0-9][0-9]/[0-9][0-9]/[0-9][0-9] ]]; then
    print "Date \`$date2' is not in the form \`DD/MM/YYYY'"
  fi
  if [[ $date3 != [0-9][0-9]-[0-9][0-9]-[0-9][0-9] ]]; then
    print "Date \`$date3' is not in the form \`YY-MM-DD'"
  fi
  if (( $date1[5,-1] != $date2[4,5] )) || (( $date2[4,5] != $date3[7,8] ))
  then
    print "Days of month do not agree in $date1, $date2, $date3"
  fi
  if (( $date2[1,2] != $date3[4,5] )); then
    print "Months do not agree in $date2, $date3"
  fi
  if (( $date2[7,8] != $date3[1,2] )); then
    print "Years do not agree in $date2, $date3"
  fi
Error output:
(eval):14: bad math expression: operand expected at `'
(eval):14: bad math expression: operand expected at `!= 2 '
Was testing: Dates produced by prompt escapes
/opt/src/zsh-2009-03-02/Test/D01prompt.ztst: test failed.

