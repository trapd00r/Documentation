From zsh-workers-return-26483-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 29 16:24:32 2009
Return-Path: <zsh-workers-return-26483-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9443 invoked from network); 29 Jan 2009 16:24:28 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 Jan 2009 16:24:28 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 45689 invoked from network); 29 Jan 2009 16:24:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 Jan 2009 16:24:23 -0000
Received: (qmail 3128 invoked by alias); 29 Jan 2009 16:24:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26483
Received: (qmail 3111 invoked from network); 29 Jan 2009 16:24:19 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 29 Jan 2009 16:24:19 -0000
Received: from cork.scru.org (cork.scru.org [209.20.67.2])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id CFEF880271F0
	for <zsh-workers@sunsite.dk>; Thu, 29 Jan 2009 17:24:02 +0100 (CET)
Received: by cork.scru.org (Postfix, from userid 1000)
	id 36E7C1040D5; Thu, 29 Jan 2009 16:24:00 +0000 (UTC)
Date: Thu, 29 Jan 2009 16:24:00 +0000
From: Clint Adams <clint@zsh.org>
To: Doug Kearns <dougkearns@gmail.com>
Cc: zsh-workers@sunsite.dk
Subject: Re: PATCH: update Cygwin completion functions
Message-ID: <20090129162400.GA9247@scru.org>
Mail-Followup-To: Doug Kearns <dougkearns@gmail.com>,
	zsh-workers@sunsite.dk
References: <20090124135312.GA3724@rosie> <20090125133900.GA27779@scru.org> <644fc65e0901260006k71316a33q361e32bd3cd2e947@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <644fc65e0901260006k71316a33q361e32bd3cd2e947@mail.gmail.com>
User-Agent: Mutt/1.5.18 (2008-05-17)
X-Virus-Scanned: ClamAV 0.92.1/8919/Thu Jan 29 14:05:38 2009 on bifrost
X-Virus-Status: Clean

On Mon, Jan 26, 2009 at 07:06:33PM +1100, Doug Kearns wrote:
> % setfacl --version
> setfacl (cygwin) 1.13
> ACL Modification Utility
> Copyright 2000, 2001, 2002 Red Hat, Inc.
> Compiled on Jun 12 2008

Thanks.

Index: Completion/Unix/Command/_getfacl
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_getfacl,v
retrieving revision 1.3
diff -u -r1.3 _getfacl
--- Completion/Unix/Command/_getfacl	29 Jan 2009 16:06:48 -0000	1.3
+++ Completion/Unix/Command/_getfacl	29 Jan 2009 16:23:20 -0000
@@ -1,7 +1,7 @@
 #compdef getfacl getfacl.exe
 
+if _pick_variant cygwin=cygwin unix --version; then
 # cygwin 1.5.25
-
 _arguments -s -S \
   '(--all -a)'{-a,--all}'[display the filename, owner, group, and ACL of the file]' \
   '(--dir -d)'{-d,--dir}'[display the filename, owner, group, and default ACL of the directory]' \
@@ -9,3 +9,20 @@
   '(- *)'{-h,--help}'[display help information]' \
   '(- *)'{-v,--version}'[display version information]' \
   '*: :_files'
+else
+_arguments -s -S \
+  '--access[display the file access control list only]' \
+  '(-d --default)'{-d,--default}'[display the default access control list only]' \
+  '--omit-header[do not display the comment header]' \
+  '--all-effective[print all effective rights]' \
+  '--no-effective[print no effective rights] '\
+  '--skip-base[skip files that only have the base entries]' \
+  '(-R --recursive)'{-R,--recursive}'[recurse into subdirectories]' \
+  '(-L --logical)'{-L,--logical}'[logical walk, follow symbolic links]' \
+  '(-P --physical)'{-P,--physical}'[physical walk, do not follow symbolic links]' \
+  '--tabular[use tabular output format]' \
+  '--numeric[print numeric user/group identifiers]' \
+  '--absolute-names[don'"'"'t strip leading '"'"'/'"'"' in pathnames' \
+  '--version[print version and exit]' \
+  '--help[this help text]'
+fi
Index: Completion/Unix/Command/_setfacl
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_setfacl,v
retrieving revision 1.1
diff -u -r1.1 _setfacl
--- Completion/Unix/Command/_setfacl	29 Jan 2009 16:02:54 -0000	1.1
+++ Completion/Unix/Command/_setfacl	29 Jan 2009 16:23:20 -0000
@@ -1,7 +1,7 @@
 #compdef setfacl setfacl.exe
 
+if _pick_variant cygwin=cygwin unix --version; then
 # cygwin 1.5.25
-
 _arguments -s -S \
   '(-d, --delete)'{-d,--delete}'[delete one or more specified ACL entries]:ACL entry:' \
   '(-f, --file)'{-f,--file}'[set ACL entries for FILE to ACL entries read from a ACL_FILE]:ACL file:_files' \
@@ -11,3 +11,24 @@
   '(- *)'{-h,--help}'[output usage information and exit]' \
   '(- *)'{-v,--version}'[output version information and exit]' \
   '*: :_files'
+else
+_arguments -s -S \
+  '(-m --modify)'{-m,--modify=}'[modify the current ACL]:ACL:' \
+  '(-M --modify-file)'{-M,--modify-file=}'[read ACL entries to modify from file]:file:_files' \
+  '(-x --remove)'{-x,--remove=}'[remove ACL entries]:ACL:' \
+  '(-X --remove-file)'{-X,--remove-file=}'[read ACL entries to remove from file]:file:_files' \
+  '(-b --remove-all)'{-b,--remove-all}'[remove all extended ACL entries]' \
+  '(-k --remove-default)'{-k,--remove-default}'[remove the default ACL]' \
+  '--set=[set the ACL, replacing the current ACL]:ACL:' \
+  '--set-file=[read ACL entries to set from file]:file:_files' \
+  '--mask[do recalculate the effective rights mask]' \
+  '(-n --no-mask)'{-n,--no-mask}'[don'"'"'t recalculate the effective rights mask]' \
+  '(-d --default)'{-d,--default}'[operations apply to the default ACL]' \
+  '(-R --recursive)'{-R,--recursive}'[recurse into subdirectories]' \
+  '(-L --logical)'{-L,--logical}'[logical walk, follow symbolic links]' \
+  '(-P --physical)'{-P,--physical}'[physical walk, do not follow symbolic links]' \
+  '--restore=[restore ACLs]:file:_files' \
+  '--test[test mode (ACLs are not modified)]' \
+  '--version[print version and exit]' \
+  '--help[this help text]'
+fi

