From zsh-users-return-3130-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 08 03:00:45 2000
Return-Path: <zsh-users-return-3130-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26983 invoked from network); 8 Jun 2000 03:00:44 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Jun 2000 03:00:44 -0000
Received: (qmail 4798 invoked by alias); 8 Jun 2000 03:00:24 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3130
Received: (qmail 4685 invoked from network); 8 Jun 2000 03:00:00 -0000
To: zsh-users@sunsite.auc.dk
Subject: Re: 3.1.9, bug in apt-get completion?
References: <87og5d2mvp.fsf@cenderis.demon.co.uk>
MIME-Version: 1.0 (generated by SEMI 1.13.7 - "Awazu")
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@m17n.org>
Date: 08 Jun 2000 12:00:08 +0900
In-Reply-To: <87og5d2mvp.fsf@cenderis.demon.co.uk>
 (Bruce Stephens's message of "07 Jun 2000 22:37:46 +0100")
Message-ID: <hvod7lsg9mv.fsf@serein.m17n.org>
Lines: 45
User-Agent: T-gnus/6.14.1 (based on Gnus v5.8.3) (revision 16) SEMI/1.13.7 (Awazu) FLIM/1.13.2 (Kasanui) Emacs/20.6 (i686-pc-linux-gnu) MULE/4.0 (HANANOEN)

In article <87og5d2mvp.fsf@cenderis.demon.co.uk>,
  Bruce Stephens <bruce+zsh@cenderis.demon.co.uk> writes:

> # exec zsh -f    
> # autoload -U compinit
> # compinit
> # apt-get install a<TAB>
> _alternative:-1: parse error near `||'
> _alternative:70: command not found: _

Following patch should fix it.

Index: Completion/Debian/_apt
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Debian/_apt,v
retrieving revision 1.6
diff -u -r1.6 _apt
--- Completion/Debian/_apt	2000/05/19 08:26:48	1.6
+++ Completion/Debian/_apt	2000/06/08 02:57:22
@@ -371,7 +371,7 @@
     -- \
     /$'update\0'/ \| \
     /$'upgrade\0'/ \| \
-    /$'install\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" uninstalled || _deb_packages "$expl_packages[@]" installed' \# \| \
+    /$'install\0'/ /$'[^\0]#\0'/ ':packages::{ _deb_packages "$expl_packages[@]" uninstalled || _deb_packages "$expl_packages[@]" installed }' \# \| \
     /$'remove\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" installed' \# \| \
     /$'dist-upgrade\0'/ \| \
     /$'dselect-upgrade\0'/ \| \
@@ -410,12 +410,12 @@
     /$'add\0'/ /$'[^\0]#\0'/ ':files:index files:_files "$expl[@]"' \# \| \
     /$'gencaches\0'/ \| \
     /$'showpkg\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
-    /$'stats\0'=$status[4]/ \| \
+    /$'stats\0'/ \| \
     /$'dump\0'/ \| \
     /$'dumpavail\0'/ \| \
     /$'unmet\0'/ \| \
     /$'check\0'/ \| \
-    /$'search\0'/ /$'[^\0]#\0'/ ':strings::_message "pattern"' \| \
+    /$'search\0'/ /$'[^\0]#\0'/ ':strings:pattern:' \| \
     /$'show\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
     /$'depends\0'/ \| \
     /"[]"/ ':argument-1::compadd "$expl_action[@]" help add gencaches showpkg stats dump dumpavail unmet check search show depends'
-- 
Tanaka Akira

