From zsh-workers-return-12185-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Jul 07 05:39:18 2000
Return-Path: <zsh-workers-return-12185-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19599 invoked from network); 7 Jul 2000 05:39:17 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Jul 2000 05:39:17 -0000
Received: (qmail 25372 invoked by alias); 7 Jul 2000 05:39:09 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12185
Received: (qmail 25365 invoked from network); 7 Jul 2000 05:39:08 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000707053849.ZM28504@candle.brasslantern.com>
Date: Fri, 7 Jul 2000 05:38:49 +0000
In-Reply-To: <0FX4007G6UV5CT@la-la.cambridgesiliconradio.com>
Comments: In reply to Peter Stephenson <pws@cambridgesiliconradio.com>
        "Re: Problem compiling 3.1.9 under HP-UX 10.20" (Jul  3,  6:49pm)
References: <0FX4007G6UV5CT@la-la.cambridgesiliconradio.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Peter Stephenson <pws@cambridgesiliconradio.com>,
        zsh-workers@sunsite.auc.dk (Zsh hackers list),
        Matthew Lovell <lovell@fc.hp.com>
Subject: Re: Problem compiling 3.1.9 under HP-UX 10.20
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jul 3,  6:49pm, Peter Stephenson wrote:
} Subject: Re: Problem compiling 3.1.9 under HP-UX 10.20
}
} > Hi,
} > 
} > I've gotten zsh-3.1.9 to compile on my workstation, but only by
} > excluding zftp.  The etc/MACHINES file doesn't state anything special
} > about HP-UX.
} > zftp.c:211: `h_errno' undeclared (first use in this function)
} 
} Finally I made some time to look at this.  From the information above,
} this is the best I can do.

This patch has been bothering me ever since it appeared.

} +dnl Check for h_errno external variable
} +AC_CACHE_CHECK(if we need our own h_errno,
} +  zsh_cv_decl_h_errno_use_local,
} +  [AC_TRY_LINK( ,[extern int h_errno; h_errno = 0;],
} +  zsh_cv_decl_h_errno_use_local=no,
} +  zsh_cv_decl_h_errno_use_local=yes)])

That's testing whether it's possible to *link with* h_errno; if it is,
then we conclude that we need not declare it locally.

But the problem in zftp.c is that h_errno is not *declared* at compile
time, not that it's not *defined* at link time.  That would indicate to
me that zftp.c hasn't #included the correct header file.

So I don't understand how this patch could possibly solve the problem
that was reported.  Has anybody actually tried it yet, *on HP-UX*?

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

