From zsh-workers-return-7453-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Aug 19 17:30:01 1999
Return-Path: <zsh-workers-return-7453-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25897 invoked from network); 19 Aug 1999 17:29:59 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Aug 1999 17:29:59 -0000
Received: (qmail 5118 invoked by alias); 19 Aug 1999 17:29:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7453
Received: (qmail 5110 invoked from network); 19 Aug 1999 17:29:42 -0000
Message-ID: <CDF457DA4ADAD11193E50008C724CC39043FD519@RED-MSG-10>
From: Amol Deshpande <amold@MICROSOFT.com>
To: "'zsh-workers@sunsite.auc.dk'" <zsh-workers@sunsite.auc.dk>
Subject: unmetafy_line in 3.0.5
Date: Thu, 19 Aug 1999 10:28:45 -0700
X-Mailer: Internet Mail Service (5.5.2650.14)

hi,

I got this bug report from an NT user of zsh, and looking at the code, I 
thought it might be a generic problem with 3.0.5

The reported problem was that if you had, for example,

bindky ^B reverse-menu-complete

and then did ^B on an empty line, zsh would crash on NT.

looking at the crash, it happens in ztrsub() when called from unmetafy_line.

/**/
void
unmetafy_line(void)
{
    cs = ztrsub((char *) line + cs, (char *) line);
    (void) unmetafy((char *) line, &ll);
}


When I look at the parameters, cs is -1.  Now, I don't know if this
particular
variable never becomes -1 on unix, so perhaps someone can tell me if
this is indeed a generic zsh problem or should I try to figure out how 
cs came to be -1 on an empty line ?

thanks,
-amol

