From arno@utu.fi Thu Mar 21 06:37:18 1996
Received: from euclid.skiles.gatech.edu (euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.4/8.7.3) with ESMTP id GAA02726 for <mason@werple.mira.net.au>; Thu, 21 Mar 1996 06:37:15 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id OAA11102; Wed, 20 Mar 1996 14:11:35 -0500 (EST)
Resent-Date: Wed, 20 Mar 1996 14:11:35 -0500 (EST)
Subject: Bug in zsh filename completion (bad one...)
From: Arno Hahma <arno@utu.fi>
To: zsh-workers@math.gatech.edu
Date: 	Wed, 20 Mar 1996 21:10:13 +0200 (EET)
MIME-Version: 1.0
Content-Type: 	text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7BIT
Message-Id: <96Mar20.211019+0200eet_dst.12050-25005+162@utu.fi>
Resent-Message-ID: <"q_J4Q.0.Oj2.cX5Kn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/843
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1967
Status: OR

Dear developers,

I found a pretty annoying bug in zsh-2.6-beta13, in its
filename completion. The first characters of all filenames are missing,
like this:

sol|21:02|>ls <press TAB or ctrl-d>

             amp-h.in     h_startups   local.m4     nfig.h.in    nfigure.in
ADME         angeLog      il           nctions      nfig.log     sc
STALL        artupFiles   installdirs  nfig.cache   nfig.status  stall-sh
TA-FAQ       c            kefile       nfig.guess   nfig.sub
amp-h        config.h     kefile.in    nfig.h       nfigure

This should be:

ChangeLog       Makefile        Util/           config.h.in     install-sh*
Doc/            Makefile.in     acconfig.h      config.log      mkinstalldirs*
Etc/            Misc/           aclocal.m4      config.status*  stamp-h
Functions/      README          config.cache    config.sub*     stamp-h.in
INSTALL         Src/            config.guess*   configure*      zsh_startups
META-FAQ        StartupFiles/   config.h        configure.in

The same behaviour appears in all filename completion, including the
use of wildcard characters. I.e. ls * will result the same erroneous
output.

The system is Solaris 2.4 on sparc, compiled with either gcc-2.7.2 or
SunPro 3.0.1. The compiler does not have any effect, i.e. the bug is
not there.

The zsh works just fine on Solaris 2.5x86 (Intel-Solaris), the above
bug does not show up at all. Consequently, the bug is likely to be in
the Solaris-libraries (which system call?). 

There is one difference in compiling zsh on the two above systems:
Solaris 2.4 requires linking of /usr/ucblib/libucb.a or .so to get the
routine "killpg". The Solaris 2.5 has the same routine in its
/usr/lib/libc.so, not libucb.a.  However, I don't think the bug is in
the "kill process group" call ;).

It would be nice, if there was a workaround to the problem other than
updating to Solaris 2.5 ;). Well, this is going to happen anyway, some
time, but until then...

Yours,

ArNO
    2


