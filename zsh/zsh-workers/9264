From zsh-workers-return-9264-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Jan 07 14:49:24 2000
Return-Path: <zsh-workers-return-9264-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5346 invoked from network); 7 Jan 2000 14:49:22 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Jan 2000 14:49:22 -0000
Received: (qmail 2821 invoked by alias); 7 Jan 2000 14:49:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9264
Received: (qmail 2814 invoked from network); 7 Jan 2000 14:49:04 -0000
Date: Fri, 7 Jan 2000 15:49:02 +0100 (MET)
Message-Id: <200001071449.PAA23487@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: docs


My makeinfo at least can't parse a menu definition if it contains the
comments inserted by yodl. So I need to move the {start,end}menu()
from modlist.yo to modmenu.yo (and add manmodmenu.yo for manual.yo).

And is there a reason why `make clean' doesn't remove the manual files 
and the automatically created files in Doc/Zsh? If so, the last hunk
for Makefile.in shouldn't be applied.

Bye
 Sven

diff -ru ../z.old/Doc/Makefile.in ./Doc/Makefile.in
--- ../z.old/Doc/Makefile.in	Fri Jan  7 11:33:16 2000
+++ ./Doc/Makefile.in	Fri Jan  7 15:36:23 2000
@@ -67,7 +67,7 @@
 Zsh/exec.yo Zsh/expn.yo \
 Zsh/filelist.yo Zsh/files.yo Zsh/func.yo Zsh/grammar.yo Zsh/manual.yo \
 Zsh/index.yo Zsh/intro.yo Zsh/invoke.yo Zsh/jobs.yo Zsh/metafaq.yo \
-Zsh/modules.yo Zsh/modlist.yo Zsh/modmenu.yo $(MODDOCSRC) \
+Zsh/modules.yo Zsh/modlist.yo Zsh/modmenu.yo Zsh/manmodmenu.yo $(MODDOCSRC) \
 Zsh/options.yo Zsh/params.yo Zsh/prompt.yo Zsh/redirect.yo Zsh/restricted.yo \
 Zsh/seealso.yo Zsh/zftpsys.yo Zsh/zle.yo
 
@@ -178,9 +178,7 @@
 		echo ")"; \
 	    done; \
 	    echo "enditem()"; \
-	    echo "startmenu()"; \
 	    echo "includefile(Zsh/modmenu.yo)"; \
-	    echo "endmenu()"; \
 	    set '' $(MODDOCSRC); \
 	    unset mod1 mod2 mod3; \
 	    test ".$$2" != . && \
@@ -200,12 +198,22 @@
 
 Zsh/modmenu.yo: $(MODDOCSRC)
 	( \
+	    echo "startmenu()"; \
 	    for modfile in $(MODDOCSRC); do \
 		sed -n '1{s|^COMMENT(!MOD!\(.*\)$$|menu(The \1 Module)|;p;q;}' \
 		    < $(sdir)/$$modfile; \
-	    done \
+	    done; \
+	    echo "endmenu()" \
 	) > $(sdir)/Zsh/modmenu.yo
 
+Zsh/manmodmenu.yo: $(MODDOCSRC)
+	( \
+	    for modfile in $(MODDOCSRC); do \
+		sed -n '1{s|^COMMENT(!MOD!\(.*\)$$|menu(The \1 Module)|;p;q;}' \
+		    < $(sdir)/$$modfile; \
+	    done \
+	) > $(sdir)/Zsh/manmodmenu.yo
+
 # ========== DEPENDENCIES FOR INSTALLING ==========
 
 # install just installs the manual pages
@@ -278,6 +286,7 @@
 	rm -f *.aux *.cp *.cps *.fn *.fns *.ky *.log
 	rm -f *.pg *.pgs *.toc *.tp *.tps *.vr *.vrs
 	rm -rf infodir
+	rm -f *.1 Zsh/modlist.yo Zsh/modmenu.yo Zsh/manmodmenu.yo
 .PHONY: clean-here
 
 distclean-here: clean-here
diff -ru ../z.old/Doc/Zsh/manual.yo Doc/Zsh/manual.yo
--- ../z.old/Doc/Zsh/manual.yo	Fri Jan  7 11:33:13 2000
+++ Doc/Zsh/manual.yo	Fri Jan  7 15:34:34 2000
@@ -115,7 +115,7 @@
 
 Zsh Modules
 
-includefile(Zsh/modmenu.yo)
+includefile(Zsh/manmodmenu.yo)
 endmenu()
 texinode(The Z Shell Manual)(Introduction)(Top)(Top)
 chapter(The Z Shell Manual)

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

