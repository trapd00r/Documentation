From zsh-users-return-12376-mason-zsh=primenet.com.au@sunsite.dk Sat Dec 29 19:08:27 2007
Return-Path: <zsh-users-return-12376-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18164 invoked from network); 29 Dec 2007 19:08:18 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 Dec 2007 19:08:18 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 67539 invoked from network); 29 Dec 2007 19:07:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 Dec 2007 19:07:59 -0000
Received: (qmail 19782 invoked by alias); 29 Dec 2007 19:07:51 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12376
Received: (qmail 19766 invoked from network); 29 Dec 2007 19:07:50 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 29 Dec 2007 19:07:50 -0000
Received: from virusfilter.dotsrc.org (bifrost [127.0.0.1])
	by spamfilter.dotsrc.org (Postfix) with ESMTP id 6A6B48058F9A
	for <zsh-users@sunsite.dk>; Sat, 29 Dec 2007 20:07:48 +0100 (CET)
Received: from vms173003pub.verizon.net (vms173003pub.verizon.net [206.46.173.3])
	by bifrost.dotsrc.org (Postfix) with ESMTP
	for <zsh-users@sunsite.dk>; Sat, 29 Dec 2007 20:07:48 +0100 (CET)
Received: from torch.brasslantern.com ([71.121.18.67])
 by vms173003.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0JTT008Y7RQ5RFS3@vms173003.mailsrvcs.net> for
 zsh-users@sunsite.dk; Sat, 29 Dec 2007 13:06:06 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id lBTJ7jOQ007697	for
 <zsh-users@sunsite.dk>; Sat, 29 Dec 2007 11:07:45 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id lBTJ7ist007696	for zsh-users@sunsite.dk; Sat,
 29 Dec 2007 11:07:44 -0800
Date: Sat, 29 Dec 2007 11:07:44 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: a simple translation to tcsh?
In-reply-to: <F15AB67F-BB03-4177-8F34-1122A92F4B8F@chemistry.ucsc.edu>
To: zsh-users@sunsite.dk
Message-id: <071229110744.ZM7695@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <F15AB67F-BB03-4177-8F34-1122A92F4B8F@chemistry.ucsc.edu>
Comments: In reply to William Scott <wgscott@chemistry.ucsc.edu>
 "a simple translation to tcsh?" (Dec 28,  3:59pm)
X-Virus-Scanned: ClamAV using ClamSMTP

On Dec 28,  3:59pm, William Scott wrote:
} Subject: a simple translation to tcsh?
}
} I use the conditional test
} 
} [[  $(sw_vers -productVersion) < 10.5  ]]
} 
} on Mac OS X to test whether the current OS version (in my case 10.5.1)  
} is 10.4.11 or earlier. This takes advantage of a property of zsh that  
} I haven't figured out how to replicate in a tcsh script.

This is just a string comparison.  If the left side was, say, 9.3 instead
of 10.4.something, your test would fail because "9" is lexically greater
than "1".  That's probably fine because the odds of any MacOS prior to
OSX running zsh are pretty small, but note that [[ 10.10 < 10.5 ]] is
also true because "1" is lexically less than "5", so you're going to be
in trouble eventually.

What you really need is

    autoload -U is-at-least
    if is-at-least 10.5 $(sw_vers -productVersion) ; then
 
} Is there a simple way to do this, as it is a small nightmare to  
} implement as an arithmetic test.

The is-at-least function is only about 15 lines long (not counting the
large comment block at the top) and if you don't try to handle the odd
version strings that contain hyphens it should be possible to translate
it into tcsh and run it as a script.  Or you could leave it as a zsh
script, put it in one of your $path directories, and run it from tcsh ...

