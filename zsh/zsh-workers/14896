From zsh-workers-return-14896-mason-zsh=primenet.com.au@sunsite.dk Wed Jun 13 10:33:04 2001
Return-Path: <zsh-workers-return-14896-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2127 invoked from network); 13 Jun 2001 10:32:59 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Jun 2001 10:32:59 -0000
Received: (qmail 20010 invoked by alias); 13 Jun 2001 10:32:25 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14896
Received: (qmail 19983 invoked from network); 13 Jun 2001 10:32:25 -0000
Sender: kiddleo
Message-ID: <3B27414D.23F93922@u.genie.co.uk>
Date: Wed, 13 Jun 2001 11:32:45 +0100
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.2.15 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: zsh-workers@sunsite.dk
Subject: Re: 4.0.1: menucomplete quirk leaving extra characters behind
References: <20010612153701.A20639@lizzy.bugworks.com> <010612171703.ZM24869@candle.brasslantern.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Bart Schaefer wrote:
> 
> > (Btw, on Solaris the characters are ``!='' instead.)
> 
> I keep on hitting TAB I see #= and $= and *=.  This is actually a bug, I
> guess, because those parameters are read-only and so you shouldn't be able
> to complete them on the left side of an assignment, but menucompletion is

Yes, it is arguably a bug, though not hard to fix. This will still offer
@= and *= because they are not readonly but you can't assign to them
this way. I'll commit this to the stable branch later unless anyone
objects.

> Ah; you (may) want
>       zstyle ':completion:*' insert-tab true

I use this:
zstyle -e ':completion:*:*:-command-:*' tag-order '
    [[ -n $PREFIX$SUFFIX || $1 = messages ]] || 
        { reply=( - ); _message "not with an empty word" }'

which has the advantage of working in other places where commands are
completed such as after noglob. It depends on why you don't want
completion at that position - I don't because it tends to be slow with
several thousand commands.

Oliver

Index: Completion/Zsh/Type/_command_names
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_command_names,v
retrieving revision 1.1
diff -u -r1.1 _command_names
--- Completion/Zsh/Type/_command_names  2001/04/02 11:17:31     1.1
+++ Completion/Zsh/Type/_command_names  2001/06/13 10:28:19
@@ -22,7 +22,7 @@
     'aliases:alias:compadd -k aliases'
     'reserved-words:reserved word:compadd -k reswords'
     'jobs:: _jobs -t'
-    'parameters:: _parameters -qS= -r "\n\t\- =["'
+    'parameters:: _parameters -g "^*readonly*" -qS= -r "\n\t\- =["'
   )
 fi

