From zsh-users-return-11231-mason-zsh=primenet.com.au@sunsite.dk Sat Mar 03 23:33:02 2007
Return-Path: <zsh-users-return-11231-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3401 invoked from network); 3 Mar 2007 23:32:55 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Mar 2007 23:32:55 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 49523 invoked from network); 3 Mar 2007 23:32:48 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Mar 2007 23:32:48 -0000
Received: (qmail 7250 invoked by alias); 3 Mar 2007 23:32:40 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11231
Received: (qmail 7240 invoked from network); 3 Mar 2007 23:32:39 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 3 Mar 2007 23:32:39 -0000
Received: (qmail 48166 invoked from network); 3 Mar 2007 23:32:39 -0000
Received: from mta-2.ms.rz.rwth-aachen.de (134.130.7.73)
  by a.mx.sunsite.dk with SMTP; 3 Mar 2007 23:32:33 -0000
Received: from r220-1 ([134.130.3.31]) by mta-2.ms.rz.RWTH-Aachen.de
 (Sun Java System Messaging Server 6.2-7.05 (built Sep  5 2006))
 with ESMTP id <0JEC0089YPE8L710@mta-2.ms.rz.RWTH-Aachen.de> for
 zsh-users@sunsite.dk; Sun, 04 Mar 2007 00:32:32 +0100 (CET)
Received: from relay.rwth-aachen.de ([134.130.3.1])
	by r220-1 (MailMonitor for SMTP v1.2.2 ) ; Sun,
 04 Mar 2007 00:32:32 +0100 (MET)
Received: from fsst.voodoo.lan ([212.117.84.19])
	by relay.rwth-aachen.de (8.13.7/8.13.3/1) with ESMTP id l23NWWaV005934	for
 <zsh-users@sunsite.dk>; Sun, 04 Mar 2007 00:32:32 +0100 (MET)
Received: from hawk by fsst.voodoo.lan with local (Exim 4.63)
	(envelope-from <ft@bewatermyfriend.org>)
	id 1HNdi2-0004VJ-H0	for zsh-users@sunsite.dk; Sun, 04 Mar 2007 00:32:14 +0100
Date: Sun, 04 Mar 2007 00:32:14 +0100
From: Frank Terbeck <ft@bewatermyfriend.org>
Subject: Re: auto-reflesh $PATH
In-reply-to: <c12037010703031514h2730c96te5b721188deda41d@mail.gmail.com>
To: zsh-users@sunsite.dk
Mail-followup-to: zsh-users@sunsite.dk
Message-id: <20070303233214.GE3072@fsst.voodoo.lan>
MIME-version: 1.0
Content-type: text/plain; charset=iso-8859-1
Content-transfer-encoding: 8BIT
Content-disposition: inline
Operating-System: Linux 2.6.19.2-suspend2+ipw2200 i686
References: <c12037010703031514h2730c96te5b721188deda41d@mail.gmail.com>
User-Agent: Mutt/1.5.14+cvs20070301 (2007-02-28)

Kazuhiko Uebayashi <kzhk75@gmail.com>:
> Is it possible to reflesh $PATH "automatically" in Zsh?
> If possible, what should I do?
> 
> In my environment,
>    echo $PATH
>    /home/kazu/local/bin:/usr/local/bin:/usr/bin:/bin
>    echo $path
>    /home/kazu/local/bin /usr/local/bin:/usr/bin:/bin
> 
> In Bash, I put some executable file in $PATH
> then the executable file immediately works.

Actually, new binaries, that are put into your path _will_ work
immediately. But the $PATH is not automatically re-hashed.

That is why the completion code won't find matches. And this is also,
why zsh's autocorrection feature (set correct) will try to present
"corrected" commands, instead of the one you entered.

'hash -r' rehashes the $PATH.

Yet, you are looking for something automatic.
Bart Schaefer presented a solution for this and compsys in
zsh-users #8059¹.

If you also need a solution for the autocorrection issue, it would be
possible to wrap code around the 'accept-line' zle widget, that checks
if the first word on the commandline is in ${(k)commands},
${(k)builtins} etc., and if it's not automatically issue 'hash -r' for
you.

While this won't solve every problem, it would sure catch the most
common ones.

Regards, Frank

¹ <http://www.zsh.org/mla/users/2004/msg01066.html>

-- 
In protocol design, perfection has been reached not when there is
nothing left to add, but when there is nothing left to take away.
                                                  -- RFC 1925

