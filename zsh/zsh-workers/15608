From zsh-workers-return-15608-mason-zsh=primenet.com.au@sunsite.dk Thu Aug 09 15:53:08 2001
Return-Path: <zsh-workers-return-15608-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26778 invoked from network); 9 Aug 2001 15:53:07 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 Aug 2001 15:53:07 -0000
Received: (qmail 17298 invoked by alias); 9 Aug 2001 15:52:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15608
Received: (qmail 17285 invoked from network); 9 Aug 2001 15:52:56 -0000
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <1010809155249.ZM1781@candle.brasslantern.com>
Date: Thu, 9 Aug 2001 15:52:49 +0000
In-Reply-To: <OF0FB43A3C.07298D98-ON80256AA3.00348BBA@uk.jpmorgan.com>
Comments: In reply to martin.ebourne@arcordia.com
        "Possible bug with cd completion" (Aug  9, 10:38am)
References: <OF0FB43A3C.07298D98-ON80256AA3.00348BBA@uk.jpmorgan.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: martin.ebourne@arcordia.com, zsh-workers@sunsite.dk
Subject: Re: Possible bug with cd completion
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Aug 9, 10:38am, martin.ebourne@arcordia.com wrote:
}
} This seems to be a problem with the handling of cdablevars in _cd.

Try this:

Index: Completion/Zsh/Command/_cd
===================================================================
--- Completion/Zsh/Command/_cd	2001/06/27 16:40:02	1.3
+++ Completion/Zsh/Command/_cd	2001/08/09 15:50:44
@@ -36,7 +36,7 @@
     tmpcdpath=(${${(@)cdpath:#.}:#$PWD})
 
     # With cdablevars, we can complete foo as if ~foo/
-    if [[ -o cdablevars && -n "$PREFIX" ]]; then
+    if [[ -o cdablevars && -n "$PREFIX" && "$PREFIX" != <-> ]]; then
       if [[ "$PREFIX" != */* ]]; then
         _tilde && ret=0
       else

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

