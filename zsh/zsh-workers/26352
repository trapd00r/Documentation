From zsh-workers-return-26352-mason-zsh=primenet.com.au@sunsite.dk Sun Jan 18 11:48:19 2009
Return-Path: <zsh-workers-return-26352-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3155 invoked from network); 18 Jan 2009 11:48:15 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 Jan 2009 11:48:15 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 24946 invoked from network); 18 Jan 2009 11:48:06 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 Jan 2009 11:48:06 -0000
Received: (qmail 11976 invoked by alias); 18 Jan 2009 11:48:02 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26352
Received: (qmail 11966 invoked from network); 18 Jan 2009 11:48:01 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 18 Jan 2009 11:48:01 -0000
Received: from flock1.newmail.ru (flock1.newmail.ru [82.204.219.207])
	by bifrost.dotsrc.org (Postfix) with SMTP id 623008028ACA
	for <zsh-workers@sunsite.dk>; Sun, 18 Jan 2009 12:47:58 +0100 (CET)
Received: (qmail 17781 invoked from network); 18 Jan 2009 11:47:59 -0000
Received: from unknown (HELO cooker.localnet) (arvidjaar@newmail.ru@91.77.236.30)
  by smtpd.newmail.ru with SMTP; 18 Jan 2009 11:47:59 -0000
From: Andrey Borzenkov <arvidjaar@newmail.ru>
To: zsh-workers@sunsite.dk
Subject: Re: 4.3.9: frequent crashes in completion menu selection
Date: Sun, 18 Jan 2009 14:47:52 +0300
User-Agent: KMail/1.11.0 (Linux/2.6.29-rc2-1avb; KDE/4.1.96; i686; ; )
References: <200901081526.48797.arvidjaar@newmail.ru> <200901081230.n08CUXTB010409@news01.csr.com>
In-Reply-To: <200901081230.n08CUXTB010409@news01.csr.com>
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart1353575.pNAHVgXh4e";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200901181447.54147.arvidjaar@newmail.ru>
X-Virus-Scanned: ClamAV 0.92.1/8874/Sun Jan 18 06:02:00 2009 on bifrost
X-Virus-Status: Clean

--nextPart1353575.pNAHVgXh4e
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

On 8 =D1=8F=D0=BD=D0=B2=D0=B0=D1=80=D1=8F 2009 15:30:33 Peter Stephenson wr=
ote:
> Andrey Borzenkov wrote:
> > I hit it quite often on Mandriva cooker; I do not see any obvious
> > post-4.3.9 commits dealing with crashes in this area. This usually
> > happens during menu selection browsing file system.
>
> There's probably not a cat's chance in hell of getting anywhere with
> this (given the code it affects) unless it can be reproduced easily.

The following seems to do it here:

mkdir /tmp/u{1,2}/w{1,2}
{pts/1}% zsh -f
cooker% autoload compinit; compinit
cooker% zmodload zsh/complist
cooker% zstyle ':completion:*' menu 'select=3D0'
cooker% bindkey -M menuselect "/" accept-and-infer-next-history
cooker% setopt menucomplete
cooker% zstyle ':completion:*' format Completing %d
cooker% ls /tmp/uTAB

Now you get menu selection; press two times '/' to get "Completing=20
'files'" (at /tmp/u1/w1/ line contents); now press undo (^_) until you=20
get empty line; press RETURN; press 'ls /tmp/uTAB'. Zsh crashes.

=46or some reasons crucial point is setting "format". Not only can I not=20
make it crash without this; it seems to change the undo behaviour as=20
well - pressing undo multiples times with and without "format" set=20
cycles through *different* line contents.

--nextPart1353575.pNAHVgXh4e
Content-Type: application/pgp-signature; name=signature.asc 
Content-Description: This is a digitally signed message part.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEABECAAYFAklzFuoACgkQR6LMutpd94zbPACgt7spXZTkjx4qRJL9IcamrvFh
1oQAn2OlihucAjEYbUgyB/wykum4ao4f
=WAT/
-----END PGP SIGNATURE-----

--nextPart1353575.pNAHVgXh4e--

