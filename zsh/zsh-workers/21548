From zsh-workers-return-21548-mason-zsh=primenet.com.au@sunsite.dk Fri Jul 29 19:31:41 2005
Return-Path: <zsh-workers-return-21548-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12431 invoked from network); 29 Jul 2005 19:31:38 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 Jul 2005 19:31:38 -0000
Received: (qmail 39619 invoked from network); 29 Jul 2005 19:31:32 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 Jul 2005 19:31:32 -0000
Received: (qmail 11797 invoked by alias); 29 Jul 2005 19:31:30 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21548
Received: (qmail 11788 invoked from network); 29 Jul 2005 19:31:29 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 29 Jul 2005 19:31:29 -0000
Received: (qmail 39340 invoked from network); 29 Jul 2005 19:31:29 -0000
Received: from dsl3-63-249-88-2.cruzio.com (HELO dot.blorf.net) (63.249.88.2)
  by a.mx.sunsite.dk with SMTP; 29 Jul 2005 19:31:25 -0000
Received: by dot.blorf.net (Postfix, from userid 1000)
	id 627BB65EA; Fri, 29 Jul 2005 12:31:24 -0700 (PDT)
Date: Fri, 29 Jul 2005 12:31:24 -0700
From: Wayne Davison <wayned@users.sourceforge.net>
To: zsh-workers@sunsite.dk
Subject: PATCH: _rsync improved
Message-ID: <20050729193124.GC26009@blorf.net>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="l76fUT7nc3MelDdI"
Content-Disposition: inline
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4


--l76fUT7nc3MelDdI
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

I reorderd some lines in the _rsync completion function to work around
a previously-reported problem with shorter options interfereing with
the completion of longer options.  [To remind folks what was wrong: the
options --include-from and --exclude-from were not completing files
after an '=' (though they would complete files if the '=' was removed)
because each had a shorter option (--include and --exclude) that also
ended with a '='.]

I just discovered that if I moved each longer option to come before
the associated shorter option, that file completion starts to work
properly.  At some point we'll probably want to debug this so that
the order is not significant.

..wayne..

--l76fUT7nc3MelDdI
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="rsync.patch"

--- _rsync	27 Apr 2005 08:22:34 -0000	1.24
+++ _rsync	29 Jul 2005 19:18:01 -0000
@@ -166,10 +166,10 @@ _arguments -s \
   '(-C --cvs-exclude)'{-C,--cvs-exclude}'[auto-ignore files the same way CVS does]' \
   '*'{-f,--filter=}'[add a file-filtering rule]:rule:' \
   '*-F[same as --filter="dir-merge /.rsync-filter", repeated: --filter="- .rsync-filter"]' \
-  '*--exclude=[exclude files matching pattern]:pattern:' \
   '--exclude-from=[read exclude patterns from specified file]:file:_files' \
-  '*--include=[do not exclude files matching pattern]:pattern:' \
+  '*--exclude=[exclude files matching pattern]:pattern:' \
   '--include-from=[read include patterns from specified file]:file:_files' \
+  '*--include=[do not exclude files matching pattern]:pattern:' \
   '--files-from=[read list of source-file names from specified file]:file:_files' \
   '(-0 --from0)'{-0,--from0}'[all *-from file lists are delimited by nulls]' \
   '--version[print version number]' \

--l76fUT7nc3MelDdI--

