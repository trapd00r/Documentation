From zsh-workers-return-11526-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 23 09:10:57 2000
Return-Path: <zsh-workers-return-11526-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13971 invoked from network); 23 May 2000 09:10:56 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 23 May 2000 09:10:56 -0000
Received: (qmail 12626 invoked by alias); 23 May 2000 09:10:48 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11526
Received: (qmail 12619 invoked from network); 23 May 2000 09:10:47 -0000
Date: Tue, 23 May 2000 10:10:17 +0100
From: Peter Stephenson <pws@cambridgesiliconradio.com>
Subject: Re: PATCH: Re: Segmentation fault 3.1.7-pre-3/4
In-reply-to: "Your message of Tue, 23 May 2000 10:31:36 +0200."
 <200005230831.KAA23545@beta.informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Message-id: <0FV000FFM9H4SI@la-la.cambridgesiliconradio.com>
Content-transfer-encoding: 7BIT

Sven wrote
> But with zle not loaded, the
> 
> 	zsh -c "read -q '?Can you see this? '" < /dev/null >& /dev/null
> 
> from 11036 doesn't show the prompt (but at least it doesn't segv
> anymore). Is it right or wrong? Do we have to work around it?

Seems to me that after doing your damnedest *not* to have the prompt shown,
you don't want it.  `read -q' is documented as always reading from
the terminal, and the prompt as printing on stderr.  I haven't checked
that's what's actually going on, but it's consistent.

I worry a bit about having a hidden file descriptor and FILE * in general:
we should be sure that the shell only uses them for editing or where
explicitly indicated.  But I think it's OK here.

-- 
Peter Stephenson <pws@cambridgesiliconradio.com>
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

