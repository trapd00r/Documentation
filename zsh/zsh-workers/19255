From zsh-workers-return-19255-mason-zsh=primenet.com.au@sunsite.dk Tue Nov 18 14:35:08 2003
Return-Path: <zsh-workers-return-19255-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13384 invoked from network); 18 Nov 2003 14:35:05 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 18 Nov 2003 14:35:05 -0000
Received: (qmail 2189 invoked by alias); 18 Nov 2003 14:34:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19255
Received: (qmail 3808 invoked from network); 18 Nov 2003 13:34:50 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 18 Nov 2003 13:34:50 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [217.227.102.174] by sunsite.dk (MessageWall 1.0.8) with SMTP; 18 Nov 2003 13:34:50 -0000
Received: from caphuso by stephen.rueger.loc with local (Exim 4.24)
	id 1AM60G-0005KZ-TA
	for zsh-workers@sunsite.dk; Tue, 18 Nov 2003 14:34:48 +0100
Date: Tue, 18 Nov 2003 14:34:48 +0100
From: Stephen Rueger <stephen.rueger@rechnerpost.org>
To: zsh-workers@sunsite.dk
Subject: patch to update _apt
Message-ID: <20031118133448.GA19691@rechnerpost.org>
Mail-Followup-To: zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
X-seti: 1007
User-Agent: Mutt/1.5.4i
Sender:  <stephen.rueger@rechnerpost.org>

Hello!

This patch updates _apt to work with APT 0.5.14, now part of both Debian
testing and unstable. It does not treat older versions different, so
people using it with e.g. Debian stable will get erroneous
completions. Is that behaviour acceptable or should i add a test solving
this issue?


--- _apt	2003-11-18 13:56:11.000000000 +0100
+++ _apt.new	2003-11-18 13:56:18.000000000 +0100
@@ -396,10 +396,11 @@
     -q,--quiet,--silent:intlevel \
     -d,--download-only:bool \
     -b,--compile,--build:bool \
-    -s,--simulate,--just-print,--recon,--no-act:bool \
+    -s,--simulate,--just-print,--dry-run,--recon,--no-act:bool \
     -y,--yes,--assume-yes:bool \
     -f,--fix-broken:bool \
     -u,--show-upgraded:bool \
+    -V,--verbose-versions:bool \
     -m,--ignore-missing,--fix-missing:bool \
     --no-download:bool \
     --ignore-hold:bool \
@@ -417,6 +418,7 @@
     --only-source:bool \
     --diff-only:bool \
     --tar-only:bool \
+    --arch-only:bool \
     -- \
     /$'update\0'/ \| \
     /$'upgrade\0'/ \| \
@@ -455,8 +457,9 @@
     -i,--important:bool \
     -f,--full:bool \
     -g,--generate:bool \
-    --names-only:bool \
+    -n,--names-only:bool \
     --all-names:bool \
+    -a,--all-versions:bool \
     --recurse:bool \
     -c,--config-file:configfile \
     -o,--option:arbitem \
@@ -470,14 +473,15 @@
     /$'dump\0'/ \| \
     /$'dumpavail\0'/ \| \
     /$'unmet\0'/ \| \
-    /$'check\0'/ \| \
     /$'search\0'/ /$'[^\0]#\0'/ ':strings:pattern:' \| \
     /$'show\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
-    /$'depends\0'/ \| \
-    /$'pkgnames\0'/ \| \
-    /$'dotty\0'/ \| \
+    /$'depends\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
+    /$'rdepends\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
+    /$'pkgnames\0'/ /$'[^\0]#\0'/ ':strings:prefix:' \| \
+    /$'dotty\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
+    /$'xvcg\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
     /$'policy\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" avail' \# \| \
-    /"[]"/ ':argument-1::compadd "$expl_action[@]" help add gencaches showpkg showsrc stats dump dumpavail unmet check search show depends pkgnames dotty policy'
+    /"[]"/ ':argument-1::compadd "$expl_action[@]" help add gencaches showpkg showsrc stats dump dumpavail unmet search show depends rdepends pkgnames dotty policy xvcg'
 
   _apt-cache () {
     local expl_action expl_packages expl_pkg_cache expl_src_cache
@@ -506,7 +510,8 @@
     -o,--option:arbitem \
     -- \
     /$'add\0'/ \| \
-    /"[]"/	':argument-1::compadd "$expl_action[@]" add'
+    /$'ident\0'/ \| \
+    /"[]"/	':argument-1::compadd "$expl_action[@]" add ident'
 
   _apt-cdrom () {
     local expl_action expl_mount_point

-- 
Stephen Rüger
stephen.rueger@rechnerpost.org

