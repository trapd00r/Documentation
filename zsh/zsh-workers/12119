From zsh-workers-return-12119-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 29 08:19:58 2000
Return-Path: <zsh-workers-return-12119-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27059 invoked from network); 29 Jun 2000 08:19:57 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 29 Jun 2000 08:19:57 -0000
Received: (qmail 15849 invoked by alias); 29 Jun 2000 08:19:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12119
Received: (qmail 15842 invoked from network); 29 Jun 2000 08:19:50 -0000
Date: Thu, 29 Jun 2000 10:19:47 +0200 (MET DST)
Message-Id: <200006290819.KAA04329@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Thu, 29 Jun 2000 11:46:51 +0400
Subject: PATCH: Re: completion partially stopped to work


Andrej Borsenkow wrote:

> With the latest CVS update:
> 
> bor@itsrm2% zsh -f
> itsrm2% autoload -U compinit; compinit -D
> itsrm2% cdpath=(/tools/src)
> itsrm2% zstyle ':completion:*' matcher-list '' 'm:{a-z}={A-Z}'
> 'm:{a-z}={A-Z} r:
> |[._-]=* r:|=*' 'm:{a-z}={A-Z} r:|[.-]=** r:|=**'
> itsrm2% cd z-bTAB
> B-e-e-p
> itsrm2% ls -d /tools/src/zsh-build
> /tools/src/zsh-build

Oops. _complete returned the return value from _first.

And a similar problem in _normal.

Bye
 Sven

Index: Completion/Core/_complete
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_complete,v
retrieving revision 1.5
diff -u -r1.5 _complete
--- Completion/Core/_complete	2000/06/28 14:27:26	1.5
+++ Completion/Core/_complete	2000/06/29 08:18:50
@@ -39,6 +39,7 @@
 
 # For arguments and command names we use the `_normal' function.
 
+ret=1
 if [[ "$compstate[context]" = command ]]; then
   curcontext="$oldcontext"
   _normal -s && ret=0
Index: Completion/Core/_normal
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_normal,v
retrieving revision 1.3
diff -u -r1.3 _normal
--- Completion/Core/_normal	2000/06/07 11:21:42	1.3
+++ Completion/Core/_normal	2000/06/29 08:18:50
@@ -68,6 +68,7 @@
 
 # Now look up the two names in the normal completion array.
 
+ret=1
 name="$cmd1"
 comp="$_comps[$cmd1]"
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

