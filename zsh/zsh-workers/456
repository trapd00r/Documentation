From zsh-workers-request@math.gatech.edu  Sat Oct 14 18:02:36 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.net.au (8.7/8.7) with SMTP id SAA22422 for <mason@werple.mira.net.au>; Sat, 14 Oct 1995 18:02:20 +1000 (EST)
Received: from gauss (gauss.skiles.gatech.edu) by gatech.edu with SMTP id AA08675
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Sat, 14 Oct 1995 03:58:13 -0400
Received: by gauss (5.x/SMI-SVR4)
	id AA11507; Sat, 14 Oct 1995 03:57:35 -0400
Resent-Date: Sat, 14 Oct 1995 00:57:26 -0700
Old-Return-Path: <sethml@ugcs.caltech.edu>
Message-Id: <199510140757.AAA00927@envy.ugcs.caltech.edu>
To: zsh-workers@math.gatech.edu
Subject: Fix for zsh signal problems with Slakware
Date: Sat, 14 Oct 1995 00:57:26 -0700
From: "Seth M. LaForge" <sethml@ugcs.caltech.edu>
Resent-Message-Id: <"-9CHP1.0.jp2.krsVm"@gauss>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/456
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Under newer versions of slakware, zsh has the really annoying habit of
totally freezing whenever a child process gets a signal.  I've finally
found the cause.

The problem is that zsh tries to generate signames.h, a list of signal
names, from /usr/include/linux/signal.h.  In recent releases of
slakware, /usr/include/linux/signal.h consists solely of 
#include <asm/signal.h>.  Thus signames.h contains no signal names,
and zsh runs off the end of the signal name array when trying to look
up a signal name.

The solution: change lines 357-360 (in 2.6-beta10) of configure.in
from:

for SIGNAL_H in /usr/include/bsd/sys/signal.h   dnl Next
                /usr/include/linux/signal.h     dnl Linux
                /usr/include/sys/signal.h       dnl Almost everybody else
                /dev/null;                      dnl Just in case we fall through

to:

for SIGNAL_H in /usr/include/bsd/sys/signal.h   dnl Next
                /usr/include/asm/signal.h       dnl Newer Linux
                /usr/include/linux/signal.h     dnl Linux
                /usr/include/sys/signal.h       dnl Almost everybody else
                /dev/null;                      dnl Just in case we fall through

It would be even better to also have configure spit out an error if it
cannot find a signal.h which actually has some signals defined, but
that's a little more work.

This problem is also present in 2.5.03, and the fix should be the
same.

Seth

