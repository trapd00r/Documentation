From zsh-workers-return-22447-mason-zsh=primenet.com.au@sunsite.dk Thu May 18 13:12:41 2006
Return-Path: <zsh-workers-return-22447-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19129 invoked from network); 18 May 2006 13:12:39 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 May 2006 13:12:39 -0000
Received: (qmail 99182 invoked from network); 18 May 2006 13:12:33 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 May 2006 13:12:33 -0000
Received: (qmail 19454 invoked by alias); 18 May 2006 13:12:30 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22447
Received: (qmail 19444 invoked from network); 18 May 2006 13:12:30 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 18 May 2006 13:12:30 -0000
Received: (qmail 98864 invoked from network); 18 May 2006 13:12:30 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 18 May 2006 13:12:28 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id BF3F370055; Thu, 18 May 2006 09:12:26 -0400 (EDT)
Date: Thu, 18 May 2006 09:12:26 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Cc: Frank Terbeck <frank.terbeck@rwth-aachen.de>,
	367823-forwarded@bugs.debian.org
Subject: Re: Bug#367823: zsh: segfault when completing arrays
Message-ID: <20060518131226.GA19838@scowler.net>
Mail-Followup-To: zsh-workers@sunsite.dk,
	Frank Terbeck <frank.terbeck@rwth-aachen.de>,
	367823-forwarded@bugs.debian.org
References: <20060518120635.11242.54875.reportbug@fsst.voodoo.lan>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20060518120635.11242.54875.reportbug@fsst.voodoo.lan>
User-Agent: Mutt/1.5.11+cvs20060403

> Howdy.
> zsh 4.3.2 crashes with sig11 when doing the following:
> 
> [snip]
> % zsh -f
> % autoload compinit; compinit
> % array=( 5 4 3 2 1 )
> % print $array[4]
>                 ^- place your cursor here and hit <TAB>
> [snap]
> 
> I've tested this on a sarge system with zsh 4.2.5 and that version is
> not affected by this problem.

Should zlemetaline be 0 or should zleline + zlemetacs be non-zero?

#0  0xa7dab425 in memcpy () from /lib/tls/i686/cmov/libc.so.6
#1  0x080a5b5f in dupstrpfx (s=0x0, len=14) at ../../Src/string.c:146
#2  0xa7be32b6 in get_rbuffer (pm=0x811a9a8) at ../../../Src/Zle/zle_params.c:303
#3  0x080926b1 in getstrvalue (v=0xafd03d28) at ../../Src/params.c:1565
#4  0x080a9105 in paramsubst (l=0xafd04374, n=<value optimized out>, 
    str=0xafd03de4, qt=1, ssub=4) at ../../Src/subst.c:1730
#5  0x080ab92a in stringsubst (list=0xafd04374, node=0xafd04368, ssub=4, asssub=0)
    at ../../Src/subst.c:137
#6  0x080abafe in prefork (list=0xafd04374, flags=4) at ../../Src/subst.c:74
#7  0x080ac3d4 in singsub (s=0xafd0441c) at ../../Src/subst.c:290
#8  0x08061fab in evalcond (state=0xafd090d8, fromtest=0x0) at ../../Src/cond.c:152
#9  0x08064c78 in execcond (state=0xafd090d8, do_exec=0) at ../../Src/exec.c:3410
#10 0x08063f48 in execsimple (state=0xafd090d8) at ../../Src/exec.c:826
#11 0x0806a372 in execlist (state=0xafd090d8, dont_change_job=1, exiting=0)
    at ../../Src/exec.c:872
#12 0x08085ade in execif (state=0xafd090d8, do_exec=0) at ../../Src/loop.c:505
#13 0x08067d14 in execcmd (state=0xafd090d8, input=0, output=0, how=18, last1=2)
    at ../../Src/exec.c:2523
#14 0x080692fb in execpline2 (state=0xafd090d8, pcode=<value optimized out>, 
    how=18, input=0, output=0, last1=0) at ../../Src/exec.c:1300
#15 0x08069710 in execpline (state=0xafd090d8, slcode=<value optimized out>, 
    how=18, last1=0) at ../../Src/exec.c:1086
#16 0x0806a40e in execlist (state=0xafd090d8, dont_change_job=1, exiting=0)
    at ../../Src/exec.c:892
#17 0x08085a60 in execif (state=0xafd090d8, do_exec=0) at ../../Src/loop.c:520
#18 0x08067d14 in execcmd (state=0xafd090d8, input=0, output=0, how=2, last1=2)

