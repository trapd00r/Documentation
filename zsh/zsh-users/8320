From zsh-users-return-8320-mason-zsh=primenet.com.au@sunsite.dk Mon Jan 03 16:39:34 2005
Return-Path: <zsh-users-return-8320-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14516 invoked from network); 3 Jan 2005 16:39:33 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Jan 2005 16:39:33 -0000
Received: (qmail 3929 invoked from network); 3 Jan 2005 16:39:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Jan 2005 16:39:23 -0000
Received: (qmail 14793 invoked by alias); 3 Jan 2005 16:38:33 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8320
Received: (qmail 14767 invoked from network); 3 Jan 2005 16:38:32 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 3 Jan 2005 16:38:32 -0000
Received: (qmail 2179 invoked from network); 3 Jan 2005 16:37:33 -0000
Received: from moonbase.zanshin.com (64.84.47.139)
  by a.mx.sunsite.dk with SMTP; 3 Jan 2005 16:37:29 -0000
Received: from toltec.zanshin.com (toltec.zanshin.com [64.84.47.166])
	by moonbase.zanshin.com (8.13.1/8.13.1) with ESMTP id j03GbPLS026614;
	Mon, 3 Jan 2005 08:37:25 -0800
Date: Mon, 3 Jan 2005 08:37:25 -0800 (PST)
From: Bart Schaefer <schaefer@brasslantern.com>
Reply-To: zsh-users@sunsite.dk
To: kynn@panix.com
cc: zsh-users@sunsite.dk
Subject: Re: Advanced scripting Q: notification to tty
In-Reply-To: <200412241809.iBOI9lq12047@panix3.panix.com>
Message-ID: <Pine.LNX.4.61.0501030832190.32450@toltec.zanshin.com>
References: <200412241809.iBOI9lq12047@panix3.panix.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

On Fri, 24 Dec 2004 kynn@panix.com wrote:

> I want to implement a notification by a function to the terminal
> controlling an interactive zsh
> 
> [...] the shell's notification arrives while the user is in the middle
> of typing a multi-line command, so the shell re-creates the
> interrupted line for the user.  *Very nicely done*.
> 
> Does zsh provide any facilities for programmers to achieve this effect
> in shell scripts?

Yes, look at the "zle" command's -F option which allows you to install an
asynchronous I/O handler function in the line editor.  See also "zle -I".

> Absent this, what is the best way to implement "synchronous" 
> notification (i.e. one that happens only after the user hits the Enter 
> key) in zsh scripts?

Have the notifier write to a named pipe (or use the coproc descriptor) and 
examine that for available input in the user-definable precmd function.

