From zsh-users-return-14956-mason-zsh=primenet.com.au@zsh.org Mon Mar 22 16:53:34 2010
Return-Path: <zsh-users-return-14956-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9840 invoked by alias); 22 Mar 2010 16:53:34 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14956
Received: (qmail 1061 invoked from network); 22 Mar 2010 16:53:23 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VERIFIED autolearn=ham version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 209.85.220.212 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=mEjkgWgsAIx8TIXY4kOU4cFw20c9Xhs+ve4A6WPjz0w=;
        b=ZR7r970SWAIfrG2UJdEgprIuHRCFxntFv64KQxFsrNKKCO6feymJnUtIP/sdvTWBIJ
         JfP2moB4fHmyFIYe1hB86nY3XfYkKO3J8BPQm4YOnW0yYWaA+oHSMj8C84PLNhV6ftDU
         JUonCdNw1mJZjdls0RaTB05jaLNSoI7Rp7GOE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=WYOPwLIqYEXaLSARrNacdXSWk3TSZoHZZzUJwuZ2WSsY78CyKMTBgqCvlDlXVCdiRz
         L2FD4KLtrCLmeQw4L2ehXjpMkgFbTpXg6Z2Z8Ewhqn+Q/Pi9HSQidKr6oi+2VkAt4wOI
         gFxi32o15S1WG+9JftMGe/E/FZPBbPi8S1i2E=
Message-ID: <4BA799B0.2010902@gmail.com>
Date: Mon, 22 Mar 2010 17:24:16 +0100
From: "Radoulov, Dimitre" <cichomitiko@gmail.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.8) Gecko/20100227 Thunderbird/3.0.3
MIME-Version: 1.0
To: zsh-users@zsh.org
Subject: Brace expansion performance
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit


Hi all,
does anybody know why the zsh brace expansion (?) performs so ... 
differently?

[1]

% time ksh -c 'echo ${.sh.version};for i in {1..300000}; do :;done'
Version JM 93t+ 2009-05-01
0.50s user 0.24s system 90% cpu 0.817 total

% time bash -c 'echo $BASH_VERSION;for i in {1..300000}; do :;done'
4.0.33(1)-release
1.59s user 0.58s system 90% cpu 2.409 total

% time zsh -c 'print $ZSH_VERSION $ZSH_PATCHLEVEL;for i in {1..300000}; 
do :;done'
4.3.10 1.4705
15.26s user 5.24s system 87% cpu 23.468 total

[2]

$ time ksh -c 'echo ${.sh.version};for i in {1..300000}; do :;done'
Version M 1993-12-28 r

real    0m0.886s
user    0m0.873s
sys     0m0.014s

$ time bash -c 'echo $BASH_VERSION;for i in {1..300000}; do :;done'
3.1.17(1)-release

real    0m2.482s
user    0m2.463s
sys     0m0.019s

$ time zsh -c 'print $ZSH_VERSION $ZSH_PATCHLEVEL;for i in {1..300000}; 
do :;done'
4.2.6

real    0m47.353s
user    0m46.672s
sys     0m0.629s

Tested on VirtualBox Ubuntu 9.10 guest [1] and on a real RHEL 5.1 host[2].


Best regards
Dimitre







