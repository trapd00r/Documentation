From zsh-users-return-11267-mason-zsh=primenet.com.au@sunsite.dk Sat Mar 10 07:30:40 2007
Return-Path: <zsh-users-return-11267-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22997 invoked from network); 10 Mar 2007 07:30:34 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 10 Mar 2007 07:30:34 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 80827 invoked from network); 10 Mar 2007 07:30:27 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 10 Mar 2007 07:30:27 -0000
Received: (qmail 20287 invoked by alias); 10 Mar 2007 07:30:18 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11267
Received: (qmail 20277 invoked from network); 10 Mar 2007 07:30:17 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 10 Mar 2007 07:30:17 -0000
Received: (qmail 79555 invoked from network); 10 Mar 2007 07:30:17 -0000
Received: from vms048pub.verizon.net (206.46.252.48)
  by a.mx.sunsite.dk with SMTP; 10 Mar 2007 07:30:10 -0000
Received: from torch.brasslantern.com ([71.116.117.231])
 by vms048.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0JEO00J59FI6DMK0@vms048.mailsrvcs.net> for
 zsh-users@sunsite.dk; Sat, 10 Mar 2007 01:30:07 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id l2A7U5e6008700	for
 <zsh-users@sunsite.dk>; Fri, 09 Mar 2007 23:30:06 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id l2A7U5hW008699	for zsh-users@sunsite.dk; Fri,
 09 Mar 2007 23:30:05 -0800
Date: Fri, 09 Mar 2007 23:30:05 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: code completition / cannot delete characters
In-reply-to: <B63D238E-72DE-4330-93D7-F361412A428C@michaelworobcuk.de>
To: zsh-users@sunsite.dk
Message-id: <070309233005.ZM8696@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=iso-8859-1
Content-transfer-encoding: quoted-printable
References: <52211927-A3E8-4E51-8735-961A3BE83BB1@michaelworobcuk.de>
	<070309024427.ZM6023@torch.brasslantern.com>
	<4916CF2F-0DA8-478B-96DC-B6154C90D98C@michaelworobcuk.de>
	<070309081354.ZM8122@torch.brasslantern.com>
	<B63D238E-72DE-4330-93D7-F361412A428C@michaelworobcuk.de>
Comments: In reply to Michael Worobcuk <mail@michaelworobcuk.de>
 "Re: code completition / cannot delete characters" (Mar  9, 11:45pm)

On Mar 9, 11:45pm, Michael Worobcuk wrote:
}
} > Instead it appears that the six keys ESC x r e d i are being swallowed

Aha, yes, as Micah suggested you do appear to be using the vi bindings.
(bindkey -v)  That would explain much.  ESC goes to vi command mode,=20
and then (because the command line is empty) nothing happens until you
get to "i" which puts you back in insert mode where you type "splay".

} > bindkey -m
} >
} > do you get a warning about multibyte support being disabled?
} Yes, here it is:
}=20
} [hanno: /home/hanno]>bindkey -m
} bindkey: warning: `bindkey -m' disables multibyte support

After you've done that, does anything change about the way completion
behaves?

I think you're probably just running into one of the cases where
multibyte support was not quite finished in the completion system.
If you're able to compile your own copy of the shell, try getting
the latest development snapshot from sourceforge.net.

} > Have you tried using the insert-composed-char or insert-unicode-char
} > functions?  You'll need to install them:
} >
} > autoload -U insert-composed-char
} > zle -N insert-composed-char
} >
} > and then bind them to a convenient key sequence with bindkey.
}=20
} Could you explain me, how to do that ?

Since you're using vi mode, the binding for the ESC key is to change
to command mode, and most other keys bindings just insert themselves.
You need to choose some keys that aren't already being used for another
purpose.  To see what's already in use, use

	bindkey -M viins

A good choice for an unbound key is often control-X (^X) but you may
find that some completion functions have already been attached to key
sequences beginning with that.

Assuming for example that ^Xc is available for insert-composed-char
and ^Xu is available for insert-unicode-char, you just do

autoload -U insert-composed-char insert-unicode-char
zle -N insert-composed-char
zle -N insert-unicode-char
bindkey -v ^Xc insert-composed-char
bindkey -v ^Xu insert-unicode-char

Then when you're ready to insert a multibyte character, you type
control-x and then c and then the two characters that represent the
multibyte character, e.g. ^X c a : for =E4.

See the manual for the various things you can insert this way.

