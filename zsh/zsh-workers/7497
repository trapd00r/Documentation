From zsh-workers-return-7497-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Aug 26 11:56:39 1999
Return-Path: <zsh-workers-return-7497-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27689 invoked from network); 26 Aug 1999 11:56:37 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 Aug 1999 11:56:37 -0000
Received: (qmail 9255 invoked by alias); 26 Aug 1999 11:56:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7497
Received: (qmail 9248 invoked from network); 26 Aug 1999 11:56:14 -0000
From: jarausch@igpm.rwth-aachen.de
Message-Id: <199908261155.NAA65383@numa1.igpm.rwth-aachen.de>
Date: Thu, 26 Aug 1999 13:55:52 +0200
Reply-To: jarausch@igpm.rwth-aachen.de
Subject: whatis DYNAMIC_NAME_CLASH_OK
To: zsh-workers@sunsite.auc.dk
cc: fletch@phydeaux.org
MIME-Version: 1.0
Content-Type: TEXT/plain; charset=us-ascii

Hi,

I've just debugged a segment fault, when trying to load
Mike Fletcher's zperl module.

I traced it down to 
#0  module_func (m=0x100da3a8, name=0x100ad0f8 "setup_", 
    name_s=0x100ad100 "setup_%s") at module.c:468
#1  0x1005746c in setup_module (m=0x100da3a8) at module.c:482



Now in  'module_func) (module.c:452)

s= m->nam  returning  "zperl"

since configure defined DYNAMIC_NAME_CLASH_OK on my IRIX 6.5
it directly calls
fn = (Module_func) dlsym(m->handle, name);
where name = 'setup_'
Obviously that fails (since the correct symbol is  setup_zperl)
and the success of dlsym is not checked
we run into nirwana.

1.) What's the heck with DYNAMIC_NAME_CLASH_OK ?
2.) At least IRIX 6.5 obviously needs  #undef DYNAMIC_NAME_CLASH_OK
3.) checking the success of  dlsym and an error abort
    would be nicer than a segment fault, which was hard to be traced
    down

Thanks for your comments,
Helmut.

-- 
Helmut Jarausch
Lehrstuhl fuer Numerische Mathematik
Institute of Technology, RWTH Aachen
D 52056 Aachen, Germany

