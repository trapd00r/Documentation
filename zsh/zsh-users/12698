From zsh-users-return-12698-mason-zsh=primenet.com.au@sunsite.dk Fri Mar 07 17:08:46 2008
Return-Path: <zsh-users-return-12698-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21563 invoked from network); 7 Mar 2008 17:08:45 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Mar 2008 17:08:45 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 81913 invoked from network); 7 Mar 2008 17:08:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Mar 2008 17:08:25 -0000
Received: (qmail 6371 invoked by alias); 7 Mar 2008 17:08:17 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12698
Received: (qmail 6357 invoked from network); 7 Mar 2008 17:08:16 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 7 Mar 2008 17:08:16 -0000
Received: from smarty.dreamhost.com (smarty.dreamhost.com [208.113.175.8])
	by bifrost.dotsrc.org (Postfix) with ESMTP id DF27B802A5EF
	for <zsh-users@sunsite.dk>; Fri,  7 Mar 2008 18:08:12 +0100 (CET)
Received: from herod.dreamhost.com (herod.dreamhost.com [208.113.239.72])
	by smarty.dreamhost.com (Postfix) with ESMTP id 42FFEEE290
	for <zsh-users@sunsite.dk>; Fri,  7 Mar 2008 09:08:11 -0800 (PST)
Received: by herod.dreamhost.com (Postfix, from userid 130321)
	id EE32B60334; Fri,  7 Mar 2008 09:08:08 -0800 (PST)
Date: Fri, 7 Mar 2008 09:08:08 -0800
From: Wayne Davison <wayned@users.sourceforge.net>
To: ZSH User List <zsh-users@sunsite.dk>
Subject: Re: feature idea: customizable string in history file
Message-ID: <20080307170808.GC11566@herod.dreamhost.com>
References: <20080307142825.GA23322@spiegl.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20080307142825.GA23322@spiegl.de>
User-Agent: Mutt/1.5.9i
X-Virus-Scanned: ClamAV 0.91.2/6165/Fri Mar  7 16:57:30 2008 on bifrost
X-Virus-Status: Clean

On Fri, Mar 07, 2008 at 03:28:25PM +0100, Andy Spiegl wrote:
> I'd like to write the content of this variable to each line of the
> history file so that we can later retrace who did what.

One simple way to do that would be to modify the writing of the extended
history in savehistfile() (see Src/hist.c).  If you add the name at the
end, like this:

    ... fprintf(out, ": %ld:%ld:%s;", ...

The parsing code won't care about the extra characters since it just
skips to the ';' after parsing the first 2 items.

..wayne..

