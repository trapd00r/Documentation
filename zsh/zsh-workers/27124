From zsh-workers-return-27124-mason-zsh=primenet.com.au@sunsite.dk Fri Jul 10 14:22:08 2009
Return-Path: <zsh-workers-return-27124-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21955 invoked from network); 10 Jul 2009 14:21:55 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 10 Jul 2009 14:21:55 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 91674 invoked from network); 10 Jul 2009 14:21:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 10 Jul 2009 14:21:49 -0000
Received: (qmail 24420 invoked by alias); 10 Jul 2009 14:21:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 27124
Received: (qmail 24400 invoked from network); 10 Jul 2009 14:21:39 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 10 Jul 2009 14:21:39 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 89BCB8027106
	for <zsh-workers@sunsite.dk>; Fri, 10 Jul 2009 16:21:35 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly45d.srv.mailcontrol.com (MailControl) with ESMTP id n6AELXBM025720
	for <zsh-workers@sunsite.dk>; Fri, 10 Jul 2009 15:21:34 +0100
Received: from news01.csr.com ([10.99.50.25]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 10 Jul 2009 15:21:33 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id n6AELXvg028012
	for <zsh-workers@sunsite.dk>; Fri, 10 Jul 2009 15:21:33 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id n6AELWFS028008
	for <zsh-workers@sunsite.dk>; Fri, 10 Jul 2009 15:21:33 +0100
Message-Id: <200907101421.n6AELWFS028008@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: file completion of ~user/... stats wrong directory
In-reply-to: <m31vooljj7.fsf@klanderman.net>
References: <19030.11925.370937.608524@gargle.gargle.HOWL> <20090710100721.56b0874c@news01> <m31vooljj7.fsf@klanderman.net>
Comments: In-reply-to Greg Klanderman <gak@klanderman.net>
   message dated "Fri, 10 Jul 2009 10:06:20 -0400."
Date: Fri, 10 Jul 2009 15:21:32 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 10 Jul 2009 14:21:33.0360 (UTC) FILETIME=[B9C88300:01CA0169]
X-Scanned-By: MailControl A-09-20-00 (www.mailcontrol.com) on 10.68.0.155
X-Virus-Scanned: ClamAV 0.94.2/9552/Fri Jul 10 14:30:33 2009 on bifrost
X-Virus-Status: Clean

Greg Klanderman wrote:
> So do you agree it's a bug that it's stat-ing the path with the ~user/
> stripped off, effectively then relative to the current directory?
> 
> So, if it needs to go through that loop at least once, then maybe when
> 'prepath' (singular) is '' it should be prepending any stuff that got
> stripped off the front back on?  Guess I'll have to grovel through
> there and try to make sense of what's going on...

Certainly sounds plausible.  It's odd this isn't an ever worse problem,
but _path_files has so many possibilities it's surprisingly hard to
trigger particular problems.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

