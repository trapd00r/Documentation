From zsh-workers-return-10963-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Apr 27 09:03:45 2000
Return-Path: <zsh-workers-return-10963-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14849 invoked from network); 27 Apr 2000 09:03:40 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Apr 2000 09:03:39 -0000
Received: (qmail 17749 invoked by alias); 27 Apr 2000 09:03:31 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10963
Received: (qmail 17735 invoked from network); 27 Apr 2000 09:03:31 -0000
Date: Thu, 27 Apr 2000 11:03:09 +0200 (MET DST)
Message-Id: <200004270903.LAA13625@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Adam Spiers's message of Wed, 26 Apr 2000 18:14:02 +0100
Subject: PATCH: Re: _setopt broken


Adam Spiers wrote:

> $ setopt <TAB> 
> _all_labels:compadd:39: need non-empty word or line pattern
> 
> Is this another of my `weird options' bugs?

Ouch, parse error for left-anchored patterns.

Bye
 Sven

Index: Src/Zle/complete.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/complete.c,v
retrieving revision 1.5
diff -u -r1.5 complete.c
--- Src/Zle/complete.c	2000/04/27 08:21:10	1.5
+++ Src/Zle/complete.c	2000/04/27 09:02:21
@@ -221,7 +221,7 @@
 	    if (err)
 		return pcm_err;
 
-	    if ((both = (*s == '|')))
+	    if ((both = (*s && s[1] == '|')))
 		s++;
 
 	    if (!*s || !*++s) {

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

