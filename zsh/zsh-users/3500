From zsh-users-return-3500-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Nov 01 19:05:32 2000
Return-Path: <zsh-users-return-3500-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17004 invoked from network); 1 Nov 2000 19:05:30 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Nov 2000 19:05:30 -0000
Received: (qmail 8920 invoked by alias); 1 Nov 2000 19:05:11 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3500
Received: (qmail 8912 invoked from network); 1 Nov 2000 19:05:09 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <001101110436.ZM18848@candle.brasslantern.com>
Date: Wed, 1 Nov 2000 11:04:36 -0800
In-Reply-To: <20001101120532.A67952@cvoo.cvoo.nl>
Comments: In reply to Phil Pennock <Phil.Pennock@globnix.org>
        "3.0.x completion on commands w/ common prefix" (Nov  1, 12:05pm)
References: <20001101120532.A67952@cvoo.cvoo.nl>
X-Mailer: Z-Mail Lite (5.0.0 30July97)
To: Phil Pennock <Phil.Pennock@globnix.org>, zsh-users@sunsite.auc.dk
Subject: Re: 3.0.x completion on commands w/ common prefix
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Nov 1, 12:05pm, Phil Pennock wrote:
> Subject: 3.0.x completion on commands w/ common prefix

> I have a whole bunch of commands which all start with a common prefix.
> I'd like to set a standard tab-completion for any command starting with
> that prefix, no matter where in $PATH they are.
> 
> The specifics:
>  * array $sshhosts with list of hostnames
>  * commands all start remote_

You want something along the lines of

	compctl -Tx 'W[0,remote_*] p[1,-1]' -k sshhosts

Which says that if the word in command position matches the pattern
"remote_*" and you are completing in any of the argument positions, then
use the array sshhosts.  Otherwise (part of the definition of -T, but
see below) fall through to normal completion for the command.

You can change the range specified with p[] to change where sshhosts is
used, add other extended-completion patterns, etc.  Note that you get only
one compctl -T, so if you have other commands that you want to pattern-
match in this way, you have to add more `W[0,...]' alternatives to the -x
set, e.g.

	compctl -Tx 'W[0,remote_*] p[1,-1]' -k sshhosts \
		-   'W[0,x*] c[-1,-display]' -k x11displays

and so on.

In 3.1.9 (and at some point after 3.1.5, but I forget exactly when) you
need to append `-tn' to the end of the compctl to specify the fallthrough
behavior (the default changed).

