From zsh-users-return-9674-mason-zsh=primenet.com.au@sunsite.dk Tue Nov 08 22:10:06 2005
Return-Path: <zsh-users-return-9674-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12626 invoked from network); 8 Nov 2005 22:10:04 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 8 Nov 2005 22:10:04 -0000
Received: (qmail 30873 invoked from network); 8 Nov 2005 22:09:56 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 8 Nov 2005 22:09:56 -0000
Received: (qmail 10819 invoked by alias); 8 Nov 2005 22:09:48 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9674
Received: (qmail 10807 invoked from network); 8 Nov 2005 22:09:47 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 8 Nov 2005 22:09:47 -0000
Received: (qmail 29756 invoked from network); 8 Nov 2005 22:09:47 -0000
Received: from xproxy.gmail.com (66.249.82.199)
  by a.mx.sunsite.dk with SMTP; 8 Nov 2005 22:09:45 -0000
Received: by xproxy.gmail.com with SMTP id s13so16132wxc
        for <zsh-users@sunsite.dk>; Tue, 08 Nov 2005 14:09:43 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=UxBk8FDZG9SXdWrjl+uzqkOAKRJEtMog/J+R9VjnFv7eHxPkRS1tZdAOdvYUOQwXp+F4YUMUGSf/ILes27s17hDjvqcZ5FB+1sRGv7gTX6mZZNTgRrvccosW5EZ3fSgtPNUVG0zkw7ZqBM8S+NuWLf0hGeIxbK6SSzkh4z9GOwI=
Received: by 10.65.215.4 with SMTP id s4mr7145956qbq;
        Tue, 08 Nov 2005 14:09:43 -0800 (PST)
Received: by 10.65.22.16 with HTTP; Tue, 8 Nov 2005 14:09:42 -0800 (PST)
Message-ID: <b6c719b90511081409w67ff0910o941c21d63f8d2126@mail.gmail.com>
Date: Tue, 8 Nov 2005 17:09:42 -0500
From: Ian Langworth <ian.langworth@gmail.com>
To: Wayne Davison <wayned@users.sourceforge.net>
Subject: Re: Is zsh buggy in connection with screen?
Cc: zsh-users@sunsite.dk
In-Reply-To: <20051108174411.GH24349@dot.blorf.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <20051108130233.GA6146@hpfsc.de>
	 <20051108141317.GQ27583@ay.vinc17.org>
	 <20051108174411.GH24349@dot.blorf.net>
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.3 required=5.0 tests=BAYES_00,RCVD_BY_IP,
	RCVD_IN_BL_SPAMCOP_NET autolearn=no version=3.0.4

I have a similar problem with ssh-agent. New screen windows
automatically get the updated environment when I've shelled freshly
into the machine, but existing shells in windows need to run
"latestssh."

# the problem with screen is that old sessions lose ssh-agent awareness. th=
is
# little system fixes it.
local agentdir=3D~/.latestssh
local agentfile=3D$agentdir/$HOST.sh
mkdir -p $agentdir
chmod 0700 $agentdir >/dev/null
if [ -n "$SSH_AUTH_SOCK" -a -z $STY ]; then
    echo "export SSH_AUTH_SOCK=3D$SSH_AUTH_SOCK" >$agentfile
    chmod 0600 $agentfile >/dev/null
fi
# ...existing windows can run this alias
alias latestssh=3D"source $agentfile; ls \$SSH_AUTH_SOCK"
# ...new windows get it automatically
if [ -n "$STY" ]; then
    source $agentfile
fi

--
Ian Langworth

