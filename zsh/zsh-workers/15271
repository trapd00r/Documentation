From zsh-workers-return-15271-mason-zsh=primenet.com.au@sunsite.dk Fri Jul 06 06:05:02 2001
Return-Path: <zsh-workers-return-15271-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11811 invoked from network); 6 Jul 2001 06:05:00 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Jul 2001 06:05:00 -0000
Received: (qmail 27452 invoked by alias); 6 Jul 2001 06:03:57 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15271
Received: (qmail 27426 invoked from network); 6 Jul 2001 06:03:56 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010706060302.ZM10729@candle.brasslantern.com>
Date: Fri, 6 Jul 2001 06:03:02 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: I hate it when you break my static link
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Please everyone remember:  When you add a module that depends on any kind
of external library feature, you should if at all possible verify that zsh
builds both --enable-dynamic and --disable-dynamic AND that it does so on
a machine that DOES NOT have the external library with which your module
is linking.

In particular, the default linkage in <module>.mdd should NEVER be 'either'
when there is a dependency on a library that might not be available.

More changes than the following will be necessary to actually fix the pcre
module on systems that don't have the library for it, but the following at
least gets --disable-dynamic working again.

diff -u zsh-forge/current/Src/Modules/pcre.mdd zsh-4.0/Src/Modules/pcre.mdd
--- zsh-forge/current/Src/Modules/pcre.mdd	Mon Jul  2 12:39:35 2001
+++ zsh-4.0/Src/Modules/pcre.mdd	Thu Jul  5 22:44:55 2001
@@ -1,5 +1,5 @@
 name=zsh/pcre
-link=either
+link=dynamic
 load=no
 
 autobins="pcre_compile pcre_study pcre_match"

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

