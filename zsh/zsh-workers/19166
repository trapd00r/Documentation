From zsh-workers-return-19166-mason-zsh=primenet.com.au@sunsite.dk Sat Oct 04 02:24:58 2003
Return-Path: <zsh-workers-return-19166-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2042 invoked from network); 4 Oct 2003 02:24:57 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 4 Oct 2003 02:24:57 -0000
Received: (qmail 25869 invoked by alias); 3 Oct 2003 22:24:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19166
Received: (qmail 25858 invoked from network); 3 Oct 2003 22:24:50 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 3 Oct 2003 22:24:50 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [66.93.131.57] by sunsite.dk (MessageWall 1.0.8) with SMTP; 3 Oct 2003 22:24:49 -0000
Received: from lorien.emufarm.org (localhost [127.0.0.1])
	by lorien.emufarm.org (8.12.7/8.12.7) with ESMTP id h93MOikI006468;
	Fri, 3 Oct 2003 15:24:45 -0700
Received: (from duvall@localhost)
	by lorien.emufarm.org (8.12.7/8.12.7/Submit) id h93MOhqY006467;
	Fri, 3 Oct 2003 15:24:43 -0700
Date: Fri, 3 Oct 2003 15:24:43 -0700
From: Danek Duvall <duvall@emufarm.org>
To: Philippe Troin <phil@fifi.org>
Cc: Nicolas George <nicolas.george@ens.fr>, zsh-workers@sunsite.dk
Subject: Re: Subshell exiting, suspend problem
Message-ID: <20031003222443.GH4255@lorien.emufarm.org>
Mail-Followup-To: Danek Duvall <duvall@emufarm.org>,
	Philippe Troin <phil@fifi.org>,
	Nicolas George <nicolas.george@ens.fr>, zsh-workers@sunsite.dk
References: <20030926165251.GA14940@clipper.ens.fr> <20031003205809.GE4255@lorien.emufarm.org> <873ceaugby.fsf@ceramic.fifi.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <873ceaugby.fsf@ceramic.fifi.org>
User-Agent: Mutt/1.5.4i

On Fri, Oct 03, 2003 at 03:06:09PM -0700, Philippe Troin wrote:

> Danek Duvall <duvall@emufarm.org> writes:
> 
> > I've been using this patch for a little while on a Solaris box, and
> > it solved the problem I had where su would be left in the job table
> > after I exited it.
> 
> Can you elaborate on that problem? I use zsh with su on solaris
> without any issues.

"su root -c /path/to/zsh" runs the shell.  When I exit, I get

    zsh: suspended (tty output)  su root -c /path/to/zsh

which is confirmed by jobs.  If I foreground the job, it finally exits
properly.  This is if both the user and the root shell are 4.1.1 without
the patch.

If the root shell is patched, then this problem doesn't happen (doesn't
matter what the user shell is).

If the user shell is patched but the root shell is not, then I get the
I/O error I described before.

> > However, I'm now unable to suspend vi or ncftp, or, I would guess,
> > any curses program.
> 
> That's strange: this patch only changes zsh's exit behavior.

Indeed.  I'll recompile both the patched version and the unpatched
version from scratch and see if I can reproduce all this behavior.

Thanks,
Danek

