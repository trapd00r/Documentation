From zsh-workers-return-16304-mason-zsh=primenet.com.au@sunsite.dk Thu Dec 06 16:06:27 2001
Return-Path: <zsh-workers-return-16304-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7904 invoked from network); 6 Dec 2001 16:06:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 Dec 2001 16:06:26 -0000
Received: (qmail 28746 invoked by alias); 6 Dec 2001 16:06:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16304
Received: (qmail 28735 invoked from network); 6 Dec 2001 16:06:20 -0000
X-VirusChecked: Checked
X-Authentication-Warning: iris.logica.co.uk: Host kiddleo@rambo.logica.co.uk [158.234.33.58] claimed to be yahoo.co.uk
Sender: kiddleo@iris.logica.co.uk
Message-ID: <3C0F96F5.DD870D8A@yahoo.co.uk>
Date: Thu, 06 Dec 2001 16:04:05 +0000
From: Oliver Kiddle <okiddle@yahoo.co.uk>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.2.15 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: Adam Spiers <adam@spiers.net>
CC: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Subject: Re: bug in _tar?
References: <20011206112547.A806@corelli.new.ox.ac.uk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Hi everyone.

Adam Spiers wrote:
> 
> The problem occurs when you have a word immediately after the cursor,
> i.e. with no space in between it and the cursor.
> 
>   $ tar ztvf src/emacs-<TAB>lisp/
>   ---- archive file
>   emacs-21.1/             emacs-21.1.tar.gz       emacs-lisp-intro-1.05/
> 
> All good so far, but ...
> 
>   $ tar ztvf src/emacs-21.1.<TAB>lisp/
>   $ tar ztvf src
> 
> Suddenly everything vanishes.
> 
> This is with latest CVS.

Firstly, the problem is not _tar. It would have helped a lot if you
could have first checked whether the problem was specific to tar (which
it isn't) and then isolated what part of your setup was needed to
reproduce the problem because I struggled to reproduce it.

If anyone else is struggling to reproduce this, try:
    zsh -f
    autoload -U compinit; compinit
    setopt completeinword
    zstyle ':completion:*' completer _complete _prefix
    _c() { compadd -p tz/ -M 'r:|/=* r:|=*' emacs-21.1.tar.gz }
    compdef _c c
    c tz/em<tab>y

In the case of the original _tar example, the compadd comes from
_path_files:650. Seems like a bug somewhere in the C code to me but I
have little idea beyond that. Sven?

Oliver

_____________________________________________________________________
This message has been checked for all known viruses by the 
MessageLabs Virus Scanning Service. For further information visit
http://www.messagelabs.com/stats.asp

