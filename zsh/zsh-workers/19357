From zsh-workers-return-19357-mason-zsh=primenet.com.au@sunsite.dk Fri Jan 09 11:58:23 2004
Return-Path: <zsh-workers-return-19357-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11425 invoked from network); 9 Jan 2004 11:58:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 9 Jan 2004 11:58:22 -0000
Received: (qmail 24242 invoked by alias); 9 Jan 2004 11:58:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19357
Received: (qmail 24213 invoked from network); 9 Jan 2004 11:58:10 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 9 Jan 2004 11:58:10 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [62.193.203.32] by sunsite.dk (MessageWall 1.0.8) with SMTP; 9 Jan 2004 11:58:9 -0000
Received: from DervishD.pleyades.net (212.Red-80-35-44.pooles.rima-tde.net [80.35.44.212])
	by madrid10.amenworld.com (8.10.2/8.10.2) with ESMTP id i09Bw3u18790;
	Fri, 9 Jan 2004 12:58:04 +0100
Received: from raul@pleyades.net by DervishD.pleyades.net with local (Exim MTA 2.05)
	  id <1AevDZ-0001jF-00>; Fri, 9 Jan 2004 12:54:21 +0100
Date: Fri, 9 Jan 2004 12:54:21 +0100
From: DervishD <raul@pleyades.net>
To: Bart Schaefer <schaefer@brasslantern.com>
Cc: Zsh Workers <zsh-workers@sunsite.dk>
Subject: Re: Test E01 and Y01 fails in my zsh 4.0.9
Message-ID: <20040109115421.GC2777@DervishD>
Mail-Followup-To: Bart Schaefer <schaefer@brasslantern.com>,
	Zsh Workers <zsh-workers@sunsite.dk>
References: <20040107121100.GA1432@DervishD> <1040107160210.ZM10597@candle.brasslantern.com> <20040107185618.GE13633@DervishD> <1040107210945.ZM10947@candle.brasslantern.com> <20040107212622.GA24850@DervishD> <1040107223003.ZM11778@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <1040107223003.ZM11778@candle.brasslantern.com>
User-Agent: Mutt/1.4i
Organization: Pleyades
User-Agent: Mutt/1.4i <http://www.mutt.org>

    Hi Bart :)

 * Bart Schaefer <schaefer@brasslantern.com> dixit:
> } file is run even when zsh is invoked with '-f', isn't it?
> Yep.  In fact, /etc/zshenv is run even when zsh is invoked with
> "-o no_global_rcs".

    There should be a flag for avoiding even /etc/zshenv, just in
case it is badly broken...

> } > }     Don't know why 'comptestinit' stops there :??
> }     Can it be caused by some option I set on my /etc/zshenv?
> It could be ... but I can't suggest anything specific.

    Well, I isolated the problem: the test doesn't like my PS1
(which, BTW, shouldn't be in /etc/zshevn... my fault). Since
'comptest' modifies PS1, that was probably the problem. If I unset my
PS1, I got the following as the output of 'make check TESTNUM=Y01'.
Haven't tried with Y02 and Y03 yet:

cd Test ; make check
make[1]: Entering directory `/root/Test/zsh-4.0.9/Test'
if test -n ""; then \
  cd .. && DESTDIR= \
  make MODDIR=`pwd`/Test/Modules install.modules > /dev/null; \
fi
for f in ./Y01*.ztst; do \
  ../Src/zsh +Z -f ./ztst.zsh $f; \
done
./Y01completion.ztst: starting.
*** /tmp/zsh.ztst.out.6474	Fri Jan  9 12:42:19 2004
--- /tmp/zsh.ztst.tout.6474	Fri Jan  9 12:42:19 2004
***************
*** 1,12 ****
  line: {: }{}
! DESCRIPTION:{file}
! DI:{dir1}
! DI:{dir2}
! FI:{file1}
! FI:{file2}
! line: {: dir1/}{}
! line: {: dir2/}{}
! line: {: file1}{}
! line: {: file2}{}
! line: {: dir1/}{}
! line: {: dir2/}{}
--- 1,7 ----
  line: {: }{}
! line: {: }{}
! line: {: }{}
! line: {: }{}
! line: {: }{}
! line: {: }{}
! line: {: }{}
Test ./Y01completion.ztst failed: output differs from expected as shown above for:
  comptest $': \t\t\t\t\t\t\t'
Was testing: directories and files
./Y01completion.ztst: test failed.
make[1]: [check] Error 1 (ignored)
rm -rf Modules .zcompdump
make[1]: Leaving directory `/root/Test/zsh-4.0.9/Test'

    I don't have the 'computil' module, could it be the problem?
Anyway, my zsh seems to work OK even if the test fails :?

    Raúl Núñez de Arenas Coronado

-- 
Linux Registered User 88736
http://www.pleyades.net & http://raul.pleyades.net/

