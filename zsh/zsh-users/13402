From zsh-users-return-13402-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 28 22:14:38 2008
Return-Path: <zsh-users-return-13402-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1815 invoked from network); 28 Oct 2008 22:14:10 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00,SPF_HELO_PASS
	autolearn=ham version=3.2.5
Received: from ns2.primenet.com.au (HELO primenet.com.au) (203.24.36.3)
  by ns1.primenet.com.au with (DHE-RSA-AES256-SHA encrypted) SMTP; 28 Oct 2008 22:14:10 -0000
Received: (qmail 27622 invoked from network); 28 Oct 2008 18:33:31 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by proxy.melb.primenet.com.au with SMTP; 28 Oct 2008 18:33:31 -0000
Received-SPF: none (proxy.melb.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 50098 invoked from network); 28 Oct 2008 18:32:04 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 Oct 2008 18:32:04 -0000
Received: (qmail 24037 invoked by alias); 28 Oct 2008 18:31:25 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13402
Received: (qmail 24011 invoked from network); 28 Oct 2008 18:31:23 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 28 Oct 2008 18:31:23 -0000
Received: from SMTP.EU.CITRIX.COM (smtp.eu.citrix.com [62.200.22.115])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 78FF080524C0
	for <zsh-users@sunsite.dk>; Tue, 28 Oct 2008 19:31:18 +0100 (CET)
X-IronPort-AV: E=Sophos;i="4.33,500,1220227200"; 
   d="scan'208";a="2485960"
Received: from lonpexchmx01.citrite.net ([10.30.224.191])
  by LONPIPO01.EU.CITRIX.COM with ESMTP; 28 Oct 2008 18:31:18 +0000
Received: from lonpexch01.citrite.net ([10.30.224.136]) by lonpexchmx01.citrite.net with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 28 Oct 2008 18:31:18 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: Completion problem when `nocaseglob' is set
Date: Tue, 28 Oct 2008 18:31:17 -0000
Message-ID: <DD74FBB8EE28D441903D56487861CD9D3883994B@lonpexch01.citrite.net>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Completion problem when `nocaseglob' is set
Thread-Index: Ack5K13H7VXPcdl4TDup7Z6wC1UcnQ==
From: "John Cooper" <John.Cooper@eu.citrix.com>
To: <zsh-users@sunsite.dk>
Cc: "John Cooper" <John.Cooper@eu.citrix.com>
X-OriginalArrivalTime: 28 Oct 2008 18:31:18.0902 (UTC) FILETIME=[5E868160:01C9392B]
X-Virus-Scanned: ClamAV 0.92.1/8526/Tue Oct 28 14:21:35 2008 on bifrost
X-Virus-Status: Clean

I've just upgraded to zsh 4.3.4 (via Cygwin) and have found that
completion in the root C: drive no longer works when I `setopt
nocaseglob'. It was working fine with my previous version of zsh
4.<something> that I installed a couple of years ago, but I don't recall
the exact version.

After running `zsh -f', the following both work fine and list the files
in the root of my C drive:
$ ls c:/<TAB>    # lists files as expected
$ ls /c/<TAB>    # lists files as expected

  (btw, I have the cygwin drive prefix set to "/" instead of
"/cygdrive")

The problem starts when I set the `nocaseglob' option:
$ setopt nocaseglob
$ ls c:/<TAB>    # no files listed
$ ls /c/<TAB>    # no files listed

A couple of years ago I experienced the same problem and, after getting
help from this list, I resolved it by doing:
$ mount -c /cygdrive
$ /usr/bin/mkdir /c
$ /usr/bin/mount -c /

Apparently, creating the /c directory allowed it to become visible to
the globbing system (it's listed in `print /*'), although I don't
understand why this is only needed when `nocaseglob' is in effect.

Anyway, with zsh 4.3.4, the above is now only a partial fix:

$ ls /c/<TAB>    # lists files as expected
$ ls c:/<TAB>    # no files listed

Does anyone know how I can get completion to work using c:/<TAB> with
zsh 4.3.4 with `nocaseglob' enabled?

I've tried the following, but to no avail:
  zstyle ':completion:*:paths' accept-exact 'c:'
  zstyle ':completion:*' fake-files '/:c'

Thanks,

    --- John.

