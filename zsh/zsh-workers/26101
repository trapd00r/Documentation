From zsh-workers-return-26101-mason-zsh=primenet.com.au@sunsite.dk Sun Nov 30 22:23:58 2008
Return-Path: <zsh-workers-return-26101-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12029 invoked from network); 30 Nov 2008 22:23:55 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 30 Nov 2008 22:23:55 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 99018 invoked from network); 30 Nov 2008 22:23:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 30 Nov 2008 22:23:49 -0000
Received: (qmail 187 invoked by alias); 30 Nov 2008 22:23:43 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26101
Received: (qmail 178 invoked from network); 30 Nov 2008 22:23:42 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 30 Nov 2008 22:23:42 -0000
Received: from vms173007pub.verizon.net (vms173007pub.verizon.net [206.46.173.7])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 9F72880525B6
	for <zsh-workers@sunsite.dk>; Sun, 30 Nov 2008 23:23:39 +0100 (CET)
Received: from torch.brasslantern.com ([96.238.220.215])
 by vms173007.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0KB60040Z3HJVSK6@vms173007.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Sun, 30 Nov 2008 16:22:32 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id mAUMNaPL031621	for
 <zsh-workers@sunsite.dk>; Sun, 30 Nov 2008 14:23:37 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id mAUMNaDg031620	for zsh-workers@sunsite.dk; Sun,
 30 Nov 2008 14:23:36 -0800
Date: Sun, 30 Nov 2008 14:23:35 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Feature idea: Expanding on completion functions
In-reply-to: <2d460de70811301335y25ee0afcya2aea82b871fedb5@mail.gmail.com>
To: "Zsh Workers" <zsh-workers@sunsite.dk>
Message-id: <081130142336.ZM31619@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <2d460de70811301335y25ee0afcya2aea82b871fedb5@mail.gmail.com>
Comments: In reply to "Richard Hartmann" <richih.mailinglist@gmail.com>
 "Feature idea: Expanding on completion functions" (Nov 30, 10:35pm)
X-Virus-Scanned: ClamAV 0.92.1/8698/Sun Nov 30 16:09:19 2008 on bifrost
X-Virus-Status: Clean

On Nov 30, 10:35pm, Richard Hartmann wrote:
}
} The completion functions are so powerful it's a shame not to use
} their output for more purposes.

Without necessarily shooting down this idea, let me point out that
completion functions don't have output.  I think the following is
mostly similar to what I said before:

What completion functions do is shove a large number of *possible*
completions into the "compadd" builtin.  Typically they generate WAY
more possibilities than you ever see as "output" ... a lot of the
magic hides in the way completion uses the contents of the command
line at or around the cursor position to throw away most of the data
that was fed to it, so you see the relevant remainder.

The rest of the magic comes from the constellation of variables that
describe the command line context so that the completion functions
have some idea where to look for possible completions.

To use the completion functions for more purposes, you have to both
populate all those context variables appropriately to each of those
other purposes, and also create the appropriate filters to remove
whatever is irrelevant to each purpose.

And then you have to decouple the stuff that performs the filtering
from the stuff that displays the results in ZLE, which is the only
place that any "output" goes right now.

-- 

