From zsh-workers-return-19073-mason-zsh=primenet.com.au@sunsite.dk Sat Sep 13 01:51:18 2003
Return-Path: <zsh-workers-return-19073-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18156 invoked from network); 13 Sep 2003 01:51:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 13 Sep 2003 01:51:17 -0000
Received: (qmail 22708 invoked by alias); 13 Sep 2003 01:51:13 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19073
Received: (qmail 22697 invoked from network); 13 Sep 2003 01:51:12 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 13 Sep 2003 01:51:12 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [207.172.4.62] by sunsite.dk (MessageWall 1.0.8) with SMTP; 13 Sep 2003 1:51:11 -0000
Received: from 65-78-17-226.c3-0.nwt-ubr2.sbo-nwt.ma.cable.rcn.com ([65.78.17.226] helo=zion.rcn.com)
	by smtp03.mrf.mail.rcn.net with esmtp (Exim 3.35 #4)
	id 19xzZ9-0006uu-00
	for zsh-workers@sunsite.dk; Fri, 12 Sep 2003 21:51:11 -0400
Received: by zion.rcn.com (Postfix, from userid 500)
	id AB2701E086; Fri, 12 Sep 2003 21:46:58 -0400 (EDT)
To: zsh-workers@sunsite.dk
Subject: C++-style comment in Src/exec.c
From: Vin Shelton <acs@alumni.princeton.edu>
Organization: EtherSoft, Inc
Date: Fri, 12 Sep 2003 21:46:58 -0400
Message-ID: <m3ad99jw8d.fsf@zion.rcn.com>
Lines: 17
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="=-=-="


--=-=-=

(Sorry if you get 2 copies, but my posts from work do not seem to be
showing up on the list.  Perhaps Teradyne is rejecting the
confirmation request as spam?)

There is a C++-style comment in Src/exec.c.  Here is a trivial patch:


--=-=-=
Content-Type: text/x-patch
Content-Disposition: attachment; filename=exec.diff
Content-Description: Replace C++-style comment in Src/exec.c

--- ChangeLog~	2003-09-12 21:27:51.000000000 -0400
+++ ChangeLog	2003-09-12 21:39:37.000000000 -0400
@@ -0,0 +1,4 @@
+2003-09-12  Vin Shelton  <acs@xemacs.org>
+
+	* Src/exec.c (execcmd): Replace C++-style comment.
+
--- Src/exec.c~	2003-09-12 21:11:06.000000000 -0400
+++ Src/exec.c	2003-09-12 21:38:09.000000000 -0400
@@ -1824,7 +1824,7 @@
 	    cflags |= hn->flags;
 	    checked = 0;
 	    if (cflags & BINF_COMMAND && nextnode(firstnode(args))) {
-		// check for options to command builtin
+		/* check for options to command builtin */
 		char *next = (char *) getdata(nextnode(firstnode(args)));
 		char *cmdopt;
 		if (next && *next == '-' && strlen(next) == 2 &&

--=-=-=


I've also included my earlier patch to zshconfig.ac.  Would somebody
please apply it?  I do not have write access.


--=-=-=
Content-Type: text/x-patch
Content-Disposition: attachment; filename=config.diff
Content-Description: Patch to make configure grok icc's CPP output

Index: ChangeLog
===================================================================
RCS file: /cvsroot/zsh/zsh/ChangeLog,v
retrieving revision 1.2089
diff -a -u -u -0 -r1.2089 ChangeLog
--- ChangeLog	3 Sep 2003 14:07:25 -0000	1.2089
+++ ChangeLog	7 Sep 2003 04:03:38 -0000
@@ -0,0 +1,4 @@
+2003-09-06  Vin Shelton  <acs@alumni.princeton.edu>
+
+	* zshconfig.ac: Make sed grok icc's cpp output.
+
Index: zshconfig.ac
===================================================================
RCS file: /cvsroot/zsh/zsh/zshconfig.ac,v
retrieving revision 1.39
diff -a -u -r1.39 zshconfig.ac
--- zshconfig.ac	30 Aug 2003 19:16:22 -0000	1.39
+++ zshconfig.ac	7 Sep 2003 04:03:54 -0000
@@ -1081,7 +1081,8 @@
 dnl slashes rather than doubled backslashes in the path.
 echo "#include <signal.h>" > nametmp.c
 sigfile_list="`$CPP nametmp.c |
-sed -n 's/^#[ 	].*\"\(.*\)\"/\1/p' |
+sed -n -e 's/^#line[ 	].*\"\(.*\)\"/\1/p' \
+       -e 's/^#[ 	].*\"\(.*\)\"/\1/p' |
 sed 's/\\\\\\\\/\//g' |
 $AWK '{ if (\$1 ~ \"sig\") files[[\$1]] = \$1 }
   END { for (var in files) print var }'`"
@@ -1128,7 +1129,8 @@
 dnl slashes rather than doubled backslashes in the path.
 echo "#include <errno.h>" > nametmp.c
 errfile_list="`$CPP nametmp.c |
-sed -n 's/^#[ 	].*\"\(.*\)\"/\1/p' |
+sed -n -e 's/^#line[ 	].*\"\(.*\)\"/\1/p' \
+       -e 's/^#[ 	].*\"\(.*\)\"/\1/p' |
 sed 's/\\\\\\\\/\//g' |
 $AWK '{ if (\$1 ~ \"err\") files[[\$1]] = \$1 }
   END { for (var in files) print var }'`"

--=-=-=


Thank you,
  Vin

--=-=-=--

