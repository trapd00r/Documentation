From zsh-workers-return-17499-mason-zsh=primenet.com.au@sunsite.dk Sun Aug 04 09:23:57 2002
Return-Path: <zsh-workers-return-17499-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16348 invoked from network); 4 Aug 2002 09:23:56 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 4 Aug 2002 09:23:56 -0000
Received: (qmail 6896 invoked by alias); 4 Aug 2002 09:23:48 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17499
Received: (qmail 6884 invoked from network); 4 Aug 2002 09:23:47 -0000
Date: Sun, 04 Aug 2002 18:23:41 +0900
Message-ID: <863ctvt1sy.wl@archon.local.idaemons.org>
From: "Akinori MUSHA" <knu@iDaemons.org>
To: zsh-workers <zsh-workers@sunsite.dk>
Subject: adding .tbz support to _bsd_pkg
User-Agent: Wanderlust/2.9.14 (Unchained Melody) EMIKO/1.14.1 (Choanoflagellata) LIMIT/1.14.7 (Fujiidera) APEL/10.3 Emacs/21.2 (i386--freebsd) MULE/5.0 (SAKAKI)
Organization: Associated I. Daemons
X-PGP-Public-Key: finger knu@FreeBSD.org
X-PGP-Fingerprint: 081D 099C 1705 861D 4B70  B04A 920B EFC7 9FD9 E1EE
MIME-Version: 1.0 (generated by EMIKO 1.14.1 - "Choanoflagellata")
Content-Type: text/plain; charset=US-ASCII

Hi, 

FreeBSD's pkg_* tools have bzip2'd package support and the default
package format has now been changed from .tgz to .tbz.  Here's a patch
to make _bsd_pkg look for .tbz files as well as .tgz files.  Please
apply it if it looks okay.

Regards,

-- 
                     /
                    /__  __            Akinori.org / MUSHA.org
                   / )  )  ) )  /     FreeBSD.org / Ruby-lang.org
Akinori MUSHA aka / (_ /  ( (__(  @ iDaemons.org / and.or.jp

"When I leave I don't know what I'm hoping to find
              When I leave I don't know what I'm leaving behind.."

Index: Completion/BSD/Command/_bsd_pkg
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/BSD/Command/_bsd_pkg,v
retrieving revision 1.3
diff -u -r1.3 _bsd_pkg
--- Completion/BSD/Command/_bsd_pkg	1 Feb 2002 14:28:31 -0000	1.3
+++ Completion/BSD/Command/_bsd_pkg	4 Aug 2002 09:21:56 -0000
@@ -16,9 +16,9 @@
   pkgsdir=${PACKAGES:-$portsdir/packages}/All
 
   paths=( "${(@)${(@s.:.)PKG_PATH}:#}" )
-  _files "$@" -g \*.tgz && ret=0
-  (( $#path )) && _files "$@" -W paths -g \*.tgz && ret=0
-  compadd "$@" - $pkgsdir/*.tgz && ret=0
+  _files "$@" -g '*.t[bg]z' && ret=0
+  (( $#path )) && _files "$@" -W paths -g '*.t[bg]z' && ret=0
+  compadd "$@" - $pkgsdir/*.t[bg]z && ret=0
 
   return ret
 }

