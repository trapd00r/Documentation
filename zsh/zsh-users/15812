From zsh-users-return-15812-mason-zsh=primenet.com.au@zsh.org Fri Feb 18 23:56:20 2011
Return-Path: <zsh-users-return-15812-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12953 invoked by alias); 18 Feb 2011 23:56:20 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15812
Received: (qmail 28666 invoked from network); 18 Feb 2011 23:56:18 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.0 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,FREEMAIL_FROM,RCVD_IN_DNSWL_NONE,
	T_TO_NO_BRKTS_FREEMAIL autolearn=ham version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 209.85.220.171 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:date:from:to:subject:in-reply-to:message-id
         :references:user-agent:mime-version:content-type;
        bh=7jTjnI68QRD0y6lQOwlOlX5QWYRIG7Epe2DC/jlny/E=;
        b=eeZac0JGGW+7S+sHrWp2aZgUqF6qo4ZdYVNG0VDSM0Bw2Vdgq7+wwoAycOCI805RSI
         ZSp3m3JGAnejGwSqJz0667PMbkmam4KyU7WyRRPSMdwfo5wwq/wbVE+MG6KPcS8/7pi7
         II1zLRxWo+kI1tB3xYoem98UOJZeCHdLmeStw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=date:from:to:subject:in-reply-to:message-id:references:user-agent
         :mime-version:content-type;
        b=fmk/lADSD53rOF1oeTbimsLxWpUCusmdhMAt0J82m3JomNjaubMoVRM/h6EZHkufhJ
         66eAaLU4pec9jNtm3Isg5GAIXB9WsMBXyoaUDK1t59Fe0E//QS0PkOkiuiruTAa6KghW
         n9VbIU5qtW7E+YriWSKyWNvQZxQ96T/dOKD7g=
Date: Fri, 18 Feb 2011 17:56:10 -0600 (CST)
From: Rory Mulvaney <rorymulv@gmail.com>
To: zsh-users@zsh.org
Subject: Re: stream buffering
In-Reply-To: <alpine.DEB.2.00.1102181746060.22551@MyComp.rgm-web.net>
Message-ID: <alpine.DEB.2.00.1102181754440.326@MyComp.rgm-web.net>
References: <alpine.DEB.2.00.1102181746060.22551@MyComp.rgm-web.net>
User-Agent: Alpine 2.00 (DEB 1167 2008-08-23)
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Fri, 18 Feb 2011, Peter Stephenson wrote:

> On Thu, 17 Feb 2011 19:40:20 -0600 (CST)
> Rory Mulvaney <rorymulv@xxxxxxxxx> wrote:
> 
> > I'm wondering if the reason that some I/O intensive zsh shell scripts 
> > aren't fast is mostly only because the I/O is (I think) line-buffered. 
> > Is there a way to do full buffering of streams, or what would be the 
> > best way to provide it?  Maybe a module similar to zsh/net/socket, 
> > perhaps using setvbuf(3)?
> 
> What I/O are you referring to?  The shell's own input for a script needs 
> to be parsed and intepreted, which will be much more of a restriction than 
> buffering except for scripts with really silly amounts of embedded text 
> like here documents.  Standard input to the shell via the read builtin 
> etc. similarly tends to be in short chunks, likewise output via print.  
> Input to other commands run from scripts makes its own arrangements for 
> buffering.

Sorry, I'm definitely referring to the type of I/O using read and print 
(or some other builtin created by a module).  And I don't necessarily mean 
in a script; it could just be from a loop on the command line where the 
loop reads or prints all lines in a file.

while read var ; do 
  -something- 
done

-Rory 

[sorry if there are some incorrect threading headers, since I just 
subscribed now]

