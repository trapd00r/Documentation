From zsh-workers-return-22813-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 03 17:33:53 2006
Return-Path: <zsh-workers-return-22813-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2273 invoked from network); 3 Oct 2006 17:33:48 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.5 (2006-08-29) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Oct 2006 17:33:48 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 49330 invoked from network); 3 Oct 2006 17:33:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Oct 2006 17:33:42 -0000
Received: (qmail 17484 invoked by alias); 3 Oct 2006 17:33:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22813
Received: (qmail 17474 invoked from network); 3 Oct 2006 17:33:37 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 3 Oct 2006 17:33:37 -0000
Received: (qmail 48882 invoked from network); 3 Oct 2006 17:33:37 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 3 Oct 2006 17:33:32 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly18c.srv.mailcontrol.com (MailControl) with ESMTP id k93HXOQH015644
	for <zsh-workers@sunsite.dk>; Tue, 3 Oct 2006 18:33:27 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 3 Oct 2006 18:33:24 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.7/8.13.4) with ESMTP id k93HXOEI008549
	for <zsh-workers@sunsite.dk>; Tue, 3 Oct 2006 18:33:24 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.7/8.13.7/Submit) with ESMTP id k93HXNCY008545
	for <zsh-workers@sunsite.dk>; Tue, 3 Oct 2006 18:33:24 +0100
Message-Id: <200610031733.k93HXNCY008545@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: _complete_help broken
Date: Tue, 03 Oct 2006 18:33:23 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 03 Oct 2006 17:33:24.0446 (UTC) FILETIME=[074B97E0:01C6E712]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-07-04-02 (www.mailcontrol.com) on 10.67.0.128

Someone, almost certainly me (or possibly I), broke _complete_help (^xh)
so that it adds an extra newline.  This happens with zsh -f and compinit
from scratch.  This is probably additional fallout from the change I put
in in 22676/22678 to make trashzle() not retrash if it never got
untrashed up (c.f. 22727).  It suggests that there's another point which
isn't fixing the cursor position after outputting to the terminal.
Unfortunately, I haven't yet got much idea of where to look for the
problem; _complete_help does some nasty things (yes, I was surprised,
too...)

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

