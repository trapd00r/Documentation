From zsh-users-return-13853-mason-zsh=primenet.com.au@sunsite.dk Sat Feb 14 19:14:06 2009
Return-Path: <zsh-users-return-13853-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1401 invoked from network); 14 Feb 2009 19:14:03 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Feb 2009 19:14:03 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 6235 invoked from network); 14 Feb 2009 19:13:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Feb 2009 19:13:54 -0000
Received: (qmail 15763 invoked by alias); 14 Feb 2009 19:13:38 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13853
Received: (qmail 15754 invoked from network); 14 Feb 2009 19:13:38 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 14 Feb 2009 19:13:38 -0000
Received: from vms173017pub.verizon.net (vms173017pub.verizon.net [206.46.173.17])
	by bifrost.dotsrc.org (Postfix) with ESMTP id E8FAC802720F
	for <zsh-users@sunsite.dk>; Sat, 14 Feb 2009 20:13:34 +0100 (CET)
Received: from torch.brasslantern.com ([96.238.220.215])
 by vms173017.mailsrvcs.net
 (Sun Java(tm) System Messaging Server 6.3-7.04 (built Sep 26 2008; 32bit))
 with ESMTPA id <0KF200K0VLE5X2X0@vms173017.mailsrvcs.net> for
 zsh-users@sunsite.dk; Sat, 14 Feb 2009 13:13:22 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n1EJDHdd015190	for
 <zsh-users@sunsite.dk>; Sat, 14 Feb 2009 11:13:17 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n1EJDGx6015189	for zsh-users@sunsite.dk; Sat,
 14 Feb 2009 11:13:16 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <090214111316.ZM15188@torch.brasslantern.com>
Date: Sat, 14 Feb 2009 11:13:15 -0800
In-reply-to: <237967ef0902141019t30118690m30116c9413015d96@mail.gmail.com>
Comments: In reply to Mikael Magnusson <mikachu@gmail.com>
 "Re: Problem with fake-files style and cd" (Feb 14,  7:19pm)
References: <mikachu@gmail.com>
	<237967ef0902140622s7389d2c8h5a0c786dcf207422@mail.gmail.com>
	<200902141801.n1EI1E2l003603@pws-pc.ntlworld.com>
	<237967ef0902141019t30118690m30116c9413015d96@mail.gmail.com>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: zsh-users <zsh-users@sunsite.dk>
Subject: Re: Problem with fake-files style and cd
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii
X-Virus-Scanned: ClamAV 0.92.1/8992/Sat Feb 14 16:43:07 2009 on bifrost
X-Virus-Status: Clean

On Feb 14,  7:19pm, Mikael Magnusson wrote:
}
} (No, I've modified the _cd completer a bit to only add $cdpath things
} if the first component is already typed out, because when I'm sitting
} in a dir with only one subdir and type cd <tab> i would like that
} directory completed and not the 50 ones in my cdpath. [...])

Well, that was your first mistake. :-)  You should be able to get the
effect you want using styles.

} Of course, my real question should have been if I can make the
} completion listing remove duplicate entries when I have both a real
} directotry and an entry in cdpath that matches, but I guess if you
} have a real dir foo/bar and a cdpath dir foo/baz you want to be able
} to complete to foo/baz too. Maybe it doesn't have to show up as a
} cdpath entry at the foo point though, since the cd builtin won't
} actually go there anyway?

I'm not sure I'm following the last part of that, but what you need to
look at is the documentation for the tag-order zstyle.  I use this:

    zstyle :completion::complete:cd:: tag-order \
	local-directories path-directories

This says to complete only local directories if there are matches for
those, and if there are no local matches then complete only directories
that are found in the cdpath.  Look at the documentation for "Standard
Tags" to find explanation of local-directories and path-directories.

If you want to complete directories in both places but only show the
local ones in listings, you can use the "hidden" style like so:

    zstyle :completion::complete:cd::path-directories hidden yes

(That's not very clear from the documentation for the "hidden" style.)
You probably don't want to use both tag-order and hidden in this case,
but there might be contexts in which you would.

-- 

