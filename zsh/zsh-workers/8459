From zsh-workers-return-8459-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Oct 27 20:39:56 1999
Return-Path: <zsh-workers-return-8459-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28978 invoked from network); 27 Oct 1999 20:39:55 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Oct 1999 20:39:55 -0000
Received: (qmail 21655 invoked by alias); 27 Oct 1999 20:39:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8459
Received: (qmail 21647 invoked from network); 27 Oct 1999 20:39:49 -0000
Subject: Re: bugs in 3.0.6 (at least on Solaris 8)
In-Reply-To: <199910272008.NAA527581@yavin.Eng.Sun.COM> from Mike Sullivan at "Oct 27, 1999  1: 8:14 pm"
To: Mike.Sullivan@Eng.Sun.COM (Mike Sullivan)
Date: Wed, 27 Oct 1999 21:39:48 +0100 (BST)
Cc: zsh-workers@sunsite.auc.dk
X-Mailer: ELM [version 2.4ME+ PL48 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Message-Id: <E11gZrI-0003l3-00@crucigera.fysh.org>
From: Zefram <zefram@fysh.org>

Mike Sullivan wrote:
>A couple things I found with zsh 3.0.6 in Solaris 8. Most important is
>that since the signal names are extracted with an awk script run on
><sys/signal.h>, zsh is broken because the signal macros are not there
>anymore. They're in <sys/iso/signal_iso.h>.

which reminds me, recent glibc has <bits/signum.h> and <bits/resource.h>.

-zefram

*** configure.in-	Wed Oct 27 21:24:33 1999
--- configure.in	Wed Oct 27 21:32:53 1999
***************
*** 838,849 ****
  if test -z "$sigfile_list"; then
    dnl In case we don't get the stuff from the preprocesor, use the old
    dnl list of standard places.
!   sigfile_list="/usr/include/bsd/sys/signal.h
  /usr/include/signum.h
  /usr/include/asm/signum.h
  /usr/include/asm/signal.h
  /usr/include/linux/signal.h
  /usr/include/sys/signal.h
  /dev/null"
  fi
  for SIGNAL_H in $sigfile_list
--- 838,851 ----
  if test -z "$sigfile_list"; then
    dnl In case we don't get the stuff from the preprocesor, use the old
    dnl list of standard places.
!   sigfile_list="/usr/include/sys/iso/signal_iso.h
! /usr/include/bsd/sys/signal.h
  /usr/include/signum.h
  /usr/include/asm/signum.h
  /usr/include/asm/signal.h
  /usr/include/linux/signal.h
  /usr/include/sys/signal.h
+ /usr/include/bits/signum.h
  /dev/null"
  fi
  for SIGNAL_H in $sigfile_list
***************
*** 856,861 ****
--- 858,866 ----
    wc -l | sed 's/[ 	]//g'`
    test "x$nsigs" != x && test "$nsigs" -ge 7 && break
  done
+ if test $SIGNAL_H = "/dev/null"; then
+   AC_MSG_ERROR(SIGNAL MACROS NOT FOUND:  please report to developers)
+ fi
  zsh_cv_path_signal_h=$SIGNAL_H
  ])
  SIGNAL_H=$zsh_cv_path_signal_h
***************
*** 870,875 ****
--- 875,881 ----
                     /usr/include/asm/resource.h	     dnl
                     /usr/include/linux/resource.h     dnl
                     /usr/include/sys/resource.h       dnl
+                    /usr/include/bits/resource.h      dnl
                     /usr/include/resourcebits.h       dnl
                     /dev/null;
  do
***************
*** 879,885 ****
  done
  zsh_cv_path_rlimit_h=$RESOURCE_H
  if test $RESOURCE_H = "/dev/null" -a $ac_cv_func_getrlimit = yes; then
!   echo "RLIMIT MACROS NOT FOUND:  please report to developers"
  fi])
  RLIMITS_INC_H=$zsh_cv_path_rlimit_h
  dnl rlimits.h only appears in dependencies if we are actually using it.
--- 885,891 ----
  done
  zsh_cv_path_rlimit_h=$RESOURCE_H
  if test $RESOURCE_H = "/dev/null" -a $ac_cv_func_getrlimit = yes; then
!   AC_MSG_WARN(RLIMIT MACROS NOT FOUND:  please report to developers)
  fi])
  RLIMITS_INC_H=$zsh_cv_path_rlimit_h
  dnl rlimits.h only appears in dependencies if we are actually using it.
END

