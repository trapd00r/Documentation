From zsh-workers-return-11755-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 05 23:03:21 2000
Return-Path: <zsh-workers-return-11755-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11956 invoked from network); 5 Jun 2000 23:03:20 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 5 Jun 2000 23:03:20 -0000
Received: (qmail 18945 invoked by alias); 5 Jun 2000 23:03:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11755
Received: (qmail 18938 invoked from network); 5 Jun 2000 23:03:06 -0000
Sender: opk
Message-ID: <393C148A.741A4904@u.genie.co.uk>
Date: Mon, 05 Jun 2000 21:58:50 +0100
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.61 [en] (X11; I; Linux 2.2.15 i586)
X-Accept-Language: en
MIME-Version: 1.0
To: Zsh workers <zsh-workers@sunsite.auc.dk>
Subject: Compilation on IRIX 5.3
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

When compiling on IRIX 5.3, I get this:

Can't open -e
Can't open /^!MOD!)$/q;p

repeated several times. Wasn't this from one of the Solaris sed
fixes recently? If not, the last time I compiled Zsh on my Indigo
was 3.1.6-dev-21 so it is since then. I've stuck some more of
the output leading up to this on then end of this message.

Another thing which I've been meaning to look at for ages is that
I get the following repeatedly on an IRIX 5.3 build:

cfe: Warning 753: /usr/include/sys/types.h, line 111: declaration
must at least declare an identifier, tag, or the member of an
enumeration
 typedef        unsigned long   unsigned long ;          
 ^
cfe: Warning 645: /usr/include/sys/types.h, line 111: Duplicate 'unsigned'
 typedef        unsigned long   unsigned long ;          
 -------        -------------   ^

This has been around since about 3.1.5-dev-25 and was caused by
the long file support. I've also put the section of types.h on
the end of this message.

Despite these, Zsh does build successfully. I ran the tests an everything
passed until 53completion.ztst. It seems that zpty doesn't work but I
haven't got time to look at that at the moment. I've added a patch
though which just fixes the English in a few print statements in
comptest.

Oliver Kiddle

partial make output:
            set '' Zsh/mod_cap.yo Zsh/mod_clone.yo  Zsh/mod_compctl.yo Zsh/mod_complete.yo Zsh/mod_complist.yo  Zsh/mod_computil.yo  Zsh/mod_deltochar.yo Zsh/mod_example.yo Zsh/mod_files.yo  Zsh/mod_mapfile.yo Zsh/mod_mathfunc.yo Zsh/mod_parameter.yo Zsh/mod_sched.yo  Zsh/mod_stat.yo Zsh/mod_zftp.yo Zsh/mod_zle.yo Zsh/mod_zleparameter.yo  Zsh/mod_zutil.yo Zsh/mod_zprof.yo Zsh/mod_zpty.yo; \
            mod1= mod2= mod3=; \
            test ".$2" = . || \
                mod2=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < ./$2`; \
            while test ".$2" != .; do \
                mod3=; \
                test ".$3" = . || \
                    mod3=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < ./$3`; \
                echo "texinode(The $mod2 Module)(${mod3:+The $mod3 Module})(${mod1:+The $mod1 Module})(Zsh Modules)"; \
                echo "sect(The $mod2 Module)"; \
                echo "includefile(${2})`"; \
                shift; \
                mod1=$mod2; \
                mod2=$mod3; \
            done \
        ) > ./Zsh/modlist.yo
Can't open -e
Can't open /^!MOD!)$/q;p
Can't open -e
Can't open /^!MOD!)$/q;p

types.h (with line numbers added):

   104  #if (_MIPS_SZLONG == 32)
   105  typedef unsigned long   mode_t;         /* file attrs */
   106  typedef unsigned long   dev_t;          /* device type */
   107  typedef long            uid_t;
   108  typedef long            gid_t;
   109  typedef unsigned long   nlink_t;        /* used for link counts */
   110  typedef long            pid_t;          /* proc & grp IDs  */
   111  typedef unsigned long   ino_t;          /* <inode> type */
   112  #endif
   113  #if (_MIPS_SZLONG == 64)
   114  typedef __uint32_t      mode_t;         /* file attrs */
   115  typedef __uint32_t      dev_t;          /* device type */
   116  typedef __int32_t       uid_t;
   117  typedef __int32_t       gid_t;
   118  typedef __uint32_t      nlink_t;        /* used for link counts */
   119  typedef __int32_t       pid_t;          /* proc & grp IDs  */
   120  typedef __uint32_t      ino_t;          /* <inode> type */
   121  #endif

--- Test/comptest    Sun May 21 19:01:00 2000
+++ Test/comptest Mon Jun  5 22:56:01 2000
@@ -19,7 +19,7 @@
   zpty zsh "$comptest_zsh" -f
 
   zpty -r zsh log1 "*<PROMPT>*" || { 
-    print "first prompt doesn't appered."
+    print "first prompt hasn't appeared."
     return 1
   }
 
@@ -75,7 +75,7 @@
   print -lr - "$@" > $tmp
   zpty -w zsh ". $tmp"
   zpty -r zsh log_eval "*<PROMPT>*" || {
-    print "prompt doesn't appered."
+    print "prompt hasn't appeared."
     return 1
   }
   rm $tmp
@@ -85,7 +85,7 @@
   input="$*"
   zpty -n -w zsh "$input"$'\C-Z'
   zpty -r zsh log "*<WIDGET><finish>*<PROMPT>*" || {
-    print "finish widget doesn't invoked."
+    print "failed to invoke finish widget."
     return 1
   }


