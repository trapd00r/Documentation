From zsh-workers-request@math.gatech.edu Fri Dec 04 14:14:04 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1578 invoked from network); 4 Dec 1998 14:14:03 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 4 Dec 1998 14:14:03 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id JAA17218;
	Fri, 4 Dec 1998 09:08:03 -0500 (EST)
Resent-Date: Fri, 4 Dec 1998 09:08:03 -0500 (EST)
Date: Fri, 4 Dec 1998 15:06:07 +0100 (MET)
Message-Id: <199812041406.PAA16177@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@math.gatech.edu
Subject: Bug with special vars in user-widgets
Resent-Message-ID: <"IuNjG3.0.zC4.2p-Ps"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4701
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu


Hi

Try:

  do-addx () {
    LBUFFER="${LBUFFER}x"
  }

  zle -N do-addx

  bindkey x do-addx

Then type `x' twice. This gives a segmentation fault because the
definitions of the widget special parameters from the first invocation 
weren't deleted, so that createparam() returns zero in
makezleparams().
Removing the `| PM_SPECIAL' in line 74 in zle_params.c fixes this, but 
I don't know if this is correct, so I won't produce a patch for this.

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

