From zsh-workers-return-21999-mason-zsh=primenet.com.au@sunsite.dk Fri Nov 11 16:06:21 2005
Return-Path: <zsh-workers-return-21999-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21046 invoked from network); 11 Nov 2005 16:06:17 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Nov 2005 16:06:17 -0000
Received: (qmail 42320 invoked from network); 11 Nov 2005 16:06:11 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Nov 2005 16:06:11 -0000
Received: (qmail 22301 invoked by alias); 11 Nov 2005 16:06:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21999
Received: (qmail 22291 invoked from network); 11 Nov 2005 16:06:07 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 11 Nov 2005 16:06:07 -0000
Received: (qmail 42097 invoked from network); 11 Nov 2005 16:06:06 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 11 Nov 2005 16:06:04 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 8B1C47C08C; Fri, 11 Nov 2005 11:06:02 -0500 (EST)
Date: Fri, 11 Nov 2005 11:06:02 -0500
From: Clint Adams <clint@zsh.org>
To: zsh-workers@sunsite.dk
Subject: PATCH: _gnutls second half
Message-ID: <20051111160602.GA32112@scowler.net>
Mail-Followup-To: zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

For people who want to manipulate certificates, keys, and SRP stuff.  I
can't commit this due to the Sourceforge outage.

--- orig/Completion/Unix/Command/_gnutls
+++ mod/Completion/Unix/Command/_gnutls
@@ -1,4 +1,4 @@
-#compdef gnutls-cli gnutls-cli-debug
+#compdef gnutls-cli gnutls-cli-debug certtool srptool
 
 local _gnutls_supported _gnutls_supported_certtypes
 local _gnutls_supported_protocols _gnutls_supported_macs
@@ -64,4 +64,63 @@
      '(-v --verbose)'{-v,--verbose}'[more verbose output]' \
      ':hostname:_hosts'
 
+     ;;
+
+	(certtool)
+_arguments \
+     '(-s --generate-self-signed)'{-s,--generate-self-signed}'[generate a self-signed certificate]' \
+     '(-c --generate-certificate)'{-c,--generate-certificate}'[generate a signed certificate]' \
+     '--generate-crl[generate a CRL]' \
+     '(-u --update-certificate)'{-u,--update-certificate}'[update a signed certificate]' \
+     '(-p --generate-privkey)'{-p,--generate-privkey}'[generate a private key]' \
+     '(-q --generate-request)'{-q,--generate-request}'[generate a PKCS #10 certificate request]' \
+     '(-e --verify-chain)'{-e,--verify-chain}'[verify a PEM encoded certificate chain]' \
+     '--verify-crl[verify a CRL]' \
+     '--generate-dh-params[generate PKCS #3 encoded Diffie Hellman parameters]' \
+     '--get-dh-params[get the included PKCS #3 encoded Diffie Hellman parameters]' \
+     '--load-privkey:private key file:_files' \
+     '--load-request:certificate request file:_files' \
+     '--load-certificate:certificate file:_files' \
+     '--load-ca-privkey:certificate authority private key file:_files' \
+     '--load-ca-certificate:certificate authority certificate file:_files' \
+     '--password:password' \
+     '(-i --certificate-info)'{-i,--certificate-info}'[print information on a certificate]' \
+     '(-l --crl-info)'{-l,--crl-info}'[print information on a CRL]' \
+     '--p12-info[print information on a PKCS #12 structure]' \
+     '--p7-info[print information on a PKCS #7 structure]' \
+     '--smime-to-p7[convert S/MIME to PKCS #7 structure]' \
+     '(-k --key-info)'{-k,--key-info}'[print information on a private key]' \
+     '--fix-key[regenerate the parameters in a private key]' \
+     '--to-p12[generate a PKCS #12 structure]' \
+     '(-8 --pkcs8)'{-8,--pkcs8}'[use PKCS #8 format for private keys]' \
+     '--dsa[use DSA keys]' \
+     '--hash:hash algorithm for signing:(MD5 SHA1 RMD160)' \
+     '--export-ciphers[use weak encryption algorithms]' \
+     '--inder[use DER format for input certificates and private keys]' \
+     '--xml[use XML format for output certificates]' \
+     '--outder[use DER format for output certificates and private keys]' \
+     '--bits:number of bits for key generation' \
+     '--outfile:output file:_files ' \
+     '--infile:input file:_files ' \
+     '--template:template file to use for non-interactive operation:_files' \
+     '(-d --debug)'{-d,--debug}':debug level' \
+     '(-h --help)'{-h,--help}'[show help]' \
+     '(-v --version)'{-v,--version}'[show version]' \
+     '--copyright[shows license]'
+
+     ;;
+	(srptool)
+
+_arguments \
+     '(-u --username)'{-u,--username}':username:_users' \
+     '(-p --passwd)'{-p,--passwd}':password file:_files' \
+     '(-i --index)'{-i,--index}':index of params in tpasswd.conf' \
+     '(-s --salt)'{-s,--salt}':salt size for crypt algorithm' \
+     '--verify[just verify password]' \
+     '(-c --passwd-conf)'{-c,--passwd-conf}':password conf file:_files' \
+     '--create-conf:generate a tpasswd.conf file:_files' \
+     '(-v --version)'{-v,--version}'[show version]' \
+     '(-h --help)'{-h,--help}'[show help]'
+
+     ;;
 esac



