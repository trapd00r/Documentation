From zsh-workers-return-21330-mason-zsh=primenet.com.au@sunsite.dk Tue Jun 14 00:56:14 2005
Return-Path: <zsh-workers-return-21330-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19488 invoked from network); 14 Jun 2005 00:56:13 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Jun 2005 00:56:13 -0000
Received: (qmail 35485 invoked from network); 14 Jun 2005 00:56:07 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Jun 2005 00:56:07 -0000
Received: (qmail 9377 invoked by alias); 14 Jun 2005 00:56:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21330
Received: (qmail 9367 invoked from network); 14 Jun 2005 00:56:03 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 Jun 2005 00:56:03 -0000
Received: (qmail 35236 invoked from network); 14 Jun 2005 00:56:03 -0000
Received: from wproxy.gmail.com (64.233.184.197)
  by a.mx.sunsite.dk with SMTP; 14 Jun 2005 00:56:00 -0000
Received: by wproxy.gmail.com with SMTP id 69so1200966wra
        for <zsh-workers@sunsite.dk>; Mon, 13 Jun 2005 17:55:59 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:reply-to:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=oaG/9nw7WEtY48x7e4s3JiwOsDTumrsLATBrT7DYc+cqjd22BKd1APFtk4u5d8o0hlXEtXpEHoTKfPBFFCwBSLccs08opwoH4B0tNnzHn0DYscl1A3AUcgdW6DJbk+eXHNEFiYybQZi2mL64zfX5wjmAPLk3PtUmHyPxHDfUrXo=
Received: by 10.54.116.20 with SMTP id o20mr2880645wrc;
        Mon, 13 Jun 2005 17:55:59 -0700 (PDT)
Received: by 10.54.37.58 with HTTP; Mon, 13 Jun 2005 17:55:59 -0700 (PDT)
Message-ID: <cf7bbda9050613175557b9c4a@mail.gmail.com>
Date: Tue, 14 Jun 2005 02:55:59 +0200
From: Ulf Magnusson <ulfalizer@gmail.com>
Reply-To: Ulf Magnusson <ulfalizer@gmail.com>
To: zsh-workers@sunsite.dk
Subject: Wierd autoload problems with nested directories
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.2 required=6.0 tests=AWL,BAYES_00,RCVD_BY_IP 
	autolearn=ham version=3.0.2
X-Spam-Hits: -2.2

I keep my completion functions in /home/ulf/lib/zsh/completions and
other, general-purpose functions in its parent dir, /home/ulf/lib/zsh.
For some reason, my completions will only work ('work' as in zsh not
using its default completion behaviour for the context in question) if
I place them in /home/ulf/lib/zsh.

I set the completion and other functions up for autoloading in two
sections of my .zshrc with the following code:


fpath=3D(/home/ulf/lib/zsh/completions $fpath)
autoload -U $fpath[1]/*(:t)

fpath=3D(/home/ulf/lib/zsh $fpath)
autoload -U $fpath[1]/*(:t)


print -l ${fpath[1,3]} yields

/home/ulf/lib/zsh/completions
/home/ulf/lib/zsh
/usr/local/share/zsh/site-functions

, as expected. I do not have KSH_AUTOLOAD nor any other options I
imagine could cause this problem set. My completion function (the only
one so far), stored in the file /home/ulf/lib/zsh/completions/_xmms
looks as follows:


#compdef xmms

local directories
directories=3D( /s/Music/**/(/) )
_files -W directories -g '*.(mp3|ogg)'


(It's not done yet, do not bug me about it :) )

Ulf

