From zsh-workers-return-11470-mason-zsh=primenet.com.au@sunsite.auc.dk Fri May 19 16:14:40 2000
Return-Path: <zsh-workers-return-11470-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14044 invoked from network); 19 May 2000 16:14:38 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 May 2000 16:14:38 -0000
Received: (qmail 29335 invoked by alias); 19 May 2000 16:14:26 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11470
Received: (qmail 29328 invoked from network); 19 May 2000 16:14:25 -0000
Message-ID: <39256859.6427618F@u.genie.co.uk>
Date: Fri, 19 May 2000 17:14:17 +0100
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.73 [en] (Win95; I)
X-Accept-Language: en
MIME-Version: 1.0
To: Zsh workers <zsh-workers@sunsite.auc.dk>
Subject: PATCH: _su
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

_su got broken at some point: su user -c command uses the user's shell
to run the command.

Oliver

Index: Completion/User/_su
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/User/_su,v
retrieving revision 1.1.1.3
diff -u -r1.1.1.3 _su
--- Completion/User/_su 1999/08/23 10:07:40     1.1.1.3
+++ Completion/User/_su 2000/05/19 16:11:51
@@ -14,7 +14,7 @@
   return
 fi

-shell="${${(M@)${(@f)$(</etc/passwd)}:#root*}##*:}"
+shell="${${(M@)${(@f)$(</etc/passwd)}:#$usr*}##*:}"
 compset -n $base
 for name in $shell $shell:t -default-; do
   comp="$_comps[$name]"

