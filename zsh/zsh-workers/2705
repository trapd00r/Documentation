From zsh-workers-request@euclid.skiles.gatech.edu Thu Jan 02 18:55:09 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 3285 invoked from network); 2 Jan 1997 18:55:07 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 2 Jan 1997 18:55:07 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id NAA05024; Thu, 2 Jan 1997 13:54:15 -0500 (EST)
Resent-Date: Thu, 2 Jan 1997 13:54:15 -0500 (EST)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199701021855.TAA12438@bolyai.cs.elte.hu>
Subject: Re: merged Makefile fixes
In-Reply-To: <1407.199701021433@stone.dcs.warwick.ac.uk> from Zefram at "Jan 2, 97 02:33:03 pm"
To: zefram@dcs.warwick.ac.uk (Zefram)
Date: Thu, 2 Jan 1997 19:55:18 +0100 (MET)
Cc: zsh-workers@math.gatech.edu
Organization: Dept. of Comp. Sci., Eotvos University, Budapest, Hungary
Phone: (36 1)2669833 ext: 2667, home phone: (36 1) 2752368
X-Mailer: ELM [version 2.4ME+ PL27 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"6mYQW1.0.RE1.MH0po"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2705
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Zefram wrote:
> This patch also makes sure that the Makefile passes all necessary
> parameters to the scripts, and avoids relying on #!.

And it also assumes that the `.' builtin set positional parameters.
Fix included below.

Zoltan


*** Src/Makefile.in	1997/01/02 16:28:02	3.1.1.17
--- Src/Makefile.in	1997/01/02 18:50:24
***************
*** 212,222 ****
  	fi
  
  bltinmods.list: $(MODBINS) $(XMODCF) mkbltnmlst.sh
! 	srcdir='$(srcdir)'; \
! 	CFSED='$(CFSED)'; \
! 	MODBINS='$(MODBINS)'; \
! 	XMODCF='$(XMODCF)'; \
! 	. $(srcdir)/mkbltnmlst.sh $@
  
  zshxmods.h: $(MODBINS) $(XMODCF)
  	@echo "Creating \`$@'."
--- 212,219 ----
  	fi
  
  bltinmods.list: $(MODBINS) $(XMODCF) mkbltnmlst.sh
! 	srcdir='$(srcdir)' CFSED='$(CFSED)' MODBINS='$(MODBINS)' \
! 	XMODCF='$(XMODCF)' $(SHELL) $(srcdir)/mkbltnmlst.sh $@
  
  zshxmods.h: $(MODBINS) $(XMODCF)
  	@echo "Creating \`$@'."
***************
*** 249,262 ****
  $(PROTO): makepro.sed
  
  $(NSTMP): $(MODBINS) $(MODCF) mkstamp.sh proto FORCE
! 	@srcdir='$(srcdir)'; \
! 	CFSED='$(CFSED)'; \
! 	MODBINS='$(MODBINS)'; \
! 	MODCF='$(MODCF)'; \
! 	MODULE_DIRS='$(MODULE_DIRS)'; \
! 	MAKE='$(MAKE)'; \
! 	MAKEDEFS="$(MAKEDEFS)"; \
! 	. $(srcdir)/mkstamp.sh $@
  
  FORCE:
  
--- 246,254 ----
  $(PROTO): makepro.sed
  
  $(NSTMP): $(MODBINS) $(MODCF) mkstamp.sh proto FORCE
! 	@srcdir='$(srcdir)' CFSED='$(CFSED)' MODBINS='$(MODBINS)' \
! 	MODCF='$(MODCF)' MODULE_DIRS='$(MODULE_DIRS)' MAKE='$(MAKE)' \
! 	MAKEDEFS="$(MAKEDEFS)" $(SHELL) $(srcdir)/mkstamp.sh $@
  
  FORCE:
  

