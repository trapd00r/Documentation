From suzuki@otsl.oki.co.jp Mon Jul  8 17:59:29 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id RAA18055 for <mason@werple.mira.net.au>; Mon, 8 Jul 1996 17:59:26 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id DAA03114; Mon, 8 Jul 1996 03:47:46 -0400 (EDT)
Resent-Date: Mon, 8 Jul 1996 03:47:46 -0400 (EDT)
X-Authentication-Warning: dorothy.fantasy.otsl.oki.co.jp: mail set sender to <suzuki@oz.fantasy.otsl.oki.co.jp> using -f
Date: Mon, 8 Jul 96 16:45:02 JST
Message-Id: <9607080745.AA07593@oz.fantasy.otsl.oki.co.jp>
From: suzuki@otsl.oki.co.jp (SUZUKI Hisao)
Organization: Oki Technosystems Laboratory, Inc., Nagoya, Japan
To: hzoli@cs.elte.hu
Cc: zsh-workers@math.gatech.edu
In-Reply-To: <199607080143.DAA05753@hzoli.ppp.cs.elte.hu> (message from Zoltan Hidvegi on Mon, 8 Jul 1996 03:43:48 +0200 (MET DST))
Subject: Re: zsh-3.0-pre1: speed up the "list-choices" etc.
Resent-Message-ID: <"uqhKr3.0.am.XqBun"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1563
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1761
Status: OR

Zoltan Hidvegi <hzoli@cs.elte.hu> wrote:
>SUZUKI Hisao wrote:
>> etc. by improving the z-shell.  It is `nicezputs' in Src/utils.c
>> that displays the string of completion list, and its current
>> implementation calls `fputs' for each character in the string.
>> Modifying Src/utils.c so that `nicezputs' calls `fputs' once for
>> all characters, the speed becomes tolerable even on the slow
>> terminal.
>
>The speed difference should not be noticeable if the output goes to a
>buffered stream.  If the output is not buffered that's really a bug.

Indeed the speed difference is hardly noticeable on
Sparc-SunOS4.1, but it is noticeable on both i860-SysV4.0 and
Sparc-Solaris2.3 (Solaris2 is a version of SysV4 in fact, you
know).

Certainly it is utterly intolerable only with slow I/O (and slow
CPU), the difference is _noticeable_ even if you use a
high-speed terminal (such as xterm on X11) and a not-so-slow CPU
(such as SPARCstation5 running Solaris2.3).  For example, you
can see the listing displayed character-by-character on xterm
running Sparc-Solaris2.3 z-shell:

	% cd zsh-3.0-pre1/Src
	% <^L>				[clear-screen]
	% ls <SPC><^D>			[delete-char-or-list]
	zsh: do you wish to see all 114 possibilities? y
	[...listing displayed character-by-character...]

Undoubtedly the output is not buffered on these machines, and I
doubt if it is a bug in itself.

# BTW, `Suzuki' is my family name and `Hisao' is my given name.
# In Japan, the family name comes first and the given name last,
# as in Hungary.  As you call yourself `Zoltan Hidvegi' in
# English context, I'd better have called myself `Hisao Suzuki'
# as long before...

Regards,

SUZUKI Hisao		# `Begin at the beginning and go on till
suzuki@otsl.oki.co.jp	# you come to the end:  then stop.'


