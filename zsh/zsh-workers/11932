From zsh-workers-return-11932-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 15 15:17:20 2000
Return-Path: <zsh-workers-return-11932-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22383 invoked from network); 15 Jun 2000 15:17:18 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Jun 2000 15:17:18 -0000
Received: (qmail 24139 invoked by alias); 15 Jun 2000 15:17:12 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11932
Received: (qmail 24131 invoked from network); 15 Jun 2000 15:17:11 -0000
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14664.62324.943668.637973@hatchet.fc.hp.com>
Date: Thu, 15 Jun 2000 09:17:08 -0600 (MDT)
From: Matthew Lovell <lovell@fc.hp.com>
To: Zsh Workers List <zsh-workers@sunsite.auc.dk>
Subject: Problem compiling 3.1.9 under HP-UX 10.20
X-Mailer: VM 6.75 under 21.1 (patch 9) "Canyonlands" XEmacs Lucid
Sender: lovell@hatchet.fc.hp.com

Hi,

I've gotten zsh-3.1.9 to compile on my workstation, but only by
excluding zftp.  The etc/MACHINES file doesn't state anything special
about HP-UX.

zsh configuration
-----------------
zsh version               : 3.1.9
host operating system     : hppa2.0-hp-hpux10.20
source code location      : .
compiler                  : gcc
preprocessor flags        :
executable compiler flags :  -Wall -Wno-implicit -Wmissing-prototypes -O2
module compiler flags     :  -Wall -Wno-implicit -Wmissing-prototypes -O2 -fpic
executable linker flags   :   -s -Wl,-E
module linker flags       :   -s -b
library flags             : -lcurses -lm -lc
installation basename     : zsh
binary install path       : /opt/zsh-3.1.9/bin
man page install path     : /opt/zsh-3.1.9/man
info install path         : /opt/zsh-3.1.9/info
functions install path    : /opt/zsh-3.1.9/share/zsh/3.1.9/functions
installed functions       : Core/* Base/* Builtins/* User/* Commands/* Debian/* Linux/* Bsd/* AIX/* X/* Zle/* Prompts/* Misc/* Zftp/*  

gcc version 2.95.2 19991024 (release)

Results
-------
gcc -c -I.  -DHAVE_CONFIG_H -DMODULE -Wall -Wno-implicit -Wmissing-prototypes -O2 -fpic -o zftp..o zftp.c
zftp.c: In function `getipnodebyname':
zftp.c:211: `h_errno' undeclared (first use in this function)
zftp.c:211: (Each undeclared identifier is reported only once
zftp.c:211: for each function it appears in.)
zftp.c: In function `gethostbyname2':
zftp.c:223: `h_errno' undeclared (first use in this function)
zftp.c: In function `zfgetline':
zftp.c:726: warning: variable `added' might be clobbered by `longjmp' or `vfork'
zftp.c:728: warning: variable `pcur' might be clobbered by `longjmp' or `vfork'
zftp.c:724: warning: argument `lnsize' might be clobbered by `longjmp' or `vfork'
zftp.c: In function `zftp_open':
zftp.c:1847: warning: argument `args' might be clobbered by `longjmp' or `vfork'
zftp.c: In function `zftp_local':
zftp.c:2619: warning: long int format, off_t arg (arg 2) 


Looking on a Linux box, it looks like h_errno is declared in netdb.h.
My HP-UX version only defines that conditionally,

#ifdef _XOPEN_SOURCE_EXTENDED
extern int h_errno;
#endif    

I will give that a try and see if I'm more successful.  Perhaps that
define should be mentioned for HP-UX.

Please include me on any replies, as I'm not a member of zsh-workers. 
Zsh 3.1.9 is an amazing piece of work, BTW!  

Thanks,
  Matt

-- 
Matthew Lovell
HP Technical Solutions Lab
mailto:lovell@fc.hp.com

