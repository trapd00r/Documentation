From zsh-workers-return-13398-mason-zsh=primenet.com.au@sunsite.dk Mon Jan 29 14:56:06 2001
Return-Path: <zsh-workers-return-13398-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6779 invoked from network); 29 Jan 2001 14:56:05 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 29 Jan 2001 14:56:05 -0000
Received: (qmail 8897 invoked by alias); 29 Jan 2001 14:55:59 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13398
Received: (qmail 8886 invoked from network); 29 Jan 2001 14:55:59 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>
Subject: termcap moodule problem on Cygwin
Date: Mon, 29 Jan 2001 17:55:53 +0300
Message-ID: <001601c08a03$93fb5170$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400
Importance: Normal

Cygwin has only static libtermcap. It gets linked twice - into main zsh
(libzsh to be sure) where term is (re-)initalized and into termcap.dll where
bin_echotc is defined. Only first one calls tgetent() so every call to `echotc
cap' crashes somewhere in termcap.

Calling tgetent in bin_echotc is not an option because it won't catch changed
TERM. It means that code to deal with terminal should exist exactly once - in
main zsh or in module. I vote for moving it into zle (after all, it is the
only module that should care for TERM) together with bin_echotc. In any case,
it makes idea of echotc in seperate module very questionable.

Note, that Cygwin is not the only system with static termcap/terminfo.

-andrej

Have a nice DOS!
B >>

