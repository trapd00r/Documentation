From zsh-workers-return-9733-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Feb 15 09:19:08 2000
Return-Path: <zsh-workers-return-9733-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17244 invoked from network); 15 Feb 2000 09:19:07 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Feb 2000 09:19:07 -0000
Received: (qmail 10627 invoked by alias); 15 Feb 2000 09:18:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9733
Received: (qmail 10619 invoked from network); 15 Feb 2000 09:18:55 -0000
Date: Tue, 15 Feb 2000 10:18:54 +0100 (MET)
Message-Id: <200002150918.KAA11998@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Sven Wischnowsky's message of Tue, 15 Feb 2000 10:02:59 +0100
	(MET)
Subject: Re: PATCH: context names


Waitamoment...

Hm, we can't get defaults from $SELECTMIN and $ZLS_COLO(|U)RS because
they may contain the values the completion system set them to.

Should we put them back in compinit?

Bye
 Sven

diff -ru ../z.old/Completion/Core/_main_complete Completion/Core/_main_complete
--- ../z.old/Completion/Core/_main_complete	Tue Feb 15 10:04:28 2000
+++ Completion/Core/_main_complete	Tue Feb 15 10:16:42 2000
@@ -45,7 +45,14 @@
 
 _setup default
 _def_menu_style=( "$_last_menu_style[@]"
-                  ${SELECTMIN+select${SELECTMIN:+\=$SELECTMIN}} )
+
+# We can't really do that because the current value of $SELECTMIN
+# may be the one set by this function.
+# There is a similar problem with $ZLS_COLORS in _setup.
+
+#                  ${SELECTMIN+select${SELECTMIN:+\=$SELECTMIN}}
+
+                )
 _last_menu_style=()
 
 # Get the names of the completers to use in the positional parameters.
diff -ru ../z.old/Completion/Core/_setup Completion/Core/_setup
--- ../z.old/Completion/Core/_setup	Tue Feb 15 10:04:28 2000
+++ Completion/Core/_setup	Tue Feb 15 10:15:41 2000
@@ -9,9 +9,13 @@
   else
     eval "ZLS_COLORS=\"(${1})\${(j.:(${1}).)\${(@)val:gs/:/\\\:}}:\${ZLS_COLORS}\""
   fi
-elif [[ "$1" = default && -n "$ZLS_COLORS$ZLS_COLOURS" ]]; then
-  zmodload -i zsh/complist
-  ZLS_COLORS="$ZLS_COLORS$ZLS_COLOURS"
+
+# Here is the problem mentioned in _main_complete.
+
+# elif [[ "$1" = default && -n "$ZLS_COLORS$ZLS_COLOURS" ]]; then
+#   zmodload -i zsh/complist
+#   ZLS_COLORS="$ZLS_COLORS$ZLS_COLOURS"
+
 fi
 
 if zstyle -s ":completion:${curcontext}:$1" list-packed val; then

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

