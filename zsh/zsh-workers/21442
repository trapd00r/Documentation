From zsh-workers-return-21442-mason-zsh=primenet.com.au@sunsite.dk Mon Jul 11 17:41:13 2005
Return-Path: <zsh-workers-return-21442-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15538 invoked from network); 11 Jul 2005 17:41:12 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Jul 2005 17:41:12 -0000
Received: (qmail 40475 invoked from network); 11 Jul 2005 17:41:06 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Jul 2005 17:41:06 -0000
Received: (qmail 12689 invoked by alias); 11 Jul 2005 17:41:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21442
Received: (qmail 12679 invoked from network); 11 Jul 2005 17:41:03 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 11 Jul 2005 17:41:03 -0000
Received: (qmail 40198 invoked from network); 11 Jul 2005 17:41:03 -0000
Received: from dsl3-63-249-88-2.cruzio.com (HELO dot.blorf.net) (63.249.88.2)
  by a.mx.sunsite.dk with SMTP; 11 Jul 2005 17:40:57 -0000
Received: by dot.blorf.net (Postfix, from userid 1000)
	id C31CC2B2; Mon, 11 Jul 2005 10:40:55 -0700 (PDT)
Date: Mon, 11 Jul 2005 10:40:55 -0700
From: Wayne Davison <wayned@users.sourceforge.net>
To: zsh-workers@sunsite.dk
Subject: Re: Very wierd output problems
Message-ID: <20050711174055.GB9294@blorf.net>
References: <cf7bbda90507110747669da77b@mail.gmail.com> <20050711151454.GH12208@ruby.cat.pdx.edu>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20050711151454.GH12208@ruby.cat.pdx.edu>
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

On Mon, Jul 11, 2005 at 08:14:54AM -0700, Travis Spencer wrote:
> Try this:
> 
> setopt NO_PROMPTCR

Since that suggestion causes screen-update problems when editing after a
line of partial output, I think it is better to point people at the zsh
FAQ (http://zsh.sunsite.dk/FAQ/zshfaq03.html#l40) where they will be
introduced to a much better solution:

function precmd {
    echo -n ${(l:$COLUMNS:::):-}
}

The only downside of that is that some X terminals include the trailing
white-space when line-selecting something that was output without a
newline.

I think we should take this solution and turn it into a zsh option that
is enabled by default for interactive sessions.  Perhaps name it
PRE_PROMPT_SPACES.  Can anyone see a problem with that?  The option will
not succeed at making partial output visible when the terminal does not
allow line-wrapping, so perhaps the code would notice if the current
terminal was not going to benefit from the heuristic and skip outputting
the spaces in such circumstances.

..wayne..

