From zsh-workers-return-8566-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Nov 05 14:42:57 1999
Return-Path: <zsh-workers-return-8566-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21986 invoked from network); 5 Nov 1999 14:42:55 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 5 Nov 1999 14:42:55 -0000
Received: (qmail 20422 invoked by alias); 5 Nov 1999 14:42:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8566
Received: (qmail 20414 invoked from network); 5 Nov 1999 14:42:35 -0000
Date: Fri, 5 Nov 1999 15:42:33 +0100 (MET)
Message-Id: <199911051442.PAA06498@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: small fix for _tags


Oops. No good defining a parameter local and later try to set it
globally.


Bye
 Sven

diff -u -r oldcompletion/Core/_tags Completion/Core/_tags
--- oldcompletion/Core/_tags	Fri Nov  5 13:52:40 1999
+++ Completion/Core/_tags	Fri Nov  5 15:40:08 1999
@@ -1,7 +1,7 @@
 #autoload
 
 if (( $# )); then
-  local cmd="$words[1]" func="$funcstack[2]" defs i tags tag pat style prio
+  local cmd="$words[1]" func="$funcstack[2]" defs i ttags tag pat style prio
   local trynow
 
   while getopts 'c:f:i' i; do
@@ -38,7 +38,7 @@
     defs=( "$defs[@]" "$prio[@]" )
   done
 
-  tags=()
+  ttags=()
   for i in "$defs[@]"; do
     tag="${i%%:*}"
     for pat in "${(s.:.)i#*:}"; do
@@ -58,7 +58,7 @@
 
 	(( prio++ ))
 
-        tags[$prio]="${tags[$prio]}:${tag}${style}"
+        ttags[$prio]="${ttags[$prio]}:${tag}${style}"
         break
       fi
     done
@@ -66,7 +66,7 @@
 
   prio="_prio_arr$(( _prio_num++ ))"
   _prio_names[$funcstack]="$prio"
-  eval "${prio}=( \"\${(@)tags:#}\" )"
+  eval "${prio}=( \"\${(@)ttags:#}\" )"
 
   [[ -z "$trynow" ]] && return 0
 fi

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

