From zsh-workers-return-19762-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 13 01:52:54 2004
Return-Path: <zsh-workers-return-19762-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4637 invoked from network); 13 Apr 2004 01:52:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 13 Apr 2004 01:52:52 -0000
Received: (qmail 9263 invoked by alias); 13 Apr 2004 01:52:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19762
Received: (qmail 9568 invoked from network); 13 Apr 2004 01:37:39 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 13 Apr 2004 01:37:39 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 13 Apr 2004 1:37:39 -0000
Received: (qmail 19634 invoked from network); 13 Apr 2004 01:37:39 -0000
Received: from lakermmtao02.cox.net (68.230.240.37)
  by a.mx.sunsite.dk with SMTP; 13 Apr 2004 01:37:36 -0000
Received: from gwendolyn.in.ql.org ([68.100.32.28]) by lakermmtao02.cox.net
          (InterMail vM.6.01.03.02 201-2131-111-104-20040324) with ESMTP
          id <20040413013709.HCOH2323.lakermmtao02.cox.net@gwendolyn.in.ql.org>;
          Mon, 12 Apr 2004 21:37:09 -0400
Received: from soup.in.ql.org (soup.in.ql.org [10.160.59.17])
	by gwendolyn.in.ql.org (8.12.11/8.12.11/Debian-1) with ESMTP id i3D1b8nD024498;
	Mon, 12 Apr 2004 21:37:08 -0400
Received: from soup.in.ql.org (localhost [127.0.0.1])
	by soup.in.ql.org (8.12.11/8.12.11/Debian-3) with ESMTP id i3D1b87e004769;
	Mon, 12 Apr 2004 21:37:08 -0400
Received: (from ejb@localhost)
	by soup.in.ql.org (8.12.11/8.12.11/Debian-3) id i3D1b5CW004764;
	Mon, 12 Apr 2004 21:37:05 -0400
Date: Mon, 12 Apr 2004 21:37:05 -0400
Message-Id: <200404130137.i3D1b5CW004764@soup.in.ql.org>
From: Jay Berkenbilt <ejb@ql.org>
To: clint@zsh.org
CC: zsh-workers@sunsite.dk, 243385-forwarded@bugs.debian.org
In-reply-to: <20040413012117.GA9729@scowler.net> (clint@zsh.org)
Subject: Re: [ejb@ql.org: Bug#243385: zsh: rsync completion expands * too soon]
References: <20040413012117.GA9729@scowler.net>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 1.5



>   I assume that this is a quoting issue again.

Yes.  Well, kind of.  It's an eval issue.  The call to _call_program
(which I have removed) causes the wildcard to be expanded too early
because it calls eval.  Here's a trace excerpt.

+_rsync_remote_files:37> remfiles=+_rsync_remote_files:1> _call_program files ssh -a -x apex ls -d1F '/*'
+_call_program:3> local tmp
+_call_program:5> zstyle -s :completion::complete:rsync:argument-rest:files command tmp
+_call_program:12> eval 'ssh -a -x apex ls -d1F /*'
+(eval):1> ssh -a -x apex ls -d1F /bin /boot /cdrom /cdrom0 /dark /dark2 /dev /etc /fc1 /floppy /home /initrd /initrd.img /initrd.img.old /lib /mnt /opt /proc /projects /.rnd /root /sbin /smb /sys /systems /tmp /tmp-Xhack /u1 /u2 /usr /var /vmlinuz
+_rsync_remote_files:37> remfiles=( /bin/ /boot/ /dev/ /etc/ /home@ /initrd/ /lib/ /mnt/ /opt/ /proc/ /projects@ /root/ /sbin/ /smb/ /systems/ /tmp/ /usr/ /var/ )
The ls command ("(eval:1)" above) does an ls on the remote system
after having expanded the wildcard on my local system.

--Jay

