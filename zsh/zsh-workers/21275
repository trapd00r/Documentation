From zsh-workers-return-21275-mason-zsh=primenet.com.au@sunsite.dk Wed May 25 13:46:21 2005
Return-Path: <zsh-workers-return-21275-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21605 invoked from network); 25 May 2005 13:46:20 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 25 May 2005 13:46:20 -0000
Received: (qmail 48880 invoked from network); 25 May 2005 13:46:14 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 25 May 2005 13:46:14 -0000
Received: (qmail 16399 invoked by alias); 25 May 2005 13:46:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21275
Received: (qmail 16380 invoked from network); 25 May 2005 13:46:10 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 25 May 2005 13:46:10 -0000
Received: (qmail 48499 invoked from network); 25 May 2005 13:46:10 -0000
Received: from grunt24.ihug.com.au (203.109.249.144)
  by a.mx.sunsite.dk with SMTP; 25 May 2005 13:46:06 -0000
Received: from 203-173-55-65.dyn.iinet.net.au (localhost.localdomain) [203.173.55.65] 
	by grunt24.ihug.com.au with esmtp (Exim 3.35 #1 (Debian))
	id 1DawCf-0002AV-00; Wed, 25 May 2005 23:45:54 +1000
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by localhost.localdomain (8.12.8/8.12.8) with ESMTP id j4PDeRVA010382
	for <zsh-workers@sunsite.dk>; Wed, 25 May 2005 23:40:40 +1000
Received: (from doug@localhost)
	by localhost.localdomain (8.12.8/8.12.8/Submit) id j4PDeAu0010374
	for zsh-workers@sunsite.dk; Wed, 25 May 2005 23:40:10 +1000
X-Authentication-Warning: localhost.localdomain: doug set sender to dougkearns@gmail.com using -f
Date: Wed, 25 May 2005 23:40:10 +1000
From: Doug Kearns <dougkearns@gmail.com>
To: zsh-workers@sunsite.dk
Subject: PATCH: raggle completion update
Message-ID: <20050525134010.GF4400@localhost.localdomain>
Mail-Followup-To: zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.4i
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00,RCVD_IN_SORBS_WEB 
	autolearn=ham version=3.0.2
X-Spam-Hits: -2.6

Just an update for version 0.4.0 of raggle.

Regards,
Doug

Index: Completion/Unix/Command/_raggle
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_raggle,v
retrieving revision 1.3
diff -u -r1.3 _raggle
--- Completion/Unix/Command/_raggle	26 Feb 2004 13:07:26 -0000	1.3
+++ Completion/Unix/Command/_raggle	25 May 2005 13:38:05 -0000
@@ -1,29 +1,46 @@
 #compdef raggle
 
-# Raggle v0.3.0
+# Raggle v0.4.0
 
-_arguments \
-  '(-a --add --add-feed)'{-a,--add,--add-feed}"[add a new feed (requires '--url')]" \
-  '--ascii[use ASCII characters instead of ANSI for window borders]' \
-  '(-c --config)'{-c,--config}'[specify an alternate config file]:config file:_files' \
-  '(-d --delete --delete-feed)'{-d,--delete,--delete-feed}'[delete an existing feed]:feed ID:' \
-  '(-e --edit --edit-feed)'{-e,--edit,--edit-feed}'[edit an existing feed]:feed ID:' \
+local curcontext="$curcontext" state line
+typeset -A opt_args
+
+_arguments -C -s \
+  '(-a --add)'{-a,--add}"[add a new feed (requires '--url')]" \
+  '(-A --ascii)'{-A,--ascii}'[use ASCII characters instead of ANSI for window borders]' \
+  '(-c --config)'{-c,--config}'[specify an alternate config file]:config file:_files -g "*.yaml(-.)"' \
+  '(-d --delete)'{-d,--delete}'[delete an existing feed]:feed ID:->feed' \
+  '--diag[run raggle in diagnostics/debug mode]' \
+  '(-e --edit)'{-e,--edit}'[edit an existing feed]:feed ID:->feed' \
   '(--import-opml)--export-opml[export feeds to OPML]:OPML file:_files -g "*.opml(-.)"' \
+  '(-f --find)'{-f,--find}'[find feeds containing a string, via Syndic8]:search string:' \
   "--force[force behavior Raggle won't normally allow]" \
   '(-)'{-h,--help,--usage}'[display help information]' \
   '(--export-opml)--import-opml[import feeds from an OPML file]:OPML file:_files -g "*.opml(-.)"' \
-  '(-i --invalidate)'{-i,--invalidate}'[invalidate a feed (force an update)]:feed ID:' \
+  '(-i --invalidate)'{-i,--invalidate}'[invalidate a feed (force an update)]:feed ID:->feed' \
   '(-l --list)'{-l,--list}"[list existing feeds (use '--verbose' to show URLs as well)]" \
   "--lock-title[lock Title attribute of feed (for '--add' and '--edit')]" \
-  "--max-items[set the maximum number of items for a feed (for '--add' and '--edit')]" \
+  "--max[set the maximum number of items for a feed (for '--add' and '--edit')]" \
+  '(-p --priority)'{-p,--priority}"[feed sorting priority: 0 by default, higher values will sort feeds to the top (for '--add' and '--edit')]:sorting priority:" \
   '--purge[purge deleted feeds from feed cache]' \
   '(-r --refresh)'{-r,--refresh}"[refresh attribute of feed (for '--add' and '--edit')]:refresh time (minutes):" \
   "--save-items[save old items of feed (for '--add' and '--edit')]" \
   '--server[run Raggle in HTTP server mode]:port:_ports' \
-  '(--sort --sort-feeds)'{--sort,--sort-feeds}'[sort feeds by title (case-insensitive)]' \
+  '(--sort --sort-feeds)'{--sort,--sort-feeds}'[sort feeds by priority then title (case-insensitive)]' \
   '(-t --title)'{-t,--title}"[title attribute of feed (for '--add' and '--edit')]:feed title:" \
   "--unlock-title[unlock Title attribute of feed (for '--add' and '--edit')]" \
   "--unsave-items[don't save old items of feed (for '--add' and '--edit')]" \
   '(-u --url)'{-u,--url}"[URL attribute of feed (for '--add' and '--edit')]:URL:_urls" \
   '--verbose[turn on verbose output]' \
-  '(-)'{-v,--version}'[display version information]'
+  '(-)'{-v,--version}'[display version information]' && return 0
+
+if [[ "$state" = feed ]]; then
+  local feeds
+  feeds=(
+    ${${(M)${${(f)"$(_call_program screen-sessions $words[1] \
+        --list)"}/(#s)[[:blank:]]/}:#[0-9]##,*}/, /:}
+  )
+  _describe -t feeds "RSS feeds" feeds && return 0
+fi
+
+return 1

