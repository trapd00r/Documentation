From zsh-workers-return-26224-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 01 14:33:05 2009
Return-Path: <zsh-workers-return-26224-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13169 invoked from network); 1 Jan 2009 14:33:02 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Jan 2009 14:33:02 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 69884 invoked from network); 1 Jan 2009 14:32:56 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Jan 2009 14:32:56 -0000
Received: (qmail 995 invoked by alias); 1 Jan 2009 14:32:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26224
Received: (qmail 980 invoked from network); 1 Jan 2009 14:32:51 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 1 Jan 2009 14:32:51 -0000
Received: from fg-out-1718.google.com (fg-out-1718.google.com [72.14.220.153])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 63D9180525C7
	for <zsh-workers@sunsite.dk>; Thu,  1 Jan 2009 15:32:48 +0100 (CET)
Received: by fg-out-1718.google.com with SMTP id e21so2040216fga.37
        for <zsh-workers@sunsite.dk>; Thu, 01 Jan 2009 06:32:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to
         :subject:mime-version:content-type:content-transfer-encoding
         :content-disposition;
        bh=qva2MjF9G8o6dIRXZBm7c5TQmjg9gMf4/V00Sh4dJEk=;
        b=OXyM1bXzvQzJq/3f+ObYJklTUkF1IT99NzA5oPxzLflm52dfCQR/98bLd0iFprO1UI
         yyHk5zwPZUfhPR/ZhSLXCD5wNoQJlqXJyhIGufF0+qFSH1MwSDwhCLiDOTW5UjmsUGOs
         5LPRTkA+ZpC/Q90TpHW5t44jGAcR51hDL5C6M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type
         :content-transfer-encoding:content-disposition;
        b=spR0i5IwYu/5z8jJ9BEguayYPIkroFwp55DNgSvOocRGSrfWAlx+U5+U6V5rVvtt0O
         aLDqMupS63XyO2hFwBzLzuMicU2hYE0Q0LLvD7BXX+Nl5u+DUF7vqr6+NUcn9p6KjbLJ
         52YM/K4YVE4Gx2zC+T5KeHGyKGkQh1FEv1ioI=
Received: by 10.86.76.16 with SMTP id y16mr9941451fga.17.1230820367707;
        Thu, 01 Jan 2009 06:32:47 -0800 (PST)
Received: by 10.86.62.8 with HTTP; Thu, 1 Jan 2009 06:32:47 -0800 (PST)
Message-ID: <2d460de70901010632q3f2c1156x36a8d1e8a4445dd4@mail.gmail.com>
Date: Thu, 1 Jan 2009 15:32:47 +0100
From: "Richard Hartmann" <richih.mailinglist@gmail.com>
To: "Zsh Workers" <zsh-workers@sunsite.dk>
Subject: Security hole in history handling for root
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Scanned: ClamAV 0.92.1/8823/Thu Jan  1 09:38:47 2009 on bifrost
X-Virus-Status: Clean

Hi all,

zsh does not complain when loading from or writing
to a history file which is not owned by root or 600.

My suggestion is that a warning similar to compaudit's
is introduced, both on loading and writing. People who
share history between root and their normal users might
appreciate an option to turn this off, but personally, I
think that is bad style, anyway.

For reference:

roadwarrior ~ # l .zsh_history
-rw-rw-rw- 1 richih richih 78515 2009-01-01 15:23 .zsh_history
roadwarrior ~ # zsh
roadwarrior ~ # mv .zsh zsh
roadwarrior ~ # ln -s /home/richih/.zsh .zsh
roadwarrior ~ # zsh
zsh compinit: insecure directories, run compaudit for list.
Ignore insecure directories and continue [y] or abort compinit [n]?


Richard

