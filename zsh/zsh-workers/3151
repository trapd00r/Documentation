From zsh-workers-request@euclid.skiles.gatech.edu Thu May 15 11:08:40 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 6885 invoked from network); 15 May 1997 11:08:38 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 15 May 1997 11:08:38 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id GAA14348; Thu, 15 May 1997 06:49:43 -0400 (EDT)
Resent-Date: Thu, 15 May 1997 06:49:43 -0400 (EDT)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <970515035240.ZM381@candle.brasslantern.com>
Date: Thu, 15 May 1997 03:52:39 -0700
In-Reply-To: <199705150908.LAA28604@hydra.ifh.de>
Comments: In reply to Peter Stephenson <pws@ifh.de>
        "Re: stopping "wait" in (sub)script ?" (May 15, 11:07am)
References: <199705150908.LAA28604@hydra.ifh.de>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Peter Stephenson <pws@ifh.de>,
        zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: stopping "wait" in (sub)script ?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"vHv7l3.0.7W3.7fkUp"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3151
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On May 15, 11:07am, Peter Stephenson wrote:
} Subject: Re: stopping "wait" in (sub)script ?
}
} > > > $ for i in `cat ss`
} > 
} > OK, now I got it.  The fix looks really simple, and I do hope that this is
} > really al that's needed.
} 
} This doesn't seem to fix this particular bug here, it's still
} uninterruptible.  On the other hand, replacing `cat ss` with $(<ss)
} has always worked.  That doesn't leave much code in getoutput() to
} make the difference.

I think the problem must be in signal_suspend().  The only difference
between the two cases in getoutput() is that $(<ss) does an explicit
child_unblock(), whereas `cat ss` does it implicitly via child_suspend(0).

If you go look at signal_suspend(), you'll find a lot of #ifdefs for the
assorted signal handling variations.  I'll bet this problem is specific
to one or more of those variations.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts        http://www.nbn.com/people/lantern

