From zsh-workers-return-20436-mason-zsh=primenet.com.au@sunsite.dk Fri Oct 01 18:27:49 2004
Return-Path: <zsh-workers-return-20436-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21211 invoked from network); 1 Oct 2004 18:27:48 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Oct 2004 18:27:48 -0000
Received: (qmail 6131 invoked from network); 1 Oct 2004 18:27:43 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2004 18:27:43 -0000
Received: (qmail 9324 invoked by alias); 1 Oct 2004 18:27:30 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20436
Received: (qmail 9311 invoked from network); 1 Oct 2004 18:27:29 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 1 Oct 2004 18:27:29 -0000
Received: (qmail 5583 invoked from network); 1 Oct 2004 18:27:29 -0000
Received: from lhuumrelay3.lnd.ops.eu.uu.net (62.189.58.19)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2004 18:27:28 -0000
Received: from MAILSWEEPER01.csr.com (mailhost1.csr.com [62.189.183.235])
	by lhuumrelay3.lnd.ops.eu.uu.net (8.11.0/8.11.0) with ESMTP id i91IRRv09309
	for <zsh-workers@sunsite.dk>; Fri, 1 Oct 2004 18:27:27 GMT
Received: from EXCHANGE02.csr.com (unverified [192.168.137.45]) by MAILSWEEPER01.csr.com
 (Content Technologies SMTPRS 4.3.12) with ESMTP id <T6c625de5ebc0a88d013d0@MAILSWEEPER01.csr.com> for <zsh-workers@sunsite.dk>;
 Fri, 1 Oct 2004 19:26:28 +0100
Received: from news01.csr.com ([192.168.143.38]) by EXCHANGE02.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Fri, 1 Oct 2004 19:29:25 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.12.11/8.12.11) with ESMTP id i91IRLaC009048
	for <zsh-workers@sunsite.dk>; Fri, 1 Oct 2004 19:27:21 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.12.11/8.12.11/Submit) with ESMTP id i91IRLGO009045
	for <zsh-workers@sunsite.dk>; Fri, 1 Oct 2004 19:27:21 +0100
Message-Id: <200410011827.i91IRLGO009045@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: [joshk@triplehelix.org: Bug#271196: makefile completion catches some delayed expansions as targets] 
In-reply-to: <20041001173932.GB26529@blorf.net> 
References: <20040911231628.GA17128@scowler.net> <20040911233227.GA17389@scowler.net> <20040911234745.GA17562@scowler.net> <20040912032458.GA20842@scowler.net> <20040929223945.GB7866@blorf.net> <200409300945.i8U9ixPZ016740@news01.csr.com> <20041001173932.GB26529@blorf.net>
Date: Fri, 01 Oct 2004 19:27:21 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 01 Oct 2004 18:29:26.0079 (UTC) FILETIME=[949B14F0:01C4A7E4]
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

Wayne Davison wrote:
> On Thu, Sep 30, 2004 at 10:44:59AM +0100, Peter Stephenson wrote:
> > I did notice that this target:
> >   builds/$(CONFIG)/stamp-builddir
> > gets shortened to
> >   builds//stamp-builddir
> > 
> > I realise there it's not likely to be able to do the substitution
> > properly, but I'm not sure why it's doing it at all.
> 
> I wanted substitutions for targets such as this:
> 
> rsync$(EXEEXT): ...
> 
> so that completion returns either "rsync" or "rsync.exe", as
> appropriate.  I'm surprised that the makefile you cited didn't set
> CONFIG somewhere inside it.  Perhaps it was in an include that didn't
> get processed?

I can see your behaviour's more use, I didn't realise it was expanding
rather than removing the variables.  The makefile in question calls
itself recursively, so it's hard to predict how CONFIG will be set.  So
I don't think this needs any fundamental change.

It would be quite nice if it got set on

make CONFIG=foo <TAB>

however.  Maybe that's not too hard to add.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 692070


**********************************************************************
This email and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this email in error please notify
the system manager.

This footnote also confirms that this email message has been swept by
MIMEsweeper for the presence of computer viruses.

www.mimesweeper.com
**********************************************************************

