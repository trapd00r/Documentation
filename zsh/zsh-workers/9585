From zsh-workers-return-9585-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Feb 06 08:03:14 2000
Return-Path: <zsh-workers-return-9585-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28601 invoked from network); 6 Feb 2000 08:03:14 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Feb 2000 08:03:14 -0000
Received: (qmail 7136 invoked by alias); 6 Feb 2000 08:03:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9585
Received: (qmail 7128 invoked from network); 6 Feb 2000 08:03:08 -0000
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: zsh-3.1.6-dev-17: Doc/Makefile.in rule: Zsh/modlist.yo
References: <slrn89q5ne.l7g.mason@coral.primenet.com.au>
MIME-Version: 1.0 (generated by AKEMI 1.13.2 - =?ISO-2022-JP?B?Ig==?=
 =?ISO-2022-JP?B?GyRCQTA0Y0s8GyhCIg==?=)
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 06 Feb 2000 17:03:05 +0900
In-Reply-To: mason@primenet.com.au's message of "6 Feb 2000 06:38:38 GMT"
Message-ID: <rsqiu02pxl2.fsf@crane.jaist.ac.jp>
Lines: 39
User-Agent: Chao-gnus/6.12.5 AKEMI/1.13.2 (=?ISO-2022-JP?B?GyRCQTAbKEI=?=
 =?ISO-2022-JP?B?GyRCNGNLPBsoQg==?=) FLAM-DOODLE/1.12.6
 (=?ISO-2022-JP?B?GyRCM3cbKEI=?= 10R4.0/5.0) Emacs/20.4
 (sparc-sun-solaris2.6) MULE/4.0 (HANANOEN)

In article <slrn89q5ne.l7g.mason@coral.primenet.com.au>,
  mason@primenet.com.au (Geoff Wing) writes:

> here's a patch for building Zsh/modlist.yo.  It subdues some temperamental
> sh variants (namely mine) over ``unset'' and for some reason the test was
> failing but it works when reversed.  Note also that I've removed the
> CTRL-A's from the includefile() lines: any reason they were there?

I think suspicious `|| true' should be removed.  Although it is
required because BSD make calls /bin/sh with -e, assigning empty
string works well without it.

Index: Doc/Makefile.in
===================================================================
RCS file: /projects/zsh/zsh/Doc/Makefile.in,v
retrieving revision 1.1.1.58
diff -u -r1.1.1.58 Makefile.in
--- Doc/Makefile.in	2000/02/06 06:40:38	1.1.1.58
+++ Doc/Makefile.in	2000/02/06 07:45:17
@@ -180,14 +180,14 @@
 	    echo "enditem()"; \
 	    echo "includefile(Zsh/modmenu.yo)"; \
 	    set '' $(MODDOCSRC); \
-	    unset mod1 mod2 mod3 || true; \
+	    mod1= mod2= mod3=; \
 	    test ".$$2" = . || \
 		mod2=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < $(sdir)/$$2`; \
 	    while test ".$$2" != .; do \
-		unset mod3 || true; \
+		mod3=; \
 		test ".$$3" = . || \
 		    mod3=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < $(sdir)/$$3`; \
-		echo "texinode(The $$mod2 Module)($${mod3+The $$mod3 Module})($${mod1:+The $$mod1 Module})(Zsh Modules)"; \
+		echo "texinode(The $$mod2 Module)($${mod3:+The $$mod3 Module})($${mod1:+The $$mod1 Module})(Zsh Modules)"; \
 		echo "sect(The $$mod2 Module)"; \
 		echo "includefile($${2})"; \
 		shift; \
-- 
Tanaka Akira

