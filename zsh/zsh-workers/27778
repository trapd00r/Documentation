From zsh-workers-return-27778-mason-zsh=primenet.com.au@zsh.org Wed Mar 10 20:09:16 2010
Return-Path: <zsh-workers-return-27778-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4445 invoked by alias); 10 Mar 2010 20:09:16 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27778
Received: (qmail 29468 invoked from network); 10 Mar 2010 20:09:14 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at benizi.com designates 64.130.10.15 as permitted sender)
Date: Wed, 10 Mar 2010 15:02:25 -0500 (EST)
From: "Benjamin R. Haskell" <zsh@benizi.com>
To: Zsh Workers <zsh-workers@zsh.org>
Subject: Broken completion on $prefix/*
Message-ID: <alpine.LNX.2.01.1003101440260.31893@hp.internal>
User-Agent: Alpine 2.01 (LNX 1266 2009-07-14)
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I can't get file-completion in this context:

## define the variable '$prefix'
$ prefix=long/relative/path/to/stuff

## [slightly-OT]
## example of why that variable name made sense
## $ run-some-command --blah-dir $prefix/blah --arga-dir $prefix/arga

## example of where I wanted completion, but it didn't work
$ find $prefix/<Tab>
(shows completion for '/')

## Attempts with variable names $outputdir or $asdfdsa both work fine.
$ outputdir=$prefix
$ find $outputdir/<Tab>
(shows completion for 'long/relative/path/to/stuff')

$ asdfdsa=$prefix
$ find $asdfdsa/<Tab>
(shows completion for 'long/relative/path/to/stuff')

I assume this is an artifact of something localizing '$prefix' before 
its value is used for completion, but I don't see it right off.

Found using zsh 4.3.10 (patch level 1.4705) at work, but I'm pretty sure 
it's still present in latest git (assuming I'm setting up my fpath 
correctly on my home machine) and it's also in 4.3.4 (on an old server).

-- 
Best,
Ben

