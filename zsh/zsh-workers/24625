From zsh-workers-return-24625-mason-zsh=primenet.com.au@sunsite.dk Thu Feb 28 17:55:57 2008
Return-Path: <zsh-workers-return-24625-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13640 invoked from network); 28 Feb 2008 17:55:56 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 28 Feb 2008 17:55:56 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 73959 invoked from network); 28 Feb 2008 17:55:36 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 Feb 2008 17:55:36 -0000
Received: (qmail 8182 invoked by alias); 28 Feb 2008 17:55:33 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24625
Received: (qmail 8129 invoked from network); 28 Feb 2008 17:55:33 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 28 Feb 2008 17:55:33 -0000
Received: from cluster-g.mailcontrol.com (cluster-g.mailcontrol.com [85.115.41.190])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 71ED88026E0B
	for <zsh-workers@sunsite.dk>; Thu, 28 Feb 2008 18:55:26 +0100 (CET)
Received: from rly07g.srv.mailcontrol.com (localhost.localdomain [127.0.0.1])
	by rly07g.srv.mailcontrol.com (MailControl) with ESMTP id m1SHtDcI032651
	for <zsh-workers@sunsite.dk>; Thu, 28 Feb 2008 17:55:18 GMT
Received: from submission.mailcontrol.com (submission.mailcontrol.com [86.111.216.190])
	by rly07g.srv.mailcontrol.com (MailControl) id m1SHt6UL032132
	for zsh-workers@sunsite.dk; Thu, 28 Feb 2008 17:55:06 GMT
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly07g-eth0.srv.mailcontrol.com (envelope-sender Peter.Stephenson@csr.com) (MIMEDefang) with ESMTP id m1SHr1AY025214; Thu, 28 Feb 2008 17:55:06 +0000 (GMT)
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 28 Feb 2008 17:54:28 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id m1SHsSpj021075;
	Thu, 28 Feb 2008 17:54:28 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id m1SHsSf1021072;
	Thu, 28 Feb 2008 17:54:28 GMT
Message-Id: <200802281754.m1SHsSf1021072@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk, Romain Francoise <rfrancoise@debian.org>,
        468386@bugs.debian.org
Subject: Re: Bug#468386: zsh-beta: Slow command completion
In-reply-to: <20080228172715.GA12451@scowler.net>
References: <87zltldnde.fsf@elegiac.orebokech.com> <20080228172715.GA12451@scowler.net>
Comments: In-reply-to Clint Adams <schizo@debian.org>
   message dated "Thu, 28 Feb 2008 12:27:15 -0500."
Date: Thu, 28 Feb 2008 17:54:28 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 28 Feb 2008 17:54:28.0180 (UTC) FILETIME=[F673D940:01C87A32]
X-Scanned-By: MailControl A-08-00-04 (www.mailcontrol.com) on 10.71.1.117
X-Virus-Scanned: ClamAV 0.91.2/6027/Thu Feb 28 17:20:09 2008 on bifrost
X-Virus-Status: Clean

Clint Adams wrote:
> On Thu, Feb 28, 2008 at 06:03:41PM +0100, Romain Francoise wrote:
> > zsh-beta's command cache is apparently broken: completing a command
> > twice takes the same amount of time both times, whereas in zsh4
> > (from the zsh package) the first completion takes a few seconds and
> > subsequent completions are much faster.
> 
> This looks to be a side effect of 24570. Any ideas?

Limit the extra information for commands to people who *really* want it,
by using another style ("extra_verbose") with an appropriate warning
in the doc that this level of verbosity has speed implications.  The
style is then reusable if this crops up elsewhere.

Bart may have more drastic suggestions...

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

