From zsh-workers-request@math.gatech.edu  Thu Aug 10 03:14:06 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id DAA16352 for <mason@werple.mira.net.au>; Thu, 10 Aug 1995 03:14:03 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA02160
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Wed, 9 Aug 1995 13:15:37 -0400
Received: by math (5.x/SMI-SVR4)
	id AA19637; Wed, 9 Aug 1995 13:11:00 -0400
Resent-Date: Wed, 09 Aug 95 18:11:33 +0100
Old-Return-Path: <P.Stephenson@swansea.ac.uk>
Message-Id: <23407.9508091711@pyro.swan.ac.uk>
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: Revised dohistexpand()
In-Reply-To: "hzoli@cs.elte.hu"'s message of "Wed, 09 Aug 95 17:21:01 +0200." <199508091521.RAA02428@bolyai.cs.elte.hu>
Date: Wed, 09 Aug 95 18:11:33 +0100
From: P.Stephenson@swansea.ac.uk
X-Mts: smtp
Resent-Message-Id: <"4dPKn3.0.jo4.YmEAm"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/300
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

hzoli@cs.elte.hu wrote:
> To summarize my opinion, I do not like this patch very much.  It
> doesn't fixe s any bugs but it introduces one.  I normally bind
> magic-space to space so each time I hit space the whole line I typed
> so far goes through the lexer but the time spet there is unnoticable
> even on a slow 386/DX40 system (which I still use at home).

I'm not insistent on this patch, but anyway here's my response...

Your magic-space problems with single quotes are certainly real ---
you'd have to use \!, which does work properly in the patch (perhaps I
didn't make that clear enough) --- but if you really don't consider
expanding previous history references when trying to complete a
subsequent word a bug, our views differ substantially.  In fact, for
people not using magic-space (me, obviously --- I should guess most
people, since expansion is just a tab away, but I expect I'm about to
generate volumes of irate mail from magic-spacers) it's a lot more
important.  Unfortunately there's no easy way to reconcile the two ---
and if there is a way, I have a feeling I'd rather not see it.

Clearly people's priorities differ, but if I really have to put up
with increasing amounts of interpenetrating cruft when trying to clean
up the code, I have to say I'm rapidly going to lose interest.  To use
one call to the lexer in zle_tricky.c might be regarded as a
misfortune; to use two looks like carelessness (as Oscar Wilde put
it).

Still, now I've found out what all this code does, maybe I can work
around it some other way.  I'm hoping, eventually, to modify the
history code so that only the lines actually typed are stored, with
the word separation in a list of numbers (this uses less space since
there are not separate lexical and literal histories, while you get
all the benefits of both, and I hate HISTSPACE, and I'd like zsh to be
8-bit clean) --- maybe we can combine this so that the new history
line becomes the editing line after history expansion, so you can call
the lexer but don't need the addtoline() bits.  (It still won't fix
the expanding-in-the-wrong-word bug, though.)

-- 
Peter Stephenson <P.Stephenson@swansea.ac.uk>  Tel: +44 1792 205678 extn. 4461
WWW:  http://python.swan.ac.uk/~pypeters/      Fax: +44 1792 295324
Department of Physics, University of Wales, Swansea,
Singleton Park, Swansea, SA2 8PP, U.K.

