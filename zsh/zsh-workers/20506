From zsh-workers-return-20506-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 19 12:51:15 2004
Return-Path: <zsh-workers-return-20506-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28528 invoked from network); 19 Oct 2004 12:51:15 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 19 Oct 2004 12:51:15 -0000
Received: (qmail 8474 invoked from network); 19 Oct 2004 12:51:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 19 Oct 2004 12:51:09 -0000
Received: (qmail 5125 invoked by alias); 19 Oct 2004 12:50:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20506
Received: (qmail 5088 invoked from network); 19 Oct 2004 12:50:51 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 19 Oct 2004 12:50:51 -0000
Received: (qmail 8038 invoked from network); 19 Oct 2004 12:50:51 -0000
Received: from master.altlinux.ru (62.118.250.235)
  by a.mx.sunsite.dk with SMTP; 19 Oct 2004 12:50:47 -0000
Received: from solemn.turbinal.org (localhost.localdomain [127.0.0.1])
	by master.altlinux.ru (Postfix) with ESMTP id 05F0AE46F2
	for <zsh-workers@sunsite.dk>; Tue, 19 Oct 2004 16:50:47 +0400 (MSD)
Received: by solemn.turbinal.org (Postfix, from userid 500)
	id 5CA5350D2C; Tue, 19 Oct 2004 16:49:47 +0400 (MSD)
Date: Tue, 19 Oct 2004 16:49:47 +0400
From: Alexey Tourbin <at@altlinux.ru>
To: zsh-workers@sunsite.dk
Subject: Re: bug: _store_cache and ksh arrays
Message-ID: <20041019124947.GK2017@solemn.turbinal.org>
Mail-Followup-To: zsh-workers@sunsite.dk
References: <20041019024827.GI2017@solemn.turbinal.org> <Pine.LNX.4.61.0410182150400.28361@toltec.zanshin.com>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="7ArrI7P/b+va1vZ8"
Content-Disposition: inline
In-Reply-To: <Pine.LNX.4.61.0410182150400.28361@toltec.zanshin.com>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 1.5


--7ArrI7P/b+va1vZ8
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Mon, Oct 18, 2004 at 09:54:21PM -0700, Bart Schaefer wrote:
> > I think I found a bug.  _store_cache produces wrong output when
> > both KSH_TYPESET and MAGIC_EQUAL_SUBST are set.
>=20
> _store_cache is meant to be called from the completion system functions,
> which are meant to execute only with the setopts in the $_comp_options
> array in effect.  Nearly all functions in the completion system assume
> those settings and make no effort to work with arbitrary combinations of
> setopts.

The bug still persists when _store_cache is called from completion
system functions (this is how I tracked down _store_cache), and I believe=
=20
that the bug can be easily reproduced.

Please consider this:

$ rm -rf ~/.zcomp*
$ zsh
$ emulate -R zsh
$ zstyle ':completion::complete:*' use-cache 1
$ perl -M<TAB>
zsh: do you wish to see all 1917 possibilities (959 lines)? n
$ head -c70 ~/.zcompcache/perl_modules; echo
_perl_modules=3D( 'AcidRip::acidrip' 'AcidRip::interface' 'AcidRip::sign
$ rm -rf ~/.zcomp*
$ zsh
$ emulate -R zsh
$ setopt KSH_TYPESET MAGIC_EQUAL_SUBST
$ zstyle ':completion::complete:*' use-cache 1
$ perl -M<TAB>
zsh: do you wish to see all 1917 possibilities (959 lines)? n
$ head -c70 ~/.zcompcache/perl_modules; echo
_perl_modules=3D( 'AcidRip::acidrip AcidRip::interface AcidRip::signals
$

--7ArrI7P/b+va1vZ8
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFBdQ1qfBKgtDjnu0YRAi1TAJ4rQuJvVJqRoAoaXKs/YB26VyNKRwCgsRhw
WXCIOcUGjWcivqIu7LZ5R5M=
=kniZ
-----END PGP SIGNATURE-----

--7ArrI7P/b+va1vZ8--

