From zsh-workers-return-20644-mason-zsh=primenet.com.au@sunsite.dk Mon Jan 03 18:21:59 2005
Return-Path: <zsh-workers-return-20644-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16623 invoked from network); 3 Jan 2005 18:21:58 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Jan 2005 18:21:58 -0000
Received: (qmail 69404 invoked from network); 3 Jan 2005 18:21:48 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Jan 2005 18:21:48 -0000
Received: (qmail 14733 invoked by alias); 3 Jan 2005 18:20:41 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20644
Received: (qmail 14717 invoked from network); 3 Jan 2005 18:20:41 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 3 Jan 2005 18:20:41 -0000
Received: (qmail 66136 invoked from network); 3 Jan 2005 18:19:42 -0000
Received: from moonbase.zanshin.com (64.84.47.139)
  by a.mx.sunsite.dk with SMTP; 3 Jan 2005 18:19:38 -0000
Received: from toltec.zanshin.com (toltec.zanshin.com [64.84.47.166])
	by moonbase.zanshin.com (8.13.1/8.13.1) with ESMTP id j03IJYoE032579;
	Mon, 3 Jan 2005 10:19:34 -0800
Date: Mon, 3 Jan 2005 10:19:34 -0800 (PST)
From: Bart Schaefer <schaefer@brasslantern.com>
Reply-To: zsh-workers@sunsite.dk
To: Clint Adams <schizo@debian.org>
cc: zsh-workers@sunsite.dk, 288323-forwarded@bugs.debian.org,
        288323-submitter@bugs.debian.org
Subject: Re: and lists and suspended processes
In-Reply-To: <20050103041512.GA22489@scowler.net>
Message-ID: <Pine.LNX.4.61.0501030945070.32450@toltec.zanshin.com>
References: <20050103041512.GA22489@scowler.net>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

On Sun, 2 Jan 2005, Clint Adams wrote:

> Should zsh wait for a suspended process to exit before continuing along
> the sublist?

I believe I was involved in a related discussion not that long ago.  
Trouble is, I can't recall if it was on zsh-workers or austin-group or 
somewhere else, and searching the zsh archives isn't helping me.

The short answer is, no, zsh can't wait for the suspended process to exit.

Given "one && two && three", if "two" stops, the shell has three choices:
(1) pretend the command was "{ one && two && three }" and suspend the 
    entire sublist; or
(2) pretend that "two" has returned a status and continue the junction; or
(3) stop the entire shell until "two" is resumed.

Choice (1) is undesirable because it subverts the user's intent (if he 
meant there to be braces, he should have typed them) and it puts "three" 
into a separate process when it might better have been run in the current 
shell.  Choice (3) is impossible in an interactive shell.  That leaves 
(2), which is what zsh does, using the signal number as the status.

If there's a bug, it's that zsh returns $? == 20 rather than $? == 148.
I forget why that's done -- maybe it's a compromise because $? > 127 would
indicate the signal caused the child to exit, which is not the case here.

