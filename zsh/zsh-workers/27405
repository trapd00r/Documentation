From zsh-workers-return-27405-mason-zsh=primenet.com.au@zsh.org Sat Nov 14 17:29:01 2009
Return-Path: <zsh-workers-return-27405-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19125 invoked by alias); 14 Nov 2009 17:29:01 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27405
Received: (qmail 15803 invoked from network); 14 Nov 2009 17:28:59 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-0.8 required=5.0 tests=AWL,BAYES_00,INVALID_DATE
	autolearn=no version=3.2.5
Received-SPF: none (proxy.melb.primenet.com.au: domain at free.fr does not designate permitted sender hosts)
In-Reply-To: <20091114161834.GA12016@scru.org>
To: zsh-workers@zsh.org
Subject: Re: PATCH: warn on "hard" hard link failure
X-Mailer: BeMail - Mail Daemon Replacement 3.0.0 Final
From: "=?utf-8?q?Fran=C3=A7ois?= Revol" <revol@free.fr>
Date: Sat, 14 Nov 2009 18:32:51 +0100 CET
Message-Id: <442188467-BeMail@laptop>
Mime-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: quoted-printable

> On Tue, Mar 10, 2009 at 02:18:41PM +0000, Peter Stephenson wrote:
> > This is reponse to Sourceforge issue 1968395: failures to create 
> > hard
> > links aren't gracefully handled.  Failing to create a link because 
> > the
> > file already exists is the normal condition being handled by the 
> > locking
> > code; however, a failure for any other reason is presumably a hard
> > failure worthy of reporting.  The same goes if stat() fails with
> > anything other than ENOENT: in both cases we give up and should say 
> > so.
> > 
> > It's possible this can be improved further.
> 
> Apparently this has caused someone distress because of the hard 
> failure
> preventing the correction of the out-of-diskspace condition causing 
> the
> history failure.

I don't know what you use hardlinks for, but beware, not every OS out 
there supports them.
BeOS and Haiku don't for example.
Actually they don't forbid them at the VFS layer, but BFS doesn't 
support hardlinks due to the way it is implemented to support indices 
and queries.

So please do provide a fallback in case of failure.

I should probably post my zsh diff someday...

Fran=C3=A7ois.

