From zsh-workers-return-28033-mason-zsh=primenet.com.au@zsh.org Sun Jun 13 23:44:52 2010
Return-Path: <zsh-workers-return-28033-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17956 invoked by alias); 13 Jun 2010 23:44:52 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28033
Received: (qmail 9535 invoked from network); 13 Jun 2010 23:44:50 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at sergio.spb.ru designates 194.58.105.39 as permitted sender)
Message-ID: <4C1567F9.6050406@sergio.spb.ru>
Date: Mon, 14 Jun 2010 03:21:29 +0400
From: sergio <mailbox@sergio.spb.ru>
User-Agent: Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-US; rv:1.9.1.9) Gecko/20100515 Icedove/3.0.4
MIME-Version: 1.0
To: zsh-workers@zsh.org
Subject: Re: PATCH: zcalc prompt fix
References: <4B44DD08.7040700@sergio.spb.ru>	<20100107213326.582fb96c@pws-pc>	<4B466A0F.9080109@sergio.spb.ru> <20100108092847.4aefd31d@news01>
In-Reply-To: <20100108092847.4aefd31d@news01>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hello.

This bug still presents in 4.3.10-13 in debian.

 > There are problems when using color in ZCALCPROMPT.
 > This is simple fix.
 >
 > --- /usr/share/zsh/functions/Misc/zcalc 2009-12-28 06:57:20.000000000 
 > +0300
 > +++ zcalc       2010-01-06 14:55:15.000000000 +0300
 > @@ -152,7 +152,7 @@
 >  done
 >
 >  psvar[1]=$num
 > -while vared -cehp "${(%)ZCALCPROMPT}" line; do
 > +while vared -cehp "${ZCALCPROMPT}" line; do
 >    [[ -z $line ]] && break
 >    # special cases
 >    # Set default base if `[#16]' or `[##16]' etc. on its own.

On 01/08/2010 12:28 PM, Peter Stephenson wrote:
> On Fri, 08 Jan 2010 02:11:11 +0300
> sergio<mailbox@sergio.spb.ru>  wrote:
>> -p for vared indicates, that the string will be taken as the prompt, and
>> it doesn't need the prompt expansion flag (%).
>
> Ah, right, vared -p obeys the PROMPTPERCENT option so we don't need the
> (%) in any case.

-- 
sergio.

