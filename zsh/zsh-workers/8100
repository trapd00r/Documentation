From zsh-workers-return-8100-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Sep 29 18:54:58 1999
Return-Path: <zsh-workers-return-8100-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18569 invoked from network); 29 Sep 1999 18:54:53 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 29 Sep 1999 18:54:53 -0000
Received: (qmail 15385 invoked by alias); 29 Sep 1999 18:54:45 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8100
Received: (qmail 15378 invoked from network); 29 Sep 1999 18:54:45 -0000
Date: Wed, 29 Sep 1999 19:54:44 +0100
From: Adam Spiers <adam@thelonious.new.ox.ac.uk>
To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Subject: PATCH: _perl* cleanups
Message-ID: <19990929195444.A15831@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0pre2i
X-URL: http://www.new.ox.ac.uk/~adam/
X-OS: Linux 2.2.9 i686

One bugfix and whitespace cleanups (2 space indents in Completion/
seem to be the convention, which ties in nicely with my personal
tastes).

Index: Completion/User/_perl_modules
===================================================================
RCS file: /usr/local/cvsroot/zsh/Completion/User/_perl_modules,v
retrieving revision 1.1.1.2
diff -u -r1.1.1.2 _perl_modules
--- Completion/User/_perl_modules	1999/09/21 12:17:48	1.1.1.2
+++ Completion/User/_perl_modules	1999/09/29 00:18:20
@@ -21,22 +21,22 @@
   else
     local inc libdir new_pms
     inc=( $( perl -e 'print "@INC"' ) )
-    typeset -agU _perl_modules	# _perl_modules is global, no duplicates
+    typeset -agU _perl_modules  # _perl_modules is global, no duplicates
     _perl_modules=( )
 
     for libdir in $inc; do
-        # Ignore cwd - could be too expensive e.g. if we're near /
-        if [[ $libdir == '.' ]]; then break; fi
+      # Ignore cwd - could be too expensive e.g. if we're near /
+      if [[ $libdir == '.' ]]; then break; fi
 
-	# Find all modules
-	cd $libdir
-        new_pms=( {[A-Z]*/**/,}*.pm(N) )
-	cd $OLDPWD
+      # Find all modules
+      cd $libdir
+      new_pms=( {[A-Z]*/**/,}*.pm(N) )
+      cd $OLDPWD
 
-	# Convert to Perl nomenclature
-	new_pms=( ${new_pms:r:fs#/#::#} )
+      # Convert to Perl nomenclature
+      new_pms=( ${new_pms:r:fs#/#::#} )
 
-        _perl_modules=( $new_pms $_perl_modules )
+      _perl_modules=( $new_pms $_perl_modules )
     done
   fi
 fi
Index: Completion/User/_perldoc
===================================================================
RCS file: /usr/local/cvsroot/zsh/Completion/User/_perldoc,v
retrieving revision 1.1.1.2
diff -u -r1.1.1.2 _perldoc
--- Completion/User/_perldoc	1999/09/21 12:17:48	1.1.1.2
+++ Completion/User/_perldoc	1999/09/29 00:18:59
@@ -6,21 +6,24 @@
 #
 
 _perldoc () {
-    _arguments -s \
-        '-h:help:' \
-        '(-q)-f:Perl built-in function:_perl_builtin_funcs:*:' \
-        '(-f)-q:Perl FAQ keyword:' \
-        '*:Perl pod pages:_perl_pods'
+  _arguments -s \
+    '-h:help:' \
+    '(-q)-f:Perl built-in function:_perl_builtin_funcs:*:' \
+    '(-f)-q:Perl FAQ keyword:' \
+    '*:Perl pod pages:_perl_pods'
 }
 
 _perl_pods () {
-    local nm="$compstate[nmatches]"
+  local nm="$compstate[nmatches]"
+  local expl
+  
+  _perl_modules
+  _perl_basepods
 
-   _perl_modules
-   _perl_basepods
-   _path_files -J 'Perl modules and .pods' -/ -g '*.(pod|pm)'
+  _description expl 'Perl modules and .pods'
+  _path_files "$expl[@]"  -/ -g '*.(pod|pm)'
 
-    [[ nm -ne "$compstate[nmatches]" ]]
+  [[ nm -ne "$compstate[nmatches]" ]]
 }
 
 _perldoc "$@"

