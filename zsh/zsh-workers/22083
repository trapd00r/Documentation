From zsh-workers-return-22083-mason-zsh=primenet.com.au@sunsite.dk Thu Dec 15 11:52:23 2005
Return-Path: <zsh-workers-return-22083-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28682 invoked from network); 15 Dec 2005 11:52:16 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 15 Dec 2005 11:52:16 -0000
Received: (qmail 86785 invoked from network); 15 Dec 2005 11:52:08 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 15 Dec 2005 11:52:08 -0000
Received: (qmail 4256 invoked by alias); 15 Dec 2005 11:52:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22083
Received: (qmail 4247 invoked from network); 15 Dec 2005 11:52:05 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 15 Dec 2005 11:52:05 -0000
Received: (qmail 86500 invoked from network); 15 Dec 2005 11:52:05 -0000
Received: from web25223.mail.ukl.yahoo.com (217.146.176.209)
  by a.mx.sunsite.dk with SMTP; 15 Dec 2005 11:52:03 -0000
Received: (qmail 38785 invoked by uid 60001); 15 Dec 2005 11:52:03 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=kjdlj4SjiuP2k6r/6s/GxTOg8Tl2Y8u2MvcZco3q0L/b+ed+kemIh36no4R/XN+dzV8GaFzr5gImlKxLvwXqXwShv4FDIv+E0yWBjidSqg6dJ4Zhoa/DyFW3V5j7lqIOpUcSOiFU85pc85LxuMxpIV88j7moCy5zH5YbxfuId0U=  ;
Message-ID: <20051215115203.38783.qmail@web25223.mail.ukl.yahoo.com>
Received: from [158.234.10.144] by web25223.mail.ukl.yahoo.com via HTTP; Thu, 15 Dec 2005 11:52:02 GMT
Date: Thu, 15 Dec 2005 11:52:02 +0000 (GMT)
From: Oliver Kiddle <okiddle@yahoo.co.uk>
Subject: Re: PATCH: assume "enhanced goodness" when --multibyte-enable
To: zsh-workers@sunsite.dk
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Peter wrote:
> In utils.c we don't enable the full multibyte code for converting
> characters unless __STDC_ISO_10646__ is turned on.  However,
everywhere
> in zle we simply trust that if --multibyte-enable is turned on
> everything just works.  That includes wctomb(), which is all we need
> for character conversion.

This doesn't make sense to me. With MULTIBYTE_SUPPORT enabled are you
just assuming that wchar_t is UCS-4 everywhere? I don't understand how
that'll work if you have a system which has perfectly good multibyte
support but uses some other encoding for wchar_t. I think FreeBSD is
such a system and older versions of many Unix systems do that. Do you
actually know for sure that Solaris 8 is using UCS-4 for wchar_t? The
fact the it doesn't define __STDC_ISO_10646__ would imply that it does
not. I'd suspect it is similar but different which is why it sort-of
seems to work.

(The code in utils.c which you have just enabled with MULTIBYTE_SUPPORT
casts a 4 byte integer into a wchar_t: something that can only work
when wchar_t is implemented as UCS-4. __STDC_ISO_10646__ is supposed a
reliable way to determine if wchar_t is UCS-4)

Oliver


		
___________________________________________________________ 
To help you stay safe and secure online, we've developed the all new Yahoo! Security Centre. http://uk.security.yahoo.com

