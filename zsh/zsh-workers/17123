From zsh-workers-return-17123-mason-zsh=primenet.com.au@sunsite.dk Fri May 10 23:08:42 2002
Return-Path: <zsh-workers-return-17123-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 353 invoked from network); 10 May 2002 23:08:42 -0000
Received: from ns2.primenet.com.au (HELO primenet.com.au) (@203.24.36.3)
  by ns1.primenet.com.au with SMTP; 10 May 2002 23:08:42 -0000
Received: (qmail 5363 invoked from network); 10 May 2002 23:01:58 -0000
Received: from sunsite.dk (130.225.247.90)
  by proxy.melb.primenet.com.au with SMTP; 10 May 2002 23:01:58 -0000
Received: (qmail 27742 invoked by alias); 10 May 2002 23:01:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17123
Received: (qmail 27729 invoked from network); 10 May 2002 23:01:40 -0000
Date: Fri, 10 May 2002 18:01:38 -0500
From: Albert Chin <zsh-workers@lists.thewrittenword.com>
To: zsh-workers@sunsite.dk
Subject: Re: Compile errors for zsh 4.0.4 on Aix 4.3.3
Message-ID: <20020510180138.A61520@oolong.il.thewrittenword.com>
Reply-To: zsh-workers@sunsite.dk
References: <20020509090819.A10978@yoda.jedi.net> <1020509150823.ZM8499@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <1020509150823.ZM8499@candle.brasslantern.com>; from schaefer@brasslantern.com on Thu, May 09, 2002 at 03:08:23PM +0000

On Thu, May 09, 2002 at 03:08:23PM +0000, Bart Schaefer wrote:
> On May 9,  9:08am, travis@jedi.net wrote:
> } "termcap.c", line 71.13: 1506-334 (S) Identifier boolcodes has already been defined on line 1342 of "/usr/include/term.h".
> 
> is happening *because* "Zsh now defaults to termcap on AIX;" the problem
> about which we want more information is "variables boolcodes and some other
> are declared in term.h but missing is libcurses.a."
> 
> It's a bit confusing that your build actually included term.h even though
> it was supposedly defaulting to termcap, so that might still be worth
> looking into, but it's not the problem Etc/MACHINES is talking about.

The patch below worked for us with 4.0.4 and AIX 4.3.2.

-- 
albert chin (china@thewrittenword.com)

-- snip snip
--- Src/Modules/termcap.c.orig	Sat Nov 10 13:26:59 2001
+++ Src/Modules/termcap.c	Sat Nov 10 13:27:53 2001
@@ -67,20 +67,20 @@
 
 static Param termcap_pm;
 
-#ifndef HAVE_BOOLCODES
-static char *boolcodes[] = {
-    "bw", "am", "ut", "cc", "xs", "YA", "YF", "YB", "xt", "xn", "eo",
-    "gn", "hc", "HC", "km", "YC", "hs", "hl", "in", "YG", "da", "db",
-    "mi", "ms", "nx", "xb", "NP", "ND", "NR", "os", "5i", "YD", "YE",
-    "es", "hz", "ul", "xo", NULL};
-#endif
-
 /**/
 static int
 ztgetflag(char *s)
 {
     char **b;
 
+#ifndef HAVE_BOOLCODES
+    static char *boolcodes[] = {
+	"bw", "am", "ut", "cc", "xs", "YA", "YF", "YB", "xt", "xn", "eo",
+	"gn", "hc", "HC", "km", "YC", "hs", "hl", "in", "YG", "da", "db",
+	"mi", "ms", "nx", "xb", "NP", "ND", "NR", "os", "5i", "YD", "YE",
+	"es", "hz", "ul", "xo", NULL};
+#endif
+
     /* ncurses can tell if an existing boolean capability is *
      * off, but other curses variants can't, so we fudge it. *
      * This feature of ncurses appears to have gone away as  *
@@ -295,6 +295,14 @@
 	"NC", "Nl", "pb", "vt", "ws", "Yo", "Yp", "Ya", "BT", "Yc", "Yb",
 	"Yd", "Ye", "Yf", "Yg", "Yh", "Yi", "Yk", "Yj", "Yl", "Ym", "Yn",
 	NULL};
+#endif
+
+#ifndef HAVE_BOOLCODES
+    static char *boolcodes[] = {
+	"bw", "am", "ut", "cc", "xs", "YA", "YF", "YB", "xt", "xn", "eo",
+	"gn", "hc", "HC", "km", "YC", "hs", "hl", "in", "YG", "da", "db",
+	"mi", "ms", "nx", "xb", "NP", "ND", "NR", "os", "5i", "YD", "YE",
+	"es", "hz", "ul", "xo", NULL};
 #endif
 
 #ifndef HAVE_STRCODES

