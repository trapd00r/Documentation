From zsh-workers-return-13733-mason-zsh=primenet.com.au@sunsite.dk Fri Mar 23 15:17:31 2001
Return-Path: <zsh-workers-return-13733-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18498 invoked from network); 23 Mar 2001 15:17:29 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 23 Mar 2001 15:17:29 -0000
Received: (qmail 7336 invoked by alias); 23 Mar 2001 15:17:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13733
Received: (qmail 7300 invoked from network); 23 Mar 2001 15:17:18 -0000
Date: Fri, 23 Mar 2001 16:17:17 +0100 (MET)
Message-Id: <200103231517.QAA10751@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.dk
In-reply-to: =?iso-8859-1?q?Oliver=20Kiddle?='s message of Fri, 23 Mar 2001
	15:10:14 +0000 (GMT)
Subject: PATCH: Re: Completion for kill


Oliver Kiddle wrote:

> This has just been annoying me: completion for kill insists on doing
> menu completion: from zsh -f + compinit, create a couple of background
> jobs and then type kill %<tab>. After pressing just one tab, menu
> completion is entered with the first job completed in full on the
> command-line. The behaviour I would like is exactly what you get with
> fg %<tab> in the same situation where you need more tabs before menu
> completion is used.
> 
> The situation is caused by _pids which _kill uses along with _jobs.
> None of the possible values of the insert-ids style help. One solution
> is if I add compstate[insert]=unambiguous to the end of _kill. Is there
> a better solution to this. Surely _pids should only be messing about
> with compstate[insert] if pids are the only thing being completed?

Ahem.  Sorry (I use jobs so seldom that I didn't see that...)

Bye
 Sven

Index: Completion/Builtins/_pids
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Builtins/_pids,v
retrieving revision 1.9
diff -u -r1.9 _pids
--- Completion/Builtins/_pids	2000/08/16 07:16:12	1.9
+++ Completion/Builtins/_pids	2001/03/23 15:15:34
@@ -11,7 +11,7 @@
   all=()
   match="*[[:blank:]]${PREFIX}[0-9]#${SUFFIX}[[:blank:]]*[/[:blank:]]${2}*"
   shift 2
-elif [[ "$PREFIX$SUFFIX" = [0-9]# ]]; then
+elif [[ "$PREFIX$SUFFIX" = (%*|[0-9]#) ]]; then
   all=()
   match="*[[:blank:]]${PREFIX}[0-9]#${SUFFIX}[[:blank:]]*"
 else

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

