From zsh-workers-request@math.gatech.edu Mon Feb 02 16:56:23 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 24957 invoked from network); 2 Feb 1998 16:56:21 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 2 Feb 1998 16:56:21 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id LAA10842;
	Mon, 2 Feb 1998 11:19:03 -0500 (EST)
Resent-Date: Mon, 2 Feb 1998 11:19:03 -0500 (EST)
Sender: stringfe@rmcs.cranfield.ac.uk
Message-Id: <34D5F142.6487@rmcs.cran.ac.uk>
Date: Mon, 02 Feb 1998 16:16:02 +0000
From: "stringfellow.n.d" <stringfe@rmcs.cran.ac.uk>
X-Mailer: Mozilla 3.02 (X11; I; SunOS 5.5.1 sun4u)
Mime-Version: 1.0
To: zsh-workers@math.gatech.edu
Subject: Re: terminal parameter changed problem
References: <9802020353.AA22474@ezdzit.zko.dec.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"dnrbl1.0.Lf2.s7Vrq"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3761
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Paul Lew wrote:
> 
> Is there a fix for the terminal parameter changed problem?  Some of the
> terminal parameters got turned off after executing some commands, in
> particular, susp, dsusp, discard, quit, and lnext all got
> reset to <undef>.  This virtually shut down the job control ability.
> 
> This has been reported before but I did not see a fix for it.
> Contraray to what has been reported before, these commands do not have
> to be backgrounded.
> 

The previous advice given was to use 

ttyctl -f

to freeze the terminal.
However, as useful as this work-around is, it would be nicer to have a
patch,
so ...

http://mason.primenet.com.au/zsh/workers-1997-hyper/0567.html

provides the answer (included below).
This patch was for zsh 3.0.3 but I think that it should work for later
versions - although it's small enough to edit the file Src/jobs.c by
hand. 

This patch doesn't appear to have made it into later versions of zsh,
i.e.
it was only ever reported as a patch and slipped through the net when
later
versions were produced.

Patch for tty problem:-

Here is Peter's patch:

*** ./Src/jobs.c.old Wed Jun 4 17:51:43 1997
--- ./Src/jobs.c Wed Jun 4 17:53:39 1997
***************
*** 155,161 ****
}
}

! if (shout && !ttyfrozen && !jn->stty_in_env)
gettyinfo(&shttyinfo);

if (isset(MONITOR)) {
--- 155,161 ----
}
}

! if (shout && !ttyfrozen && !jn->stty_in_env && inforeground)
gettyinfo(&shttyinfo);

if (isset(MONITOR)) {

