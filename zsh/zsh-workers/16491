From zsh-workers-return-16491-mason-zsh=primenet.com.au@sunsite.dk Fri Jan 25 08:59:53 2002
Return-Path: <zsh-workers-return-16491-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 818 invoked from network); 25 Jan 2002 08:59:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 25 Jan 2002 08:59:52 -0000
Received: (qmail 22015 invoked by alias); 25 Jan 2002 08:59:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16491
Received: (qmail 21992 invoked from network); 25 Jan 2002 08:59:36 -0000
From: Sven Wischnowsky <wischnow@berkom.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15441.7716.645376.366627@wischnow.berkom.de>
Date: Fri, 25 Jan 2002 09:58:12 +0100
To: zsh-workers@sunsite.dk
Subject: Re: Test failures in artih and arguments
In-Reply-To: <20020123145155.25539.qmail@web10408.mail.yahoo.com>
References: <20020123145155.25539.qmail@web10408.mail.yahoo.com>
X-Mailer: VM 6.95 under 21.5 (patch 3) "asparagus" XEmacs Lucid


Felix Rosencrantz wrote:

> ...
> 
> ./Y03arguments.ztst: starting.
> *** /tmp/zsh.ztst.out.2530	Tue Jan 22 10:02:28 2002
> --- /tmp/zsh.ztst.tout.2530	Tue Jan 22 10:02:28 2002
> ***************
> *** 1,4 ****
> ! line: {tst -}{}
> ! MESSAGE:{arg}
> ! DESCRIPTION:{option}
> ! NO:{-x}
> --- 1 ----
> ! line: {tst -x }{}
> Test ./Y03arguments.ztst failed: output differs from expected as shown 
> above for:
>  tst_arguments '-x' ':arg:'
>  comptest $'tst -\t'
> Was testing: argument beginning with minus
> ./Y03arguments.ztst: test failed.

Grrrr... that's a result of the fake style patch. Previously, with a
function containing:

  _argument '-x' ':arg:'

doing

  foo -<TAB>

didn't insert anything and displayed be message `arg'.

This was done by some code in _main_complete which I had to change
because otherwise adding completing a faked matched for the `arg'
above wouldn't work. Quite naturally, actually.

If I remember correctly, the behaviour was added on request from
Tanaka Akira.

So we now have the problem that in exactly the same case something we
certainly want to have with faked matches conflicts with the behaviour
we wanted there previously (or even now, without faked matches).

I'm not sure how to solve this.


Bye
  Sven

-- 
Sven Wischnowsky                           wischnow@berkom.de

