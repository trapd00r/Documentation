From zsh-workers-return-15156-mason-zsh=primenet.com.au@sunsite.dk Thu Jun 28 09:13:44 2001
Return-Path: <zsh-workers-return-15156-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2570 invoked from network); 28 Jun 2001 09:13:43 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 28 Jun 2001 09:13:43 -0000
Received: (qmail 825 invoked by alias); 28 Jun 2001 09:12:53 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15156
Received: (qmail 796 invoked from network); 28 Jun 2001 09:12:50 -0000
From: Tomi Vainio - Sun Finland - <Tomi.Vainio@Sun.COM>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15162.62750.136548.435614@gargle.gargle.HOWL>
Date: Thu, 28 Jun 2001 12:13:02 +0300
To: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
Cc: <zsh-workers@sunsite.dk>
Subject: RE: Zsh 4.0.2 + 64bit Solaris 8 Forte 6.1 compiler
In-Reply-To: <004a01c0ff15$c20557a0$21c9ca95@mow.siemens.ru>
References: <15161.60034.565764.974647@gargle.gargle.HOWL>
	<004a01c0ff15$c20557a0$21c9ca95@mow.siemens.ru>
X-Mailer: VM 6.92 under 21.4 (patch 3) "Academic Rigor" XEmacs Lucid
Reply-To: Tomi.Vainio@Sun.COM

Andrej Borsenkow writes:
 > 
 > Yes. I do not have either Solaris or Forte compiler so I cannot do it
 > myself. As said, either describe how your compiler can be detected or, if it
 > is confirmed that -KPIC is supported by all compilers on Solaris, we can
 > change it.
 > 
I have made some digging.  Oldest compiler I could find is 4.2 which
is quite old (cc: WorkShop Compilers 4.2 30 Oct 1996 C 4.2) and all
series 4 compilers are quite the same.  This old compiler knows -KPIC
-option and I also checked xemacs 21.4 configure and they use -KPIC
almost for every system available (irix/sysv4/unixware/solaris).
/opt/SUNWspro/bin/cc -cflags|grep -i pic
-KPIC           Compile position independent code with 32-bit addresses
-Kpic           Compile position independent code


Next thing is how to detect 64-bit.  Isainfo is quite good for this
and old compilers don't know anything about -xarch=v9 or v9a/v9b.
Only things that change for eg. on xemacs configure when using 64-bit
are size of long and void *

man cc
---clip clip---
v9  Compile for the SPARC-V9 ISA.
v9a Compile for the SPARC-V9 ISA with UltraSPARC extensions.
v9b Compile for the SPARC-V9 ISA with UltraSPARC-III extensions.
---clip clip---

man isainfo
---clip clip---
     -b    Prints the number of bits in the address space of  the
           native instruction set.
     -k    Prints the name of the instruction set(s) used by  the
           operating  system  kernel  components  such  as device
           drivers and STREAMS modules.
     -n    Prints the name of the native instruction set used  by
           portable applications supported by the current version
           of the operating system.
     -v    Prints  more  detailed  information  about  the  other
           options.
---clip clip---

% /usr/bin/isainfo -b 
64
% /usr/bin/isainfo -k
sparcv9
% /usr/bin/isainfo -n
sparcv9
% /usr/bin/isainfo -bv
64-bit sparcv9 applications
% /usr/bin/isainfo -kv
64-bit sparcv9 kernel modules
% /usr/bin/isainfo -nv
64-bit sparcv9 applications

-- 
SUN Microsystems Oy PL 112, Lars Sonckin kaari 12, 02601 ESPOO, Finland
Tomi Vainio (System Support Engineer)     +358 9 52556300 hotline
email: Tomi.Vainio@Sun.COM                +358 9 52556252 fax

