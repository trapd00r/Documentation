From zsh-workers-return-23729-mason-zsh=primenet.com.au@sunsite.dk Tue Jul 31 03:24:12 2007
Return-Path: <zsh-workers-return-23729-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14019 invoked from network); 31 Jul 2007 03:24:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 31 Jul 2007 03:24:09 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 99302 invoked from network); 31 Jul 2007 03:24:03 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 31 Jul 2007 03:24:03 -0000
Received: (qmail 11401 invoked by alias); 31 Jul 2007 03:24:00 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23729
Received: (qmail 7602 invoked from network); 31 Jul 2007 02:40:39 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 31 Jul 2007 02:40:39 -0000
Received: (qmail 43484 invoked from network); 31 Jul 2007 02:40:39 -0000
Received: from bay0-omc2-s24.bay0.hotmail.com (65.54.246.160)
  by a.mx.sunsite.dk with SMTP; 31 Jul 2007 02:40:34 -0000
Received: from BAY124-W41 ([207.46.11.204]) by bay0-omc2-s24.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.2668);
	 Mon, 30 Jul 2007 19:40:34 -0700
Message-ID: <BAY124-W41C82B6378B9BFD246A34C87EF0@phx.gbl>
X-Originating-IP: [198.95.226.224]
From: Jeffrey Merrick <jeff.merrick@hotmail.com>
To: <zsh-workers@sunsite.dk>
Subject: Zsh looping on commands that produce long output
Date: Mon, 30 Jul 2007 19:40:33 -0700
Importance: Normal
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-OriginalArrivalTime: 31 Jul 2007 02:40:34.0049 (UTC) FILETIME=[2B307710:01C7D31C]


Hi,

I've repeatedly run into the problem of zsh looping when running commands t=
hat produce many (like, 200 or more) lines of output.  If you can imagine t=
he output having line numbers, what happens is something like this:

     line 400
     line 401
     line 402
     line 382
     line 383
       .....
     line 401
     line 402
     line 382=20
     line 383=20
       .....
     line 401
     line 402
     line 382
     line 383

and so forth.  It is as if a circular buffer is being repeatedly displayed,=
 without ever getting to the next line (403 and following).

Some commands that I've had problems with are:

% ls -l -F --color=3Dtty  # when the directory contains a large number of f=
iles
% ps -A
% diff file1 file2 # when the numbers of lines of change was large

The problem does not happen in a predictable manner; I cannot repeat the pr=
oblem every time. However, once it happens on one zsh session on a machine,=
 I can create zsh session on the same machine, repeat the command (or any o=
ther command that produces a lot of output), and it is guaranteed to have t=
he same looping problem as the first.  Note that when this happens, the out=
put that is repeated is particular to the command typed at that shell; if o=
ne shell session is looping on an 'ls' comamnd, and I do a 'ps -A' in anoth=
er shell, the second shell gets repeated process status lines and not repea=
ted directory listing lines.  (Note:  I'm one of the very few zsh users at =
my company, so it's very likely I'm running all the instances of zsh on a g=
iven machine.)  When I kill all instances of zsh on the machine and login a=
gain, the problem goes away.=20

Thus, it's as if there is some shared state across all running zsh instance=
s that triggers the looping behavior, and the state is cleared only by kill=
ing all the zsh instances.

The problem seems to be independent of zsh version.  My company has zsh ver=
sion 4.0.4, but I built version 4.2.6 myself and encountered the same probl=
em.

The platform is an i686-pc-linux-gnu running i386-redhat-linux8.0.  I creat=
e the zsh login shells by ssh'ing from my Mac PowerBook to the company mach=
ine.  (Actually, my login shell is tcsh, but I exec zsh during shell startu=
p.)

I don't subscribe to zsh-workers, but I will be checking the archive at 'zs=
h.org/mla' daily.  Those interested in more details can feel free to send m=
e private email.

Thanks for any help you can provide.

And thanks to everyone who maintains zsh!  It's truly the best shell I've e=
ver used.  Having started using it about a month ago, I can't imagine going=
 back to use anything else.

Jeff
_________________________________________________________________
Missed the show?=A0 Watch videos of the Live Earth Concert on MSN.
http://liveearth.msn.com=

