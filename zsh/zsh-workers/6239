From zsh-workers-return-6239-mason-zsh=primenet.com.au@sunsite.auc.dk Sat May 08 15:07:04 1999
Return-Path: <zsh-workers-return-6239-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15157 invoked from network); 8 May 1999 15:07:01 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 May 1999 15:07:01 -0000
Received: (qmail 11927 invoked by alias); 8 May 1999 15:06:40 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6239
Received: (qmail 11919 invoked from network); 8 May 1999 15:06:34 -0000
Message-Id: <9905081442.AA46637@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: PATCH: zsh-3.1.5-pws-17: history options again
Date: Sat, 08 May 1999 16:42:09 +0200
From: Peter Stephenson <pws@ibmth.df.unipi.it>

setopt with kshoptionprint was printing out

incrementalappendhistoryoff

which is obviously wrong.  Here is a generic solution to the problem, but
maybe the option name is a bit too long, can we agree on another one before
it's too late?  It's a shame the options weren't all standardised as having
`hist' rather than `history', but it's far too late to worry about that.  How
about `incappendhistory'; I think 'inc' is a widely enough recognisable
abbreviation?

--- Src/options.c.iah	Sat May  8 15:27:16 1999
+++ Src/options.c	Sat May  8 16:37:10 1999
@@ -384,9 +384,9 @@
 	optno = -optno;
     if (isset(KSHOPTIONPRINT)) {
 	if (defset(on))
-	    printf("no%-20s%s\n", on->nam, isset(optno) ? "off" : "on");
+	    printf("no%-19s %s\n", on->nam, isset(optno) ? "off" : "on");
 	else
-	    printf("%-22s%s\n", on->nam, isset(optno) ? "on" : "off");
+	    printf("%-21s %s\n", on->nam, isset(optno) ? "on" : "off");
     } else if (set == (isset(optno) ^ defset(on))) {
 	if (set ^ isset(optno))
 	    fputs("no", stdout);

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

