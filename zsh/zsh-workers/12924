From zsh-workers-return-12924-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Oct 08 18:34:14 2000
Return-Path: <zsh-workers-return-12924-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5953 invoked from network); 8 Oct 2000 18:34:13 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Oct 2000 18:34:13 -0000
Received: (qmail 23396 invoked by alias); 8 Oct 2000 18:33:57 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12924
Received: (qmail 23387 invoked from network); 8 Oct 2000 18:33:56 -0000
Date: Sun, 8 Oct 2000 14:33:58 -0400
Message-Id: <200010081833.e98IXw909213@soup.ql.org>
X-Authentication-Warning: soup.ql.org: ejb set sender to ejb@ql.org using -f
From: "E. Jay Berkenbilt" <ejb@ql.org>
To: zsh-workers@sunsite.auc.dk
Subject: kill -l broken in zsh 3.1.9-dev-6 on RedHat 7.0 (w/ explanation)
Mime-Version: 1.0 (generated by tm-edit 7.106)
Content-Type: text/plain; charset=US-ASCII


The code in configure.in that figures out which header file contains a
list of signal names and numbers in zsh 3.1.9-dev-6 doesn't work on
the header files that are included with RedHat 7.0.  The reason is
that the code runs cpp on a file that includes <signal.h> and looks at
the # lines to figure out dependencies, and uses this to figure out
which files to search.  However, RH7.0's version of gcc only puts the
# ... for files that actually have content.  As it happens, in RedHat
7.0, the list of signals appears in /usr/include/bits/signum.h.  This
file contains nothing but preprocessor directives and comments and so
it does not appear in the cpp output!

This seems to me like a bug in cpp.  Loads of programs use this cpp
output to generate dependencies.  If gcc just decides not to print the
names of files that don't have any contents, it will break numerous
dependency generators and probably lead to the downfall of
civilization.  I'm going to try to track this down and figure out
where the bug really is, possibly posting a workaround for this
specific manifestation with zsh.

On an unrelated topic, as long as I'm writing, I've been buried alive
at work for the last few weeks.  I am finally now going to go through
all those messages about the completion/expansion discussions and
reply.

--
E. Jay Berkenbilt (ejb@ql.org)  |  http://www.ql.org/q/

