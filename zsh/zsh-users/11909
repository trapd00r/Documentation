From zsh-users-return-11909-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 01 07:29:53 2007
Return-Path: <zsh-users-return-11909-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7135 invoked from network); 1 Oct 2007 07:29:45 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Oct 2007 07:29:45 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 25594 invoked from network); 1 Oct 2007 07:29:39 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2007 07:29:39 -0000
Received: (qmail 2930 invoked by alias); 1 Oct 2007 07:29:32 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11909
Received: (qmail 2915 invoked from network); 1 Oct 2007 07:29:31 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 1 Oct 2007 07:29:31 -0000
Received: (qmail 24344 invoked from network); 1 Oct 2007 07:29:31 -0000
Received: from wr-out-0506.google.com (64.233.184.238)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2007 07:29:26 -0000
Received: by wr-out-0506.google.com with SMTP id c48so1773983wra
        for <zsh-users@sunsite.dk>; Mon, 01 Oct 2007 00:29:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=8cN1/vTRfv/JLg3m0cB8qZDP3AUqJqUiyoWocq63+p8=;
        b=olNEVAyHtxjPLNNtp+gar8mqsr8lT3rsg4e3TMGCEqPmBgmOPdNQliW323RZhWPFmkb8dynsLuEgONl9ORXGbmbN2T1Hvd/8PXdHXxtIUrbMos2Gj5OflA5HI7v4ngHY+xyTRhjR9duf/uY1ffmIirBDELbgWuSzsbsrKG9yW5g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=beta;
        h=received:message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=oplRUL2MHkzjJ7Q4eACXzwDOdF7OCRxpvjYC8HbFd6dVfgIdU5jLD5OgQ6a7u9o/I+fGthwd2xNSxnwFGgDKTmI5bzSnlc9YQtEyHb/IQidoVzvVjiYMYWQaNYtCUhzZsiQ25+b/ZOrziqkP7Of1y+3rk6taBXtu0OM1VOwYNXk=
Received: by 10.90.118.8 with SMTP id q8mr4362920agc.1191223764466;
        Mon, 01 Oct 2007 00:29:24 -0700 (PDT)
Received: by 10.142.126.1 with HTTP; Mon, 1 Oct 2007 00:29:24 -0700 (PDT)
Message-ID: <30c383e70710010029h143cd1f7obb1218c17e000587@mail.gmail.com>
Date: Mon, 1 Oct 2007 09:29:24 +0200
From: "Pau Amaro-Seoane" <vim.unix@googlemail.com>
Reply-To: vim.unix@gmail.com
To: zsh-users@sunsite.dk
Subject: Re: nohup dies
In-Reply-To: <30c383e70709302316m6e93584ckcffdb3fd70b50b79@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <vim.unix@googlemail.com>
	 <30c383e70709301256m570d4cd7v4ce180db1d83cc67@mail.gmail.com>
	 <200709302207.l8UM7FBc005205@pws-pc.ntlworld.com>
	 <30c383e70709302316m6e93584ckcffdb3fd70b50b79@mail.gmail.com>

Hi,

I have been playing around and found the problem. Let's go step by step...

I tried the vanilla zshrc by just moving my zshrc out of where zsh
looks for it when I start a session.

After having done this, I set nohup and try to launch the simulation
as I have done all the last years:

tuffi3% set nohup
tuffi3% nohup  cat ./inicia| ~pau/executables/NB4_NoPN > diagnostic &
[1] 19492 19493
tuffi3%
tuffi3% exit
zsh: you have running jobs.
tuffi3% exit
zsh: warning: 1 jobs SIGHUPed

This is new: "zsh: warning: 1 jobs SIGHUPed"

But when I log in again, the job is not there anymore

I try again now with nohup before and after the pipe AND set nohup before a=
nd
after quitting

tuffi3% set nohup
tuffi3% vim inicia
tuffi3% nohup  cat ./inicia| nohup ~pau/executables/NB4_NoPN > diagnostic &
[1] 19511 19512
tuffi3% set nohup
tuffi3% exit
zsh: you have running jobs.
tuffi3% exit
zsh: warning: 1 jobs SIGHUPed
Connection to tuffi3 closed.


Hurrah! NB4_NoPN is there when I log in again.

Now... what was the problem? My zshrc? nohup before and after the pipe
or set nohup?

let's see... Let's kill the job and restart zsh to make sure set nohup
is not loaded

tuffi3% pkill -9 NB4_NoPN
tuffi3% zsh

Let's try before the two nohups

tuffi3% nohup  cat ./inicia| nohup ~pau/executables/NB4_NoPN > diagnostic &
[1] 19542 19543
tuffi3% exit
zsh: you have running jobs.
tuffi3% exit
zsh: warning: 1 jobs SIGHUPed

I log in again and... the job is there!

Let's try now NO nohup at all and "set nohup"

tuffi3% pkill -9 NB4_NoPN
tuffi3% cat ./inicia| ~pau/executables/NB4_NoPN > diagnostic &
[1] 19553 19554
tuffi3% exit
zsh: you have running jobs.
tuffi3% exit
zsh: warning: 1 jobs SIGHUPed
Connection to tuffi3 closed.

I log in again: The job has died

Now ONE nohup with "set nohup" on

tuffi3% set nohup
tuffi3% nohup  cat ./inicia| ~pau/executables/NB4_NoPN > diagnostic &
[1] 19566 19567
tuffi3% exit
zsh: you have running jobs.
tuffi3% exit
zsh: warning: 1 jobs SIGHUPed
Connection to tuffi3 closed.

I log in again: The job has died

Now just two nohup and "set nohup" off

tuffi3% nohup  cat ./inicia| nohup ~pau/executables/NB4_NoPN > diagnostic &
zsh: you have running jobs.
tuffi3% exit
zsh: warning: 1 jobs SIGHUPed
Connection to tuffi3 closed.

I log in again: The job is there, it has survived

And now the last test: My zshrc + two "nohups"

tuffi3| nohup  cat ./inicia| nohup ~pau/executables/NB4_NoPN > diagnostic &
[1] 19626 19627
tuffi3| exit
zsh: you have running jobs.
tuffi3| exit
zsh: warning: 1 jobs SIGHUPed
fins despr=E9s, plaerdemavida
Connection to tuffi3 closed.

I log in again: The job is there.


And just out of curiousity: my zshrc and the nohup AFTER the pipe

tuffi3| pkill -9 NB4_NoPN
tuffi3| cat ./inicia| nohup ~pau/executables/NB4_NoPN > diagnostic &
[1] 19652 19653
tuffi3| exit
zsh: you have running jobs.
tuffi3| exit
zsh: warning: 1 jobs SIGHUPed
fins despr=E9s, plaerdemavida
Connection to tuffi3 closed.

I log in again: The job is there.


Moral of the story:

(1) My zshrc is not the problem
(2) Setting nohup after the pipe fixes it
(3) ksh behaves differently

But, let me insist: In the old cluster, with a former version of zsh, the s=
hell
"understood what I meant" when I set nohup at the beginning of the
whole command, as ksh does

Why doesn't zsh understand it any more?

Thanks

Pau

