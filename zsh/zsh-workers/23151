From zsh-workers-return-23151-mason-zsh=primenet.com.au@sunsite.dk Mon Feb 05 19:21:31 2007
Return-Path: <zsh-workers-return-23151-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19225 invoked from network); 5 Feb 2007 19:21:27 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 5 Feb 2007 19:21:27 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 71341 invoked from network); 5 Feb 2007 19:21:20 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 Feb 2007 19:21:20 -0000
Received: (qmail 25263 invoked by alias); 5 Feb 2007 19:21:17 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23151
Received: (qmail 25254 invoked from network); 5 Feb 2007 19:21:17 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 Feb 2007 19:21:17 -0000
Received: (qmail 71011 invoked from network); 5 Feb 2007 19:21:16 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 5 Feb 2007 19:21:09 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 0737D5C06B; Mon,  5 Feb 2007 14:21:05 -0500 (EST)
Date: Mon, 5 Feb 2007 14:21:04 -0500
From: Clint Adams <clint@zsh.org>
To: zsh-workers@sunsite.dk
Subject: PATCH: _monotone
Message-ID: <20070205192104.GA12858@scowler.net>
Mail-Followup-To: zsh-workers@sunsite.dk
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.13 (2006-08-11)


Hopefully someone who actually uses monotone can give this a bit of
enhancement.

Index: Completion/Unix/Command/.distfiles
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/.distfiles,v
retrieving revision 1.80
diff -u -r1.80 .distfiles
--- Completion/Unix/Command/.distfiles	25 Oct 2006 13:13:23 -0000	1.80
+++ Completion/Unix/Command/.distfiles	5 Feb 2007 19:19:11 -0000
@@ -22,6 +22,7 @@
 _look           _lp             _ls             _lsof           _lynx
 _lzop           _mail           _make           _man            _mencal
 _metaflac       _mh             _mount          _mpc            _mt
+_monotone
 _mtools         _mtr            _mutt           _mysqldiff      _mysql_utils
 _ncftp          _netcat         _nice           _nmap           _nslookup
 _pack           _patch          _pax            _pbm            _perforce
Index: Completion/Unix/Command/_monotone
===================================================================
RCS file: Completion/Unix/Command/_monotone
diff -N Completion/Unix/Command/_monotone
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ Completion/Unix/Command/_monotone	5 Feb 2007 19:19:11 -0000
@@ -0,0 +1,41 @@
+#compdef mtn
+
+local context state line ret
+typeset -a cmds
+typeset -A opt_args
+
+_arguments \
+  '--brief[print a brief version of the normal output]' \
+  '--confdir[set location of configuration directory]:confdir:_files -/' \
+  '(-d --db)'{-d,--db}'[set name of database]:dbname' \
+  '--debug[print debug log to stderr while running]' \
+  '--dump[file to dump debugging log to, on failure]:dumpfile:_files' \
+  '--full-version[print detailed version number, then exit]' \
+  '(-h --help)'{-h,--help}'[display help message]' \
+  '(-k --key)'{-k,--key}'[set key for signatures]:key:' \
+  '--keydir[set location of key store]:keydir:_files -/' \
+  '--log[file to write the log to]:logfile:_files' \
+  '--norc[do not load ~/.monotone/monotonerc or _MTN/monotonerc lua files]' \
+  '--nostd[do not load standard lua hooks]' \
+  '--pid-file[record process id of server]:arg:' \
+  '--quiet[suppress verbose, informational and progress messages]' \
+  '--rcfile[load extra rc file]:extra rcfile:_files' \
+  '--reallyquiet[suppress warning, verbose, informational and progress messages]' \
+  '--root[limit search for workspace to specified root]:root:_files -/' \
+  '--ticker[set ticker style]:ticker style:(count dot none)' \
+  '--version[print version number, then exit]' \
+  '(-@ --xargs)'{-@,--xargs}'[insert command line arguments taken from the given file]:file:_files' \
+  '*:command:->cmd' && return 0
+
+case "$state" in
+  (cmd)
+  if (( CURRENT == 2 )); then
+    cmds=(automate:automation db:database fdiff:debug fload:debug fmerge:debug get_roster:debug identify:debug rcs_import:debug annotate:informative cat:informative complete:informative diff:informative help:informative list:informative log:informative ls:informative show_conflicts:informative status:informative cert:key+cert chkeypass:key+cert dropkey:key+cert genkey:key+cert trusted:key+cert pull:network push:network serve:network sync:network privkey:packet\ i/o pubkey:packet\ i/o read:packet\ i/o cvs_import:rcs approve:review comment:review disapprove:review tag:review testresult:review checkout:tree co:tree explicit_merge:tree heads:tree merge:tree merge_into_dir:tree migrate_workspace:tree propagate:tree refresh_inodeprints:tree setup:tree set:vars unset:vars add:workspace attr:workspace ci:workspace commit:workspace drop:workspace mv:workspace pivot_root:workspace pluck:workspace rename:workspace revert:workspace rm:workspace update:workspace)
+    _describe -t commands 'cmds' cmds && ret=0
+  else
+    _files
+  fi
+  ;;
+esac
+
+return ret

