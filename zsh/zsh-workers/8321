From zsh-workers-return-8321-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Oct 18 11:12:21 1999
Return-Path: <zsh-workers-return-8321-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9179 invoked from network); 18 Oct 1999 11:12:19 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 Oct 1999 11:12:19 -0000
Received: (qmail 6754 invoked by alias); 18 Oct 1999 11:12:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8321
Received: (qmail 6747 invoked from network); 18 Oct 1999 11:12:03 -0000
Date: Mon, 18 Oct 1999 13:12:02 +0200 (MET DST)
Message-Id: <199910181112.NAA27445@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Sven Wischnowsky's message of Mon, 18 Oct 1999 11:53:06 +0200
	(MET DST)
Subject: Re: PATCH: Re: Associative array ordering and selective unset (Re: Example function)


I wrote:

> This does that. The patterns are only compiled on demand and the
> testing is quite simple, so even in the used-only-once-in-an-init-
> script-case it shouldn't make things slower.

Oh my... I thought I had tested that with xtrace.

Bye
 Sven

diff -u -r oldsrc/cond.c Src/cond.c
--- oldsrc/cond.c	Mon Oct 18 11:53:58 1999
+++ Src/cond.c	Mon Oct 18 12:47:46 1999
@@ -117,7 +117,8 @@
 	if (c->type < COND_MOD) {
 	    char *rt = (char *) right;
 	    if (c->type == COND_STREQ || c->type == COND_STRNEQ) {
-		rt = dupstring(rt);
+		rt = dupstring(c->right);
+		singsub(&rt);
 		untokenize(rt);
 	    }
 	    fprintf(stderr, " %s %s %s", (char *)left, condstr[c->type],

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

