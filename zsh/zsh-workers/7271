From zsh-workers-return-7271-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Jul 24 16:30:04 1999
Return-Path: <zsh-workers-return-7271-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4012 invoked from network); 24 Jul 1999 16:30:02 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Jul 1999 16:30:02 -0000
Received: (qmail 1125 invoked by alias); 24 Jul 1999 16:29:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7271
Received: (qmail 1116 invoked from network); 24 Jul 1999 16:29:45 -0000
To: zsh-workers@sunsite.auc.dk
Subject: _files does not list files after foo/
MIME-Version: 1.0 (generated by AKEMI 1.13.2 - =?ISO-2022-JP?B?Ig==?=
 =?ISO-2022-JP?B?GyRCQTA0Y0s8GyhCIg==?=)
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 25 Jul 1999 01:29:38 +0900
Message-ID: <rsq673aj9jh.fsf@crane.jaist.ac.jp>
Lines: 31
User-Agent: Chao-gnus/6.12.5 AKEMI/1.13.2 (=?ISO-2022-JP?B?GyRCQTAbKEI=?=
 =?ISO-2022-JP?B?GyRCNGNLPBsoQg==?=) FLAM-DOODLE/1.12.6
 (=?ISO-2022-JP?B?GyRCM3cbKEI=?= 10R4.0/5.0) Emacs/20.4
 (sparc-sun-solaris2.6) MULE/4.0 (HANANOEN)

Z(2):akr@is27e1u11% zsh -f         
is27e1u11% autoload -U compinit; compinit -D
is27e1u11% ls
ChangeLog      Doc            META-FAQ       README         acconfig.h     config.guess   config.status  install-sh
ChangeLog.3.0  Etc            Makefile       Src            aclocal.m4     config.h       config.sub     mkinstalldirs
Completion     Functions      Makefile.in    StartupFiles   aczsh.m4       config.h.in    configure      stamp-h
Config         INSTALL        Misc           Util           config.cache   config.log     configure.in   stamp-h.in
is27e1u11% gunzip ./<TAB>

After above operation, zsh does not list files in current directory.

OK, I know that the behaviour is intentional as:

_path_files:
|       # A little extra hack: if we were completing `foo/<TAB>' and `foo'
|       # contains no files, this will normally produce no matches and other
|       # completers might think that's it's their time now. But if the next
|       # completer is _correct or something like that, this will result in
|       # an attempt to correct a valid directory name. So we just add the
|       # original string in such a case so that the command line doesn't
|       # change but other completers still think there are matches.
| 
|       if [[ -z "$tpre$tsuf" && "$pre" = */ && -z "$suf" ]]; then
|         compadd -nQS '' - "$linepath$donepath$orig"
|         tmp4=-
|       fi

But it is confusing in this case.
I suppose that there should be the way to disable the hack.
-- 
Tanaka Akira

