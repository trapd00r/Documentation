From zsh-workers-return-13506-mason-zsh=primenet.com.au@sunsite.dk Mon Feb 19 10:32:51 2001
Return-Path: <zsh-workers-return-13506-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4826 invoked from network); 19 Feb 2001 10:32:50 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Feb 2001 10:32:50 -0000
Received: (qmail 25166 invoked by alias); 19 Feb 2001 10:32:44 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13506
Received: (qmail 25152 invoked from network); 19 Feb 2001 10:32:44 -0000
Message-ID: <Tc0a8890c51d2ae58ca@mailsweeper01.cambridgesiliconradio.com>
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: PATCH: Re: :r modifier 
In-Reply-To: Your message of "15 Dec 2000 12:53:30 +0100."
             <mvbelz96gud.fsf@phobos.lrde.epita.fr> 
Date: Mon, 19 Feb 2001 10:32:14 +0000
From: Peter Stephenson <pws@csr.com>

> >>> "adl" == Alexandre Duret-Lutz <duret_g@lrde.epita.fr> writes:
>
> Here are the results on some error-prone inputs:
> 
> % for x in a.b//c //e ///g.h /i/j/k/ l.m ..
> for> print "$x\t root=$x:r\text=$x:e,\thead=$x:h,\ttail=$x:t"
> a.b//c   root=a.b//c    ext=,   head=a.b,       tail=c
> //e      root=//e       ext=,   head=//,        tail=e
> ///g.h   root=///g      ext=h,  head=/, tail=g.h
> /i/j/k/  root=/i/j/k/   ext=,   head=/i/j,      tail=k
> l.m      root=l ext=m,  head=., tail=l.m
> ..       root=. ext=,   head=., tail=..
>
> and unpatched zsh:
>
> % for x in a.b//c //e ///g.h /i/j/k/ l.m ..
> for> print "$x\t root=$x:r\text=$x:e,\thead=$x:h,\ttail=$x:t"
> a.b//c   root=a ext=b//c,       head=a.b/,      tail=c
> //e      root=//e       ext=//e,        head=/, tail=e
> ///g.h   root=///g      ext=h,  head=//,        tail=g.h
> /i/j/k/  root=/i/j/k/   ext=/i/j/k/,    head=/i/j/k,    tail=
> l.m      root=l ext=m,  head=l.m,       tail=l.m
> ..       root=. ext=,   head=..,        tail=..

I've just committed Alexandre's patch, with the effects shown.  Watch out
for unexpected results from colon modifiers.  With a bit of luck, in most
places where they are used the new behaviour should actually reduce
unexpected results.  Andrej:  note that this uses `\\' as well as `/' for
paths in Cygwin.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

