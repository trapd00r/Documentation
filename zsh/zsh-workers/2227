From zsh-workers-request@euclid.skiles.gatech.edu  Mon Oct 14 20:08:59 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id UAA10505 for <mason@primenet.com.au>; Mon, 14 Oct 1996 20:08:55 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id FAA03743; Mon, 14 Oct 1996 05:59:10 -0400 (EDT)
Resent-Date: Mon, 14 Oct 1996 05:59:10 -0400 (EDT)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <961014030142.ZM2470@candle.brasslantern.com>
Date: Mon, 14 Oct 1996 03:01:41 -0700
In-Reply-To: ams104@york.ac.uk (Alan Stephenson)
        "Building zsh-3.0.0 SGI IRIX 5.3" (Oct 14, 10:02am)
References: <199610140902.KAA11668@sgi20.york.ac.uk>
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: ams104@york.ac.uk (Alan Stephenson), zsh-workers@math.gatech.edu
Subject: Re: Building zsh-3.0.0 SGI IRIX 5.3
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"DAEfY3.0.Pw.jxWOo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2227
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Oct 14, 10:02am, Alan Stephenson wrote:
} Subject: Building zsh-3.0.0 SGI IRIX 5.3
}
} Probably something silly, but:
} 
}   The configure script supplied is determined to think I'm
} cross-compiling. Even if I persuade it I'm not, by hacking the script,
} the following occurs during the operation of `make':
} 
} ...
}         sed -n -f ./makepro.sed zle_utils.c > zle_utils.pro
}         sed -n -f ./makepro.sed zle_vi.c > zle_vi.pro
}         sed -n -f ./makepro.sed zle_word.c > zle_word.pro
}         nawk -f ./signames.awk /usr/include/sys/signal.h > signames.h
}         gcc -c -I.. -I. -I.  -DHAVE_CONFIG_H (-xansi -rdata_shared -p0
} -g0 -s -O2 -32) ansi2knr.c
} UX:sh (sh): ERROR: sh: Syntax error at line 1: `(' unexpected
} *** Error code 2 (bu21)
} *** Error code 1 (bu21)
} 
}   Not really sure what's going on here. Should the gcc line have the
} brackets?

Multiple questions arise.

Why is ansi2knr.c being compiled?  Both gcc and the IRIX C compiler are
ansi, so configure should NOT think K&R conversion is needed.

Why are the IRIX 5.3 native C compiler options -xansi -rdata_shared etc.
being passed to gcc?  *Nothing* about configure should have worked with
that combination.

} I've done the `reporter' thing, too. Hope you can help me.

Normally "reporter" would only help debug a problem with zsh itself, not
with the build process, but in this case it actually sheds some light.

What the heck is this stuff doing in your environment?

[...]
} CFLAGS="\'(-xansi -rdata_shared -p0 -g0 -s -O2 -32)\'"
} CPP="/lib/cpp"
[...]
} export CFLAGS
} export CPP
[...]

The parens in your failed build are coming from that CFLAGS environment
variable, which it looks as though you attempted to create as an array
(with parens around the value); but arrays aren't exported in zsh, so
somehow or other you got the parens into the value itself instead.

Or something; I'm gussing wildly here.

Get those out of your environment.  They'll screw up every compile you
attempt, zsh or anything else.  If there's an option to IRIX's `make'
to tell it to NOT import variables from the environment when processing
makefiles, start using it habitually.

unset CFLAGS
unset CPP
rm config.cache
configure
make


-- 
Bart Schaefer                             Brass Lantern Enterprises
http://www.well.com/user/barts            http://www.nbn.com/people/lantern

New male in /home/schaefer:
>N  2 Justin William Schaefer  Sat May 11 03:43  53/4040  "Happy Birthday"

