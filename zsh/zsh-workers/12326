From zsh-workers-return-12326-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jul 20 16:07:46 2000
Return-Path: <zsh-workers-return-12326-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8299 invoked from network); 20 Jul 2000 16:07:45 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 20 Jul 2000 16:07:45 -0000
Received: (qmail 8231 invoked by alias); 20 Jul 2000 16:07:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12326
Received: (qmail 8222 invoked from network); 20 Jul 2000 16:07:33 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000720160702.ZM2143@candle.brasslantern.com>
Date: Thu, 20 Jul 2000 16:07:02 +0000
In-Reply-To: <200007201532.LAA32728@ursula.cortexmachina.com>
Comments: In reply to Peter Whaite <peta@cortexmachina.com>
        "cvs completion messy on dangling slink" (Jul 20, 11:32am)
References: <200007201532.LAA32728@ursula.cortexmachina.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Peter Whaite <peta@cortexmachina.com>, zsh-workers@sunsite.auc.dk
Subject: PATCH: Re: cvs completion messy on dangling slink
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jul 20, 11:32am, Peter Whaite wrote:
}
} _cvs_modified_entries:stat:8: .#fuji-2.patch: no such file or directory

This should take care of it.

In the very general case, though, I still lament that there's no good way
to capture this kind of error output and present it via _message or some
other completion-friendly mechanism.

Index: Completion/User/_cvs
===================================================================
@@ -748,7 +748,7 @@
     linedir="$match[1]"
     realdir=${(e)~linedir}
     [[ -f "$realdir"CVS/Entries ]] &&
-    [[ -n ${pat::="${(@j:|:)${(@)${(@)${(@)${(@)${(@)${(@M)${(@f)"$(<"$realdir"CVS/Entries)"}:#/*}#/}/\\/[^\\/]#\\///}%/[^/]#/[^/]#}:#${(j:|:)~${${${${(f)"$(LC_ALL=C builtin stat -gn +mtime -F '%a %b %e %T %Y' ${realdir}*(D))"}##*/}/ //}//(#m)[][*?()<|^~#\\]/\\$MATCH}}}%%/*}//(#m)[][*?()<|^~#\\]/\\$MATCH}"} ]] &&
+    [[ -n ${pat::="${(@j:|:)${(@)${(@)${(@)${(@)${(@)${(@M)${(@f)"$(<"$realdir"CVS/Entries)"}:#/*}#/}/\\/[^\\/]#\\///}%/[^/]#/[^/]#}:#${(j:|:)~${${${${(f)"$(LC_ALL=C builtin stat -gn +mtime -F '%a %b %e %T %Y' ${realdir}*(D) 2>/dev/null)"}##*/}/ //}//(#m)[][*?()<|^~#\\]/\\$MATCH}}}%%/*}//(#m)[][*?()<|^~#\\]/\\$MATCH}"} ]] &&
     _wanted files expl file _path_files -g "$pat"
   else
     _cvs_existing_entries

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

