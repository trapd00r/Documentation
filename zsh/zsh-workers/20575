From zsh-workers-return-20575-mason-zsh=primenet.com.au@sunsite.dk Tue Nov 23 15:43:29 2004
Return-Path: <zsh-workers-return-20575-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 297 invoked from network); 23 Nov 2004 15:43:28 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Nov 2004 15:43:28 -0000
Received: (qmail 75582 invoked from network); 23 Nov 2004 15:43:20 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Nov 2004 15:43:20 -0000
Received: (qmail 25031 invoked by alias); 23 Nov 2004 15:43:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20575
Received: (qmail 24815 invoked from network); 23 Nov 2004 15:42:55 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 23 Nov 2004 15:42:55 -0000
Received: (qmail 75081 invoked from network); 23 Nov 2004 15:42:23 -0000
Received: from rent.teradyne.com (198.51.251.8)
  by a.mx.sunsite.dk with SMTP; 23 Nov 2004 15:42:20 -0000
Received: from chorus.teradyne.com (chorus.teradyne.com [131.101.1.195])
	by rent.teradyne.com (8.8.8+Sun/8.8.8) with ESMTP id KAA24844
	for <zsh-workers@sunsite.dk>; Tue, 23 Nov 2004 10:42:18 -0500 (EST)
Received: from kiki.icd.teradyne.com (kiki.icd.teradyne.com [131.101.10.126]) by chorus.teradyne.com (8.8.8+Sun/8.7.1) with ESMTP id KAA07328 for <zsh-workers@sunsite.dk>; Tue, 23 Nov 2004 10:42:18 -0500 (EST)
Received: from denver.icd.teradyne.com (denver [131.101.18.106])
	by kiki.icd.teradyne.com (8.9.3+Sun/8.9.3) with ESMTP id KAA28940
	for <zsh-workers@sunsite.dk>; Tue, 23 Nov 2004 10:43:54 -0500 (EST)
Received: (from sheltonv@localhost)
	by denver.icd.teradyne.com (8.11.6+Sun/8.11.6) id iANFgHA29370;
	Tue, 23 Nov 2004 10:42:17 -0500 (EST)
X-Authentication-Warning: denver.icd.teradyne.com: sheltonv set sender to acs@alumni.princeton.edu using -f
To: zsh-workers@sunsite.dk
Subject: Core dump in C03traps.zsh
From: Vin Shelton <acs@alumni.princeton.edu>
Organization: Teradyne, Inc
Date: Tue, 23 Nov 2004 10:42:17 -0500
Message-ID: <545zn18inc6.fsf@alumni.princeton.edu>
Lines: 88
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

Building from latest CVS sources, there are core dumps in test C03 on
Solaris 5.5 and 5.8.  Here is verbose output from a 5.5 run:

cd Test ; make check
make[1]: Entering directory `/u/sheltonv/software/SunOS-5.5/build/zsh-2004-11-23/Test'
if test -n "cc"; then \
  cd .. && DESTDIR= \
  make MODDIR=`pwd`/Test/Modules install.modules > /dev/null; \
fi
mkdir /u/sheltonv/software/SunOS-5.5/build/zsh-2004-11-23/Test/Modules
mkdir /u/sheltonv/software/SunOS-5.5/build/zsh-2004-11-23/Test/Modules/zsh
mkdir /u/sheltonv/software/SunOS-5.5/build/zsh-2004-11-23/Test/Modules/zsh/net
for f in /u/sheltonv/software/SunOS-5.5/src/zsh-2004-11-23/Test/C03*.ztst; do \
  ZTST_exe=../Src/zsh \
    ../Src/zsh +Z -f /u/sheltonv/software/SunOS-5.5/src/zsh-2004-11-23/Test/ztst.zsh $f; \
done
/u/sheltonv/software/SunOS-5.5/src/zsh-2004-11-23/Test/C03traps.ztst: starting.
ZTST_getsect: read section name: prep
ZTST_getchunk: read code chunk:
  setopt localtraps
  mkdir traps.tmp && cd traps.tmp
ZTST_execchunk: status 0
ZTST_getchunk: read code chunk:

ZTST_getsect: read section name: test
ZTST_test: looking for new test
ZTST_test: examining line:

ZTST_test: examining line:
  fn1() {
ZTST_getchunk: read code chunk:
  fn1() {
    trap 'print EXIT1' EXIT
    fn2() { trap 'print EXIT2' EXIT; }
    fn2
  }
  fn1
ZTST_test: examining line:
>EXIT2
ZTST_getredir: read redir for '>':
EXIT2
EXIT1
ZTST_test: examining line:

Running test: Nested `trap ... EXIT'
ZTST_test: expecting status: 0
Input: /tmp/zsh.ztst.in.10721, output: /tmp/zsh.ztst.out.10721, error: /tmp/zsh.ztst.terr.10721
ZTST_execchunk: status 0
ZTST_test: test produced standard output:
EXIT2
EXIT1
ZTST_test: and standard error:

Test successful.
ZTST_test: looking for new test
ZTST_test: examining line:

ZTST_test: examining line:
  fn1() {
ZTST_getchunk: read code chunk:
  fn1() {
    TRAPEXIT() { print EXIT1; }
    fn2() { TRAPEXIT() { print EXIT2; }; }
    fn2
  }
  fn1
ZTST_test: examining line:
>EXIT2
ZTST_getredir: read redir for '>':
EXIT2
EXIT1
ZTST_test: examining line:

Running test:  Nested TRAPEXIT
ZTST_test: expecting status: 0
Input: /tmp/zsh.ztst.in.10721, output: /tmp/zsh.ztst.out.10721, error: /tmp/zsh.ztst.terr.10721
Segmentation Fault - core dumped
make[1]: [check] Error 139 (ignored)
rm -rf Modules .zcompdump
make[1]: Leaving directory `/u/sheltonv/software/SunOS-5.5/build/zsh-2004-11-23/Test'

HTH,
  Vin

-- 
In a minute there is time
For decisions and revisions which a minute will reverse.         T.S. Eliot
[URL: http://www.cs.amherst.edu/~ccm/prufrock.html]

