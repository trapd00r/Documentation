From zsh-workers-return-10228-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Mar 24 12:05:52 2000
Return-Path: <zsh-workers-return-10228-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14600 invoked from network); 24 Mar 2000 12:05:51 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Mar 2000 12:05:51 -0000
Received: (qmail 10348 invoked by alias); 24 Mar 2000 12:05:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10228
Received: (qmail 10335 invoked from network); 24 Mar 2000 12:05:38 -0000
Date: Fri, 24 Mar 2000 13:05:36 +0100 (MET)
Message-Id: <200003241205.NAA25922@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Fri, 24 Mar 2000 14:31:23 +0300
Subject: RE: Wordcode files and compinit


Andrej Borsenkow wrote:

> > Hm. The wordcode files already store the complete pathnames used when
> > calling zcompile. That could be changed to prepend $PWD to names not
> > starting with a slash. Then we could change the patch for
> > `autoload -w'
> > to make `autoload -w foo.zwc a b c' mark only a, b and c for
> > autoloading. And then we could make `autoload -mw foo.zwc
> > "*/Completion/Debian/*"'
> > mark only those functions for autoloading.
> 
> This won't help in case of completion.

It isn't possible any more anyway (because of `zcompile -c ...').

> We need the information from
> comments and comments are lost when compiling zsh code. With current way
> completion is initialized, functions must be present in source form. I
> am not happy about it.

I'm very happy with it. No way for anyone to give completion functions 
(or any functions) without also giving the source code.

> Keeping two form of the same function always
> increases the possibility of two getting out of sync.

Have you had a look at the zrecompile function I sent? It should make
this simple. Also, the wordcode files could be organised in a way that 
makes the source files be preferred when they are younger (just create 
a wordcode file for each completion directory named like the directory 
with a trailing `.zwc'). That would be less efficient than using one
big wordcode file, though (zrecompile can help with both approaches).
And anyway, the distributed functions will, from a user's or
administrator's point of view, be relatively stable.

Please also remember that in the part of my message which you didn't
quote I said that I hadn't thought about using wordcode files for a
package concept and that the above was just a quick thought...

I don't plan to think much more about the package stuff now, there are 
other things higher on my lsit, so only another quick thought: we
could enhance the wordcode file format to allow user's to store extra
information for each function...

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

