From zsh-users-return-13714-mason-zsh=primenet.com.au@sunsite.dk Fri Jan 16 15:57:25 2009
Return-Path: <zsh-users-return-13714-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11867 invoked from network); 16 Jan 2009 15:57:13 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,WEIRD_PORT
	autolearn=no version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 Jan 2009 15:57:13 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 80228 invoked from network); 16 Jan 2009 15:57:04 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Jan 2009 15:57:04 -0000
Received: (qmail 449 invoked by alias); 16 Jan 2009 15:56:45 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13714
Received: (qmail 440 invoked from network); 16 Jan 2009 15:56:44 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 16 Jan 2009 15:56:44 -0000
Received: from vms173007pub.verizon.net (vms173007pub.verizon.net [206.46.173.7])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 9C58B8028ACA
	for <zsh-users@sunsite.dk>; Fri, 16 Jan 2009 16:56:27 +0100 (CET)
Received: from torch.brasslantern.com ([96.238.220.215])
 by vms173007.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0KDK0028RMVEMXE3@vms173007.mailsrvcs.net> for
 zsh-users@sunsite.dk; Fri, 16 Jan 2009 09:54:55 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n0GFuFhP021873	for
 <zsh-users@sunsite.dk>; Fri, 16 Jan 2009 07:56:16 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n0GFuFwo021872	for zsh-users@sunsite.dk; Fri,
 16 Jan 2009 07:56:15 -0800
Date: Fri, 16 Jan 2009 07:56:15 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: sourcing a sh file in zsh
In-reply-to: <BD9D2405-AD6A-4336-9C8A-85149165B6B8@gmail.com>
To: zsh-users@sunsite.dk
Message-id: <090116075615.ZM21871@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <BD9D2405-AD6A-4336-9C8A-85149165B6B8@gmail.com>
Comments: In reply to Evert Rol <evert.rol@gmail.com>
 "sourcing a sh file in zsh" (Jan 16,  2:53pm)
X-Virus-Scanned: ClamAV 0.92.1/8871/Fri Jan 16 05:16:59 2009 on bifrost
X-Virus-Status: Clean

On Jan 16,  2:53pm, Evert Rol wrote:
} 
} How do I source a .sh file in zsh? It works fine in bash or sh, but  
} gives an error when source in zsh.

You'll probably need to do something like

  emulate sh
  source bla.sh

That leaves the problem of getting back to your original zsh settings
after the script is done.  Depending on what the script is supposed
to accomplish, you might be able to wrap that in a shell function:

  sh_source() {
    emulate -L sh
    source "$@"
  }

That won't work if the script wants to declare variables with typeset
and have them remain set after it finishes.

} $> source bla.sh
} bla.sh:1: bad math expression: operand expected at `'
} 
} where that line reads:
}    [ "$a_root" = "" ] && a_root=/some/dir

I suspect the line number reported in the error is inaccurate, as zsh
wouldn't invoke any math operations for that.

