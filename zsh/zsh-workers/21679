From zsh-workers-return-21679-mason-zsh=primenet.com.au@sunsite.dk Tue Aug 23 00:02:07 2005
Return-Path: <zsh-workers-return-21679-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 71 invoked from network); 23 Aug 2005 00:02:00 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Aug 2005 00:02:00 -0000
Received: (qmail 13825 invoked from network); 23 Aug 2005 00:01:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Aug 2005 00:01:52 -0000
Received: (qmail 22066 invoked by alias); 23 Aug 2005 00:01:49 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21679
Received: (qmail 22056 invoked from network); 23 Aug 2005 00:01:48 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 23 Aug 2005 00:01:48 -0000
Received: (qmail 13426 invoked from network); 23 Aug 2005 00:01:48 -0000
Received: from mailms.chase.com (HELO sb11.jpmchase.com) (170.148.48.205)
  by a.mx.sunsite.dk with SMTP; 23 Aug 2005 00:01:44 -0000
Received: from cmx5.jpmchase.com (cmx5 [10.246.2.168])
	by sb11.jpmchase.com (Switch-3.1.6/Switch-3.1.6) with ESMTP id j7N01g9X030092
	for <zsh-workers@sunsite.dk>; Mon, 22 Aug 2005 20:01:43 -0400
Received: from bretton.ny.jpmorgan.com (bretton.ny.jpmorgan.com [10.21.19.32])
	by cmx5.jpmchase.com (Switch-3.1.6/Switch-3.1.6) with ESMTP id j7N01eB4020090
	for <zsh-workers@sunsite.dk>; Mon, 22 Aug 2005 20:01:40 -0400
Received: from aheading by bretton.ny.jpmorgan.com with local (Exim 4.41)
	id 1E7MEX-0000wP-V4
	for zsh-workers@sunsite.dk; Mon, 22 Aug 2005 20:01:41 -0400
Date: Mon, 22 Aug 2005 20:01:41 -0400
From: Anthony Heading <aheading@jpmorgan.com>
To: zsh-workers@sunsite.dk
Subject: dynamic modules without libzsh.so?
Message-ID: <20050823000141.GA21090@bretton.ny.jpmorgan.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.4i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.0.4


Hi,

How does one build the core zsh statically (i.e. with
builtin.o etc as part of the main executable, not in
libzsh-4.2.5.so), while still having zle and zftp
and so on created as loadable modules?

None of the configure invocations I've tried seem
to work, and while config.modules has link=static for
zsh/main that doesn't seem to stop libzsh-($VERSION).so
being built, since this seems to be controlled by
the expansion of Src/Makefile.in.

FWIW, the reason I want to do this is to have a
moveable zsh binary which is not dependent on an
embedded RPATH to the shared lib (and this is on
Solaris 8 where $ORIGIN support is broken).

Thanks

Anthony

PS.  On Solaris with gcc 4 (and I think earlier)
dynamic modules get disabled by default - it's
necessary to set DLLDFLAGS=-shared to override
a default setting of '-G' which doesn't work

This communication is for informational purposes only. It is not intended
as an offer or solicitation for the purchase or sale of any financial
instrument or as an official confirmation of any transaction. All market prices,
data and other information are not warranted as to completeness or accuracy and
are subject to change without notice. Any comments or statements made herein 
do not necessarily reflect those of JPMorgan Chase & Co., its subsidiaries 
and affiliates.

