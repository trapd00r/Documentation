From zsh-workers-request@math.gatech.edu Tue Aug 18 10:33:24 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4194 invoked from network); 18 Aug 1998 10:33:22 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 18 Aug 1998 10:33:22 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id GAA07435;
	Tue, 18 Aug 1998 06:27:23 -0400 (EDT)
Resent-Date: Tue, 18 Aug 1998 06:27:23 -0400 (EDT)
Message-Id: <199808181029.MAA07660@hydra.ifh.de>
X-Authentication-Warning: hydra.ifh.de: pws owned process doing -bs
To: pacman@cqc.com, zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: recipe for a ZLE segfault 
In-reply-to: "pacman@cqc.com"'s message of "Tue, 18 Aug 1998 00:22:43 MST."
             <19980818052244.3805.qmail@defiant.cqc.com> 
Date: Tue, 18 Aug 1998 12:29:57 +0200
From: Peter Stephenson <pws@ifh.de>
Resent-Message-ID: <"rkxhb3.0.6q1.BSLsr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4315
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

pacman@cqc.com wrote:
> $ zsh-3.1.4 -f
> londo% bindkey -v
> londo% bindkey '^[[A' history-beginning-search-backward
> londo% 
> 
> Now type ^[kBBC^[[A^M (ESC k B B C Up-arrow Enter). BLAM!

I get this too.  Does this fix it?  (It looks like it's necessary anyway,
according to my reading of mkundoent().)

*** Src/Zle/zle_utils.c.ch	Wed Apr 29 23:42:46 1998
--- Src/Zle/zle_utils.c	Tue Aug 18 12:24:07 1998
***************
*** 516,521 ****
--- 516,522 ----
  	line[ll - 1 - suf] == lastline[lastll - 1 - suf]; )
  	suf++;
      ch = zalloc(sizeof(*ch));
+     ch->next = NULL;
      ch->hist = histline;
      ch->off = pre;
      if(suf + pre == lastll)

-- 
Peter Stephenson <pws@ifh.de>       Tel: +39 50 844536
WWW:  http://www.ifh.de/~pws/
Gruppo Teorico, Dipartimento di Fisica
Piazza Torricelli 2, 56100 Pisa, Italy

