From zsh-workers-return-17910-mason-zsh=primenet.com.au@sunsite.dk Wed Nov 06 08:01:04 2002
Return-Path: <zsh-workers-return-17910-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2713 invoked from network); 6 Nov 2002 08:01:03 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 6 Nov 2002 08:01:03 -0000
Received: (qmail 18509 invoked by alias); 6 Nov 2002 08:00:49 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17910
Received: (qmail 18490 invoked from network); 6 Nov 2002 08:00:44 -0000
From: Sven Wischnowsky <wischnow@berkom.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15816.52462.264530.186687@wischnow.berkom.de>
Date: Wed, 6 Nov 2002 09:03:58 +0100
To: zsh-workers@sunsite.dk, Frank v Waveren <fvw@var.cx>
Subject: Re: zcompsys space character problem
In-Reply-To: <1021105051003.ZM21024@candle.brasslantern.com>
References: <1036465301GKC.fvw@jareth.var.cx>
	<1021105051003.ZM21024@candle.brasslantern.com>
X-Mailer: VM 7.03 under 21.5 (patch 5) "beets" XEmacs Lucid


Bart Schaefer wrote:

> ...
> 
> Changing line 461 from
> 
> 	compfiles -r tmp1 "$tmp3"
> 
> to
> 
> 	compfiles -r tmp1 "${(Q)tmp3}"
> 
> has the desired effect in this particular case, but I don't know if it is
> always correct.  Sven, are you out there?

I wasn't sure if it weren't better to put this into the C-code, but
leaving it in the shell code seems much more flexible (and, somehow,
logical).

Below is Bart's suggestion put into a patch which I'm goinh to commit.


Bye
  Sven

Index: Completion/Unix/Type/_path_files
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_path_files,v
retrieving revision 1.19
diff -u -r1.19 _path_files
--- Completion/Unix/Type/_path_files	2 Jul 2002 14:06:49 -0000	1.19
+++ Completion/Unix/Type/_path_files	6 Nov 2002 07:55:34 -0000
@@ -464,7 +464,7 @@
     # names. This avoids having `foo' complete to `foo' and `foobar'.
     # The return value is non-zero if the component is ambiguous.
 
-    compfiles -r tmp1 "$tmp3"
+    compfiles -r tmp1 "${(Q)tmp3}"
     tmp4=$?
 
     if [[ "$tpre" = */* ]]; then

-- 
Sven Wischnowsky                          wischnow@berkom.de

