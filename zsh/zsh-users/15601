From zsh-users-return-15601-mason-zsh=primenet.com.au@zsh.org Sat Dec 04 03:36:06 2010
Return-Path: <zsh-users-return-15601-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11446 invoked by alias); 4 Dec 2010 03:36:06 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15601
Received: (qmail 19402 invoked from network); 4 Dec 2010 03:35:55 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.7 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,FREEMAIL_FROM,RCVD_IN_DNSWL_LOW,
	T_TO_NO_BRKTS_FREEMAIL autolearn=ham version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 209.85.160.171 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:subject:user-agent
         :date:message-id:mime-version:content-type;
        bh=ebh9X/oUomCPqfHqzeiDFB+IVSqRzazA8kHh2/bFLx4=;
        b=D4Iq4Mnb/HWwIFH3bN1DCp+zvQJ6DKoHdSMjvaKWcnjxZcIjOIEAgFqUbONPHVELOO
         NyV+EL56MbRSa+5eqFuUZ35tA9TDMaS9MkZXb3j9YEmEp+qmTPRZHbuD/6Qu9JfwWVLi
         vDtKaVmLHxf6Ou5hKf2+3WIV5o8940wjE/BII=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=from:to:subject:user-agent:date:message-id:mime-version
         :content-type;
        b=jIIFXozRFkLLrE+J2aRLtF8kr+96FMR2d/zZDchGoDcHk3LRbOj0RQ7wo14DlKl1Ax
         lafmi6TcegHfNdUK9JfCG1ATDvqjFLAioeRqq8xdu8cZJYu8McbsXGCm76Eg7UYJAIw6
         ZKolgljJBaRxPr9n0AWywW/IjGGH5X5pHrkAw=
From: Anonymous <swell.k@gmail.com>
To: zsh-users@zsh.org
Subject: time builtin vs. time(1): difference in memory numbers
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/24.0.50 (berkeley-unix)
Date: Sat, 04 Dec 2010 04:43:33 +0300
Message-ID: <868w06l3cq.fsf@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain

zsh-4.3.10_4, FreeBSD 9.0-CURRENT r216095M amd64

I'm a bit puzzled by...

- numbers for shared/unshared space don't match those from `time -l'
- zsh manual page claims that %M stands for memory in Kbytes while it
  displays them in Mbytes

Do %X/%D/%K/%M display consistent numbers on Linuces or other BSDs?

$ tcsh -f
% set time=(3 "%X shared %D unshared %K total %M maxres")
% time xz -c /COPYRIGHT >/dev/null
52 shared 3148 unshared 3200 total 8132 maxres

$ zsh -f
% TIMEFMT="%X shared %D unshared %K total %M maxres"
% time xz -c /COPYRIGHT >/dev/null
6953 shared 420930 unshared 427883 total 17 maxres

$ command time -l xz -c /COPYRIGHT >/dev/null
        0.02 real         0.00 user         0.02 sys
     17220  maximum resident set size
        78  average shared memory size
      3032  average unshared data size
       192  average unshared stack size
      4386  page reclaims
         0  page faults
         0  swaps
         0  block input operations
         1  block output operations
         0  messages sent
         0  messages received
         0  signals received
         1  voluntary context switches
         1  involuntary context switches

time(1) is close to ps(1) and STATUS (^T) in numbers about resident size.
Not sure why maxres (%M) is halved for tcsh.

