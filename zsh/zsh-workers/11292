From zsh-workers-return-11292-mason-zsh=primenet.com.au@sunsite.auc.dk Wed May 10 07:58:34 2000
Return-Path: <zsh-workers-return-11292-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4263 invoked from network); 10 May 2000 07:58:33 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 10 May 2000 07:58:33 -0000
Received: (qmail 7357 invoked by alias); 10 May 2000 07:58:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11292
Received: (qmail 7336 invoked from network); 10 May 2000 07:58:22 -0000
Date: Wed, 10 May 2000 09:58:19 +0200 (MET DST)
Message-Id: <200005100758.JAA07439@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 10 May 2000 01:59:31 +0900
Subject: PATCH: Re: file-patterns


Tanaka Akira wrote:

> Z(4):akr@serein% zsh -f
> serein% bindkey -e; autoload -U compinit; compinit -D
> serein% zstyle ':completion:*' file-patterns '%p:globbed-files *(-/):directories' '*:all-files'
> serein% ls 
> %p             Completion/    Doc/           Functions/     Src/           Test/          
> CVS/           Config/        Etc/           Misc/          StartupFiles/  Util/          
> 
> Hm.  `%p' is completed.

That's because `%' isn't special after `${foo//' any more.

Bye
 Sven

Index: Completion/Core/_files
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_files,v
retrieving revision 1.9
diff -u -r1.9 _files
--- Completion/Core/_files	2000/04/12 12:35:38	1.9
+++ Completion/Core/_files	2000/05/10 07:57:08
@@ -26,7 +26,7 @@
 if zstyle -a ":completion:${curcontext}:" file-patterns tmp; then
   [[ "$type" = */* ]] && glob="$glob,*(-/)"
   pats=()
-  for i in ${tmp//\\%p/${${glob:-\*}//:/\\:} }; do
+  for i in ${tmp//%p/${${glob:-\*}//:/\\:} }; do
     if [[ $i = *[^\\]:* ]]; then
       pats=( "$pats[@]" " $i " )
     else

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

