From zsh-workers-return-10799-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Apr 18 07:10:03 2000
Return-Path: <zsh-workers-return-10799-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4740 invoked from network); 18 Apr 2000 07:10:02 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 Apr 2000 07:10:02 -0000
Received: (qmail 19171 invoked by alias); 18 Apr 2000 07:09:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10799
Received: (qmail 19163 invoked from network); 18 Apr 2000 07:09:51 -0000
Date: Tue, 18 Apr 2000 09:09:50 +0200 (MET DST)
Message-Id: <200004180709.JAA16373@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Sven Wischnowsky's message of Mon, 17 Apr 2000 12:42:45 +0200
	(MET DST)
Subject: Re: PATCH: newlines in job-texts (was: Re: Questions)


I'm sooo ashamed... When the text will not be used for a job-text, it
should still contain the newlines, of course.


Bye
 Sven

Index: Src/text.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/text.c,v
retrieving revision 1.3
diff -u -r1.3 text.c
--- Src/text.c	2000/04/17 10:46:01	1.3
+++ Src/text.c	2000/04/18 07:08:33
@@ -69,8 +69,12 @@
 	tlim = tbuf + tsiz;
 	tptr = tbuf + x;
     }
-    while ((c = *s++))
-	*tptr++ = (c == '\n' ? ' ' : c);
+    if (tnewlins) {
+	memcpy(tptr, s, sl);
+	tptr += sl;
+    } else
+	while ((c = *s++))
+	    *tptr++ = (c == '\n' ? ' ' : c);
 }
 
 /**/

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

