From zsh-users-return-8146-mason-zsh=primenet.com.au@sunsite.dk Mon Nov 01 12:41:01 2004
Return-Path: <zsh-users-return-8146-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29265 invoked from network); 1 Nov 2004 12:41:00 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Nov 2004 12:41:00 -0000
Received: (qmail 88786 invoked from network); 1 Nov 2004 12:40:53 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Nov 2004 12:40:53 -0000
Received: (qmail 440 invoked by alias); 1 Nov 2004 12:40:02 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8146
Received: (qmail 419 invoked from network); 1 Nov 2004 12:40:01 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 1 Nov 2004 12:40:01 -0000
Received: (qmail 87415 invoked from network); 1 Nov 2004 12:40:01 -0000
Received: from ns9.hostinglmi.net (213.194.149.146)
  by a.mx.sunsite.dk with SMTP; 1 Nov 2004 12:40:00 -0000
Received: from 212.red-80-35-44.pooles.rima-tde.net ([80.35.44.212]:47019 helo=dervishd.net)
	by ns9.hostinglmi.net with esmtpa (Exim 4.43)
	id 1CObTa-0005JP-Lh; Mon, 01 Nov 2004 13:39:59 +0100
Date: Mon, 1 Nov 2004 13:42:37 +0100
From: DervishD <zsh@dervishd.net>
To: William Scott <wgscott@chemistry.ucsc.edu>
Cc: zsh-users@sunsite.dk
Subject: Re: Yet another completion question
Message-ID: <20041101124237.GA16236@DervishD>
Mail-Followup-To: William Scott <wgscott@chemistry.ucsc.edu>,
	zsh-users@sunsite.dk
References: <20041027184948.GA10764@DervishD> <Pine.GSO.4.43.0410290808140.9882-100000@hydrogen.ucsc.edu>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <Pine.GSO.4.43.0410290808140.9882-100000@hydrogen.ucsc.edu>
User-Agent: Mutt/1.4.2.1i
Organization: DervishD
X-MailScanner-Information: Please contact the ISP for more information
X-MailScanner: Found to be clean
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - ns9.hostinglmi.net
X-AntiAbuse: Original Domain - sunsite.dk
X-AntiAbuse: Originator/Caller UID/GID - [0 0] / [47 12]
X-AntiAbuse: Sender Address Domain - dervishd.net
X-Source: 
X-Source-Args: 
X-Source-Dir: 
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

    Hi William :)

 * William Scott <wgscott@chemistry.ucsc.edu> dixit:
> I have a completion that works in the old form and would like
> to write a completion function.
[...]
> and I am using compctl to read in a file it produces, since this takes
> awhile to produce:
> 
>  compctl -f  -x 'c[-1,-a] p[2,2]' -s "$(cat ~/.zshapplist)" \
>           -M 'm:{A-Za-z}={a-zA-Z} r: ||[^ ]=**' -- open
> 
> This works.  I figured out the -s was critical to getting this to
> work right with the applications having escaped spaces.
> 
> But what I would like to do is use the new completion system and cache
> these completions in the proper z-shell manner.

    I'm NOT an expert in completion. In fact, I'm NOT even a NEWBIE.
I'll just tell you what I would do. If your compctl code works, keep
on using it. If, by all means, you really want to write that code in
the compsys way, do it at the higher level possible, using _arguments
and the like, but don't use compadd directly. Otherwise you will need
to write a lot more of code just to make compadd work as compctl
worked, and all that code is already written for you thanks to zsh
developers and contributors. There is no real point in rewriting code
written by clever programmers, unless you're (as I am) pathologically
impulsed to do so O:)))

    Probably you will be able to rewrite your compctl recipe using
the new system in a couple of lines of code if you use the higher
level functions (_wanted, _arguments, etc.). I don't know how to use
them, but AFAIK they are documented properly in the zsh user's
manual.

> I can't seem to figure out how to use compadd syntax in analogy to the -s
> option of compctl.

    You don't need it: when you're writing a shell function to do the
completion, if compsys doesn't have already one that suits you to do
the same job, you can simply use shell constructions to do the job,
create a list (an array will do) and use compadd to add such list to
the completion list.

    BTW: do you really need -s? won't you get the same result with
'-k'?

    Raúl Núñez de Arenas Coronado

-- 
Linux Registered User 88736
http://www.dervishd.net & http://www.pleyades.net/

