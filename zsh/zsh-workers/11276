From zsh-workers-return-11276-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 09 11:52:37 2000
Return-Path: <zsh-workers-return-11276-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15978 invoked from network); 9 May 2000 11:52:36 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 May 2000 11:52:36 -0000
Received: (qmail 28401 invoked by alias); 9 May 2000 11:52:12 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11276
Received: (qmail 28380 invoked from network); 9 May 2000 11:52:11 -0000
To: zsh-workers@sunsite.auc.dk
Subject: Re: build problem on OpenBSD 2.6
References: <hvog0s4w6c9.fsf@serein.m17n.org>
MIME-Version: 1.0 (generated by SEMI 1.13.7 - "Awazu")
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@m17n.org>
Date: 09 May 2000 20:53:25 +0900
In-Reply-To: <hvog0s4w6c9.fsf@serein.m17n.org>
 (Tanaka Akira's message of "30 Apr 2000 13:39:02 +0900")
Message-ID: <hvou2g8gcsq.fsf@serein.m17n.org>
Lines: 56
User-Agent: T-gnus/6.14.1 (based on Gnus v5.8.3) (revision 16) SEMI/1.13.7 (Awazu) FLIM/1.13.2 (Kasanui) Emacs/20.6 (i686-pc-linux-gnu) MULE/4.0 (HANANOEN)

In article <hvog0s4w6c9.fsf@serein.m17n.org>,
  Tanaka Akira <akr@m17n.org> writes:

> On OpenBSD 2.6, zsh-3.1.7-pre-1 is failed to build.

I found another problem on OpenBSD.  --enable-zsh-debug can not used
because ld doesn't accept -g as NetBSD.

Although I think the patch for zftp.c is bit ugly, I'll commit this...

Index: configure.in
===================================================================
RCS file: /cvsroot/zsh/zsh/configure.in,v
retrieving revision 1.8
diff -u -r1.8 configure.in
--- configure.in	2000/05/02 14:22:39	1.8
+++ configure.in	2000/05/09 11:44:01
@@ -316,7 +316,7 @@
 fi
 if test -n "$auto_ldflags"; then
   case "${enable_zsh_debug}$host_os" in
-    yesaix*|yeshpux*|yesnetbsd*) ;;  # "ld -g" is not valid on these systems
+    yesaix*|yeshpux*|yesnetbsd*|yesopenbsd*) ;;  # "ld -g" is not valid on these systems
     yes*)    LDFLAGS=-g ;;
     *)       LDFLAGS=-s ;;
   esac
Index: Src/Modules/zftp.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Modules/zftp.c,v
retrieving revision 1.1.1.22
diff -u -r1.1.1.22 zftp.c
--- Src/Modules/zftp.c	2000/02/23 15:18:47	1.1.1.22
+++ Src/Modules/zftp.c	2000/05/09 11:44:02
@@ -50,15 +50,17 @@
 struct zftp_session;
 typedef struct zftp_session *Zftp_session;
 
-#include "zftp.mdh"
-#include "zftp.pro"
-
+#include <sys/types.h>
 #include <sys/socket.h>
 #include <netdb.h>
 #include <netinet/in_systm.h>
 #include <netinet/in.h>
 #include <netinet/ip.h>
 #include <arpa/inet.h>
+
+#include "zftp.mdh"
+#include "zftp.pro"
+
 /* it's a TELNET based protocol, but don't think I like doing this */
 #include <arpa/telnet.h>
 
-- 
Tanaka Akira

