From zsh-users-return-3515-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Nov 07 19:45:11 2000
Return-Path: <zsh-users-return-3515-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16549 invoked from network); 7 Nov 2000 19:45:09 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Nov 2000 19:45:09 -0000
Received: (qmail 10101 invoked by alias); 7 Nov 2000 19:44:49 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3515
Received: (qmail 10094 invoked from network); 7 Nov 2000 19:44:48 -0000
From: "Jack McKinney" <jackmc-zsh-users@lorentz.com>
Date: Tue, 7 Nov 2000 13:44:46 -0600
To: zsh-users@sunsite.auc.dk
Subject: Re: for loop body works, but not when called from for loop...
Message-ID: <20001107134445.A3548@stocks.pillory.com>
Mail-Followup-To: zsh-users@sunsite.auc.dk
References: <20001107113047.A32446@stocks.pillory.com> <001107113812.ZM13332@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="NzB8fVQJ5HfG6fxh"
Content-Disposition: inline
User-Agent: Mutt/1.2i
In-Reply-To: <001107113812.ZM13332@candle.brasslantern.com>; from schaefer@candle.brasslantern.com on Tue, Nov 07, 2000 at 11:38:12AM -0800


--NzB8fVQJ5HfG6fxh
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Big Brother tells me that Bart Schaefer wrote:
> On Nov 7, 11:30am, Jack McKinney wrote:
> > Subject: for loop body works, but not when called from for loop...
> >=20
> > for i in $(find . -name \*.pgp | fgrep -v ring.pgp) ; do ;
> > echo $i ; pgp -fd -z "My passphrase" < $i |
> > gpg --passphrase-fd 3 --batch -c 3<<< "My passphrase" > ${i%pgp}gpg ; d=
one
> >=20
> >     When I run it, it echoes the first file it finds, and creates the .=
gpg
> > file (since it is stdout of one of the commands).  However, the file ne=
ver
> > gets any data in it.  [...] the echo command echoes the correct filename
> > (./test.pgp), but it just hangs there.
>=20
> What version of zsh are we talking about?

    3.1.2, as compiled by debian 2.1.
> Are you typing out that loop at a shell prompt, or is it in a script?  If
> the latter, what else is in the script?  When you run the non-loop trial,
> is everything the same except for the loop?

     I am typing it at the prompt.  When it doesn't work, I type ctrl-C
to get back to the prompt, and set i to the value of the first file. Then,
I use the line editor to back up to the for loop and remove the loop and
run it.  It works fine, then.
     What I ended up doing was to put the body into a script, and then
ran the for loop to call the script.  This worked just fine.  I never
retyped anything, it was all copy and paste.

> What happens if you run the loop version, and type control-D to send it an
> EOF when it seems hung?

     Good question.  I just set this up again and tried it, and nothing
happens.  It does not appear to be waiting for stdin.

> Something must be waiting for input.  I don't know exactly what, or wheth=
er
> it might have something to do with file descriptor 3.

    It shouldn't, since it works fine outside the loop or inside a script
called by the loop.

--
"Restore your inalienable human rights.       Jack McKinney
 Vote Libertarian.  http://www.lp.org         http://www.lorentz.com
 http://www.harrybrowne2000.org               jackmc@lorentz.com
                                              1024D/D68F2C07 4096g/38AEF076

--NzB8fVQJ5HfG6fxh
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.4 (GNU/Linux)
Comment: For info see http://www.gnupg.org

iEYEARECAAYFAjoIW60ACgkQimeon9aPLAeKNwCfch+WZRl/yXJwmV8MrEV/4oWz
nrUAn3KEF/M86fOrTQoEElzZyV/aFLi3
=uIf3
-----END PGP SIGNATURE-----

--NzB8fVQJ5HfG6fxh--

