From zsh-workers-return-8499-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Nov 02 20:10:46 1999
Return-Path: <zsh-workers-return-8499-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12853 invoked from network); 2 Nov 1999 20:10:45 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 Nov 1999 20:10:45 -0000
Received: (qmail 28472 invoked by alias); 2 Nov 1999 20:10:33 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8499
Received: (qmail 28465 invoked from network); 2 Nov 1999 20:10:32 -0000
Date: Tue, 2 Nov 1999 15:10:31 -0500
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: tcsetpgrp test switch
Message-ID: <19991102151031.A5951@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0pre4i

This provides a configure switch to prevent the testing of tcsetpgrp.

--- configure.in.bak	Tue Nov  2 14:43:47 1999
+++ configure.in	Tue Nov  2 15:05:47 1999
@@ -250,6 +250,13 @@
   AC_DEFINE(MAILDIR_SUPPORT)
 fi])
 
+dnl Do you want to verify that tcsetpgrp works?
+undefine([tcsetpgrp-check])dnl
+AC_ARG_ENABLE(tcsetpgrp-check,
+[  --disable-tcsetpgrp-check     Disable test of tcsetpgrp],
+[tcsetpgrp-check="$enableval"], [tcsetpgrp-check=yes])
+
+
 dnl ------------------
 dnl CHECK THE COMPILER
 dnl ------------------
@@ -1240,8 +1247,12 @@
 dnl -----------
 dnl if found tcsetpgrp, test to see if it actually works
 dnl for instance, BeOS R4.51 does not support it yet
+dnl When building where stdin is not a terminal, this
+dnl check will fail, resulting in no job control support
+dnl being available.  Because this is undesirable, allow
+dnl it to be skipped.
 dnl -----------
-if test $ac_cv_func_tcsetpgrp=yes; then
+if test $ac_cv_func_tcsetpgrp=yes -a $tcsetpgrp-check=yes; then
     AC_CACHE_CHECK(if tcsetpgrp() actually works,
     zsh_cv_sys_tcsetpgrp,
     [AC_TRY_RUN([

