From zsh-users-return-2691-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Oct 24 22:33:05 1999
Return-Path: <zsh-users-return-2691-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16742 invoked from network); 24 Oct 1999 22:33:03 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Oct 1999 22:33:03 -0000
Received: (qmail 26480 invoked by alias); 24 Oct 1999 22:32:47 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 2691
Received: (qmail 26472 invoked from network); 24 Oct 1999 22:32:46 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <991024223238.ZM13211@candle.brasslantern.com>
Date: Sun, 24 Oct 1999 22:32:38 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-users@sunsite.auc.dk
Subject: compconfig[list_condition]
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

I'm still fooling around with insert-and-predict.  In its present state, it
attempts regular completion on any self-inserted key (other than space) that
does not result in a history-beginning-search match.  With autolist set,
however, this tends to produce things like this:

zagzig[28] echo $
zsh: do you wish to see all 128 possibilities? 

This means I have to type an extra character, which if I'm typing quickly
enough I fail to do, causing a character that I wanted to have on the line
to be consumed instead.  This was previously discussed (in zsh-users/2641)
and the result seems to have been the addition of compstate[list_lines] and
BUFFERLINES (mis-documented as BLINES, by the way) in 8227.

So I've added

compconfig[list_condition]='compstate[list_lines]+BUFFERLINES < LINES'
compconfig[completer]='_list:_complete'

to my completion configuration, and set LISTMAX very large.  However, this
doesn't do what I thought it would.  I tried reversing the order of the
completers, and setting and unsetting autolist, but either I get listings
that scroll off the screen or I don't get any listings at all.

What *should* I be doing to get listings if and only if they fit on the
screen?

(Incidentally, I captured some debugging output and it appears that
$[compstate[list_lines]+BUFFERLINES < LINES] is always true, no matter how
many lines are going to be in the listing or what order the completers are
given.)

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

