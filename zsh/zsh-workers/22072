From zsh-workers-return-22072-mason-zsh=primenet.com.au@sunsite.dk Mon Dec 12 16:45:52 2005
Return-Path: <zsh-workers-return-22072-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7733 invoked from network); 12 Dec 2005 16:45:47 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Dec 2005 16:45:47 -0000
Received: (qmail 97826 invoked from network); 12 Dec 2005 16:45:41 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Dec 2005 16:45:41 -0000
Received: (qmail 6069 invoked by alias); 12 Dec 2005 16:45:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22072
Received: (qmail 6059 invoked from network); 12 Dec 2005 16:45:38 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 12 Dec 2005 16:45:38 -0000
Received: (qmail 97634 invoked from network); 12 Dec 2005 16:45:38 -0000
Received: from cluster-c.mailcontrol.com (HELO rly22c.srv.mailcontrol.com) (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 12 Dec 2005 16:45:36 -0000
Received: from exchange03.csr.com (uuk202166.uk.customer.alter.net [62.189.241.194] (may be forged))
	by rly22c.srv.mailcontrol.com (MailControl) with ESMTP id jBCGeeAO016279
	for <zsh-workers@sunsite.dk>; Mon, 12 Dec 2005 16:45:30 GMT
Received: from news01 ([10.103.143.38]) by exchange03.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 12 Dec 2005 16:42:03 +0000
Date: Mon, 12 Dec 2005 16:42:02 +0000
From: Peter Stephenson <pws@csr.com>
To: zsh-workers@sunsite.dk
Subject: Re: Weird delay on long command lines
Message-Id: <20051212164202.0edd4c16.pws@csr.com>
In-Reply-To: <237967ef0512091236n1fb4fe28lb77d2b75d42dedce@mail.gmail.com>
References: <237967ef0512091236n1fb4fe28lb77d2b75d42dedce@mail.gmail.com>
Organization: Cambridge Silicon Radio
X-Mailer: Sylpheed version 0.9.12 (GTK+ 1.2.10; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 12 Dec 2005 16:42:03.0268 (UTC) FILETIME=[FAE8E440:01C5FF3A]
X-Scanned-By: MailControl A-05-40-01 (www.mailcontrol.com) on 10.67.0.132

Mikael Magnusson <mikachu@gmail.com> wrote:
> This mostly happens when i paste gcc commands from autoconf, but it's
> easy to reproduce with the alt-number keybinds. For example type
> alt-1000 and press a, then press left arrow. You'll notice it takes a
> second or two before anything happens. I've confirmed the same thing
> happens with zsh -f. Attaching with strace shows the final argument to
> poll() seems to be O(n) with the command line length but I really have
> no idea why (or what the poll is for, haven't looked at the code).

It's to do with the optimisation of the display for low baud rates.  BAUD is
initiliased from the terminal driver which may well have it set to
something low like 38400.  Try setting it to something much larger, or
unsetting BAUD altogether.

It's probably more trouble than it's worth nowadays; the number of serial
line terminals, or even remote terminals where it's worth optimising the
terminal handling, is probably quite limited.  Maybe it shouldn't be set by
default.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


This message has been scanned for viruses by BlackSpider MailControl - www.blackspider.com

