From schaefer@candle.brasslantern.com Fri Jul 19 08:23:06 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id IAA20655 for <mason@werple.mira.net.au>; Fri, 19 Jul 1996 08:23:03 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id SAA11729; Thu, 18 Jul 1996 18:17:35 -0400 (EDT)
Resent-Date: Thu, 18 Jul 1996 18:17:35 -0400 (EDT)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <9607181518.ZM14255@candle.brasslantern.com>
Date: Thu, 18 Jul 1996 15:18:39 -0700
In-Reply-To: Zefram <A.Main@dcs.warwick.ac.uk>
        "more dependencies on emulation" (Jul 18,  3:23pm)
References: <11879.199607181423@granite.dcs.warwick.ac.uk>
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (3.2.1 24feb96 Caldera)
To: Zefram <A.Main@dcs.warwick.ac.uk>,
        zsh-workers@math.gatech.edu (Z Shell workers mailing list)
Subject: Re: more dependencies on emulation
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"1As9y.0.Ct2.-Vhxn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1700
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1525
Status: O

On Jul 18,  3:23pm, Zefram wrote:
> Subject: more dependencies on emulation
> -----BEGIN PGP SIGNED MESSAGE-----
> 
> There are two distinct uses of emulation addressed here.  One affects
> the position of filename expansion in the order of expansion; I add a
> new option, SH_FILE_SUBST, to control this.  [...]
> 
> The second use of emulation is to control whether the $foo[2] subscript
> placement will work; sh and ksh don't recognise it as a subscript.
> The patch makes this be controlled by the KSH_ARRAYS option, as it should
> have been all along.  The KSH_ARRAYS option is also changed to be set
> by default when emulating sh, which was previously not essential.

[....]

>       + \fBSH_FILE_SUBST\fP
>       + If this option is unset, it is performed
>       + .I after
>       + brace expansion, so things like ``~$USERNAME'' ``~{pfalstad,rc}'' will work.

Two minor nits:

If zsh were really emulating sh, arrays wouldn't work at all.  So it's a
bit dubious to force ksh syntax only, given that it affects the indices
as well as the syntax.

I don't have a ksh to try this, but ~{pfalstad,rc} works fine in Bash
(that is, the ~ is expanded), even though ~$USER doesn't expand tilde.
In zsh's ksh emulation mode with this patch applied, ~$USER works, but
~{pfalstad,rc} fails unless IGNORE_BRACES is also unset.  There doesn't
seem to be any way to get the Bash behavior (maybe not important), but
the manual should probably mention the IGNORE_BRACES requirement if it
is going to use ~{...} in this example.


