From zsh-workers-request@euclid.skiles.gatech.edu  Sun Nov 10 16:56:53 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id QAA03925 for <mason@primenet.com.au>; Sun, 10 Nov 1996 16:56:50 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id AAA24917; Sun, 10 Nov 1996 00:54:26 -0500 (EST)
Resent-Date: Sun, 10 Nov 1996 00:54:26 -0500 (EST)
From: Geoff Wing <gwing@primenet.com.au>
Message-Id: <199611100552.QAA03910@coral.primenet.com.au>
Subject: Re: Purified zsh-3.0.1
To: hniksic@srce.hr (Hrvoje Niksic)
Date: Sun, 10 Nov 1996 16:52:25 +1100 (EST)
Cc: zsh-workers@math.gatech.edu (zsh-workers)
In-Reply-To: <kigd8xmttg1.fsf@jagor.srce.hr> from "Hrvoje Niksic" at Nov 10, 96 06:22:54 am
X-Mailer: ELM [version 2.4 PL25]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"knz-93.0.F56.HuMXo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2361
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hrvoje Niksic wrote:
:Geoff Wing (gwing@primenet.com.au) wrote:
:> :I hope this will help debugging...  Those ABR-s in line editor could
:> :be the cause of coredumps seen on Ultrix, that are quite hard to
:> :repeat.
:> This is a patch (on top of 2351 and its predecessor though it'll
:Yup, that fixes it (at least I cannot repeat it anymore).  Anyway, zsh
:is very stable, in the sense of purify.  Now there are no more
:array-bound reads or writes.
:> It doesn't seem likely to me that it would be the cause of any
:> coredumps.
:But it is possible, as soon as you read memory outside of the
:allocated block, isn't it?  The fact that the read was off-by-one
:could account for those dumps being hard to repeat.

Yes, though very unlikely. I don't know how your malloc stuff aligns things,
but the buffers involved are normally 81 bytes (for an 80 column screen)
and if accessing the 82nd byte places it outside a page boundary, then
that would be strange.

I think the most likely way for you to get it to reoccur, is by having 
delete/insert happen on a line, so scroll between lines which have
lots of similarities.
I play around a bit with a segment of my news file  `active' - 20k to 80k
worth.  Then do something like
% echo $(< active)<TAB>
and CTRL-A / CTRL-E combinations and other cursor movements.

Don't use the full `active' file: 800-900k, expand it on line, then press
return.  I had it going for over twenty minutes, memory use up to 27 meg,
before I got sick of it and killed it EXTERNALLY (no internal interrupt).
Not that many people are going to be doing this sort of thing, but...
The spelling correction stuff could use a bit of improvement -
I assume it rereads the directory for every single word on line.
-- 
Geoff Wing [gwing@primenet.com.au]   Technical Manager
  Phone    : +61-3-9818 2977	     PrimeNet - Internet Consultancy
  Facsimile: +61-3-9819 3788	     Web : <URL:http://www.primenet.com.au/>
  Mobile   : 0412 162 441

