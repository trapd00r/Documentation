From zsh-workers-return-19998-mason-zsh=primenet.com.au@sunsite.dk Tue Jun 01 07:17:32 2004
Return-Path: <zsh-workers-return-19998-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12464 invoked from network); 1 Jun 2004 07:17:31 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.86)
  by ns1.primenet.com.au with SMTP; 1 Jun 2004 07:17:31 -0000
Received: (qmail 21347 invoked from network); 1 Jun 2004 07:17:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Jun 2004 07:17:13 -0000
Received: (qmail 22214 invoked by alias); 1 Jun 2004 07:17:09 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19998
Received: (qmail 22205 invoked from network); 1 Jun 2004 07:17:08 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 1 Jun 2004 07:17:05 -0000
Received: (qmail 21007 invoked from network); 1 Jun 2004 07:17:05 -0000
Received: from web51107.mail.yahoo.com (206.190.38.149)
  by a.mx.sunsite.dk with SMTP; 1 Jun 2004 07:17:02 -0000
Message-ID: <20040601071634.55178.qmail@web51107.mail.yahoo.com>
Received: from [63.201.35.238] by web51107.mail.yahoo.com via HTTP; Tue, 01 Jun 2004 00:16:34 PDT
Date: Tue, 1 Jun 2004 00:16:34 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: Re: zsh 4.2.0 dumping core on completion attempt 
To: Oliver Kiddle <okiddle@yahoo.co.uk>
Cc: zsh-workers@sunsite.dk
In-Reply-To: <3888.1085737050@trentino.logica.co.uk>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=BAYES_50,RCVD_IN_SORBS 
	autolearn=no version=2.63
X-Spam-Hits: 1.5


--- Oliver Kiddle <okiddle@yahoo.co.uk> wrote:

> It probably just needs:
> 	 (!o->word || !strncmp(o->word, n->word, o->wlen))) ||
> changing to:
>          (!o->word || !n->word || !strncmp(o->word, n->word, o->wlen))) ||

I tried this change, and it prevents the core dump.

> 
> We've got o->word == "xmmap", n->word == NULL and o->wlen == n->wlen.
> So it might be a bug elsewhere that allows n->word == NULL or it might
> be an omission that it isn't checked. Presumably n->wlen == 0 but is
> that a length or an initial value?
> 
> Could you perhaps have a more detailed look from the debugger. At least
> see what n->wlen is and ideally trace back to where o->word, n->word and
> n->wlen are set (or not set).  Does that change result in it completing
> the right thing?
> 
> Unfortunately, I can't reproduce the problem on any system I have access
> to. If we can't find a bug higher in the chain, this would at least
> avoid it crashing but I'd obviously prefer to understand what's going on.

I'm having problems with shared libs and gdb on my home system, so I'll have to
try elsewhere to see if I can get you more info.  I'd be happier if we can find
the cause of the bug.  I did run valgrind, and the only thing it reported was
strncmp getting the NULL. 

-FR.


	
		
__________________________________
Do you Yahoo!?
Friends.  Fun.  Try the all-new Yahoo! Messenger.
http://messenger.yahoo.com/ 

