From zsh-workers-return-26631-mason-zsh=primenet.com.au@sunsite.dk Sat Feb 28 18:23:13 2009
Return-Path: <zsh-workers-return-26631-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29162 invoked from network); 28 Feb 2009 18:23:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 28 Feb 2009 18:23:09 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 70172 invoked from network); 28 Feb 2009 18:23:05 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 Feb 2009 18:23:05 -0000
Received: (qmail 8316 invoked by alias); 28 Feb 2009 18:23:02 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26631
Received: (qmail 8303 invoked from network); 28 Feb 2009 18:23:01 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 28 Feb 2009 18:23:01 -0000
Received: from vms173015pub.verizon.net (vms173015pub.verizon.net [206.46.173.15])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 71EBB8058F83
	for <zsh-workers@sunsite.dk>; Sat, 28 Feb 2009 19:22:58 +0100 (CET)
Received: from torch.brasslantern.com ([173.67.122.60])
 by vms173015.mailsrvcs.net
 (Sun Java(tm) System Messaging Server 6.3-7.04 (built Sep 26 2008; 32bit))
 with ESMTPA id <0KFS00CPFGE44ON7@vms173015.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Sat, 28 Feb 2009 12:22:57 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n1SIMptH003439; Sat,
 28 Feb 2009 10:22:51 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n1SIMo5c003438; Sat, 28 Feb 2009 10:22:50 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <090228102250.ZM3434@torch.brasslantern.com>
Date: Sat, 28 Feb 2009 10:22:50 -0800
In-reply-to: <19e566510902280137s3bb02510te650364cb03145a9@mail.gmail.com>
Comments: In reply to ( Text in unknown character set UTF-8 not shown )
 <ismail@namtrac.org>        "Problems with non-ascii filenames" (Feb 28,
 11:37am)
References: <19e566510902280137s3bb02510te650364cb03145a9@mail.gmail.com>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: ismail@namtrac.org, zsh workers <zsh-workers@sunsite.dk>
Subject: Re: Problems with non-ascii filenames
MIME-version: 1.0
Content-type: text/plain; charset=iso-8859-1
Content-transfer-encoding: quoted-printable
X-Virus-Scanned: ClamAV 0.92.1/9057/Sat Feb 28 14:56:20 2009 on bifrost
X-Virus-Status: Clean

On Feb 28, 11:37am, Ismail wrote:
}=20
} Using latest zsh CVS on OSX 10.5.6, observe :
}=20
} [~]> touch x=C3=C3=C3x
}=20
} [~]> echo xo<0308>o<0308>o<0308>x
} x=C3=C3=C3x
}=20
} Somehow "=C3" character is replaced by <0308> while tab completing. Any
} help is appreciated.

The multibyte character handling on OSX appears to be particularly
sensitive to the LANG setting (see my previous mail to Wolfgang).
At the same time, OSX doesn't appear to export a LANG value (or at
least it doesn't on my iMac at work).

I can't precisely reproduce the above; I get things like

schaefer<263> touch x<00c3><00c3><00c3>x

or

schaefer<263> touch xinsert-composed-char:180: character not in range

before I ever get as far as creating the file.  Maybe there's some
additional character munging happening in transit of the email so
I'm not using the correct input.

However, I suggest checking your $LANG value and adjusting it if
necessary.  Tab-completion after LANG=3D works quite nicely.

Wolfgang, if you're reading this, something that I forgot to mention in
my reply to you is that sometime during 4.3.x zsh began to pay closer
attention to characters that are absent from the declared LANG character
set and to either refuse to process them at all, or to render them as
digits surrounded by angle brackets.  It no longer blindly passes those
characters around unprocessed, so things that "worked" before because
xterm dealt with the processing will now appear to "fail" because the
shell is trying harder to do the right thing internally.

