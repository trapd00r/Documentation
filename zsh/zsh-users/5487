From zsh-users-return-5487-mason-zsh=primenet.com.au@sunsite.dk Mon Nov 11 20:23:14 2002
Return-Path: <zsh-users-return-5487-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3876 invoked from network); 11 Nov 2002 20:23:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 11 Nov 2002 20:23:13 -0000
Received: (qmail 28754 invoked by alias); 11 Nov 2002 20:22:16 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 5487
Received: (qmail 28743 invoked from network); 11 Nov 2002 20:22:15 -0000
Date: Mon, 11 Nov 2002 13:21:27 -0700
From: Steve Talley <stephen.talley@sun.com>
To: Peter Stephenson <pws@csr.com>
Cc: Zsh users list <zsh-users@sunsite.dk>
Subject: Re: Vared with newlines between array elements
Message-ID: <20021111202127.GB8737@.central.sun.com>
References: <8483.1036753640@csr.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <8483.1036753640@csr.com>
User-Agent: Mutt/1.3.28i

Good tip.  I use:

# Use newlines to separate array elements in vared
alias vared='IFS="
" vared'

Steve

Peter Stephenson wrote:

> I just realised this trivial function is the answer to all my problems
> with editing path and similar array variables with vared --- it puts
> each element on a new line, so it's much easier to manipulate elements
> separately.
>
> To get filename completion to work properly, it should only require
> backslashes before newlines and not other whitespace, nor anything else.
> In other words, you get `/e/Program\ Files' from completion, but you
> need `/e/Program Files' because vared preserves the backslash.
> This could be fixed up if vared always stripped backslashes, which is
> more symmetric since it always doubles existing backslashes (i.e. if you
> had `/e/Program\ Files' to begin with it would have been quoted as
> `/e/Program\\ Files' for editing.  However, the function is buried
> inside the shell array splitting functions, so it's not entirely trivial
> to fix without knock-on effects.
>
> # Use vared with array elements joined by newlines.
> # This makes reordering or removal of elements much simpler.
> #
> # With this function whitespace other than newlines in array elements
> # should not be quoted by a backslash; this needs special completion
> # handling (not currently provided).
>
> local IFS='
> '
>
> vared "$@"
> # End

