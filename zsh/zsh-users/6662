From zsh-users-return-6662-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 08 02:29:28 2003
Return-Path: <zsh-users-return-6662-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22827 invoked from network); 8 Oct 2003 02:29:27 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 8 Oct 2003 02:29:27 -0000
Received: (qmail 26144 invoked by alias); 8 Oct 2003 02:29:12 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6662
Received: (qmail 26102 invoked from network); 8 Oct 2003 02:29:11 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 8 Oct 2003 02:29:11 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [170.148.93.21] by sunsite.dk (MessageWall 1.0.8) with SMTP; 8 Oct 2003 2:29:11 -0000
Received: from emanpe07.ny.jpmorgan.com (emanpe07.jpmorgan.com [10.21.212.207])
	by emanpe03.jpmorgan.com (8.9.1a/8.9.1) with ESMTP id WAA29527;
	Tue, 7 Oct 2003 22:22:51 -0400 (EDT)
Received: from taiyo.ja.jpmorgan.com (tkd-fires-02.ja.jpmorgan.com [169.16.62.170])
	by emanpe07.ny.jpmorgan.com (8.12.9/8.12.9) with ESMTP id h982Qli5023073;
	Tue, 7 Oct 2003 22:26:48 -0400 (EDT)
Received: from aheading by taiyo.ja.jpmorgan.com with local (Exim 4.22)
	id 1A744Z-0001c4-NS; Wed, 08 Oct 2003 11:29:07 +0900
Date: Wed, 8 Oct 2003 11:29:07 +0900
From: Anthony Heading <aheading@jpmorgan.com>
To: Bart Schaefer <schaefer@brasslantern.com>
Cc: zsh-users@sunsite.dk
Subject: Re: startup delay from compinit
Message-ID: <20031008022907.GB4263@tkd-fires-02.ja.jpmorgan.com>
References: <20031007105820.GA23911@tkd-fires-02.ja.jpmorgan.com> <1031007154001.ZM6620@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <1031007154001.ZM6620@candle.brasslantern.com>
User-Agent: Mutt/1.5.4i

On Tue, Oct 07, 2003 at 03:40:01PM +0000, Bart Schaefer wrote:
> That's rather odd.

Thanks. That was really the hint I needed. Turned out that I
broke everything last time I tried to get it working: I'd
tried to nudge compaudit to accept that files which we have
carefully installed with a special "application" group are
_not_ in fact insecure.  (Looks rather like there is a similar
existing hack for the 'staff' group triggered
by -f /etc/debian_version)

And I was trying to force that externally since I didn't
want to maintain a variant of compaudit in perpetuity,
since compaudit contains the directory scanning code.

But I evidently got it wrong - I'd returned OK from compaudit
without correctly having set _i_files, which meant the
function count was zero, which meant the compdump file
was rejected.

Thanks for the help - I'll have to mull how best to fix
this - turning off security measures (i.e. using -u here)
isn't normally appealing on principle, but when the checking
rules admit to being so arbitrary and system-conditional
they're clearly not always going to work.

Thanks

Anthony

PS. Small patch for conceptual anachronism.  (Young people
today blaa blaa, think they invented everything...)  It's
actually misleading, because it doesn't appear to apply
only to RedHat, yet there is code which is Debian specific
in the file.


--- Completion/compaudit.Orig   Wed Oct  8 11:12:15 2003
+++ Completion/compaudit        Wed Oct  8 11:14:07 2003
@@ -76,7 +76,7 @@
 
 [[ $_i_fail == use ]] && return 0
 
-# RedHat Linux "per-user groups" check.  This is tricky, because it's very
+# "Per-user groups" check.  This is tricky, because it's very
 # difficult to tell whether the sysadmin has put someone else into your
 # "private" group (e.g., via the default group field in /etc/passwd, or
 # by NFS group sharing with an untrustworthy machine).  So we must assume

This communication is for informational purposes only.  It is not intended as
an offer or solicitation for the purchase or sale of any financial instrument
or as an official confirmation of any transaction. All market prices, data
and other information are not warranted as to completeness or accuracy and
are subject to change without notice. Any comments or statements made herein
do not necessarily reflect those of J.P. Morgan Chase & Co., its
subsidiaries and affiliates.

