From zsh-workers-return-21883-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 19 13:40:45 2005
Return-Path: <zsh-workers-return-21883-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17632 invoked from network); 19 Oct 2005 13:40:42 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 19 Oct 2005 13:40:42 -0000
Received: (qmail 28389 invoked from network); 19 Oct 2005 13:40:36 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 19 Oct 2005 13:40:36 -0000
Received: (qmail 19260 invoked by alias); 19 Oct 2005 13:40:33 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21883
Received: (qmail 19135 invoked from network); 19 Oct 2005 13:38:50 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 19 Oct 2005 13:38:50 -0000
Received: (qmail 26964 invoked from network); 19 Oct 2005 13:38:50 -0000
Received: from zproxy.gmail.com (64.233.162.206)
  by a.mx.sunsite.dk with SMTP; 19 Oct 2005 13:38:48 -0000
Received: by zproxy.gmail.com with SMTP id i11so71487nzi
        for <zsh-workers@sunsite.dk>; Wed, 19 Oct 2005 06:38:46 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:cc:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=hhta+gvrB4IUaT3OGzECTK+2L16lC1l94i/WbcDRmZ9jmJt0MG3+pFMkKgYL+ECUIO10qLhRI87fpuosEWWNDkWxSB2wngIXgX34kutQSEN/X3olnTG54xwbuThRyLGczt+sP9HghTuo3vP8caNVssAmgfVSPc/JlzdeBR+luyI=
Received: by 10.36.86.5 with SMTP id j5mr633634nzb;
        Wed, 19 Oct 2005 06:38:46 -0700 (PDT)
Received: by 10.37.13.12 with HTTP; Wed, 19 Oct 2005 06:38:46 -0700 (PDT)
Message-ID: <19c433eb0510190638x398b105aid10aab9b94bb7e2e@mail.gmail.com>
Date: Wed, 19 Oct 2005 15:38:46 +0200
From: =?ISO-8859-1?Q?Fran=E7ois-Xavier_Coudert?= <fxcoudert@gmail.com>
To: zsh-workers@sunsite.dk
Subject: Bug with multibyte and completion
Cc: FX Coudert <fxcoudert@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-2022-JP
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,RCVD_BY_IP 
	autolearn=ham version=3.0.4

Hi,

Former user of zsh, I switched to bash for its ability to handle
multibyte. I regularly try zsh from CVS to keep track of the
progresses and switch back as soon as possible. I found very good
multibyte improvements (thanks for the good work!), and experienced
the following bug. I hope this can help, if this is already known,
please ignore me...

[all this in UTF-8 locale] In a directory containing two files,
foo.pdf and 文京区と目黒区.pdf (or any unicode with double-width characters
on my xterm), typing "ls" and asking for completion gives
successively:

pc31 /tmp/test $ ls foo.pdf
foo.pdf             文京区と目黒区.pdf

pc31 /tmp/test $ ls 文京区と目黒区.pdf
foo.pdf             文京区と目黒区.pdf

pc31 /tmp/test $ ls 文京区 foo.pdf
foo.pdf             文京区と目黒区.pdf

While the first two are OK, the third should be exactly like the
first. It looks like the wide-characters string is not erased
correctly. Pressing ^L at that point results in the redrawn screen
looking as it should.

Thanks,
FX

