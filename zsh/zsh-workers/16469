From zsh-workers-return-16469-mason-zsh=primenet.com.au@sunsite.dk Mon Jan 21 06:56:04 2002
Return-Path: <zsh-workers-return-16469-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18223 invoked from network); 21 Jan 2002 06:56:02 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 21 Jan 2002 06:56:02 -0000
Received: (qmail 13755 invoked by alias); 21 Jan 2002 06:55:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16469
Received: (qmail 13743 invoked from network); 21 Jan 2002 06:55:52 -0000
X-Face: &]X"G,bJ*!V1{yvL=l~V=`bF;JX4oQ?sDWkxp^`c{enH>~~?h*QzJ7o4):0vE\a,_'`]@~,
 F!92q:XmNKbn8nq'1=JM>qh5oxf3dzYab'<^9'kGH
X-Now-Playing: Eric Johnson's _Alien Love Child_: "Enzo Shuffle"
To: zsh-workers@sunsite.dk
Subject: Problem inputting Japanese using XIM
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
From: Daiki Ueno <ueno@unixuser.org>
Date: Mon, 21 Jan 2002 16:01:43 +0900
Message-ID: <b78fa9d0-c9c9-434a-8cd4-ca248c08bbd8@deisui.bug.org>
Lines: 30

Hello,

I'm wondering why zsh considers characters in the [0x80, 0xa0] range
as control characters?  Without the patch below, I couldn't input any
UTF-8 text via XIM.  For example, the series of characters 0xe3 0x81
0x82 corresponding the Japanese "a" are translated into the following
byte sequence in the typescript:

0xe3 0xe5(= ^) 0xc1(= 0x81 | '@') 0xe5 0xc2(= 0x82 | '@')

Index: utils.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/utils.c,v
retrieving revision 1.39
diff -u -F^( -r1.39 utils.c
--- utils.c	2002/01/06 01:07:23	1.39
+++ utils.c	2002/01/21 06:08:19
@@ -2160,7 +2160,7 @@
     for (t0 = 0; t0 != 256; t0++)
 	typtab[t0] = 0;
     for (t0 = 0; t0 != 32; t0++)
-	typtab[t0] = typtab[t0 + 128] = ICNTRL;
+	typtab[t0] = ICNTRL;
     typtab[127] = ICNTRL;
     for (t0 = '0'; t0 <= '9'; t0++)
 	typtab[t0] = IDIGIT | IALNUM | IWORD | IIDENT | IUSER;

Regards,
-- 
Daiki Ueno

