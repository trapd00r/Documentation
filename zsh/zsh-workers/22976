From zsh-workers-return-22976-mason-zsh=primenet.com.au@sunsite.dk Tue Nov 07 15:12:23 2006
Return-Path: <zsh-workers-return-22976-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28014 invoked from network); 7 Nov 2006 15:12:18 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Nov 2006 15:12:18 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 80968 invoked from network); 7 Nov 2006 15:12:12 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Nov 2006 15:12:12 -0000
Received: (qmail 4872 invoked by alias); 7 Nov 2006 15:12:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22976
Received: (qmail 4861 invoked from network); 7 Nov 2006 15:12:07 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Nov 2006 15:12:07 -0000
Received: (qmail 80615 invoked from network); 7 Nov 2006 15:12:07 -0000
Received: from wr-out-0506.google.com (64.233.184.229)
  by a.mx.sunsite.dk with SMTP; 7 Nov 2006 15:12:02 -0000
Received: by wr-out-0506.google.com with SMTP id i12so303274wra
        for <zsh-workers@sunsite.dk>; Tue, 07 Nov 2006 07:11:59 -0800 (PST)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:sender:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=kx3Hc7+I9jExCqePVCokvhQXh2j6SGTCzI4Dw3bqDywUnGcm2Yj3TPm390DPqdDT2pyxMtMFL1OloQEwWV+shbH3Oh/F53SA6etHKGV359JFnp9lIYukH3yuZom8oZFlwpSjChq3hS3Vk+pF+Er+S6JHosv+qb2RwV9GKW2waWs=
Received: by 10.90.119.15 with SMTP id r15mr1504386agc.1162912318883;
        Tue, 07 Nov 2006 07:11:58 -0800 (PST)
Received: by 10.90.65.18 with HTTP; Tue, 7 Nov 2006 07:11:58 -0800 (PST)
Message-ID: <dbfc82860611070711u322a6948m675ef9a38d097717@mail.gmail.com>
Date: Tue, 7 Nov 2006 16:11:58 +0100
From: "Nikolai Weibull" <now@bitwi.se>
Sender: nikolai.weibull@gmail.com
To: "Peter Stephenson" <pws@csr.com>
Subject: Re: Hooks
Cc: "Zsh hackers list" <zsh-workers@sunsite.dk>
In-Reply-To: <20061107104916.d01e2fa5.pws@csr.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <5db995410611060845y53f673e6je029a9c60659f116@mail.gmail.com>
	 <20061106174053.GA4323@sc>
	 <5db995410611061314l26e089b8wb214da46064c8235@mail.gmail.com>
	 <20061106215051.GB4323@sc>
	 <Pine.OSX.4.61.0611061617370.1112@vanunu.ucsc.edu>
	 <20061107081800.GA4420@sc> <20061107104916.d01e2fa5.pws@csr.com>
X-Google-Sender-Auth: 8f6027db97b87e6c

On 11/7/06, Peter Stephenson <pws@csr.com> wrote:
> Stephane Chazelas <Stephane_Chazelas@yahoo.fr> wrote:
> > functions[preexec]+='
> >   get_saved_dirstack'
> > functions[chpwd]+='
> >   save_dirstack'
>
> This is even further away from the original subject, but I've often felt
> that functions like preexec and chpwd are getting a bit overloaded and
> are unnecessarily hard to maintain automatically.  It would be easy to
> add an array which could contain names of functions to be executed,
> similar to Emacs hooks.  Of course you can implement such an array
> within the existing functions, but the advantage of having a fixed
> mechanism is that it's easy to add to and be sure it's working without
> getting in anyone else's way.  You still have namespace problems, of
> course, but if you have functions called get_saved_dirstack and
> save_dirstack that clash your real problem is almost certainly more
> basic than naming.
>
> However, I'm not sure if it's really needed.

Yes, please do add.  It's a real, em...lady of the night, to try to
chain all these functions properly (i.e., checking if preexec is
defined and then try to get its definition or however I did it when I
did it last time (I did this for a prompt that was depended on the
value of $WIDTH, so I read it on each preexec, but I also had another
function running at preexec, so I had to get that other functions body
and eval it from the prompt preexec instead.).

Thanks!

  nikolai

