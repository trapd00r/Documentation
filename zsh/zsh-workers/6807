From zsh-workers-return-6807-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jun 23 09:27:34 1999
Return-Path: <zsh-workers-return-6807-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12787 invoked from network); 23 Jun 1999 09:27:32 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 23 Jun 1999 09:27:32 -0000
Received: (qmail 449 invoked by alias); 23 Jun 1999 09:27:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6807
Received: (qmail 436 invoked from network); 23 Jun 1999 09:27:20 -0000
Date: Wed, 23 Jun 1999 11:27:17 +0200 (MET DST)
Message-Id: <199906230927.LAA06338@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Wed, 23 Jun 1999 13:14:34 +0400
Subject: Re: accept-and-menu-complete not working with menu-select


Andrej Borsenkow wrote:

> ESC-RETURN bound to accept-and-menu-complete
> 
> bor@itsrm2:~/tmp/abcd%> l<TAB>
> bor@itsrm2:~/tmp/abcd%> l <TAB>
> x   y   z     
> bor@itsrm2:~/tmp/abcd%> l x<ESC><RETURN> 
> x   y   z     
> ^ highlighted
> bor@itsrm2:~/tmp/abcd%> l x x
> x   y   z     
> ^ highlighted
> 
> This is with all current patches

You want it to go to the next match, right?

At one point in time this different behaviour was intentional, but now 
that menu-select behaves more like menu-complete, it should probably
be changed, yes.

Bye
 Sven

diff -u os/Zle/complist.c Src/Zle/complist.c
--- os/Zle/complist.c	Wed Jun 23 11:19:07 1999
+++ Src/Zle/complist.c	Wed Jun 23 11:19:52 1999
@@ -668,6 +668,9 @@
 	    s->cs = cs;
 	    memcpy(&(s->info), &minfo, sizeof(struct menuinfo));
 	    acceptlast();
+	    do_menucmp(0);
+	    mselect = (*(minfo.cur))->gnum;
+	    continue;
 	} else if (cmd == Th(z_undo)) {
 	    int l;
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

