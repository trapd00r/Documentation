From zsh-workers-return-13239-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Dec 05 17:01:08 2000
Return-Path: <zsh-workers-return-13239-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18184 invoked from network); 5 Dec 2000 17:01:06 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 5 Dec 2000 17:01:06 -0000
Received: (qmail 8121 invoked by alias); 5 Dec 2000 17:00:59 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13239
Received: (qmail 8113 invoked from network); 5 Dec 2000 17:00:57 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1001205170040.ZM1529@candle.brasslantern.com>
Date: Tue, 5 Dec 2000 17:00:40 +0000
In-Reply-To: <20001205162626.A9181@gmx.de>
Comments: In reply to Dominik Vogt <dominik.vogt@gmx.de>
        "bug in 'repeat' syntax (zsh-3.0.7)" (Dec  5,  4:26pm)
References: <20001205162626.A9181@gmx.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: dominik.vogt@gmx.de, zsh-workers@sunsite.auc.dk
Subject: Re: bug in 'repeat' syntax (zsh-3.0.7)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Dec 5,  4:26pm, Dominik Vogt wrote:
} Subject: bug in 'repeat' syntax (zsh-3.0.7)
}
} There is a minor bug in the parsing of the 'repeat' command in
} zsh-3.0.7.  The repeat count can be any token you like, as long
} as it starts with a digit.

That's happening because the word following the `repeat' keyword is
parsed as a zsh "string" token, meaning it can be a variable reference,
a command or process substitution, a glob, etc.  Most of those don't
make sense, of course, but a variable reference does.

Zsh then expands the string token and calls atoi() on the result.  One
side effect of atoi() is that it ignores trailing garbage after the
integer.  There are several places where this happens, e.g.

    kill -2foo $!

will send SIGINT to the most recent child process.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

