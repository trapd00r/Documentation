From zsh-users-return-3594-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 25 09:37:35 2001
Return-Path: <zsh-users-return-3594-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8427 invoked from network); 25 Jan 2001 09:37:33 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Jan 2001 09:37:33 -0000
Received: (qmail 11346 invoked by alias); 25 Jan 2001 09:37:24 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 3594
Received: (qmail 11334 invoked from network); 25 Jan 2001 09:37:24 -0000
Message-ID: <AFD7CFC52B58014B9C0BFAF32EAB48EF0177B0@PLUTO.forumone.com>
From: Joakim Ryden <jryden@forumone.com>
To: =?iso-8859-1?Q?=27Tarmo_J=E4rvi=27?= <tarmoj@iobox.com>, 
	zsh-users@sunsite.auc.dk
Subject: RE: process limit/su problem
Date: Thu, 25 Jan 2001 04:36:59 -0500
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2650.21)
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

su - root ?

Jo

-----Original Message-----
From: Tarmo J=E4rvi [mailto:tarmoj@iobox.com]
Sent: Thursday, January 25, 2001 4:33 AM
To: zsh-users@sunsite.auc.dk
Subject: process limit/su problem


Hello dear list,

I have following lines in /etc/zshenv to prevent fork-bombing etc by
ordinary users :

if [ `id -gn` =3D `id -un` -a `id -u` -gt 14 ]
then
        ulimit -H -u 64 -c 65536 -f 2097152 -n 128
else
        ulimit -u 2048 -c 65536 -f 4194394 -n 1024
fi

Everything works nicely except 'su root' (by few selected "power =
users").
Usually my server is running about 100 processes owned by root. When =
I'm
logged in as, for example, tarmoj and do 'su root',  I get following =
errors:

/etc/zshenv: fork failed: resource temporarily unavailable [33]

So, obviously, the process limit for user is limiting the execution of
/etc/zshenv etc and thus (as root after 'su' )I have to manually set  =
higher
process limit and set other variables.

So, my question is, is there any other way to prevent this (otherthan =
ssh
root@localhost)?

