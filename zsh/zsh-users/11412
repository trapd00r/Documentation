From zsh-users-return-11412-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 16 16:35:39 2007
Return-Path: <zsh-users-return-11412-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14189 invoked from network); 16 Apr 2007 16:35:37 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 Apr 2007 16:35:37 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 41158 invoked from network); 16 Apr 2007 16:35:32 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Apr 2007 16:35:32 -0000
Received: (qmail 28538 invoked by alias); 16 Apr 2007 16:35:16 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11412
Received: (qmail 28527 invoked from network); 16 Apr 2007 16:35:15 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 16 Apr 2007 16:35:15 -0000
Received: (qmail 39562 invoked from network); 16 Apr 2007 16:35:15 -0000
Received: from smtpout0154.sc1.he.tucows.com (HELO n064.sc1.he.tucows.com) (64.97.136.154)
  by a.mx.sunsite.dk with SMTP; 16 Apr 2007 16:35:12 -0000
Received: from sc.homeunix.net (82.26.169.154) by n064.sc1.he.tucows.com (7.2.069.1)
        id 45FC2AFB0021AA26 for zsh-users@sunsite.dk; Mon, 16 Apr 2007 16:35:10 +0000
Received: from chazelas by sc.homeunix.net with local (Exim 4.63)
	(envelope-from <stephane_chazelas@yahoo.fr>)
	id 1HdUAA-0004e4-Jh
	for zsh-users@sunsite.dk; Mon, 16 Apr 2007 17:34:46 +0100
Date: Mon, 16 Apr 2007 17:34:46 +0100
From: Stephane Chazelas <Stephane_Chazelas@yahoo.fr>
To: zsh-users@sunsite.dk
Subject: Re: pushing a string in the cut&paste stack
Message-ID: <20070416163446.GA16374@sc.homeunix.net>
Mail-Followup-To: zsh-users@sunsite.dk
References: <9fda5e550704160530p7e478483i4e8021a9e199ce23@mail.gmail.com> <20070416144411.GB20630@spiegl.de> <9fda5e550704160803o1a26edf2oad09587d5e8b9c87@mail.gmail.com> <20070416155007.GA29719@spiegl.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <20070416155007.GA29719@spiegl.de>
User-Agent: Mutt/1.5.6i

On Mon, Apr 16, 2007 at 05:50:07PM +0200, Andy Spiegl wrote:
> Hi Giulio,
> 
> > to put the output of a program in the shell killring, something like
> > 
> > myprogram | copythis
> 
> This example sounds more interesting.  Actually, this reminds me of a
> zsh-feature that I am missing sometimes: execute the command at the prompt
> and replace it with its result.  Something like this:
> 
>  condor:~>zcalc 170000. /7
>   [some magic key..]
>  condor:~>24285.714285714286
>   [ctrl-A zcalc ...]
>  condor:~>zcalc 24285.714285714286 % 7
>   [some magic key..]
>  condor:~>2
>   [and so on...]
> 
> Any ideas?
> That would make your copy_this superflous, too.  (c;
[...]

edit-command-output() {
  BUFFER=$(eval $BUFFER)
  CURSOR=0
}
zle -N edit-command-output
bindkey '\e!' edit-command-output

$ echo foo<Meta-!>
$ foo

Or maybe:

edit-command-output() {
  local output
  output=$(eval $BUFFER) || return
  BUFFER=$output
  CURSOR=0
}

-- 
Stéphane

