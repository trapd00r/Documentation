From zsh-workers-return-27820-mason-zsh=primenet.com.au@zsh.org Mon Mar 22 11:32:46 2010
Return-Path: <zsh-workers-return-27820-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 262 invoked by alias); 22 Mar 2010 11:32:46 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27820
Received: (qmail 9856 invoked from network); 22 Mar 2010 11:32:44 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-3.0 required=5.0 tests=AWL,BAYES_00,
	RCVD_IN_DNSWL_LOW,SPF_HELO_PASS autolearn=ham version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at csr.com does not designate permitted sender hosts)
Date: Mon, 22 Mar 2010 10:40:11 +0000
From: Peter Stephenson <pws@csr.com>
To: Zsh Workers <zsh-workers@zsh.org>
Subject: Re: [PATCH] _xargs: add many options
Message-ID: <20100322104011.3699c3df@news01>
In-Reply-To: <alpine.LNX.2.01.1003212329460.19615@hp.internal>
References: <alpine.LNX.2.01.1003212329460.19615@hp.internal>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 22 Mar 2010 10:40:12.0177 (UTC) FILETIME=[0CEB1010:01CAC9AC]
X-Scanned-By: MailControl A_09_30_00 (www.mailcontrol.com) on 10.71.0.122

On Sun, 21 Mar 2010 23:38:58 -0400 (EDT)
"Benjamin R. Haskell" <zsh@benizi.com> wrote:
> 1. I suspect a lot of these are GNU-specific.  Can someone point me to a 
> good example of the use of _variant (sp?) for another command that has 
> both GNU- and non-GNU completion?

They're scattered through Completion/Unix/Command.  None of them are
particularly canonical, but the form "_pick_variant gnu=GNU unix --version"
is fairly common.  Searching for some component of "Free Software
Foundation" in the --version or --help output is also common, however since
xargs --version gives something like

GNU xargs version 4.2.31
Built using GNU gnulib version 2007-02-24

and --help doesn't give anything very useful, I think you need something
like the first form.

The only thing to be wary of in _pick_variant is if "<cmd> --version" might
be interpreted as "rm -rf /" or something else nasty if --version isn't
understood.  That's not a worry for xargs.

> What's the expected difference in behavior between an optspec of:
> 
> -optname[explanation]::
> 
> vs.
> 
> -optname:message:
> 
> ?

This is in the manual: the former documents the option itself, the second
documents its argument.  If the option has an argument the second form
should be present since otherwise you get no information about the argument
(from _arguments, anyway, if the completion defined in the arguments to
_arguments descends to another fully implemented completer instead of
e.g. specifying an array of possible values you may get information from
down there).  There's a style auto-description to use the second form to
document the option itself (it's not really clear this is useful as an
end-user option rather than an _arguments option except for the not very
helpful reason that people writing completions would forget to use it).
There's nothing to stop both forms from being present.

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

