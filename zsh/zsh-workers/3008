From zsh-workers-request@euclid.skiles.gatech.edu Thu Mar 20 16:33:30 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 27130 invoked from network); 20 Mar 1997 16:33:28 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 20 Mar 1997 16:33:28 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id LAA08668; Thu, 20 Mar 1997 11:22:18 -0500 (EST)
Resent-Date: Thu, 20 Mar 1997 11:22:18 -0500 (EST)
Date: Thu, 20 Mar 1997 16:24:57 GMT
From: Zefram <zefram@dcs.warwick.ac.uk>
Message-Id: <299.199703201624@stone.dcs.warwick.ac.uk>
Subject: non-dynamic compilation
X-Patch: 214
Resent-Message-ID: <"k_92b3.0.K72.wGMCp"@euclid>
To: zsh-workers@math.gatech.edu
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3008
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

This patch makes compilation of non-dynamic zsh work even if the zle
module is not being statically linked in.  The correct conditionals
already exist in the main code, but some of the automatically generated
files don't look at DYNAMIC where they should.

 -zefram

 *** Src/Makefile.in	1997/03/19 15:47:00	1.36
 --- Src/Makefile.in	1997/03/20 13:48:54
 ***************
 *** 230,237 ****
   	    for mod in $$xmods; do \
   		case $$binmods in \
   		    *" $$mod "*) \
 ! 			echo "#define   LINKED_XMOD_$$mod 1" ;; \
 ! 		    *)  echo "#define UNLINKED_XMOD_$$mod 1" ;; \
   		esac; \
   	    done; \
   	    echo; \
 --- 230,239 ----
   	    for mod in $$xmods; do \
   		case $$binmods in \
   		    *" $$mod "*) \
 ! 			echo "#define    LINKED_XMOD_$$mod 1" ;; \
 ! 		    *)  echo "#ifdef DYNAMIC"; \
 ! 			echo "# define UNLINKED_XMOD_$$mod 1"; \
 ! 			echo "#endif" ;; \
   		esac; \
   	    done; \
   	    echo; \
 *** Src/mkbltnmlst.sh	1997/01/29 03:25:19	1.5
 --- Src/mkbltnmlst.sh	1997/03/20 13:41:28
 ***************
 *** 18,23 ****
 --- 18,24 ----
   xmods=`sed -n $CFSED -e "$sed" $XMODCF`
   trap "rm -f $1; exit 1" 1 2 15
   exec > $1
 + echo "#ifdef DYNAMIC"
   for mod in $xmods; do
       case $binmods in
   	*" $mod "*) ;;
 ***************
 *** 44,49 ****
 --- 45,51 ----
   	    done ;;
       esac
   done
 + echo "#endif /* DYNAMIC */"
   echo
   donemods=" "
   for mod in $binmods; do

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3ia
Charset: ascii

iQCVAwUBMzFCZXD/+HJTpU/hAQGbEQP/WeR5/3dAofPKIjA8xv8eHnwsXOeUzc7k
r5qrYzQNwAbck9K7LtaYA36UV86JveTwae7Kq9rAiXLyBaiVEmmKVE0/lr9AkbTk
5JIng5OPBRAkOSfmzdPQqHfANf1N49LvZDIeeCcX1p/RqEscOI2qHlIlpSQCU0c8
BXSgglfGRM8=
=Q3UH
-----END PGP SIGNATURE-----

