From zsh-workers-return-6326-mason-zsh=primenet.com.au@sunsite.auc.dk Fri May 21 13:18:59 1999
Return-Path: <zsh-workers-return-6326-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14668 invoked from network); 21 May 1999 13:18:56 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 21 May 1999 13:18:56 -0000
Received: (qmail 2889 invoked by alias); 21 May 1999 13:18:36 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6326
Received: (qmail 2882 invoked from network); 21 May 1999 13:18:35 -0000
Date: Fri, 21 May 1999 15:18:32 +0200 (MET DST)
Message-Id: <199905211318.PAA01688@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 19 May 1999 02:11:15 +0900
Subject: Re: compadd -f with IPREFIX.


Tanaka Akira wrote:

> In article <199905180954.LAA16898@beta.informatik.hu-berlin.de>,
>   Sven Wischnowsky <wischnow@informatik.hu-berlin.de> writes:
> > So the question to everyone is: should we change this to make -[rR]
> > work even on automatically added suffixes?
> 
> It's consistent and useful, I suppose.

Yes, maybe. And since this is only with explicitly given characters or 
functions to remove the suffix, it won't interfere with previous
behavior anyway.

Bye
 Sven

diff -u os/Zle/zle_tricky.c Src/Zle/zle_tricky.c
--- os/Zle/zle_tricky.c	Thu May 20 08:32:47 1999
+++ Src/Zle/zle_tricky.c	Fri May 21 15:13:30 1999
@@ -7112,9 +7112,13 @@
 		menuinsc++;
 		if (menuwe)
 		    menuend++;
-		if ((!menucmp || menuwe) && isset(AUTOREMOVESLASH)) {
-		    makesuffix(1);
-		    suffixlen['/'] = 1;
+		if (!menucmp || menuwe) {
+		    if (m->remf || m->rems)
+			makesuffixstr(m->remf, m->rems, 1);
+		    else if (isset(AUTOREMOVESLASH)) {
+			makesuffix(1);
+			suffixlen['/'] = 1;
+		    }
 		}
 	    }
 	}

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

