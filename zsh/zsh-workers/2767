From zsh-workers-request@euclid.skiles.gatech.edu Fri Jan 10 11:59:34 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 28607 invoked from network); 10 Jan 1997 11:59:32 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 10 Jan 1997 11:59:32 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id GAA06059; Fri, 10 Jan 1997 06:46:33 -0500 (EST)
Resent-Date: Fri, 10 Jan 1997 06:46:33 -0500 (EST)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199701101147.MAA02168@bolyai.cs.elte.hu>
Subject: Re: Lost Job Control (Again :(
In-Reply-To: <199701100454.XAA02582@people-eater.purple.org> from Andy Wick at "Jan 9, 97 11:54:14 pm"
To: awick@purple.org (Andy Wick)
Date: Fri, 10 Jan 1997 12:47:40 +0100 (MET)
Cc: zsh-workers@math.gatech.edu
Organization: Dept. of Comp. Sci., Eotvos University, Budapest, Hungary
Phone: (36 1)2669833 ext: 2667, home phone: (36 1) 2752368
X-Mailer: ELM [version 2.4ME+ PL27 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"xclSk1.0.cU1.OmYro"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2767
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Andy Wick wrote:
> I guess other people must actually use the jobs command instead of blindly 
> using %.  Call me % happy or something! :)
> 
> xclock &
> disown %
> %
> 
> zsh: can't set tty pgrp: invalid argument

This should fix that.

Zoltan


*** Src/builtin.c	1997/01/08 12:30:48	3.1.1.12
--- Src/builtin.c	1997/01/10 11:42:56
***************
*** 410,416 ****
  	scanjobs();
  
      /* Make sure we have a suitable previous job set. */
!     if (curjob != -1 && !(jobtab[curjob].stat & STAT_INUSE)) {
  	curjob = prevjob;
  	setprevjob();
  	if (curjob != -1 && !((jobtab[curjob].stat & STAT_INUSE) &&
--- 410,417 ----
  	scanjobs();
  
      /* Make sure we have a suitable previous job set. */
!     if (curjob == thisjob ||
! 	(curjob != -1 && !(jobtab[curjob].stat & STAT_INUSE))) {
  	curjob = prevjob;
  	setprevjob();
  	if (curjob != -1 && !((jobtab[curjob].stat & STAT_INUSE) &&

