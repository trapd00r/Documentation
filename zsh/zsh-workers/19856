From zsh-workers-return-19856-mason-zsh=primenet.com.au@sunsite.dk Fri Apr 30 15:40:32 2004
Return-Path: <zsh-workers-return-19856-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17238 invoked from network); 30 Apr 2004 15:40:30 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by ns1.primenet.com.au with SMTP; 30 Apr 2004 15:40:30 -0000
Received: (qmail 20094 invoked from network); 30 Apr 2004 15:40:12 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 30 Apr 2004 15:40:12 -0000
Received: (qmail 14513 invoked by alias); 30 Apr 2004 15:40:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19856
Received: (qmail 14498 invoked from network); 30 Apr 2004 15:40:10 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 30 Apr 2004 15:40:06 -0000
Received: (qmail 19912 invoked from network); 30 Apr 2004 15:40:06 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 30 Apr 2004 15:40:04 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 89F3570047; Fri, 30 Apr 2004 11:39:37 -0400 (EDT)
Date: Fri, 30 Apr 2004 11:39:37 -0400
From: Clint Adams <clint@zsh.org>
To: Oliver Kiddle <okiddle@yahoo.co.uk>,
	246305-submitter@bugs.debian.org
Cc: zsh-workers@sunsite.dk
Subject: Re: Bug#246305: zsh: completion for sudo doesn't add commands under root's path
Message-ID: <20040430153937.GA4644@scowler.net>
References: <877jw0gzp3.wl@broken.int.wedontsleep.org> <20040428130449.GA3198@scowler.net> <1040428160206.ZM29342@candle.brasslantern.com> <20040430122712.GA2985@scowler.net> <17443.1083331282@trentino.logica.co.uk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <17443.1083331282@trentino.logica.co.uk>
User-Agent: Mutt/1.5.5.1+cvs20040105i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

> That wouldn't work on my system here. It looks like there is a
> "SECURE_PATH" compile option to sudo which needs to be enabled before it
> uses a different path:
> 
> % PATH=/usr/bin sudo printenv PATH
> /usr/bin

So probably the only reasonable thing to do is to default to current
PATH and I can put the appropriate overriding zstyle in the global zshrc
of the Debian package, or at least a note about it.

> Out of interest, is there any way to run a process detached from the tty?
> (the above sometimes prompts for a password.)

Does
sudo setsid sleep 600
do what you mean?

> If you use a style, give it a generic sounding name then. Perhaps it
> could be looked up from _command_names instead of _sudo. Keep in mind
> that people might want to do things like add to the existing path or
> remove `.'.

So... it should be eval'd?

