From Hrvoje.Niksic@public.srce.hr Tue May  7 10:26:08 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id KAA02254 for <mason@werple.mira.net.au>; Tue, 7 May 1996 10:26:01 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id UAA01517; Mon, 6 May 1996 20:15:53 -0400 (EDT)
Resent-Date: Mon, 6 May 1996 20:15:53 -0400 (EDT)
From: Hrvoje.Niksic@public.srce.hr (Hrvoje Niksic)
Message-Id: <199605062254.AAA09143@jagor.srce.hr>
Subject: Compilation on Ultrix cc
To: zsh-workers@math.gatech.edu (zsh)
Date: Tue, 7 May 1996 00:54:40 +0200 (MET DST)
Reply-To: hniksic@public.srce.hr
X-Mailer: ELM [version 2.4ME+ PL16 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"qwrAr3.0.dN.uOfZn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/985
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1333
Status: O

I had problems compiling zsh on Ultrix 4.2 with cc.

1. configure determined that the compiler is non-ANSI, which is true enough,
but ansi2knr is still unnecessary since all it does is converting the
function declarations to ANSI-style, and the cc can handle them.

2. In several places the name of a variable is the same as the name of a cpp
macro. The newer cpp-s ignore the variable, whereas the Ultrix cpp gives a
warning, but still makes the substitution with an empty argument. This
prevents the compilation of builtin.c (because of iword macro/variables) and
zle_tricky.c (because of nonempty macro/variables). The solution is to
rename either the macro or the variables in both cases. Note that
zle_tricky.c uses both forms of nonempty.

3. glob.c contains the things that make Ultrix compiler happy wrapped within
#ifdef ULTRIX. However, the Ultrix cc defines only ultrix (lower-case),
which is why a %s/ULTRIX/ultrix is welcome in glob.c. Without it, glob.c
will not compile.

These things done, the shell compiles and works well.

-- 
hniksic@srce.hr              |  Student of electrical engineering
hniksic@fly.cc.fer.hr        |  University of Zagreb, Croatia
------------------------------------------------------------------
`VI' - An editor used by those heretics that don't subscribe to
       the Emacs religion.


