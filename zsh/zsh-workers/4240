From zsh-workers-request@math.gatech.edu Fri Jul 17 14:34:13 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4862 invoked from network); 17 Jul 1998 14:34:11 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 17 Jul 1998 14:34:11 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id KAA19677;
	Fri, 17 Jul 1998 10:27:38 -0400 (EDT)
Resent-Date: Fri, 17 Jul 1998 10:27:38 -0400 (EDT)
Sender: domivogt@hp.com
Message-Id: <35AF5FB5.25F5@hp.com>
Date: Fri, 17 Jul 1998 16:29:26 +0200
From: Dominik Vogt <dominik_vogt@hp.com>
X-Mailer: Mozilla 3.0 (X11; I; HP-UX B.10.20 9000/712)
Mime-Version: 1.0
To: zefram@tao.co.uk
Cc: zsh-workers@math.gatech.edu
Subject: Re: bug with chpwd/allexport
References: <H0000bb106ef5312@MHS>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"qxQUx.0.Op4.Pzrhr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4240
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> >                        BTW if the second workaround you suggest works,
> >then it is a bug. The manpage states clearly, that a local variable is
> >still exported if the ALLEXPORT option is set and the variable was
> >prviously unset.
> 
> But with `local', the variable disappears at the end of the function,
> and so can't affect the display of the prompt.  Try adding "print -P '%~'"
> in different parts of the function to see where the variable takes effect.

OK, you're right, you can read the manpage this way, but it's just
implicitly in the description and not stated clearly. And I do not
understand why the ALLEXPORT option is handled differently in shell
functions if the auto-exported variables are not visible in the calling
environment anyway. I think it just creates confusion about which
variables are exported to subshells of the function and which are not?
Or what is the reason for this?

Bye

Dominik
-- 
------------------------------------------------------------------------
Dominik Vogt                                 phone:        07031/14-4596
Hewlett-Packard GmbH                           fax:        07031/14-3883
Boeblingen Verification Solutions                                       
Herrenberger Str. 130
71034 Boeblingen                             email:  dominik_vogt@hp.com
------------------------------------------------------------------------

