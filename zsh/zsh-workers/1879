From zsh-workers-request@euclid.skiles.gatech.edu  Fri Aug  2 03:47:48 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id DAA01574 for <mason@primenet.com.au>; Fri, 2 Aug 1996 03:47:45 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id NAA10799; Thu, 1 Aug 1996 13:42:13 -0400 (EDT)
Resent-Date: Thu, 1 Aug 1996 13:42:13 -0400 (EDT)
Message-Id: <199608011740.TAA03299@hydra.ifh.de>
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: More Configure problems 
In-reply-to: "pws@ifh.de"'s message of "Thu, 01 Aug 1996 18:27:40 MET."
	                  <199608011627.SAA11721@hydra.ifh.de> 
Date: Thu, 01 Aug 1996 19:40:59 +0200
From: Peter Stephenson <pws@ifh.de>
Resent-Message-ID: <"5tq9Q2.0.fe2.qnE0o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1879
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

I wrote:
> Next problem with Configure... actually with the makedepend script
> that comes with it:  this assignment is failing:
> 
>     defrule=`<$mf sed -n		\
> ...
> 
> That first interestingly positioned <$mf (sometimes I wonder if people
> do this deliberately) is supposed to be a redirection, but zsh is
> treating it like $(<...).  ksh behaves like sh here, i.e. only $(<...)
> has that behaviour.  Perhaps we should follow suit.

Well, there's only about one possible fix, as follows.  The manual
page mentions $(<...) and specifically fails to mention `<...`, so I
think we're in line with that after the patch.  No other Configure
problems that I've noticed.  (This is actually non-trivial, if you
want to install perl on Linux without having to have bash around.)

*** Src/exec.c.go	Thu Aug  1 19:14:53 1996
--- Src/exec.c	Thu Aug  1 19:19:00 1996
***************
*** 1986,1998 ****
  
  /**/
  LinkList
! getoutput(char *cmd, int qt)
  {
      List list;
      int pipes[2];
      pid_t pid;
  
!     if (*cmd == '<') {
  	int stream, l;
  	char *fi, *s;
  
--- 1986,1998 ----
  
  /**/
  LinkList
! getoutput(char *cmd, int qt, int stringpar)
  {
      List list;
      int pipes[2];
      pid_t pid;
  
!     if (*cmd == '<' && stringpar) {
  	int stream, l;
  	char *fi, *s;
  
*** Src/subst.c.go	Thu Aug  1 19:14:58 1996
--- Src/subst.c	Thu Aug  1 19:22:25 1996
***************
*** 92,105 ****
  LinkNode
  stringsubst(LinkList list, LinkNode node, int ssub)
  {
!     int qt;
      char *str3 = (char *)getdata(node);
      char *str  = str3;
  
      while (!errflag && *str) {
  	if ((qt = *str == Qstring) || *str == String)
  	    if (str[1] == Inpar) {
  		str++;
  		goto comsub;
  	    } else if (str[1] == Inbrack) {
  		/* $[...] */
--- 92,107 ----
  LinkNode
  stringsubst(LinkList list, LinkNode node, int ssub)
  {
!     int qt, stringpar;
      char *str3 = (char *)getdata(node);
      char *str  = str3;
  
      while (!errflag && *str) {
+ 	stringpar = 0;
  	if ((qt = *str == Qstring) || *str == String)
  	    if (str[1] == Inpar) {
  		str++;
+ 		stringpar = 1;
  		goto comsub;
  	    } else if (str[1] == Inbrack) {
  		/* $[...] */
***************
*** 161,167 ****
  		       (qt && str[1] == '"'))))
  		    *str = ztokens[*str - Pound];
  	    str++;
! 	    if (!(pl = getoutput(str2 + 1, qt || ssub))) {
  		zerr("parse error in command substitution", NULL, 0);
  		return NULL;
  	    }
--- 163,169 ----
  		       (qt && str[1] == '"'))))
  		    *str = ztokens[*str - Pound];
  	    str++;
! 	    if (!(pl = getoutput(str2 + 1, qt || ssub, stringpar))) {
  		zerr("parse error in command substitution", NULL, 0);
  		return NULL;
  	    }

-- 
Peter Stephenson <pws@ifh.de>       Tel: +49 33762 77366
WWW:  http://www.ifh.de/~pws/       Fax: +49 33762 77330
Deutches Electronen-Synchrotron --- Institut fuer Hochenergiephysik Zeuthen
DESY-IfH, 15735 Zeuthen, Germany.

