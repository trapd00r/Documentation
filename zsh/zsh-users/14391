From zsh-users-return-14391-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 16 03:32:36 2009
Return-Path: <zsh-users-return-14391-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16487 invoked from network); 16 Sep 2009 03:32:34 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 16 Sep 2009 03:32:34 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 5109 invoked from network); 16 Sep 2009 03:32:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Sep 2009 03:32:17 -0000
Received: (qmail 15783 invoked by alias); 16 Sep 2009 03:31:49 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14391
Received: (qmail 15738 invoked from network); 16 Sep 2009 03:31:48 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 16 Sep 2009 03:31:48 -0000
Received: from vms173005pub.verizon.net (vms173005pub.verizon.net [206.46.173.5])
	by bifrost.dotsrc.org (Postfix) with ESMTP id EB9158026E39
	for <zsh-users@sunsite.dk>; Wed, 16 Sep 2009 05:31:41 +0200 (CEST)
Received: from torch.brasslantern.com ([96.238.222.107])
 by vms173005.mailsrvcs.net
 (Sun Java(tm) System Messaging Server 6.3-7.04 (built Sep 26 2008; 32bit))
 with ESMTPA id <0KQ100BB1OG3A5AW@vms173005.mailsrvcs.net> for
 zsh-users@sunsite.dk; Tue, 15 Sep 2009 22:31:21 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n8G3VEqT003080	for
 <zsh-users@sunsite.dk>; Tue, 15 Sep 2009 20:31:15 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n8G3VEBp003079	for zsh-users@sunsite.dk; Tue,
 15 Sep 2009 20:31:14 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <090915203114.ZM3078@torch.brasslantern.com>
Date: Tue, 15 Sep 2009 20:31:14 -0700
In-reply-to: <20090915101929.GS949@intoxicatedmind.net>
Comments: In reply to Frank Blendinger <fb@intoxicatedmind.net>
 "Get the current command line from a function" (Sep 15, 12:19pm)
References: <20090915101929.GS949@intoxicatedmind.net>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: zsh-users@sunsite.dk
Subject: Re: Get the current command line from a function
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii
X-Virus-Scanned: ClamAV 0.94.2/9808/Tue Sep 15 17:47:58 2009 on bifrost
X-Virus-Status: Clean

On Sep 15, 12:19pm, Frank Blendinger wrote:
}
} I would like to get the entered command line from a function, just like
} !!, but at an earlier time. An example:
} 
}     foo -x -y | my-func -z
} 
} I'd like to get the whole line within my-func, so obviously $0 $* don't
} work. Is there a way to do that?

So what you mean is that you want "my-func" to be able to access the
string "foo -x -y | my-func -z" ?  Or you mean something else, such
as the contents of the current line of the function body?

If the former, then in an interactive shell only (so history is active)
you can do

    zmodload zsh/parameter

and then refer to

    $history[$HISTCMD]

to get the currently-executing history event.  In the general case,
though (e.g., in a shell script) it is not possible to do that.

