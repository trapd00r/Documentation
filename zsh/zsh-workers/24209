From zsh-workers-return-24209-mason-zsh=primenet.com.au@sunsite.dk Tue Dec 11 13:54:31 2007
Return-Path: <zsh-workers-return-24209-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18379 invoked from network); 11 Dec 2007 13:54:23 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Dec 2007 13:54:23 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 31753 invoked from network); 11 Dec 2007 13:54:16 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Dec 2007 13:54:16 -0000
Received: (qmail 5635 invoked by alias); 11 Dec 2007 13:54:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24209
Received: (qmail 5613 invoked from network); 11 Dec 2007 13:54:13 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 11 Dec 2007 13:54:13 -0000
Received: from virusfilter.dotsrc.org (bifrost [127.0.0.1])
	by spamfilter.dotsrc.org (Postfix) with ESMTP id 392048058F3B
	for <zsh-workers@sunsite.dk>; Tue, 11 Dec 2007 14:51:41 +0100 (CET)
Received: from prunille.vinc17.org (vinc17.pck.nerim.net [213.41.242.187])
	by bifrost.dotsrc.org (Postfix) with ESMTP
	for <zsh-workers@sunsite.dk>; Tue, 11 Dec 2007 14:51:41 +0100 (CET)
Received: by prunille.vinc17.org (Postfix, from userid 501)
	id 492F81C634E5; Tue, 11 Dec 2007 14:54:12 +0100 (CET)
Date: Tue, 11 Dec 2007 14:54:12 +0100
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-workers@sunsite.dk
Subject: Shared history and locales (charmap)
Message-ID: <20071211135412.GB7651@prunille.vinc17.org>
Mail-Followup-To: zsh-workers@sunsite.dk
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
X-Mailer-Info: http://www.vinc17.org/mutt/
User-Agent: Mutt/1.5.17-vl-r19795 (2007-12-08)
X-Virus-Scanned: ClamAV using ClamSMTP

Another problem: When using different locales (e.g. ISO-8859-1 and
UTF-8) and a shared history, zsh isn't able to correctly retrieve
the command, as locale information isn't stored in the history file.

IMHO, there should be an option so that the history is stored and
retrieved in UTF-8. And if for some reason, zsh finds an invalid
UTF-8 sequence in the history, it should use the current charmap
as a fallback. In practice, this would allow zsh to continue to
work with old history files.

-- 
Vincent Lefèvre <vincent@vinc17.org> - Web: <http://www.vinc17.org/>
100% accessible validated (X)HTML - Blog: <http://www.vinc17.org/blog/>
Work: CR INRIA - computer arithmetic / Arenaire project (LIP, ENS-Lyon)

