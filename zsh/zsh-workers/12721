From zsh-workers-return-12721-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Sep 02 04:47:20 2000
Return-Path: <zsh-workers-return-12721-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11752 invoked from network); 2 Sep 2000 04:47:15 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 Sep 2000 04:47:15 -0000
Received: (qmail 22437 invoked by alias); 2 Sep 2000 04:46:47 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12721
Received: (qmail 22429 invoked from network); 2 Sep 2000 04:46:45 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000902044638.ZM20336@candle.brasslantern.com>
Date: Sat, 2 Sep 2000 04:46:38 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: allopts
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

This function was added in 3.1.5-pws-8 after one of the longest discussion
threads in zsh-users history.  And I just now noticed that Peter broke it
by adding that "emulate" command, which resets some of the options that the
function is supposed to report!

There are also a couple of unnecessary semicolons and a completely useless
use of &&, which have been there since the zsh-users posted version.

Index: Functions/Misc/allopt
===================================================================
@@ -8,17 +8,16 @@
 # Written by Sweth Chandramouli with hacks by Bart Schaefer.
 
 listalloptions () {
-   emulate -R zsh
    builtin setopt localoptions kshoptionprint
    local OPT_NAME OPT_PAIR OPT_VALUE
    for OPT_PAIR in "${(f)$(builtin setopt)}" ; do
       OPT_VALUE=${OPT_PAIR##* }
       OPT_NAME=${OPT_PAIR%% *}
       if [[ ${OPT_NAME#no} != ${OPT_NAME} ]] ; then
-         OPT_VALUE=${(L)${${OPT_VALUE:s/on/OFF}:s/off/on}} &&
-            OPT_NAME=${OPT_NAME#no};
-      fi;
-      echo ${(r:21:)OPT_NAME} ${OPT_VALUE}
+	 OPT_VALUE=${(L)${${OPT_VALUE:s/on/OFF}:s/off/on}}
+	 OPT_NAME=${OPT_NAME#no}
+      fi
+      echo "${(r:21:)OPT_NAME} ${OPT_VALUE}"
    done
 }
 

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

