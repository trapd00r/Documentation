From zsh-workers-return-6436-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jun 02 09:55:56 1999
Return-Path: <zsh-workers-return-6436-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9571 invoked from network); 2 Jun 1999 09:55:54 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 Jun 1999 09:55:54 -0000
Received: (qmail 17735 invoked by alias); 2 Jun 1999 09:55:23 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6436
Received: (qmail 17726 invoked from network); 2 Jun 1999 09:55:22 -0000
Message-Id: <199906020955.CAA04266@bebop.clari.net>
To: "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>
Subject: PATCH: 3.0.6-pre-3: mainly history bug fixes
Date: Wed, 02 Jun 1999 02:55:20 -0700
From: Wayne Davison <wayne@clari.net>

I believe I've managed to distill most of the bug fixes that were
included in my previous history changes into a separate patch for
3.0.6.  I haven't had much of a chance to test this yet, but since
most of this is lifted from my previous changes, it should be OK.

Most of these changes were originally lifted from the 3.1.x source.
Some of the more trivial changes are included just to make it easier
to compare the 3.1.x source to the 3.0.x source with more manageable
diffs (e.g. when an int variable turned into a thingy in 3.1.x, I
went ahead and moved the int variable onto its own line in the 3.0.x
source in order to make the rest of the declarations match up).

One non-bugfix that is included here is the change I made to the
EXTENDED_HISTORY output format where it writes the finish time in
elapsed seconds instead of epoch seconds -- I figured if this is
going to change in 3.1.x, we might as well get it going in 3.0.6 too.
Unfortunately I don't seem to have lifted the documentation change
for this yet, so I'll send a patch for that later.

..wayne..

---8<------8<------8<------8<---cut here--->8------>8------>8------>8---
begin 644 zsh-3.0.6-pre-3.patch.gz
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
A%UY KY:^?'O^!J?&]O?W&;[W[4?Z);CY_]>^=$]/7   
 
end
---8<------8<------8<------8<---cut here--->8------>8------>8------>8---

