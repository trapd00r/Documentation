From zsh-workers-return-6283-mason-zsh=primenet.com.au@sunsite.auc.dk Fri May 14 11:17:31 1999
Return-Path: <zsh-workers-return-6283-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29256 invoked from network); 14 May 1999 11:17:26 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 14 May 1999 11:17:26 -0000
Received: (qmail 4135 invoked by alias); 14 May 1999 11:17:17 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6283
Received: (qmail 4128 invoked from network); 14 May 1999 11:17:17 -0000
Date: Fri, 14 May 1999 13:17:15 +0200 (MET DST)
Message-Id: <199905141117.NAA06033@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Fri, 14 May 1999 13:31:45 +0400
Subject: Re: 3.1.5-pws-17: completion filenames with blanks problem


Andrej Borsenkow wrote:

> blanks are not quoted. Builtin completion is O.K.

This affected all `compadd -U's.

Bye
 Sven

diff -u oos/Zle/zle_tricky.c Src/Zle/zle_tricky.c
--- oos/Zle/zle_tricky.c	Sat May  8 14:31:49 1999
+++ Src/Zle/zle_tricky.c	Fri May 14 13:13:45 1999
@@ -3723,7 +3723,8 @@
 		    }
 		}
 		if (!(dat->aflags & CAF_MATCH)) {
-		    ms = dupstring(s);
+		    ms = ((dat->aflags & CAF_QUOTE) ? dupstring(s) :
+			  quotename(s, NULL));
 		    lc = bld_parts(ms, sl, -1, NULL);
 		    isexact = 0;
 		} else if (!(ms = comp_match(lpre, lsuf, s, cp, &lc,

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

