From zsh-workers-return-5509-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Feb 24 14:05:04 1999
Return-Path: <zsh-workers-return-5509-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19948 invoked from network); 24 Feb 1999 14:04:57 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Feb 1999 14:04:57 -0000
Received: (qmail 6681 invoked by alias); 24 Feb 1999 14:04:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5509
Received: (qmail 6667 invoked from network); 24 Feb 1999 14:04:31 -0000
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>
Subject: new completion and dynamic loading weirdness
Date: Wed, 24 Feb 1999 17:03:52 +0300
Message-ID: <004801be5ffe$821c7eb0$21c9ca95@mowp.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="Windows-1252"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook 8.5, Build 4.71.2377.0
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.0810.800
Importance: Normal

I have been using dynamic modules on ReliantUNIX for quite a bit without any
problems. Suddenly, whent trying to test new competion, I got absolutely
weird behaviour:

bor@itsrm2:/tools/src/zsh-3.1.5-pws-9/Functions/Completion%> zsh -f
itsrm2% setopt extendedglob
itsrm2% fpath=( $PWD )
itsrm2% source init
itsrm2% cd <TAB>zsh: illegal hardware instruction (core dumped)  zsh -f
bor@itsrm2:/tools/src/zsh-3.1.5-pws-9/Functions/Completion%> dbx =zsh
dbx V2.4A00 SINIX (Oct 12 1998)
Copyright (C) Siemens AG 1998
Base:   BSD, Copyright (C) The Regents of the University of California
All rights reserved
No Key Diskette found: running as `dbx-lite'.
reading symbolic information ...
warning: debuggee has no source information
64bit dbx - 64bit program
warning: libg.a is missing
Type 'help' for help
(dbx64) where
_r_debug_state() at 0x802d380
_rtld() at 0x802ed04
_rt_setup() at 0x80316b0
_rt_boot() at 0x80282ac
(dbx64)

It happens on both 5.43 and 5.44 in 32 or 64 bit mode.The error differs (bus
error, seg fault etc). Statically linked zsh is fine.

The stack is of no use. It suggests, that zsh tries to run startup code
(_rt_boot & co are part of /usr/lib/libc.so.1) - but why? And what has it to
do with new completion?

/andrej

