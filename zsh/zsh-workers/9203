From zsh-workers-return-9203-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jan 04 15:57:11 2000
Return-Path: <zsh-workers-return-9203-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15281 invoked from network); 4 Jan 2000 15:57:10 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 4 Jan 2000 15:57:10 -0000
Received: (qmail 18917 invoked by alias); 4 Jan 2000 15:57:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9203
Received: (qmail 18910 invoked from network); 4 Jan 2000 15:57:03 -0000
Date: Tue, 4 Jan 2000 10:55:36 -0500
From: Clint Adams <schizo@debian.org>
To: jarausch@igpm.rwth-aachen.de
Cc: zsh-workers@sunsite.auc.dk
Subject: PATCH: struct heap 64-bit
Message-ID: <20000104105536.A8967@dman.com>
References: <200001031011.LAA11708@numa1.igpm.rwth-aachen.de> <200001031201.NAA18846@numa1.igpm.rwth-aachen.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0i
In-Reply-To: <200001031201.NAA18846@numa1.igpm.rwth-aachen.de>; from jarausch@igpm.rwth-aachen.de on Mon, Jan 03, 2000 at 01:01:13PM +0100

> What's the intent?

Helmut fixed this in 9186 but the patch was reversed.

This just gets rid of the overcompensation altogether.
Incidentally, this solves the bus error problem I was
experiencing on 64-bit SPARC Linux.

Index: Src/zsh.h
===================================================================
RCS file: /cvs/zsh/zsh/Src/zsh.h,v
retrieving revision 1.1.1.39
diff -u -r1.1.1.39 zsh.h
--- Src/zsh.h	1999/12/17 12:18:28	1.1.1.39
+++ Src/zsh.h	2000/01/04 15:51:39
@@ -1559,9 +1559,6 @@
     size_t size;		/* size of heap                              */
     size_t used;		/* bytes used from the heap                  */
     struct heapstack *sp;	/* used by pushheap() to save the value used */
-#ifdef PAD_64_BIT
-    size_t dummy;		/* Make sure sizeof(heap) is a multiple of 8 */
-#endif
 #define arena(X)	((char *) (X) + sizeof(struct heap))
 };
 

