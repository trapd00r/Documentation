From zsh-workers-request@euclid.skiles.gatech.edu Tue Apr 01 00:18:06 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 22118 invoked from network); 1 Apr 1997 00:18:02 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 1 Apr 1997 00:18:02 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id TAA11123; Mon, 31 Mar 1997 19:07:54 -0500 (EST)
Resent-Date: Mon, 31 Mar 1997 19:07:54 -0500 (EST)
Date: Tue, 1 Apr 1997 01:10:46 +0100 (BST)
From: Zefram <zefram@dcs.warwick.ac.uk>
Message-Id: <17854.199704010010@stone.dcs.warwick.ac.uk>
Subject: hash builtin improvements
X-Patch: 247
Resent-Message-ID: <"WRjih1.0.kj2.P75Gp"@euclid>
To: zsh-workers@math.gatech.edu
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3061
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

There is a big hole in restricted mode near ``hash sh=/bin/sh; sh''.
This patch restricts that usage of hash.  It also fixes a couple of minor
bugs: ``hash -m foo=bar'' would ignore the -m, and ``hash -d foo'' would
attempt to hash foo both as a directory and a command.  Finally, ash's -v
option to hash is added; this lists hashtable entries as they are added.

 -zefram

begin 644 hash_patch.gz
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
=\&E-X=HDJ2G<OY/DX209__]GR7\!9KHI.-XG````
`
end

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3ia
Charset: ascii

iQCVAwUBMz/7fXD/+HJTpU/hAQH3dgQArW7AN2uq03VuUR0isrsqnry1bSxAxP4n
0jfTnFY4ppkYdHFegF8tAUsxBgvKKEGdgzgVbAYsEWqBLrP8EcKtbX8939IJWWmX
jDkJTozS0Ce63+FWS3JFUsMIJinrtYuyJwHYfatQh48k+DKr3+FSFi2crMFx2C72
WcKk3gKP3jA=
=0OMK
-----END PGP SIGNATURE-----

