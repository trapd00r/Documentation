From zsh-workers-request@euclid.skiles.gatech.edu Mon Dec 30 22:38:20 1996
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 996 invoked from network); 30 Dec 1996 22:38:12 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 30 Dec 1996 22:38:12 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id RAA29168; Mon, 30 Dec 1996 17:39:14 -0500 (EST)
Resent-Date: Mon, 30 Dec 1996 17:39:14 -0500 (EST)
Date: Mon, 30 Dec 1996 23:46:09 +0100
Message-Id: <199612302246.XAA12157@sartre.xss.co.at>
From: Andreas Haumer <andreas@xss.co.at>
To: zsh-workers@math.gatech.edu
Cc: andreas@xss.co.at
Subject: Bug in zsh-3.0.2
Resent-Message-ID: <"gPeJF1.0.h77.II4oo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2677
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hi!

I have installed zsh-3.0.2 as replacement for /bin/sh (i.e. /bin/sh is a
symbolic link to zsh) and now I get a segmentation fault when executing 
the configure-script from the GNU fileutils-3.14 package. It crashes
at the end of the script, just before creating the result files:

Output of configure:
[...]
checking for gettext in libintl... no
checking whether catgets can be used... no
checking for msgfmt... /usr/bin/msgfmt
checking for gmsgfmt... /usr/bin/msgfmt
checking for xgettext... /usr/bin/xgettext
checking for catalogs to be installed...  de es fr nl pl pt sl sv
zsh: segmentation fault (core dumped)  ./configure --prefix=/usr


Here's the output of gdb after loading the core file:

(gdb) core /usr/src/fileutils-3.14/core
warning: core file may not match specified executable file.
Core was generated by `sh ./configure --prefix=/usr'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /lib/libtermcap.so.2.0.8...done.
Reading symbols from /lib/libc.so.5.4.17...done.
Reading symbols from /lib/ld-linux.so.1...done.
#0  0x80686d6 in parsecomp () at glob.c:2071
(gdb) l
2066		    *s++ = *pptr++;
2067		}
2068	    }
2069	    /* mark if last pattern component in path component or pattern */
2070	    if (*pptr == '/' || !*pptr)
2071		c->stat |= C_LAST;
2072	    *s++ = '\0';
2073	    c->str = dupstring(cstr);
2074	    return c;
2075	}
(gdb)

This segmentation fault does _not_ occur when I change the magic line
in the configure script from "#! /bin/sh" to "#! /bin/sh -f" !

This the output from the reporter-script:
# START zsh saveset
# uname:  Linux sartre 2.0.27 #5 Thu Dec 19 18:58:54 MET 1996 i586

# Aliases.

alias run-help=man
alias which-command=whence

# Key bindings.

bindkey -r "^@"
bindkey -r "^A"
bindkey -r "^B"
bindkey -r "^C"
bindkey -r "^D"
bindkey -r "^E"
bindkey -r "^F"
bindkey -r "^G"
bindkey -r "^H"
bindkey -r "^I"
bindkey -r "^J"
bindkey -r "^K"
bindkey -r "^L"
bindkey -r "^M"
bindkey -r "^N"
bindkey -r "^O"
bindkey -r "^P"
bindkey -r "^Q"
bindkey -r "^R"
bindkey -r "^S"
bindkey -r "^T"
bindkey -r "^U"
bindkey -r "^V"
bindkey -r "^W"
bindkey -r "^X"
bindkey -r "^Y"
bindkey -r "^Z"
bindkey -r "\e"
bindkey -r "^_"
bindkey -r "^?"
bindkey -r "^X^B"
bindkey -r "^X^F"
bindkey -r "^X^J"
bindkey -r "^X^K"
bindkey -r "^X^N"
bindkey -r "^X^O"
bindkey -r "^X^U"
bindkey -r "^X^V"
bindkey -r "^X^X"
bindkey -r "^X*"
bindkey -r "^XG"
bindkey -r "^Xg"
bindkey -r "^Xr"
bindkey -r "^Xs"
bindkey -r "^Xu"
bindkey -r "\e^D"
bindkey -r "\e^G"
bindkey -r "\e^H"
bindkey -r "\e^I"
bindkey -r "\e^J"
bindkey -r "\e^L"
bindkey -r "\e^M"
bindkey -r "\e^_"
bindkey -r "\e "
bindkey -r "\e!"
bindkey -r "\e\\""
bindkey -r "\e$"
bindkey -r "\e'"
bindkey -r "\e-"
bindkey -r "\e."
bindkey -r "\e0"
bindkey -r "\e1"
bindkey -r "\e2"
bindkey -r "\e3"
bindkey -r "\e4"
bindkey -r "\e5"
bindkey -r "\e6"
bindkey -r "\e7"
bindkey -r "\e8"
bindkey -r "\e9"
bindkey -r "\e<"
bindkey -r "\e>"
bindkey -r "\e?"
bindkey -r "\eA"
bindkey -r "\eB"
bindkey -r "\eC"
bindkey -r "\eD"
bindkey -r "\eF"
bindkey -r "\eG"
bindkey -r "\eH"
bindkey -r "\eL"
bindkey -r "\eN"
bindkey -r "\eP"
bindkey -r "\eQ"
bindkey -r "\eS"
bindkey -r "\eT"
bindkey -r "\eU"
bindkey -r "\eW"
bindkey -r "\e[A"
bindkey -r "\e[B"
bindkey -r "\e[C"
bindkey -r "\e[D"
bindkey -r "\e_"
bindkey -r "\ea"
bindkey -r "\eb"
bindkey -r "\ec"
bindkey -r "\ed"
bindkey -r "\ef"
bindkey -r "\eg"
bindkey -r "\eh"
bindkey -r "\el"
bindkey -r "\en"
bindkey -r "\ep"
bindkey -r "\eq"
bindkey -r "\es"
bindkey -r "\et"
bindkey -r "\eu"
bindkey -r "\ew"
bindkey -r "\ex"
bindkey -r "\ey"
bindkey -r "\ez"
bindkey -r "\e|"
bindkey -r "\e^?"

bindkey "^@"	set-mark-command
bindkey "^A"	beginning-of-line
bindkey "^B"	backward-char
bindkey "^C"	undefined-key
bindkey "^D"	delete-char-or-list
bindkey "^E"	end-of-line
bindkey "^F"	forward-char
bindkey "^G"	send-break
bindkey "^H"	backward-delete-char
bindkey "^I"	expand-or-complete
bindkey "^J"	accept-line
bindkey "^K"	kill-line
bindkey "^L"	clear-screen
bindkey "^M"	accept-line
bindkey "^N"	down-line-or-history
bindkey "^O"	accept-line-and-down-history
bindkey "^P"	up-line-or-history
bindkey "^Q"	push-line
bindkey "^R"	history-incremental-search-backward
bindkey "^S"	history-incremental-search-forward
bindkey "^T"	transpose-chars
bindkey "^U"	kill-whole-line
bindkey "^V"	quoted-insert
bindkey "^W"	backward-kill-word
bindkey "^X"	prefix
bindkey "^Y"	yank
bindkey "^Z"	undefined-key
bindkey "\e"	prefix
bindkey "^_"	undo
bindkey "^?"	backward-delete-char
bindkey "^X^B"	vi-match-bracket
bindkey "^X^F"	vi-find-next-char
bindkey "^X^J"	vi-join
bindkey "^X^K"	kill-buffer
bindkey "^X^N"	infer-next-history
bindkey "^X^O"	overwrite-mode
bindkey "^X^U"	undo
bindkey "^X^V"	vi-cmd-mode
bindkey "^X^X"	exchange-point-and-mark
bindkey "^X*"	expand-word
bindkey "^XG"	list-expand
bindkey "^Xg"	list-expand
bindkey "^Xr"	history-incremental-search-backward
bindkey "^Xs"	history-incremental-search-forward
bindkey "^Xu"	undo
bindkey "\e^D"	list-choices
bindkey "\e^G"	send-break
bindkey "\e^H"	backward-kill-word
bindkey "\e^I"	self-insert-unmeta
bindkey "\e^J"	self-insert-unmeta
bindkey "\e^L"	clear-screen
bindkey "\e^M"	self-insert-unmeta
bindkey "\e^_"	copy-prev-word
bindkey "\e "	expand-history
bindkey "\e!"	expand-history
bindkey "\e\\""	quote-region
bindkey "\e$"	spell-word
bindkey "\e'"	quote-line
bindkey "\e-"	neg-argument
bindkey "\e."	insert-last-word
bindkey "\e0"	digit-argument
bindkey "\e1"	digit-argument
bindkey "\e2"	digit-argument
bindkey "\e3"	digit-argument
bindkey "\e4"	digit-argument
bindkey "\e5"	digit-argument
bindkey "\e6"	digit-argument
bindkey "\e7"	digit-argument
bindkey "\e8"	digit-argument
bindkey "\e9"	digit-argument
bindkey "\e<"	beginning-of-buffer-or-history
bindkey "\e>"	end-of-buffer-or-history
bindkey "\e?"	which-command
bindkey "\eA"	accept-and-hold
bindkey "\eB"	backward-word
bindkey "\eC"	capitalize-word
bindkey "\eD"	kill-word
bindkey "\eF"	forward-word
bindkey "\eG"	get-line
bindkey "\eH"	run-help
bindkey "\eL"	down-case-word
bindkey "\eN"	history-search-forward
bindkey "\eP"	history-search-backward
bindkey "\eQ"	push-line
bindkey "\eS"	spell-word
bindkey "\eT"	transpose-words
bindkey "\eU"	up-case-word
bindkey "\eW"	copy-region-as-kill
bindkey "\e[A"	up-line-or-history
bindkey "\e[B"	down-line-or-history
bindkey "\e[C"	forward-char
bindkey "\e[D"	backward-char
bindkey "\e_"	insert-last-word
bindkey "\ea"	accept-and-hold
bindkey "\eb"	backward-word
bindkey "\ec"	capitalize-word
bindkey "\ed"	kill-word
bindkey "\ef"	forward-word
bindkey "\eg"	get-line
bindkey "\eh"	run-help
bindkey "\el"	down-case-word
bindkey "\en"	history-search-forward
bindkey "\ep"	history-search-backward
bindkey "\eq"	push-line
bindkey "\es"	spell-word
bindkey "\et"	transpose-words
bindkey "\eu"	up-case-word
bindkey "\ew"	copy-region-as-kill
bindkey "\ex"	execute-named-cmd
bindkey "\ey"	yank-pop
bindkey "\ez"	execute-last-named-cmd
bindkey "\e|"	vi-goto-column
bindkey "\e^?"	backward-kill-word

# Completions.

compctl -b bindkey
compctl -c builtin
compctl -v export
compctl -o setopt
compctl -v typeset
compctl -v unset
compctl -o unsetopt
compctl -v vared
compctl -c which
compctl -C -c
compctl -D -f
compctl -T

# Undefined functions.


# Defined functions.


# Limits.

limit stacksize       8MB
limit coredumpsize    20MB
limit maxproc         256
limit descriptors     256

# Non-array variables.

TERMCAP='xterm|vs100|xterms|xterm terminal emulator (X Window System):ac=``aaffggjjkkllmmnnooppqqrrssttuuvvwwxxyyzz{{||}}~~..--++,,II00:u6=\E[%i%d;%dR:u7=\E[6n:u8=\E[?1;2c:u9=\E[c:am:km:mi:ms:xn:co#80:it#8:li#50:AL=\E[%dL:DC=\E[%dP:DL=\E[%dM:DO=\E[%dB:IC=\E[%d@:K1=\EOw:K2=\EOy:K3=\EOu:K4=\EOq:K5=\EOs:LE=\E[%dD:RI=\E[%dC:UP=\E[%dA:ae=^O:al=\E[L:as=^N:bl=^G:cd=\E[J:ce=\E[K:cl=\E[H\E[2J:cm=\E[%i%d;%dH:cr=^M:cs=\E[%i%d;%dr:ct=\E[3g:dc=\E[P:dl=\E[M:do=^J:ec=\E[%dX:ei=\E[4l:ho=\E[H:ic=\E[@:im=\E[4h:is=\E7\E[r\E[m\E[?7h\E[?1;3;4;6l\E[4l\E8\E>:k1=\E[11~:k2=\E[12~:k3=\E[13~:k4=\E[14~:k5=\E[15~:k6=\E[17~:k7=\E[18~:k8=\E[19~:k9=\E[20~:kD=:kI=\E[2~:kN=\E[6~:kP=\E[5~:kb=^H:kd=\EOB:ke=\E[?1l\E>:kh=\EOH:kl=\EOD:kr=\EOC:ks=\E[?1h\E=:ku=\EOA:le=^H:md=\E[1m:me=\E[m\017:mr=\E[7m:nd=\E[C:rc=\E8:sc=\E7:se=\E[27m:sf=^J:so=\E[7m:sr=\EM:st=\EH:ta=^I:te=\E[2J\E[?47l\E8:ti=\E7\E[?47h:ue=\E[24m:up=\E[A:us=\E[4m:vb=\E[?5h\E[?5l:ve=\E[?25h:vi=\E[?25l:vs=\E[?25h:'
TERM='xterm'
\'#\'="0"
\'$\'="7926"
\'?\'="0"
AUDIOSERVER="duras:0"
AWK="awk"
BAUD="0"
CDPATH=".:/home/andreas"
COLUMNS="80"
CPP="/lib/cpp"
DISPLAY="duras.xss.co.at:0.0"
EGID="100"
ERRNO="0"
EUID="101"
EXINIT="\'set ai eb nomesg nowrapscan shiftwidth=2 showmatch\'"
FCEDIT="vi"
FIGNORE="\'\'"
FPATH="\'\'"
GID="100"
HELPPATH="/usr/opt/StarOffice3.1/linux-x86/../modules"
HISTSIZE="30"
HOME="/home/andreas"
HOST="sartre"
INFOPATH="/usr/local/info:/usr/local/teTeX/info:/usr/share/info"
KEYTIMEOUT="40"
LINENO="329"
LINES="50"
LISTMAX="100"
LOGCHECK="60"
LOGNAME="andreas"
MACHTYPE="i586"
MAILCHECK="60"
MAILPATH="\'\'"
MANPATH="/usr/man:/usr/X11R6/man:/usr/local/man:/usr/local/teTeX/man"
NULLCMD=":"
OLDPWD="/usr/src/zsh-3.0.2/Util"
OPTARG="\'\'"
OPTIND="1"
OSTYPE="linux"
PATH="/bin:/usr/bin:/opt/bin:/usr/local/bin:/usr/local/bin/pbmplus:/usr/local/bin/ImageMagick:/usr/X11R6/bin:/usr/local/bin/X11:/usr/games/bin::/usr/local/teTeX/bin/i486-linux:."
POSTEDIT="\'\'"
PPID="5154"
PS1="\'%n@%m {%!} %# \'"
PS2="\'> \'"
PS3="\'?# \'"
PS4="\'+ \'"
PSVAR="\'\'"
PWD="/usr/src/zsh-3.0.2/Util"
RANDOM="17187"
READNULLCMD=":"
RPROMPT="\'\'"
RPS1="\'\'"
SECONDS="1"
SHELL="/bin/zsh"
SHLVL="2"
SPROMPT="\'zsh: correct \'\\'\'%R\'\\'\' to \'\\'\'%r\'\\'\' [nyae]? \'"
SVFONTPATH="/usr/opt/StarOffice3.1/linux-x86/../fonts/75dpi:/usr/opt/StarOffice3.1/linux-x86/../fonts/75dpi/bdf:/usr/opt/StarOffice3.1/linux-x86/../fonts/type1"
SVHOME="/home/andreas"
TIMEFMT="\'%J  %U user %S system %P cpu %*E total\'"
TMPPREFIX="/tmp/zsh"
TTY="/dev/ttyp0"
TTYIDLE="-1"
UID="101"
USER="andreas"
USERNAME="andreas"
VENDOR="pc"
WATCH="\'\'"
WATCHFMT="\'%n has %a %l from %m.\'"
WINDOWID="41943055"
WORDCHARS="\'*?_-.[]~=/&;!#$%^(){}<>\'"
XAPPLRESDIR=":/usr/local/lib/X11/app-defaults"
XENVIRONMENT="/usr/opt/StarOffice3.1/linux-x86/../starview.xres"
XKEYSYMDB="/usr/X11R6/lib/X11/XKeysymDB"
XNLSPATH="/usr/X11R6/lib/X11/nls/"
XPPATH="/usr/opt/StarOffice3.1/linux-x86/../Xp3"
ZSH_NAME="sh"
ZSH_VERSION="3.0.2"
each="/bin"
histchars="\'!^#\'"
reporter_OSVersion="Linux_2.0.27"
reporter_junkiequotes="no"
str="\'Linux sartre 2.0.27 #5 Thu Dec 19 18:58:54 MET 1996 i586\'"
prompt='test%'

# Array variables.

argv=()
'*'=()
signals=(EXIT HUP INT QUIT ILL TRAP ABRT BUS FPE KILL USR1 SEGV USR2 PIPE ALRM TERM STKFLT CHLD CONT STOP TSTP TTIN TTOU URG XCPU XFSZ VTALRM PROF WINCH IO PWR UNUSED ZERR DEBUG)

# Exported variables.

export TERMCAP
export TERM
export AUDIOSERVER=duras:0
export CDPATH=.:/home/andreas
export DISPLAY=duras.xss.co.at:0.0
export EXINIT='set ai eb nomesg nowrapscan shiftwidth=2 showmatch'
export HELPPATH=/usr/opt/StarOffice3.1/linux-x86/../modules
export HOME=/home/andreas
export HOST=sartre
export INFOPATH=/usr/local/info:/usr/local/teTeX/info:/usr/share/info
export LOGNAME=andreas
export MANPATH=/usr/man:/usr/X11R6/man:/usr/local/man:/usr/local/teTeX/man
export PATH=/bin:/usr/bin:/opt/bin:/usr/local/bin:/usr/local/bin/pbmplus:/usr/local/bin/ImageMagick:/usr/X11R6/bin:/usr/local/bin/X11:/usr/games/bin::/usr/local/teTeX/bin/i486-linux:.
export PS1='%n@%m {%!} %# '
export PS2='> '
export PWD=/usr/src/zsh-3.0.2/Util
export SHELL=/bin/zsh
export SHLVL=2
export SVFONTPATH=/usr/opt/StarOffice3.1/linux-x86/../fonts/75dpi:/usr/opt/StarOffice3.1/linux-x86/../fonts/75dpi/bdf:/usr/opt/StarOffice3.1/linux-x86/../fonts/type1
export SVHOME=/home/andreas
export TERM=xterm
export USER=andreas
export WINDOWID=41943055
export XAPPLRESDIR=:/usr/local/lib/X11/app-defaults
export XENVIRONMENT=/usr/opt/StarOffice3.1/linux-x86/../starview.xres
export XKEYSYMDB=/usr/X11R6/lib/X11/XKeysymDB
export XNLSPATH=/usr/X11R6/lib/X11/nls/
export XPPATH=/usr/opt/StarOffice3.1/linux-x86/../Xp3

# Setopt.


# END zsh saveset

Does anyone else have this problem? As the configure script is quite 
complicated, I didn't have the time to further investigate this bug.

If you need more information please tell me.

- andreas

--
 Andreas Haumer           |   email: andreas@xss.co.at   |   PGP key available
 *x Software + Systeme    |   phone: +43.1.6001508       |   on request.
 Buchengasse 67/8         |          +43.664.3004449     |   
 A-1100 Vienna, Austria   |     fax: +43.1.6001084       |   

