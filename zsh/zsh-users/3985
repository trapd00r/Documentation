From zsh-users-return-3985-mason-zsh=primenet.com.au@sunsite.dk Sat Jun 30 16:07:47 2001
Return-Path: <zsh-users-return-3985-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1023 invoked from network); 30 Jun 2001 16:07:46 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Jun 2001 16:07:46 -0000
Received: (qmail 829 invoked by alias); 30 Jun 2001 16:06:39 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 3985
Received: (qmail 807 invoked from network); 30 Jun 2001 16:06:38 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010630160614.ZM21128@candle.brasslantern.com>
Date: Sat, 30 Jun 2001 16:06:14 +0000
In-Reply-To: <4a9256987fvincent@vinc17.org>
Comments: In reply to Vincent Lefevre <vincent@vinc17.org>
        "Re: [4.0.2 bug] commands not written to history" (Jun 29,  8:14pm)
References: <20010629163348.A9632@greux.loria.fr> 
	<1010629155017.ZM14989@candle.brasslantern.com> 
	<4a9256987fvincent@vinc17.org>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-users@sunsite.dk
Subject: Re: [4.0.2 bug] commands not written to history
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jun 29,  8:14pm, Vincent Lefevre wrote:
} Subject: Re: [4.0.2 bug] commands not written to history
}
} I can even tell you that the last time this problem occurs, the
} command after cmd1 was xinit, i.e. the first command I type after I
} log in.
} 
} I probably had several opened shells. But here, I'm sure I typed both
} commands one after the other. And anyway, a xinit can't have been
} interleaved.

This being the case, you can check what happened to xinit by examining
the history file from a new shell as soon as you have X up and running.
With incappendhistory, `xinit' should already be the last command in
the file before `xinit' itself runs -- so assuming that your shells in
xterm (or whatever emulator) are using the same history file as your
console shell, typing <C-p> as soon as a new terminal opens should show
you `xinit', and <C-p> again should show you `cmd1'.  If history files
aren't the same, `tail' the one the console should have written.

An important thing to note is that with incappendhistory set, zsh will
not re-write the history file again at shell exit.  If you did anything
at all in a shell from within X, and then you immediately `exit' from the
console after the X server shuts down, the last commands in the history
will be those saved by the shells within X.

} BTW, I use NFS, but all the shells were on the same machine.

NFS could be a factor even if only one client machine is involved.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

