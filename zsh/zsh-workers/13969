From zsh-workers-return-13969-mason-zsh=primenet.com.au@sunsite.dk Fri Apr 13 01:13:09 2001
Return-Path: <zsh-workers-return-13969-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8674 invoked from network); 13 Apr 2001 01:13:08 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Apr 2001 01:13:08 -0000
Received: (qmail 15856 invoked by alias); 13 Apr 2001 01:13:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13969
Received: (qmail 15841 invoked from network); 13 Apr 2001 01:13:07 -0000
Date: Thu, 12 Apr 2001 18:13:00 -0700 (PDT)
From: Wayne Davison <wayned@users.sourceforge.net>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: <zsh-workers@sunsite.dk>
Subject: Re: PATCH: Re: Build Failures on SunOS-4.1 and 5.5
In-Reply-To: <1010412230835.ZM692@candle.brasslantern.com>
Message-ID: <Pine.LNX.4.30.0104121754580.5377-100000@phong.blorf.net>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 12 Apr 2001, Bart Schaefer wrote:
> So how about the following (also not yet committed); I'm not sure how
> it flies with respect to your needing to put curses.h above termios.h,

Solaris 2.6 fails to compile terminfo.c because of the weirdness with
curses.h and termios.h/termio.h.  Basically curses.h has a long
comment that goes on about how including curses.h is wrong in a
"strictly conformant ANSI-C compilation", so it makes me think that
they didn't imagine someone would want to include termios.h along with
curses.h.

The underlying problem here is that curses.h omits including termio.h
if VINTR is defined, and while termios.h defines VINTR, it doesn't
define the termio struct, and term.h puts a termio struct into its
term struct.

I can get terminfo.c to compile by either including termio.h before I
include term.h, or by undefining VINTR before including curses.h.  Any
ideas on what is a good, portable solution?  Can we stomache adding
this before the curses.h include:

# ifdef VINTR
#  undef VINTR
# endif

On a slightly related note, anyone know what the "offsetof" define is
doing in system.h?  It doesn't appear to be used anywhere, and the new
include of term.h causes it to be redefined (on Solaris).

..wayne..

