From zsh-workers-return-24876-mason-zsh=primenet.com.au@sunsite.dk Sat Apr 26 19:33:31 2008
Return-Path: <zsh-workers-return-24876-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29611 invoked from network); 26 Apr 2008 19:33:19 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.1 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Apr 2008 19:33:19 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 82719 invoked from network); 26 Apr 2008 19:33:15 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Apr 2008 19:33:15 -0000
Received: (qmail 23704 invoked by alias); 26 Apr 2008 19:33:12 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24876
Received: (qmail 23687 invoked from network); 26 Apr 2008 19:33:12 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 26 Apr 2008 19:33:12 -0000
Received: from rcpt-expgw.biglobe.ne.jp (rcpt-expgw.biglobe.ne.jp [133.205.19.68])
	by bifrost.dotsrc.org (Postfix) with ESMTP id E1383808A38A
	for <zsh-workers@sunsite.dk>; Sat, 26 Apr 2008 21:33:05 +0200 (CEST)
Received: from smtp-gw.biglobe.ne.jp
	by rcpt-expgw.biglobe.ne.jp (kbkr/0208160408) with ESMTP id m3QJX3ab024588
	for <zsh-workers@sunsite.dk>; Sun, 27 Apr 2008 04:33:03 +0900
X-Biglobe-Sender: <takimoto-j@kba.biglobe.ne.jp>
Received: from [192.168.0.3] (125.196.138.236 [125.196.138.236]) by smtp-gw.biglobe.ne.jp
	id EAIDAC15AFDB; Sun, 27 Apr 2008 04:33:03 +0900 (JST)
Message-Id: <58F0E106-74F5-4F3E-A146-4DBF38A7F933@kba.biglobe.ne.jp>
From: "Jun T." <takimoto-j@kba.biglobe.ne.jp>
To: zsh-workers@sunsite.dk
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Empty man pages are installed (if yodl is not available)
Date: Sun, 27 Apr 2008 04:33:03 +0900
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: ClamAV 0.91.2/6957/Sat Apr 26 20:28:22 2008 on bifrost
X-Virus-Status: Clean

It is rather tedious (and not necessary) to install yodl to
every machine on which I want to quickly test the latest CVS.

If yodl is not installed, "make" fails while making man pages,
of course, but empty man pages are created by the "touch"
command. Then "make install" will install these empty man
pages, replacing the pre-existing ones.

I know I can type
make install.bin install.modules install.fns
(or "make mandir=/xxx/yyy install")
but I frequently forget this...

How about modifying Doc/Makefile.in so that empty man pages
are not installed?


Index: Doc/Makefile.in
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Makefile.in,v
retrieving revision 1.41
diff -u -r1.41 Makefile.in
--- Doc/Makefile.in	27 Feb 2008 18:24:41 -0000	1.41
+++ Doc/Makefile.in	26 Apr 2008 19:20:59 -0000
@@ -278,6 +278,7 @@
  install.man: man
  	${SHELL} $(sdir_top)/mkinstalldirs $(DESTDIR)$(mandir)/man1
  	for file in $(MAN); do \
+	    test -s $(sdir)/$$file || exit 1; \
  	    $(INSTALL_DATA) $(sdir)/$$file $(DESTDIR)$(mandir)/man1/`echo $ 
$file | sed 's|zsh|$(tzsh)|'` || exit 1; \
  	done
  .PHONY: install.man


-----
Jun

