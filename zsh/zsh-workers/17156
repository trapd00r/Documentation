From zsh-workers-return-17156-mason-zsh=primenet.com.au@sunsite.dk Tue May 14 15:24:15 2002
Return-Path: <zsh-workers-return-17156-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14165 invoked from network); 14 May 2002 15:24:14 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 14 May 2002 15:24:14 -0000
Received: (qmail 4297 invoked by alias); 14 May 2002 15:24:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17156
Received: (qmail 4282 invoked from network); 14 May 2002 15:24:03 -0000
From: Sven Wischnowsky <wischnow@berkom.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15585.11254.373249.131932@wischnow.berkom.de>
Date: Tue, 14 May 2002 17:23:34 +0200
To: zsh-workers@sunsite.dk
Subject: Re: completion in quotes - " vs ' - no suffix added
In-Reply-To: <1020514143155.ZM13540@candle.brasslantern.com>
References: <15576.54689.459113.686818@wischnow.berkom.de>
	<6134254DE87BD411908B00A0C99B044F02E89A73@mowd019a.mow.siemens.ru>
	<15577.7296.682622.411849@wischnow.berkom.de>
	<1020508153855.ZM7837@candle.brasslantern.com>
	<15583.34740.981994.404489@wischnow.berkom.de>
	<6134254DE87BD411908B00A0C99B044F02E89A8C@mowd019a.mow.siemens.ru>
	<1020513173320.ZM12360@candle.brasslantern.com>
	<1021313089.2926.10.camel@localhost.localdomain>
	<15584.49227.780505.590251@wischnow.berkom.de>
	<1020514142335.ZM13473@candle.brasslantern.com>
	<1020514143155.ZM13540@candle.brasslantern.com>
X-Mailer: VM 6.95 under 21.5 (patch 3) "asparagus" XEmacs Lucid


Bart Schaefer wrote:

> On May 14,  2:23pm, Bart Schaefer wrote:
> }
> } -rw-rw-r--   1 schaefer schaefer        0 May 13 10:29 a\ b
> } drwxrwxr-x   2 schaefer schaefer     1024 May 13 10:29 a\ d/
> } schaefer<503> zsh -c "ls a<TAB>
> } schaefer<503> zsh -c "ls a\\\\\\ 
> 
> It's worse than that -- if I type TAB again at this point, the shell
> crashes.

The number of backslashes is ok.

But the segv not, obviously. A quick check shows that there's another
bug in the zle_tricky code, similar to the one I fixed in that other
patch -- only this time it's with double quotes, whereas the other one
was with single quotes. One of the effects of these bugs is that the
`x' inserted into the line stays there so the completion code gets to
see it. With this bug I guess this means the code calls chuck() with a
pointer pointing to the null byte at the end of the string, messing up
the following memory.

But this might take more time, so it'll have to wait until I get home
but I hope to send a patch tomorrow. Sorry.


Bye
  Sven

-- 
Sven Wischnowsky                          wischnow@berkom.de

