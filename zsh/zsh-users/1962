From zsh-workers-request@math.gatech.edu Mon Dec 07 14:24:32 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15569 invoked from network); 7 Dec 1998 14:24:31 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 7 Dec 1998 14:24:31 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id JAA08590;
	Mon, 7 Dec 1998 09:13:49 -0500 (EST)
Resent-Date: Mon, 7 Dec 1998 09:13:44 -0500 (EST)
Message-Id: <9812071357.AA69927@ibmth.df.unipi.it>
To: Stucki <stucki@math.fu-berlin.de>, zsh-users@math.gatech.edu
Subject: Re: How to NOT allow LC_COLLATE to corrupt globbing ??? 
In-Reply-To: "Stucki"'s message of "Mon, 07 Dec 1998 14:44:48 NFT."
             <19981207144447.A13964@math.fu-berlin.de> 
Date: Mon, 07 Dec 1998 14:57:03 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>
Resent-Message-ID: <"dz7d71.0.b52.NA-Qs"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1962
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Stucki wrote:
> So now I'd like to ***compile*** my zsh in a way that makes sure
> I *always* use the standard collating sequence like LC_COLLATE=C
> (or may be LC_COLLATE=us).
> 
> Is there a way to configure this in, by editing some config-files ???
> 
> (changing 'config.h' *after* running 'configure'
>  to contain '#define HAVE_LOCALE_H 0' did *not* help!)

I just reread that and the first thing I'd suggest is not defining
HAVE_LOCALE_H at all, since most of the tests are #ifdef's.

If that's not it, here's what I wrote before I realised what the
problem probably was.

zsh will only ever call setlocale() if LC_ALL is defined, which
usually happens in locale.h; zsh will not define it itself.  So either
the definition is creeping in some other way on your system --- you
could look at the post-prerprocessor output to see what files are
being included --- or the locale you are in is the default one.  If
it's the former you might try sticking #undef LC_ALL at the end of
system.h, since config.h probably gets included too early to do
anything about it without some more detective work.  If it's the
second (which seems pretty unlikely) you can't get away without at
least one call to setlocale().

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

