From zsh-workers-return-20140-mason-zsh=primenet.com.au@sunsite.dk Wed Jul 07 12:38:09 2004
Return-Path: <zsh-workers-return-20140-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19031 invoked from network); 7 Jul 2004 12:38:08 -0000
Received: from odin.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.85)
  by ns1.primenet.com.au with SMTP; 7 Jul 2004 12:38:08 -0000
Received: (qmail 3701 invoked from network); 7 Jul 2004 13:53:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Jul 2004 13:53:54 -0000
Received: (qmail 12084 invoked by alias); 7 Jul 2004 12:37:52 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20140
Received: (qmail 12075 invoked from network); 7 Jul 2004 12:37:52 -0000
Received: from odin.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.85)
  by sunsite.dk with SMTP; 7 Jul 2004 12:37:52 -0000
Received: (qmail 3462 invoked from network); 7 Jul 2004 13:53:46 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 7 Jul 2004 13:53:33 -0000
Received: from localhost (localhost [127.0.0.1])
	by acolyte.scowler.net (Postfix) with ESMTP id 80C3270053;
	Wed,  7 Jul 2004 08:37:10 -0400 (EDT)
Received: from acolyte.scowler.net ([127.0.0.1])
	by localhost (acolyte [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id 04378-04; Wed, 7 Jul 2004 08:36:44 -0400 (EDT)
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 0A0E27004F; Wed,  7 Jul 2004 08:36:42 -0400 (EDT)
Date: Wed, 7 Jul 2004 08:36:42 -0400
From: Clint Adams <clint@zsh.org>
To: Peter Stephenson <pws@csr.com>
Cc: zsh-workers@sunsite.dk, 251378@bugs.debian.org, mdz@debian.org
Subject: Re: Bug#251378: zsh: segfaults when globing includes too many files
Message-ID: <20040707123642.GA16023@scowler.net>
References: <20040706185926.GA14980@scowler.net> <200407071101.i67B1Ygr024643@news01.csr.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <200407071101.i67B1Ygr024643@news01.csr.com>
User-Agent: Mutt/1.5.6+20040523i
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at scowler.net
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-1.4 required=6.0 tests=BAYES_20 autolearn=no 
	version=2.63
X-Spam-Hits: -1.4

> > when globbing in /usr/share/doc.  The source shown below includes 19920.
> 
> So this happens with both 4.2.0 and the latest, and therefore isn't
> (directly) related to the mmap reorganisation of heap allocation?

No, 19920 is the heap allocation patch.  I don't know if this happens
without it.

> Is it possible a memory allocator is returning 0?  It could be another
> case where the shell is trying to allocate way too much memory, not
> getting it, and not handling the failure gracefully.

Guys, are you using a non-default overcommit_memory setting on Linux?

