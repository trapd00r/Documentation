From zsh-users-return-8231-mason-zsh=primenet.com.au@sunsite.dk Thu Nov 18 13:02:02 2004
Return-Path: <zsh-users-return-8231-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17799 invoked from network); 18 Nov 2004 13:01:44 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 Nov 2004 13:01:44 -0000
Received: (qmail 19935 invoked from network); 18 Nov 2004 12:59:18 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 Nov 2004 12:59:18 -0000
Received: (qmail 21477 invoked by alias); 18 Nov 2004 12:58:29 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 8231
Received: (qmail 21462 invoked from network); 18 Nov 2004 12:58:28 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 18 Nov 2004 12:58:28 -0000
Received: (qmail 14893 invoked from network); 18 Nov 2004 12:51:53 -0000
Received: from smtp-out6.blueyonder.co.uk (195.188.213.9)
  by a.mx.sunsite.dk with SMTP; 18 Nov 2004 12:51:37 -0000
Received: from sc ([82.41.208.120]) by smtp-out6.blueyonder.co.uk with Microsoft SMTPSVC(5.0.2195.6713);
	 Thu, 18 Nov 2004 12:36:51 +0000
Date: Thu, 18 Nov 2004 12:36:13 +0000
From: Stephane Chazelas <Stephane_Chazelas@yahoo.fr>
To: Zsh Users List <zsh-users@sunsite.dk>
Subject: [tip] Linux-GPM mouse support (repost)
Message-ID: <20041118123613.GB4511@sc>
Mail-Followup-To: Zsh Users List <zsh-users@sunsite.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-15
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
User-Agent: Mutt/1.5.6i
X-OriginalArrivalTime: 18 Nov 2004 12:36:51.0209 (UTC) FILETIME=[47261790:01C4CD6B]
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 1.5

Hi,

I have updated my zsh mouse support again.

Now, it should work in the console of i386 Linux machines if
there's a GPM daemon running (the GPM protocol is hardcoded, it
happens to work with GPM 1.19.6 at least).

I have one problem with it. For GPM support, I use a unix socket
connection and a zle handler on that FD. As you can see, I
explicitely used the fd 9. I tried to let zsh decide for the
file descriptor. But when I did so, it picked the fd 3, and
there seemed to be a bug as there were interferences with the
tty input handling (only when I activated the mouse support
withing zle (zle-toggle-mouse bound to a key)). I also tried to
use a fd above 9. 10 was a bad idea as this fd was internally
used by zsh. Higher was OK except that I don't know how to close
it (there has been a thread some time ago about issues about
exec 15>&... but I don't remember the conclusions). Any advice?
Why isn't there a "zsocket -c" to close a connection?

[for FreeBSD console mouse support, we'd need the ability to
perform ioctls]

[Note it is my fourth attempt to post that message to the list.
It never showed up so far. Was it spam-rejected? This time, I
don't include the code. You may find it at:
http://stchaz.free.fr/mouse.zsh]

Hope this helps
Stéphane

