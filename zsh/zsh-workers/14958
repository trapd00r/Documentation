From zsh-workers-return-14958-mason-zsh=primenet.com.au@sunsite.dk Mon Jun 18 09:27:17 2001
Return-Path: <zsh-workers-return-14958-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4319 invoked from network); 18 Jun 2001 09:27:17 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 Jun 2001 09:27:16 -0000
Received: (qmail 25075 invoked by alias); 18 Jun 2001 09:24:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14958
Received: (qmail 25064 invoked from network); 18 Jun 2001 09:24:27 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "Peter Breitenlohner" <peb@mppmu.mpg.de>, <zsh-workers@sunsite.dk>
Subject: RE: zsh-4.0.1 -- some minor build/install problems
Date: Mon, 18 Jun 2001 13:24:47 +0400
Message-ID: <000c01c0f7d8$84922220$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200
In-Reply-To: <Pine.LNX.4.21.0106111210040.1321-200000@nbltheo1.mppmu.mpg.de>
Importance: Normal

>
> 1. zsh-4.0.1/Test/Makefile.in:
>
> without the patch "make DESTDIR=some_where check" rather badly fails.
> Why would I want to use "DESTDIR=some_where" together with "make check"?
> Seen in isolation this admittedly doesn't make much sense, nevertheless
> "make check" shouldn't fail. Consider, however,
> "make DESTDIR=some_where all check install"
>

That makes sense I guess.

> 2. zsh-4.0.1/Makefile.in:
>
> without the patch I had to say
> 	"make all; make -C Doc info" as user
> and	"make install install.info" as root
> instead of the more natural "make all info".
> You might say that "make install.info" will build the info pages in any
> case. True, but when the build tree is on an nfs-mounted
> filesystem, root may
> not have write permission.
>

The actual bug is that currently info is not created at all when building
off CVS. install.info depends on texi not on info as it should. Your patch
does not fix it. I'll commit the right one.

There remains the issue of make install.info vs. make info of course.

> 3. zsh-4.0.1/Doc/Makefile.in:
>
> without the patch "make DESTDIR=some_where install.info" produces
> some weird
> messages (in my case zsh.info from zsh-3.0.5 had no 'INFO-DIR-SECTION', or
> there may not be any /usr/local/info/zsh.info at all).
>

Now, when I'm looking at it - DESTDIR was instroduced for package creation -
in which case install-info is pretty useless and DESTDIR is plain wrong.
Alternative would be to skip install-info if -n $DESTDIR.

-andrej

