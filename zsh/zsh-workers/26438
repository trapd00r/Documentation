From zsh-workers-return-26438-mason-zsh=primenet.com.au@sunsite.dk Sun Jan 25 23:36:35 2009
Return-Path: <zsh-workers-return-26438-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2334 invoked from network); 25 Jan 2009 23:36:22 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 25 Jan 2009 23:36:22 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 18806 invoked from network); 25 Jan 2009 23:36:18 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 25 Jan 2009 23:36:18 -0000
Received: (qmail 17337 invoked by alias); 25 Jan 2009 23:36:12 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26438
Received: (qmail 17324 invoked from network); 25 Jan 2009 23:36:12 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 25 Jan 2009 23:36:12 -0000
Received: from fly.srk.fer.hr (fly.srk.fer.hr [161.53.74.66])
	by bifrost.dotsrc.org (Postfix) with ESMTP id B487880271F0
	for <zsh-workers@sunsite.dk>; Mon, 26 Jan 2009 00:36:08 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fly.srk.fer.hr (Postfix) with ESMTP id E331E68327
	for <zsh-workers@sunsite.dk>; Mon, 26 Jan 2009 00:36:07 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at fly.srk.fer.hr
Received: from fly.srk.fer.hr ([127.0.0.1])
	by localhost (fly.srk.fer.hr [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 0so8HMzKpGKw for <zsh-workers@sunsite.dk>;
	Mon, 26 Jan 2009 00:36:07 +0100 (CET)
Received: by fly.srk.fer.hr (Postfix, from userid 30102)
	id C722568325; Mon, 26 Jan 2009 00:36:07 +0100 (CET)
Date: Mon, 26 Jan 2009 00:36:07 +0100
From: =?iso-8859-2?Q?Dra=BEen_Ka=E8ar?= <dave@fly.srk.fer.hr>
To: zsh-workers@sunsite.dk
Subject: Questions about _values
Message-ID: <20090125233607.GA30627@fly.srk.fer.hr>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
X-Face: 'UIE}WabGB0+U>p-#(hp<_+AD2{H],=qR*jHfm$/e]l0(kU3oOYc5lqG6gg>[\h^IOc{'siD6#!T&loIShgmYHz3#+*D38:|`~\BE,(W~Ol9BDfDwk'lKJ;Z{sY8E9(ME.E]'wvNO`$n#,;9Z`tOFcW/nHZq!BOSrM>V?C<5DTw=<$<xxB~RP@|-Co<|COgeVi1ozw_W>{c{M2V+|)0jSUl&!+8%8nIBF(u:E>SZWM^e
X-Attribution: Dave
User-Agent: Mutt/1.5.13 (2006-08-11)
X-Virus-Scanned: ClamAV 0.92.1/8901/Sun Jan 25 11:10:36 2009 on bifrost
X-Virus-Status: Clean

Hello,

I'm trying to write some completions with mixed success. Currently one
of my completions looks like this:

{vsun}/# pcred  <TAB pressed here
0                          --     root sched                                   
1                          --     root /sbin/init                              
122                        --     root /usr/sbin/nscd                          
125                        --     root /usr/lib/sysevent/syseventd             
134                        --   daemon /usr/lib/crypto/kcfd                    
140                        --     root /usr/lib/power/powerd                   
1402  2777  438            --     root /usr/lib/ssh/sshd                       
143                        --     root /usr/lib/picl/picld                     
2                          --     root pageout                                 
237                        --     root /usr/bin/VBoxService                    
238                        --     root /usr/sbin/cron                          
2780  1405                 --     dave /usr/lib/ssh/sshd                       
2782  1407                 --     dave -zsh
...

Argument is a PID, completed with _values. 

1. I tried to get the same effect with _describe, but I don't know how
   to do that (value grouping if description is the same and the "--"
   separator). I looked at _values source, but I don't understand how
   it does what it does. I suppose compvalues does the trick somehow. How
   do I produce the above output with _describe?

2. Is there a way to tell _values to limit the maximum number of items
   in a group? In the above example the description (process name) is
   more important than the items, so I'd like to avoid description
   trimming which happens by default.

3. Is there a way to tell _values (or _describe) to sort offered
   completions by description and not by item? In that case I'd get sort
   by username here, which is much better than sort by PID.

   Also, is there a way to tell them not to sort? The completion list
   could already be sorted in a meaningful way.

4. If I keep pressing TAB, zsh will offer completions. Is there a way to
   make it highlight (print the characters in bold or some color, for
   example) the offered item and its description in the list?
   Here the offered completions (PIDs) aren't descriptive, so the user must
   associate them with the descriptions (command names) to actually select
   what he wanted. It's hard to do vithout visual cue.

-- 
 .-.   .-.    Yes, I am an agent of Satan, but my duties are largely
(_  \ /  _)   ceremonial.
     |
     |        dave@fly.srk.fer.hr

