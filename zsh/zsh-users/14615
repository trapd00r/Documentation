From zsh-users-return-14615-mason-zsh=primenet.com.au@zsh.org Mon Nov 30 04:05:07 2009
Return-Path: <zsh-users-return-14615-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20919 invoked by alias); 30 Nov 2009 04:05:07 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14615
Received: (qmail 22132 invoked from network); 30 Nov 2009 04:05:04 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=AWL,BAYES_00,PLING_QUERY
	autolearn=no version=3.2.5
Received-SPF: none (ns2.melb.primenet.com.au: domain at klanderman.net does not designate permitted sender hosts)
From: Greg Klanderman <gak@klanderman.net>
To: zsh-users@zsh.org
Subject: unable to wait on completed job [was: should $! give the pid of subshell?]
Reply-To: gak@klanderman.net
References: <19213.26295.345572.732238@gargle.gargle.HOWL>
	<200911251748.nAPHmrCX010198@news01.csr.com>
Date: Sun, 29 Nov 2009 23:04:54 -0500
In-Reply-To: <200911251748.nAPHmrCX010198@news01.csr.com> (Peter Stephenson's message of "Wed, 25 Nov 2009 17:48:52 +0000")
Message-ID: <m3638sr72x.fsf_-_@klanderman.net>
User-Agent: Gnus/5.1008 (Gnus v5.10.8) XEmacs/21.4.17 (linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

>>>>> On November 25, 2009 Peter Stephenson <pws@csr.com> wrote:

> zsh "exec"s the final
> command since it notices the subshell isn't needed any more so there's
> no point in forking.

Oh cool, I didn't realize zsh did tail recursion..

OK, so let me change the question a bit.  If I run this script:

  #!/bin/zsh -f
  sleep 10 &
  pid=$!
  sleep 12
  wait $pid

I get the error:

| zshbgtest.zsh:wait:12: pid 19673 is not a child of this shell

Using bash or ksh, I can successfully wait on the completed job.

Shouldn't I be able to wait on a job that has completed in zsh?

This is zsh 4.3.10-dev-1, patchlevel 1.4816 if it matters, though
4.2.0 and 4.2.6 behave the same.

thanks,
Greg

