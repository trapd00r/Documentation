From zsh-workers-request@math.gatech.edu Thu Apr 23 19:53:21 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13753 invoked from network); 23 Apr 1998 19:53:20 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 23 Apr 1998 19:53:20 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id PAA17828;
	Thu, 23 Apr 1998 15:45:40 -0400 (EDT)
Resent-Date: Thu, 23 Apr 1998 15:45:40 -0400 (EDT)
Date: Thu, 23 Apr 1998 12:45:23 -0700
Message-Id: <199804231945.MAA07509@wank.pdi.com>
MIME-Version: 1.0
From: Nik Gervae <Nik@pdi.com>
To: zsh-workers@math.gatech.edu
Subject: System calls in zsh
X-Mailer: VM 6.34 under 20.3 "Vatican City" XEmacs  Lucid
Reply-To: Nik Gervae <nik@pdi.com>
Content-Type: text/plain; charset=US-ASCII
Resent-Message-ID: <"errRh.0.VM4.ZfvFr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3866
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hello. I've been using zsh 3.0.0 on IRIX for a while here at work, and we
just started an evaluation of shell script efficiency that prompted me to
ask this. It seems that if you create an empty zsh script and run it, it
invokes these system calls (which I got using "par -s -S"):

exit             : 1 times
read             : 12 times
open             : 12 times
close            : 11 times
time             : 3 times
brk              : 5 times
getpid           : 5 times
getuid           : 5 times
access           : 1 times
syssgi           : 5 times
times            : 1 times
getgid           : 4 times
ioctl            : 8 times
sysmp            : 2 times
execve           : 1 times
fcntl            : 5 times
lseek64          : 1 times
sigreturn        : 1 times
gethostname      : 1 times
getdomainname    : 1 times
gettimeofday     : 1 times
prctl            : 1 times
mmap             : 2 times
getrlimit        : 8 times
xstat            : 5 times
fxstat           : 9 times
sigaction        : 3 times
ngetdents        : 3 times

Can anyone explain why read() and open() are called so many times for an
empty shell script? The Bourne and Korn shells here invoke them twice each.
zsh seems to be expending a bit more effort here than might be necessary.

--Nik

