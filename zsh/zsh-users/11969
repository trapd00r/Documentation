From zsh-users-return-11969-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 09 01:45:24 2007
Return-Path: <zsh-users-return-11969-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5190 invoked from network); 9 Oct 2007 01:45:16 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 9 Oct 2007 01:45:16 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 40592 invoked from network); 9 Oct 2007 01:45:07 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 Oct 2007 01:45:07 -0000
Received: (qmail 9025 invoked by alias); 9 Oct 2007 01:44:56 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11969
Received: (qmail 9012 invoked from network); 9 Oct 2007 01:44:56 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 9 Oct 2007 01:44:56 -0000
Received: (qmail 39172 invoked from network); 9 Oct 2007 01:44:56 -0000
Received: from vms046pub.verizon.net (206.46.252.46)
  by a.mx.sunsite.dk with SMTP; 9 Oct 2007 01:44:49 -0000
Received: from torch.brasslantern.com ([71.116.76.59])
 by vms046.mailsrvcs.net (Sun Java System Messaging Server 6.2-6.01 (built Apr
 3 2006)) with ESMTPA id <0JPM00D1EFIMDEL7@vms046.mailsrvcs.net> for
 zsh-users@sunsite.dk; Mon, 08 Oct 2007 20:44:48 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id l991ijsh025515	for
 <zsh-users@sunsite.dk>; Mon, 08 Oct 2007 18:44:46 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id l991ijmf025514	for zsh-users@sunsite.dk; Mon,
 08 Oct 2007 18:44:45 -0700
Date: Mon, 08 Oct 2007 18:44:45 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Failing to write to history file if containing directory doesn't
 exist
In-reply-to: <dbfc82860710081532m5672197crf568b7d120ab192f@mail.gmail.com>
To: zsh-users@sunsite.dk
Message-id: <071008184445.ZM25513@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <dbfc82860710080309m41cfa984q5aa0474c6b4bdf62@mail.gmail.com>
	<200710081015.l98AFlIU018448@news01.csr.com>
	<dbfc82860710080508o3ef1de0br957caf39bb2aa19f@mail.gmail.com>
	<200710081338.l98Dc2br012284@news01.csr.com>
	<dbfc82860710080705w6e90db9i2a9714caf27460c4@mail.gmail.com>
	<20071008141403.GA25326@scowler.net>	<20071008151949.GA18576@mastermind>
	<dbfc82860710080830r289c962eyde18f1564e7f0de0@mail.gmail.com>
	<20071008154632.GB18576@mastermind>
	<dbfc82860710081532m5672197crf568b7d120ab192f@mail.gmail.com>
Comments: In reply to "Nikolai Weibull" <now@bitwi.se>
 "Re: Failing to write to history file if containing directory doesn't exist"
 (Oct  9, 12:32am)

On Oct 9, 12:32am, Nikolai Weibull wrote:
}
} > every time the history is updated.  That would make it impossible for
} > a user with HISTFILE=~/.zsh/history to do something as simple as:
} >
} > % mv .zsh .zsh-4.3.4
} > % ln -s .zsh-4.3.4 .zsh
} >
} > without first unsetting and later setting HISTFILE, since the
} > directory would be recreated between the two commands.
} 
} Only under the condition that HISTFILE is written to between the two
} commands.

Which will be always, if the SHARE_HISTORY and/or INC_APPEND_HISTORY
options are set.

} I still want to play a "don't lose data without trying to save it"
} card, but it seems I'm the only one playing cards of that suite.

History is only maintained for interactive shells, so you might get
more traction with an option to prompt the user to create the directory
and/or fix $HISTFILE when the file does not exist or is not writable.

