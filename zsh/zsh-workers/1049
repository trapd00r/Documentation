From wayne@tenor.clarinet.com Sat May 11 07:30:32 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id HAA28359 for <mason@werple.mira.net.au>; Sat, 11 May 1996 07:30:00 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id RAA21080; Fri, 10 May 1996 17:13:57 -0400 (EDT)
Resent-Date: Fri, 10 May 1996 17:13:57 -0400 (EDT)
Message-Id: <199605102112.OAA01273@tenor.clari.net>
To: Zefram <A.Main@dcs.warwick.ac.uk>
Cc: Z Shell workers mailing list <zsh-workers@math.gatech.edu>
Subject: Re: ZLE 8-bit patch 
In-reply-to: A.Main's message of Fri, 10 May 1996 10:39:17 +0100.
	     <23053.199605100939@stone.dcs.warwick.ac.uk> 
Date: Fri, 10 May 1996 14:12:47 -0700
From: Wayne Davison <wayne@tenor.clarinet.com>
Resent-Message-ID: <"fJ_vG.0.I95.L6xan"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1049
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 559
Status: O

Zefram writes:
> The i-search code is now a real mess.
> Someone should review/rewrite the code properly.

I'm fiddling with it now.  If anyone else is working on it, let me know.

Also, I discovered that your DEBUG code in zstrlen() isn't checking
the error condition correctly.  Here's a patch:

Index: utils.c
@@ -2936,11 +2936,12 @@
 
     for (l = 0; *s; l++)
 	if (*s++ == Meta) {
-	    s++;
 #ifdef DEBUG
 	    if (! *s)
 		fprintf(stderr, "BUG: unexpected end of string in ztrlen()\n");
+	    else
 #endif
+	    s++;
 	}
     return l;
 }

..wayne..


