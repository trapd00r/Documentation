From zsh-workers-return-27589-mason-zsh=primenet.com.au@zsh.org Mon Jan 11 07:03:39 2010
Return-Path: <zsh-workers-return-27589-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17186 invoked by alias); 11 Jan 2010 07:03:39 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27589
Received: (qmail 21159 invoked from network); 11 Jan 2010 07:03:27 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.1 required=5.0 tests=AWL,BAYES_00,
	DATE_IN_PAST_12_24 autolearn=no version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at benizi.com does not designate permitted sender hosts)
Date: Sun, 10 Jan 2010 13:12:33 -0500 (EST)
From: "Benjamin R. Haskell" <zsh@benizi.com>
To: Zsh Workers <zsh-workers@zsh.org>
Subject: Re: #compdef lines prevent X11 and init.d completion
In-Reply-To: <alpine.LNX.2.01.1001101051310.8115@hp.internal>
Message-ID: <alpine.LNX.2.01.1001101303150.8115@hp.internal>
References: <alpine.LNX.2.01.1001101051310.8115@hp.internal>
User-Agent: Alpine 2.01 (LNX 1266 2009-07-14)
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="-1463810530-1211027817-1263147153=:8115"

---1463810530-1211027817-1263147153=:8115
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Sun, 10 Jan 2010, Benjamin R. Haskell wrote:

> [...]
> 
> I frequently use <filename as a command unto itself, happily 
> tab-completing the whole of filename.  But, that line prevents me from 
> tab-completing into the /etc/X11 and /usr/share/X11 directories.
> 
> [...]
> 
> Seems like a bug to me -- not 100% sure where, so I figured I'd ping the 
> list before patching it myself.
> 

Making _redirect consider whether $CURRENT is 1 seems to solve the 
problem for me.  Might also make sense to test whether NULLCMD is set.  
Not sure if this would have other adverse effects, nor what the mention 
of 'ksharrays' in the man page might entail.

Patch attached.

Best,
Ben
---1463810530-1211027817-1263147153=:8115
Content-Type: TEXT/PLAIN; charset=US-ASCII; name=zsh-redirect.patch
Content-Transfer-Encoding: BASE64
Content-ID: <alpine.LNX.2.01.1001101312330.8115@hp.internal>
Content-Description: 
Content-Disposition: attachment; filename=zsh-redirect.patch

SW5kZXg6IENvbXBsZXRpb24vWnNoL0NvbnRleHQvX3JlZGlyZWN0DQo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvenNoL3pz
aC9Db21wbGV0aW9uL1pzaC9Db250ZXh0L19yZWRpcmVjdCx2DQpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuMw0KZGlmZiAtdSAtcjEuMyBfcmVkaXJlY3QNCi0t
LSBDb21wbGV0aW9uL1pzaC9Db250ZXh0L19yZWRpcmVjdAkxMyBNYXIgMjAw
MiAwOToyODowNSAtMDAwMAkxLjMNCisrKyBDb21wbGV0aW9uL1pzaC9Db250
ZXh0L19yZWRpcmVjdAkxMCBKYW4gMjAxMCAxODowODo1MCAtMDAwMA0KQEAg
LTYsMTEgKzYsMTMgQEANCiANCiBzdHJzPSggLWRlZmF1bHQtICkNCiANCi1p
ZiBbWyAtbiAiJF9jb21wX2NvbW1hbmQxIiBdXTsgdGhlbg0KLSAgc3Rycz0o
ICIke19jb21wX2NvbW1hbmQxfSIgIiRzdHJzW0BdIiApDQotICBbWyAtbiAi
JF9jb21wX2NvbW1hbmQyIiBdXSAmJg0KK2lmIFtbICIkQ1VSUkVOVCIgIT0g
IjEiIF1dOyB0aGVuDQorICBzdHJzPSggIiR7X2NvbXBfY29tbWFuZH0iICIk
c3Ryc1tAXSIgKQ0KKyAgaWYgW1sgLW4gIiRfY29tcF9jb21tYW5kMSIgXV07
IHRoZW4NCisgICAgc3Rycz0oICIke19jb21wX2NvbW1hbmQxfSIgIiRzdHJz
W0BdIiApDQorICAgIFtbIC1uICIkX2NvbXBfY29tbWFuZDIiIF1dICYmDQog
ICAgICAgc3Rycz0oICIke19jb21wX2NvbW1hbmQyfSIgIiRzdHJzW0BdIiAp
DQorICBmaQ0KIGZpDQogDQotX2Rpc3BhdGNoIC1yZWRpcmVjdC0sJHtjb21w
c3RhdGVbcmVkaXJlY3RdfSwke19jb21wX2NvbW1hbmR9IFwNCi0gICAgICAg
ICAgLXJlZGlyZWN0LSx7JHtjb21wc3RhdGVbcmVkaXJlY3RdfSwtZGVmYXVs
dC19LCR7XnN0cnN9DQorX2Rpc3BhdGNoIC1yZWRpcmVjdC0seyR7Y29tcHN0
YXRlW3JlZGlyZWN0XX0sLWRlZmF1bHQtfSwke15zdHJzfQ0K

---1463810530-1211027817-1263147153=:8115--

