From zsh-workers-request@math.gatech.edu Tue Jun 23 20:41:27 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15811 invoked from network); 23 Jun 1998 20:41:26 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 23 Jun 1998 20:41:26 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id QAA00252;
	Tue, 23 Jun 1998 16:37:08 -0400 (EDT)
Resent-Date: Tue, 23 Jun 1998 16:33:49 -0400 (EDT)
To: "Bart Schaefer" <schaefer@brasslantern.com>
Cc: zsh-users@math.gatech.edu
Subject: Re: zsh exits suddenly.
References: <rsqbtrkw50q.fsf@is27e1s03.jaist.ac.jp>
 <980623112518.ZM375@candle.brasslantern.com>
X-Emacs: Emacs 20.2, MULE 3.0 (MOMIJINOGA)
Mime-Version: 1.0 (generated by SEMI 1.5.3 - "Uozu")
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 24 Jun 1998 05:35:05 +0900
In-Reply-To: "Bart Schaefer"'s message of "Tue, 23 Jun 1998 11:25:17 -0700"
Message-Id: <rsq7m27x3eu.fsf@is27e1s03.jaist.ac.jp>
Lines: 26
X-Mailer: Semi-gnus 6.4.0 (based on Gnus 5.6.11; for SEMI 1.5)
Resent-Message-ID: <"0UUny2.0.LK7.i41ar"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1647
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

In article <980623112518.ZM375@candle.brasslantern.com>,
  "Bart Schaefer" <schaefer@brasslantern.com> writes:

> I finally figured out where that's happening -- it's in ing%tc(), which
> is called from the SIGINT handler() via inerrflush().  However, I still
> don't know how to fix the problem.

Why following fix is wrong?

------------------------------------------------------------
--- signals.c.org	Wed Jun 24 04:38:45 1998
+++ signals.c	Wed Jun 24 04:40:24 1998
@@ -479,6 +479,7 @@
                 breaks = loops;
                 errflag = 1;
 		inerrflush();
+                lexstop = 0;
             }
         }
         break;
------------------------------------------------------------

Although I found that setopt ignoreeof prevents exiting zsh suddenly
in exchange for annoying errors...
-- 
[Tanaka Akira]

