From zsh-workers-request@math.gatech.edu Fri May 15 09:33:09 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22839 invoked from network); 15 May 1998 09:33:07 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 15 May 1998 09:33:07 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id FAA04327;
	Fri, 15 May 1998 05:17:06 -0400 (EDT)
Resent-Date: Fri, 15 May 1998 05:17:06 -0400 (EDT)
Mail-Copies-To: steve@xemacs.org
To: zsh-workers@math.gatech.edu
Subject: Another zsh 3.1 bug -- localization?
X-Face: (:YAD@JS'&Kz'M}n7eX7gEvPR6U1mJ-kt;asEc2qAv;h{Yw7ckz<7+X_SYeTNAaPui:e~x$
 ,A=gkt*>UPL/}\a/#C~v2%ETiAY_sx;xve0yL??JWTtX_-NUzXyP38UdW#cmN1\4(X!c3m#%IbtB-3
 Z-!xpZi!`E.s{(;aP=b11"!3wQu]1j@^V|;n=B|{l<bZV1.AI`zWV%kPCnUhcgEe\(}/_kNd6,*3ZJ
 Q3o<YQ3^u;7jS=:p0--u3msQO
X-Attribution: sb
From: SL Baur <steve@xemacs.org>
Mime-Version: 1.0 (generated by tm-edit 7.108)
Content-Type: text/plain; charset=US-ASCII
Date: 15 May 1998 02:19:50 -0700
Message-ID: <m2yaw3x555.fsf@altair.xemacs.org>
Lines: 26
X-Mailer: Gnus v5.6.9/XEmacs 21.0(beta40) - "Saanen-pre3"
Resent-Message-ID: <"_JkVR2.0.Y31.IW0Nr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3976
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

I've tested this now on zsh 3.1.2 and zsh 3.1.3 Linux libc5 and GNU
libc.  It does not occur in zsh 3.0.4 or zsh 3.0.5.  It reproduces
reliably for me in a new zsh-3.1.3 (without the `unset CDPATH'
bugfix).  The machine I'm running on is localizable to the extent that
`LANG=ja' is able to programs that need Japanese input and display
Japanese output.

$ Src/zsh
$ LC_ALL=C; export LC_ALL; LANC=C; export LANG; date
zsh: 30841 segmentation fault (core dumped)  Src/zsh

[The misspelling of LANC=C is deliberate and duplicates the typo in
the GNU Awk 3.0.3 package].

The stack backtrace is cryptic:

$ LC_ALL=C; export LC_ALL; LANC=C; export LANG
# the previous step requires me to be running zsh-3.0
$ gdb src/Zsh 
(gdb) run -c date
Starting program: /usr/local/src/bin/zsh-3.1.3/Src/zsh -c date
Program received signal SIGTRAP, Trace/breakpoint trap.
0x400009d0 in lastmailcheck ()
(gdb) where
#0  0x400009d0 in lastmailcheck ()
Cannot access memory at address 0x80ad2f0.

