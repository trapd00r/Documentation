From zsh-workers-return-15460-mason-zsh=primenet.com.au@sunsite.dk Mon Jul 23 16:34:02 2001
Return-Path: <zsh-workers-return-15460-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27099 invoked from network); 23 Jul 2001 16:34:01 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 23 Jul 2001 16:34:01 -0000
Received: (qmail 21400 invoked by alias); 23 Jul 2001 16:33:53 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15460
Received: (qmail 21387 invoked from network); 23 Jul 2001 16:33:52 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010723163143.ZM13997@candle.brasslantern.com>
Date: Mon, 23 Jul 2001 16:31:43 +0000
In-Reply-To: <m2y9phybno.fsf@freebie.phydeaux.org>
Comments: In reply to Fletch <fletch@phydeaux.org>
        "Where to add extra libraries for modules" (Jul 21,  9:50pm)
References: <m2y9phybno.fsf@freebie.phydeaux.org>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: Re: Where to add extra libraries for modules
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jul 21,  9:50pm, Fletch wrote:
} 
}         I've all but got my perl-in-zsh module working with 4.0.2
} again, but I've got an issue with where I should be adding in the
} commands to link against the perl libraries.
} 
}         Would it make sense (possibly) to add an `extralibs' paramter
} in the .mdd and then have mkmakemod.sh include that in the rule for
} module.$(DL_EXT)?

We had a short discussion about this back when termcap/terminfo became
modules.  The above would work for Perl, I think, but it won't work for
new modules in general -- the difficult bit comes when some sort of
configure-time testing is needed in order to detect the availability or
local install location of such extra libraries.  At this point there's
nowhere other than zsh's configure script where such tests can be added.

Another question is whether `extralibs' is enough.  Do we need separate
entries for dynamic v. static?  (And is `extralibs' the best name?)

One possibility would be to have `extralibs' or whatever, be an eval'd
value like `link' is.  It'd be evaluated at configure time and then the
result would be copied into config.modules.  We'd have to fix parsing
of that file to permit multiple libraries -- currently in every name=val
pair except the last on the line (`functions'), val has to be exactly
one word.

Then there's the additional question, which someone raised earlier, of
being able to compile zsh modules independently of compiling the shell
itself.  At present I think this would require installing all the .epro
files in an include directory (/usr/local/include/zsh/$(VERSION)/ ?) and
also makepro.awk, mkmakemod.sh, and the generated Makemod (or a subset
of it) somewhere.  What other files am I forgetting?

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

