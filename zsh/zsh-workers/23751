From zsh-workers-return-23751-mason-zsh=primenet.com.au@sunsite.dk Sun Aug 12 09:01:14 2007
Return-Path: <zsh-workers-return-23751-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15626 invoked from network); 12 Aug 2007 09:01:12 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.1
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Aug 2007 09:01:12 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 20770 invoked from network); 12 Aug 2007 09:01:06 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Aug 2007 09:01:06 -0000
Received: (qmail 15646 invoked by alias); 12 Aug 2007 09:01:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23751
Received: (qmail 15636 invoked from network); 12 Aug 2007 09:01:02 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 12 Aug 2007 09:01:02 -0000
Received: (qmail 20440 invoked from network); 12 Aug 2007 09:01:02 -0000
Received: from flock1.newmail.ru (82.204.219.207)
  by a.mx.sunsite.dk with SMTP; 12 Aug 2007 09:00:59 -0000
Received: (qmail 18097 invoked from network); 12 Aug 2007 09:00:58 -0000
Received: from unknown (HELO cooker.net) (arvidjaar@newmail.ru@85.141.134.237)
  by smtpd.newmail.ru with SMTP; 12 Aug 2007 09:00:58 -0000
From: Andrey Borzenkov <arvidjaar@newmail.ru>
To: zsh-workers@sunsite.dk
Subject: [PATCH] support module file too
User-Agent: KMail/1.9.7
MIME-Version: 1.0
Date: Sun, 12 Aug 2007 13:00:56 +0400
Content-Type: multipart/signed;
  boundary="nextPart5921832.q2smy9y1ef";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200708121300.57257.arvidjaar@newmail.ru>

--nextPart5921832.q2smy9y1ef
Content-Type: multipart/mixed;
  boundary="Boundary-01=_JxsvGxcYYlfluhC"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

--Boundary-01=_JxsvGxcYYlfluhC
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

modinfo/modprobe will check for local file in addition to centrally install=
ed=20
modules

=2Dandrey

--Boundary-01=_JxsvGxcYYlfluhC
Content-Type: text/x-diff;
  charset="us-ascii";
  name="_modutils.diff"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline;
	filename="_modutils.diff"

Index: Completion/Linux/Command/_modutils
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
RCS file: /cvsroot/zsh/zsh/Completion/Linux/Command/_modutils,v
retrieving revision 1.5
diff -u -p -r1.5 _modutils
=2D-- Completion/Linux/Command/_modutils	10 Dec 2004 16:05:51 -0000	1.5
+++ Completion/Linux/Command/_modutils	12 Aug 2007 08:36:23 -0000
@@ -74,7 +74,11 @@ case "$state" in
=20
   all_modules)
     modules=3D( ${${${${(f)"$(_call_program modules ${(M)words[1]##*/}modp=
robe -l 2>/dev/null)"}:#}##*/}%%.*} )
=2D    _wanted modules expl module compadd -a modules && return
+    _tags files modules
+    while _tags; do
+      _requested files expl "module file"  _files && ret=3D0
+      _requested modules expl module compadd -a modules && ret=3D0
+    done
   ;;
=20
   params)

--Boundary-01=_JxsvGxcYYlfluhC--

--nextPart5921832.q2smy9y1ef
Content-Type: application/pgp-signature; name=signature.asc 
Content-Description: This is a digitally signed message part.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (GNU/Linux)

iD8DBQBGvsxJR6LMutpd94wRAvQmAJwLHSvsrp/9SJZDR2fwqSLKAZvcTwCgzX7U
XwMCt9dsfkZN2m/8nM12pn0=
=gpzE
-----END PGP SIGNATURE-----

--nextPart5921832.q2smy9y1ef--

