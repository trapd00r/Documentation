From zsh-users-return-12252-mason-zsh=primenet.com.au@sunsite.dk Tue Nov 27 09:57:39 2007
Return-Path: <zsh-users-return-12252-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19885 invoked from network); 27 Nov 2007 09:57:30 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 27 Nov 2007 09:57:30 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 31105 invoked from network); 27 Nov 2007 09:57:24 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Nov 2007 09:57:24 -0000
Received: (qmail 12372 invoked by alias); 27 Nov 2007 09:57:08 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12252
Received: (qmail 12353 invoked from network); 27 Nov 2007 09:57:07 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 27 Nov 2007 09:57:07 -0000
Received: (qmail 29716 invoked from network); 27 Nov 2007 09:57:07 -0000
Received: from cluster-d.mailcontrol.com (217.69.20.190)
  by a.mx.sunsite.dk with SMTP; 27 Nov 2007 09:57:01 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly38d.srv.mailcontrol.com (MailControl) with ESMTP id lAR9usra030358
	for <zsh-users@sunsite.dk>; Tue, 27 Nov 2007 09:56:55 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 27 Nov 2007 09:56:53 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.1/8.13.4) with ESMTP id lAR9urhU020649
	for <zsh-users@sunsite.dk>; Tue, 27 Nov 2007 09:56:53 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.1/8.14.1/Submit) with ESMTP id lAR9ur36020646
	for <zsh-users@sunsite.dk>; Tue, 27 Nov 2007 09:56:53 GMT
Message-Id: <200711270956.lAR9ur36020646@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: ZSH User List <zsh-users@sunsite.dk>
Subject: Re: matcher-list question
In-reply-to: <20071127084203.GA4034@spiegl.de>
References: <20071119160702.GB29766@spiegl.de> <20071127084203.GA4034@spiegl.de>
Comments: In-reply-to Andy Spiegl <zsh.Andy@spiegl.de>
   message dated "Tue, 27 Nov 2007 09:42:03 +0100."
Date: Tue, 27 Nov 2007 09:56:53 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 27 Nov 2007 09:56:53.0753 (UTC) FILETIME=[D6AA8690:01C830DB]
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.68.0.148

Andy Spiegl wrote:
> > How can I avoid this behaviour?
> > lama:~>zsh -f
> > lama% autoload -U compinit; compinit -C
> > lama% zstyle ":completion:*" matcher-list 'r:|[-./_]=* r:|=*' '+l:|=*'
> > lama% ls         
> > foo-bar-abc  foo-bar-def  foo-bar-geh
> > lama% ls bar<TAB>
> > lama% ls -foobar-
> > 
> > I'd really prefer:
> > lama% ls bar<TAB>
> > lama% ls foo-bar-
>
> Hm, nobody seems to know an answer...
> Does that mean, it is not avoidable at all?

There's a bug somewhere in the code that assembles partial lines using
matching in this fashion (the code that generates the lists seems to be
OK, or at least the list of matches is correct).  Unfortunately, I've
been watching the entrance to that piece of code carefully and nobody
has emerged alive from it in several years.

On the bright side, this is about the purest form of it I've yet seen,
so it might help in tracking it down if anybody has a spare week or two.

You can help matters by typing the initial "f-" yourself, which seems
to deconfuse it (and is probably another clue to what's going on).
Also, turning on menu completion seems to help.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

