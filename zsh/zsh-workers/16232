From zsh-workers-return-16232-mason-zsh=primenet.com.au@sunsite.dk Sat Nov 10 02:27:58 2001
Return-Path: <zsh-workers-return-16232-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17872 invoked from network); 10 Nov 2001 02:27:57 -0000
Received: from ns2.primenet.com.au (HELO primenet.com.au) (?bAGNx+19tHHIS8vJZJNw7VE8W4daK7xF?@203.24.36.3)
  by ns1.primenet.com.au with SMTP; 10 Nov 2001 02:27:57 -0000
Received: (qmail 3040 invoked from network); 10 Nov 2001 02:27:55 -0000
Received: from sunsite.dk (130.225.247.90)
  by proxy.melb.primenet.com.au with SMTP; 10 Nov 2001 02:27:55 -0000
Received: (qmail 25408 invoked by alias); 10 Nov 2001 02:27:48 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16232
Received: (qmail 25397 invoked from network); 10 Nov 2001 02:27:47 -0000
Sender: ethersoft@rcn.com
To: zsh-workers@sunsite.dk
Subject: typeset -U within a function
From: Vin Shelton <acs@alumni.princeton.edu>
Organization: EtherSoft, Inc
Date: 09 Nov 2001 21:29:55 -0500
Message-ID: <m2snbn73z0.fsf@zion.rcn.com>
Lines: 37
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

>From either zsh-4.0.4 or from the latest CVS sources, when I create a
function like this:

function bar {
  typeset -U PATH
  PATH=/xxx:/yyy
}

and then run it, PATH is unchanged:

  zion% /usr/local/zsh-4.0.4/bin/zsh -f
  zion% function bar {
  function> typeset -U PATH
  function> PATH=/xxx:/yyy
  function> }
  zion% echo $PATH
  /home/acs/bin:/usr/local/bin:/usr/X11R6/bin:/bin:/usr/bin:/etc
  zion% bar
  zion% echo $PATH
  /home/acs/bin:/usr/local/bin:/usr/X11R6/bin:/bin:/usr/bin:/etc

If I remove the 'typeset -U PATH' line (even if PATH already had been
'typeset -U' before entering the function), the value of PATH is
changed by the function bar:

  zion% function bar {
  function> PATH=/xxx:/yyy
  function> }
  zion% echo $PATH
  /home/acs/bin:/usr/local/bin:/usr/X11R6/bin:/bin:/usr/bin:/etc
  zion% bar
  zion% echo $PATH
  /xxx:/yyy


  - vin

