From hzoli@cs.elte.hu Fri Jun 21 09:26:19 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id JAA00702 for <mason@werple.mira.net.au>; Fri, 21 Jun 1996 09:26:17 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id TAA22060; Thu, 20 Jun 1996 19:18:47 -0400 (EDT)
Resent-Date: Thu, 20 Jun 1996 19:18:47 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199606202309.BAA01474@hzoli.ppp.cs.elte.hu>
Subject: signal handling bug
To: zsh-workers@math.gatech.edu (Zsh hacking and development)
Date: Fri, 21 Jun 1996 01:09:14 +0200 (MET DST)
X-Mailer: ELM [version 2.4ME+ PL17 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"hUlSW.0.ZO5.MnTon"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1392
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 725
Status: OR

Here is a strange bug:

% zsh -f
hzoli% trap 'echo interrupt' INT
hzoli% while true ; do ; done
<press ^C many times quickly (eg. with an auto-repeating keyboard)>
interrupt
interrupt
BUG: empty(args) in exec.c
zsh: 1459 segmentation fault (core dumped)  zsh -f

The empry args message is very strange.  It can only happen if the
interrupt handler changes the args list of the interrupted execcmd()
function somehow.

The core dump comes from dotrap() in signals.c line 712 where the arguments
of the trap is freed after execution because someone already free'd that
(zsh-mem-warning  notices this).  Sometimes there is no coredump but after
a few interrupts the shell blocks the INT signal and continues execution.

Zoltan


