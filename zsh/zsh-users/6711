From zsh-users-return-6711-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 15 19:26:55 2003
Return-Path: <zsh-users-return-6711-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17216 invoked from network); 15 Oct 2003 19:26:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 15 Oct 2003 19:26:54 -0000
Received: (qmail 661 invoked by alias); 15 Oct 2003 19:26:18 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6711
Received: (qmail 607 invoked from network); 15 Oct 2003 19:26:17 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 15 Oct 2003 19:26:17 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [216.27.138.216] by sunsite.dk (MessageWall 1.0.8) with SMTP; 15 Oct 2003 19:26:17 -0000
Received: from home.acholado.net (localhost.localdomain [127.0.0.1])
	by home.acholado.net (8.12.8/8.12.8) with ESMTP id h9FJQGWp029524
	for <zsh-users@sunsite.dk>; Wed, 15 Oct 2003 15:26:16 -0400
Received: (from ljz@localhost)
	by home.acholado.net (8.12.8/8.12.8/Submit) id h9FJQGRw029522;
	Wed, 15 Oct 2003 15:26:16 -0400
X-Authentication-Warning: home.acholado.net: ljz set sender to ljz@asfast.com using -f
To: zsh-users@sunsite.dk
Subject: Incomplete completion for w3m under 4.1.1
From: Lloyd Zusman <ljz@asfast.com>
Reply-To: ljz@asfast.com
Date: Wed, 15 Oct 2003 15:26:16 -0400
Message-ID: <m3u16afgkn.fsf@asfast.com>
User-Agent: Gnus/5.1003 (Gnus v5.10.3) Emacs/21.2 (gnu/linux)
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="=-=-="
Sender: Lloyd Zusman <ljz@asfast.com>


--=-=-=

The zsh-4.1.1 completion specification for the 'w3m' program
(specification attached) is incomplete.  It will only try to complete
the final argument if it's some sort of URL.  For example ..

  w3m [ -options ] http://some.url.goes.here

However, w3m can also properly be used in the following way:

  w3m file.html

... where 'file.html' is a file on disk that I want to view.  However,
zsh is not completing these cases.

How can the _w3m completion spec be changed so that both kinds of values
can validly be completed for the final argument? ... or at least so
that I can cause it to switch between the two types of completion
with some sort of keystroke.    Thanks in advance.


--=-=-=
Content-Disposition: attachment; filename=_w3m
Content-Description: zsh-4.1.1 _w3m

#compdef w3m

local curcontext="$curcontext" state line
typeset -A opt_args

_arguments -C \
  '-t[tabwidth]:tabwidth:' \
  '-r[ignore backspace effect]' \
  '-l[preserved lines]:number of lines:' \
  '-B[load bookmark]' \
  '-bookmark:bookmark file:_files' \
  '-T[content-type]:content type:' \
  '-m[internet message mode]' \
  '-v[visual startup mode]' \
  '-M[monochrome display]' \
  '-F[automatically render frame]' \
  '(-dump_source -dump_head)-dump' \
  '-cols:column width:' \
  '(-dump -dump_head)-dump_source' \
  '(-dump -dump_source)-dump_head' \
  '+:goto line:' \
  '-num[show line number]' \
  '-no-proxy' \
  '-no-mouse' \
  '(-no-cookie)-cookie' \
  '(-cookie)-no-cookie' \
  '-no-graph' \
  '-S[squeeze multiple blank lines]' \
  '-W[toggle wrap search mode]' \
  '-X[do not use termcap init/deinit]' \
  '-o[option]:option-value:' \
  '-config:config file:_files' \
  '-debug' \
  ':url:->url' && return 0

case $state in
	url)
	local _w3mhistory

	if [[ -s ~/.w3m/history ]]; then
	   _w3mhistory=(${(f)"$(<$HOME/.w3m/history)"})
	   compadd $_w3mhistory
	fi

	_urls -f
	;;

esac

--=-=-=



-- 
 Lloyd Zusman
 ljz@asfast.com

--=-=-=--

