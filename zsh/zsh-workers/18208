From zsh-workers-return-18208-mason-zsh=primenet.com.au@sunsite.dk Sun Feb 09 01:41:19 2003
Return-Path: <zsh-workers-return-18208-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17745 invoked from network); 9 Feb 2003 01:41:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 9 Feb 2003 01:41:17 -0000
Received: (qmail 4049 invoked by alias); 9 Feb 2003 01:41:02 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18208
Received: (qmail 4042 invoked from network); 9 Feb 2003 01:41:02 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 9 Feb 2003 01:41:02 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [207.99.30.4] by sunsite.dk (MessageWall 1.0.8) with SMTP; 9 Feb 2003 1:41:1 -0000
Received: from acolyte.scowler.net (localhost [127.0.0.1])
	by acolyte.scowler.net (8.12.6/8.12.6/Debian-7) with ESMTP id h191f2Re016756
	(version=TLSv1/SSLv3 cipher=EDH-RSA-DES-CBC3-SHA bits=168 verify=OK);
	Sat, 8 Feb 2003 20:41:03 -0500
Received: (from clint@localhost)
	by acolyte.scowler.net (8.12.6/8.12.6/Debian-7) id h191f2vA016754;
	Sat, 8 Feb 2003 20:41:02 -0500
X-Authentication-Warning: acolyte.scowler.net: clint set sender to clint@zsh.org using -f
Date: Sat, 8 Feb 2003 20:41:02 -0500
From: Clint Adams <clint@zsh.org>
To: zsh-workers@sunsite.dk
Cc: 180306-forwarded@bugs.debian.org
Subject: Re: PATCH: maxfilelocks in ulimit output
Message-ID: <20030209014102.GA15743@scowler.net>
References: <20030209010655.GA10509@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20030209010655.GA10509@dman.com>
User-Agent: Mutt/1.4i

% ulimit
cpu time (seconds)         unlimited
file size (blocks)         unlimited
data seg size (kbytes)     unlimited
stack size (kbytes)        8192
core file size (blocks)    0
unlimited
processes                  1023
file descriptors           1024
locked-in-memory size (kb) unlimited
memory size (kb)           unlimited
unlimited

This is in glibc 2.3/linux, which

#define RLIMIT_RSS  5               /* max resident set size */
#define RLIMIT_AS   9               /* address space limit */


RLIMIT_VMEM is undefined, so Src/system.h defines it as RLIMIT_AS.

Thus,

# if defined(RLIMIT_RSS) && (!defined(RLIMIT_VMEM) || RLIMIT_VMEM != RLIMIT_RSS)

should be true,

and

#  if defined(RLIMIT_RSS) && RLIMIT_VMEM == RLIMIT_RSS

should be false, thereby printing "resident set size (kbytes) " and
"virtual memory size (kb) " respectively.

Yet the opposite seems to be occurring.  What am I missing?

