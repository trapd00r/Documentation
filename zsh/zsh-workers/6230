From zsh-workers-return-6230-mason-zsh=primenet.com.au@sunsite.auc.dk Fri May 07 08:58:33 1999
Return-Path: <zsh-workers-return-6230-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15474 invoked from network); 7 May 1999 08:58:31 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 May 1999 08:58:31 -0000
Received: (qmail 8979 invoked by alias); 7 May 1999 08:58:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6230
Received: (qmail 8969 invoked from network); 7 May 1999 08:58:20 -0000
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: "Peter Stephenson" <pws@ibmth.df.unipi.it>,
        "Zsh hackers list" <zsh-workers@sunsite.auc.dk>
Subject: Possible impact of RE: PATCH: large file support on SunOS 5
Date: Fri, 7 May 1999 12:57:39 +0400
Message-ID: <006a01be9867$a8b43b70$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2314.1300
Importance: Normal
In-Reply-To: <9905061523.AA21545@ibmth.df.unipi.it>


The LFS_CFLAGS (or, for that matter, LFS64_CFLAGS) make the off_t and ino_t
64 bit long. Dunno about Solaris, but at least on our system they are of
type "long long" and there is no standard portable way to print 64 bit
integers (if sizeof(long) < 8). Our system is using %lld; Solaris is using
%qd if I'm not wrong.

This has impact at least on stat module (and possibly others) that print
file size and inode. It has possible impact on zftp module that has to
correctly count transferred bytes (and our ftp is able to transfer more than
2GB - I'd expect it from zftp as well).  And may be some others.

What I want to say - it is not enough to simply compile a program with
correct flags - program must be able to correctly handle large files.

Can anybody who knows zsh internals better confirm, that zsh is really able
to handle large files?

/andrej

P.S. I am running zsh in LP64 mode for quite a long time. This is different,
as in this case all of off_t, ino_t and long are 8 bytes, so nothing in the
code changes. May be, if a system supports LP64 we should prefer it to LFS?

