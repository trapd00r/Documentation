From zsh-workers-return-14859-mason-zsh=primenet.com.au@sunsite.dk Tue Jun 12 12:25:33 2001
Return-Path: <zsh-workers-return-14859-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23001 invoked from network); 12 Jun 2001 12:25:32 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 12 Jun 2001 12:25:32 -0000
Received: (qmail 16731 invoked by alias); 12 Jun 2001 12:25:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14859
Received: (qmail 16693 invoked from network); 12 Jun 2001 12:25:03 -0000
X-VirusChecked: Checked
Sender: kiddleo@cav.logica.co.uk
Message-ID: <3B260A14.23330A7B@u.genie.co.uk>
Date: Tue, 12 Jun 2001 13:24:52 +0100
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.2.15 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: Timothy Miller <tsm@cs.brown.edu>
CC: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>, zsh-workers@sunsite.dk,
        tjaalton@cc.hut.fi
Subject: Re: AIX-problem: the main module won't link statically
References: <001d01c0f0c1$83ed8670$21c9ca95@mow.siemens.ru> <yehk82jugj3.fsf@water.cs.brown.edu>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Timothy Miller wrote:

> Updated `stamp-modobjs'.
> rm -f libzsh-4.0.1.so
> gcc  -s  -o libzsh-4.0.1.so  `cat stamp-modobjs` -ldl -lcurses -lm  -lc

It is still trying to link a libzsh so I suspect that the
zsh_SYS_DYNAMIC_EXECSYMS test is going wrong, possibly because the test
it does is trying to use the dl* functions. Timothy: could you please
try changing the `L=L' line somewhere in configure to `L=N'. Keep
Andrej's patch in and then try another build (after a `make distclean'
or whatever to clean things up).

Andrej wrote:
> Oliver, is it possible to compile zsh with gcc on AIX? I understand,
> currently it is assumed that we use native compiler. Or does gcc support
> the same options as native compiler?

I never tried it. The AIX machines were on an isolated network so I'd
have had to split gcc across a pile of floppies to get it over which I
never felt inclined to do. What I can tell you is that gcc would not
support the same options as the native compiler. For example, I expect
that to achieve the -L option which Timothy described in 14825, it would
need something like -Wl,-rpath,/cs/lib/zsh.

> But the second branch is never executed for AIX. Anybody remembers what's
> going on here? What DLLDFLAGS are needed on AIX? Oliver, what have you
> used?

I wish I could remember that. I don't particularly recognise "-G
-bexportall". You can try looking through the ld documentation which is
at
http://www.rs6000.ibm.com/doc_link/en_US/a_doc_lib/cmds/aixcmds3/ld.htm
but they don't seem to have the compiler's documentation there.

Oliver

_____________________________________________________________________
This message has been checked for all known viruses by the 
MessageLabs Virus Scanning Service. For further information visit
http://www.messagelabs.com/stats.asp

