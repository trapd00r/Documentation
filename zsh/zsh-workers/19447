From zsh-workers-return-19447-mason-zsh=primenet.com.au@sunsite.dk Thu Feb 19 10:35:21 2004
Return-Path: <zsh-workers-return-19447-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9771 invoked from network); 19 Feb 2004 10:35:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 19 Feb 2004 10:35:19 -0000
Received: (qmail 16789 invoked by alias); 19 Feb 2004 10:35:13 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19447
Received: (qmail 16742 invoked from network); 19 Feb 2004 10:35:13 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 19 Feb 2004 10:35:13 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [63.249.88.2] by sunsite.dk (MessageWall 1.0.8) with SMTP; 19 Feb 2004 10:35:12 -0000
Received: by binome.blorf.net (Postfix, from userid 1000)
	id 0F027FBB0; Thu, 19 Feb 2004 02:35:12 -0800 (PST)
Date: Thu, 19 Feb 2004 02:35:12 -0800
From: Wayne Davison <wayned@users.sourceforge.net>
To: zsh-workers@sunsite.dk
Subject: Missing ERR define
Message-ID: <20040219103511.GC26450@blorf.net>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="p4qYPpj5QlsIQJ0K"
Content-Disposition: inline
User-Agent: Mutt/1.5.5.1+cvs20040105i


--p4qYPpj5QlsIQJ0K
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

I'm compiling zsh on a debian sarge system without using the curses
libraries (i.e. I'm not specifying --with-curses-terminfo).  This setup
skips the check for curses.h.  Unfortunately, that means that ERR does
not get defined (since it is only found in curses.h and ncurses.h on my
system), and thus the compiling of Src/Modules/terminfo.c fails.

The attached patch defines ERR to -1 if it is not already defined.  Is
this the right way to deal with this?

..wayne..

--p4qYPpj5QlsIQJ0K
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="zsh-err.patch"

--- Src/Modules/terminfo.c	14 Sep 2003 05:10:09 -0000	1.22
+++ Src/Modules/terminfo.c	19 Feb 2004 10:16:06 -0000
@@ -50,6 +50,9 @@ static char terminfo_nam[] = "terminfo";
 # ifdef HAVE_TERM_H
 #  include <term.h>
 # endif
+# ifndef ERR
+#  define ERR (-1)
+# endif
 
 static Param terminfo_pm;
 

--p4qYPpj5QlsIQJ0K--

