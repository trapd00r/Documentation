From zsh-users-return-9650-mason-zsh=primenet.com.au@sunsite.dk Sun Nov 06 03:44:23 2005
Return-Path: <zsh-users-return-9650-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24095 invoked from network); 6 Nov 2005 03:44:20 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 6 Nov 2005 03:44:20 -0000
Received: (qmail 14521 invoked from network); 6 Nov 2005 03:44:14 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 6 Nov 2005 03:44:14 -0000
Received: (qmail 24352 invoked by alias); 6 Nov 2005 03:44:04 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9650
Received: (qmail 24342 invoked from network); 6 Nov 2005 03:44:03 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 6 Nov 2005 03:44:03 -0000
Received: (qmail 13468 invoked from network); 6 Nov 2005 03:44:03 -0000
Received: from main.gmane.org (HELO ciao.gmane.org) (80.91.229.2)
  by a.mx.sunsite.dk with SMTP; 6 Nov 2005 03:44:00 -0000
Received: from list by ciao.gmane.org with local (Exim 4.43)
	id 1EYbRn-0005Oo-1A
	for zsh-users@sunsite.dk; Sun, 06 Nov 2005 04:43:59 +0100
Received: from hippo.e-hippo.net ([216.182.10.250])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Sun, 06 Nov 2005 04:43:58 +0100
Received: from ljz by hippo.e-hippo.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Sun, 06 Nov 2005 04:43:58 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-users@sunsite.dk
From:  Lloyd Zusman <ljz@asfast.com>
Subject:  Re: Forcing expansion without explicit eval nor a subshell?
Date:  Sat, 05 Nov 2005 22:40:53 -0500
Lines: 62
Message-ID:  <m3acgimoje.fsf@asfast.com>
References:  <m364r73fpp.fsf@asfast.com>
	<1051105195640.ZM24493@candle.brasslantern.com>
	<m3d5lezwu7.fsf@asfast.com>
	<1051105213315.ZM24679@candle.brasslantern.com>
	<m33bmaycil.fsf@asfast.com>
	<1051106030216.ZM25909@candle.brasslantern.com>
Mime-Version:  1.0
Content-Type:  text/plain; charset=us-ascii
X-Complaints-To: usenet@sea.gmane.org
X-Gmane-NNTP-Posting-Host: hippo.e-hippo.net
User-Agent: Gnus/5.110004 (No Gnus v0.4) Emacs/21.4 (gnu/linux)
Cancel-Lock: sha1:GKKShDiITXtFtR3V6tMZkcsVWEE=
Sender: news <news@sea.gmane.org>
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.0.4

Bart Schaefer <schaefer@brasslantern.com> writes:

> On Nov 5,  5:07pm, Lloyd Zusman wrote:
> }
> } I can't figure out how to do the nesting stuff using arrays, without
> } things getting rather complex.
>
> You do end up needing one array for each level of nesting.
>
> E.g.:
>
>     yumargs=( --disablerepo='${(e)^disablerepos}' )
>     disablerepos=( dag '${(e)^livnarepos' )
>     livnarepos=( livna{,-updates,-extras,-testing} )
>
>     yum ${(e)yumargs}
>
> This corresponds to your example
>
>     yum --disablerepo={dag,livna{,-updates,-extras,-testing}}
>
> The extra arrays are the price you pay for wanting to avoid defining
> e.g. $livnarepos until the last minute and also avoid eval.
>
> You might also ask yourself whether there's another way to get the end
> result that you want, such as writing a wrapper function around yum.

Thanks.

Well, after realizing that I have to use "eval" with brace expansion, I
went and wrote this wrapper function:

  function yum {
    eval /usr/bin/yum ${yumargs:-} '"$@"'
  }

... and I have these variables set:

  livna='livna{,-testing,-updates,-extras}'
  dag=dag
  dries=dries
  freshrpms=freshrpms
  newrpms=newrpms
  fedora='fedora-{core,extras}'

Then, I can do things like this:

  yumargs="--d={$dag,$livna}"  # --d is equivalent to --disablerepo
  yum update

This lets me change yumargs based on the availability of the
repositories, and then just issue normal "yum" commands.

And now I see how I can do pretty much the same thing with arrays.

Thanks again.


-- 
 Lloyd Zusman
 ljz@asfast.com
 God bless you.

