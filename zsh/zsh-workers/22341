From zsh-workers-return-22341-mason-zsh=primenet.com.au@sunsite.dk Mon Mar 13 19:12:04 2006
Return-Path: <zsh-workers-return-22341-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8150 invoked from network); 13 Mar 2006 19:12:00 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Mar 2006 19:12:00 -0000
Received: (qmail 6182 invoked from network); 13 Mar 2006 19:11:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Mar 2006 19:11:54 -0000
Received: (qmail 29694 invoked by alias); 13 Mar 2006 19:11:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22341
Received: (qmail 29685 invoked from network); 13 Mar 2006 19:11:50 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 13 Mar 2006 19:11:50 -0000
Received: (qmail 5906 invoked from network); 13 Mar 2006 19:11:50 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 13 Mar 2006 19:11:47 -0000
Received: from rly11c.srv.mailcontrol.com (localhost.localdomain [127.0.0.1])
	by rly11c.srv.mailcontrol.com (MailControl) with ESMTP id k2DJBAa4013484
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <zsh-workers@sunsite.dk>; Mon, 13 Mar 2006 19:11:10 GMT
Received: from submission.mailcontrol.com (submission.mailcontrol.com [212.158.48.250])
	by rly11c.srv.mailcontrol.com (MailControl) id k2DJAdGF012847
	for zsh-workers@sunsite.dk; Mon, 13 Mar 2006 19:10:39 GMT
Received: from exchange03.csr.com (uuk202166.uk.customer.alter.net [62.189.241.194])
	by rly11c-eth0.srv.mailcontrol.com (envelope-sender Peter.Stephenson@csr.com) (MIMEDefang) with ESMTP id k2DJAcPM012791; Mon, 13 Mar 2006 19:10:39 +0000 (GMT)
Received: from csr.com ([10.103.143.38]) by exchange03.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Mon, 13 Mar 2006 19:10:38 +0000
To: Francisco Borges <f.borges@rug.nl>,
        zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: installing zsh questions 
In-reply-to: <20060313181552.GA9806@let.rug.nl> 
References: <20060313181552.GA9806@let.rug.nl>
Date: Mon, 13 Mar 2006 19:10:39 +0000
From: Peter Stephenson <pws@csr.com>
Message-ID: <EXCHANGE03bpH71yEXU00015a4e@exchange03.csr.com>
X-OriginalArrivalTime: 13 Mar 2006 19:10:38.0829 (UTC) FILETIME=[D096C9D0:01C646D1]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-06-00-04 (www.mailcontrol.com) on 10.67.1.121

Francisco wrote:
> 2. There are executable scripts in Functions/Misc, however 'make
>    install' is installing them as non-executable files.

This should fix that particular problem, although some of the functions
in the archive that are also executable shouldn't be.  The paths for
things that run as scripts don't get fixed up, either, so this doesn't
necessarily make the rest run as executables anyway.  If we were going
to do it properly we would run sed on the #! line at the top of those
that run under zsh (there are some set to use /bin/sh).

Index: Makefile.in
===================================================================
RCS file: /cvsroot/zsh/zsh/Makefile.in,v
retrieving revision 1.14
diff -u -r1.14 Makefile.in
--- Makefile.in	20 Jul 2005 18:08:47 -0000	1.14
+++ Makefile.in	13 Mar 2006 19:05:39 -0000
@@ -87,6 +87,7 @@
 	  scriptdir="$(scriptdir)" \
 	  FUNCTIONS_SUBDIRS="$(FUNCTIONS_SUBDIRS)" \
 	  INSTALL_DATA="$(INSTALL_DATA)" \
+	  INSTALL_PROGRAM="$(INSTALL_PROGRAM)" \
 	  DESTDIR="$(DESTDIR)" VERSION="$(VERSION)" \
 	  $(SHELL) $(sdir_top)/Config/installfns.sh || exit 1; \
 	fi; \
Index: Config/installfns.sh
===================================================================
RCS file: /cvsroot/zsh/zsh/Config/installfns.sh,v
retrieving revision 1.12
diff -u -r1.12 installfns.sh
--- Config/installfns.sh	24 Jul 2005 03:15:26 -0000	1.12
+++ Config/installfns.sh	13 Mar 2006 19:05:39 -0000
@@ -45,6 +45,10 @@
       esac
     fi
     test -d $instdir || /bin/sh $sdir_top/mkinstalldirs $instdir || exit 1
-    $INSTALL_DATA $sdir_top/$file $instdir || exit 1
+    if test -x $sdir_top/$file; then
+	$INSTALL_PROGRAM $sdir_top/$file $instdir || exit 1
+    else
+	$INSTALL_DATA $sdir_top/$file $instdir || exit 1
+    fi
   fi
 done

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

