From zsh-workers-return-18086-mason-zsh=primenet.com.au@sunsite.dk Sun Jan 12 08:08:36 2003
Return-Path: <zsh-workers-return-18086-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1055 invoked from network); 12 Jan 2003 08:08:35 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 12 Jan 2003 08:08:35 -0000
Received: (qmail 4634 invoked by alias); 12 Jan 2003 08:08:30 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18086
Received: (qmail 4626 invoked from network); 12 Jan 2003 08:08:28 -0000
Date: Sun, 12 Jan 2003 00:08:26 -0800
From: Jos Backus <jos@catnook.com>
To: zsh-workers@sunsite.dk
Subject: [peter@FreeBSD.ORG: cvs commit: ports/shells/zsh Makefile ports/shells/zsh/files patch-Src::utils.c]
Message-ID: <20030112080848.GB83265@lizzy.catnook.com>
Reply-To: jos@catnook.com
Mail-Followup-To: zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.3i

Fyi: just saw this on freebsd-cvs-all. The patches:

===================================================================
RCS file: /home/ncvs/ports/shells/zsh/Makefile,v
retrieving revision 1.56
retrieving revision 1.57
diff -u -p -r1.56 -r1.57
--- ports/shells/zsh/Makefile	2002/09/17 14:58:44	1.56
+++ ports/shells/zsh/Makefile	2003/01/11 23:45:20	1.57
@@ -2,7 +2,7 @@
 # Date created:			11 Feb. 1995
 # Whom:				torstenb
 #
-# $FreeBSD: /home/ncvs/ports/shells/zsh/Makefile,v 1.56 2002/09/17 14:58:44 will Exp $
+# $FreeBSD: /home/ncvs/ports/shells/zsh/Makefile,v 1.57 2003/01/11 23:45:20 peter Exp $
 #
 
 PORTNAME=	zsh
@@ -32,7 +32,7 @@ ZSH_VER=	${PORTVERSION}
 ZSHFUNC_SUBDIR=	share/zsh/${ZSH_VER}/functions
 GNU_CONFIGURE=	yes
 CONFIGURE_ARGS=	--enable-zsh-mem --enable-zsh-secure-free --enable-dynamic \
-		--enable-maildir-support
+		--enable-maildir-support --with-curses-terminfo
 
 .if !defined(NOPORTDOCS)
 INSTALL_TARGET=	install install.html

--- Src/utils.c.orig    Wed Dec  4 19:39:01 2002
+++ Src/utils.c Wed Dec  4 19:39:18 2002
@@ -1093,4 +1093,5 @@
  * is unique, for use as a temporary file.      */
  
+extern char *_mktemp(char *);
 /**/
 mod_export char *

----- Forwarded message from Peter Wemm <peter@FreeBSD.ORG> -----

Date: Sat, 11 Jan 2003 15:45:20 -0800 (PST)
From: Peter Wemm <peter@FreeBSD.ORG>
To: cvs-committers@FreeBSD.ORG, cvs-all@FreeBSD.ORG
Subject: cvs commit: ports/shells/zsh Makefile ports/shells/zsh/files
         patch-Src::utils.c

peter       2003/01/11 15:45:20 PST

  Modified files:
    shells/zsh           Makefile 
  Added files:
    shells/zsh/files     patch-Src::utils.c 
  Log:
  Make zsh not segfault on ia64 due to a generic misconfiguration that
  just happens to be fatal there, and a coding botch.  The first problem is
  that it assumes a termcap interface (which is an emulation on freebsd),
  and provides its own terminfo wrappers around termcap..  so that's two
  avoidable translation layers... termcap file -> terminfo (libncurses) ->
  termcap API emulation (libncurses) -> terminfo (zsh emlulation).  zsh
  forgot to prototype the tiget* functions (which return pointers) so we
  have an integer (implicit declaration) being cast to a pointer which
  is fatal.  The second problem is that zsh tries to use _mktemp() to get
  around the __warn_references in our C library, but also neglects a
  prototype there and has the same fatal int/pointer problem.
  
  It is likely all the zsh* ports need these fixes.  A test compile on
  pluto1.freebsd.org will highlight the problem.
  
  I do not know why the packaging fails for ia64.  termcap.so and
  terminfo.so are not being built for some reason, this change doesn't
  solve that problem.
  
  Revision  Changes    Path
  1.57      +1 -1      ports/shells/zsh/Makefile
  1.1       +8 -0      ports/shells/zsh/files/patch-Src::utils.c (new)

To Unsubscribe: send mail to majordomo@FreeBSD.org
with "unsubscribe cvs-all" in the body of the message


----- End forwarded message -----

-- 
Jos Backus                       _/  _/_/_/      Sunnyvale, CA
                                _/  _/   _/
                               _/  _/_/_/
                          _/  _/  _/    _/
jos at catnook.com        _/_/   _/_/_/          require 'std/disclaimer'

