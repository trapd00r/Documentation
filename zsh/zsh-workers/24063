From zsh-workers-return-24063-mason-zsh=primenet.com.au@sunsite.dk Mon Nov 05 20:32:37 2007
Return-Path: <zsh-workers-return-24063-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17215 invoked from network); 5 Nov 2007 20:32:29 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 5 Nov 2007 20:32:29 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 34935 invoked from network); 5 Nov 2007 20:32:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 Nov 2007 20:32:23 -0000
Received: (qmail 15342 invoked by alias); 5 Nov 2007 20:32:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24063
Received: (qmail 14084 invoked from network); 5 Nov 2007 20:30:39 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 Nov 2007 20:30:39 -0000
Received: (qmail 34175 invoked from network); 5 Nov 2007 20:30:38 -0000
Received: from fk-out-0910.google.com (209.85.128.189)
  by a.mx.sunsite.dk with SMTP; 5 Nov 2007 20:30:33 -0000
Received: by fk-out-0910.google.com with SMTP id 18so1673952fkq
        for <zsh-workers@sunsite.dk>; Mon, 05 Nov 2007 12:30:32 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=Z1GWaGcaNQoqPh3tjLjN+ib7o4UO03SLPYmJ2W8MC1g=;
        b=Hc0OTBXpIijSav5JhimpXAUuxOC7Mqwd6Ib6joZcKr5MKIeGK0tagDDH1yWfCBDmj+8jDMxgNDYPq/4fhzA8U/s7k1ei01P+vKz27+DFTtFaf57Pu5Syzj2Zq9eNxyzdb8SGEEwRlDXEefmoRjYWlNgrXE5mWp/qNiPz7zisrU0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=A6gCUtOXi8Ww2ezjNHpw4TrmwIod0PxdS7wJF6Ix9mE+PxunMrHvEJEbPSZA02DksPmg2WMwt7pTTtKHnQOAQrH2fNvzwIcLnbW+NqXrWik8bE6sABYXhE/wTGzR0gkCHb5D7kK07MLElj6mHlJLb0ErcBFqRzdv2yv21GLUNoQ=
Received: by 10.82.182.1 with SMTP id e1mr9711050buf.1194294631625;
        Mon, 05 Nov 2007 12:30:31 -0800 (PST)
Received: by 10.82.120.11 with HTTP; Mon, 5 Nov 2007 12:30:31 -0800 (PST)
Message-ID: <cccc8faf0711051230j4b5de727lf146080a208e0499@mail.gmail.com>
Date: Mon, 5 Nov 2007 12:30:31 -0800
From: "Drew Middlesworth" <drew.middlesworth@gmail.com>
To: zsh-workers@sunsite.dk
Subject: zsh bug
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I've been able to reproduce this bug on Ubuntu Dapper (zsh
4.2.5-23ubuntu3), Ubuntu Edgy (zsh 4.3.2-13ubuntu1), Ubuntu Gusty (zsh
4.3.4-14ubuntu2),CentOS5 (zsh-4.2.6-1) and also in the latest
development (zsh 4.3.4) on multiple operating systems. This issue
doesn't seem to exist in zsh version 4.1.1 that we also tested. The
steps to reproduce this are below.

Could you also reply CC my address too? Thanks,

Drew


Steps to reproduce (on dapper, with vi bindings):
 - enter some commands (echo foo ...)
 - hit esc to go into command mode
 - do a backward search: hit [the ?/ key] to get a '?' char indicating
  a backward search. search for something you typed a few lines
  back.
 - the search is successful, you're now a few lines back in the history
 - repeat:
  - shift-[the ?/ key] to get a '/' char indicating a forward-search
    (yes, normally you'd press [?/] without shift to get this char, but
     they invert it, since normally you want to search backwards
     through history)
  - backspace: don't search
  - scroll up or down in the history

After a few tries, pressing shift-[?/], when a '/' char should appear will
crash zsh:

Here, I searched backwards for 'echo c', then it crashed (after a few
tries) when I'd scrolled back to the 'echo a' line and tried a
forward-search:

epizzi@epizzi:~$ zsh
[epizzi:~]$ echo a
a
[epizzi:~]$ echo b
b
[epizzi:~]$ echo c
c
[epizzi:~]$ echo d
d
[epizzi:~]$ echo e
e
[epizzi:~]$ echo *** glibc detected *** double free or corruption
(fasttop): 0x080dfea8 ***
Aborted

