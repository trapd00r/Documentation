From zsh-workers-return-15631-mason-zsh=primenet.com.au@sunsite.dk Wed Aug 15 14:54:36 2001
Return-Path: <zsh-workers-return-15631-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25729 invoked from network); 15 Aug 2001 14:54:34 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Aug 2001 14:54:34 -0000
Received: (qmail 6488 invoked by alias); 15 Aug 2001 14:54:24 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15631
Received: (qmail 6471 invoked from network); 15 Aug 2001 14:54:22 -0000
Date: Wed, 15 Aug 2001 15:54:20 +0100
From: Adam Spiers <adam@spiers.net>
To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
Subject: Re: /usr/local/bin/perl
Message-ID: <20010815155420.A14031@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh workers mailing list <zsh-workers@sunsite.auc.dk>
References: <20010327142836.C32602@thelonious.new.ox.ac.uk> <1010327181943.ZM14188@candle.brasslantern.com> <20010327142836.C32602@thelonious.new.ox.ac.uk> <20010327151711.94655.qmail@web9306.mail.yahoo.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <20010327151711.94655.qmail@web9306.mail.yahoo.com>; from okiddle@yahoo.co.uk on Tue, Mar 27, 2001 at 04:17:11PM +0100
X-Home-Page: http://www.new.ox.ac.uk/~adam/
X-OS: RedHat Linux

Dragging up an old topic ...

Oliver Kiddle (okiddle@yahoo.co.uk) wrote:
> --- Adam Spiers <adam@spiers.net> wrote:
> > The following scripts hardcode binary locations (excluding /bin/sh
> 
> > Can we avoid this?  Is env(1) common to enough platforms, for
> > instance, or maybe we could add something to configure?
> 
> I'd agree that this is something which would be nice to clean up. I'd
> have thought that it would be fine to use env for these.

I'm not so sure env is any use now, as it appears to break if you
specify any switch, e.g.

  #!/usr/bin/env perl -w

breaks with

  env: perl -w: No such file or directory

Pretty remarkably braindead IMHO, but there we go.

> Setting the #! lines would be quite simple from configure but I'm not
> sure it is worth it for the extra complexity and potential for things
> to break.

Bart Schaefer (schaefer@candle.brasslantern.com) wrote:
> The only reason that I've added #! lines anywhere is so that emacs will
> start up in shell script mode and select the correct syntax.
> 
> }    Util/helpfiles           :   #!/usr/bin/perl -- -*-perl-*-
> 
> The -*- perl -*- is extraneous there, at least in newer versions of emacs.
> It'll figure it out from the tail of the #! path.

Yep.

> }    Test/ztst.zsh            :   #!/usr/local/bin/zsh -f
> 
> That should be ".../zsh -f +Z".

Indeed, and I believe that I've had tests misleadingly fail through
running `make test' before `make install' as a result of that.  Shall
I change it then?

> If you put env in the #! line -- or put the #! line anywhere but as the
> first line in the script -- it foils emacs' algorithm for figuring out
> which mode to start in.  Same issue if you put some kind of @...@ thing
> for configure there.  Not that this should be the primary reason for any
> decision that we make, but at least consider it.

We can persuade emacs to use the right mode using the other method:

  # Local Variables:
  # mode:cperl
  # End:

should do it.

If we use configure, presumably that would mean having (say)
Utils/helpfiles auto-generated from Utils/helpfiles.in?  My vote is
for that option.

