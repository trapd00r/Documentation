From zsh-users-return-4362-mason-zsh=primenet.com.au@sunsite.dk Wed Oct 10 09:46:37 2001
Return-Path: <zsh-users-return-4362-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5979 invoked from network); 10 Oct 2001 09:46:36 -0000
Received: from unknown (HELO sunsite.dk) (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 10 Oct 2001 09:46:36 -0000
Received: (qmail 28449 invoked by alias); 10 Oct 2001 09:46:16 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4362
Received: (qmail 28436 invoked from network); 10 Oct 2001 09:46:16 -0000
Date: Wed, 10 Oct 2001 11:42:25 +0200
From: Phil Pennock <Phil.Pennock@globnix.org>
To: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
Cc: 'Bruno Bonfils' <asyd@debian-fr.org>,
	'ZSH Users' <zsh-users@sunsite.dk>
Subject: Re: question about float variables
Message-ID: <20011010114224.A12923@globnix.org>
Mail-Followup-To: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>,
	'Bruno Bonfils' <asyd@debian-fr.org>,
	'ZSH Users' <zsh-users@sunsite.dk>
References: <20011010013324.A9741@debian-fr.org> <001401c15169$c095c020$21c9ca95@mow.siemens.ru>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-md5;
	protocol="application/pgp-signature"; boundary="IS0zKkzwUGydFO0o"
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <001401c15169$c095c020$21c9ca95@mow.siemens.ru>; from Andrej.Borsenkow@mow.siemens.ru on Wed, Oct 10, 2001 at 12:58:38PM +0400
X-Disclaimer: Any views expressed in this message, where not explicitly
	attributed otherwise, are mine and mine alone.  Such views
	do not necessarily coincide with those of any organisation
	or company with which I am or have been affiliated.
X-No-Archive: yes


--IS0zKkzwUGydFO0o
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On 2001-10-10 at 12:58 +0400, Borsenkow Andrej wrote:
> > float var1=3D0.0
> > var1=3D$((3 / 2))
> > echo $var1
> >=20
> > return 1.000000000e+00 not good ! :(

> Integer divided by integer is integer.

Not so useful if you're manipulating parameters and you don't know what
their value is in advance.

% zmodload zsh/mathfunc
% float var1
% var1=3D$((float(3) / 2))
% echo $var1
1.500000000e+00

(Math-context float() is not the zsh command "float")

> > and how to format the output of $var1 ?
> > (i want a number like 95.3)

> typeset description:

They just change the storage type, so that:
% typeset -E var2
% typeset -F var3
% var2=3D$((3.0 / 2 )) ; var3=3D$((3.0 / 2 ))
% print $var2
1.500000000e+00
% print $var3
1.5000000000

I've not seen a way in zsh to modify this to be 'sensible' for humans,
as the original poster wants, unless you're happy to _just_ remove
trailing zeroes, in which case use the -F form and then:
% print ${var3%%0##}
1.5

Personally, I'd use the OS's printf(1) if it exists, and use the G
format specification; on OpenBSD:
 gG          The argument is printed in style f or in style e (E) whichev-
             er gives full precision in minimum space.

% printf '%g\n' $var2
1.5
% printf '%g\n' $var3
1.5

--=20
I don't like your use of the word "interesting" in this context.

--IS0zKkzwUGydFO0o
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.6 (OpenBSD)

iD8DBQE7xBgAfDS04Uzk9lURAinyAJ4vr/+/1m4lJToH+bR2Ja/e9i83tQCgl8d+
OPY/NTk6UWsx1gmgo8iY9Io=
=h8jr
-----END PGP SIGNATURE-----

--IS0zKkzwUGydFO0o--

