From zsh-workers-return-9361-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jan 19 08:59:50 2000
Return-Path: <zsh-workers-return-9361-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20006 invoked from network); 19 Jan 2000 08:59:49 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Jan 2000 08:59:49 -0000
Received: (qmail 18385 invoked by alias); 19 Jan 2000 08:59:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9361
Received: (qmail 18373 invoked from network); 19 Jan 2000 08:59:36 -0000
Date: Wed, 19 Jan 2000 09:59:34 +0100 (MET)
Message-Id: <200001190859.JAA12126@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 19 Jan 2000 07:49:37 +0900
Subject: Re: If someone wants to try...


Tanaka Akira wrote:

> In article <200001171250.NAA21712@beta.informatik.hu-berlin.de>,
>   Sven Wischnowsky <wischnow@informatik.hu-berlin.de> writes:
> 
> > If someone tries it and finds any problems, please tell me...
> 
> `make check' succeed but some extra messages are printed.
> 
> % make check
> cd Test ; gmake check
> gmake[1]: Entering directory `/space/akr/zsh/zsh-main-trunc/Test'
> for f in ./*.ztst; do \
>   ../Src/zsh -f ./ztst.zsh $f; \
> done
> ./01grammar.ztst: all tests successful.
> ./02alias.ztst: all tests successful.
> ./03quoting.ztst: all tests successful.
> ZTST_test:72: redirection with no command
> ZTST_test:72: redirection with no command
> ZTST_test:72: redirection with no command
> ZTST_test:72: redirection with no command
> ./04redirect.ztst: all tests successful.
> ...
> 
> These messages `ZTST_test:72: redirection with no command' are
> expected error messages but should not be printed on a terminal and
> dev-15 doesn't print them.

Oops. Unnecessarily complex test in getoutput().

Bye
 Sven

diff -ru ../z.old/Src/exec.c Src/exec.c
--- ../z.old/Src/exec.c	Tue Jan 18 13:07:18 2000
+++ Src/exec.c	Wed Jan 19 09:46:35 2000
@@ -2517,8 +2517,7 @@
 	wc_code(pc[2]) == WC_PIPE && WC_PIPE_TYPE(pc[2]) == WC_PIPE_END &&
 	wc_code(pc[3]) == WC_REDIR && WC_REDIR_TYPE(pc[3]) == READ && 
 	!pc[4] &&
-	wc_code(pc[6]) == WC_SIMPLE && !WC_SIMPLE_ARGC(pc[6]) &&
-	wc_code(pc[7]) == WC_END) {
+	wc_code(pc[6]) == WC_SIMPLE && !WC_SIMPLE_ARGC(pc[6])) {
 	/* $(< word) */
 	int stream;
 	char *s = dupstring(ecrawstr(prog, pc + 5));

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

