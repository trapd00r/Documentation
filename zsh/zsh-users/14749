From zsh-users-return-14749-mason-zsh=primenet.com.au@zsh.org Wed Jan 27 17:10:01 2010
Return-Path: <zsh-users-return-14749-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17431 invoked by alias); 27 Jan 2010 17:10:01 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14749
Received: (qmail 1076 invoked from network); 27 Jan 2010 17:09:57 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at math.technion.ac.il does not designate permitted sender hosts)
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: ApoEALH/X0uERHMG/2dsb2JhbADZZgKENwQ
X-IronPort-AV: E=Sophos;i="4.49,355,1262556000"; 
   d="scan'208";a="221968546"
X-Authentication-Warning: fermat.math.technion.ac.il: nyh set sender to nyh@math.technion.ac.il using -f
Date: Wed, 27 Jan 2010 18:58:43 +0200
From: "Nadav Har'El" <nyh@math.technion.ac.il>
To: zsh-users@zsh.org
Subject: Binding Home and End
Message-ID: <20100127165843.GA4832@fermat.math.technion.ac.il>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.4.2.2i
Hebrew-Date: 12 Shevat 5770

I wanted to have the "Home" and "End" key do in vi mode the obvious thing
(move to the beginning and end of line). The obvious thing to do was
something like this:

	bindkey $terminfo[khome] vi-beginning-of-line
and so on.

Unfortunately it didn't work on xterm. Apparently, the terminfo says that
the home key is ^[OH, while it actually generates ^[[H.

After a long investigation I discovered the reason in this page:
http://www.mpimf-heidelberg.mpg.de/~rohm/computing/mpimf/notes/terminal.html

Apparently, for obscure historic reasons, xterm, like the VT100, has two
"modes" - "cursor mode" and "application mode". Cursor keys in the former
generate escape sequences with "[", and in the latter mode they generate
escape sequences with "O". Editors are *expected* to switch to "application"
mode using the "smkx" terminfo capability when they start, and to go back
to the normal "cursor" mode ("rmkx") when they exit. Since editors are
supposed to do that, they can expect cursor keys to generate the "O" escape
sequences, and this is why the "khome" capability is ^[OH, not ^[[H.

I just checked, and vi (for example) indeed switches to application mode.

I wonder - shouldn't ZLE also switch to application mode and leave this
mode when editing is complete (to run a command)?

And if we don't do that, how do people bind the "khome" and "kend" keys?
How does the default "kcuu1" (cursor up key) work, for example? Do you
perhaps use "cuu1" instead of "kcuu1"? That would be cheating ;-) And
unfortunately, there's no "end" (rather than "kend") capability that I
could use.

Any ideas?

Thanks,
Nadav.

P.S. Is there a particular reason why the "Home" and "End" key shouldn't
be bound by default in vi mode (both in insert and command modes)? They
are very useful, and also work in normal vi (or at least, vim).


-- 
Nadav Har'El                        |   Wednesday, Jan 27 2010, 13 Shevat 5770
nyh@math.technion.ac.il             |-----------------------------------------
Phone +972-523-790466, ICQ 13349191 |Someone offered you a cute little quote
http://nadav.harel.org.il           |for your signature? JUST SAY NO!

