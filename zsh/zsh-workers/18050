From zsh-workers-return-18050-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 02 17:34:56 2003
Return-Path: <zsh-workers-return-18050-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7020 invoked from network); 2 Jan 2003 17:34:55 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 2 Jan 2003 17:34:55 -0000
Received: (qmail 18419 invoked by alias); 2 Jan 2003 17:34:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18050
Received: (qmail 18399 invoked from network); 2 Jan 2003 17:34:48 -0000
Date: Fri, 3 Jan 2003 01:34:45 +0800
From: James Devenish <j-devenish@users.sourceforge.net>
To: Oliver Kiddle <okiddle@yahoo.co.uk>
Cc: zsh-workers@sunsite.dk
Subject: Re: Refactoring _bsd_pkg
Message-ID: <20030102173445.GC8904@gulag.guild.uwa.edu.au>
References: <20030102140412.GG2863@gulag.guild.uwa.edu.au> <2419.1041518512@finches.logica.co.uk> <20030102153706.GA7459@gulag.guild.uwa.edu.au> <3190.1041528082@finches.logica.co.uk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <3190.1041528082@finches.logica.co.uk>
User-Agent: Mutt/1.3.28i

In message <3190.1041528082@finches.logica.co.uk>
on Thu, Jan 02, 2003 at 06:21:22PM +0100, Oliver Kiddle wrote:
> > another look at it tomorrow. (And the person with the CC of my post is
> > the OpenBSD port maintainer for zsh, so he may have something useful to
> > add.)
> 
> Except I got a delivery failure for him so he may not see the whole
> conversation.

Re: David Lebel, I got no delivery errors and am corresponding with his
at the present minute. This is interesting, as according inference from
the mail Date headers, there are 13 hours of time difference between us.

In message <3190.1041528082@finches.logica.co.uk>
on Thu, Jan 02, 2003 at 06:21:22PM +0100, Oliver Kiddle wrote:
> I've had a cursory glance through it and it all looks fine to me. Can
> $(arch -s) be safely replaced by $MACHTYPE?

I will check with him, as he has more OpenBSD experience than I.

> When you've got it to a point you're happy with, let me know and it can
> then be committed.

Thanks, I will repost my suggestions tomorrow (with the guiding advice
you have about the paths).

> > pkg_add still doesn't work quite right because it always has some
> > directories (those matching the pattern /*) in the completion list,
> > even if my current directory is not /.
> 
> This is in _bsd_pkg_pkgfiles() right?

Mmm.

> This bit looks suspicious:
> 
>   paths=( "${(@)${(@s.:.)PKG_PATH}:#}" )
[...etc...]

I was not clear on the exact mode of operation of that portion, but I
will continue to try to arrive at a possible equivalent that makes
sense with respect to OpenBSD behaviour (may have to introduce another
case clause).

> > PS. I replaced '\'' with '', but maybe that's not portable? Also, I
> 
> That depends on the rcquotes option. You can only depend on those options
> listed in $_comp_options (of which rcquotes is not one). I tend to stick
> the whole line in double quotes to make it more readable.

Good plan. I will modify my patch to do that, then. As I only stumbled
across _bsd_pkg today, it seems to me to have a few oddities/
non-neatnesses that may be "legacy" matters (if you know what I mean).

Thanks.



