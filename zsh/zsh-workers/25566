From zsh-workers-return-25566-mason-zsh=primenet.com.au@sunsite.dk Sun Aug 31 09:32:20 2008
Return-Path: <zsh-workers-return-25566-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3800 invoked from network); 31 Aug 2008 09:32:16 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 31 Aug 2008 09:32:16 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 91003 invoked from network); 31 Aug 2008 09:31:41 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 31 Aug 2008 09:31:41 -0000
Received: (qmail 26813 invoked by alias); 31 Aug 2008 09:31:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25566
Received: (qmail 24500 invoked from network); 31 Aug 2008 09:23:40 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 31 Aug 2008 09:23:40 -0000
Received: from smtp7-g19.free.fr (smtp7-g19.free.fr [212.27.42.64])
	by bifrost.dotsrc.org (Postfix) with ESMTP id C4B41801E2B4
	for <zsh-workers@sunsite.dk>; Sun, 31 Aug 2008 11:23:37 +0200 (CEST)
Received: from smtp7-g19.free.fr (localhost [127.0.0.1])
	by smtp7-g19.free.fr (Postfix) with ESMTP id DE571B0217
	for <zsh-workers@sunsite.dk>; Sun, 31 Aug 2008 11:23:35 +0200 (CEST)
Received: from abeille.maison (rob76-2-82-225-119-151.fbx.proxad.net [82.225.119.151])
	by smtp7-g19.free.fr (Postfix) with ESMTP id F2D58B01E4
	for <zsh-workers@sunsite.dk>; Sun, 31 Aug 2008 11:23:34 +0200 (CEST)
Received: from dragon.maison (dragon.maison [192.168.0.11])
	by abeille.maison (Postfix) with ESMTP id 88EF0BBC0
	for <zsh-workers@sunsite.dk>; Sun, 31 Aug 2008 11:23:34 +0200 (CEST)
Received: by dragon.maison (Postfix, from userid 1001)
	id 754674044; Sun, 31 Aug 2008 11:23:34 +0200 (CEST)
Date: Sun, 31 Aug 2008 11:23:34 +0200
From: David LE BOURGEOIS <david.lebourgeois@free.fr>
To: zsh-workers@sunsite.dk
Subject: [zsh] ant completion broken
Message-ID: <20080831092334.GA5600@dragon.maison>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="MfFXiAuoTsnnDAfZ"
Content-Disposition: inline
X-PGP-Key: http://david.lebourgeois.free.fr/pgp/pubkey.asc
Disposition-Notification-To: David LE BOURGEOIS <david.lebourgeois@free.fr>
User-Agent: Mutt/1.5.18 (2008-05-17)
X-Virus-Scanned: ClamAV 0.92.1/8122/Sun Aug 31 03:04:56 2008 on bifrost
X-Virus-Status: Clean


--MfFXiAuoTsnnDAfZ
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

Hello.

I wish to report a problem about zsh-4.3.6, concerning the _ant
completion file. The zsh-workers/24129 fix breaks the ant completion for
target name.

In fact, the regular expression used in sed contains two spaces. And
since, in most of XML tags, the property separator is a single space,
the completion fails for many of build.xml files.

As a fix, deleting one of the two spaces from the regular expression
makes the ant completion working again. Also, replacing the remaining
single space by the POSIX [[:blank:]] pattern might provide a safer
parsing of the target name.

So, I send a patch file as attachment that fixes the _ant file.

Thank you for considering my report.

Regards.

PS: Does it matter if I ask to be Cc:ed for getting all replies?

-- 
David LE BOURGEOIS
E-mail : david.lebourgeois (at) free.fr
XMPP   : david.lebourgeois (at) jabber.fr
PGP    : http://david.lebourgeois.free.fr/pgp/

--MfFXiAuoTsnnDAfZ
Content-Type: text/plain; charset=us-ascii
Content-Description: _ant.patch
Content-Disposition: attachment; filename="_ant.patch"

--- zsh-4.3.6/Completion/Unix/Command/_ant	2007-11-29 10:45:58.000000000 +0100
+++ zsh-4.3.6/Completion/Unix/Command/_ant.new	2008-08-31 10:42:55.000000000 +0200
@@ -10,7 +10,7 @@
     importedfiles=( $(sed -n "s/ *<import[^>]* file=[\"']\([^\"']*\)[\"'].*/\1/p" < $1) )
     # Tweaked to omit targets beginning with "-" that can't
     # be invoked from the command line; see zsh-workers/24129.
-    sed -n "s/ *<target[^>]*  name=[\"']\([^-][^\"']*\)[\"'].*/\1/p" $1
+    sed -n "s/ *<target[^>]*[[:blank:]]name=[\"']\([^-][^\"']*\)[\"'].*/\1/p" $1
     if (( $#importedfiles )) ; then
 	( cd $1:h
     	for file in $importedfiles ; do

--MfFXiAuoTsnnDAfZ
Content-Type: text/plain; charset=us-ascii
Content-Description: _ant.patch.asc
Content-Disposition: attachment; filename="_ant.patch.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD4DBQBIumI6fGpn1bRTyEYRAhyBAKC3AWK5df2OveanWP88C+1JIAOyXwCXbCnq
sdJLBChTN6vYYuveJ+byag==
=diPn
-----END PGP SIGNATURE-----

--MfFXiAuoTsnnDAfZ--

