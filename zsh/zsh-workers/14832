From zsh-workers-return-14832-mason-zsh=primenet.com.au@sunsite.dk Sun Jun 10 11:35:31 2001
Return-Path: <zsh-workers-return-14832-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29073 invoked from network); 10 Jun 2001 11:35:30 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 10 Jun 2001 11:35:30 -0000
Received: (qmail 9008 invoked by alias); 10 Jun 2001 11:35:09 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14832
Received: (qmail 8993 invoked from network); 10 Jun 2001 11:35:08 -0000
Date: Sun, 10 Jun 2001 07:34:18 -0400
From: Clint Adams <clint@zsh.org>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: zsh-workers@sunsite.dk
Subject: Re: PATCH: check deleted .zwc files
Message-ID: <20010610073418.B4640@dman.com>
References: <20010608141719.A4626@dman.com> <010608115028.ZM5876@candle.brasslantern.com> <20010608150445.A5394@dman.com> <010608124608.ZM5942@candle.brasslantern.com> <20010608155309.A6700@dman.com> <1010609205833.ZM20464@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <1010609205833.ZM20464@candle.brasslantern.com>; from schaefer@candle.brasslantern.com on Sat, Jun 09, 2001 at 08:58:32PM +0000


> Clint, maybe you could explain more WHY you want this to work?  Is it
> for the case where the ONLY place from which zsh can load the function
> definition is the (removed but still mapped) digest file?  Or is there
> some reason that you want the mapped file to take precedence over any
> other file on disk?

The former.  In Debian, when someone upgrades their zsh package,
the binary, docs, functions, modules, and wordcode digests get
removed, and those of the new version are put in place.
The directories are versioned, so "place" is a unique pathname.
The user with a running shell finds his $fpath emptied,
usually when he hits TAB for a completion that has not yet
been autoloaded, and zsh spams him with pages of "function
definition file not found".

In this particular scenario, the mapped file should never take
precedence over the on-disk file, since unless the administrator
has for some reason reinstalled the very same version, that
on-disk file won't exist.

Perhaps everyone would be happier if the deleted files were only
checked if the function could not be found anywhere else.

