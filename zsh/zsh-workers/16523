From zsh-workers-return-16523-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 31 05:01:21 2002
Return-Path: <zsh-workers-return-16523-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24336 invoked from network); 31 Jan 2002 05:01:20 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 31 Jan 2002 05:01:20 -0000
Received: (qmail 6513 invoked by alias); 31 Jan 2002 05:01:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16523
Received: (qmail 6502 invoked from network); 31 Jan 2002 05:01:09 -0000
Date: Wed, 30 Jan 2002 21:01:04 -0800
From: Derek Peschel <dpeschel@eskimo.com>
To: Oliver Kiddle <okiddle@yahoo.co.uk>
Cc: zsh-workers@sunsite.dk
Subject: Re: PATCH: 4.0.2: rprompt2 variable
Message-ID: <20020130210103.A28938@eskimo.eskimo.com>
References: <20020125044808.C7661@eskimo.eskimo.com> <3C56E82C.64A1D159@yahoo.co.uk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0i
In-Reply-To: <3C56E82C.64A1D159@yahoo.co.uk>; from okiddle@yahoo.co.uk on Tue, Jan 29, 2002 at 06:21:32PM +0000

On Tue, Jan 29, 2002 at 06:21:32PM +0000, Oliver Kiddle wrote:
> Derek Peschel wrote:
> > 
> > Even if a feature (right-hand prompts) is frivolous, it might as well be
> > available in general.
> > 
> > Now you can see the parser state (or whatever else you might want to put
> > in PROMPT2) and still have a consistent left margin when entering a multi-
> > line command.  See my companion "reverse parser state" patch if you want
> > the parser state to expand leftward on your screen.
> > 
> > Comments welcome (I just started using zsh and I have no idea if anyone
> > else will find these patches useful).
> 
> I'd just like to say that I like this. I've never actually used
> rprompts but this with the transient_rprompt option (new since 4.0.2)
> is useful. For one thing, it makes life easier if I decide to cut 'n'
> paste the lines into an editor or other terminal because I don't then
> have a prompt to get rid of. I fear that other people may want a
> separate transient_rprompt2 option with this.

Because you mentioned it, I decided to see how easy it is to add.
(I'm not sure why people would want one prompt transient and not the
other, but I also don't like it when programs make assumptions that
prevent me from doing something.)

> > %_ no longer treats negative integers like zero, but instead extracts
> > leading (outermost) words.  Maybe someone somewhere cares more about
> > the outer state than the inner state.
> > 
> > %^ works like %_ (including the behavior described above) but after
> > the words are selected they are printed in reverse order.  Try using %^
> > in RPS2.
> > 
> > I picked ^ because it comes before _ in ASCII.
> 
> I'm not sure whether the negative integers part might ever be useful
> though I have no objections because it is logical. I'd be tempted to
> use negative numbers for reversing the order but -0 not being a
> distinct number from +0 makes that less clean as a solution.

It's very important for programs (especially large and complicated ones)
to act consistently IMO.  Some of the other prompt escapes (like the one
for the current directory) already use the sign to choose between first
and last components.  I don't think any other escapes have a "reverse order"
feature.

I'm not sure whether the negative integer feature might be useful either.
Though someone might not like the way the line changes from

	for for for if then
to
	for for if then if

and reason that if the line is going to get too long, it should just
stop growing.  So leaving the feature out on principle seems a bit
presumptuous to me (especially since it was easy to add and didn't use
very much code).

Would it be possible to do the reversal using the precmd feature?  (Can
you "print" the prompt to a string?)  If so, then the %^ escape can go.
And that makes more sense as the code to take out, since none of the
other escapes has a "reverse order" feature.

-- Derek

