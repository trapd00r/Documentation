From zsh-workers-return-16275-mason-zsh=primenet.com.au@sunsite.dk Thu Nov 22 11:27:21 2001
Return-Path: <zsh-workers-return-16275-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25993 invoked from network); 22 Nov 2001 11:27:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 22 Nov 2001 11:27:19 -0000
Received: (qmail 23480 invoked by alias); 22 Nov 2001 11:27:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16275
Received: (qmail 23469 invoked from network); 22 Nov 2001 11:27:03 -0000
From: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
To: "'Gary Oberbrunner'" <garyo@genarts.com>, zsh-workers@sunsite.dk
Subject: RE: Zsh 4.0.4 and Emacs 21.1 in Windows XP
Date: Thu, 22 Nov 2001 14:26:55 +0300
Message-ID: <000001c17348$9794de80$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.2627
In-Reply-To: <3BFC07BB.8090601@genarts.com>
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2600.0000

> 
> I'm trying to use Zsh 4.0.4 on Windows XP with Emacs 21.1 in
shell-mode.
>  I compiled both of them from sources.
> 

Have you compiled Emacs under Cygwin? (I assume, you have Cygwin
environment as zsh definitely does not work under native Win32). I
vaguely remember there were problems (Xemacs is supposed to work
though).

> Everything works OK except zsh thinks all my input has an extra CR
(^M)
> at the end of each line.  So in order to do a 'ls' I have to do 'ls;'
> and then it does the ls properly and then gives me an error 'zsh:
> command not found: ^M'.  If I just type ls<CR> I get 'zsh: command not
> found: ls^M'.  I've turned off all my .z* scripts and it didn't make
any
> difference.  All that's set in my .emacs is
>   (setq shell-file-name "c:/bin/zsh.exe")
>   (setq explicit-shell-file-name shell-file-name)
> 


Probably, you are using native emacs and Cygwin zsh. In this case emacs
writes pipe to zsh in text mode (CR-LF under DOS) and zsh reads it in
binary mode (default for pipes under Cygwin). Please, look on
www.cygwin.com for description of CYGWIN variable, specifically
nobinmode. But I have no idea what effects may it have - it makes Cygwin
read/write pipes in text (in DOS sense) mode which is O.K. for pure text
but may break binary data.

In general it is bad idea to mix native and Cygwin applications.

> Has anyone tried this?  Is it supposed to work?
> 

Please specify more details. 

> (By the way, zsh works fine in a regular command window.)
> 

I hope :-)

-andrej

