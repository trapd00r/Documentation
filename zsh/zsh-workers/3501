From zsh-workers-request@math.gatech.edu Wed Sep 17 13:10:15 1997
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 15722 invoked from network); 17 Sep 1997 13:10:14 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 17 Sep 1997 13:10:14 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id IAA18969;
	Wed, 17 Sep 1997 08:58:12 -0400 (EDT)
Resent-Date: Wed, 17 Sep 1997 08:58:12 -0400 (EDT)
Message-Id: <m0xBJgb-00013EC@worf.informatik.hu-berlin.de>
Date: Wed, 17 Sep 97 14:58 MET DST
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@math.gatech.edu
In-reply-to: Peter Stephenson's message of Mon, 15 Sep 1997 17:41:24 +0200
Subject: Re:  Directory completion and Initial path completion option
Resent-Message-ID: <"Jl_qW3.0.Ke4.aFz7q"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3501
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu


Peter Stephenson wrote:

*** Src/Zle/zle_tricky.c.dir	Mon Sep 15 16:57:36 1997
--- Src/Zle/zle_tricky.c	Mon Sep 15 17:27:39 1997
***************
*** 2635,2641 ****
  				prpre = pp;
  			    }
  			}
! 		    }
  		    /* The compctl has a glob pattern (compctl -g). */
  		    if (cc->glob) {
  			int ns, pl = strlen(prpre), o;
--- 2635,2642 ----
  				prpre = pp;
  			    }
  			}
! 		    } else if (cc->mask && CC_DIRS)
! 			gen_matches_files(1, 0, 0);
  		    /* The compctl has a glob pattern (compctl -g). */
  		    if (cc->glob) {
  			int ns, pl = strlen(prpre), o;


That should be `cc-mask & CC_DIRS'.
                       ^^^

And:

*** Src/Zle/compctl.c.withd	Mon Sep 15 18:30:40 1997
--- Src/Zle/compctl.c	Tue Sep 16 16:27:08 1997
***************
*** 280,285 ****
--- 280,298 ----
  		    *argv = "" - 1;
  		}
  		break;
+ 	    case 'W':
+ 		if ((*argv)[1]) {
+ 		    cct.withd = (*argv) + 1;
+ 		    *argv = "" - 1;
+ 		} else if (!argv[1]) {
+ 		    zwarnnam(name, "command string expected after -%c", NULL,
+ 			    **argv);
+ 		    return 1;
+ 		} else {
+ 		    cct.withd = *++argv;
+ 		    *argv = "" - 1;
+ 		}
+ 		break;
  	    case 'H':
  		if ((*argv)[1])
  		    cct.hnum = atoi((*argv) + 1);

here we probably should use "path expected after -%c".
                             ^^^^


Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

