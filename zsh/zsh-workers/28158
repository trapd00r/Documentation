From zsh-workers-return-28158-mason-zsh=primenet.com.au@zsh.org Thu Aug 12 17:34:16 2010
Return-Path: <zsh-workers-return-28158-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22661 invoked by alias); 12 Aug 2010 17:34:16 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28158
Received: (qmail 3048 invoked from network); 12 Aug 2010 17:34:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.0 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,FREEMAIL_FROM,RCVD_IN_DNSWL_NONE autolearn=ham
	version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 209.85.161.43 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:received:received:date:from:to:cc:subject
         :message-id:references:mime-version:content-type:content-disposition
         :in-reply-to:user-agent;
        bh=fZos/Fuse8zYdZbd7oZKTHWIKh4AwblApAo9vVQA0iY=;
        b=Ub9AL5DQxGhH8Ma/U3HT6MjCItRnnoXRvsmp++xEgVbowSx6uzWyLWAOW9e33XqNcM
         xQ+Xrllo1gfFUm3kgQdyngAe9Cvs/xe2Ctkt2+0pW0IrKIU+UXs8LwKULjPP19ywHS3L
         HjFi1BvRRhqSc4jLVeePtRwWp1Gsn2n+A23QM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=date:from:to:cc:subject:message-id:references:mime-version
         :content-type:content-disposition:in-reply-to:user-agent;
        b=lo//q5oeB1I7+JamgJgaFsGtc5Q49J3a4fb1zufZ/aRRxmwOTWXsZU0DoKKm2NVJTg
         bYlxteALDYBwqR+Q+0idWpsAbxp5ajiF0b3dE4FUFD5oU/eYep1odQzBEuZpRiRRkWW5
         2JFt67xbYlPoj7ZyyXy+wgTZNklLwIwDVM9vw=
Date: Thu, 12 Aug 2010 19:33:56 +0200
From: Philipp Hartwig <ph.hartwig@googlemail.com>
To: Frank Terbeck <ft@bewatermyfriend.org>
Cc: zsh-workers@zsh.org
Subject: Re: segfault on menu-select
Message-ID: <20100812173356.GC24998@ph>
References: <20100812144626.GI28144@ph>
 <8762zf6fwo.fsf@ft.bewatermyfriend.org>
 <20100812152044.GJ28144@ph>
 <87wrrv4yrg.fsf@ft.bewatermyfriend.org>
 <20100812165307.GA24998@ph>
 <87r5i34v51.fsf@ft.bewatermyfriend.org>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="SFyWQ0h3ruR435lw"
Content-Disposition: inline
In-Reply-To: <87r5i34v51.fsf@ft.bewatermyfriend.org>
User-Agent: Mutt/1.5.20 (2009-06-14)

--SFyWQ0h3ruR435lw
Content-Type: multipart/mixed; boundary="TiqCXmo5T1hvSQQg"
Content-Disposition: inline


--TiqCXmo5T1hvSQQg
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

> To generate the manuals, you need the `yodl' package.

I had installed this because even "make" failed without it, but "make=20
install" still wouldn't work afterwards. On a new checkout it however=20
does, so never mind.
=20
> From a fresh checkout, here's what I usually do:
>=20
> % ./Util/preconfig
> % /configure  --enable-cap --enable-function-subdirs \
>               --enable-largefile --enable-maildir-support \
>               --enable-multibyte --enable-pcre --enable-zsh-debug
> % make
> % su
> # make install
>=20
> Then when you've crashed the application, you can load the core file
> together with the program's binary and use the "bt full" command to
> produce a backtrace.
>=20
> To put the backtrace to a file, the following oneliner works:
>=20
> % gdb -c core /usr/local/bin/zsh <<< $'bt full\nquit\n' > backtrace.txt
>=20
> Where `core' is the core file and `/usr/local/bin/zsh' being the
> installed zsh binary which you just crashed.
>=20
> The backtrace will only be useful if the zsh binary is from a debugging
> build.

Ok, apart from a "warning: Can't read pathname for load map:=20
Input/output error." it looks like this has worked. I've attached the=20
result.

Best,
Philipp

--TiqCXmo5T1hvSQQg
Content-Type: text/plain; charset=utf-8
Content-Disposition: attachment; filename="backtrace.txt"
Content-Transfer-Encoding: quoted-printable

GNU gdb (GDB) 7.0.1-debian
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.htm=
l>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /usr/local/bin/zsh...done.
Reading symbols from /lib/libpcre.so.3...(no debugging symbols found)...don=
e.
Loaded symbols for /lib/libpcre.so.3
Reading symbols from /lib/libcap.so.2...(no debugging symbols found)...done.
Loaded symbols for /lib/libcap.so.2
Reading symbols from /lib/libdl.so.2...(no debugging symbols found)...done.
Loaded symbols for /lib/libdl.so.2
Reading symbols from /lib/libncursesw.so.5...(no debugging symbols found)..=
=2Edone.
Loaded symbols for /lib/libncursesw.so.5
Reading symbols from /lib/libm.so.6...(no debugging symbols found)...done.
Loaded symbols for /lib/libm.so.6
Reading symbols from /lib/libc.so.6...(no debugging symbols found)...done.
Loaded symbols for /lib/libc.so.6
Reading symbols from /lib/libattr.so.1...(no debugging symbols found)...don=
e.
Loaded symbols for /lib/libattr.so.1
Reading symbols from /lib64/ld-linux-x86-64.so.2...(no debugging symbols fo=
und)...done.
Loaded symbols for /lib64/ld-linux-x86-64.so.2
Reading symbols from /lib/libnss_compat.so.2...(no debugging symbols found)=
=2E..done.
Loaded symbols for /lib/libnss_compat.so.2
Reading symbols from /lib/libnsl.so.1...(no debugging symbols found)...done.
Loaded symbols for /lib/libnsl.so.1
Reading symbols from /lib/libnss_nis.so.2...(no debugging symbols found)...=
done.
Loaded symbols for /lib/libnss_nis.so.2
Reading symbols from /lib/libnss_files.so.2...(no debugging symbols found).=
=2E.done.
Loaded symbols for /lib/libnss_files.so.2
Reading symbols from /usr/local/lib/zsh/4.3.10-dev-2/zsh/parameter.so...don=
e.
Loaded symbols for /usr/local/lib/zsh/4.3.10-dev-2/zsh/parameter.so
Reading symbols from /usr/local/lib/zsh/4.3.10-dev-2/zsh/zle.so...done.
Loaded symbols for /usr/local/lib/zsh/4.3.10-dev-2/zsh/zle.so
Reading symbols from /usr/local/lib/zsh/4.3.10-dev-2/zsh/complete.so...done.
Loaded symbols for /usr/local/lib/zsh/4.3.10-dev-2/zsh/complete.so
Reading symbols from /usr/local/lib/zsh/4.3.10-dev-2/zsh/zutil.so...done.
Loaded symbols for /usr/local/lib/zsh/4.3.10-dev-2/zsh/zutil.so
Reading symbols from /usr/local/lib/zsh/4.3.10-dev-2/zsh/complist.so...done.
Loaded symbols for /usr/local/lib/zsh/4.3.10-dev-2/zsh/complist.so
Reading symbols from /usr/local/lib/zsh/4.3.10-dev-2/zsh/computil.so...done.
Loaded symbols for /usr/local/lib/zsh/4.3.10-dev-2/zsh/computil.so
Core was generated by `zsh'.
Program terminated with signal 11, Segmentation fault.
#0  0x00007f5cb77a3b92 in ?? () from /lib/libc.so.6
(gdb) #0  0x00007f5cb77a3b92 in ?? () from /lib/libc.so.6
No symbol table info available.
#1  0x00007f5cb63b76eb in instmatch (m=3D0x1776660, scs=3D0x7fff5707cf2c) a=
t compresult.c:634
        l =3D 4
        r =3D 14
        ocs =3D 19
        a =3D 5
        brb =3D 0
        bradd =3D 0
        brpos =3D 0x7fff5707ce50
        bp =3D 0x7f5cb65fd7ac
#2  0x00007f5cb63b87bb in do_single (m=3D0x1776660) at compresult.c:989
        l =3D 0
        sr =3D 0
        scs =3D 0
        havesuff =3D 0
        partest =3D 1
        str =3D 0x5d8 <Address 0x5d8 out of bounds>
        ppre =3D 0x7f5cb7a84e98 "p\001\202\001"
        psuf =3D 0x9 <Address 0x9 out of bounds>
        prpre =3D 0x21 <Address 0x21 out of bounds>
#3  0x00007f5cb63a3616 in do_completion (dummy=3D0x7f5cb6810f68, dat=3D0x7f=
ff5707d060) at compcore.c:413
        m =3D 0x1811e50
        ret =3D 0
        lst =3D 0
        incmd =3D 0
        osl =3D 0
        s =3D 0x1812140 ""
        opm =3D 0x1776700 ""
        n =3D 0x7f5cb7a84e40
#4  0x00000000004632a9 in runhookdef (h=3D0x7f5cb6810f68, d=3D0x7fff5707d06=
0) at module.c:996
No locals.
#5  0x00007f5cb65fa1d5 in docompletion (s=3D0x1812140 "", lst=3D0, incmd=3D=
0) at zle_tricky.c:2179
        dat =3D {s =3D 0x1812140 "", lst =3D 0, incmd =3D 0}
#6  0x00007f5cb65f5a00 in docomplete (lst=3D0) at zle_tricky.c:859
        active =3D 1
        s =3D 0x1812140 ""
        ol =3D 0x0
        olst =3D 0
        chl =3D 0
        ne =3D 0
        ocs =3D 5
        ret =3D 0
        dat =3D {0, 0}
#7  0x00007f5cb65f3e54 in menucomplete (args=3D0x7f5cb68114c8) at zle_trick=
y.c:247
No locals.
#8  0x00007f5cb5f8a63d in menuselect (args=3D0x7f5cb68114c8) at complist.c:=
3378
        d =3D 0
#9  0x00007f5cb65e221f in execzlefunc (func=3D0x178d4d0, args=3D0x7f5cb6811=
4c8, set_bindk=3D0) at zle_main.c:1333
        wflags =3D 645
        r =3D 0
        ret =3D 0
        remetafy =3D 0
        w =3D 0x178d470
        save_bindk =3D 0x178d4d0
#10 0x00007f5cb65e15c4 in zlecore () at zle_main.c:1058
No locals.
#11 0x00007f5cb65e1d32 in zleread (lp=3D0x6d6358, rp=3D0x0, flags=3D3, cont=
ext=3D0) at zle_main.c:1227
        s =3D 0x0
        old_errno =3D 22
        tmout =3D 0
        initthingy =3D 0x0
#12 0x00007f5cb65e4821 in zle_main_entry (cmd=3D1, ap=3D0x7fff5707d510) at =
zle_main.c:1889
        lp =3D 0x6d6358
        rp =3D 0x0
        flags =3D 3
        context =3D 0
#13 0x000000000044be61 in zleentry (cmd=3D1) at init.c:1354
        ret =3D 0x0
        ap =3D {{gp_offset =3D 40, fp_offset =3D 48, overflow_arg_area =3D =
0x7fff5707d610,=20
            reg_save_area =3D 0x7fff5707d550}}
#14 0x000000000044c8c1 in inputline () at input.c:281
        flags =3D 3
        ingetcline =3D 0x0
        ingetcpmptl =3D 0x6d6358
        ingetcpmptr =3D 0x0
        context =3D 0
#15 0x000000000044c738 in ingetc () at input.c:217
        lastc =3D 0
#16 0x0000000000441180 in ihgetc () at hist.c:279
        c =3D 0
#17 0x0000000000456375 in gettok () at lex.c:694
        c =3D 0
        d =3D 0
        peekfd =3D -1
        peek =3D 0
#18 0x0000000000455b3e in zshlex () at lex.c:381
No locals.
#19 0x0000000000477203 in parse_event () at parse.c:451
No locals.
#20 0x0000000000448f01 in loop (toplevel=3D1, justonce=3D0) at init.c:132
        prog =3D 0x1771420
        err =3D 1000
        non_empty =3D 0
#21 0x000000000044c32d in zsh_main (argc=3D1, argv=3D0x7fff5707d8d8) at ini=
t.c:1508
        t =3D 0x7fff5707d8e0
        runscript =3D 0x0
        t0 =3D 158
#22 0x000000000040ff44 in main (argc=3D1, argv=3D0x7fff5707d8d8) at ./main.=
c:93
No locals.
(gdb)=20
--TiqCXmo5T1hvSQQg--

--SFyWQ0h3ruR435lw
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAkxkMIQACgkQiTx0ar4roGRVqACgsLS4uml5fotyOmTBF5epVLZL
bAMAmwQ7hMG2+CVuHpvFn/qN+lbLL2aH
=SF+a
-----END PGP SIGNATURE-----

--SFyWQ0h3ruR435lw--

