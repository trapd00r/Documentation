From zsh-workers-return-13541-mason-zsh=primenet.com.au@sunsite.dk Mon Feb 26 18:41:40 2001
Return-Path: <zsh-workers-return-13541-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4070 invoked from network); 26 Feb 2001 18:41:39 -0000
Received: from unknown (HELO sunsite.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 Feb 2001 18:41:39 -0000
Received: (qmail 23948 invoked by alias); 26 Feb 2001 18:41:34 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13541
Received: (qmail 23937 invoked from network); 26 Feb 2001 18:41:33 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
Date: Mon, 26 Feb 2001 21:41:29 +0300 (MSK)
From: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
X-X-Sender:  <bor@itsrm2.mow.siemens.ru>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
cc: <zsh-workers@sunsite.dk>
Subject: Re: PATCH: Re: completion function for apachectl
In-Reply-To: <1010226160719.ZM5007@candle.brasslantern.com>
Message-ID: <Pine.SV4.4.33.0102262137550.12371-100000@itsrm2.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 26 Feb 2001, Bart Schaefer wrote:

> On Feb 26,  6:17pm, Andrej Borsenkow wrote:
> }
> } > +_sub_commands start stop
> }
> } Well, Linux strikes again. You can be sure only in the above; restart and
> } status are not universally supported.
>
> One could probably pull a stunt like this:
>
> _sub_commands $(sed -ne '/case/,/esac/{;s/^ *\([a-z|)]*\).*/\1/g;s/[|)]/ /gp;}' $words[1])
>
> Runs a slight risk of finding case-labels that aren't actually part of the
> argument parsing -- on a RedHat 6.2 machine it finds y, n, and c in one of
> the scripts -- but for the most part it's pretty accurate.
>
> Tuning the regex and adapting to older seds left as an exercise.
>
>

I prefer explicit search for (start|stop|restart|status|reload). It is
what is used on Linux (just checked) and we can always add more labels
if needed. Searching for every label will find too much.

One small problem is binary programs (at least our system sometimes did
that). So, '2> /dev/null' is needed and at least (start|stop) should be
fallback.

-andrej

