From zsh-users-return-9698-mason-zsh=primenet.com.au@sunsite.dk Sat Nov 19 14:58:03 2005
Return-Path: <zsh-users-return-9698-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20943 invoked from network); 19 Nov 2005 14:58:02 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=0.6 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO,
	RCVD_IN_BL_SPAMCOP_NET,RCVD_NUMERIC_HELO autolearn=no version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 19 Nov 2005 14:58:02 -0000
Received: (qmail 24500 invoked from network); 19 Nov 2005 14:57:54 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 19 Nov 2005 14:57:54 -0000
Received: (qmail 16690 invoked by alias); 19 Nov 2005 14:57:47 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9698
Received: (qmail 16680 invoked from network); 19 Nov 2005 14:57:47 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 19 Nov 2005 14:57:47 -0000
Received: (qmail 23355 invoked from network); 19 Nov 2005 14:57:47 -0000
Received: from main.gmane.org (HELO ciao.gmane.org) (80.91.229.2)
  by a.mx.sunsite.dk with SMTP; 19 Nov 2005 14:57:46 -0000
Received: from list by ciao.gmane.org with local (Exim 4.43)
	id 1EdU8l-00020A-LZ
	for zsh-users@sunsite.dk; Sat, 19 Nov 2005 15:56:31 +0100
Received: from 212.17.39.109 ([212.17.39.109])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Sat, 19 Nov 2005 15:56:31 +0100
Received: from thorsten by 212.17.39.109 with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Sat, 19 Nov 2005 15:56:31 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-users@sunsite.dk
From:  Thorsten Kampe <thorsten@thorstenkampe.de>
Subject:  Re: listing/deleting empty directories recursively
Date:  Sat, 19 Nov 2005 14:54:58 +0000
Lines: 31
Message-ID:  <21s006pe8uia$.1l1390nr523s7$.dlg@40tude.net>
References:  <tfrtn1dt9nf26m1rka6b9kg3bmcoa2evs4@4ax.com> <20051119115653.GA329@imada.sdu.dk> <20051119115926.GB329@imada.sdu.dk> <200511191348.29062.cht@chello.at>
Mime-Version:  1.0
Content-Type:  text/plain; charset="us-ascii"
Content-Transfer-Encoding:  7bit
X-Complaints-To: usenet@sea.gmane.org
X-Gmane-NNTP-Posting-Host: 212.17.39.109
User-Agent: 40tude_Dialog/2.0.15.1
Sender: news <news@sea.gmane.org>

* Christian Taylor (2005-11-19 12:48 +0100)
> Thor Andreassen wrote:
>>> This should do the trick:
>>>
>>> for dir in `ls -ld **/*(/^F)`; do echo $dir > LOGFILE; rmdir $dir; done
>>
>> You should use double quotes (") around the dir variable if you have
>> dirnames with spaces (and some other chars), i.e. echo "$dir" and rmdir
>> "$dir".
> 
> That probably wouldn't work, since ls -ld prints a whole lot of additional 
> information that will be interpreted as directories to log and delete. It's 
> far simpler to do away with ls:
> 
> for dir in **/*(/^F); do print $dir >> LOGFILE; rmdir $dir; done

Exactly. Using "for x in $(ls)" or "for x in $(ls *)" instead of "for
dir in *" is a common mistake (mentioned in "From bash to zsh").
 
> or with the alternative syntax I really like:
> 
> for dir (**/*(/^F)) { print $dir >> LOGFILE; rmdir $dir }
> 
> As far as I can see, filenames generated this way are already quoted 
> correctly, so spaces and special characters shouldn't be an issue.

Sorry, but it completely the other way round: the filenames are not
split (shwordsplit) so there's no need to quote them.

That's one major reason for the superiority of zsh to other shells
like bash.

