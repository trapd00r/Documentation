From zsh-workers-return-19211-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 28 16:05:15 2003
Return-Path: <zsh-workers-return-19211-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1353 invoked from network); 28 Oct 2003 16:05:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 28 Oct 2003 16:05:13 -0000
Received: (qmail 6183 invoked by alias); 28 Oct 2003 16:05:00 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19211
Received: (qmail 6158 invoked from network); 28 Oct 2003 16:04:59 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 28 Oct 2003 16:04:59 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [128.178.50.179] by sunsite.dk (MessageWall 1.0.8) with SMTP; 28 Oct 2003 16:4:59 -0000
Received: (qmail 13110 invoked from network); 28 Oct 2003 16:04:58 -0000
Received: from smartdatapc1.epfl.ch (HELO rhin.pse.sd) (128.179.50.2)
  by psemail.epfl.ch with SMTP; 28 Oct 2003 16:04:58 -0000
Received: from fred by rhin.pse.sd with local (Exim 3.36 #1 (Debian))
	id 1AEWL4-0006c0-00; Tue, 28 Oct 2003 17:04:58 +0100
Date: Tue, 28 Oct 2003 17:04:57 +0100
From: Frederic Gobry <frederic.gobry@smartdata.ch>
To: Peter Stephenson <pws@csr.com>
Cc: zsh-workers@sunsite.dk, 217915@bugs.debian.org
Subject: Re: NSS LDAP/TLS crashing
Message-ID: <20031028160457.GA25326@rhin>
References: <20031028143032.GA26489@scowler.net> <21704.1067354886@csr.com>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="TRYliJ5NKNqkz5bu"
Content-Disposition: inline
In-Reply-To: <21704.1067354886@csr.com>
User-Agent: Mutt/1.5.4i
Sender:  <frederic.gobry@smartdata.ch>


--TRYliJ5NKNqkz5bu
Content-Type: multipart/mixed; boundary="+QahgC5+KEYLbs62"
Content-Disposition: inline


--+QahgC5+KEYLbs62
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Excellent, the patch solves the crash :-) However, there are still
invalid writes (see attachment).

Fr=E9d=E9ric

--=20
 Fr=E9d=E9ric Gobry       SMARTDATA    	 =20
                      http://www.smartdata.ch/
 PGP: 5B44F4A5        Lausanne - Switzerland
                      +41 21 693 84 98

--+QahgC5+KEYLbs62
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: attachment; filename=zsh-valgrind
Content-Transfer-Encoding: quoted-printable

=3D=3D25377=3D=3D Memcheck, a.k.a. Valgrind, a memory error detector for x8=
6-linux.
=3D=3D25377=3D=3D Copyright (C) 2002-2003, and GNU GPL'd, by Julian Seward.
=3D=3D25377=3D=3D Using valgrind-20030725, a program supervision framework =
for x86-linux.
=3D=3D25377=3D=3D Copyright (C) 2000-2003, and GNU GPL'd, by Julian Seward.
=3D=3D25377=3D=3D Estimated CPU clock rate is 600 MHz
=3D=3D25377=3D=3D For more details, rerun with: -v
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x41008ABA: _dl_relocate_object_internal (in /lib/l=
d-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4111DD70: (within /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4100B115: _dl_catch_error_internal (in /lib/ld-2.=
3.2.so)
=3D=3D25377=3D=3D    by 0x4111DFDB: _dl_open (in /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x41008B05: _dl_relocate_object_internal (in /lib/l=
d-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4111DD70: (within /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4100B115: _dl_catch_error_internal (in /lib/ld-2.=
3.2.so)
=3D=3D25377=3D=3D    by 0x4111DFDB: _dl_open (in /lib/libc-2.3.2.so)
=3D=3D25378=3D=3D=20
=3D=3D25378=3D=3D Invalid write of size 4
=3D=3D25378=3D=3D    at 0x805DFF1: (within /bin/zsh4)
=3D=3D25378=3D=3D    by 0x805E513: execute (in /bin/zsh4)
=3D=3D25378=3D=3D    by 0x8061831: (within /bin/zsh4)
=3D=3D25378=3D=3D    by 0x805FE2C: (within /bin/zsh4)
=3D=3D25378=3D=3D    Address 0x40C96110 is 0 bytes after a block of size 17=
6 alloc'd
=3D=3D25378=3D=3D    at 0x40015CE9: realloc (vg_replace_malloc.c:299)
=3D=3D25378=3D=3D    by 0x4104258C: (within /lib/libc-2.3.2.so)
=3D=3D25378=3D=3D    by 0x410424B7: putenv (in /lib/libc-2.3.2.so)
=3D=3D25378=3D=3D    by 0x808955B: addenv (in /bin/zsh4)
=3D=3D25379=3D=3D=20
=3D=3D25379=3D=3D Invalid write of size 4
=3D=3D25379=3D=3D    at 0x805DFF1: (within /bin/zsh4)
=3D=3D25379=3D=3D    by 0x805E513: execute (in /bin/zsh4)
=3D=3D25379=3D=3D    by 0x8061831: (within /bin/zsh4)
=3D=3D25379=3D=3D    by 0x805FE2C: (within /bin/zsh4)
=3D=3D25379=3D=3D    Address 0x40C96110 is 0 bytes after a block of size 17=
6 alloc'd
=3D=3D25379=3D=3D    at 0x40015CE9: realloc (vg_replace_malloc.c:299)
=3D=3D25379=3D=3D    by 0x4104258C: (within /lib/libc-2.3.2.so)
=3D=3D25379=3D=3D    by 0x410424B7: putenv (in /lib/libc-2.3.2.so)
=3D=3D25379=3D=3D    by 0x808955B: addenv (in /bin/zsh4)
=3D=3D25380=3D=3D=20
=3D=3D25380=3D=3D Invalid write of size 4
=3D=3D25380=3D=3D    at 0x805DFF1: (within /bin/zsh4)
=3D=3D25380=3D=3D    by 0x805E513: execute (in /bin/zsh4)
=3D=3D25380=3D=3D    by 0x8061831: (within /bin/zsh4)
=3D=3D25380=3D=3D    by 0x805FE2C: (within /bin/zsh4)
=3D=3D25380=3D=3D    Address 0x40C96110 is 0 bytes after a block of size 17=
6 alloc'd
=3D=3D25380=3D=3D    at 0x40015CE9: realloc (vg_replace_malloc.c:299)
=3D=3D25380=3D=3D    by 0x4104258C: (within /lib/libc-2.3.2.so)
=3D=3D25380=3D=3D    by 0x410424B7: putenv (in /lib/libc-2.3.2.so)
=3D=3D25380=3D=3D    by 0x808955B: addenv (in /bin/zsh4)
=3D=3D25381=3D=3D discard syms in /lib/libnss_compat-2.3.2.so due to munmap=
()
=3D=3D25381=3D=3D discard syms in /lib/libnss_nis-2.3.2.so due to munmap()
=3D=3D25381=3D=3D discard syms in /lib/libnss_files-2.3.2.so due to munmap()
=3D=3D25381=3D=3D=20
=3D=3D25381=3D=3D ERROR SUMMARY: 14 errors from 2 contexts (suppressed: 0 f=
rom 0)
=3D=3D25381=3D=3D malloc/free: in use at exit: 241444 bytes in 10216 blocks.
=3D=3D25381=3D=3D malloc/free: 15820 allocs, 5604 frees, 1865417 bytes allo=
cated.
=3D=3D25381=3D=3D For a detailed leak analysis,  rerun with: --leak-check=
=3Dyes
=3D=3D25381=3D=3D For counts of detected errors, rerun with: -v
=3D=3D25382=3D=3D=20
=3D=3D25382=3D=3D Invalid write of size 4
=3D=3D25382=3D=3D    at 0x805DFF1: (within /bin/zsh4)
=3D=3D25382=3D=3D    by 0x805E513: execute (in /bin/zsh4)
=3D=3D25382=3D=3D    by 0x8061831: (within /bin/zsh4)
=3D=3D25382=3D=3D    by 0x805FE2C: (within /bin/zsh4)
=3D=3D25382=3D=3D    Address 0x40C96110 is 0 bytes after a block of size 17=
6 alloc'd
=3D=3D25382=3D=3D    at 0x40015CE9: realloc (vg_replace_malloc.c:299)
=3D=3D25382=3D=3D    by 0x4104258C: (within /lib/libc-2.3.2.so)
=3D=3D25382=3D=3D    by 0x410424B7: putenv (in /lib/libc-2.3.2.so)
=3D=3D25382=3D=3D    by 0x808955B: addenv (in /bin/zsh4)
=3D=3D25383=3D=3D=20
=3D=3D25383=3D=3D Invalid write of size 4
=3D=3D25383=3D=3D    at 0x805DFF1: (within /bin/zsh4)
=3D=3D25383=3D=3D    by 0x805E513: execute (in /bin/zsh4)
=3D=3D25383=3D=3D    by 0x8061831: (within /bin/zsh4)
=3D=3D25383=3D=3D    by 0x805FE2C: (within /bin/zsh4)
=3D=3D25383=3D=3D    Address 0x40C96110 is 0 bytes after a block of size 17=
6 alloc'd
=3D=3D25383=3D=3D    at 0x40015CE9: realloc (vg_replace_malloc.c:299)
=3D=3D25383=3D=3D    by 0x4104258C: (within /lib/libc-2.3.2.so)
=3D=3D25383=3D=3D    by 0x410424B7: putenv (in /lib/libc-2.3.2.so)
=3D=3D25383=3D=3D    by 0x808955B: addenv (in /bin/zsh4)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x4210E154: __memp_fopen_int_4001 (in /usr/lib/libd=
b-4.1.so)
=3D=3D25377=3D=3D    by 0x4210DB93: (within /usr/lib/libdb-4.1.so)
=3D=3D25377=3D=3D    by 0x420C73D3: __db_dbenv_setup_4001 (in /usr/lib/libd=
b-4.1.so)
=3D=3D25377=3D=3D    by 0x420D6E8F: __db_dbopen_4001 (in /usr/lib/libdb-4.1=
=2Eso)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x4100896A: _dl_relocate_object_internal (in /lib/l=
d-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4111DD70: (within /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4100B115: _dl_catch_error_internal (in /lib/ld-2.=
3.2.so)
=3D=3D25377=3D=3D    by 0x4111DFDB: _dl_open (in /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x41008976: _dl_relocate_object_internal (in /lib/l=
d-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4111DD70: (within /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4100B115: _dl_catch_error_internal (in /lib/ld-2.=
3.2.so)
=3D=3D25377=3D=3D    by 0x4111DFDB: _dl_open (in /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Syscall param open(pathname) contains uninitialised or un=
addressable byte(s)
=3D=3D25377=3D=3D    at 0x410E1778: __libc_open (in /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    by 0x41081207: _IO_file_fopen (in /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    by 0x4107745C: (within /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    by 0x410774BD: _IO_fopen (in /lib/libc-2.3.2.so)
=3D=3D25377=3D=3D    Address 0x0 is not stack'd, malloc'd or free'd
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x423E2008: gcry_mpi_print (in /usr/lib/libgcrypt.s=
o.1.5.1)
=3D=3D25377=3D=3D    by 0x423BA982: (within /usr/lib/libgcrypt.so.1.5.1)
=3D=3D25377=3D=3D    by 0x423BAD7E: gcry_sexp_build (in /usr/lib/libgcrypt.=
so.1.5.1)
=3D=3D25377=3D=3D    by 0x42320A14: (within /usr/lib/libgnutls.so.7.0.9)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x423E2008: gcry_mpi_print (in /usr/lib/libgcrypt.s=
o.1.5.1)
=3D=3D25377=3D=3D    by 0x423BA982: (within /usr/lib/libgcrypt.so.1.5.1)
=3D=3D25377=3D=3D    by 0x423BAD7E: gcry_sexp_build (in /usr/lib/libgcrypt.=
so.1.5.1)
=3D=3D25377=3D=3D    by 0x42320A34: (within /usr/lib/libgnutls.so.7.0.9)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x423E2008: gcry_mpi_print (in /usr/lib/libgcrypt.s=
o.1.5.1)
=3D=3D25377=3D=3D    by 0x423BA982: (within /usr/lib/libgcrypt.so.1.5.1)
=3D=3D25377=3D=3D    by 0x423BAD7E: gcry_sexp_build (in /usr/lib/libgcrypt.=
so.1.5.1)
=3D=3D25377=3D=3D    by 0x423C13C2: gcry_pk_encrypt (in /usr/lib/libgcrypt.=
so.1.5.1)
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D Conditional jump or move depends on uninitialised value(s)
=3D=3D25377=3D=3D    at 0x423E1F6C: gcry_mpi_print (in /usr/lib/libgcrypt.s=
o.1.5.1)
=3D=3D25377=3D=3D    by 0x4232029C: _gnutls_mpi_print (in /usr/lib/libgnutl=
s.so.7.0.9)
=3D=3D25377=3D=3D    by 0x4232FF1B: _gnutls_gen_dh_common_client_kx (in /us=
r/lib/libgnutls.so.7.0.9)
=3D=3D25377=3D=3D    by 0x4231BF2B: _gnutls_send_client_kx_message (in /usr=
/lib/libgnutls.so.7.0.9)
=3D=3D25377=3D=3D discard syms in /lib/libnss_compat-2.3.2.so due to munmap=
()
=3D=3D25377=3D=3D discard syms in /lib/libnss_nis-2.3.2.so due to munmap()
=3D=3D25377=3D=3D discard syms in /lib/libnss_ldap-2.3.2.so due to munmap()
=3D=3D25377=3D=3D discard syms in /usr/lib/libldap.so.2.0.122 due to munmap=
()
=3D=3D25377=3D=3D discard syms in /usr/lib/liblber.so.2.0.122 due to munmap=
()
=3D=3D25377=3D=3D discard syms in /usr/lib/libdb-4.1.so due to munmap()
=3D=3D25377=3D=3D discard syms in /usr/lib/libsasl2.so.2.0.15 due to munmap=
()
=3D=3D25377=3D=3D discard syms in /usr/lib/libgnutls.so.7.0.9 due to munmap=
()
=3D=3D25377=3D=3D discard syms in /lib/libcrypt-2.3.2.so due to munmap()
=3D=3D25377=3D=3D discard syms in /lib/libnss_files-2.3.2.so due to munmap()
=3D=3D25377=3D=3D discard syms in /lib/libnss_dns-2.3.2.so due to munmap()
=3D=3D25377=3D=3D=20
=3D=3D25377=3D=3D ERROR SUMMARY: 62 errors from 10 contexts (suppressed: 0 =
=66rom 0)
=3D=3D25377=3D=3D malloc/free: in use at exit: 1786659 bytes in 12714 block=
s.
=3D=3D25377=3D=3D malloc/free: 28010 allocs, 15296 frees, 3831552 bytes all=
ocated.
=3D=3D25377=3D=3D For a detailed leak analysis,  rerun with: --leak-check=
=3Dyes
=3D=3D25377=3D=3D For counts of detected errors, rerun with: -v

--+QahgC5+KEYLbs62--

--TRYliJ5NKNqkz5bu
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQE/npOpFjQHpltE9KURAhtqAJ0bPdRnY7BwQh7p9r9kUeIhjB44sACdHZwS
cnu2tbdBHvty2iCvZdXVIvc=
=iTzw
-----END PGP SIGNATURE-----

--TRYliJ5NKNqkz5bu--

