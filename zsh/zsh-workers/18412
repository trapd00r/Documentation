From zsh-workers-return-18412-mason-zsh=primenet.com.au@sunsite.dk Mon Mar 31 21:59:21 2003
Return-Path: <zsh-workers-return-18412-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15879 invoked from network); 31 Mar 2003 21:59:21 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 31 Mar 2003 21:59:21 -0000
Received: (qmail 17277 invoked by alias); 31 Mar 2003 21:59:13 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18412
Received: (qmail 17270 invoked from network); 31 Mar 2003 21:59:13 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 31 Mar 2003 21:59:13 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [198.51.251.8] by sunsite.dk (MessageWall 1.0.8) with SMTP; 31 Mar 2003 21:59:12 -0000
Received: from chorus.teradyne.com (chorus.teradyne.com [131.101.1.195])
	by rent.teradyne.com (8.8.8+Sun/8.8.8) with ESMTP id QAA19210;
	Mon, 31 Mar 2003 16:59:11 -0500 (EST)
Received: from kiki.icd.teradyne.com (kiki.icd.teradyne.com [131.101.10.126]) by chorus.teradyne.com (8.8.8+Sun/8.7.1) with ESMTP id QAA19885; Mon, 31 Mar 2003 16:59:11 -0500 (EST)
Received: from denver.icd.teradyne.com (denver [131.101.18.106])
	by kiki.icd.teradyne.com (8.9.3+Sun/8.9.3) with ESMTP id QAA04188;
	Mon, 31 Mar 2003 16:59:24 -0500 (EST)
Received: (from shelton@localhost)
	by denver.icd.teradyne.com (8.11.6+Sun/8.11.6) id h2VLxAv05725;
	Mon, 31 Mar 2003 16:59:10 -0500 (EST)
X-Authentication-Warning: denver.icd.teradyne.com: shelton set sender to shelton@icd.teradyne.com using -f
To: Peter Stephenson <pws@csr.com>
Cc: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: Test Failures
From: Vin Shelton <shelton@icd.teradyne.com>
Organization: Teradyne, Inc
Date: Mon, 31 Mar 2003 16:59:10 -0500
In-Reply-To: <24740.1049106138@csr.com> (Peter Stephenson's message of "Mon,
 31 Mar 2003 11:22:18 +0100")
Message-ID: <545wuiffb9t.fsf@icd.teradyne.com>
Lines: 151
References: <24740.1049106138@csr.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Peter Stephenson <pws@csr.com> writes:
> Vin Shelton wrote:
>> > } ***************
>> > } *** 1,2 ****
>> > } - 1) one     2) two     3) three   
>> > }   input> input> 
>> > } --- 1 ----
>> > } Was testing: `select' loop
>> 
>> OK, FWIW, I see the failure on both Solaris 5.5 and 5.8 at work, and
>> on my linux box:
>
> Does normal select work?
Normal select works.  At least this script:

    #!/bin/sh
 
    # Execute this script under the Z shell
    [ ! -n "$ZSH_VERSION" ] && exec zsh -f "$0" ${1+"$@"}

    progname=${0:t}

    PROMPT3='Select prompt> '

    select choice in one two three
    do
      case $choice in
      (one|two|three)
        echo You chose $choice
        break
        ;;
      esac
    done

does the expected thing.

> If so, does it non-interactively send messages to stderr?
I'm not sure what you mean here.  When I run the script here is what
gets output to stderr:

    1) one    2) two    3) three  
    Select prompt> 


> Any sign of the missing message appearing on the terminal?
No.  I ran:
  ZTST_verbose=1 make TESTNUM=A01 check >out 2>err

Here is the contents of out:
    cd Test ; make check
    make[1]: Entering directory `/u/shelton2/software/build/SunOS-5.8/zsh-2003-03-31-1145/Test'
    if test -n "/opt/SUNWspro/bin/cc"; then \
      cd .. && DESTDIR= \
      make MODDIR=`pwd`/Test/Modules install.modules > /dev/null; \
    fi
    for f in /u/shelton2/software/src/zsh-2003-03-31-1145/Test/A01*.ztst; do \
      ../Src/zsh +Z -f /u/shelton2/software/src/zsh-2003-03-31-1145/Test/ztst.zsh $f; \
    done
    /u/shelton2/software/src/zsh-2003-03-31-1145/Test/A01grammar.ztst: starting.
    Running test: Basic pipeline handling
    Test successful.
    Running test: Exit status of pipeline with builtins (true)
    Test successful.
    Running test: Exit status of pipeline with builtins (false)
    Test successful.
    Running test: Basic coprocess handling
    Test successful.
    Running test: Basic sublist (i)
    Test successful.
    Running test: Basic sublist (ii)
    Test successful.
    Running test: Basic subshell list with error
    Test successful.
    Running test: Basic current shell list with error
    Test successful.
    Running test: `-' precommand modifier
    Test successful.
    Running test: `noglob' precommand modifier
    Test successful.
    Running test: `exec' precommand modifier
    Test successful.
    Running test: `command' precommand modifier
    Test successful.
    Running test: `builtin' precommand modifier
    Test successful.
    Running test: `if ...' (i)
    Test successful.
    Running test: `if ...' (ii)
    Test successful.
    Running test: `if ...' (iii)
    Test successful.
    Running test: `if ...' (iv)
    Test successful.
    Running test: `for' loop
    Test successful.
    Running test: `for' loop with newline before in keyword
    Test successful.
    Running test: arithmetic `for' loop
    Test successful.
    Running test: enhanced `for' syntax with two loop variables
    Test successful.
    Running test: enhanced `for' syntax with three loop variables
    Test successful.
    Running test: compatibility of enhanced `for' syntax with standard syntax
    Test successful.
    Running test: `while' loop
    Test successful.
    Running test: `until' loop
    Test successful.
    Running test: `repeat' loop
    Test successful.
    Running test: `case', old syntax
    Test successful.
    Running test: `case', new syntax
    Test successful.
    Running test: `case', new syntax, cascaded
    Test successful.
    Running test: `select' loop
    *** /tmp/zsh.ztst.err.5558	Mon Mar 31 16:33:24 2003
    --- /tmp/zsh.ztst.terr.5558	Mon Mar 31 16:33:24 2003
    ***************
    *** 1,2 ****
    ! 1) one     2) two     3) three   
      input> input> 
    --- 1,2 ----
    ! 1) one    2) two    3) three  
      input> input> 
    Test /u/shelton2/software/src/zsh-2003-03-31-1145/Test/A01grammar.ztst failed: error output differs from expected as shown above for:
      PS3="input> "
      select name in one two three; do
        print $name
      done
    Was testing: `select' loop
    /u/shelton2/software/src/zsh-2003-03-31-1145/Test/A01grammar.ztst: test failed.
    rm -rf Modules .zcompdump
    make[1]: Leaving directory `/u/shelton2/software/build/SunOS-5.8/zsh-2003-03-31-1145/Test'

Here is the contents of err:
    mkdir /u/shelton2/software/build/SunOS-5.8/zsh-2003-03-31-1145/Test/Modules
    mkdir /u/shelton2/software/build/SunOS-5.8/zsh-2003-03-31-1145/Test/Modules/zsh
    mkdir /u/shelton2/software/build/SunOS-5.8/zsh-2003-03-31-1145/Test/Modules/zsh/net
    make[1]: [check] Error 1 (ignored)

and nothing was printed on the terminal.  It looks to me that the only
difference is that there are extra spaces in the first line:
'one     ' vs. 'one    ',
'two     ' vs. 'two    ' and
'three   ' vs. 'three  '.


  - Vin

