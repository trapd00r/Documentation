From zsh-workers-return-13355-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 16 08:34:55 2001
Return-Path: <zsh-workers-return-13355-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22736 invoked from network); 16 Jan 2001 08:34:53 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 16 Jan 2001 08:34:53 -0000
Received: (qmail 3578 invoked by alias); 16 Jan 2001 08:34:47 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13355
Received: (qmail 3562 invoked from network); 16 Jan 2001 08:34:46 -0000
Sender: kvho@sebb.bel.alcatel.be
Message-ID: <3A6406C0.AF8A744A@alcatel.be>
Date: Tue, 16 Jan 2001 09:30:56 +0100
From: koen van hoof <koen.van_hoof@alcatel.be>
Reply-To: koen.van_hoof@alcatel.be
Organization: Alcatel Bell
X-Mailer: Mozilla 4.7 [en] (X11; I; SunOS 5.6 sun4u)
X-Accept-Language: en
MIME-Version: 1.0
To: Bart Schaefer <schaefer@candle.brasslantern.com>
CC: zsh-workers@sunsite.auc.dk
Subject: Re: TERMCAP problem.
References: <3A62CD8D.2DC85B34@alcatel.be> 
		<20010115094653.A2172@dan.emsphone.com> <1010115172300.ZM15781@candle.brasslantern.com>
Content-Type: multipart/mixed;
 boundary="------------7FA55E76FAC867F75C760646"

This is a multi-part message in MIME format.
--------------7FA55E76FAC867F75C760646
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Bart Schaefer wrote:

> On Jan 15,  9:46am, Dan Nelson wrote:
> } Subject: Re: TERMCAP problem.
> }
> } In the last episode (Jan 15), koen van hoof said:
> } > zsh V3.1.9 and termcap V1.3 on SunOS se9ws265 5.6 Generic_105181-03
> } > sun4u sparc
> [...]
> } > it core dumps, because at a certain moment getenv("TERM")
> } > returns 0 and this is fed into a strcmp.
> }
> } getenv("TERM") should never return 0.  screen sets both TERM and
> } TERMCAP on all my machines.
>
> But zsh shouldn't dump core when TERM is not set, even so.
>
> Koen, you're going to have to give us more details (if you can) about the
> core dump.  As far as I can tell, zsh never feeds the result of getenv()
> directly to strcmp().  $TERM is handled by params.c:termsetfn(), which
> always sets the global char *term to the empty string when $TERM is NULL;
> later comparisons on the terminal type always use *term, which should
> never be NULL unless ztrdup("") failed (which would indicate a serious
> memory allocation problem).
>

Bart,
Here is the backtrace.  If you want, I can also send you the core file.
#0  0xef5a4274 in strcmp () from /usr/lib/libc.so.1
#1  0x126c00 in tgetent (bp=0x0, name=0x15c2e8 "xterm") at termcap.c:469
#2  0x48608 in init_term () at init.c:478
#3  0x6f808 in termsetfn (pm=0x145e20, x=0x15c2e8 "xterm") at params.c:2763
#4  0x6c514 in setstrvalue (v=0xefffed28, val=0x15c2e8 "xterm") at params.c:1513

#5  0x6d7d0 in setsparam (s=0xeffffe45 "", val=0x15c2e8 "xterm") at
params.c:1810
#6  0x6767c in createparamtable () at params.c:515
#7  0x491d0 in setupvals () at init.c:715
#8  0x12158 in main (argc=1, argv=0xeffff4ac) at ./main.c:78

>
> --
> Bart Schaefer                                 Brass Lantern Enterprises
> http://www.well.com/user/barts              http://www.brasslantern.com
>
> Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net

--
==========================================================
Koen Van Hoof    koen.van_hoof@alcatel.be   32 3 451 60 31
==========================================================



--------------7FA55E76FAC867F75C760646
Content-Type: text/x-vcard; charset=us-ascii;
 name="koen.van_hoof.vcf"
Content-Transfer-Encoding: 7bit
Content-Description: Card for koen van hoof
Content-Disposition: attachment;
 filename="koen.van_hoof.vcf"

begin:vcard 
n:Van Hoof;Koen
x-mozilla-html:TRUE
adr:;;;;;;
version:2.1
email;internet:koen.van_hoof@alcatel.be
x-mozilla-cpt:;0
fn:Koen Van Hoof
end:vcard

--------------7FA55E76FAC867F75C760646--

