From zsh-workers-return-8933-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Dec 07 16:14:28 1999
Return-Path: <zsh-workers-return-8933-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11504 invoked from network); 7 Dec 1999 16:14:22 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Dec 1999 16:14:22 -0000
Received: (qmail 21580 invoked by alias); 7 Dec 1999 16:14:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8933
Received: (qmail 21569 invoked from network); 7 Dec 1999 16:14:15 -0000
Date: Tue, 7 Dec 1999 11:14:13 -0500
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: manpage reference transforms
Message-ID: <19991207111413.A10562@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0i

This monster makes the manpages refer to each other properly,
except for "zsh", which I didn't replace for obvious reasons.
The slashes should probably be changed to commas for
consistency's sake.

AFAICT the only two major things not yet being transformed
are the references to zsh.1 in the manpages, and the Texinfo
description.

--- Doc/Makefile.in.old
+++ Doc/Makefile.in
@@ -171,13 +171,8 @@
 	tzsh=`echo zsh | sed '$(transform); s/,/\\\\,/g'`; \
 	for file in $(MAN); do \
 	  tfile=`echo $$file | sed "s,zsh,$$tzsh,"`; \
-	  if test -f $$file; then \
-	    cp -f $$file $$tfile; \
-	  elif test -f $(sdir)/$$file; then \
-	    cp -f $(sdir)/$$file $$tfile; \
-	  else :; \
-	  fi || exit 1; \
-	  $(INSTALL_DATA) $$tfile $(DESTDIR)$(mandir)/man1 || exit 1; \
+	sed "s/zshall/$${tzsh}all/; s/zshmisc/$${tzsh}misc/; s/zshexpn/$${tzsh}expn/; s/zshparam/$${tzsh}param/; s/zshoptions/$${tzsh}options/; s/zshbuiltins/$${tzsh}builtins/; s/zshzle/$${tzsh}zle/; s/zshcompwid/$${tzsh}compwid/; s/zshcompctl/$${tzsh}compctl/; s/zshmodules/$${tzsh}modules/; s/zshcompsys/$${tzsh}compsys/;" \
+	$(sdir)/$$file >$(DESTDIR)$(mandir)/man1/$$tfile || exit 1; \
 	done
 
 # install info pages, creating install directory if necessary

