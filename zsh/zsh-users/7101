From zsh-users-return-7101-mason-zsh=primenet.com.au@sunsite.dk Tue Mar 02 11:48:29 2004
Return-Path: <zsh-users-return-7101-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12523 invoked from network); 2 Mar 2004 11:48:28 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 2 Mar 2004 11:48:28 -0000
Received: (qmail 19748 invoked by alias); 2 Mar 2004 11:48:15 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7101
Received: (qmail 19718 invoked from network); 2 Mar 2004 11:48:14 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 2 Mar 2004 11:48:14 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [195.54.107.70] by sunsite.dk (MessageWall 1.0.8) with SMTP; 2 Mar 2004 11:48:14 -0000
Received: from puritan.pcp.ath.cx ([213.112.43.212] [213.112.43.212])
          by mxfep01.bredband.com with ESMTP
          id <20040302114814.XZH12060.mxfep01.bredband.com@puritan.pcp.ath.cx>
          for <zsh-users@sunsite.dk>; Tue, 2 Mar 2004 12:48:14 +0100
Received: by puritan.pcp.ath.cx (Postfix, from userid 1000)
	id: 48:15 +0100 (CET)
Date: Tue, 2 Mar 2004 12:48:15 +0100
From: Nikolai Weibull <zsh-users-list@pcppopper.org>
To: Zsh users list <zsh-users@sunsite.dk>
Subject: Re: Two Questions
Message-ID: <20040302114814.GH1981@puritan.pcp.ath.cx>
References: <20040302111425.GG1981@puritan.pcp.ath.cx> <20748.1078227229@csr.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20748.1078227229@csr.com>
User-Agent: Mutt/1.5.6i

* Peter Stephenson <pws@csr.com> [Mar 02, 2004 12:40]:
> > [= not being taken into account]
>
> This seems to be a fully paid up bug...  I think it's simply that
> this chunk in _main_complete isn't testing for the option before
> trying to make `=' special.  (Leading `=' should now work regardless
> of magicequalsubst --- it seems that's already smart enough to match
> a non-leading `='.)
>
> Index: Completion/Base/Core/_main_complete
> ===================================================================
> RCS file: /cvsroot/zsh/zsh/Completion/Base/Core/_main_complete,v
> retrieving revision 1.8
> diff -u -r1.8 _main_complete
> --- Completion/Base/Core/_main_complete	1 Aug 2003 16:29:21 -0000	1.8
> +++ Completion/Base/Core/_main_complete	2 Mar 2004 11:24:04 -0000
> @@ -57,7 +57,7 @@
>  # Special completion contexts after `~' and `='.
>
>  if [[ -z "$compstate[quote]" ]]; then
> -  if compset -P 1 '='; then
> +  if [[ -o equals ]] && compset -P 1 '='; then
>      compstate[context]=equal
>    elif [[ "$PREFIX" != */* && "$PREFIX[1]" = '~' ]]; then
>      compset -p 1

Aw nice.  This was what I tried doing, but I did
  if compset -P 1 '=' && [[ -o equals ]]; then
instead (and I hadn't done the compdef from the previous mail either).

Works like a charm, thanks!
	nikolai

--
::: name: Nikolai Weibull    :: aliases: pcp / lone-star / aka :::
::: born: Chicago, IL USA    :: loc atm: Gothenburg, Sweden    :::
::: page: www.pcppopper.org  :: fun atm: gf,lps,ruby,lisp,war3 :::
main(){printf(&linux["\021%six\012\0"],(linux)["have"]+"fun"-97);}

