From zsh-users-return-15208-mason-zsh=primenet.com.au@zsh.org Thu Jul 29 16:13:45 2010
Return-Path: <zsh-users-return-15208-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13524 invoked by alias); 29 Jul 2010 16:13:45 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15208
Received: (qmail 10456 invoked from network); 29 Jul 2010 16:13:40 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_NONE
	autolearn=ham version=3.3.1
Received-SPF: softfail (ns1.primenet.com.au: transitioning SPF record at sysctl.co.uk does not designate 74.125.83.171 as permitted sender)
Subject: Re: Zsh autocompletion with no access to a parent directory
Mime-Version: 1.0 (Apple Message framework v1159)
Content-Type: text/plain; charset=us-ascii
From: Matt Wright <matt@sysctl.co.uk>
In-Reply-To: <20100430093251.4fcd8c45@csr.com>
Date: Thu, 29 Jul 2010 08:46:47 -0700
Cc: zsh-users@zsh.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <548B2AA0-8397-4292-A41B-156FDC42B886@sysctl.co.uk>
References: <3663DC29-7A8F-4A0C-8262-5FFE701C8E3A@sysctl.co.uk> <20100413174533.5a15043a@news01> <361816B9-75B6-4C88-8BE9-097B33CA2283@sysctl.co.uk> <201004140914.o3E9EPkL009936@news01.csr.com> <201004140947.o3E9llgG010201@news01.csr.com> <C1A23A01-1F48-4C3B-9232-C44EC0AA7C6F@sysctl.co.uk> <20100423224428.7479faa8@pws-pc> <20100429223850.14143862@pws-pc> <04C31B8F-4588-4DA0-93E6-EB175CEFA6F6@sysctl.co.uk> <20100430093251.4fcd8c45@csr.com>
To: Peter Stephenson <pws@csr.com>
X-Mailer: Apple Mail (2.1159)

Apologies for necroing this thread but I've hit a snag with this stuff =
and I can't work out whats going on. I threw some debug in around the =
code you changed in _path_files but all the paths look sane. After that =
it barrels off down compfiles code and my brain leapt out my left =
armpit.

If I do the following, using the _path_files changes you supplied me =
long ago:

# mkdir -p /tmp/foo\~bar/test
# ls /tmp/foo~bar/te<TAB>

All I get is:

[caesium: ~]$ ls /tmp/foo~bar/te
No matches found for: `files'

If I back up and TAB at the end of "foo~bar", zsh changes my prompt to:

[caesium: ~]$ ls /tmp/foo\~bar/=20

After which, it carries on completing properly. There's also a case I =
have at work where pressing tab in a setup like this appears to expand =
the ~ to \~ and then copy the entire completion path again. Though I =
don't appear to be able to replicate it right now I'll give you the gist =
below incase it rings any bells.

# command /var/tmp/foo~quack/usr/lib/local/foo<tab>

This becomes:

# command /var/tmp/foo\~quack//var/tmp/foo~quack/usr/lib/local/foo

And things get very confused.

M

On Apr 30, 2010, at 1:32 AM, Peter Stephenson wrote:

> On Thu, 29 Apr 2010 15:14:33 -0700
> Matt Wright <matt@sysctl.co.uk> wrote:
>>> Matt, could you make sure this doesn't break anything?  Of course,
>>> with code this trivial it's hard to make a mistake.  Sob.
>>=20
>> Tried to at work and git-apply hates the patch format. Not sure why.
>> Also patch -p0 wouldn't apply it cleanly to the current top-of-git.
>=20
> It should apply OK to what's in the archive (and does here), but I did
> change the previous patch from what I gave you before, so it would be
> problematic with anything not under revision control...
>=20
> Here's a patch against what was in the archive before I started =
tinkering
> with it so it should apply to something older, as well as the new
> patch.
>=20
> pws
>=20
>=20
> Member of the CSR plc group of companies. CSR plc registered in =
England and Wales, registered number 4187346, registered office =
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 =
0WZ, United Kingdom
> <path_files_against_old.dif><path_files_against_new.dif>

