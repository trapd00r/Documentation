From zsh-users-return-14045-mason-zsh=primenet.com.au@sunsite.dk Fri Apr 17 20:26:13 2009
Return-Path: <zsh-users-return-14045-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24216 invoked from network); 17 Apr 2009 20:26:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 Apr 2009 20:26:09 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 27667 invoked from network); 17 Apr 2009 20:25:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 Apr 2009 20:25:49 -0000
Received: (qmail 25391 invoked by alias); 17 Apr 2009 20:25:34 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14045
Received: (qmail 25380 invoked from network); 17 Apr 2009 20:25:34 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 17 Apr 2009 20:25:34 -0000
Received: from smtp.benizi.com (www5.pairlite.com [64.130.10.15])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 606DF82D4B6A
	for <zsh-users@sunsite.dk>; Fri, 17 Apr 2009 22:25:09 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp.benizi.com (Postfix) with ESMTPSA id B12261911B;
	Fri, 17 Apr 2009 16:25:33 -0400 (EDT)
Date: Fri, 17 Apr 2009 16:25:33 -0400 (EDT)
From: "Benjamin R. Haskell" <zsh@benizi.com>
To: Zsh Users <zsh-users@sunsite.dk>
Subject: Re: error on TTY read: bad file descriptor
In-Reply-To: <20090414055549.98484.qmail@smasher.org>
Message-ID: <alpine.LNX.2.00.0904171607080.773@averatec.internal>
References: <20090414055549.98484.qmail@smasher.org>
User-Agent: Alpine 2.00 (LNX 1169 2008-08-27)
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Scanned: ClamAV 0.92.1/9252/Fri Apr 17 20:21:29 2009 on bifrost
X-Virus-Status: Clean

On Tue, 14 Apr 2009, Atom Smasher wrote:

> here's an edge case...
> 
>  ## Cygwin 6.8.99.903(242)
>  ## zsh 4.3.9 (i686-pc-cygwin)
> 
> http://smasher.org/tmp/zsh-tty-fail.txt
> 
> start up zsh in an XTerm(tm) with no rc file (zsh -f) then source the file
> "zsh-tty-fail.txt".
> 
> not every time, but most of the time, when you re-size the terminal the shell
> will die with the message:
> 	zsh: error on TTY read: bad file descriptor
> 
> the workaround so far is to just disable TRAPWINCH if it's an xterm on cygwin.
> google doesn't tell me much about the error, except that someone found it once
> before but didn't give enough details for it to be duplicated. with this set
> up i can cause the error very consistently.

Just as another data point, I can't duplicate this, even though I'm using 
the same versions of xterm and Zsh.  Other possible variables:

Cygwin/X X Server / Version 1.5.3 (20090222)

Microsoft Windows Server 2003 R2 / Standard Edition / Service Pack 2

Cygwin DLL version info: (from cygcheck -s)
 DLL version: 1.5.25
 DLL epoch: 19
 API major: 0
 API minor: 156


(1.5.25 seems old... I thought 1.7 was out... will check on that and 
report back if I upgrade and it breaks.)

Best,
Ben

