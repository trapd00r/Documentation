From zsh-workers-return-12496-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Aug 03 11:10:56 2000
Return-Path: <zsh-workers-return-12496-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7726 invoked from network); 3 Aug 2000 11:10:54 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 3 Aug 2000 11:10:54 -0000
Received: (qmail 21725 invoked by alias); 3 Aug 2000 11:10:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12496
Received: (qmail 21718 invoked from network); 3 Aug 2000 11:10:18 -0000
Date: Thu, 3 Aug 2000 13:10:03 +0200 (MET DST)
Message-Id: <200008031110.NAA09282@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 03 Aug 2000 18:23:42 +0900
Subject: PATCH: Re: completion problem with filename including #


Tanaka Akira wrote:

> Z:akr@cvs% zsh -f
> cvs% bindkey -e; autoload -U compinit; compinit -D
> cvs% rmdir /cvs/root/www/\#cvs.lock/<TAB>
> _path_files:327: bad pattern: /cvs/root/www/#cvs.lock/*(-/)

Damn. This `quoting of glob characters' just made it one more step up
in my list of things that would be nice to have in C-code, efficiently.

Bye
 Sven

Index: Completion/Core/_path_files
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_path_files,v
retrieving revision 1.27
diff -u -r1.27 _path_files
--- Completion/Core/_path_files	2000/07/26 09:16:13	1.27
+++ Completion/Core/_path_files	2000/08/03 11:08:38
@@ -421,6 +421,7 @@
     # There are more components, so skip over the next components and make a
     # slash be added.
 
+    tmp1=( ${tmp1//(#b)([][()|*?^#~<>])/\\${match[1]}} )
     tmp2="${(M)tpre##((.|..|)/)##}"
     if [[ -n "$tmp2" ]]; then
       skipped="/$tmp2"

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

