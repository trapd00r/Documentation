From zsh-workers-request@euclid.skiles.gatech.edu  Sun Nov  3 02:46:00 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id CAA23920 for <mason@primenet.com.au>; Sun, 3 Nov 1996 02:45:57 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id KAA28290; Sat, 2 Nov 1996 10:24:50 -0500 (EST)
Resent-Date: Sat, 2 Nov 1996 10:24:50 -0500 (EST)
Date: Sat, 2 Nov 1996 16:25:00 +0100 (MET)
From: "C. v. Stuckrad" <stucki@math.fu-berlin.de>
X-Sender: stucki@petzval
Reply-To: "C. v. Stuckrad" <stucki@math.fu-berlin.de>
To: Zsh workers list <zsh-workers@math.gatech.edu>
Subject: Strange coredump in new zsh-3.0.1 on Sunos4.1.3
Message-ID: <Pine.GSO.3.95.961102161204.26939J-100000@petzval>
X-TestHeaderA: Written by C. v. Stuckrad; FB. Mathematik; EDV
X-TestHeaderB: FU-Berlin; Arnimallee 2-6; 14195 Berlin; GERMANY
Priority: normal
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Resent-Message-ID: <"CFyNH1.0.vv6.2VsUo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2312
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu


Hi!

I yesterday tried to install the new 3.0.1 including the two patches
from the zsh-workers-list (Subjects: '4 bugs' + 'strange behaviour of autocd')
compiled on SunOS 4.1.3 with gcc 2.7.2.                   Then:

ONE zsh was fine (freshly logged in)
on top of 'screen' no zhsh would survive (vers. 3.0.0 does though).
and I get a coredump always at places like VARIABLE=`program` 
The places divver, I cud not find a 'real' system in the dumps,
but ALWAYS it's inside the initialisation files, and always at
an definition of a Variable. One stacktrace of gdb follows here:
-------------------- snip ---------------------------
GDB 4.11 (sparc-sun-sunos4.1.3),
Copyright 1993 Free Software Foundation, Inc...
Core was generated by `zsh'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /usr/lib/libc.so.1.8...done.
Reading symbols from /usr/lib/libdl.so.1.0...done.
#0  0x6fe4c in zclose (fd=19) at utils.c:921
921             while (!fdtable[max_zsh_fd])
(gdb) where
#0  0x6fe4c in zclose (fd=19) at utils.c:921
#1  0x25a2c in getoutput (cmd=0xce334 "/usr/local/etc/dotpath", qt=1)
    at exec.c:2051
#2  0x63764 in stringsubst (list=0xdbc40, node=0xdbc48, ssub=4) at subst.c:164
#3  0x62f2c in prefork (list=0xdbc40, flags=7) at subst.c:72
#4  0x217bc in addvars (l=0xce494, export=0) at exec.c:1070
#5  0x2253c in execcmd (cmd=0xce464, input=0, output=0, how=2, last1=2)
    at exec.c:1253
#6  0x2055c in execpline2 (pline=0xce4c0, how=2, input=0, output=0, last1=0)
    at exec.c:801
#7  0x1fa6c in execpline (l=0xce450, how=2, last1=0) at exec.c:647
#8  0x1f524 in execlist (list=0xce4d0, dont_change_job=1, exiting=0)
    at exec.c:527
#9  0x4c600 in execif (cmd=0xcda30) at loop.c:265
#10 0x23de8 in execcmd (cmd=0xcda30, input=0, output=0, how=2, last1=2)
    at exec.c:1606
#11 0x2055c in execpline2 (pline=0xce658, how=2, input=0, output=0, last1=0)
    at exec.c:801
#12 0x1fa6c in execpline (l=0xcda1c, how=2, last1=0) at exec.c:647
#13 0x1f524 in execlist (list=0xce668, dont_change_job=1, exiting=0)
    at exec.c:527
#14 0x4c600 in execif (cmd=0xccf20) at loop.c:265
#15 0x23de8 in execcmd (cmd=0xccf20, input=0, output=0, how=2, last1=2)
    at exec.c:1606
#16 0x2055c in execpline2 (pline=0xdb828, how=2, input=0, output=0, last1=0)
    at exec.c:801
#17 0x1fa6c in execpline (l=0xccf0c, how=2, last1=0) at exec.c:647
#18 0x1f524 in execlist (list=0xdb838, dont_change_job=0, exiting=0)
    at exec.c:527
#19 0x3e6c4 in loop (toplevel=0) at init.c:126
#20 0x40c8c in source (s=0xefffecb8 "/Vol/petzval_h1/stucki/.zsh/.zshenv")
    at init.c:803
#21 0x40e70 in sourcehome (s=0x406b0 ".zshenv") at init.c:840
#22 0x408c0 in run_init_scripts () at init.c:721
#23 0x3e3e4 in main (argc=4, argv=0xeffff204) at init.c:69
(gdb)
----------------------------- snip ---------------------------------

Any ideas ?  The (nearly) same setup on Solaris2.4 works so far !
How shall I debug this further ? The zsh is compiled WITH zsh-mem
and all debugging included, but did not tell something.

Clueless, Stucki


Christoph von Stuckrad       * *  | talk to  | <stucki@math.fu-berlin.de> \
Freie Universitaet Berlin    |/_* | nickname | ...!unido!fub!leibniz!stucki|
Fachbereich Mathematik, EDV  |\ * | 'stucki' | Tel:+49 30 838-7545{9|8}    |
Arnimallee 2-6/14195 Berlin  * *  |  on IRC  | Fax:+49 30 838-5913        /

