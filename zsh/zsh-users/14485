From zsh-users-return-14485-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 12 09:04:41 2009
Return-Path: <zsh-users-return-14485-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28018 invoked from network); 12 Oct 2009 09:04:27 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 12 Oct 2009 09:04:27 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 76431 invoked from network); 12 Oct 2009 09:04:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Oct 2009 09:04:13 -0000
Received: (qmail 29963 invoked by alias); 12 Oct 2009 09:04:02 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14485
Received: (qmail 29946 invoked from network); 12 Oct 2009 09:04:01 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 12 Oct 2009 09:04:01 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 064E9805D0AA
	for <zsh-users@sunsite.dk>; Mon, 12 Oct 2009 11:03:52 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly51d.srv.mailcontrol.com (MailControl) with ESMTP id n9C93njq031740
	for <zsh-users@sunsite.dk>; Mon, 12 Oct 2009 10:03:49 +0100
Received: from news01.csr.com ([10.99.50.25]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 12 Oct 2009 10:03:49 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id n9C93nWi015832
	for <zsh-users@sunsite.dk>; Mon, 12 Oct 2009 10:03:49 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id n9C93meM015828
	for <zsh-users@sunsite.dk>; Mon, 12 Oct 2009 10:03:49 +0100
Message-Id: <200910120903.n9C93meM015828@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: How to make underlining of a command line disappear after an ordinary key press? (2)
In-reply-to: <937889.54824.qm@web65607.mail.ac4.yahoo.com>
References: <937889.54824.qm@web65607.mail.ac4.yahoo.com>
Comments: In-reply-to Guido van Steen <gvsteen@yahoo.com>
   message dated "Sun, 11 Oct 2009 20:06:34 -0700."
Date: Mon, 12 Oct 2009 10:03:48 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 12 Oct 2009 09:03:49.0529 (UTC) FILETIME=[E9AF4090:01CA4B1A]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-09-22-01 (www.mailcontrol.com) on 10.68.0.161
X-Virus-Scanned: ClamAV 0.94.2/9882/Mon Oct 12 05:15:10 2009 on bifrost
X-Virus-Status: Clean

Guido van Steen wrote:
> ordinary-key-press(){
> 	if [[ $KEYS = [[:print:]] ]]; then
> 		region_highlight=("0 0 underline")
> 	fi
> 	zle .self-insert
> }
> 
> zle -N .self-insert ordinary-key-press

You *don't* want the "." in the zle -N.  The whole point of the
dot-commands is that they can't be replaced by user widgets.  That's
the same reason you *do* want it in the function.

  ordinary-key-press(){
  	if [[ $KEYS = [[:print:]] ]]; then
  		region_highlight=("0 0 underline")
  	fi
  	zle .self-insert
  }

  zle -N self-insert ordinary-key-press

There's nothing special about space so long as it's bound to
self-insert; I had no trouble using it.

By the way, if you ever need to undo this, the incantation is

  zle -A .self-insert self-insert

---don't simply delete self-insert or you will have trouble typing.

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

