From zsh-workers-return-24420-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 22 00:00:36 2008
Return-Path: <zsh-workers-return-24420-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10037 invoked from network); 22 Jan 2008 00:00:32 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-0.5 required=5.0 tests=BAYES_00,RCVD_NUMERIC_HELO
	autolearn=no version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 22 Jan 2008 00:00:32 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 78445 invoked from network); 22 Jan 2008 00:00:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 22 Jan 2008 00:00:22 -0000
Received: (qmail 13915 invoked by alias); 22 Jan 2008 00:00:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24420
Received: (qmail 13899 invoked from network); 22 Jan 2008 00:00:17 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 22 Jan 2008 00:00:17 -0000
Received: from virusfilter.dotsrc.org (bifrost [127.0.0.1])
	by spamfilter.dotsrc.org (Postfix) with ESMTP id 187C28058F58
	for <zsh-workers@sunsite.dk>; Tue, 22 Jan 2008 01:00:01 +0100 (CET)
Received: from ciao.gmane.org (main.gmane.org [80.91.229.2])
	by bifrost.dotsrc.org (Postfix) with ESMTP
	for <zsh-workers@sunsite.dk>; Tue, 22 Jan 2008 01:00:00 +0100 (CET)
Received: from root by ciao.gmane.org with local (Exim 4.43)
	id 1JH6Yc-0004AE-Px
	for zsh-workers@sunsite.dk; Tue, 22 Jan 2008 00:00:02 +0000
Received: from 84.119.35.225 ([84.119.35.225])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-workers@sunsite.dk>; Tue, 22 Jan 2008 00:00:02 +0000
Received: from steiner.sepp by 84.119.35.225 with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-workers@sunsite.dk>; Tue, 22 Jan 2008 00:00:02 +0000
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-workers@sunsite.dk
From:  Sepp Steiner <steiner.sepp@gmx.net>
Subject:  [PATCH] _net_interfaces: enable completion for mappings on debian
 systems
Date:  Tue, 22 Jan 2008 00:58:39 +0100
Lines: 37
Message-ID: <fn3bjk$4o6$1@ger.gmane.org>
Mime-Version:  1.0
Content-Type:  text/plain; charset=us-ascii
Content-Transfer-Encoding:  7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 84.119.35.225
User-Agent: slrn/0.9.8.1pl2 (Debian)
Sender: news <news@ger.gmane.org>
X-Virus-Scanned: ClamAV using ClamSMTP

The main part of this patch enables completion of mappings for ifup on 
debian systems and for ifdown the completion lists only interfaces that 
are really up and running.

The first part of the patch avoids use of sed, when filling ${intf}.

The second part contains the patch to enable completion for mappings and
corrections of ifdown.

1. ifdown: If we call completion for ifdown look in
           /etc/network/run/ifstate and list the registered interfaces

2. ifup: My patch tries to dedect, if you use mappings. If you do use
         them, then my _net_interfaces completion lists all cominations
	 of interfaces and mappings, excluding the loopback interface.
	 In any other case it acts in the same way as the actual
	 completion.

   eg. - ifconfig -a lists eth0 and lo. Both of them are in
         /etc/network/interfaces -> Behavior as known
       - ifconfig -a lists eth0 and lo, but only one or none of them is
	 listed in /etc/network/interfaces and no other mapping is used
	 -> Behavior as known
       - ifconfig -a lists eth0 and lo. /etc/network/interfaces contains
	 one, none or both of them, but also other mappings ->
	 Completion lists all possible compinations of interfaces and
	 mappings excluding the loopback interface.

I tested this patch with zsh 4.3.4-dev-7 on debian unstable. 

Excuse me for only posting a link but i use gmane and slrn to poste this 
patch and it seems that slrn is not capable of attaching files.

http://members.inode.at/sepp.steiner/test/_net_interfaces.patch

Regards,
Sepp

