From zsh-workers-return-20328-mason-zsh=primenet.com.au@sunsite.dk Tue Sep 07 14:09:19 2004
Return-Path: <zsh-workers-return-20328-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23677 invoked from network); 7 Sep 2004 14:09:18 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Sep 2004 14:09:18 -0000
Received: (qmail 17939 invoked from network); 7 Sep 2004 14:09:12 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Sep 2004 14:09:12 -0000
Received: (qmail 28528 invoked by alias); 7 Sep 2004 14:09:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20328
Received: (qmail 28519 invoked from network); 7 Sep 2004 14:09:10 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Sep 2004 14:09:10 -0000
Received: (qmail 17702 invoked from network); 7 Sep 2004 14:09:10 -0000
Received: from lhuumrelay3.lnd.ops.eu.uu.net (62.189.58.19)
  by a.mx.sunsite.dk with SMTP; 7 Sep 2004 14:09:07 -0000
Received: from MAILSWEEPER01.csr.com (mailhost1.csr.com [62.189.183.235])
	by lhuumrelay3.lnd.ops.eu.uu.net (8.11.0/8.11.0) with ESMTP id i87E96v14736
	for <zsh-workers@sunsite.dk>; Tue, 7 Sep 2004 14:09:06 GMT
Received: from EXCHANGE02.csr.com (unverified [192.168.137.45]) by MAILSWEEPER01.csr.com
 (Content Technologies SMTPRS 4.3.12) with ESMTP id <T6be5d8d57ac0a88d016a8@MAILSWEEPER01.csr.com> for <zsh-workers@sunsite.dk>;
 Tue, 7 Sep 2004 15:08:13 +0100
Received: from news01.csr.com ([192.168.143.38]) by EXCHANGE02.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Tue, 7 Sep 2004 15:10:01 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.12.11/8.12.11) with ESMTP id i87E8v1P004333
	for <zsh-workers@sunsite.dk>; Tue, 7 Sep 2004 15:08:57 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.12.11/8.12.11/Submit) with ESMTP id i87E8vQO004330
	for <zsh-workers@sunsite.dk>; Tue, 7 Sep 2004 15:08:57 +0100
Message-Id: <200409071408.i87E8vQO004330@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: zsh exits after delete-char-or-list and two ^Cs 
In-reply-to: <Pine.LNX.4.61.0409030827210.28049@toltec.zanshin.com> 
References: <200409020919.i829J0eC012233@news01.csr.com> <Pine.LNX.4.61.0409020755430.18377@toltec.zanshin.com> <200409030937.i839bJxR018972@news01.csr.com> <Pine.LNX.4.61.0409030827210.28049@toltec.zanshin.com>
Date: Tue, 07 Sep 2004 15:08:57 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 07 Sep 2004 14:10:01.0330 (UTC) FILETIME=[5D60DD20:01C494E4]
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

> On Fri, 3 Sep 2004, Peter Stephenson wrote:
> > Bart Schaefer wrote:
> > >   zle && echo "widgets callable"	# I'm least certain of this
> > >   zle -I && echo "Display invalidated and widgets callable"
> > >   zle -R && echo "Display refreshed and zle active"
> > > 
> > > Is that right?
> > 
> > Yes, noting that testing for `display invalidated' and `display
> > refreshed' doesn't form part of the return status (I think that's what
> > you mean but it's not clear from the output).
> 
> Hmm.  OK, that's not so good, because it breaks "zle -I || ..." in the 
> case where you want to know whether the display was NOT invalidated.
> (Maybe there's never a reason to care about that, but ...)

I don't think there is, in fact, but for the sake of logic it's probably
worth changing.  I've looked at the pattern of usage of zle -I in the
various functions I've got and I never test the return value at all:
either zle wasn't active, or it's been invalidated, and either are good
enough for me.  (I do, however, test [[ -o zle ]] beforehand to avoid
having to load it if it wasn't in use.)

It would require putting the test back to testing for zleactive.  That
means your original example wouldn't work, but as you say that's really
a problem with the documentation for when I feel fit enough to look at
the zle documentation again.

The display is refreshed if and only if zle is active on zle -R, so that
doesn't need changing.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 692070


**********************************************************************
This email and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this email in error please notify
the system manager.

This footnote also confirms that this email message has been swept by
MIMEsweeper for the presence of computer viruses.

www.mimesweeper.com
**********************************************************************

