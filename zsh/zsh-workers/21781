From zsh-workers-return-21781-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 28 18:57:37 2005
Return-Path: <zsh-workers-return-21781-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29799 invoked from network); 28 Sep 2005 18:57:34 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 28 Sep 2005 18:57:34 -0000
Received: (qmail 34485 invoked from network); 28 Sep 2005 18:57:24 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 Sep 2005 18:57:24 -0000
Received: (qmail 24528 invoked by alias); 28 Sep 2005 18:57:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21781
Received: (qmail 24519 invoked from network); 28 Sep 2005 18:57:20 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 28 Sep 2005 18:57:20 -0000
Received: (qmail 34149 invoked from network); 28 Sep 2005 18:57:20 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 28 Sep 2005 18:57:19 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 4FD7F34025; Wed, 28 Sep 2005 14:57:17 -0400 (EDT)
Date: Wed, 28 Sep 2005 14:57:17 -0400
From: Clint Adams <clint@zsh.org>
To: zsh-workers@sunsite.dk
Subject: PATCH: cope with new GNU iconv
Message-ID: <20050928185717.GA7484@scowler.net>
Mail-Followup-To: zsh-workers@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.0.4

`iconv --list` no longer pipes out the informational header that this sed
command is meant to elide.  This will cause a mess on older glibc.

Index: Completion/Unix/Command/_iconv
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_iconv,v
retrieving revision 1.5
diff -u -r1.5 _iconv
--- Completion/Unix/Command/_iconv	3 Mar 2005 14:13:06 -0000	1.5
+++ Completion/Unix/Command/_iconv	28 Sep 2005 18:55:34 -0000
@@ -26,7 +26,7 @@
     else
       _wanted codesets expl 'code set' compadd "$@" \
 	  -M 'm:{a-zA-Z}={A-Za-z} r:|-=* r:|=*' \
-	  ${${${(f)"$(_call_program codesets iconv --list|sed -n '/^$/,$ p')"}## #}%//} && ret=0
+	  ${${${(f)"$(_call_program codesets iconv --list)"}## #}%//} && ret=0
     fi
   fi
 

