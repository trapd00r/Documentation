From zsh-users-return-7825-mason-zsh=primenet.com.au@sunsite.dk Fri Aug 13 08:26:41 2004
Return-Path: <zsh-users-return-7825-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20265 invoked from network); 13 Aug 2004 08:26:40 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Aug 2004 08:26:40 -0000
Received: (qmail 56022 invoked from network); 13 Aug 2004 08:26:34 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Aug 2004 08:26:34 -0000
Received: (qmail 19496 invoked by alias); 13 Aug 2004 08:25:49 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7825
Received: (qmail 19487 invoked from network); 13 Aug 2004 08:25:49 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by 130.225.247.90 with SMTP; 13 Aug 2004 08:25:49 -0000
Received: (qmail 53498 invoked from network); 13 Aug 2004 08:23:51 -0000
Received: from smtp1.su.se (130.237.162.112)
  by a.mx.sunsite.dk with SMTP; 13 Aug 2004 08:23:48 -0000
Received: from localhost (smtp1.su.se [127.0.0.1])
	by smtp1.su.se (Postfix) with ESMTP id 7AE473850E
	for <zsh-users@sunsite.dk>; Fri, 13 Aug 2004 10:23:48 +0200 (CEST)
Received: from smtp1.su.se ([127.0.0.1])
 by localhost (smtp1.su.se [127.0.0.1]) (amavisd-new, port 10024) with LMTP
 id 12720-01-21 for <zsh-users@sunsite.dk>;
 Fri, 13 Aug 2004 10:23:48 +0200 (CEST)
Received: from unni.dsv.su.se (unni.dsv.su.se [130.237.161.27])
	by smtp1.su.se (Postfix) with ESMTP id 5E35D383C1
	for <zsh-users@sunsite.dk>; Fri, 13 Aug 2004 10:23:36 +0200 (CEST)
Received: from localhost (dhcp-161-153.dsv.su.se [130.237.161.153])
	by unni.dsv.su.se (Postfix) with ESMTP id 3D8638B341
	for <zsh-users@sunsite.dk>; Fri, 13 Aug 2004 10:23:36 +0200 (CEST)
Received: from jesper by localhost with local (Exim 4.34)
	id 1BvXLL-0002th-7Q
	for zsh-users@sunsite.dk; Fri, 13 Aug 2004 10:23:19 +0200
Date: Fri, 13 Aug 2004 10:23:19 +0200
From: Jesper Holmberg <jeho5791@student.uu.se>
To: Zsh-users List <zsh-users@sunsite.dk>
Subject: insert-last-word makes space disappear
Message-ID: <20040813082318.GN1191@localhost>
Mail-Followup-To: Zsh-users List <zsh-users@sunsite.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.6+20040722i
Sender: Jesper Holmberg <jesper.holmberg.5791@student.uu.se>
X-Virus-Scanned: by amavisd-new at su.se
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.1 required=6.0 tests=BAYES_10,FROM_ENDS_IN_NUMS 
	autolearn=no version=2.63
X-Spam-Hits: 0.1

Here's a problem I've seen for a long time, but never gotten around
to reporting. It seems like a bug to me, but perhaps I have something
configured incorrectly.

I use the new completion system with <TAB> bound to menu-complete, on zsh
4.2.0.

What happens is that the combination of menu-complete and insert-last-word
(bound to alt-.) sometimes makes a vital space disappear on the command
line. I'll give an example:

% ls last.avi
last.avi
% mpl<TAB>

zsh now completes 'mpl' to 'mplayer ', which leaves me with the command
line:

% mplayer 

with a space after 'mplayer'.

Now, if I hit alt-. (insert-last-word), this is the result:

% mplayerlast.avi

The space that was after 'mplayer' has been eaten!

It seems to me that this only happens when the menu-complete has something
unambiguous to complete, i.e. when 'mplayer' is the only completion of
'mpl'. If there had been more than one alternative, the space would not
have been added after 'mplayer', and the problem wouldn't have manifested
itself.

Is this a bug?

TIA,

Jesper

