From zsh-workers-return-5876-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Mar 22 14:11:32 1999
Return-Path: <zsh-workers-return-5876-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5522 invoked from network); 22 Mar 1999 14:11:30 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Mar 1999 14:11:30 -0000
Received: (qmail 13842 invoked by alias); 22 Mar 1999 14:10:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5876
Received: (qmail 13835 invoked from network); 22 Mar 1999 14:10:47 -0000
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: "Sven Wischnowsky" <wischnow@informatik.hu-berlin.de>,
        <zsh-workers@sunsite.auc.dk>
Subject: RE: PATCH: cleanup in zle_tricky.c
Date: Mon, 22 Mar 1999 17:09:48 +0300
Message-ID: <001501be746d$a4f9e390$21c9ca95@mowp.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
In-reply-to: <199903221355.OAA08373@beta.informatik.hu-berlin.de>
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2014.211

>
> > Do I understand it correctly, that now * is always added if
> GLOB_COMPLETE is
> > set (and never added is GLOB_COMPLETE is unset)? Und is
> globbing ever done
> > at all? I mean, normally, Doc/z*i should be globbed before
> completion even
> > starts - now (with GLOB_COMPLETE) this is the same as Doc/z*i*.
>
> That's not a change (at least it should have behaved like this
> before).

Ahem ... With old good ZSH ...

bor@itsmx1:~/tmp%> echo $ZSH_VERSION
3.1.4
bor@itsmx1:~/tmp%> l foo
a1    b1    x1y
bor@itsmx1:~/tmp%> setopt globcomplete
bor@itsmx1:~/tmp%> l foo/*1TAB
bor@itsmx1:~/tmp%> l foo/a1
foo/a1  foo/b1
bor@itsmx1:~/tmp%> unsetopt globcomplete
bor@itsmx1:~/tmp%> l foo/*1TAB
bor@itsmx1:~/tmp%> l foo/a1 foo/b1

 With old style completion and with new style completion and
> not setting compstate[pattern_match] to anything not starting with a
> `*', glob completion will insert a `*' at the cursor position.
> Globbing is only done if expand-or-complete is used and GLOB_COMPLETE
> is not set, as always.

Sorry? If I can believe manuals (and at least 3.1.4 as you see agrees with
me :-), in case of expand-or-complete globbing is *always* done first. Only
if it fails, we do completion. GLOB_COMPLETE tells a) how to insert matches
and b) what to do if _first_ globbing fails. And I really like this, and I'd
like to have it back :-)

With brand new zsh (without your last patch) with GLOB_COMPLETE:

bor@itsrm2:~/test%> touch cd/{a1,b1,x1y}
bor@itsrm2:~/test%> l cd/*1TAB
bor@itsrm2:~/test%> l cd/a1
a1    b1    x1y

Without GLOB_COMPLETE it simply beeps.

/andrej


