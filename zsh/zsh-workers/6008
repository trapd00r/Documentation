From zsh-workers-return-6008-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Apr 12 08:39:17 1999
Return-Path: <zsh-workers-return-6008-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16517 invoked from network); 12 Apr 1999 08:39:15 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 12 Apr 1999 08:39:15 -0000
Received: (qmail 8161 invoked by alias); 12 Apr 1999 08:19:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6008
Received: (qmail 8153 invoked from network); 12 Apr 1999 08:19:08 -0000
Date: Mon, 12 Apr 1999 10:19:03 +0200 (MET DST)
Message-Id: <199904120819.KAA26732@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: %{...%} in explanation strings


I was reminded of this by the discussion about beautifying completion
lists...

Since we can now use `%b' etc. in explanations strings, we probably
should allow `%{...%}', too.

Bye
 Sven

diff -u os/Zle/zle_tricky.c Src/Zle/zle_tricky.c
--- os/Zle/zle_tricky.c	Thu Apr  1 15:09:24 1999
+++ Src/Zle/zle_tricky.c	Wed Apr  7 20:53:22 1999
@@ -7134,6 +7134,15 @@
 		    u = 0; m = 1;
 		    tcout(TCUNDERLINEEND);
 		    break;
+		case '{':
+		    for (p++; *p && (*p != '%' || p[1] != '}'); p++, cc++)
+			if (dopr)
+			    putc(*p, shout);
+		    if (*p)
+			p++;
+		    else
+			p--;
+		    break;
 		}
 		if (m) {
 		    if (b)
diff -u od/Zsh/compctl.yo Doc/Zsh/compctl.yo
--- od/Zsh/compctl.yo	Thu Apr  1 15:08:53 1999
+++ Doc/Zsh/compctl.yo	Wed Apr  7 20:59:38 1999
@@ -449,7 +449,8 @@
 string.
 
 The sequences tt(%B), tt(%b), tt(%S), tt(%s), tt(%U), and tt(%u) specify
-output attributes (bold, standout, and underline) as in prompts.
+output attributes (bold, standout, and underline) and tt(%{...%}) can
+be used to include literal escape sequences as in prompts.
 )
 item(tt(-Y) var(explanation))(
 Identical to tt(-X), except that the var(explanation) first undergoes

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

