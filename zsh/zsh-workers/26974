From zsh-workers-return-26974-mason-zsh=primenet.com.au@sunsite.dk Wed May 20 02:17:22 2009
Return-Path: <zsh-workers-return-26974-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15129 invoked from network); 20 May 2009 02:17:19 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 20 May 2009 02:17:19 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 26512 invoked from network); 20 May 2009 02:17:12 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 20 May 2009 02:17:12 -0000
Received: (qmail 6675 invoked by alias); 20 May 2009 02:17:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26974
Received: (qmail 6662 invoked from network); 20 May 2009 02:17:07 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 20 May 2009 02:17:07 -0000
Received: from vms173009pub.verizon.net (vms173009pub.verizon.net [206.46.173.9])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 70F578027106
	for <zsh-workers@sunsite.dk>; Wed, 20 May 2009 04:17:02 +0200 (CEST)
Received: from torch.brasslantern.com ([96.249.201.13])
 by vms173009.mailsrvcs.net
 (Sun Java(tm) System Messaging Server 6.3-7.04 (built Sep 26 2008; 32bit))
 with ESMTPA id <0KJX00I5V7NLM4E8@vms173009.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Tue, 19 May 2009 21:16:38 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n4K2GWbu011595	for
 <zsh-workers@sunsite.dk>; Tue, 19 May 2009 19:16:33 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n4K2GWpf011594	for zsh-workers@sunsite.dk; Tue,
 19 May 2009 19:16:32 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Message-id: <090519191632.ZM11593@torch.brasslantern.com>
Date: Tue, 19 May 2009 19:16:32 -0700
In-reply-to: <20090519195114.17059.qmail@smasher.org>
Comments: In reply to Atom Smasher <atom@smasher.org>
 "Re: unset IFS - zsh: segmentation fault (core dumped) zsh" (May 20,  7:51am)
References: <20090518113402.12840.qmail@smasher.org>
	<20090518125753.1931c23d@news01>	<20090519110848.12650.qmail@smasher.org>
	<200905191139.n4JBdQU8004448@news01.csr.com>
	<20090519195114.17059.qmail@smasher.org>
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
To: zsh-workers@sunsite.dk
Subject: Re: unset IFS - zsh: segmentation fault (core dumped) zsh
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii
X-Virus-Scanned: ClamAV 0.94.2/9372/Tue May 19 16:28:03 2009 on bifrost
X-Virus-Status: Clean

On May 20,  7:51am, Atom Smasher wrote:
} Subject: Re: unset IFS - zsh: segmentation fault (core dumped) zsh
}
} On Tue, 19 May 2009, Peter Stephenson wrote:
} 
} > Unfortunately, we don't know what's in $PR_STUFF[FILLBAR], and other 
} > forms don't crash, so this doesn't help.
} 
} print ${(V)PR_STUFF[FILLBAR]} | base64
} JHsocjo0ODo6cTopfXUlYiV7XltbMzg7NTsxNDdtJX0le15PJX0le15PJX0lRHslSDolTX0g
} JXteW1szODs1OzYybSV9QXVja2xhbmQle15OJX0le15bWzM4OzU7MjMxbSV9dHUle15PJX0l
} e15bWzM4OzU7NDBtJX0wLjE3LCAwLjI1LCAwLjIxJXteTiV9JXteW1szODs1OzIzMW0lfXR1
} JHtQUl9TVFVGRltCR19MSUdIVF9CTFVFXX0ke1BSX1NUVUZGW1dISVRFXX1BQyAxMDAlJSR7
} UFJfU1RVRkZbTk9fQ09MT1VSXX0le15bWzM4OzU7MjMxbSV9JXteW1swbSV9JXteW1szODs1
} OzIzMW0lfXQK

Indeed:

torch% perl -MMIME::Base64 -e 'print decode_base64("JHsocjo0ODo6cTopfXUlYiV7XltbMzg7NTsxNDdtJX0le15PJX0le15PJX0lRHslSDolTX0g
JXteW1szODs1OzYybSV9QXVja2xhbmQle15OJX0le15bWzM4OzU7MjMxbSV9dHUle15PJX0l
e15bWzM4OzU7NDBtJX0wLjE3LCAwLjI1LCAwLjIxJXteTiV9JXteW1szODs1OzIzMW0lfXR1
JHtQUl9TVFVGRltCR19MSUdIVF9CTFVFXX0ke1BSX1NUVUZGW1dISVRFXX1BQyAxMDAlJSR7
UFJfU1RVRkZbTk9fQ09MT1VSXX0le15bWzM4OzU7MjMxbSV9JXteW1swbSV9JXteW1szODs1
OzIzMW0lfXQK")' | read X
torch% unset IFS; print -- ${(e)X}  


Program received signal SIGSEGV, Segmentation fault.
0x080b513e in dopadding (str=0xb7cbea80 "", prenum=0, postnum=48, preone=0x0, 
    postone=0x0, premul=0x8146da5 " ", postmul=0xb7cbea78 "q", multi_width=0)
    at ../../zsh-4.0/Src/subst.c:717
717         if (*ifs)
(gdb) p ifs
$1 = 0x0

This hardly needs any more context, but:

(gdb) where
#0  0x080b513e in dopadding (str=0xb7cbea80 "", prenum=0, postnum=48, 
    preone=0x0, postone=0x0, premul=0x8146da5 " ", postmul=0xb7cbea78 "q", 
    multi_width=0) at ../../zsh-4.0/Src/subst.c:717
#1  0x080b9f6f in paramsubst (l=0xb7cbe6b8, n=0xb7cbe6dc, str=0xbfe56638, 
    qt=0, ssub=0) at ../../zsh-4.0/Src/subst.c:3144
#2  0x080b404e in stringsubst (list=0xb7cbe6b8, node=0xb7cbe6dc, ssub=0, 
    asssub=0) at ../../zsh-4.0/Src/subst.c:214
#3  0x080b384a in prefork (list=0xb7cbe6b8, flags=0)
    at ../../zsh-4.0/Src/subst.c:77
#4  0x080659b6 in execcmd (state=0xbfe56f10, input=0, output=0, how=18, 
    last1=2) at ../../zsh-4.0/Src/exec.c:2424
#5  0x0806398d in execpline2 (state=0xbfe56f10, pcode=1795, how=18, input=0, 
    output=0, last1=0) at ../../zsh-4.0/Src/exec.c:1561
#6  0x08062d8e in execpline (state=0xbfe56f10, slcode=5122, how=18, last1=0)
    at ../../zsh-4.0/Src/exec.c:1347
#7  0x080626ec in execlist (state=0xbfe56f10, dont_change_job=0, exiting=0)
    at ../../zsh-4.0/Src/exec.c:1144
#8  0x080621b7 in execode (p=0xb7cbe5c0, dont_change_job=0, exiting=0)
    at ../../zsh-4.0/Src/exec.c:975
#9  0x0807b2b6 in loop (toplevel=1, justonce=0) at ../../zsh-4.0/Src/init.c:183
#10 0x0807e019 in zsh_main (argc=1, argv=0xbfe57054)
    at ../../zsh-4.0/Src/init.c:1409
#11 0x0804cbea in main (argc=1, argv=0xbfe57054) at ../../zsh-4.0/Src/main.c:93

