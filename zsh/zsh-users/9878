From zsh-users-return-9878-mason-zsh=primenet.com.au@sunsite.dk Wed Feb 01 02:05:18 2006
Return-Path: <zsh-users-return-9878-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16371 invoked from network); 1 Feb 2006 02:05:16 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Feb 2006 02:05:16 -0000
Received: (qmail 27344 invoked from network); 1 Feb 2006 02:05:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Feb 2006 02:05:08 -0000
Received: (qmail 17171 invoked by alias); 1 Feb 2006 02:05:00 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9878
Received: (qmail 17143 invoked from network); 1 Feb 2006 02:04:59 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 1 Feb 2006 02:04:59 -0000
Received: (qmail 26054 invoked from network); 1 Feb 2006 02:04:59 -0000
Received: from 69-12-150-177.dsl.static.sonic.net (HELO ripple.fruitbat.org) (69.12.150.177)
  by a.mx.sunsite.dk with SMTP; 1 Feb 2006 02:04:57 -0000
Received: (from daemon@localhost)
	by ripple.fruitbat.org (8.10.2/8.8.8/PAC-1.3) id k11052G10952;
	Tue, 31 Jan 2006 16:05:02 -0800
Received: from ming.fruitbat.org(192.168.55.2) by ripple.fruitbat.org via smap (V2.1/2.1+anti-relay+anti-spam)
	id xma010943; Tue, 31 Jan 06 16:04:32 -0800
Received: from gremlin.fruitbat.org (IDENT:202@gremlin.fruitbat.org [192.168.55.4])
	by ming.fruitbat.org (8.12.10/8.10.2/PAC-1.6) with ESMTP id k1104U6V007324;
	Tue, 31 Jan 2006 16:04:30 -0800
Date: Tue, 31 Jan 2006 16:04:30 -0800 (PST)
From: "Peter A. Castro" <doctor@fruitbat.org>
To: Thomas Richter <richter@thomas-richter.de>
cc: list zsh-users <zsh-users@sunsite.dk>
Subject: Re: history trouble
In-Reply-To: <20060129162920.GA32595@thomas-richter.de>
Message-ID: <Pine.LNX.4.63.0601311548570.4099@gremlin.fruitbat.org>
References: <20060128074156.GA19690@thomas-richter.de>
 <1060128155351.ZM730@candle.brasslantern.com> <20060128190424.GC19690@thomas-richter.de>
 <1060128203236.ZM1042@candle.brasslantern.com> <20060129162920.GA32595@thomas-richter.de>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed

On Sun, 29 Jan 2006, Thomas Richter wrote:

Greetings, Thomas,
   Can you verify something:
   Start a shell, enter a few commands, exit the shell, then look at the
history file and see if your commands were added to it?  If so, then
it's not a matter of your commands not being written to history, but that
they are being buffered and, upon exit, flushed to file.

Try this:
   setopt inc_append_history

> Hi Bart Schaefer <schaefer@brasslantern.com>,
> you wrote on Saturday, 2006-01-28 20:32:36 +0000:
>> On Jan 28,  8:04pm, Thomas Richter wrote:
>>
>> Possible reasons for the history not to be read are:
>>
>> - the NO_RCS option is set (the doc says this prevents history from
>>   being written, but it also suppresses reading it)
>
> This option is not set.
>
>> - the INTERACT option is not set
>
> This option is set.
>
>> - lockhistfile() fails because
>>   + a temporary lock file can't be created in the same directory
>>     as the HISTFILE
>
> How can I test this?
>
>>   + a link to that temp file can't be created
>
> ln -s $HISTFILE newname is ok
>
>>   + something else [possibly several somethings] has the file locked
>>     for more than about 10 seconds (but this shouldn't apply at shell
>>     startup, only for incremental history)
>
> no process has this file open
>
>> - the file can't be opened for reading
>
> cat $HISTFILE is ok
>
>> - some part of the file is corrupt
>
> no contains only one line with one word
>
>> - HISTSIZE is zero (in which case, I believe, the file is read but all
>>   the contents are discarded)
>
> HISTSIZE = 99999
>
>> My (new, ahem) guess is that the problem is with the lock file.
>
> wkr Thomas Richter

-- 
Peter A. Castro <doctor@fruitbat.org> or <Peter.Castro@oracle.com>
 	"Cats are just autistic Dogs" -- Dr. Tony Attwood

