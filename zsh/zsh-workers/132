From zsh-workers-request@math.gatech.edu  Sat Jul  1 03:26:04 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id DAA13771 for <mason@werple.mira.net.au>; Sat, 1 Jul 1995 03:26:01 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA10050
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Fri, 30 Jun 1995 13:25:14 -0400
Received: by math (5.x/SMI-SVR4)
	id AA02490; Fri, 30 Jun 1995 13:22:04 -0400
Resent-Date: Fri, 30 Jun 1995 19:20:54 +0100 (MET DST)
Old-Return-Path: <hzoli@cs.elte.hu>
From: hzoli@cs.elte.hu (Zoltan Hidvegi)
Message-Id: <9506301721.AA13999@turan.elte.hu>
Subject: Re: USERNAME bug zsh-2.6-beta9
To: pckizer@tamu.edu
Date: Fri, 30 Jun 1995 19:20:54 +0100 (MET DST)
In-Reply-To: <970.804532201@gonzo.tamu.edu> from "Philip Kizer" at Jun 30, 95 12:10:01 pm
X-Mailer: ELM [version 2.4 PL21]
Content-Type: text
Sender: hzoli@cs.elte.hu
Resent-Message-Id: <"CE_xW1.0.mc.xA3zl"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/132
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> "%n" should show the username of the uid running the shell in my opinion as
> that's what current privileges are in effect.  I guess this qualifies as a
> minor change from the way it's documented, and it was just "wrong" for so
> long I got used to it showing name of current uid.  Which beta release did
> that actually get "fixed"...about b7?

I think it only came in in beta9. It happend when init.c started using
getlogin(). It used that well before beta9, but an other bug prevented it
working.

I think your patch does the right thing.

Someone else said that su should not change the environment. In fact USERNAME
is usually not in the environment, and it is reinitialized each time a new zsh
process is invoked.

Bye,
   Zoltan

