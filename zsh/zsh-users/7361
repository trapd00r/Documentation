From zsh-users-return-7361-mason-zsh=primenet.com.au@sunsite.dk Sun Apr 18 18:07:22 2004
Return-Path: <zsh-users-return-7361-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11042 invoked from network); 18 Apr 2004 18:07:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 18 Apr 2004 18:07:19 -0000
Received: (qmail 13944 invoked by alias); 18 Apr 2004 18:06:55 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7361
Received: (qmail 13933 invoked from network); 18 Apr 2004 18:06:55 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 18 Apr 2004 18:06:55 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 18 Apr 2004 18:6:54 -0000
Received: (qmail 20423 invoked from network); 18 Apr 2004 18:06:54 -0000
Received: from cmailm2.svr.pol.co.uk (195.92.193.210)
  by a.mx.sunsite.dk with SMTP; 18 Apr 2004 18:06:43 -0000
Received: from modem-24.blue-streak-damsel.dialup.pol.co.uk ([62.136.241.24] helo=pwstephenson.fsnet.co.uk)
	by cmailm2.svr.pol.co.uk with esmtp (Exim 4.14)
	id 1BFGgf-0002LZ-Ie; Sun, 18 Apr 2004 19:06:38 +0100
Received: by pwstephenson.fsnet.co.uk (Postfix, from userid 501)
	id 8714C8543; Sun, 18 Apr 2004 14:10:10 -0400 (EDT)
Received: from pwstephenson.fsnet.co.uk (localhost [127.0.0.1])
	by pwstephenson.fsnet.co.uk (Postfix) with ESMTP
	id 553D284C0; Sun, 18 Apr 2004 19:10:10 +0100 (BST)
To: Vincent Stemen <zsh@hightek.org>
Cc: zsh-users@sunsite.dk
Subject: Re: FreeBSD compatability feature request 
In-reply-to: "Vincent Stemen"'s message of "Sat, 17 Apr 2004 17:22:22 CDT."
             <20040417222222.GA27230@quark.hightek.org> 
Date: Sun, 18 Apr 2004 19:10:09 +0100
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <20040418181010.8714C8543@pwstephenson.fsnet.co.uk>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 1.5

Vincent Stemen wrote:
> Zsh's sh compatibility works great for the most part.  However, there
> is one unimplemented feature that I know of that prevents us from
> being able to use it as a plug in replacement for /bin/sh on FreeBSD.
> The "set -T" option.  This is used in a few places in the FreeBSD-5.x
> init scripts.
> 
> Here is the FreeBSD manual entry:
> 
>   -T trapsasync
>         When waiting for a child, execute traps immediately.  If this
>         option is not set, traps are executed after the child exits,
>         as specified in IEEE Std 1003.2 (``POSIX.2'')

This question came up before.  It can probably be done in certain
controlled circumstances --- usually it's dangerous to run traps
asynchronously, but with appropriate tests around a wait it ought to be
possible.  It doesn't sound too difficult.

If someone with a FreeBSD system wants to implement this, please go
ahead, but otherwise (i) it's ultralow priority (ii) we can't compare
the result with what it's supposed to do.

(We get quite a lot of feature requests and very few people offering to
implement new features, unfortunately.  So unless it's really of general
interest it tends not to get done.)

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Work: pws@csr.com
Web: http://www.pwstephenson.fsnet.co.uk

