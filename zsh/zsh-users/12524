From zsh-users-return-12524-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 31 16:55:49 2008
Return-Path: <zsh-users-return-12524-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8767 invoked from network); 31 Jan 2008 16:55:39 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-0.9 required=5.0 tests=AWL,BAYES_00,SUBJ_RE_NUM
	autolearn=no version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 31 Jan 2008 16:55:39 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 12455 invoked from network); 31 Jan 2008 16:55:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 31 Jan 2008 16:55:22 -0000
Received: (qmail 18398 invoked by alias); 31 Jan 2008 16:55:11 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12524
Received: (qmail 18374 invoked from network); 31 Jan 2008 16:55:10 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 31 Jan 2008 16:55:10 -0000
Received: from smtp.tt-solutions.com (sunset.tt-solutions.com [82.238.156.189])
	by bifrost.dotsrc.org (Postfix) with ESMTP id CACC68029406
	for <zsh-users@sunsite.dk>; Thu, 31 Jan 2008 17:55:06 +0100 (CET)
Received: from nightfall ([192.168.17.76])
	by smtp.tt-solutions.com with esmtp (Exim 4.63)
	(envelope-from <vz-zsh@zeitlins.org>)
	id 1JKcgs-0001Bt-BR
	for zsh-users@sunsite.dk; Thu, 31 Jan 2008 17:55:06 +0100
Date: Thu, 31 Jan 2008 17:55:06 +0100
From: Vadim Zeitlin <vz-zsh@zeitlins.org>
Subject: Re[2]: svn commit completion
To: zsh-users@sunsite.dk
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII
Content-Disposition: INLINE
References: <47A07DB2.7080604@cam.ac.uk> <20080130151133.285c6450@news01><35705.76.254.7.151.1201707955.squirrel@mail.acg.ucsc.edu> <2d460de70801310741x3b6796c6ib87d0323cc165ab2@mail.gmail.com>
In-Reply-To: <2d460de70801310741x3b6796c6ib87d0323cc165ab2@mail.gmail.com>
X-Mailer: Mahogany 0.67.0 'Constance', running under Windows Server 2003 (build 3790, Service Pack 1)
Message-Id: <20080131165506.CACC68029406@bifrost.dotsrc.org>
X-Virus-Scanned: ClamAV 0.91.2/5627/Thu Jan 31 17:15:25 2008 on bifrost
X-Virus-Status: Clean

On Thu, 31 Jan 2008 16:41:59 +0100 Richard Hartmann <richih.mailinglist@gmail.com> wrote:

RH> On Jan 30, 2008 4:45 PM, William Scott <wgscott@chemistry.ucsc.edu> wrote:
RH> 
RH> > With _cvs, the commit contextual completion offers only files that have
RH> > been touched since the last cvs update.  With _svn, it completes with
RH> > everything in the directory, instead of only what has changed.
RH> 
RH> I noticed that as well, though I adapted my muscle memory to it.
RH> 
RH> > Is that a limit imposed by svn, or just a design difference?
RH> 
RH> As svn status will happily tell you which files have been changed and which
RH> are not in the repo, it is probably an oversight, not a hard limit.

 Actually "svn ci" does complete only modified (or added, removed) files
here (zsh 4.3.2 under Debian Linux), but the problem is that these files
are remembered by the completer in a global _cache_svn_status variable
which is never updated. I don't really know what's the best way of fixing
it but for now I've just done "precmd() { unset _cache_svn_status }" and
"svn ci" completes correctly all the time and not just the first one.

 Regards,
VZ

