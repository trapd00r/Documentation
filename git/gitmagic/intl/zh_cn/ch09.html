<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 25 March 2009), see www.w3.org">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Git Magic - 第&nbsp;9&nbsp;章&nbsp;附录 A: Git的缺点</title>
  <link rel="stylesheet" href="default.css" type="text/css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
  <link rel="home" href="index.html" title="Git 魔法">
  <link rel="up" href="index.html" title="Git 魔法">
  <link rel="prev" href="ch08.html" title=
  "第&nbsp;8&nbsp;章&nbsp;揭开面纱">
  <link rel="next" href="ch10.html" title=
  "第&nbsp;10&nbsp;章&nbsp;附录 B: 本指南的翻译">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
    <div class="toc">
      <ul>
<li><b>Git Magic</b></li>
        <li>
          <span class="preface"><a href="index.html">前言</a></span>

          <ul>
            <li><span class="section"><a href=
            "index.html#__2">致谢！</a></span></li>

            <li><span class="section"><a href=
            "index.html#__3">许可</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch01.html">1.
          入门</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch01.html#__5">工作是玩</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__6">版本控制</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__7">分布控制</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__8">一个误区</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#__9">合并冲突</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch02.html">2.
          基本技巧</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch02.html#__11">保存状态</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__12">添加、删除、重命名</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__13">进阶撤销/重做</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__14">撤销</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__15">变更日志生成</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__16">下载文件</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__17">到最新</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__18">快速发布</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__19">我们已经做了什么？</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#__20">练习</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch03.html">3.
          克隆周边</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch03.html#__22">计算机间同步</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__23">典型源码控制</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__24">封闭源码</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__25">裸仓库</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__26">推还是拽</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__27">项目分叉</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__28">终极备份</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__29">轻快多任务</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#__30">游击版本控制</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_mercurial">Mercurial</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bazaar">Bazaar</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_git">我偏爱Git的原因</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch04.html">4.
          分支巫术</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch04.html#__32">老板键</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__33">肮脏的工作</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__34">快速修订</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__35">合并</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__36">不间断工作流</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__37">重组杂乱</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__38">管理分支</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__39">临时分支</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#__40">按你希望的方式工作</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch05.html">5.
          关于历史</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch05.html#__42">我认错</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__43">更复杂情况</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__44">本地变更之后</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__45">重写历史</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__46">制造历史</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__47">哪儿错了？</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__48">谁让事情变糟了？</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#__49">个人经验</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch06.html">6.
          多人Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch06.html#__50">我是谁？</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_ssh_http">Git在SSH,
            HTTP上</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_3">Git在随便什么上</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__51">补丁：全球货币</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__52">对不起，移走了</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__53">远端分支</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__54">多远端</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#__55">我的喜好</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch07.html">7.
          Git大师技</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch07.html#__56">源码发布</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__57">提交变更</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__58">我的提交太大了！</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_git_5">索引：Git的中转区域</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_head">别丢了你的HEAD</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_head_2">HEAD捕猎</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_git_6">基于Git构建</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__59">大胆的特技</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#__60">阻止坏提交</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch08.html">8.
          揭开面纱</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch08.html#__62">大象无形</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__63">数据完整性</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__64">智能</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__65">索引</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_git_7">Git的源起</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__66">对象数据库</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_blob">Blob对象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_tree">Tree对象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_commit">Commit对象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#__67">没那么神</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch09.html">9. 附录 A:
          Git的缺点</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch09.html#_sha1">SHA1 的弱点</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_windows">微软 Windows</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__68">不相关的文件</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__69">谁在编辑什么？</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__70">文件历史</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__71">初始克隆</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__72">不稳定的项目</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__73">全局计数器</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__74">空子目录</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__75">初始提交</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#__76">接口怪癖</a></span></li>
          </ul>
        </li>

        <li><span class="chapter"><a href="ch10.html">10. 附录 B:
        本指南的翻译</a></span></li>
      </ul>
    </div>
<div class="content">
  <div class="chapter" title="第&nbsp;9&nbsp;章&nbsp;附录 A: Git的缺点">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title"><a name=
          "_a_git"></a>第&nbsp;9&nbsp;章&nbsp;附录 A: Git的缺点</h2>
        </div>
      </div>
    </div>

    <p>有一些Git的问题，我已经藏在毯子下面了。有些可以通过脚本或回调方法轻易地解决，
    有些需要重组或重定义项目，少数剩下的烦恼，还只能等待。或者更好地，投入进来帮 忙。</p>

    <div class="section" title="SHA1 的弱点">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="_sha1"></a>SHA1 的弱点</h2>
          </div>
        </div>
      </div>

      <p>随着时间的推移，密码学家发现越来越多的SHA1的弱点。已经发现对对资源雄厚的组织
      哈希冲撞是可能的。在几年内，或许甚至一个一般的PC也将有足够计算能力悄悄摧毁一 个Git仓库。</p>

      <p>希望在进一步研究摧毁SHA1之前，Git能迁移到一个更好的哈希算法。</p>
    </div>

    <div class="section" title="微软 Windows">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="_windows"></a>微软
            Windows</h2>
          </div>
        </div>
      </div>

      <p>Git在微软Windows上可能有些繁琐：</p>

      <div class="itemizedlist">
        <ul class="itemizedlist">
          <li class="listitem"><a class="ulink" href=
          "http://cygwin.com/" target="_top">Cygwin</a> ，,
          一个Windows下的类Linux的环境，包含一个 <a class="ulink" href=
          "http://cygwin.com/packages/git/" target=
          "_top">一个Git在Windows下的移植</a>.</li>

          <li class="listitem"><a class="ulink" href=
          "http://code.google.com/p/msysgit/" target=
          "_top">基于MSys的Git</a> 是另一个，要求最小运行时支持，不过一些命令不能马上工作。</li>
        </ul>
      </div>
    </div>

    <div class="section" title="不相关的文件">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__68"></a>不相关的文件</h2>
          </div>
        </div>
      </div>

      <p>如果你的项目非常大，包含很多不相关的文件，而且正在不断改变，Git可能比其他系统
      更不管用，因为独立的文件是不被跟踪的。Git跟踪整个项目的变更，这通常才是有益的。</p>

      <p>一个方案是将你的项目拆成小块，每个都由相关文件组成。如果你仍然希望在同一个资 源库里保存所有内容的话，可以使用
      <span class="strong"><strong>git submodule</strong></span>
      。</p>
    </div>

    <div class="section" title="谁在编辑什么？">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__69"></a>谁在编辑什么？</h2>
          </div>
        </div>
      </div>

      <p>一些版本控制系统在编辑前强迫你显示地用某个方法标记一个文件。尽管这种要求很烦
      人，尤其是需要和中心服务器通讯时，不过它还是有以下两个好处的：</p>

      <div class="orderedlist">
        <ol class="orderedlist" type="1">
          <li class="listitem">比较速度快，因为只有被标记的文件需要检查。</li>

          <li class="listitem">可以知道谁在这个文件上工作，通过查询在中心服务器谁把这个文件标记为编辑状
          态。</li>
        </ol>
      </div>

      <p>使用适当的脚本，你也可以使Git达到同样的效果。这要求程序员协同工作，当他编辑一
      个文件的时候还要运行特定的脚本。</p>
    </div>

    <div class="section" title="文件历史">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__70"></a>文件历史</h2>
          </div>
        </div>
      </div>

      <p>因为Git记录的是项目范围的变更，重造单一文件的变更历史比其他跟踪单一文件的版本 控制系统要稍微麻烦些。</p>

      <p>好在麻烦还不大，也是值得的，因为Git其他的操作难以置信地高效。例如，`git checkout`比`cp
      -a`都快，而且项目范围的delta压缩也比基于文件的delta集合的做法 好多了。</p>
    </div>

    <div class="section" title="初始克隆">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__71"></a>初始克隆</h2>
          </div>
        </div>
      </div>

      <p>The initial cost is worth paying in the long run, as most
      future operations will then be fast and offline. However, in
      some situations, it may be preferable to create a shallow
      clone with the <code class="literal">--depth</code> option.
      This is much faster, but the resulting clone has reduced
      functionality.</p>

      <p>当一个项目历史很长后，与在其他版本系统里的检出代码相比，创建一个克隆的开销会 大的多。</p>

      <p>长远来看，开始付出的代价还是值得付出的，因为大多将来的操作将由此变得很快，并
      可以离线完成。然而，在一些情况下，使用`--depth`创建一个浅克隆比较划算些。这种
      克隆初始化的更快，但得到克隆的功能有所削减。</p>
    </div>

    <div class="section" title="不稳定的项目">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__72"></a>不稳定的项目</h2>
          </div>
        </div>
      </div>

      <p>变更的大小决定写入的速度快慢是Git的设计。一般人做了小的改动就会提交新版本。这
      里一行臭虫修改，那里一个新功能，修改掉的注释等等。但如果你的文件在相邻版本之
      间存在极大的差异，那每次提交时，你的历史记录会以整个项目的大小增长。</p>

      <p>任何版本控制系统对此都束手无策，但标准的Git用户将遭受更多，因为一般来说，历史 记录也会被克隆。</p>

      <p>应该检查一下变更巨大的原因。或许文件格式需要改变一下。小修改应该仅仅导致几个 文件的细小改动。</p>

      <p>或许，数据库或备份/打包方案才是正选，而不是版本控制系统。例如，版本控制就不适
      宜用来管理网络摄像头周期性拍下的照片。</p>

      <p>如果这些文件实在需要不断更改，他们实在需要版本控制，一个可能的办法是以中心的
      方式使用Git。可以创建浅克隆，这样检出的较少，也没有项目的历史记录。当然，很多
      Git工具就不能用了，并且修复必须以补丁的形式提交。这也许还不错，因为似乎没人需 要大幅度变化的不稳定文件历史。</p>

      <p>另一个例子是基于固件的项目，使用巨大的二进制文件形式。用户对固件文件的变化历
      史没有兴趣，更新的压缩比很低，因此固件修订将使仓库无谓的变大。</p>

      <p>这种情况，源码应该保存在一个Git仓库里，二进制文件应该单独保存。为了简化问题，
      应该发布一个脚本，使用Git克隆源码，对固件只做同步或Git浅克隆。</p>
    </div>

    <div class="section" title="全局计数器">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__73"></a>全局计数器</h2>
          </div>
        </div>
      </div>

      <p>
      一些中心版本控制系统维护一个正整数，当一个新提交被接受的时候这个整数就增长。Git则是通过哈希值来记录所有变更，这在大多数情况下都工作的不错。</p>

      <p>
      但一些人喜欢使用整数的方法。幸运的是，很容易就可以写个脚本，这样每次更新，中心Git仓库就增大这个整数，或使用tag的方式，把最新提交的哈希值与这个整数关联起来。</p>

      <p>每个克隆都可以维护这么个计数器，但这或许没什么用，因为只有中心仓库以及它的计数器对每个人才有意义。</p>
    </div>

    <div class="section" title="空子目录">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__74"></a>空子目录</h2>
          </div>
        </div>
      </div>

      <p>空子目录不可加入管理。可以通过创建一个空文件以绕过这个问题。</p>

      <p>Git的当前实现，而不是它的设计，是造成这个缺陷的原因。如果运气好，一旦Git得到
      更多关注，更多用户要求这个功能，这个功能就会被实现。</p>
    </div>

    <div class="section" title="初始提交">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__75"></a>初始提交</h2>
          </div>
        </div>
      </div>

      <p>传统的计算机系统从0计数，而不是1。不幸的是，关于提交，Git并不遵从这一约定。很
      多命令在初始提交之前都不友好。另外，一些极少数的情况必须作特别地处理。例如重 订一个使用不同初始提交的分支。</p>

      <p>Git将从定义零提交中受益：一旦一个仓库被创建起来，HEAD将被设为包含20个零字节
      的字符串。这个特别的提交代表一棵空的树，没有父节点，早于所有Git仓库。</p>

      <p>然后运行git log，比如，通知用户至今还没有提交过变更，而不是报告致命错误并退出。 这与其他工具类似。</p>

      <p>每个初始提交都隐式地成为这个零提交的后代。</p>

      <p>不幸的是还有更糟糕的情况。如果把几个具有不同初始提交的分支合并到一起，之后的
      重新修订不可避免的需要人员的介入。</p>
    </div>

    <div class="section" title="接口怪癖">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="__76"></a>接口怪癖</h2>
          </div>
        </div>
      </div>

      <p>对提交A和提交B，表达式“A..B”和“A…B”的含义，取决于命令期望两个终点还是一 个范围。参见
      <span class="strong"><strong>git help diff</strong></span> 和
      <span class="strong"><strong>git help
      rev-parse</strong></span> 。</p>
    </div>
  </div><script type="text/javascript" src="find_selflink.js">
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1901330-2");
  pageTracker._initData();
  pageTracker._trackPageview();
  </script>
</div>
</div><div class="footer"><a href="/~blynn/">Ben Lynn</a></div>
</body>
</html>
