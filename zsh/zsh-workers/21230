From zsh-workers-return-21230-mason-zsh=primenet.com.au@sunsite.dk Thu May 05 00:18:50 2005
Return-Path: <zsh-workers-return-21230-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1304 invoked from network); 5 May 2005 00:18:49 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 5 May 2005 00:18:49 -0000
Received: (qmail 25475 invoked from network); 5 May 2005 00:18:43 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 May 2005 00:18:43 -0000
Received: (qmail 7493 invoked by alias); 5 May 2005 00:18:41 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21230
Received: (qmail 7482 invoked from network); 5 May 2005 00:18:40 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 May 2005 00:18:40 -0000
Received: (qmail 25151 invoked from network); 5 May 2005 00:18:40 -0000
Received: from mx4.netwood.net (209.247.184.2)
  by a.mx.sunsite.dk with SMTP; 5 May 2005 00:18:36 -0000
Received: from netwood.net (mail.netwood.net [209.247.184.35])
	by MX4.NetWood.net (Postfix) with ESMTP id C149A1DE85C
	for <zsh-workers@sunsite.dk>; Wed,  4 May 2005 17:18:56 -0700 (PDT)
Received: from [66.81.21.244] [66.81.21.244] by netwood.net with ESMTP
  (SMTPD32-8.15) id A65D12A400EE; Wed, 04 May 2005 17:18:37 -0700
Mime-Version: 1.0 (Apple Message framework v619)
Content-Transfer-Encoding: 7bit
Message-Id: <841710F4-BCFB-11D9-8F80-000A957CB0EE@netwood.net>
Content-Type: text/plain; charset=US-ASCII; format=flowed
To: zsh-workers@sunsite.dk
From: Jesse W <jessw@netwood.net>
Subject: small dpkg completion update patch
Date: Wed, 4 May 2005 17:20:42 -0700
X-Mailer: Apple Mail (2.619)
X-Declude-Sender: jessw@netwood.net [66.81.21.244]
X-Note: This E-mail was scanned by Declude JunkMail (www.declude.com) for spam.
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=6.0 tests=AWL,BAYES_00,
	RCVD_IN_SORBS_WEB autolearn=ham version=3.0.2
X-Spam-Hits: -2.3

I've written a tiny patch for _dpkg, the completion function for dpkg, 
and dpkg-deb.  It adds the --show option, which was added to dpkg-deb 
(but not dpkg) in version 10.1.  I'm intending to hack up completion 
for dpkg-query evetually, so this is also sort of a training for me in 
the process of creating and sending in patches for zsh.  If I've done 
anything wrong, please let me know.  The patch is included below.

	Jesse Weinstein

*** /Users/jesse/_dpkg.old	Wed May  4 17:00:21 2005
--- /Users/jesse/_dpkg	Wed May  4 17:07:56 2005
***************
*** 2,9 ****
--- 2,13 ----

   local _dpkg_deb_actions _dpkg_common_actions _dpkg_actions 
_dpkg_options
   local _dpkg_options_recursive _dpkg_actions_install 
_dpkg_actions_record_avail
+ local _dpkg_deb_only_actions
   local curcontext="$curcontext" context state line expl ret
   typeset -A opt_args
+ _dpkg_deb_only_actions=(
+     '(--show -W)'{--show,-W}'[show package info]:Debian 
package:_files -g \*.u\#deb'
+     )

   _dpkg_deb_actions=(
     '(--build -b)'{--build,-b}'[build archive]:directory:_files -/'
***************
*** 83,89 ****

   dpkg-deb)
   _arguments "$_dpkg_deb_actions[@]" \
!            "$_dpkg_common_actions[@]" && return 0

   ;;

--- 87,94 ----

   dpkg-deb)
   _arguments "$_dpkg_deb_actions[@]" \
!            "$_dpkg_common_actions[@]" \
!            "$_dpkg_deb_only_actions[@]" && return 0

   ;;

