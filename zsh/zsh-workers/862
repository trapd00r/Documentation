From pws@hydra.ifh.de Wed Mar 27 19:37:04 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id TAA18777 for <mason@werple.mira.net.au>; Wed, 27 Mar 1996 19:37:02 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id DAA29384; Wed, 27 Mar 1996 03:25:30 -0500 (EST)
Resent-Date: Wed, 27 Mar 1996 03:25:30 -0500 (EST)
Message-Id: <9603270824.AA02618@hydra.ifh.de>
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: zsh hangs on IRIX 5.2 / me to: (SunOS4.1.3 + Solaris 2.4) 
In-Reply-To: "schaefer@z-code.ncd.com"'s message of "Tue, 26 Mar 1996 11:52:39 MET."
             <960326115239.ZM24606@zyrcon.z-code.com> 
Date: Wed, 27 Mar 1996 09:24:24 +0100
From: Peter Stephenson <pws@hydra.ifh.de>
Resent-Message-ID: <"3H9US1.0._A7.wjFMn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/862
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 964
Status: OR

schaefer@z-code.ncd.com wrote:
> I think this is what is wanted:
> 
> 		if (pgrp != mypgrp && kill(pgrp, 0) == -1)
> 		    attachtty(mypgrp);
> 		else {

That's got to work, since it'll only try the attachtty(mypgrp) once
and then fail.  Here's that as a patch for everyone to try at home.

*** Src/utils.c.pgrp	Wed Mar 27 09:17:42 1996
--- Src/utils.c	Wed Mar 27 09:17:09 1996
***************
*** 2597,2603 ****
  # endif
  #endif
  	{
! 	    if (kill(pgrp, 0) == -1)
  		attachtty(mypgrp);
  	    else {
  		zerr("can't set tty pgrp: %e", NULL, errno);
--- 2597,2603 ----
  # endif
  #endif
  	{
! 	    if (pgrp != mypgrp && kill(pgrp, 0) == -1)
  		attachtty(mypgrp);
  	    else {
  		zerr("can't set tty pgrp: %e", NULL, errno);

-- 
Peter Stephenson <pws@ifh.de>       Tel: +49 33762 77366
WWW:  http://www.ifh.de/~pws/       Fax: +49 33762 77330
Deutches Electronen-Synchrotron --- Institut fuer Hochenergiephysik Zeuthen
DESY-IfH, 15735 Zeuthen, Germany.


