From zsh-workers-return-25023-mason-zsh=primenet.com.au@sunsite.dk Wed May 14 09:48:30 2008
Return-Path: <zsh-workers-return-25023-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27188 invoked from network); 14 May 2008 09:48:28 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 May 2008 09:48:28 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 83121 invoked from network); 14 May 2008 09:48:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 May 2008 09:48:19 -0000
Received: (qmail 21314 invoked by alias); 14 May 2008 09:48:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25023
Received: (qmail 21295 invoked from network); 14 May 2008 09:48:15 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 14 May 2008 09:48:15 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [217.69.20.190])
	by bifrost.dotsrc.org (Postfix) with ESMTP id CD8AC80ED172
	for <zsh-workers@sunsite.dk>; Wed, 14 May 2008 11:48:11 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly41d.srv.mailcontrol.com (MailControl) with ESMTP id m4E9m8TJ001944
	for <zsh-workers@sunsite.dk>; Wed, 14 May 2008 10:48:09 +0100
Received: from news01 ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 14 May 2008 10:47:57 +0100
Date: Wed, 14 May 2008 10:47:57 +0100
From: Peter Stephenson <pws@csr.com>
To: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: case insensitive completion
Message-ID: <20080514104757.01013e55@news01>
In-Reply-To: <482839D5.6070901@sergio.spb.ru>
References: <482839D5.6070901@sergio.spb.ru>
Organization: CSR
X-Mailer: Claws Mail 3.3.1 (GTK+ 2.12.5; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-OriginalArrivalTime: 14 May 2008 09:47:57.0851 (UTC) FILETIME=[970E1EB0:01C8B5A7]
X-Scanned-By: MailControl A-08-50-03 (www.mailcontrol.com) on 10.68.0.151
X-Virus-Scanned: ClamAV 0.91.2/7115/Tue May 13 23:19:43 2008 on bifrost
X-Virus-Status: Clean

On Mon, 12 May 2008 16:36:37 +0400
sergio <zsh@sergio.spb.ru> wrote:
> zstyle ':completion:*' matcher-list 'm:{=D0=B0-=D1=8F=D0=90-=D0=AF}=3D{=
=D0=90-=D0=AF=D0=B0-=D1=8F}
> doesn't work

I think this really needs fixing a more general way.  You don't care what
the character set is, you just want to make lower and upper case match.  So
really you want to be able to use ctype-style character specifications:

zstyle ':completion:*' matcher-list \
       'm:{[:lower:][:upper:]}=3D{[:upper:][:lower:]}'

More general ctype tests would also be useful in:

  compadd -M 'r:|[.,_-]=3D* r:|=3D*'

which could be

  compadd -M 'r:|[[:punct:]]=3D* r:|=3D*'

and it's a bit confusing that that doesn't currently work---it's not
spelled out in the completion documentation.

That doesn't leave much for individual multibyte characters in
correspondence classes to do, but it still shouldn't be too difficult to
turn the tables into explicit sets of characters tested the way character
classes in globbing are tested (which is fully general, although based on
the wchar_t ordering, which isn't necessarily Unicode code points).

--=20
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

