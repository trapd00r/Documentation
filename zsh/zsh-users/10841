From zsh-users-return-10841-mason-zsh=primenet.com.au@sunsite.dk Thu Oct 12 10:11:27 2006
Return-Path: <zsh-users-return-10841-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5589 invoked from network); 12 Oct 2006 10:11:21 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.6 (2006-10-03) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.6
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Oct 2006 10:11:21 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 36517 invoked from network); 12 Oct 2006 10:11:15 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Oct 2006 10:11:15 -0000
Received: (qmail 22012 invoked by alias); 12 Oct 2006 10:11:03 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 10841
Received: (qmail 21994 invoked from network); 12 Oct 2006 10:11:02 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 12 Oct 2006 10:11:01 -0000
Received: (qmail 34764 invoked from network); 12 Oct 2006 10:11:01 -0000
Received: from main.gmane.org (HELO ciao.gmane.org) (80.91.229.2)
  by a.mx.sunsite.dk with SMTP; 12 Oct 2006 10:11:00 -0000
Received: from list by ciao.gmane.org with local (Exim 4.43)
	id 1GXxVb-0001Ji-FN
	for zsh-users@sunsite.dk; Thu, 12 Oct 2006 12:09:47 +0200
Received: from calabi-yao.net ([69.93.127.252])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Thu, 12 Oct 2006 12:09:47 +0200
Received: from ljz by calabi-yao.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <zsh-users@sunsite.dk>; Thu, 12 Oct 2006 12:09:47 +0200
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-users@sunsite.dk
From:  Lloyd Zusman <ljz@asfast.com>
Subject:  Re: logout from interactive subshell
Date:  Thu, 12 Oct 2006 06:07:43 -0400
Lines: 71
Message-ID:  <87ac41c0eo.fsf@asfast.com>
References:  <237967ef0610120210r1d3a8c57n8850a4872b846c77@mail.gmail.com>
	<F7507090F1A72B43A51444325DFBE43101391E41@MCHP7R6A.ww002.siemens.net>
Mime-Version:  1.0
Content-Type:  text/plain; charset=us-ascii
X-Complaints-To: usenet@sea.gmane.org
Cc:  "Com MN PG P E B Consultant 3" <mn-pg-p-e-b-consultant-3.com@siemens.com>
X-Gmane-NNTP-Posting-Host: calabi-yao.net
User-Agent: Gnus/5.110006 (No Gnus v0.6) Emacs/21.4 (gnu/linux)
Cancel-Lock: sha1:38R1+yQsQvEF/TkyEOeRjbWWKUM=
Sender: news <news@sea.gmane.org>

"Com MN PG P E B Consultant 3"
<mn-pg-p-e-b-consultant-3.com@siemens.com> writes:

>> How about
>> function rlogin() {command rlogin "$@"; exit}
>> ?
>
> Hmmmm.... I don't see how this could help me. Actually, your
> solution would EXIT the shell I came from, after the login
> has finished!! So I not only have to type all the "exit"s on
> the remote host, I would even loose my current shell on the
> local host.
>
> Maybe to repeat what I would like to do:
>
> A typical application would go like this:
>
>    rlogin foobar
>    DO SOME STUFF
>    cleartool setview myview # this creates a subshell
>    DO MORE STUFF
>    cleartool setview yourview # now I'm two subshells deep
>    DO STILL MORE STUFF
>    # Now I want to exit
>    exit
>    exit
>    logout
>
> I would like to have a (interactive) command which does the final two
> exits plus
> a logout for me.
>
> BTW, I could imagine a solution using 'expect', which does the login,
> then hands
> over the control to the user, and finally if the user is done, performs
> the
> exit and logout.

With clearcase in the picture, this becomes complicated, due to the fact
that cleartool automatically puts you into a subshell whether you like
it or not.  That's one of several reasons for why I don't like
clearcase.

But given that you're probably stuck having to use it, you might try
something like this (assuming that you're using zsh):

Put this into your ~/.zlogin:

  [[ ${SHLVL:-0} == 1 ]] && {
    export LOGINPID=$$
  }

Then, after your "# Now I want to exit" comment (above), do this:

  kill -9 $LOGINPID

You can make this into an alias, if you wish.

It's an ugly hack, but it may be the only thing that you can do, given
that you're using clearcase.

I think it will work, but I can't test it, because clearcase isn't
installed on any of my machines.

Good luck!


-- 
 Lloyd Zusman
 ljz@asfast.com
 God bless you.

