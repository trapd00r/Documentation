From zsh-workers-return-19954-mason-zsh=primenet.com.au@sunsite.dk Tue May 18 15:54:37 2004
Return-Path: <zsh-workers-return-19954-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 856 invoked from network); 18 May 2004 15:54:36 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.86)
  by ns1.primenet.com.au with SMTP; 18 May 2004 15:54:36 -0000
Received: (qmail 32476 invoked from network); 18 May 2004 15:54:15 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 May 2004 15:54:15 -0000
Received: (qmail 23954 invoked by alias); 18 May 2004 15:54:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19954
Received: (qmail 23944 invoked from network); 18 May 2004 15:54:10 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 18 May 2004 15:54:07 -0000
Received: (qmail 32082 invoked from network); 18 May 2004 15:54:06 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 18 May 2004 15:54:04 -0000
Received: from localhost (localhost [127.0.0.1])
	by acolyte.scowler.net (Postfix) with ESMTP
	id 2AEFC7004B; Tue, 18 May 2004 11:53:29 -0400 (EDT)
Received: from acolyte.scowler.net ([127.0.0.1])
	by localhost (acolyte [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id 05854-05; Tue, 18 May 2004 11:53:26 -0400 (EDT)
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id E5CD670047; Tue, 18 May 2004 11:53:25 -0400 (EDT)
Date: Tue, 18 May 2004 11:53:25 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Cc: Nicolas George <nicolas.george@ens.fr>,
	249627-forwarded@bugs.debian.org
Subject: Re: Bug#249627: Alias + LC_CTYPE + function => segmentation fault
Message-ID: <20040518155325.GA6069@scowler.net>
References: <20040518152257.GA11291@clipper.ens.fr>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20040518152257.GA11291@clipper.ens.fr>
User-Agent: Mutt/1.5.5.1+cvs20040105i
X-Virus-Scanned: by amavisd-new-20030616-p7 (Debian) at scowler.net
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

I can't reproduce this myself.  Does gdb tell you anything?

On Tue, May 18, 2004 at 05:22:57PM +0200, Nicolas George wrote:
> Package: zsh
> Version: 4.2.0-10
> 
> With no config file at all (/etc/zsh removed and HOME=/tmp/empty), I get
> that:
> 
> ssecem% alias frobnicate="LC_CTYPE=en_US.UTF-8"
> ssecem% alias date="frobnicate date"
> ssecem% function date { command date; echo done }
> ssecem% date
> Tue May 18 17:08:42 CEST 2004
> done
> ssecem% date
> zsh: segmentation fault  HOME=/tmp/empty zsh
> 
> (Yes, I do have a real-world case where the bug appears.)
> 
> If I try to type "setopt" before all that to see enabled options (which
> are interactive, monitor, shinstdin and zle), the second date succeeds,
> but a third one sends zsh in an infinite loop eating all CPU.
> 
> 
> Here are details about my configuration:
> 
> debconf		1.4.25
> passwd		1:4.0.3-28
> libc6		2.3.2.ds1-12
> libcap1		1:1.10-14
> libncurses5	5.4-3
> 
> /usr/bin/zsh:
>                 libcap.so.1 => /lib/libcap.so.1 (0x40025000)
>         libdl.so.2 => /lib/tls/i686/cmov/libdl.so.2 (0x40029000)
>         libnsl.so.1 => /lib/tls/i686/cmov/libnsl.so.1 (0x4002d000)
>         libncurses.so.5 => /lib/libncurses.so.5 (0x40042000)
>         libm.so.6 => /lib/tls/i686/cmov/libm.so.6 (0x40081000)
>         libc.so.6 => /lib/tls/i686/cmov/libc.so.6 (0x400a4000)
>         /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
> 
> Linux ssecem 2.6.5 #2 Wed Apr 14 23:36:02 CEST 2004 i686 GNU/Linux


