From zsh-users-return-10893-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 23 02:31:43 2006
Return-Path: <zsh-users-return-10893-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13353 invoked from network); 23 Oct 2006 02:31:39 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Oct 2006 02:31:39 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 27733 invoked from network); 23 Oct 2006 02:31:32 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Oct 2006 02:31:32 -0000
Received: (qmail 15980 invoked by alias); 23 Oct 2006 02:31:24 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 10893
Received: (qmail 15971 invoked from network); 23 Oct 2006 02:31:23 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 23 Oct 2006 02:31:23 -0000
Received: (qmail 26576 invoked from network); 23 Oct 2006 02:31:23 -0000
Received: from vms042pub.verizon.net (206.46.252.42)
  by a.mx.sunsite.dk with SMTP; 23 Oct 2006 02:31:22 -0000
Received: from torch.brasslantern.com ([71.116.118.106])
 by vms042.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-4.02 (built Sep  9 2005))
 with ESMTPA id <0J7K00CNPHNKWFC1@vms042.mailsrvcs.net> for
 zsh-users@sunsite.dk; Sun, 22 Oct 2006 21:30:57 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id k9N2Utho016626	for
 <zsh-users@sunsite.dk>; Sun, 22 Oct 2006 19:30:56 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id k9N2UskA016625	for zsh-users@sunsite.dk; Sun,
 22 Oct 2006 19:30:54 -0700
Date: Sun, 22 Oct 2006 19:30:54 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Is this possible with MULTIOS
In-reply-to: <20061022.161634.41652125.Meino.Cramer@gmx.de>
To: zsh-users@sunsite.dk
Message-id: <061022193054.ZM16624@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <20061022.161634.41652125.Meino.Cramer@gmx.de>
Comments: In reply to Meino Christian Cramer <Meino.Cramer@gmx.de>
 "Is this possible with MULTIOS" (Oct 22,  4:16pm)

On Oct 22,  4:16pm, Meino Christian Cramer wrote:
} 
}  upcnt=`<update-cmd> | <filter> | wc -l`
}  if [ 0 -ne upcnt ]

If the filter is grep, it exits with a success code when it finds a
matching line or with failure when it does not, so you should be able
to do 

  if update-cmd | grep ...
  then recompile
  else ...
  fi

This would behave differently only if grep matched some lines and then
exited with an error.

However, to answer your literal question, yes, you can do this with
multios.  You just have to open an extra descriptor outside of the
subshell and redirect stdout to it inside the subshell.

  setopt multios
  uncnt=$(update-cmd | filter 1>&3 | wc -l) 3>&1

