From zsh-users-return-6591-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 17 11:06:49 2003
Return-Path: <zsh-users-return-6591-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10610 invoked from network); 17 Sep 2003 11:06:46 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 17 Sep 2003 11:06:46 -0000
Received: (qmail 11925 invoked by alias); 17 Sep 2003 11:06:24 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6591
Received: (qmail 11916 invoked from network); 17 Sep 2003 11:06:24 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 17 Sep 2003 11:06:24 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [212.227.126.201] by sunsite.dk (MessageWall 1.0.8) with SMTP; 17 Sep 2003 11:6:24 -0000
Received: from [172.17.36.7] (helo=erdbeere.use.schlund.de)
	by mxintern.kundenserver.de with esmtp (Exim 3.35 #1)
	id 19za8e-0007DE-00
	for zsh-users@sunsite.dk; Wed, 17 Sep 2003 13:06:24 +0200
Received: from luthien by erdbeere.use.schlund.de with local
	id 19za9j-0000nj-00
	for <zsh-users@sunsite.dk>; Wed, 17 Sep 2003 13:07:31 +0200
Date: Wed, 17 Sep 2003 13:07:31 +0200
From: Dominik Vogt <dominik.vogt@gmx.de>
To: Zsh Users <zsh-users@sunsite.dk>
Subject: Re: security risk in source builtin?
Message-ID: <20030917110731.GA535@gmx.de>
Reply-To: dominik.vogt@gmx.de
Mail-Followup-To: Zsh Users <zsh-users@sunsite.dk>
References: <20030916145820.GC4583@gmx.de> <20030917102420.GA2522@mail.guild.uwa.edu.au>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20030917102420.GA2522@mail.guild.uwa.edu.au>
User-Agent: Mutt/1.3.28i

On Wed, Sep 17, 2003 at 06:24:20PM +0800, James Devenish wrote:
> In message <20030916145820.GC4583@gmx.de>
> on Tue, Sep 16, 2003 at 04:58:20PM +0200, Dominik Vogt wrote:
> > but isn't it also a security risk?  In this case, the
> > following happened:
> > 
> >   $ ls -F
> >   test
> >   $ cat test
> >   echo hello world
> >   $ source test
> >   /usr/bin/test:3: bad pattern: ^@^F^@(...
 
> Could you please explain to me how this is a security risk? Are you
> merely trying to say that is offers the possibility of the wrong command
> being executed, or are you saying it could lead to some exploitable
> condition such as execution of a file that could not normally be
> executed?

To the casual user, it is not obvious why the $PATH should be
searched.  After all, scripts read with "source" or "." should
usually not be executable, so they do not belong into any
directory in the $PATH.  On the other hand scripts in the $PATH
normally begin with "#!<path to parser>" and should never be read
with "source" or "." (it's not guaranteed that the "#" character
introduces a comment).

This is not a vulnenrability per se and is not exploitable unless
the user makes an additional mistake (like using "." in the PATH).

The security risk here is that it is by no means obvious that or
why the $PATH is searched for the script.  At the very least, I
think "source" and "." should not attempt to read files in the
$PATH that are not executable.  Of course this is only my mersonal
opinion

> How is this different to simply feeding arbitrary bytes to the
> command line with your terminal or pipe?

Only in the way it is invoked.

P.S.:  I'm now subscribed to the mailing list.  It's not necessary
to answer to me personally.

Ciao

Dominik ^_^  ^_^

