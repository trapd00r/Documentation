From zsh-workers-return-13023-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Oct 18 09:08:57 2000
Return-Path: <zsh-workers-return-13023-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9792 invoked from network); 18 Oct 2000 09:08:56 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 Oct 2000 09:08:56 -0000
Received: (qmail 14571 invoked by alias); 18 Oct 2000 09:08:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13023
Received: (qmail 14563 invoked from network); 18 Oct 2000 09:08:50 -0000
Date: Wed, 18 Oct 2000 10:08:23 +0100
From: Peter Stephenson <pws@csr.com>
Subject: Re: parse errors and up-line-or-history
In-reply-to: "Your message of Tue, 17 Oct 2000 14:21:11 PDT."
 <001017142111.ZM3802@candle.brasslantern.com>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Message-id: <0G2M00EBTC1Z6M@la-la.cambridgesiliconradio.com>
Content-transfer-encoding: 7BIT

Bart wrote:
> On Oct 17,  3:35pm, E. Jay Berkenbilt wrote:
> > 
> > zsh% for in *; do echo $i; done
> > zsh: parse error near `do'
> > 
> > which seems entirely reasonable.  If you then do ^p to fix it, you see
> > only
> > 
> > zsh% for in *; do
> > 
> > and not the whole command.
>
> Zsh used to have an option to store the command history as the literal
> input text, rather than as lexical words.  IIRC, it actually stored both
> and let you select which one to retrieve.  The duplication was resolved
> in favor of lexical history a *very* long time ago, with the side-effect
> that anything that won't lex, doesn't make it into the history.

There was originally a partial fix that the rest of the line gets read in
and stuck on the end of the history without lexing.  I haven't looked at
this for a long time, so it may be at the mercy of various flags which
abort what you're doing.  It might be possible to get it working.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

