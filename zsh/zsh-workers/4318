From zsh-workers-request@math.gatech.edu Tue Aug 18 16:05:48 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4385 invoked from network); 18 Aug 1998 16:05:47 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 18 Aug 1998 16:05:47 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id LAA12527;
	Tue, 18 Aug 1998 11:59:24 -0400 (EDT)
Resent-Date: Tue, 18 Aug 1998 11:59:24 -0400 (EDT)
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <980818090148.ZM5899@candle.brasslantern.com>
Date: Tue, 18 Aug 1998 09:01:47 -0700
In-Reply-To: <199808181451.QAA03048@hydra.ifh.de>
Comments: In reply to Peter Stephenson <pws@ifh.de>
        "PATCH: 3.1.4: Re: zsh bug with local variables?" (Aug 18,  4:51pm)
References: <199808181451.QAA03048@hydra.ifh.de>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: PATCH: 3.1.4: Re: zsh bug with local variables?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"Tukxe.0.d33.SJQsr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4318
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Aug 18,  4:51pm, Peter Stephenson wrote:
} Subject: PATCH: 3.1.4: Re: zsh bug with local variables?
}
} !     /* If this was a local variable, we need to keep the old     *
} !      * struct so that it is resurrected at the right level.      *
} !      * This is partly because when an array/scalar value is set	 *
} !      * and the parameter used to be the other sort, unsetparam() *
} !      * is called.  Beyond that, there is an ambiguity:  should	 *
} !      * foo() { local bar; unset bar; } make the global  bar	 *
} !      * available or not?  The following makes the answer "no".   */

That's consistent with the 3.0.5 behavior.  Remember my namedir tests?
With this patch applied, 3.1.4 behaves exactly like 3.0.5 again:

zagzig% namedir_test
zsh 3.1.4
TEST 1
namedir1: test1=/etc
namedir1: test1=/etc
namedir2: test1=/etc
namedir1: test1=/etc
namedir3:
namedir1: test1=/etc
namedir4:
TEST 2
namedir1: test2=/etc
namedir1: test2=/etc
namedir2: test2=/etc
namedir1: test2=/etc
namedir3:
namedir1: test2=/etc
namedir4: test2=/usr/bin

(I still think the namedir4 behavior is wrong.)

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

