From zsh-workers-return-19765-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 13 05:33:05 2004
Return-Path: <zsh-workers-return-19765-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27250 invoked from network); 13 Apr 2004 05:33:04 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 13 Apr 2004 05:33:04 -0000
Received: (qmail 8346 invoked by alias); 13 Apr 2004 05:32:59 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19765
Received: (qmail 8335 invoked from network); 13 Apr 2004 05:32:59 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 13 Apr 2004 05:32:59 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 13 Apr 2004 5:32:59 -0000
Received: (qmail 18842 invoked from network); 13 Apr 2004 05:32:58 -0000
Received: from wbar3.sjo1-4-11-009-147.sjo1.dsl-verizon.net (HELO candle.brasslantern.com) (4.11.9.147)
  by a.mx.sunsite.dk with SMTP; 13 Apr 2004 05:32:48 -0000
Received: (from schaefer@localhost)
	by candle.brasslantern.com (8.11.6/8.11.6) id i3D5Wk520005
	for zsh-workers@sunsite.dk; Mon, 12 Apr 2004 22:32:46 -0700
X-Authentication-Warning: candle.brasslantern.com: schaefer set sender to schaefer@closedmail.com using -f
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <1040413053246.ZM20004@candle.brasslantern.com>
Date: Tue, 13 Apr 2004 05:32:46 +0000
In-Reply-To: <3571.1081806187@athlon>
Comments: In reply to Oliver Kiddle <okiddle@yahoo.co.uk>
        "Re: Compsys and KSH_AUTOLOAD" (Apr 12, 11:43pm)
References: <1040410174430.ZM10891@candle.brasslantern.com> 
	<1170.1081778412@athlon> 
	<040412085942.ZM19035@candle.brasslantern.com> 
	<3571.1081806187@athlon>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: While we're on the subject of zcompile ...
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: ****
X-Spam-Status: No, hits=4.7 required=6.0 tests=RCVD_IN_DYNABLOCK,
	RCVD_IN_NJABL,RCVD_IN_NJABL_DIALUP,RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 4.7

On Apr 12, 11:43pm, Oliver Kiddle wrote:
}
} Bart wrote:
} 
} > Matthias has since written back to me again and says he's having all
} > sorts of problems with zcompile'd functions
} 
} I've had problems with it in the past so it probably needs more
} investigation.

I find the behavior of "zcompile -a" (with no arguments) to be extremely
annoying.  There should be a way to say "dump all the functions you can,
and ignore the ones that are already loaded or can't be loaded" rather
than having it die entirely (blowing away the dump done so far) the first
time it encounters an un-dumpable function.

For one thing, if I've said "zcompile -a" with no arguments, then the
chances are pretty good that I didn't intend for it to even try to dump
already-loaded functions; if I wanted both, I'd have used "-c -a".  For
another, there's no way to tell in advance whether a function is going
to fail to autoload, so it's practically impossible to create a list of
names to pass as arguments.

The questions are whether it's cur_add_func() that should be taught to
ignore the error, or build_cur_dump(), and whether it should happen any
time there are no arguments, or there should be a flag to cause errors
to be ignored.

