From zsh-workers-return-24836-mason-zsh=primenet.com.au@sunsite.dk Fri Apr 18 01:24:31 2008
Return-Path: <zsh-workers-return-24836-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12636 invoked from network); 18 Apr 2008 01:24:30 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 Apr 2008 01:24:30 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 9782 invoked from network); 18 Apr 2008 01:24:24 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 Apr 2008 01:24:24 -0000
Received: (qmail 2547 invoked by alias); 18 Apr 2008 01:24:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24836
Received: (qmail 2532 invoked from network); 18 Apr 2008 01:24:21 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 18 Apr 2008 01:24:21 -0000
Received: from vms042pub.verizon.net (vms042pub.verizon.net [206.46.252.42])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 3629A808A379
	for <zsh-workers@sunsite.dk>; Fri, 18 Apr 2008 03:24:17 +0200 (CEST)
Received: from torch.brasslantern.com ([71.116.74.146])
 by vms042.mailsrvcs.net (Sun Java System Messaging Server 6.2-6.01 (built Apr
 3 2006)) with ESMTPA id <0JZH000D4YKD6201@vms042.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Thu, 17 Apr 2008 20:24:14 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id m3I1ODmH009588	for
 <zsh-workers@sunsite.dk>; Thu, 17 Apr 2008 18:24:13 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id m3I1OCSK009587	for zsh-workers@sunsite.dk; Thu,
 17 Apr 2008 18:24:12 -0700
Date: Thu, 17 Apr 2008 18:24:12 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: [PATCH] history locking with fcntl
In-reply-to: <20080418004942.GA1067@prunille.vinc17.org>
To: zsh-workers@sunsite.dk
Message-id: <080417182412.ZM9586@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <20080415153120.GE1223@prunille.vinc17.org>
	<20080417104054.295003e3@news01>	<080417065834.ZM9193@torch.brasslantern.com>
	<20080418004942.GA1067@prunille.vinc17.org>
Comments: In reply to Vincent Lefevre <vincent@vinc17.org>
 "Re: [PATCH] history locking with fcntl" (Apr 18,  2:49am)
X-Virus-Scanned: ClamAV 0.91.2/6815/Fri Apr 18 01:56:17 2008 on bifrost
X-Virus-Status: Clean

On Apr 18,  2:49am, Vincent Lefevre wrote:
}
} > (more specifically, only creat() was guaranteed to be atomic and
} > lock daemons were flaky).
} 
} Some software, like Firefox, uses symlink() locking. So, if symlink()
} isn't atomic, there will be problems with such software.

(1) Note I said "was", not "is".

(2) Procmail's code pre-dates near-universal availability of symlink().

} I don't see why it can be dangerous if it is used in addition to
} another lock mechanism, like it currently is.

That's OK, then (as long as the equivalent of rpc.lockd is running, of
course).  My copy of your message didn't actually have the patch in it, 
and I've been running back and forth to a conference all this week so
I didn't go out of my way to check whether this was an "either" or an
"as well."

