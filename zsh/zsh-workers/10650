From zsh-workers-return-10650-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Apr 11 11:19:17 2000
Return-Path: <zsh-workers-return-10650-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3920 invoked from network); 11 Apr 2000 11:19:16 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 11 Apr 2000 11:19:16 -0000
Received: (qmail 14611 invoked by alias); 11 Apr 2000 11:19:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10650
Received: (qmail 14574 invoked from network); 11 Apr 2000 11:18:59 -0000
Date: Tue, 11 Apr 2000 13:18:50 +0200 (MET DST)
Message-Id: <200004111118.NAA03892@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Tue, 11 Apr 2000 14:51:25 +0400
Subject: Re: ** matcher does not work anymore


Andrej Borsenkow wrote:

> This stopped to work:
> 
> bor@itsrm2% l /tools/share/zsh
> 3.1.6-dev-22/    site-functions/
> bor@itsrm2% l /to/sh/z/-22<TAB>
> B-e-e-p
> 
> It did work at least yesterday.

Ahem. The problem wasn't the `**'. The problem was that I got a bit
confused with the blanks in file-patterns, forgetting to remove
trailing spaces from the tags.

Sorry to everyone...

> Yes, I do use ** matcher.

I know, implemented personally for you ;-)

Bye
 Sven

Index: Completion/Core/_files
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_files,v
retrieving revision 1.7
diff -u -r1.7 _files
--- Completion/Core/_files	2000/04/11 07:57:56	1.7
+++ Completion/Core/_files	2000/04/11 11:17:13
@@ -47,7 +47,7 @@
 for def in "$pats[@]"; do
   def="${def##[[:blank:]]#}"
   while [[ "$def" = *[^\\][[:blank:]]* ]]; do
-    sdef="${(M)def#*[^\\][[:blank:]]}"
+    sdef="${${(M)def#*[^\\][[:blank:]]}%%[[:blank:]]#}"
     tag="${${sdef#*[^\\]:}%%:*}"
     pat="${${${sdef%%:${tag}*}//\\\\:/:}//,/ }"
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

