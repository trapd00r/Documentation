From zsh-workers-request@math.gatech.edu Sat Jun 06 00:54:24 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24382 invoked from network); 6 Jun 1998 00:54:23 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 6 Jun 1998 00:54:23 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id UAA08255;
	Fri, 5 Jun 1998 20:48:04 -0400 (EDT)
Resent-Date: Fri, 5 Jun 1998 20:47:47 -0400 (EDT)
X-Face: 3su_O5R!|})4gc|&nXdVILe~2hIncsaJF_<Oc-Jh^/CMkcS<hf^xDqKMy*k"_g5l>TC>rnR
 NA0Aj<M}5Wt'(7ed8SwQYk-hVi2lG\mkc2$h/Kg706R%]c(14w:>-u\*nln*:ktY!d+[%K()Q|1*-U
 [+xczKd$Xev:F#3'rFgot\l.I+w>DQ%:%HOyZ]EgFw@0[gMFsR-E`Hs~tjkc>y.<T7~KVE0-$=ca5]
 LEV[[CXa(!|P:Y--3j|)%&B,FVU(-DDBBHU%aRKLrtO>i#y<55R_CScR
To: zsh-users@math.gatech.edu
Subject: sigsegv bug in 3.1.4.
From: David Hedbor <david@hedbor.org>
Mime-Version: 1.0 (generated by tm-edit 7.106)
Content-Type: text/plain; charset=US-ASCII
Date: 05 Jun 1998 17:47:59 -0700
Message-ID: <86n2br9wzk.fsf@animearchive.org>
Lines: 39
X-Mailer: Gnus v5.6.5/Emacs 19.34
Resent-Message-ID: <"f42523.0.Q02.h69Ur"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1578
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

I noticed a bug in the latest beta version. It's easy to reproduce and
should be rather easy to fix. I didn't try myself, since I am familiar
with the zsh code.

Reproduce it:

	unset LC_CTYPE
	export LC_CTYPE

This results in a sigsev:

Program received signal SIGSEGV, Segmentation fault.
0x807e59e in mkenvstr (name=0x80a1b4c "LC_CTYPE", value=0x0) at
params.c:2075
2075             *s && (*s++ != Meta || *s++ != 32); len_value++);
(gdb) bt
#0  0x807e59e in mkenvstr (name=0x80a1b4c "LC_CTYPE", value=0x0)
    at params.c:2075
#1  0x807e72e in addenv (name=0x80a1b4c "LC_CTYPE", value=0x0) at
#params.c:2114
#2  0x8052a66 in bin_typeset (name=0x80a19f4 "export", argv=0x80a1c80,
    ops=0xbffff748 "", func=21) at builtin.c:1590
#3  0x804fc77 in execbuiltin (args=0x80a1b28, bn=0x8097334) at
#builtin.c:352
#4  0x805d097 in execcmd (cmd=0x80a1b08, input=0, output=0, how=2,
#last1=2)
    at exec.c:1806
#5  0x805a972 in execpline2 (pline=0x80a1c5c, how=2, input=0,
#output=0,
    last1=0) at exec.c:902
#6  0x805a2be in execpline (l=0x80a1af4, how=2, last1=0) at exec.c:747
#7  0x8059f73 in execlist (list=0x80a1c6c, dont_change_job=0,
#exiting=0)
    at exec.c:627

The reason is of course that the value is NULL.

-- 
David Hedbor

