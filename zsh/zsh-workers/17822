From zsh-workers-return-17822-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 14 22:01:08 2002
Return-Path: <zsh-workers-return-17822-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4055 invoked from network); 14 Oct 2002 22:01:07 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 14 Oct 2002 22:01:07 -0000
Received: (qmail 5007 invoked by alias); 14 Oct 2002 22:00:43 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17822
Received: (qmail 4941 invoked from network); 14 Oct 2002 22:00:28 -0000
Date: Mon, 14 Oct 2002 18:00:21 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Cc: Marco Bodrato <bodrato@gulp.linux.it>, 164686-forwarded@bugs.debian.org
Subject: Re: Bug#164686: zsh: Wrong floatting point operation (when locale_decimal_sign=","?)
Message-ID: <20021014220021.GB30674@dman.com>
References: <E1816J0-0001YL-00@debian>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <E1816J0-0001YL-00@debian>
User-Agent: Mutt/1.4i
X-Virus-Scanned: by amavisd-milter (http://amavis.org/)

> Here is the log of a repetible, wrong session of zsh:
> 
> $ LANG=it_IT@euro zsh
> debian% a=4003
> debian% b=4
> debian% typeset -F 4 a
> debian% typeset -F 4 c
> debian% c=$((a/b))
> debian% print $c
> 75,0000
> debian% c=5.5
> debian% c=$((a/b))
> debian% print $c
> 1000.7500
> debian% exit
> 
> And here is the correct one:
> 
> $ LANG=C zsh
> debian% a=4003
> debian% b=4
> debian% typeset -F 4 a
> debian% typeset -F 4 c
> debian% c=$((a/b))
> debian% print $c
> 1000.7500
> debian% exit
> 
> I think the problem reside in the fact that in italian we write
> 4003/4 = 1.000,75

Do we need another set of setlocale() calls somewhere?

