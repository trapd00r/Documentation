From zsh-workers-return-21774-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 28 03:05:17 2005
Return-Path: <zsh-workers-return-21774-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19337 invoked from network); 28 Sep 2005 03:05:14 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 28 Sep 2005 03:05:14 -0000
Received: (qmail 59743 invoked from network); 28 Sep 2005 03:05:08 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 28 Sep 2005 03:05:08 -0000
Received: (qmail 13535 invoked by alias); 28 Sep 2005 03:05:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21774
Received: (qmail 13499 invoked from network); 28 Sep 2005 03:05:01 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 28 Sep 2005 03:05:00 -0000
Received: (qmail 58993 invoked from network); 28 Sep 2005 03:05:00 -0000
Received: from flock1.newmail.ru (212.48.140.157)
  by a.mx.sunsite.dk with SMTP; 28 Sep 2005 03:04:59 -0000
Received: (qmail 20557 invoked from network); 28 Sep 2005 02:53:39 -0000
Received: from unknown (HELO cooker.home.net) (arvidjaar@newmail.ru@83.237.13.110)
  by smtpd.newmail.ru with SMTP; 28 Sep 2005 02:53:39 -0000
From: Andrey Borzenkov <arvidjaar@newmail.ru>
To: zsh-workers@sunsite.dk
Subject: Re: Regression in UTF-8 support
Date: Wed, 28 Sep 2005 07:04:49 +0400
User-Agent: KMail/1.8.2
References: <200509252005.41824.arvidjaar@newmail.ru> <20050927152247.6a1f6452.pws@csr.com> <237967ef05092710007dfd7b1b@mail.gmail.com>
In-Reply-To: <237967ef05092710007dfd7b1b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart3447637.q3aMy1vVLG";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200509280704.50012.arvidjaar@newmail.ru>
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

--nextPart3447637.q3aMy1vVLG
Content-Type: text/plain;
  charset="gb2312"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

On Tuesday 27 September 2005 21:00, Mikael Magnusson wrote:
> On 9/27/05, Peter Stephenson <pws@csr.com> wrote:
> > Andrey Borzenkov <arvidjaar@newmail.ru> wrote:
> > > this fixed history truncation but not strange mangling in completion
> > > listing.
> >
> > There were some bits I missed or got wrong when updating nicechar().
>
> This seems to fix most things here,=20

yes, completion listing for sure (sans width calculation :)

> but when i look at the history=20
> file, some utf characters aren't saved correctly, but they become
> correct when up-arrowing in zsh. Manually entering the same utf-8 code
> in the history file seems to not confuse zsh though, but pressing
> enter saves the "malformed" entry again. In my case the utf is =A4=B7,
> hiragana shi, 0xE38107. It is saved in history as =A4=A3=A1=A4, 0xE38183C=
2B7.
>

Zsh saves it metafied. I agree, external representation should be unmetafie=
d;=20
OTOH this is unlikely to depend on UTF-8 support, it is just that those=20
characters are usually unused in 8-bit character sets so nobody has probabl=
y=20
noticed this before

=2Dandrey=20

PS I am pretty much impressed; finally there is valid usage for UTF-8 encod=
ing=20
in E-Mail. Good bye legacy terminals?

--nextPart3447637.q3aMy1vVLG
Content-Type: application/pgp-signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)

iD8DBQBDOghRR6LMutpd94wRAqrzAJ4jYFXb5l/9i8R94WikfxpSLcqDsgCeJA8M
Hq51cWfJYSmGl9CWGuBL69k=
=8kvS
-----END PGP SIGNATURE-----

--nextPart3447637.q3aMy1vVLG--

