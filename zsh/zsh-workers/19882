From zsh-workers-return-19882-mason-zsh=primenet.com.au@sunsite.dk Wed May 05 20:59:45 2004
Return-Path: <zsh-workers-return-19882-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2392 invoked from network); 5 May 2004 20:59:44 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.86)
  by ns1.primenet.com.au with SMTP; 5 May 2004 20:59:44 -0000
Received: (qmail 13725 invoked from network); 5 May 2004 20:59:27 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 May 2004 20:59:27 -0000
Received: (qmail 18204 invoked by alias); 5 May 2004 20:59:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19882
Received: (qmail 18193 invoked from network); 5 May 2004 20:59:12 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 5 May 2004 20:59:09 -0000
Received: (qmail 13187 invoked from network); 5 May 2004 20:59:09 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 5 May 2004 20:59:07 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 414877004A; Wed,  5 May 2004 16:58:40 -0400 (EDT)
Date: Wed, 5 May 2004 16:58:40 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Cc: Kurt Roeckx <Q@ping.be>, 247556-forwarded@bugs.debian.org
Subject: Re: Bug#247556: zsh build gets stuck running tests.
Message-ID: <20040505205840.GA30862@scowler.net>
References: <20040505194300.GA3142@ping.be>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20040505194300.GA3142@ping.be>
User-Agent: Mutt/1.5.5.1+cvs20040105i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

I don't know the cause, but this has happened in the past on sparc(64),
though only under sbuild (a perl script).

On Wed, May 05, 2004 at 09:43:00PM +0200, Kurt Roeckx wrote:
> 
> When building the package on amd64, it runs fine until it gets to this
> point:
> ../../Test/B03print.ztst: starting.
> ../../Test/B03print.ztst: all tests successful.
> ../../Test/B04read.ztst: starting.
> 
> Then you see this in ps:
> 
> root     18855  0.0  0.2  5580 1140 ?        TN   19:31   0:00 sh -c dpkg-buildpackage -us -uc -B -r/usr/bin/fakeroot 2>&1
> root     18856  0.0  0.2  5616 1236 ?        TN   19:31   0:00 /bin/sh /usr/bin/dpkg-buildpackage -us -uc -B -r/usr/bin/fakeroot
> root     18982  0.0  0.1  5412  848 ?        TN   19:31   0:00 /usr/bin/make -f
> debian/rules build
> root     31972  0.0  0.2  5572 1144 ?        TN   19:35   0:00 /bin/sh -c cd obj && /usr/bin/make check
> root     31973  0.0  0.2  5692 1104 ?        TN   19:35   0:00 /usr/bin/make check
> root     31974  0.0  0.2  5572 1144 ?        TN   19:35   0:00 /bin/sh -c cd Test ; /usr/bin/make check
> root     31975  0.0  0.1  5412  840 ?        TN   19:35   0:00 /usr/bin/make check
> root     32150  0.0  0.2  5584 1168 ?        TN   19:35   0:00 /bin/sh -c for f in ../../Test/*.ztst; do  ../Src/zsh +Z -f ../../Test/ztst.zsh
> $f;  done root       728  0.0  0.3 13704 1680 ?        TN   19:35   0:00 ../Src/zsh +Z -f ../../Test/ztst.zsh ../../Test/B04read.ztst
> 
> As you can see all the processes are suddenly stuck in state "T",
> straced/stopped.
> 
> I can get them all back to working using KILL -CONT, but if I do
> the same on the last process (pid 728, the test), they all end up
> in stop again.
> 
> I then tried to strace it, and get then get this all over and
> over again:
> --- SIGTTOU (Stopped (tty output)) @ 0 (0) ---
> --- SIGTTOU (Stopped (tty output)) @ 0 (0) ---
> ioctl(11, SNDCTL_TMR_STOP or TCSETSW, {B38400 opost isig -icanon
> echo ...}) = ?
> ERESTARTSYS (To be restarted)
> 
> If I kill -9 728 and -CONT the rest the build goes on fine and
> says it's succesful.
> 
> Anybody got any idea what might be wrong or how I can test what's
> really going on?
> 
> 
> Kurt

