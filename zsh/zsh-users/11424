From zsh-users-return-11424-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 17 18:13:33 2007
Return-Path: <zsh-users-return-11424-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25504 invoked from network); 17 Apr 2007 18:13:31 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 Apr 2007 18:13:31 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 64454 invoked from network); 17 Apr 2007 18:13:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 Apr 2007 18:13:26 -0000
Received: (qmail 19834 invoked by alias); 17 Apr 2007 18:13:11 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11424
Received: (qmail 19817 invoked from network); 17 Apr 2007 18:13:08 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 17 Apr 2007 18:13:08 -0000
Received: (qmail 63017 invoked from network); 17 Apr 2007 18:13:08 -0000
Received: from dsl-74-220-69-151.cruzio.com (HELO dot.blorf.net) (74.220.69.151)
  by a.mx.sunsite.dk with SMTP; 17 Apr 2007 18:13:04 -0000
Received: by dot.blorf.net (Postfix, from userid 1000)
	id AC1221617C; Tue, 17 Apr 2007 11:13:02 -0700 (PDT)
Date: Tue, 17 Apr 2007 11:13:02 -0700
From: Wayne Davison <wayned@users.sourceforge.net>
To: Peter Stephenson <pws@csr.com>
Cc: Zsh users list <zsh-users@sunsite.dk>
Subject: Re: zsh 4.3.3 released
Message-ID: <20070417181302.GB28756@blorf.net>
References: <200704161647.l3GGl2FE027950@news01.csr.com>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="GvXjxJ+pjyke8COw"
Content-Disposition: inline
In-Reply-To: <200704161647.l3GGl2FE027950@news01.csr.com>
User-Agent: Mutt/1.5.13 (2006-08-11)


--GvXjxJ+pjyke8COw
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

On Mon, Apr 16, 2007 at 05:47:02PM +0100, Peter Stephenson wrote:
> I've uploaded version 4.3.3 of zsh to ftp.zsh.org.

I just tested out the latest CVS version, and found that I get an error
using the smart-insert-last-word function:

smart-insert-last-word:108: bad math expression: operator expected at `Account fo...'

The attached patch fixes this for me.  Was it ever possible to infix a
comment inside a math expression?

..wayne..

--GvXjxJ+pjyke8COw
Content-Type: text/x-diff; charset=us-ascii
Content-Disposition: attachment; filename="smart.patch"

--- Functions/Zle/smart-insert-last-word	26 Feb 2007 07:43:39 -0000	1.3
+++ Functions/Zle/smart-insert-last-word	17 Apr 2007 18:06:36 -0000
@@ -104,8 +104,8 @@ fi
               found=$lastcmd[(I)$pattern]
           done
       fi
-      (( found-- > 0 &&            # Account for 1-based index
-        (numeric = $#lastcmd - found) ))
+      # The following will account for 1-based index
+      (( found-- > 0 && (numeric = $#lastcmd - found) ))
   fi
 } always {
   HISTNO=$_ilw_hist                # Return to current command

--GvXjxJ+pjyke8COw--

