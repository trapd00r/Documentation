From zsh-workers-request@math.gatech.edu Mon Nov 02 09:57:10 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23107 invoked from network); 2 Nov 1998 09:57:08 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 2 Nov 1998 09:57:08 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id EAA10565;
	Mon, 2 Nov 1998 04:50:31 -0500 (EST)
Resent-Date: Mon, 2 Nov 1998 04:50:25 -0500 (EST)
From: kristiag@stud.math.ntnu.no
Message-ID: <19981102103233.A1700@stud.math.ntnu.no>
Date: Mon, 2 Nov 1998 10:32:33 +0100
To: zsh-users@math.gatech.edu
Subject: Re: Strange behaviour of zsh-3.1.5 on IRIX 6.2
References: <19981031003916.B29500@cs.uni-magdeburg.de> <Pine.LNX.4.05.9810301553210.6235-100000@protovision.fcn.net> <13884.8743.733953.358182@knecht>
Mime-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Mailer: Mutt 0.91.1
In-Reply-To: <13884.8743.733953.358182@knecht>; from Roland Jesse on Sun, Nov 01, 1998 at 09:56:07AM +0100
Resent-Message-ID: <"xufQd3.0.Pa2.X1OFs"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1917
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Sun, Nov 01, 1998 at 09:56:07AM +0100, Roland Jesse wrote:
> After the build the shell works just fine on this particular
> machine. But on another O2 machine I simply get: "13116:-zsh: rld:
> Fatal Error: attempted access to unresolvable symbol in -zsh:
> cap_get_proc."
> 
> I am not a 100% sure what IRIX version this other machine is
> running. Is it possible that it might have a problem with a zsh build
> on a 6.4 system?

Running binaries compiled on a newer version of IRIX on older versions
is not supported. So you should compile binaries on your IRIX 6.3
machine and use them on both your 6.3 and 6.4 machines (I assume your
O2 runs IRIX 6.3, not 6.5).

As regards the original strange problem, I have been unable to compile
a working zsh-3.1.5 with `MIPSpro Compilers: Version 7.2.1.2m' on my
IRIX 6.2 machine. Using `egcs-2.92.07 19980914' works just fine,
however.

I did some debugging and found that a typtab array came out differently
in the two versions. So with the following patch, zsh-3.1.5 seems to
work on IRIX 6.2 using said MIPSpro compiler. Now, obviously, this is
just silly and should not be used, but I hope this can point others in
the right direction. I do not have time to debug this further.

--- /Stores/stash/zsh/src-3.1.5-local/Src/utils.c       Thu Oct 15 23:46:01 1998
+++ utils.c     Mon Nov  2 09:43:16 1998
@@ -2387,6 +2387,8 @@
        typtab[STOUC(*s)] |= ISPECIAL;
     if (isset(BANGHIST) && bangchar && interact && isset(SHINSTDIN))
        typtab[bangchar] |= ISPECIAL;
+    typtab[0] = 4640;
+    typtab[32] = 10284;
 }
 
 /**/

-- 
Kristian Gjøsteen

