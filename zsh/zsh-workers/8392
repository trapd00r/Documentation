From zsh-workers-return-8392-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Oct 24 17:33:38 1999
Return-Path: <zsh-workers-return-8392-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15023 invoked from network); 24 Oct 1999 17:33:36 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Oct 1999 17:33:36 -0000
Received: (qmail 12400 invoked by alias); 24 Oct 1999 17:33:31 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8392
Received: (qmail 12393 invoked from network); 24 Oct 1999 17:33:31 -0000
Sender: aduret@venus.l2i
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: files attributes not colored by complist
X-Attribution: plx
From: Alexandre Duret-Lutz <alexandre.duret@greyc.ismra.fr>
Date: 24 Oct 1999 20:32:34 +0100
Message-ID: <7d3dv0tuzx.fsf@venus.l2i>
Lines: 43
User-Agent: Gnus/5.0700000000000003 (Pterodactyl Gnus v0.97) Emacs/20.2
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


This is just a cosmetic patch so that complist 
does not color files' attributes (as does GNU ls).


--- Src/Zle/complist.c.old	Thu Oct 21 13:47:02 1999
+++ Src/Zle/complist.c	Sun Oct 24 20:13:48 1999
@@ -401,6 +401,13 @@
 	nicezputs((m->disp ? m->disp : m->str), shout);
 	len = niceztrlen(m->disp ? m->disp : m->str);
 
+	if (m->gnum != mselect) {
+	    if (mcolors.cols[COL_EC])
+		tputs(mcolors.cols[COL_EC], 1, putshout);
+	    else
+		zcputs(&mcolors, COL_NO);
+	}
+
 	if (isset(LISTTYPES)) {
 	    if (buf)
 		putc(file_type(buf->st_mode), shout);
@@ -413,10 +420,13 @@
 	while (len-- > 0)
 	    putc(' ', shout);
 
-	if (mcolors.cols[COL_EC])
-	    tputs(mcolors.cols[COL_EC], 1, putshout);
-	else
-	    zcputs(&mcolors, COL_NO);
+	if (m->gnum == mselect) {
+	    if (mcolors.cols[COL_EC])
+		tputs(mcolors.cols[COL_EC], 1, putshout);
+	    else
+		zcputs(&mcolors, COL_NO);
+	}
+
 	if (!lastc) {
 	    zcputs(&mcolors, COL_NO);
 	    fputs("  ", shout);


-- 
Alexandre Duret-Lutz

