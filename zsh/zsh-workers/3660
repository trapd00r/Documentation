From zsh-workers-request@math.gatech.edu Fri Dec 26 12:32:43 1997
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 21140 invoked from network); 26 Dec 1997 12:32:41 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 26 Dec 1997 12:32:41 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id HAA12631;
	Fri, 26 Dec 1997 07:17:23 -0500 (EST)
Resent-Date: Fri, 26 Dec 1997 07:17:23 -0500 (EST)
Sender: k@anna.in-berlin.de
To: zsh-workers@math.gatech.edu
Subject: 3.0.5 Src/Makefile.in doesn't stop after error
From: koenig@kulturbox.de (Andreas J. Koenig)
Date: 26 Dec 1997 13:17:13 +0100
In-Reply-To: Tuomo Pyhala's message of "Fri, 26 Dec 1997 01:00:15 +0200 (EET)"
Message-ID: <sfcra705meu.fsf@anna.in-berlin.de>
Lines: 41
X-Mailer: Gnus v5.4.66/Emacs 19.34
Resent-Message-ID: <"uNNBV2.0.I53.J1weq"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3660
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

The Src/Makefile.in has a buglet in the rule for rlimits.h.

The patch below deletes a quite useless warning that has the
inappropriate side effect of returning TRUE instead of FALSE.

Without the patch a failing awk script (which I will describe in a
separate message) doesn't stop the make from proceeding. In my case,
on a NeXT 3.3, this leads to an empty Src/rlimits.h which leads to a
failing compilation later. It is much easier to find the cause for the
troubles if the error becomes visible immediately when it happens.

The current warning is unlikely to be seen by anybody. It comes quite
early during the first run of a make. It won't be issued again if you
repeat the make. It just gets buried and can only be reproduced by
removing the empty rlimits.h file.

*** /tmp/Makefile.in.~1.1~	Fri Dec 26 13:11:34 1997
--- /tmp/Makefile.in	Fri Dec 26 13:11:34 1997
***************
*** 135,142 ****
  # silent so the warning doesn't appear unless necessary
  rlimits.h: rlimits.awk $(RLIMITS_INC_H)
  	@echo '$(AWK) -f $(srcdir)/rlimits.awk $(RLIMITS_INC_H) > rlimits.h'; \
! 	$(AWK) -f $(srcdir)/rlimits.awk $(RLIMITS_INC_H) > rlimits.h || \
! 	    echo WARNING: unknown limits:  mail rlimits.h to developers
  
  $(OBJS): $(HDRS)
  
--- 135,141 ----
  # silent so the warning doesn't appear unless necessary
  rlimits.h: rlimits.awk $(RLIMITS_INC_H)
  	@echo '$(AWK) -f $(srcdir)/rlimits.awk $(RLIMITS_INC_H) > rlimits.h'; \
! 	$(AWK) -f $(srcdir)/rlimits.awk $(RLIMITS_INC_H) > rlimits.h
  
  $(OBJS): $(HDRS)
  


Enjoy,
-- 
andreas

