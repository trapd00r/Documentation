From zsh-workers-request@euclid.skiles.gatech.edu Sun Dec 15 22:49:48 1996
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 647 invoked from network); 15 Dec 1996 22:49:46 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 15 Dec 1996 22:49:46 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id RAA23862; Sun, 15 Dec 1996 17:47:39 -0500 (EST)
Resent-Date: Sun, 15 Dec 1996 17:47:39 -0500 (EST)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199612152245.XAA00352@hzoli.ppp.cs.elte.hu>
Subject: Glob qualifiers bug?
To: zsh-workers@math.gatech.edu (Zsh hacking and development)
Date: Sun, 15 Dec 1996 23:45:23 +0100 (MET)
X-Mailer: ELM [version 2.4ME+ PL17 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"1Qw-H.0.nq5.B08jo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2587
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

The glob pattern *(@-.,/) should match symbolic links to plain files and
directories but instead it matches symbolic links to directories as well.
The problem is that the - toggle has effect over the comma.  The ^ (not)
toggle behaves similarily.  This behaviour might be considered a feature
but the manual suggests that it's not a feature but a bug.  The patch below
fixes this.  It resets these toggles to their default after each comma.
Tell me if you think I do not interpret the manual correctly.

Zoltan


*** Src/glob.c	1996/12/08 02:55:55	3.1.0.2
--- Src/glob.c	1996/12/15 22:33:18
***************
*** 187,192 ****
--- 187,193 ----
  		} else if (*s == ',') {
  		    /* A comma separates alternative sets of qualifiers */
  		    s++;
+ 		    sense = 0;
  		    if (qualct) {
  			qn = (struct qual *)hcalloc(sizeof *qn);
  			qo->or = qn;

