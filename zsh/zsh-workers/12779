From zsh-workers-return-12779-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Sep 08 08:14:42 2000
Return-Path: <zsh-workers-return-12779-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1005 invoked from network); 8 Sep 2000 08:14:40 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Sep 2000 08:14:40 -0000
Received: (qmail 8687 invoked by alias); 8 Sep 2000 08:14:33 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12779
Received: (qmail 8680 invoked from network); 8 Sep 2000 08:14:32 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>
Subject: PATCH: remove sinix special case in system.h
Date: Fri, 8 Sep 2000 12:14:29 +0400
Message-ID: <000401c0196c$cf467f00$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400


It reverts this one (ChangeLog-Release):

Sat May 30 16:16:13 1998  Andrew Main  <zefram@zsh.org>

        * Src/system.h: #define _XPG_IV on SINIX (Reliant UNIX).  It is
          reported that this is necessary in order to get the right
          version of gettimeofday().

Setting _XPG_IV here is not quite correct. It modifies some system headers and
is expected to be set by compiler if called with appropriate flag, in which
case also different startup files are linked. I.e. it possibly gives you
headers that correspond neither to configure run nor to run-time support.

Also, currently suported versions (to which I have access) do not need it
anymore. For this reason I am too lazy to add check for gettimeofday()
prototype, given that it works everywhere else. But if anybody insists ...

I leave it in place for a while as reminder.

-andrej

Have a nice DOS!
B >>

Index: Src/system.h
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/system.h,v
retrieving revision 1.7
diff -u -r1.7 system.h
--- Src/system.h        2000/08/14 16:46:19     1.7
+++ Src/system.h        2000/09/08 08:05:54
@@ -27,8 +27,14 @@
  *
  */

+#if 0
+/*
+ * Setting _XPG_IV here is actually wrong and is not needed
+ * with currently supported versions (5.43C20 and above)
+ */
 #ifdef sinix
 # define _XPG_IV 1
+#endif
 #endif

 /* NeXT has half-implemented POSIX support *

