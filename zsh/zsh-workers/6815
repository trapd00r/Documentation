From zsh-workers-return-6815-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jun 23 15:26:17 1999
Return-Path: <zsh-workers-return-6815-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23078 invoked from network); 23 Jun 1999 15:26:14 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 23 Jun 1999 15:26:14 -0000
Received: (qmail 28760 invoked by alias); 23 Jun 1999 15:25:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6815
Received: (qmail 28753 invoked from network); 23 Jun 1999 15:25:45 -0000
Date: Wed, 23 Jun 1999 17:25:43 +0200 (MET DST)
Message-Id: <199906231525.RAA07314@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: fix for complist


You may have noticed that menu-selection doesn't work when there are
matches that are not shown. I overlooked one place where we have to
switch off selection in such a case.

It's a pity, isn't it? The alternative would be to allow
menu-selection but then you wouldn't be able to get at the hidden
matches (which would clash with e.g. _correct when it inserts the
original string into the line).

Bye
 Sven

diff -u os/Zle/complist.c Src/Zle/complist.c
--- os/Zle/complist.c	Wed Jun 23 17:10:07 1999
+++ Src/Zle/complist.c	Wed Jun 23 17:20:54 1999
@@ -349,7 +349,8 @@
 		    if ((l = niceztrlen(m->str)) > longest)
 			longest = l;
 		    nlist++;
-		}
+		} else
+		    noselect = 1;
 	    }
 	}
 	if ((e = g->expls)) {

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

