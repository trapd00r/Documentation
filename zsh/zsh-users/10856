From zsh-users-return-10856-mason-zsh=primenet.com.au@sunsite.dk Fri Oct 13 09:05:28 2006
Return-Path: <zsh-users-return-10856-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5225 invoked from network); 13 Oct 2006 09:05:22 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.6 (2006-10-03) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.6
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 13 Oct 2006 09:05:22 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 36411 invoked from network); 13 Oct 2006 09:05:12 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2006 09:05:12 -0000
Received: (qmail 18261 invoked by alias); 13 Oct 2006 09:05:01 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 10856
Received: (qmail 18230 invoked from network); 13 Oct 2006 09:05:00 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 13 Oct 2006 09:05:00 -0000
Received: (qmail 34971 invoked from network); 13 Oct 2006 09:05:00 -0000
Received: from ms-2.rz.rwth-aachen.de (HELO ms-dienst.rz.rwth-aachen.de) (134.130.3.131)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2006 09:04:58 -0000
Received: from r220-1 (r220-1.rz.RWTH-Aachen.DE [134.130.3.31])
 by ms-dienst.rz.rwth-aachen.de
 (iPlanet Messaging Server 5.2 Patch 2 (built Jul 14 2004))
 with ESMTP id <0J72006IZH89QX@ms-dienst.rz.rwth-aachen.de> for
 zsh-users@sunsite.dk; Fri, 13 Oct 2006 11:04:58 +0200 (MEST)
Received: from relay.rwth-aachen.de ([134.130.3.1])
	by r220-1 (MailMonitor for SMTP v1.2.2 ) ; Fri,
 13 Oct 2006 11:04:57 +0200 (MEST)
Received: from fsst.voodoo.lan ([212.117.84.3])
	by relay.rwth-aachen.de (8.13.7/8.13.3/1) with ESMTP id k9D94v5L019638	for
 <zsh-users@sunsite.dk>; Fri, 13 Oct 2006 11:04:57 +0200 (MEST)
Received: from hawk by fsst.voodoo.lan with local (Exim 4.63)
	(envelope-from <ft@bewatermyfriend.de>)
	id 1GYIxq-0001EO-FT	for zsh-users@sunsite.dk; Fri, 13 Oct 2006 11:04:22 +0200
Date: Fri, 13 Oct 2006 11:04:22 +0200
From: Frank Terbeck <ft@bewatermyfriend.de>
Subject: matching commands by pattern
To: zsh users <zsh-users@sunsite.dk>
Mail-followup-to: zsh users <zsh-users@sunsite.dk>
Message-id: <20061013090422.GH4262@fsst.voodoo.lan>
MIME-version: 1.0
Content-type: text/plain; charset=iso-8859-1
Content-transfer-encoding: 7BIT
Content-disposition: inline
Operating-System: Linux 2.6.16.16 i686
User-Agent: Mutt/1.5.13 (2006-08-11)

Howdy list!

Due to a question in comp.unix.shell, I recently thought about the
following:

I'm trying to be able to use compsys to find all completions, that are
possible as the first word of the command-line _and_ match a given
pattern. Ideally, these matches should be accessible via a completion
menu.

E.g.:

% *com*<KEY-SEQUENCE>
- external command -
combine                  compose
comm                     composeglyphs
compare                  composite
compile_et               debcommit
- builtin command -
command                  comparguments
compadd                  compcall
- shell function -
compaudit                compdef
- alias -
which-command
- parameter -
commands
- original -
*com*

The solution I found is this:
[snip]
zmodload zsh/complist
autoload -U compinit && compinit
zstyle ':completion:::::' completer _complete _match
zstyle ':completion:*:descriptions' format "- %d -"
zstyle ':completion:*:default' list-prompt '%S%M matches%s'
zstyle ':completion:*' group-name ''
zstyle ':completion:*' menu select
bindkey "^xd" menu-complete
[snap]

That way, I can enter a pattern (like *com*) and hit 'ctrl-x d' to get
into a nice menu with possible completions.

My questions are:
Is this the way one would do it?
Is there a possibility, to get this going with 'expand-or-complete'
instead of 'menu-complete'? That way you could use <TAB> to trigger
the menu. I think this could be done by not expanding filenames, if
completing the first word in the command-line. But I'm not sure, how
to achieve this.

Any comments are welcome.

Regards, Frank

