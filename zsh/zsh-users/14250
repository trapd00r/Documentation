From zsh-users-return-14250-mason-zsh=primenet.com.au@sunsite.dk Fri Jul 24 08:48:51 2009
Return-Path: <zsh-users-return-14250-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26346 invoked from network); 24 Jul 2009 08:48:47 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 24 Jul 2009 08:48:47 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 32882 invoked from network); 24 Jul 2009 08:48:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 24 Jul 2009 08:48:26 -0000
Received: (qmail 14264 invoked by alias); 24 Jul 2009 08:47:47 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14250
Received: (qmail 14245 invoked from network); 24 Jul 2009 08:47:46 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 24 Jul 2009 08:47:46 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 03188801E289
	for <zsh-users@sunsite.dk>; Fri, 24 Jul 2009 10:47:39 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly25d.srv.mailcontrol.com (MailControl) with ESMTP id n6O8lKfu011467
	for <zsh-users@sunsite.dk>; Fri, 24 Jul 2009 09:47:33 +0100
Received: from news01.csr.com ([10.99.50.25]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 24 Jul 2009 09:43:57 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id n6O8hvxq022992
	for <zsh-users@sunsite.dk>; Fri, 24 Jul 2009 09:43:57 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id n6O8hvWB022988
	for <zsh-users@sunsite.dk>; Fri, 24 Jul 2009 09:43:57 +0100
Message-Id: <200907240843.n6O8hvWB022988@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: 'read -q -t X'
In-reply-to: <alpine.DEB.2.00.0907231851500.2551@zest.trausch.us>
References: <alpine.DEB.2.00.0907231851500.2551@zest.trausch.us>
Comments: In-reply-to "Michael B. Trausch" <mbt@zest.trausch.us>
   message dated "Thu, 23 Jul 2009 18:54:58 -0400."
Date: Fri, 24 Jul 2009 09:43:57 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 24 Jul 2009 08:43:57.0743 (UTC) FILETIME=[E24723F0:01CA0C3A]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-09-20-00 (www.mailcontrol.com) on 10.68.0.135
X-Virus-Scanned: ClamAV 0.94.2/9610/Fri Jul 24 04:11:48 2009 on bifrost
X-Virus-Status: Clean

"Michael B. Trausch" wrote:
> 
> I'd like to use read with the -q and -toptions together, like so:
> 
>   read -q -t 10 '?Load Screen? (10 seconds, default Y) [Y/n] '
> 
> And have it read a y or n, but timeout the read if it's not answered in 10 
> seconds.  I am doing this to have my login shells not always kick other ones 
> off, as I use GNU screen for when I login from my phone, but not (usually) 
> otherwise (and not always on the phone, sometimes I move it).
> 
> Is there a way to do this?  It seems that combining -q and -t results in 
> weirdness that ultimately doesn't work.

I think the nearest you can get for now is use read -k -t 10 ...  and
interpret the character yourself on a successful read.  This is a bug:
-q and -k should be similar enough that the shell does essentially that
internally.  Unfortunately, every time anyone has added a "great new
feature" to the read builtin they've simply hacked it in as a completely
separate case without fitting it properly into the existing code, so the
-t code isn't wired up to treat -q as a special case, unlike -k.

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


'member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom'

