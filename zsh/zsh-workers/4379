From zsh-workers-request@math.gatech.edu Thu Sep 03 19:13:59 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11266 invoked from network); 3 Sep 1998 19:13:58 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 3 Sep 1998 19:13:58 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id OAA03377;
	Thu, 3 Sep 1998 14:58:20 -0400 (EDT)
Resent-Date: Thu, 3 Sep 1998 14:58:20 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@frontiernet.net>
Message-Id: <199809031900.OAA53082@frontiernet.net>
Subject: Re: zsh-3.1.4 bug, parsing case ... esac
In-Reply-To: <980903075133.ZM3869@candle.brasslantern.com> from Bart Schaefer at "Sep 3, 98 07:51:33 am"
To: schaefer@brasslantern.com (Bart Schaefer)
Date: Thu, 3 Sep 1998 14:00:20 -0500 (CDT)
Cc: zsh-workers@math.gatech.edu
X-Mailer: ELM [version 2.4ME+ PL35 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"LOHx6.0.iq.CRkxr"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4379
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> } Actually, the shell grammar allows this, this is really a zsh bug.
> 
> Obviously, this is a surprise to me.  Can you point me at "the shell
> grammar" that specifies this?  The informal one in the man pages/info
> sure doesn't.

You can look at the Single Unix Specification -> Commands & Utilities
-> Shell Command Language -> Shell Grammar Rules:

if_clause        : If compound_list Then compound_list else_part Fi
                 | If compound_list Then compound_list           Fi
                 ;

compound_list    :              term
                 | newline_list term
                 |              term separator
                 | newline_list term separator
                 ;

term             : term separator and_or
                 |                and_or
                 ;

and_or           :                         pipeline
                 | and_or AND_IF linebreak pipeline
                 | and_or OR_IF  linebreak pipeline
                 ;


pipeline         :      pipe_sequence
                 | Bang pipe_sequence
                 ;

pipe_sequence    :                             command
                 | pipe_sequence '|' linebreak command
                 ;

command          : simple_command
                 | compound_command
                 | compound_command redirect_list
                 | function_definition
                 ;

compound_command : brace_group
                 | subshell
                 | for_clause
                 | case_clause
                 | if_clause
                 | while_clause
                 | until_clause
                 ;

case_clause      : Case WORD linebreak in linebreak case_list Esac
                 | Case WORD linebreak in linebreak           Esac
                 ;

There is more, but as you see, there is no required separator.
Obviously the manual and info pages are not that accurate.  People are
already complaining aboud the complicated and hard to understand
manual, a formal grammar description would be even more difficult to
read.

Zoli

