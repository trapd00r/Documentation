From zsh-users-return-3512-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Nov 07 18:36:11 2000
Return-Path: <zsh-users-return-3512-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16026 invoked from network); 7 Nov 2000 18:36:10 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Nov 2000 18:36:10 -0000
Received: (qmail 28596 invoked by alias); 7 Nov 2000 18:35:53 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3512
Received: (qmail 28589 invoked from network); 7 Nov 2000 18:35:52 -0000
Date: Tue, 7 Nov 2000 10:35:47 -0800
To: zsh-users@sunsite.auc.dk
Subject: TRAPEXIT doesn't get executed
Message-ID: <20001107103547.A5606@corp.phone.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable
User-Agent: Mutt/1.2.5i
From: Matt Armstrong <matt@corp.phone.com>

I'm trying to find the right idiom to make sure some cleanup code gets
executed no matter how the script exits.

When I run this script:
 =20
---------------------------------------------------------
#!/usr/bin/zsh
 =20
set -x
 =20
function TRAPEXIT {
    print "executed TRAPEXIT"
}
sleep 10
---------------------------------------------------------
 =20
And hit Ctrl-C while "sleep 10" is executing, the TRAPEXIT isn't
executed.  But when I run this script:
 =20
---------------------------------------------------------
#!/usr/bin/zsh
 =20
set -x

function TRAPEXIT {
    print "executed TRAPEXIT"
}
function TRAPINT {
    print "executed TRAPINT"
}
sleep 10
---------------------------------------------------------

And hit Ctrl-C, both TRAPINT and TRAPEXIT get executed.  Is this
explained anywhere?  The behavior is the same under 3.0 and 3.1, so I
imagine this has been covered before.

--=20
matt

