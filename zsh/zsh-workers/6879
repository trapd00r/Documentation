From zsh-workers-return-6879-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Jun 27 15:10:15 1999
Return-Path: <zsh-workers-return-6879-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21712 invoked from network); 27 Jun 1999 15:10:13 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Jun 1999 15:10:13 -0000
Received: (qmail 26393 invoked by alias); 27 Jun 1999 15:10:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6879
Received: (qmail 26380 invoked from network); 27 Jun 1999 15:10:02 -0000
Message-Id: <9906271441.AA27209@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk
Subject: Re: bindkey: autoload failed 
In-Reply-To: "Tanaka Akira"'s message of "27 Jun 1999 15:19:03 DFT."
             <rsqlnd6qi7c.fsf@crane.jaist.ac.jp> 
Date: Sun, 27 Jun 1999 16:41:23 +0200
From: Peter Stephenson <pws@ibmth.df.unipi.it>

Tanaka Akira wrote:
> is27e1u11% cat .zshrc
> a=(bindkey -e)
> $a
> is27e1u11% /app/zsh-3.1.5-pws-24/bin/zsh
> /space/home/akr_csh/.zshrc: bindkey: autoload failed [2]

I can't get this to happen however hard I try, so something different is
happending somewhere.  But maybe the following patch fixes it?

--- Src/exec.c.hfn	Sat Jun 26 17:17:22 1999
+++ Src/exec.c	Sun Jun 27 16:30:21 1999
@@ -1584,8 +1584,10 @@
 		is_builtin = 1;
 #ifdef DYNAMIC
 		/* autoload the builtin if necessary */
-		if (!((Builtin) hn)->handlerfunc)
+		if (!((Builtin) hn)->handlerfunc) {
 		    load_module(((Builtin) hn)->optstr);
+		    hn = builtintab->getnode(builtintab, cmdarg);
+		}
 #endif
 		break;
 	    }

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

