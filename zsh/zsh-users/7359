From zsh-users-return-7359-mason-zsh=primenet.com.au@sunsite.dk Sat Apr 17 22:22:42 2004
Return-Path: <zsh-users-return-7359-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3599 invoked from network); 17 Apr 2004 22:22:41 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 17 Apr 2004 22:22:41 -0000
Received: (qmail 15373 invoked by alias); 17 Apr 2004 22:22:25 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7359
Received: (qmail 15362 invoked from network); 17 Apr 2004 22:22:24 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 17 Apr 2004 22:22:24 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 17 Apr 2004 22:22:24 -0000
Received: (qmail 16079 invoked from network); 17 Apr 2004 22:22:24 -0000
Received: from lakermmtao11.cox.net (68.230.240.28)
  by a.mx.sunsite.dk with SMTP; 17 Apr 2004 22:22:22 -0000
Received: from quark.hightek.org ([68.12.75.33]) by lakermmtao11.cox.net
          (InterMail vM.6.01.03.02 201-2131-111-104-20040324) with ESMTP
          id <20040417222151.HRKY29407.lakermmtao11.cox.net@quark.hightek.org>
          for <zsh-users@sunsite.dk>; Sat, 17 Apr 2004 18:21:51 -0400
Received: by quark.hightek.org (Postfix, from userid 501)
	id 5326012408; Sat, 17 Apr 2004 17:22:22 -0500 (CDT)
Date: Sat, 17 Apr 2004 17:22:22 -0500
From: Vincent Stemen <zsh@hightek.org>
To: zsh-users@sunsite.dk
Subject: FreeBSD compatability feature request
Message-ID: <20040417222222.GA27230@quark.hightek.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.4.1i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=RCVD_IN_SORBS autolearn=no 
	version=2.63
X-Spam-Hits: 1.5

Zsh's sh compatibility works great for the most part.  However, there
is one unimplemented feature that I know of that prevents us from
being able to use it as a plug in replacement for /bin/sh on FreeBSD.
The "set -T" option.  This is used in a few places in the FreeBSD-5.x
init scripts.

Here is the FreeBSD manual entry:

  -T trapsasync
        When waiting for a child, execute traps immediately.  If this
        option is not set, traps are executed after the child exits,
        as specified in IEEE Std 1003.2 (``POSIX.2'') This nonstandard
        option is useful for putting guarding shells around children
        that block signals.  The surrounding shell may kill the child
        or it may just return control to the tty and leave the child
        alone, like this:

           sh -T -c "trap 'exit 1' 2 ; some-blocking-program"

I know that normally -T turns on the cdablevars option but are you
willing to consider adding this feature for FreeBSD compatibility when
in sh compatibility mode?  Otherwise, is there any other option in zsh
that implements this same feature?

Regards,
Vincent

-- 
Vincent Stemen
Avoid the VeriSign/Network Solutions domain registration trap!
http://www.InetAddresses.net

