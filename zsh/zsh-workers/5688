From zsh-workers-return-5688-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Mar 08 18:38:34 1999
Return-Path: <zsh-workers-return-5688-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6673 invoked from network); 8 Mar 1999 18:38:33 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Mar 1999 18:38:33 -0000
Received: (qmail 15562 invoked by alias); 8 Mar 1999 18:37:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5688
Received: (qmail 15555 invoked from network); 8 Mar 1999 18:37:53 -0000
X-Authentication-Warning: c-bart.amazon.com: schaefer set sender to schaefer@tiny.zanshin.com using -f
From: Bart Schaefer <schaefer@tiny.zanshin.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14052.6278.382505.243437@localhost.localdomain>
Date: Mon, 8 Mar 1999 10:35:50 -0800 (PST)
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: zsh-3.1.5-pws-11 plus: _long_options and compstate[matcher]
X-Mailer: VM 6.65a under Emacs 20.3.5.1
Reply-To: Bart Schaefer <schaefer@brasslantern.com>

This is the same bug that I had to patch in _match_test before.  Please
remember that compstate[matcher] may be ZERO!  I think this is the right
fix.

--- _long_options.bak	Mon Mar  8 10:28:51 1999
+++ _long_options	Mon Mar  8 10:30:54 1999
@@ -180,7 +180,7 @@
 
 # We get the string from the line and and see if it already contains a 
 # equal sign.
-[[ compstate[matcher] -ne 1 ]] && return
+(( compstate[matcher] > 1 )) && return
 
 str="$PREFIX$SUFFIX"
 

