From A.Main@dcs.warwick.ac.uk Fri May 24 01:11:25 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id BAA06227 for <mason@werple.mira.net.au>; Fri, 24 May 1996 01:11:23 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id KAA09505; Thu, 23 May 1996 10:51:44 -0400 (EDT)
Resent-Date: Thu, 23 May 1996 10:51:44 -0400 (EDT)
From: Zefram <A.Main@dcs.warwick.ac.uk>
Message-Id: <19728.199605231451@stone.dcs.warwick.ac.uk>
Subject: quotename() fix
To: zsh-workers@math.gatech.edu (Z Shell workers mailing list)
Date: Thu, 23 May 1996 15:51:22 +0100 (BST)
X-Patch: 97
X-Loop: zefram@dcs.warwick.ac.uk
X-Stardate: [-31]7548.09
X-US-Congress: Moronic fuckers
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"1Uztn1.0.RK2._j7fn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1143
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1749
Status: O

-----BEGIN PGP SIGNED MESSAGE-----

Zoltan's patch in article 1098, reversing a hunk of my completion patch,
broke this:

% compctl -s foo^@bar baz
% baz _<TAB>
% baz foo| bar _

I had actually fixed this in the hunk that Zoltan reversed, but in
the wrong way, so that I broke completion on words containing tokens.
Here is the correct fix:

 Index: Src/zle_tricky.c
 *** zle_tricky.c	1996/05/23 11:40:56	1.17
 --- zle_tricky.c	1996/05/23 12:27:12
 ***************
 *** 1283,1289 ****
    * pointer it points to may point to aposition in s and in e the position *
    * of the corresponding character in the quoted string is returned.  Like *
    * e, te may point to a position in the string and pl is used to return   *
 !  * the position of the character pointed to by te in the quoted string.   */
   
   /**/
   char *
 --- 1283,1290 ----
    * pointer it points to may point to aposition in s and in e the position *
    * of the corresponding character in the quoted string is returned.  Like *
    * e, te may point to a position in the string and pl is used to return   *
 !  * the position of the character pointed to by te in the quoted string.   *
 !  * The string is metafied and may contain tokens.                         */
   
   /**/
   char *
 ***************
 *** 1319,1324 ****
 --- 1320,1327 ----
   		continue;
   	    } else
   		*v++ = '\\';
 + 	if(*u == Meta)
 + 	    *v++ = *u++;
   	*v++ = *u;
       }
       *v = '\0';

 -zefram

-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBMaRaUHD/+HJTpU/hAQEicgP/SAztxmhGUQ8oSmdEiZ9VNXjUOslSSoAH
m35fd+5xX4MiMfR2NydXyQVz3eKEy9aF7k32aHiVT78GU39P2Lkvoq/8kakUwV6v
Dv+2iilrDn2GGYA66/z9rUIf49g/gQTAm/j7D9tYK/0lmvh4K7LXTWWH9xH7lpgB
qGUX13anynM=
=dhUG
-----END PGP SIGNATURE-----


