From zsh-workers-return-11385-mason-zsh=primenet.com.au@sunsite.auc.dk Mon May 15 17:51:25 2000
Return-Path: <zsh-workers-return-11385-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19895 invoked from network); 15 May 2000 17:51:24 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 May 2000 17:51:24 -0000
Received: (qmail 5504 invoked by alias); 15 May 2000 17:51:17 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11385
Received: (qmail 5497 invoked from network); 15 May 2000 17:51:16 -0000
Date: Mon, 15 May 2000 13:51:09 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: octal in arithmetic expressions
Message-ID: <20000515135109.A31551@scowler.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0.1i

http://www.pasc.org/interps/unofficial/db/p1003.2/pasc-1003.2-173.html

This should make zsh conform to POSIX in this regard.

Index: Src/math.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/math.c,v
retrieving revision 1.2
diff -u -r1.2 math.c
--- Src/math.c	2000/04/30 17:58:35	1.2
+++ Src/math.c	2000/05/15 17:44:51
@@ -357,6 +357,10 @@
 		yyval.u.l = zstrtol(++ptr, &ptr, lastbase = 16);
 		return NUM;
 	    }
+	    else if (idigit(*ptr) && (memchr(ptr, '.', strlen(ptr)) == NULL)) {
+	        yyval.u.l = zstrtol(ptr, &ptr, lastbase = 8);
+	        return NUM;
+	    }
 	/* Fall through! */
 	default:
 	    if (idigit(*--ptr) || *ptr == '.') {

