From zsh-workers-return-10136-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Mar 14 15:27:48 2000
Return-Path: <zsh-workers-return-10136-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7286 invoked from network); 14 Mar 2000 15:27:46 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 14 Mar 2000 15:27:46 -0000
Received: (qmail 27876 invoked by alias); 14 Mar 2000 15:27:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10136
Received: (qmail 27867 invoked from network); 14 Mar 2000 15:27:37 -0000
Date: Tue, 14 Mar 2000 16:27:36 +0100 (MET)
Message-Id: <200003141527.QAA08824@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Sven Wischnowsky's message of Mon, 13 Mar 2000 13:23:48 +0100
	(MET)
Subject: Re: command completion taking ages


I wrote:

> Oliver Kiddle wrote:
> 
> > If I press tab in a position where all commands are completed, I get a
> > very long delay. This is quite annoying even though I can interrupt it
> > with Ctrl-C. Is there a way using the zstyle, tags and _wanted stuff
> > that I could indicate with zstyle that I don't want to complete commands
> > if $#PREFIX = 0. I couldn't see any styles which are passed through eval
> > in any of _requested, _wanted, _tags etc but other than using the
> > high-level stuff for tag ordering, I don't fully understand the tag
> > selection stuff so I may well have missed something.
> 
> No, we don't have something like that. I don't remember exactly when
> it was, but I have been thinking about something like that too...
> 
> ...
> 
> Back to your question: currently you can only 1) use tag-order to make 
> it generate as few matches as possible, or 2) (probably better) copy
> and modify _command_names to test [[ -z $PREFIX] (or (( $#PREFIX )) if 
> you prefer).

Ahem, I'm thinking too much about styles already. Of course there is a 
way:

  zstyle ':completion:*:*:-command-:*' tag-order 'maybe()' -

  maybe() { [[ -n $PREFIX ]] && comptry "$@" }

or somthing like this:

  maybe() {
    if [[ -n "$PREFIX$SUFFIX" || $1 = messages ]]; then
      comptry "$@"
    else
      _message 'not with an empty word...'
    fi
  }

Good enough?

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

