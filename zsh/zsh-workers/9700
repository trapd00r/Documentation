From zsh-workers-return-9700-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Feb 13 18:40:25 2000
Return-Path: <zsh-workers-return-9700-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24679 invoked from network); 13 Feb 2000 18:40:24 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Feb 2000 18:40:24 -0000
Received: (qmail 18260 invoked by alias); 13 Feb 2000 18:40:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9700
Received: (qmail 18253 invoked from network); 13 Feb 2000 18:40:19 -0000
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Things which used to work
Date: Sun, 13 Feb 2000 18:43:51 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E12K3wN-0005pO-00.2000-02-13-18-40-15@mail3.svr.pol.co.uk>

Something's gone screwy with my file completion.  Consider completing after
`gv '.


First, I get the options even with no `-'.  The following used to work so
that I didn't in this case:

    zstyle ':completion:*' prefix-needed no
    zstyle ':completion:*:(options|signals)*' prefix-needed yes

(Actually, I didn't have the `*' at the end of the second pattern before,
but I added it to see if it helped, but it didn't.  It shouldn't be
necessary since `options' is a tag.)  Switching prefix-needed to yes
globally does work, however.


Second, if I type a directory name, I *only* get postscript files completed,
and not directory names even if there are no postscript files.  It works if
I type the first letter of a directory, but if that wasn't how it worked
before.  Furthermore, the listing looks like this:

% gv ./             
Completing postscript file
Completing PDF file
/ 

Apart from the missing directories, I don't know where that final `/' came
from.  (The rest is OK.)  I don't have any sort-tags style defined.


Third, if I use the zmodload completion I get all the files in the relevant
directories, not just those ending in .so, even though the glob pattern is
explicit, and there are .so files present.  `zmodload zsh/...' seems to
have given up completely.


It's quite possible this all relates to the change in style contexts, but
if so I haven't a clue how.  In case it does, here's my complete list of
styles.

    autoload -U compinit
    compinit
    zstyle ':completion:*' matcher 'm:{a-zA-Z}={A-Za-z}' 'r:|[.,_-]=* r:|=*'

    # This effectively replaces ZLS_COLORS
    zstyle -d ':completion:*::::'
    zstyle -d ':completion:*::::default'
    zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}

    zstyle ':completion:*' completer _matcher _oldlist _complete _approximate
    # This one is a bit ugly. You may want to use only `*:correct'
    # if you also have the `correctword_*' or `approximate_*' keys.
    zstyle ':completion:*:(correct|approximate):*' max-errors 2 numeric
    zstyle ':completion:*:(correct|approximate):*' prompt \
      'Correcting (%e errors):'
    zstyle ':completion:*:oldlist:*' list 'never'
    zstyle ':completion:*:descriptions' format 'Completing %d'
    zstyle ':completion:*' prefix-needed no
    zstyle ':completion:*:(options|signals)*' prefix-needed yes
    zstyle ':completion:*:options' description 'true'
    zstyle ':completion:*' menu "select=6"
    zstyle ':completion:*:oldlist*' menu true
    zstyle ':completion:*' group-name ''
    zstyle ':completion:*:urls' path ~/.urls
    zstyle '*' hosts $hosts


-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

