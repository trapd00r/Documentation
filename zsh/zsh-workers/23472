From zsh-workers-return-23472-mason-zsh=primenet.com.au@sunsite.dk Sun May 27 02:50:39 2007
Return-Path: <zsh-workers-return-23472-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24660 invoked from network); 27 May 2007 02:50:37 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.0 (2007-05-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=no
	version=3.2.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 27 May 2007 02:50:37 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 46175 invoked from network); 27 May 2007 02:50:31 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 May 2007 02:50:31 -0000
Received: (qmail 28454 invoked by alias); 27 May 2007 02:50:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23472
Received: (qmail 28444 invoked from network); 27 May 2007 02:50:28 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 27 May 2007 02:50:28 -0000
Received: (qmail 45931 invoked from network); 27 May 2007 02:50:28 -0000
Received: from acolyte.scowler.net (216.254.112.45)
  by a.mx.sunsite.dk with SMTP; 27 May 2007 02:50:25 -0000
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id C29645C284; Sat, 26 May 2007 22:50:23 -0400 (EDT)
Date: Sat, 26 May 2007 22:50:23 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Cc: =?iso-8859-1?Q?J=F6rg?= Sommer <joerg@alea.gnuu.de>,
	426161-forwarded@bugs.debian.org
Subject: Re: Bug#426161: zsh: crashes in reverse_menu
Message-ID: <20070527025023.GA19806@scowler.net>
Mail-Followup-To: zsh-workers@sunsite.dk,
	=?iso-8859-1?Q?J=F6rg?= Sommer <joerg@alea.gnuu.de>,
	426161-forwarded@bugs.debian.org
References: <20070526205426.GA19686@alea.gnuu.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <20070526205426.GA19686@alea.gnuu.de>
User-Agent: Mutt/1.5.13 (2006-08-11)

On Sat, May 26, 2007 at 10:54:26PM +0200, Jörg Sommer wrote:
> Hi,
> 
> after typing “vared CF” I've called “reverse-menu-complete” with M-x and
> zsh crashes. This also happens in zsh-beta 4.3.4-dev-0+20070516-1 and is
> not #416970.
> 
> % gdb zsh
> <0,2416>(iBook):~% vared CF 
> Program received signal SIGSEGV, Segmentation fault.
> 0x0fbc87d8 in reverse_menu (dummy=0xfc3be40, dummy2=0x0)
>     at ../../../Src/Zle/compresult.c:1231
> 1231    ../../../Src/Zle/compresult.c: No such file or directory.
>         in ../../../Src/Zle/compresult.c
> (gdb) bt
> #0  0x0fbc87d8 in reverse_menu (dummy=0xfc3be40, dummy2=0x0)
>     at ../../../Src/Zle/compresult.c:1231
> #1  0x1004a4c8 in runhookdef ()
> #2  0x0fc19e2c in reversemenucomplete (args=<value optimized out>)
>     at ../../../Src/Zle/zle_tricky.c:357
> #3  0x0fc13738 in completecall (args=<value optimized out>)
>     at ../../../Src/Zle/zle_tricky.c:208
> #4  0x0fc04eec in execzlefunc (func=0xfc39804, args=0xfc3be40, 
>     set_bindk=269896152) at ../../../Src/Zle/zle_main.c:1254
> #5  0x0fc0510c in zlecore () at ../../../Src/Zle/zle_main.c:1019
> #6  0x0fc057e4 in zleread (lp=<value optimized out>, rp=<value optimized out>, 
>     flags=<value optimized out>, context=<value optimized out>)
>     at ../../../Src/Zle/zle_main.c:1174
> #7  0x100394b4 in ingetc ()
> #8  0x10034264 in ?? ()
> #9  0x10041b7c in gettok ()
> #10 0x100425e4 in yylex ()
> #11 0x10060c08 in parse_event ()
> #12 0x10037a94 in loop ()
> #13 0x1003883c in zsh_main ()
> #14 0x1000b8b0 in main ()

This is because reverse_menu() is trying to dereference minfo.group
which is NULL.

