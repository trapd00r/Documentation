From zsh-workers-return-11923-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 15 09:29:34 2000
Return-Path: <zsh-workers-return-11923-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18892 invoked from network); 15 Jun 2000 09:29:32 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Jun 2000 09:29:32 -0000
Received: (qmail 23117 invoked by alias); 15 Jun 2000 09:29:25 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11923
Received: (qmail 23110 invoked from network); 15 Jun 2000 09:29:24 -0000
Date: Thu, 15 Jun 2000 11:29:22 +0200 (MET DST)
Message-Id: <200006150929.LAA06651@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Felix Rosencrantz's message of Wed, 14 Jun 2000 21:41:10 -0700
	(PDT)
Subject: Re: Unitialized memory reads again.


Felix Rosencrantz wrote:

> Sorry to report that I started seeing new uninitialized memory reads
> during completion.  Now at different location.
>         match_str      [compmatch.c:806]
>         match_str      [compmatch.c:598]
>         match_str      [compmatch.c:598]
>         addmatches     [compcore.c:1801]
>         bin_compadd    [complete.c:606]
>         ---------------------------------
>         match_str      [compmatch.c:806]
>         match_str      [compmatch.c:598]
>         addmatches     [compcore.c:1801]
>         bin_compadd    [complete.c:606]
> 
> Though these seem to be more difficult to trip over.

Before using the patch below, could you try if `setopt __listbeep__<TAB>'
shows the bad behaviour (probably adding more `_'s to the end)? If it
does, the patch below should fix it (of course, with uninitialized
memory reads it could be that this is the problem but it doesn't show
up, sigh).

> The recent changes to the trap code have fixed the memory leaks
> reported in 11766, and no new errors.

Good. I was about to ask.

> Sven, thanks for the stat optimizations to _path_files.  It seems faster.
> Plus, file completion works nicely with Clearcase now.  (Though... the
> additional change you were suggesting in workers/9631 for a "style that
> gives a pattern to match pathname components that should be accepted
> immediately" would make it work even better... :) )

I had forgotten about that... we'll see.

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

