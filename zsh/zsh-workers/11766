From zsh-workers-return-11766-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jun 06 05:32:27 2000
Return-Path: <zsh-workers-return-11766-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25654 invoked from network); 6 Jun 2000 05:32:26 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Jun 2000 05:32:26 -0000
Received: (qmail 16485 invoked by alias); 6 Jun 2000 05:31:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11766
Received: (qmail 16472 invoked from network); 6 Jun 2000 05:31:45 -0000
Message-ID: <20000606053142.20146.qmail@web1303.mail.yahoo.com>
Date: Mon, 5 Jun 2000 22:31:42 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: Re: PATCH: Small memory leak and doc fix
To: zsh-workers <zsh-workers@sunsite.auc.dk>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

That last set of patches cleaned up most of the memory leaks found in the
tests, plus all the ones I see from just using the shell.   Thanks, Sven.

Glad they made it into 3.1.9.  Thanks, Peter.

There is only one set of leaks that the tests still find.
These are found by the 08traps.ztst.  (Sorry, I missed sending these before.)

        zcalloc        [mem.c:469]
        dupeprog       [parse.c:2003]
        dosavetrap     [signals.c:675]
        removetrap     [signals.c:756]
        unsettrap      [signals.c:733]
        ------------------------------
        zalloc         [mem.c:453]
        dupeprog       [parse.c:1998]
        dosavetrap     [signals.c:675]
        removetrap     [signals.c:756]
        unsettrap      [signals.c:733]




>> There seems to be some situations when the following code will see
>> uninitialized memory reads from the following stack:
>>       pattern_match  [compmatch.c:1035]
>>         match_str      [compmatch.c:577]
>>         comp_match     [compmatch.c:941]
>>         addmatches     [compcore.c:1954]
>>         bin_compadd    [complete.c:595]
>> I haven't looked into this, so if more details are needed let me know.
>
>Haven't had the time to look at this, but knowing the match specs used
>would help.

I think this comes up while running _path_files.  The match specs used:
	m:{a-zA-Z}={A-Za-z}  r:|[.,_-]=** r:[^0-9]||[0-9]=**


-FR.

__________________________________________________
Do You Yahoo!?
Yahoo! Photos -- now, 100 FREE prints!
http://photos.yahoo.com

