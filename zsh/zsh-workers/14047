From zsh-workers-return-14047-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 19 19:49:15 2001
Return-Path: <zsh-workers-return-14047-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24189 invoked from network); 19 Apr 2001 19:49:14 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Apr 2001 19:49:14 -0000
Received: (qmail 29802 invoked by alias); 19 Apr 2001 19:47:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14047
Received: (qmail 29774 invoked from network); 19 Apr 2001 19:47:53 -0000
Date: Thu, 19 Apr 2001 15:47:47 -0400
From: Clint Adams <schizo@debian.org>
To: Oliver Kiddle <opk@u.genie.co.uk>
Cc: zsh-workers@sunsite.dk
Subject: Re: PATCH: honor STRIPFLAGS for modules
Message-ID: <20010419154747.A9412@dman.com>
References: <20010418213942.A15845@dman.com> <3ADEC96C.5D8DC609@u.genie.co.uk> <20010419084000.A18361@dman.com> <3ADF1D4C.EAE735E3@u.genie.co.uk> <20010419134611.A370@dman.com> <3ADF3C5B.A508F9E2@u.genie.co.uk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <3ADF3C5B.A508F9E2@u.genie.co.uk>; from opk@u.genie.co.uk on Thu, Apr 19, 2001 at 08:28:27PM +0100

> I'm not sure that I understand the difference. I only just realised that
> on Linux termcap and curses are symlinked - yuk. So I guess the initial

That's not always true.  Some systems have a libtermcap which is merely
libtermcap, not some sort of (n)curses termcap emulation.

> patch was removing the duplicates by doing symbol searches to detect if
> termcap/curses are one and the same which is fair enough provided there
> is some tangible benefit of not linking both. If you say it makes a

No, the original point of this was to link the termcap module with
whatever has tgetent() and the terminfo module with whatever has tigetstr().
On Debian, for instance, they're both covered by ncurses, but elsewhere
there can be conflicts.

> difference on Linux then fine. I'm just not clear on why it was an
> improvement other than possibly making the compile system cleaner. If
> I'm asking stupid questions, ignore me: normally I'd have assumed you
> know what you're doing and kept quiet if I didn't fully understand but
> in this case I'm afraid I didn't.

No, I clearly don't know what I'm doing or I would have gotten it right
the first time.

> So, this latest patch seems to be separating LIBS, and MAINLIBS for DSOs
> and the main zsh binary - right? It sounds to me from the discussion
> though that we almost need a separate $LIBS for every single module
> though which is a bit worrying. Is the initial thing which has sparked
> this off that the termcap/terminfo modules are the first modules which
> are using libraries which the main zsh never previously loaded? Could
> LIBS maybe remain just the common libraries and we then add the extra
> libraries for the termcap module only?

Originally, you would only get the terminfo module if whatever
library selected for termcap also did terminfo.  This was, IIRC,
because people didn't want terminfo libraries linked against
the main binary just for the sake of a module that they would
not use.  Obviously that's gotten more complicated now.

> Also, a while back when you implemented ${(k)terminfo} you asked if you
> should also do this for termcap. Sorry if this is already done but if
> not, I'd just like to add my vote in favour, even if you need to
> constant table of termcap codes - it'd be useful.

I had started this and then lost my changes due to a system crash,
but I'll restart it soon.

