From leitner@gluon.inf.fu-berlin.de Thu Jun 13 10:41:07 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id KAA04631 for <mason@werple.mira.net.au>; Thu, 13 Jun 1996 10:41:01 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id UAA13632; Wed, 12 Jun 1996 20:26:23 -0400 (EDT)
Resent-Date: Wed, 12 Jun 1996 20:25:59 -0400 (EDT)
Message-Id: <m0uU0E6-0009tkC@inf.fu-berlin.de>
Date: Thu, 13 Jun 1996 02:25:30 +0200
From: leitner@gluon.inf.fu-berlin.de (Felix von Leitner)
To: jkroeger@squirrel.owl.de
Cc: zsh-users@math.gatech.edu
Subject: Re: zsh-2.6beta20 doesn't compile under Linux pre2.0.14
In-Reply-To: <19960607203126.2843.qmail@squirrel.owl.de>; from jkroeger@squirrel.owl.de on Jul 7, 1996 20:31:26 -0000
References: <19960607203126.2843.qmail@squirrel.owl.de>
X-Mailer: Mutt 0.31
Mime-Version: 1.0
X-Dogma: Barney must die, all else is irrelevant
Resent-Message-ID: <"NQIbG.0.cK3.M0sln"@euclid>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/253
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 968
Status: O

Thus spake jkroeger@squirrel.owl.de (jkroeger@squirrel.owl.de):

> Recent Linux kernels introduced a new limit for the address space of a process:

> #define RLIMIT_AS       9               /* address space limit */

> This makes compiling zsh fail with the following error message:

> builtin.c:3539: #error there are some unknown limits.  Fix me!
> make[1]: *** [builtin.o] Error 1
> make[1]: Leaving directory `/usr/src/bin/zsh-2.6-beta20/Src'
> make: *** [Src] Error 2

Apply this diff, it works for me.

Felix

--- Src/builtin.c	Thu Jun 13 02:23:09 1996
+++ Src/builtin.c.new	Thu Jun 13 02:22:49 1996
@@ -3535,6 +3535,11 @@
 #  define NEXT_RLIM (RLIMIT_MEMLOCK + 1)
     "memorylocked",
 # endif /* RLIMIT_MEMLOCK */
+# if defined RLIMIT_AS && RLIMIT_AS == NEXT_RLIM
+#  undef NEXT_RLIM
+#  define NEXT_RLIM (RLIMIT_AS + 1)
+    "addressspace",
+# endif /* RLIMIT_AS */
 # if NEXT_RLIM != RLIM_NLIMITS
    #error there are some unknown limits.  Fix me!
 # endif


