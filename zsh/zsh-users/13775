From zsh-users-return-13775-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 29 08:53:43 2009
Return-Path: <zsh-users-return-13775-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13769 invoked from network); 29 Jan 2009 08:53:39 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 Jan 2009 08:53:39 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 10406 invoked from network); 29 Jan 2009 08:53:24 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 Jan 2009 08:53:24 -0000
Received: (qmail 4263 invoked by alias); 29 Jan 2009 08:53:02 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13775
Received: (qmail 4251 invoked from network); 29 Jan 2009 08:53:01 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 29 Jan 2009 08:53:01 -0000
Received: from vms173001pub.verizon.net (vms173001pub.verizon.net [206.46.173.1])
	by bifrost.dotsrc.org (Postfix) with ESMTP id D173E80271F0
	for <zsh-users@sunsite.dk>; Thu, 29 Jan 2009 09:52:57 +0100 (CET)
Received: from torch.brasslantern.com ([96.238.220.215])
 by vms173001.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0KE800BIT602TFL2@vms173001.mailsrvcs.net> for
 zsh-users@sunsite.dk; Thu, 29 Jan 2009 02:52:56 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id n0T8qnXk010207	for
 <zsh-users@sunsite.dk>; Thu, 29 Jan 2009 00:52:50 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id n0T8qmuM010206	for zsh-users@sunsite.dk; Thu,
 29 Jan 2009 00:52:48 -0800
Date: Thu, 29 Jan 2009 00:52:48 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: help with matcher-list style
In-reply-to: <18817.6080.228775.132881@gargle.gargle.HOWL>
To: Zsh list <zsh-users@sunsite.dk>
Message-id: <090129005248.ZM10205@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <18817.6080.228775.132881@gargle.gargle.HOWL>
Comments: In reply to Greg Klanderman <gak@klanderman.net>
 "help with matcher-list style" (Jan 28,  9:43pm)
X-Virus-Scanned: ClamAV 0.92.1/8917/Thu Jan 29 06:38:54 2009 on bifrost
X-Virus-Status: Clean

On Jan 28,  9:43pm, Greg Klanderman wrote:
}
} I'm currently using this matcher-list setting:
} 
} zstyle ':completion:*' matcher-list '' 'm:{a-zA-Z}={A-Za-z}' '+ l:|=* r:|=*'

Interesting.  When I attempt to use that with the latest CVS (1.4529)
I get errors:

39: ../../../zsh-4.0/Src/Zle/compmatch.c:1181: bad matcher pattern type
39: ../../../zsh-4.0/Src/Zle/compmatch.c:1181: bad matcher pattern type
(repeats a dozen times or so)

I do NOT get that error with 4.2.0 (the only older zsh I have handy
at the moment).  It's got something to do with m:{a-zA-Z}={A-Za-z}
appearing all by itself in that second element; if it appears along
with an r: pattern (for example), there is no error, and if I leave
it out, there is no error.

} Is there any way to have the substring completion not match an
} underscore at the beginning of the trial completion?

I meant to reply to your earlier message on this topic ...

} I think I essentially want 'l:|=[^_]*' but ordinary shell patterns
} do not seem to be supported.

Right, they aren't.  "*" has a special meaning and is a pattern all
unto itself, it can't be combined with other patterns.

The real difficulty is that there's no pattern that means "in this
position the text on the line must both match this pattern and also
exactly equal the text in the trial match."  The matcher list only
describes what happens in the parts of the comparison where the
text in the trial is allowed to differ.

However, I suspect matcher-list is not alone in being the culprit
here.  What is your "completer" style?

I'm also puzzled by your assertion in the earlier mail that the
ignored-patterns style doesn't work for you.  Here's what I see (with
my own slightly different matcher-list style).  Here I type "sion"
and then hit TAB.

schaefer<501> sion
Completing external command
gnome-session             gpilotd-session-wrapper   mysql_setpermission 
gnome-session-properties  gtweakui-session          svnversion 
gnome-session-remove      irpsion5
gnome-session-save        mysql_fix_extensions
Completing shell function
_apt-show-versions  _subversion         _x_extension        _xt_session_id

Erase that, install an ignored-patterns style, and try again:

schaefer<501> zstyle ':completion:*:-command-:*' ignored-patterns '_*'
schaefer<502> sion
Completing external command
gnome-session             gpilotd-session-wrapper   mysql_setpermission
gnome-session-properties  gtweakui-session          svnversion
gnome-session-remove      irpsion5
gnome-session-save        mysql_fix_extensions

