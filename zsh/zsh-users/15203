From zsh-users-return-15203-mason-zsh=primenet.com.au@zsh.org Wed Jul 28 13:43:28 2010
Return-Path: <zsh-users-return-15203-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29089 invoked by alias); 28 Jul 2010 13:43:28 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15203
Received: (qmail 4423 invoked from network); 28 Jul 2010 13:43:26 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.0 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,FREEMAIL_FROM,HTML_MESSAGE autolearn=ham
	version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 74.125.82.171 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:received:in-reply-to
         :references:date:message-id:subject:from:to:cc:content-type;
        bh=6k1bjRGaUj2P4zusgrh1zFTYkro4gwG/fiN3SNtog3o=;
        b=t7QqV3elwJFIDBoAH1ASVm7VxnU1oyOtY7ti3h97DHAvyyLP8BnQ4TK3Eu0iT9dT5z
         O2flINlq4CqIbRMyiyL8ARbrTwzsh/5WVV8H0qO22hPdMquf7O1miKjG1TzToMqE5qY5
         MwyRrSfrp73XTHE79GJzbX2gCPA0FeG1px9xA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        b=oCKjmuIfXnhVsLXqgNDm8XOAw+yIsymFzU6Pwin0LM3emkOjwaqPz7QTZmSc/Yt4ee
         SITYtxcvbwn9YWgTUfyqFJnZt6Ufev7mDo+GSAIVcYqnU+R62cSKt35maYEuWqK2WkXX
         XglQiu6rkobI6gCuZEMtyEqHawmxqXM+l+Jhg=
MIME-Version: 1.0
In-Reply-To: <20100728142944.7a7c2a94@csr.com>
References: <AANLkTik1GPGh+erS9eHdjZBnZnsrFX7BiJVxWpo3G_Ud@mail.gmail.com>
	<20100728142944.7a7c2a94@csr.com>
Date: Wed, 28 Jul 2010 15:43:20 +0200
Message-ID: <AANLkTinJ-FCXpxALUWHRUVOMP+7bo_boHE3JM87FJQr5@mail.gmail.com>
Subject: Re: zfinit problem in ksh emulation mode
From: Jerry Rocteur <jerry.rocteur@gmail.com>
To: Peter Stephenson <Peter.Stephenson@csr.com>
Cc: zsh-users@zsh.org
Content-Type: multipart/alternative; boundary=0016e6d7e35201f589048c72cd9d

--0016e6d7e35201f589048c72cd9d
Content-Type: text/plain; charset=ISO-8859-1

On Wed, Jul 28, 2010 at 15:29, Peter Stephenson <Peter.Stephenson@csr.com>wrote:

> On Wed, 28 Jul 2010 13:36:42 +0200
> Jerry Rocteur <jerry.rocteur@gmail.com> wrote:
> > I have a problem running zfinit in ksh emulation ( running zsh as a
> > link from /usr/bin/ksh )
> >
> > When I try:
> >
> > user@zambezi: autoload -U zfinit
> > user@zambezi: zfinit
> > zsh: zfinit: function not defined by file
>
> "autoload -Uz zfinit" is a better bet, to force zsh-style autoload.
>
> Unfortunately we're not very consistent about using those flags in the
> distributed functions, so while it'll probably run it might not do the
> trick with the other zftp functions since zfinit currently runs just
> "autoload -U ..." with the effects you've just seen.  I'll apply a very
> boring patch that fixes up every autoload under Functions in the
> distribution, unless anybody knows of an exception (which would surprise
> me).
>
> Until then, you might want to modify zfinit by hand to replace all the
> "autoload -U"s with "autoload -Uz".  After that you might be OK, since I
> was more successful with putting "emulate -L zsh" at the top of functions.
>

Thanks Peter, I can't change all the installation, I did try the -Uz zfinit
but then it failed with zfparams: function not defined.

I may be out of luck until they install an updated copy here!

> Is there some option I can set in my script so that when my script
> > runs as:
> >
> > #!/usr/bin/ksh
> >
> > That this will work ...
>
> The obvious one to try is "unsetopt kshautoload".
>
> I tried it but then when running zfinit I get:

zfinit:42: command not found: compctl
zfinit:50: command not found: compctl
zfinit:51: command not found: compctl
zfinit:52: command not found: compctl
zfinit:53: command not found: compctl
zfinit:58: command not found: compctl
zfinit:67: command not found: compctl

I can still write the scripts to run on my system but will have to wait for
a new version of zsh here before I can write production scripts

Thanks for the answer!

Cheers,

Jerry

--0016e6d7e35201f589048c72cd9d--

