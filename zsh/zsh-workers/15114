From zsh-workers-return-15114-mason-zsh=primenet.com.au@sunsite.dk Wed Jun 27 09:24:58 2001
Return-Path: <zsh-workers-return-15114-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29271 invoked from network); 27 Jun 2001 09:24:57 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Jun 2001 09:24:57 -0000
Received: (qmail 16155 invoked by alias); 27 Jun 2001 09:24:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15114
Received: (qmail 16135 invoked from network); 27 Jun 2001 09:24:01 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "ZSH Workers Mailing List" <zsh-workers@sunsite.dk>
Subject: AIX again
Date: Wed, 27 Jun 2001 13:24:39 +0400
Message-ID: <001301c0feea$fd804c20$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2479.0006
Importance: Normal

This is really weird. configure fails to find boolcodes when they are
available. Everything looks proper:

config.log

configure:3367: checking if boolcodes is available
configure:3379: cc -qlanglvl=ansi -o conftest  -O  -bnoquiet
conftest.c -lcurses
 -lm  -lc 1>&5
(ld): halt 4
(ld): savename conftest
(ld): filelist 5 1
(ld): i /lib/crt0.o
(ld): i conftest.o
(ld): lib /usr/lib/libcurses.a
(ld): lib /usr/lib/libm.a
(ld): lib /usr/lib/libc.a
LIBRARY: Shared object libcurses.a[shr42.o]: 499 symbols imported.
LIBRARY: Shared object libc.a[shr.o]: 2238 symbols imported.
LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
LIBRARY: Shared object libc.a[aio.o]: 11 symbols imported.
LIBRARY: Shared object libc.a[pse.o]: 78 symbols imported.
LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
FILELIST: Number of previously inserted files processed: 5
(ld): resolve
RESOLVE: 32 of 3513 symbols were kept.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 3 symbols.
(ld): er full
ld: 0711-318 ERROR: Undefined symbols were found.
        The following symbols are in error:
 Symbol                    Inpndx  TY CL Source-File(Object-File) OR
Import-File
{Shared-object}
                              RLD: Address  Section  Rld-type Referencing
Symbol
 ---------------------------------------------------------------------------
----
---------------
ld: 0711-317 ERROR: Undefined symbol: boolcodes
 boolcodes                 [20]    ER UA conftest.c(conftest.o)
                                   00000044 .data    R_POS    [22]
<boolcodes>
ER: The return code is 8.
configure: failed program was:
#line 3369 "configure"
#include "confdefs.h"
#ifdef TERM_H_NEEDS_CURSES_H
#include <curses.h>
#endif
#include <term.h>
int main() {
char **test = boolcodes; printf(*test);
; return 0; }

term.h:

extern  char    term_parm_err[], *term_err_strings[], *Def_term,
                *boolnames[], *boolcodes[], *boolfnames[],
                *numnames[], *numcodes[], *numfnames[],
                *strnames[], *strcodes[], *strfnames[];

nm /usr/lib/libcurses.a:

boolcodes            D      42624     152
boolcodes            d      76556       4

config.h:

#define TERM_H_NEEDS_CURSES_H 1

I do not quite understand nm output; it is synmbol/type/value/size where D
means global data and d means local data (static?). Size is very funny, I
cannot imagine where this 152 comes from.

Any idea? Oliver, can you give a hint?

-andrej

