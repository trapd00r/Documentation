From zsh-workers-request@math.gatech.edu Sun Jan 25 15:26:03 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 506 invoked from network); 25 Jan 1998 15:25:24 -0000
Received: from ns2.primenet.com.au (7795@203.24.36.3)
  by ns1.primenet.com.au with SMTP; 25 Jan 1998 15:25:23 -0000
Received: (qmail 1235 invoked from network); 24 Jan 1998 22:24:57 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns2.primenet.com.au with SMTP; 24 Jan 1998 22:24:57 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id RAA29740;
	Sat, 24 Jan 1998 17:12:58 -0500 (EST)
Resent-Date: Sat, 24 Jan 1998 17:12:17 -0500 (EST)
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <980124141339.ZM23464@candle.brasslantern.com>
Date: Sat, 24 Jan 1998 14:13:39 -0800
In-Reply-To: <199801242023.PAA25336@luomat.peak.org>
Comments: In reply to Timothy J Luoma <luomat+zsh+users@luomat.peak.org>
        "zsh script wipes out my PROMPT and RPROMPT" (Jan 24,  3:23pm)
References: <199801242023.PAA25336@luomat.peak.org>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Timothy J Luoma <luomat+zsh+users@luomat.peak.org>,
        zsh-users@math.gatech.edu
Subject: Re: zsh script wipes out my PROMPT and RPROMPT
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"iOu0T3.0.3G7.0Tcoq"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1277
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Jan 24,  3:23pm, Timothy J Luoma wrote:
} Subject: zsh script wipes out my PROMPT and RPROMPT
}
} This script wipes out the PROMPT and RPROMPT

Can you explain further, please?

If you run this as an actual script, it -shouldn't- be able to have any
effect on your prompt at all, because it runs in a second shell.

If you run this as a shell function (e.g. by autoloading it), the "exit 0"
at the end should kill the shell entirely.

If you source or execute as a function this script from your .zlogin or
other init file, the "exit 0" will abort reading that file, which will of
course leave unfinished anything that appears later in the file.  My guess
is that this is what you're seeing, and that if you get rid of "exit 0"
then things will improve.

Another problem is that

LINES=`wc -l $FILE | awk '{print $1}'`

is changing zsh's idea of the size of your terminal; LINES is a reserved
variable name, along with COLUMNS.  You shouldn't use it as a temporary.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

