From zsh-workers-return-12070-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 26 09:35:00 2000
Return-Path: <zsh-workers-return-12070-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6111 invoked from network); 26 Jun 2000 09:34:58 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 Jun 2000 09:34:58 -0000
Received: (qmail 2874 invoked by alias); 26 Jun 2000 09:34:41 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12070
Received: (qmail 2848 invoked from network); 26 Jun 2000 09:34:40 -0000
Date: Mon, 26 Jun 2000 11:34:38 +0200 (MET DST)
Message-Id: <200006260934.LAA19520@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Bart Schaefer"'s message of Sat, 24 Jun 2000 23:00:22 +0000
Subject: PATCH: Re: A couple completion glitches


Bart Schaefer wrote:

> On Jun 24, 12:54pm, Wayne Davison wrote:
> } Subject: A couple completion glitches
> }
> } I've noticed that the new completion system won't ever complete a name
> } that matches the $fignore list, even if it is the only completion
> } possible.
> 
> Yes, that's correct.  To get the new completion system to act like the
> old one, you need something like
> 
>     zstyle ':completion:*:all-files' ignored-patterns \*$^fignore

No, the _ignored completer, which is used by default, but there was a
bug in it: it didn't find the right completers to use because it used
a parameter it had just declared local.

But of course one *can* replace $fignore with the above. Welcome to
the world of hey-look-at-all-the-things-we-can-ignore-now ;-)


In another message:

> You DO need to set the suffix style, but you need to set it to "false".
> 
> Which, now that I think about it, sounds backwards to me.  It means "do
> not make a special case of expansions that have a suffix" but it *seems*
> to mean "do not expand the suffix."  Which is how I got confused about
> what _expand was testing with "zstyle -T" in the first place ...

Hmhm, I found that rather confusing, too. But I was terribly confused
by all the possible interactions between the styles and such when
writing all that anyway. I was tempted to call it `no-suffix' but that 
wouldn't be very obvious either. Does anyone have a good suggestion,
probably avoiding `suffix' completely?


Bye
 Sven

Index: Completion/Core/_ignored
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Core/_ignored,v
retrieving revision 1.3
diff -u -r1.3 _ignored
--- Completion/Core/_ignored	2000/05/08 08:16:32	1.3
+++ Completion/Core/_ignored	2000/06/26 09:32:56
@@ -4,11 +4,13 @@
 
 [[ _matcher_num -gt 1 || $compstate[ignored] -eq 0 ]] && return 1
 
-local comp _comp_no_ignore=yes tmp expl \
-      _completer _completer_num _matcher _matchers _matcher_num
+local comp
 
 zstyle -a ":completion:${curcontext}:" completer comp ||
   comp=( "${(@)_completers[1,_completer_num-1][(R)_ignored(|:*),-1]}" )
+
+local _comp_no_ignore=yes tmp expl \
+      _completer _completer_num _matcher _matchers _matcher_num
 
 _completer_num=1
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

