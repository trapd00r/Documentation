From zsh-users-return-12854-mason-zsh=primenet.com.au@sunsite.dk Sun May 18 17:23:46 2008
Return-Path: <zsh-users-return-12854-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19820 invoked from network); 18 May 2008 17:23:44 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.7 required=5.0 tests=AWL,BAYES_00,HTML_MESSAGE
	autolearn=ham version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 May 2008 17:23:44 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 96251 invoked from network); 18 May 2008 17:23:30 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 May 2008 17:23:30 -0000
Received: (qmail 8459 invoked by alias); 18 May 2008 17:23:19 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12854
Received: (qmail 8444 invoked from network); 18 May 2008 17:23:19 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 18 May 2008 17:23:19 -0000
Received: from rv-out-0506.google.com (rv-out-0506.google.com [209.85.198.238])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 2B3838059114
	for <zsh-users@sunsite.dk>; Sun, 18 May 2008 19:23:14 +0200 (CEST)
Received: by rv-out-0506.google.com with SMTP id g37so894814rvb.21
        for <zsh-users@sunsite.dk>; Sun, 18 May 2008 10:23:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=tPE0W+MXr3ZIcS/JOJbiRykeGY31LP467opNJC0gXRc=;
        b=pCiM4ygryN8XXl79GGrlzKHDaRFckNvB8yMqj4ESlRkLpvRdGT/BpA4ByBbFWwmdwyGQmpMTgiTUADH3OWtCNLXbqC8xcU+QgTyMncnMVS8r4Tt9h/M0RB5DCCz9J36FA5J6bO+LKL+10X6RQp5FAVGVZZpAu+GLqsJUvIPrB6A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=L0rhrC8rgD1fcwsnlmYKZUyzJweOObv2DiZJ9kG1Rt/MrHPK1BGYw6nQm3/1m/oP7b9U/edOgE8roXOS+pN+3R4hgGs7lsNR7bOBUHAluDHTXdmIJS1AGkcq7JMdS2olDLXBjwAxUbV9Gz0OGm3mAzUdaFBuu2upN5kEJIFHrEE=
Received: by 10.140.174.18 with SMTP id w18mr3134820rve.227.1211131393389;
        Sun, 18 May 2008 10:23:13 -0700 (PDT)
Received: by 10.141.76.8 with HTTP; Sun, 18 May 2008 10:23:13 -0700 (PDT)
Message-ID: <d53cb3110805181023p1e823d8drb196db9e52f79b33@mail.gmail.com>
Date: Sun, 18 May 2008 22:53:13 +0530
From: "Gowtham M" <gowthamgowtham@gmail.com>
To: "Zsh Users" <zsh-users@sunsite.dk>
Subject: Question on filename completion
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_17001_17380285.1211131393389"
X-Virus-Scanned: ClamAV 0.91.2/7149/Sun May 18 16:40:15 2008 on bifrost
X-Virus-Status: Clean

------=_Part_17001_17380285.1211131393389
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I noticed that zsh gets very slow/unresponsive when I try to
complete a file name which resides in the following file system
hierarchy:

/some/path/to/something/<folders>/xyz/<file to be completed>

The number of folders in <folders> is very high (of the order of
10 thousand). Let us assume they are numbered from 0 to 9999

When I hit tab at
zsh> ls /some/path/to/something/761/xyz/_  # Tab is hit when cursor is at _

zsh spends a lot of time in stat64()ing all the directories from
/some/path/to/something/0 to /some/path/to/something/9999

I do not understand why this is required to complete the filename
after /some/path/to/something/761/xyz

I have turned approximate matching off.

My current zstyle is:

completer
        :completion:* _expand _complete _ignored
matcher-list
        :completion:* 'm:{a-zA-Z}={A-Za-z}'
format
        :completion:*:messages '%B%U---- %d%u%b'
        :completion:*:warnings '%BSorry. No match for: %d%b'
        :completion:*:corrections '%B%d (errors: %e)%b'
menu
        :completion:*:*:kill:* yes select
force-list
        :completion:*:kill:* always
list-colors
        :completion:* 'no=00' 'fi=00' 'di=01;36' 'ln=01;36' 'pi=40;33'
'so=01;35' 'do=01;35' 'bd=40;33;01' 'cd=40;33;01' 'or=40;31;01' 'ex=01;32'
'*.tar=01;31' '*.tgz=01;31' '*.svgz=01;31' '*.arj=01;31' '*.taz=01;31'
'*.lzh=01;31' '*.lzma=01;31' '*.zip=01;31' '*.z=01;31' '*.Z=01;31'
'*.dz=01;31' '*.gz=01;31' '*.bz2=01;31' '*.bz=01;31' '*.tbz2=01;31'
'*.tz=01;31' '*.deb=01;31' '*.rpm=01;31' '*.jar=01;31' '*.rar=01;31'
'*.ace=01;31' '*.zoo=01;31' '*.cpio=01;31' '*.7z=01;31' '*.rz=01;31'
'*.jpg=01;35' '*.jpeg=01;35' '*.gif=01;35' '*.bmp=01;35' '*.pbm=01;35'
'*.pgm=01;35' '*.ppm=01;35' '*.tga=01;35' '*.xbm=01;35' '*.xpm=01;35'
'*.tif=01;35' '*.tiff=01;35' '*.png=01;35' '*.svg=01;35' '*.mng=01;35'
'*.pcx=01;35' '*.mov=01;35' '*.mpg=01;35' '*.mpeg=01;35' '*.m2v=01;35'
'*.mkv=01;35' '*.ogm=01;35' '*.mp4=01;35' '*.m4v=01;35' '*.mp4v=01;35'
'*.vob=01;35' '*.qt=01;35' '*.nuv=01;35' '*.wmv=01;35' '*.asf=01;35'
'*.rm=01;35' '*.rmvb=01;35' '*.flc=01;35' '*.avi=01;35' '*.fli=01;35'
'*.gl=01;35' '*.dl=01;35' '*.xcf=01;35' '*.xwd=01;35' '*.yuv=01;35'
'*.aac=00;36' '*.au=00;36' '*.flac=00;36' '*.mid=00;36' '*.midi=00;36'
'*.mka=00;36' '*.mp3=00;36' '*.mpc=00;36' '*.ogg=00;36' '*.ra=00;36'
'*.wav=00;36'


My zsh version: 4.0.7

I found that zsh is is stat64()ing with the help of strace.


Thanks for your time.

- Gowtham

------=_Part_17001_17380285.1211131393389
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: base64
Content-Disposition: inline

SSBub3RpY2VkIHRoYXQgenNoIGdldHMgdmVyeSBzbG93L3VucmVzcG9uc2l2ZSB3aGVuIEkgdHJ5
IHRvIDxicj5jb21wbGV0ZSBhIGZpbGUgbmFtZSB3aGljaCByZXNpZGVzIGluIHRoZSBmb2xsb3dp
bmcgZmlsZSBzeXN0ZW08YnI+aGllcmFyY2h5Ojxicj48YnI+L3NvbWUvcGF0aC90by9zb21ldGhp
bmcvJmx0O2ZvbGRlcnMmZ3Q7L3h5ei8mbHQ7ZmlsZSB0byBiZSBjb21wbGV0ZWQmZ3Q7PGJyPgo8
YnI+VGhlIG51bWJlciBvZiBmb2xkZXJzIGluICZsdDtmb2xkZXJzJmd0OyBpcyB2ZXJ5IGhpZ2gg
KG9mIHRoZSBvcmRlciBvZjxicj4xMCB0aG91c2FuZCkuIExldCB1cyBhc3N1bWUgdGhleSBhcmUg
bnVtYmVyZWQgZnJvbSAwIHRvIDk5OTk8YnI+PGJyPldoZW4gSSBoaXQgdGFiIGF0PGJyPnpzaCZn
dDsgbHMgL3NvbWUvcGF0aC90by9zb21ldGhpbmcvNzYxL3h5ei9fJm5ic3A7ICMgVGFiIGlzIGhp
dCB3aGVuIGN1cnNvciBpcyBhdCBfPGJyPgo8YnI+enNoIHNwZW5kcyBhIGxvdCBvZiB0aW1lIGlu
IHN0YXQ2NCgpaW5nIGFsbCB0aGUgZGlyZWN0b3JpZXMgZnJvbTxicj4vc29tZS9wYXRoL3RvL3Nv
bWV0aGluZy8wIHRvIC9zb21lL3BhdGgvdG8vc29tZXRoaW5nLzk5OTk8YnI+PGJyPkkgZG8gbm90
IHVuZGVyc3RhbmQgd2h5IHRoaXMgaXMgcmVxdWlyZWQgdG8gY29tcGxldGUgdGhlIGZpbGVuYW1l
PGJyPmFmdGVyIC9zb21lL3BhdGgvdG8vc29tZXRoaW5nLzc2MS94eXo8YnI+Cjxicj5JIGhhdmUg
dHVybmVkIGFwcHJveGltYXRlIG1hdGNoaW5nIG9mZi48YnI+PGJyPk15IGN1cnJlbnQgenN0eWxl
IGlzOjxicj48YnI+Y29tcGxldGVyPGJyPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyA6Y29tcGxldGlvbjoqIF9leHBhbmQgX2NvbXBsZXRlIF9pZ25vcmVkPGJyPm1h
dGNoZXItbGlzdDxicj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsg
OmNvbXBsZXRpb246KiAmIzM5O206e2EtekEtWn09e0EtWmEten0mIzM5Ozxicj5mb3JtYXQ8YnI+
CiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyA6Y29tcGxldGlvbjoq
Om1lc3NhZ2VzICYjMzk7JUIlVS0tLS0gJWQldSViJiMzOTs8YnI+Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IDpjb21wbGV0aW9uOio6d2FybmluZ3MgJiMzOTslQlNv
cnJ5LiBObyBtYXRjaCBmb3I6ICVkJWImIzM5Ozxicj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsgOmNvbXBsZXRpb246Kjpjb3JyZWN0aW9ucyAmIzM5OyVCJWQgKGVy
cm9yczogJWUpJWImIzM5Ozxicj5tZW51PGJyPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyA6Y29tcGxldGlvbjoqOio6a2lsbDoqIHllcyBzZWxlY3Q8YnI+CmZvcmNl
LWxpc3Q8YnI+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IDpjb21w
bGV0aW9uOio6a2lsbDoqIGFsd2F5czxicj5saXN0LWNvbG9yczxicj4mbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgOmNvbXBsZXRpb246KiAmIzM5O25vPTAwJiMzOTsg
JiMzOTtmaT0wMCYjMzk7ICYjMzk7ZGk9MDE7MzYmIzM5OyAmIzM5O2xuPTAxOzM2JiMzOTsgJiMz
OTtwaT00MDszMyYjMzk7ICYjMzk7c289MDE7MzUmIzM5OyAmIzM5O2RvPTAxOzM1JiMzOTsgJiMz
OTtiZD00MDszMzswMSYjMzk7ICYjMzk7Y2Q9NDA7MzM7MDEmIzM5OyAmIzM5O29yPTQwOzMxOzAx
JiMzOTsgJiMzOTtleD0wMTszMiYjMzk7ICYjMzk7Ki50YXI9MDE7MzEmIzM5OyAmIzM5OyoudGd6
PTAxOzMxJiMzOTsgJiMzOTsqLnN2Z3o9MDE7MzEmIzM5OyAmIzM5OyouYXJqPTAxOzMxJiMzOTsg
JiMzOTsqLnRhej0wMTszMSYjMzk7ICYjMzk7Ki5semg9MDE7MzEmIzM5OyAmIzM5OyoubHptYT0w
MTszMSYjMzk7ICYjMzk7Ki56aXA9MDE7MzEmIzM5OyAmIzM5Oyouej0wMTszMSYjMzk7ICYjMzk7
Ki5aPTAxOzMxJiMzOTsgJiMzOTsqLmR6PTAxOzMxJiMzOTsgJiMzOTsqLmd6PTAxOzMxJiMzOTsg
JiMzOTsqLmJ6Mj0wMTszMSYjMzk7ICYjMzk7Ki5iej0wMTszMSYjMzk7ICYjMzk7Ki50YnoyPTAx
OzMxJiMzOTsgJiMzOTsqLnR6PTAxOzMxJiMzOTsgJiMzOTsqLmRlYj0wMTszMSYjMzk7ICYjMzk7
Ki5ycG09MDE7MzEmIzM5OyAmIzM5OyouamFyPTAxOzMxJiMzOTsgJiMzOTsqLnJhcj0wMTszMSYj
Mzk7ICYjMzk7Ki5hY2U9MDE7MzEmIzM5OyAmIzM5Oyouem9vPTAxOzMxJiMzOTsgJiMzOTsqLmNw
aW89MDE7MzEmIzM5OyAmIzM5OyouN3o9MDE7MzEmIzM5OyAmIzM5Oyoucno9MDE7MzEmIzM5OyAm
IzM5OyouanBnPTAxOzM1JiMzOTsgJiMzOTsqLmpwZWc9MDE7MzUmIzM5OyAmIzM5OyouZ2lmPTAx
OzM1JiMzOTsgJiMzOTsqLmJtcD0wMTszNSYjMzk7ICYjMzk7Ki5wYm09MDE7MzUmIzM5OyAmIzM5
OyoucGdtPTAxOzM1JiMzOTsgJiMzOTsqLnBwbT0wMTszNSYjMzk7ICYjMzk7Ki50Z2E9MDE7MzUm
IzM5OyAmIzM5OyoueGJtPTAxOzM1JiMzOTsgJiMzOTsqLnhwbT0wMTszNSYjMzk7ICYjMzk7Ki50
aWY9MDE7MzUmIzM5OyAmIzM5OyoudGlmZj0wMTszNSYjMzk7ICYjMzk7Ki5wbmc9MDE7MzUmIzM5
OyAmIzM5Oyouc3ZnPTAxOzM1JiMzOTsgJiMzOTsqLm1uZz0wMTszNSYjMzk7ICYjMzk7Ki5wY3g9
MDE7MzUmIzM5OyAmIzM5OyoubW92PTAxOzM1JiMzOTsgJiMzOTsqLm1wZz0wMTszNSYjMzk7ICYj
Mzk7Ki5tcGVnPTAxOzM1JiMzOTsgJiMzOTsqLm0ydj0wMTszNSYjMzk7ICYjMzk7Ki5ta3Y9MDE7
MzUmIzM5OyAmIzM5Oyoub2dtPTAxOzM1JiMzOTsgJiMzOTsqLm1wND0wMTszNSYjMzk7ICYjMzk7
Ki5tNHY9MDE7MzUmIzM5OyAmIzM5OyoubXA0dj0wMTszNSYjMzk7ICYjMzk7Ki52b2I9MDE7MzUm
IzM5OyAmIzM5OyoucXQ9MDE7MzUmIzM5OyAmIzM5OyoubnV2PTAxOzM1JiMzOTsgJiMzOTsqLndt
dj0wMTszNSYjMzk7ICYjMzk7Ki5hc2Y9MDE7MzUmIzM5OyAmIzM5Oyoucm09MDE7MzUmIzM5OyAm
IzM5Oyoucm12Yj0wMTszNSYjMzk7ICYjMzk7Ki5mbGM9MDE7MzUmIzM5OyAmIzM5OyouYXZpPTAx
OzM1JiMzOTsgJiMzOTsqLmZsaT0wMTszNSYjMzk7ICYjMzk7Ki5nbD0wMTszNSYjMzk7ICYjMzk7
Ki5kbD0wMTszNSYjMzk7ICYjMzk7Ki54Y2Y9MDE7MzUmIzM5OyAmIzM5OyoueHdkPTAxOzM1JiMz
OTsgJiMzOTsqLnl1dj0wMTszNSYjMzk7ICYjMzk7Ki5hYWM9MDA7MzYmIzM5OyAmIzM5OyouYXU9
MDA7MzYmIzM5OyAmIzM5OyouZmxhYz0wMDszNiYjMzk7ICYjMzk7Ki5taWQ9MDA7MzYmIzM5OyAm
IzM5OyoubWlkaT0wMDszNiYjMzk7ICYjMzk7Ki5ta2E9MDA7MzYmIzM5OyAmIzM5OyoubXAzPTAw
OzM2JiMzOTsgJiMzOTsqLm1wYz0wMDszNiYjMzk7ICYjMzk7Ki5vZ2c9MDA7MzYmIzM5OyAmIzM5
OyoucmE9MDA7MzYmIzM5OyAmIzM5Oyoud2F2PTAwOzM2JiMzOTs8YnI+Cjxicj48YnI+TXkgenNo
IHZlcnNpb246IDQuMC43PGJyPjxicj5JIGZvdW5kIHRoYXQgenNoIGlzIGlzIHN0YXQ2NCgpaW5n
IHdpdGggdGhlIGhlbHAgb2Ygc3RyYWNlLjxicj48YnI+PGJyPlRoYW5rcyBmb3IgeW91ciB0aW1l
Ljxicj48YnI+LSBHb3d0aGFtPGJyPgo=
------=_Part_17001_17380285.1211131393389--

