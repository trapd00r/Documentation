From zsh-users-return-14566-mason-zsh=primenet.com.au@zsh.org Thu Nov 12 20:38:10 2009
Return-Path: <zsh-users-return-14566-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15145 invoked by alias); 12 Nov 2009 20:38:10 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14566
Received: (qmail 29457 invoked from network); 12 Nov 2009 20:38:08 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at exherbo.org does not designate permitted sender hosts)
From: Ingmar Vanhassel <ingmar@exherbo.org>
To: Zsh hackers list <zsh-workers@zsh.org>
Cc: Zsh users list <zsh-users@zsh.org>,
	Ingmar Vanhassel <ingmar@exherbo.org>
Subject: [PATCH] env completion: add missing explanation of --unset option, fixes alignment of completed arguments
Date: Thu, 12 Nov 2009 21:13:39 +0100
Message-Id: <1258056819-4409-1-git-send-email-ingmar@exherbo.org>
X-Mailer: git-send-email 1.6.5.2.351.g0943
In-Reply-To: <alpine.LNX.2.01.0911121446150.26715@hp.internal>
References: <alpine.LNX.2.01.0911121446150.26715@hp.internal>

---
 Completion/Unix/Command/_env |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

I was getting a few patch series ready to send, but I guess I can fire this one
off already, it probably fixes your issue.

What I've not figured out, is how to make 'env FOO=bar quux <TAB>' complete
options to 'quux'. I guess that'll take someone with more experience than me.

diff --git a/Completion/Unix/Command/_env b/Completion/Unix/Command/_env
index 2638186..383891f 100644
--- a/Completion/Unix/Command/_env
+++ b/Completion/Unix/Command/_env
@@ -3,7 +3,7 @@
 if _pick_variant gnu=Free\ Soft unix --version; then
   _arguments \
     '(--ignore-environment -i)'{-i,--ignore-environment}'[start with empty environment]' \
-    {-u,--unset=}':env var to remove:compadd ${(k)parameters[(R)*export*]}' \
+    '(--unset= -u)'{-u,--unset=}'[remove variable from the environment]:env var to remove:compadd ${(k)parameters[(R)*export*]}' \
     '--help[help]' \
     '--version[version]' \
     '*::arguments: _normal'
-- 
1.6.5.2.351.g0943

