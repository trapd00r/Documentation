From zsh-workers-return-13866-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 02 05:35:19 2001
Return-Path: <zsh-workers-return-13866-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6978 invoked from network); 2 Apr 2001 05:35:18 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 Apr 2001 05:35:18 -0000
Received: (qmail 8700 invoked by alias); 2 Apr 2001 05:35:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13866
Received: (qmail 8688 invoked from network); 2 Apr 2001 05:35:10 -0000
Date: Mon, 2 Apr 2001 01:33:56 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.dk
Subject: PATCH: apt-get install "pinning"
Message-ID: <20010402013356.A15573@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i

More new apt features.

Index: Completion/Debian/_apt
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Debian/_apt,v
retrieving revision 1.13
diff -u -r1.13 _apt
--- Completion/Debian/_apt	2001/04/02 00:57:20	1.13
+++ Completion/Debian/_apt	2001/04/02 05:32:34
@@ -414,7 +414,9 @@
     -- \
     /$'update\0'/ \| \
     /$'upgrade\0'/ \| \
-    /$'install\0'/ /$'[^\0]#\0'/ ':packages::{ _deb_packages "$expl_packages[@]" uninstalled || _deb_packages "$expl_packages[@]" installed }' \# \| \
+    \( \
+    /$'install\0'/ /$'[^\0]#\0'/ ':packages::{ _deb_packages "$expl_packages[@]" uninstalled || _deb_packages "$expl_packages[@]" installed }' \# \
+    /$'[^\0/]#/'/ /$'[^\0/]#\0'/ ':release name::_apt_releases' \) \| \
     /$'remove\0'/ /$'[^\0]#\0'/ ':packages::_deb_packages "$expl_packages[@]" installed' \# \| \
     /$'dist-upgrade\0'/ \| \
     /$'dselect-upgrade\0'/ \| \
@@ -535,7 +537,7 @@
 }
 
 _apt_releases () {
-  local command="$argv[$#]" update_policy
+  local update_policy
 
   zstyle -s ":completion:*:*:$service:*" cache-policy update_policy
   if [[ -z "$update_policy" ]]; then

