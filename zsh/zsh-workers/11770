From zsh-workers-return-11770-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jun 06 09:49:14 2000
Return-Path: <zsh-workers-return-11770-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1401 invoked from network); 6 Jun 2000 09:49:08 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Jun 2000 09:49:08 -0000
Received: (qmail 16804 invoked by alias); 6 Jun 2000 09:48:41 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11770
Received: (qmail 16796 invoked from network); 6 Jun 2000 09:48:40 -0000
Date: Tue, 6 Jun 2000 11:48:12 +0200 (MET DST)
Message-Id: <200006060948.LAA08623@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Bart Schaefer"'s message of Tue, 6 Jun 2000 05:16:26 +0000
Subject: Re: #compdef -k menu-select glitch in 3.1.9


Bart Schaefer wrote:

> On Jun 6,  4:56am, Bart Schaefer wrote:
> } Subject: #compdef -k menu-select glitch in 3.1.9
> }
> } If I explicitly invoke `zle -C _widget .menu-select _widget' then I do get
> } menu-select behavior, but for some reason it doesn't work at compinit time.
> 
> I found out what's happening: this is partly pilot error on my part, and
> partly bad behavior from compinit.
> 
> I have two files in my $fpath both named _widget with different #compdef
> tags.  compinit processes both of them, in $fpath order, which means that
> the #compdef that wins doesn't match the function that gets autoloaded.  I
> expected it to only process the one that would actually be autoloaded.
> 
> Should we stick a `(( $+functions[$_i_file] )) && continue' or equivalent
> into the `for _i_file in ...' loop in compinit?

Or make compinit tell the user about such things and add an option to
make it be quiet (that reminds me of the security checks you suggested 
for loading the completion system; I got no reply to my suggested
patch in 11440).

> The other puzzler, with the beeping, still remains.

That's because menu-select always returns zero, whereas the other
completion widgets return 1 when listing and LISTBEEP is set. Hm, is
it `correct' to make menu-select beep, too? (But that seems a bit
silly, because it always lists, kind of.) I don't have any opinion
here since I don't let it beep at me at all... what do you want to
have? 


Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

