From zsh-workers-return-18362-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 19 04:32:06 2003
Return-Path: <zsh-workers-return-18362-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12058 invoked from network); 19 Mar 2003 04:32:05 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 19 Mar 2003 04:32:05 -0000
Received: (qmail 23710 invoked by alias); 19 Mar 2003 04:31:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18362
Received: (qmail 23703 invoked from network); 19 Mar 2003 04:31:57 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 19 Mar 2003 04:31:57 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [156.153.255.237] by sunsite.dk (MessageWall 1.0.8) with SMTP; 19 Mar 2003 4:31:57 -0000
Received: from tsx2.cup.hp.com (tsx2.cup.hp.com [15.13.185.29])
	by palrel12.hp.com (Postfix) with ESMTP id 7A6561C01BF3
	for <zsh-workers@sunsite.dk>; Tue, 18 Mar 2003 20:31:56 -0800 (PST)
Received: from cup.hp.com (localhost [127.0.0.1])
	by tsx2.cup.hp.com (8.11.1/8.8.6) with ESMTP id h2J4Vqn22699;
	Tue, 18 Mar 2003 20:31:52 -0800 (PST)
Sender: manish@cup.hp.com
Message-ID: <3E77F2B5.E50A6FB@cup.hp.com>
Date: Tue, 18 Mar 2003 20:31:49 -0800
From: Manish Ahluwalia <manish@cup.hp.com>
Organization: Hewlett Packard
X-Mailer: Mozilla 4.79 [en] (X11; U; HP-UX B.11.11 9000/800)
X-Accept-Language: en
MIME-Version: 1.0
To: zsh-workers@sunsite.dk
Cc: manish@cup.hp.com
Subject: zsh - hpux 11i prompt does not work
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Hi,

I use zsh on hpux. I have noticed a problem with zsh and hpux version
11i. I have tried zsh versions 3.0.5 and 4.0.4 with the same results.
Both versions display the problem mentioned below on hpux 11i and both
don't have the problem on hpux 10.20.

I use the dtterm terminal. The same behavior is seen with xterm. What
happens is that I set my PS1 to do a couple of things:
a) Print the hostname, username and pwd on the title bar of the
terminal.
b) Change the color to something other than the default (for dtterm, I
prefer yellow in the example below). Print pwd, last exit value, and
change the color back to default.

However, I notice that most of the prompt settings don't take effect.
Here is a cut and paste from my dtterm window:
 echo $PS1 | xd -c
0000000  %  { 1b  ]  0  ;  %  n  @  %  M 07  %  }  %  {
0000010 1b  [  1  ;  3  3  m  %  }  %  3  ~  -  %  ?  %
0000020  #  %  { 1b  [  m  %  }    \n
000002a
 echo $TERM
dtterm
 pwd
/home/manish

(The terminal window title does not change, it always displays the
default `Terminal').

As you can see, my PS1 is set up to do a bunch of things. Nothing of it
gets printed as part of the prompt. there is no prompt string at all.

I have also noticed that if I change to a directory that has a long name
(i.e. the prompt string expansion becomes very big), then the prompt
does display a portion of itself:

 cd /home/manish/work/hp/tests/MAS/Performance/ 
/MAS/Performance-0% 

which leads me to think that somehow only the last few characters of the
expansion of the prompt are being printed by zsh. Also, if I do a:
/MAS/Performance-0% print -P $PS1
tests/MAS/Performance-0% 
/MAS/Performance-0% 

The line printed by `print -P' (tests/MAS/Performance-0%) is in yellow
as PS1 wanted it to be. Also, the print -P causes the title bar to
change to `manish@tsx2' (manish is my login name , tsx2 is my hostname)
also as PS1 dictates.

Any suggestions as to what could be going wrong / what I could do to
investigate further / what information I should provide to help you
figure what is going on?

Thanks.

-- Manish
____________________________________________________________________
If it weren't for C, we'd be programming in BASI, PASAL, and OBOL.

