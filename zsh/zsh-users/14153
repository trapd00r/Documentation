From zsh-users-return-14153-mason-zsh=primenet.com.au@sunsite.dk Thu May 21 07:41:47 2009
Return-Path: <zsh-users-return-14153-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17730 invoked from network); 21 May 2009 07:41:43 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 21 May 2009 07:41:43 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 28970 invoked from network); 21 May 2009 07:41:28 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 21 May 2009 07:41:28 -0000
Received: (qmail 6886 invoked by alias); 21 May 2009 07:41:09 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14153
Received: (qmail 6868 invoked from network); 21 May 2009 07:41:08 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 21 May 2009 07:41:08 -0000
Received: from prunille.vinc17.org (vinc17.pck.nerim.net [213.41.242.187])
	by bifrost.dotsrc.org (Postfix) with ESMTP id EA3B88027106
	for <zsh-users@sunsite.dk>; Thu, 21 May 2009 09:41:04 +0200 (CEST)
Received: by prunille.vinc17.org (Postfix, from userid 501)
	id 7E1013808BF3; Thu, 21 May 2009 09:41:03 +0200 (CEST)
Date: Thu, 21 May 2009 09:41:03 +0200
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-users@sunsite.dk
Subject: Re: prompt and ssh
Message-ID: <20090521074103.GN27141@prunille.vinc17.org>
Mail-Followup-To: zsh-users@sunsite.dk
References: <e7db6e960905190954j7be72739p6b521bca8e90fe7f@mail.gmail.com>
 <20090519200217.35368.qmail@smasher.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <20090519200217.35368.qmail@smasher.org>
X-Mailer-Info: http://www.vinc17.org/mutt/
User-Agent: Mutt/1.5.19-5808-vl-r28634 (2009-05-15)
X-Virus-Scanned: ClamAV 0.94.2/9377/Thu May 21 04:57:18 2009 on bifrost
X-Virus-Status: Clean

On 2009-05-20 08:02:16 +1200, Atom Smasher wrote:
> On Tue, 19 May 2009, ugaciaka wrote:
>
>> I would like to change the type of zsh prompt the remote client (ssh):  
>> if I connected remotely show differently prompt...
>>
>> What kind of condition if I can put on PS1?
> ==============
>
> you can test for SSH_CONNECTION, SSH_CLIENT, or SSH_TTY on the far side. 
> i would recommend SSH_CONNECTION.

But this will not work well if you use "screen". For instance:
1. Connect to host remote_host by ssh.
2. Start a screen session. SSH_CONNECTION is inherited and the prompt
   will say that you are connected by ssh (this is what you want).
3. Later, log on the machine directly (without ssh) and recall the
   screen session. SSH_CONNECTION is still set (as the environment
   doesn't change in the recalled shell) and the prompt will still
   say that you are connected by ssh, while you are not.

-- 
Vincent Lefèvre <vincent@vinc17.org> - Web: <http://www.vinc17.org/>
100% accessible validated (X)HTML - Blog: <http://www.vinc17.org/blog/>
Work: CR INRIA - computer arithmetic / Arenaire project (LIP, ENS-Lyon)

