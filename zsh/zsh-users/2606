From zsh-users-return-2606-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Sep 16 16:34:33 1999
Return-Path: <zsh-users-return-2606-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8467 invoked from network); 16 Sep 1999 16:34:32 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 16 Sep 1999 16:34:32 -0000
Received: (qmail 22675 invoked by alias); 16 Sep 1999 16:34:10 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 2606
Received: (qmail 22668 invoked from network); 16 Sep 1999 16:34:10 -0000
Date: Thu, 16 Sep 1999 17:34:09 +0100
From: Adam Spiers <adam@thelonious.new.ox.ac.uk>
To: zsh users mailing list <zsh-users@sunsite.auc.dk>
Subject: Re: simulation of dabbrev-expand
Message-ID: <19990916173409.A17932@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh users mailing list <zsh-users@sunsite.auc.dk>
References: <19990909133913.A30055@thelonious.new.ox.ac.uk> <990909171104.ZM15814@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0pre2i
In-Reply-To: <990909171104.ZM15814@candle.brasslantern.com>
X-URL: http://www.new.ox.ac.uk/~adam/
X-OS: Linux 2.2.9 i686

Bart Schaefer (schaefer@candle.brasslantern.com) wrote:
> On Sep 9,  1:39pm, Adam Spiers wrote:
> } Subject: simulation of dabbrev-expand
> }
> } It appears to always work fine when grabbing words from history added
> } by the current shell, but either doesn't work at all, or very
> } unreliably when you want to grab a word from the saved history.
> 
> Can you perhaps give a more specific example?  I'm not having any trouble
> with this at all.

  % history 1 | grep ' /' | wc -l
      650
  % zle -l | grep hist
  _history_complete_word -C .complete-word _history_complete_word
  _reverse_history_complete_word -C reverse-menu-complete _history_complete_word
  % _history_complete_word () {
  local expl
  compstate[list]=list
  compstate[insert]=menu
  _description -V expl 'history word'
  compgen -V 'history words' -Q -H 0 ''
  }
  % bindkey ^[/
  "^[/" _history_complete_word
  % less /<>
  % less /usr/share/zsh/functions/_man
  zsh: do you wish to see all 51 possibilities? 

Where did all the others go?  For example, a very old entry in my
history (I save large histories):

   114  cp /share/software/redhat/updates-6.0/i386/netscape-* .

but when I try do

  % ls /s<meta-/>

nothing happens.  The newer entries work fine.  This problem has
exhibited itself in exactly the same way across zsh-3.1.6-pws-* :-(

> What history-related options do you have set?

  % setopt | grep hist
  cshjunkiehistory
  extendedhistory
  histallowclobber
  histexpiredupsfirst
  histignorealldups
  histignoredups
  histignorespace
  histreduceblanks
  histverify
  incappendhistory

Adam

