From zsh-users-return-9710-mason-zsh=primenet.com.au@sunsite.dk Sat Nov 26 14:55:08 2005
Return-Path: <zsh-users-return-9710-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13261 invoked from network); 26 Nov 2005 14:55:06 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Nov 2005 14:55:06 -0000
Received: (qmail 96282 invoked from network); 26 Nov 2005 14:54:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Nov 2005 14:54:59 -0000
Received: (qmail 28703 invoked by alias); 26 Nov 2005 14:54:51 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9710
Received: (qmail 28693 invoked from network); 26 Nov 2005 14:54:50 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 26 Nov 2005 14:54:50 -0000
Received: (qmail 95070 invoked from network); 26 Nov 2005 14:54:50 -0000
Received: from wsip-68-98-209-187.ph.ph.cox.net (HELO maggie.pointcircle.com) (68.98.209.187)
  by a.mx.sunsite.dk with SMTP; 26 Nov 2005 14:54:47 -0000
Received: from localhost (localhost [127.0.0.1])
	by maggie.pointcircle.com (Postfix) with ESMTP id 0D4AC141CB579;
	Sat, 26 Nov 2005 07:55:36 -0700 (MST)
Received: from maggie.pointcircle.com ([127.0.0.1])
 by localhost (maggie.pointcircle.com [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 22998-09; Sat, 26 Nov 2005 07:55:33 -0700 (MST)
Received: from [192.168.1.31] (gretchen.pointcircle.com [192.168.1.31])
	(using TLSv1 with cipher RC4-SHA (128/128 bits))
	(No client certificate requested)
	by maggie.pointcircle.com (Postfix) with ESMTP id 0854D141CB0E2;
	Sat, 26 Nov 2005 07:55:33 -0700 (MST)
In-Reply-To: <20051126132557.GH13460@ay.vinc17.org>
References: <2FDFACEA-C7A6-4F45-897D-B786CC632463@pointcircle.com> <200511261032.35289.cht@chello.at> <20051126132557.GH13460@ay.vinc17.org>
Mime-Version: 1.0 (Apple Message framework v746.2)
Content-Type: text/plain; charset=ISO-8859-1; delsp=yes; format=flowed
Message-Id: <E350C29B-12FD-4276-8EA3-D13B4E11AE41@pointcircle.com>
Content-Transfer-Encoding: quoted-printable
From: Steven Klass <sklass@pointcircle.com>
Subject: Re: path and += troubles
Date: Sat, 26 Nov 2005 07:54:35 -0700
To: zsh-users <zsh-users@sunsite.dk>
X-Mailer: Apple Mail (2.746.2)
X-Virus-Scanned: amavisd-new at maggie.pointcircle.com

Hi,

This exposes one of my personal problems with typeset.  If I really =20
want a path appended typeset -U will drop the appended path, in favor =20=

of the path which already exists.  So IMHO the only way to handle =20
this properly is to
=09
	Normalize the new path ($2) - Remove any trailing slashes ensure =
no =20
double-slashes
	Check to see if the new path exists in the old path array ($1) =
and =20
delete it
	Append or Prepend the new path to the $1
=09
Here's some of the cleanup stuff I read about in this list..
	path=3D($^path(N))
	setopt EXTENDED_GLOB
	path=3D(${${path//\/##/\/}%/})
	unsetopt EXTENDED_GLOB
	typeset -U path

But can anyone please explain my number 1 item - that is really =20
annoying me..

	appendPath() {
		# if the path exists delete it..
		deletePath $1 $2
		# Append the path to the end..
		$1+=3D($2)
	}

	1.  Why does +=3D not work when adding to the array - It should =
right?


---

Steven Klass

sklass@pointcircle.com
(480) 988-5657

On Nov 26, 2005, at 6:25 AM, Vincent Lefevre wrote:

> On 2005-11-26 10:32:35 +0100, Christian Taylor wrote:
>> I never bothered about a deletion function, because I simply use:
>> typeset -U path
>> which will keep only the first occurence of any element.
>
> But if a same path is written in two different ways, it doesn't
> recognise it:
>
> ay:~> echo $library_path
> /home/lefevre/./lib /home/lefevre/./lib /home/lefevre/lib /usr/=20
> local/gmp/lib
> ay:~> typeset -U LIBRARY_PATH
> ay:~> echo $library_path
> /home/lefevre/./lib /home/lefevre/lib /usr/local/gmp/lib
>
> --=20
> Vincent Lef=E8vre <vincent@vinc17.org> - Web: <http://www.vinc17.org/>
> 100% accessible validated (X)HTML - Blog: <http://www.vinc17.org/=20
> blog/>
> Work: CR INRIA - computer arithmetic / SPACES project at LORIA

