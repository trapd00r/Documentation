From zsh-workers-return-9526-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Feb 02 09:28:14 2000
Return-Path: <zsh-workers-return-9526-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11763 invoked from network); 2 Feb 2000 09:28:13 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 Feb 2000 09:28:13 -0000
Received: (qmail 18698 invoked by alias); 2 Feb 2000 09:28:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9526
Received: (qmail 18690 invoked from network); 2 Feb 2000 09:28:07 -0000
Date: Wed, 2 Feb 2000 10:28:05 +0100 (MET)
Message-Id: <200002020928.KAA10664@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 02 Feb 2000 03:55:20 +0900
Subject: Re: :*pattern:message:action


Tanaka Akira wrote:

> I found that _arguments description `:*pattern:message:action' has a problem.
> 
> Z(2):akr@is27e1u11% Src/zsh -f
> is27e1u11% bindkey -e; autoload -U compinit; compinit -D; compdef _tst tst
> is27e1u11% _tst () { _arguments '-x:*-?*:arguments for -x:' '-y' '-z' }
> is27e1u11% zstyle ':completion*:messages' format '%d'
> is27e1u11% tst -x a b c -y <TAB>
> arguments for -x
> 
> This doesn't complete `-y' and `-z'.  However they are completed by
> following command line, it is not intentional, I think.
> 
> is27e1u11% tst -x ab c -?* <TAB>

Indeed, missing tokenization.

Bye
 Sven

diff -ru ../z.old/Src/Zle/computil.c Src/Zle/computil.c
--- ../z.old/Src/Zle/computil.c	Wed Feb  2 09:34:50 2000
+++ Src/Zle/computil.c	Wed Feb  2 10:25:20 2000
@@ -717,6 +717,7 @@
 			    sav = *p;
 			    *p = '\0';
 			    end = dupstring(end);
+			    tokenize(end);
 			    *p = sav;
 			}
 			if (*p != ':') {

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

