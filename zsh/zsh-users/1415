From zsh-workers-request@math.gatech.edu Tue Mar 24 16:42:50 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 722 invoked from network); 24 Mar 1998 16:42:49 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 24 Mar 1998 16:42:49 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id LAA26952;
	Tue, 24 Mar 1998 11:35:08 -0500 (EST)
Resent-Date: Tue, 24 Mar 1998 11:34:50 -0500 (EST)
From: "Eddy J. Gurney" <eddy@ans.net>
Message-Id: <980324113412.ZM3686@gizmo.aa.ans.net>
Date: Tue, 24 Mar 1998 11:34:12 -0500
References: <Pine.SV4.3.95.980320172520.16527A-100000@itsrm2>
X-Mailer: Z-Mail (4.0.1 13Jan97)
To: zsh-users@math.gatech.edu
Subject: Re: Directory-only `cd' completion via compctl bug
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"9xxG52.0.Ma6.f2-5r"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1415
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Mar 20 at 17:26, Andrej Borsenkow wrote:
,--
| > # Another possibility for cd/pushd is to use it in conjunction with the
| > # cdmatch function (in the Functions subdirectory of zsh distribution).
| >
| > if [[ -o AUTO_REMOVE_SLASH ]] then
| >     compctl -x 'p[2]' -Q -K cdmatch2 - 'S[/][~][./][../]' -g '*(-/)' + \
| >         -g '*(-/D)' - 'n[-1,/], s[]' -K cdmatch -q -S '/' -- cd pushd
| > else
| >     compctl -x 'p[2]' -Q -K cdmatch2 - 'S[/][~][./][../]' -g '*(-/)' + \
| >         -g '*(-/D)' - 'n[-1,/], s[]' -K cdmatch -S '/' -- cd pushd
| > fi
| >
| > This works great... except for one case that I've found so far.
| >
| > If you try to CD into a directory with spaces in the name, for some
| > reason it escapes the backslashes:
| >
| > cd Schoolhouse\\\ Rock\\\ -\\\ America\\\ Rock/
|
| Just tried with zsg-3.1.2-zefram3 (+some patches) and it works quite fine.
| I am using the same completion. Which zsh version do you have? Try to
| start with vanilla zsh -f (may be, some options you set cause it).
`--
Nope, I still can't get it to work correctly.

gizmo:~> zsh-3.1.2-zefram3/Src/zsh -f
gizmo% echo $ZSH_VERSION
3.1.2-zefram3

I then pasted in the above `cd' compctl defintion, and pasted in the
`cdmatch' function. Exact same bahavior:

gizmo% cd T<tab>
Test\\\ -\\\ abc     Test\\\ -\\\ ghi
Test\\\ -\\\ def     Trouble\\\ -\\\ abc
gizmo% cd Tr<tab> -> cd Trouble\\\ -\\\ abc/
cd: no such file or directory: Trouble\ -\ abc/
gizmo% cd ./Tr<tab> -> cd ./Trouble\ -\ abc/

My 3.1.2-zefram3 has patches 3713, 3714 and 3739 applied. But I get the
same behavior described above under zsh-3.0.2 as well.

