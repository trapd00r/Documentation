From zsh-workers-return-9976-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Mar 03 11:44:02 2000
Return-Path: <zsh-workers-return-9976-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9652 invoked from network); 3 Mar 2000 11:44:00 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 3 Mar 2000 11:44:00 -0000
Received: (qmail 11111 invoked by alias); 3 Mar 2000 11:43:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9976
Received: (qmail 11097 invoked from network); 3 Mar 2000 11:43:54 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>
Subject: Running tests without installing Zsh
Date: Fri, 3 Mar 2000 14:43:48 +0300
Message-ID: <000301bf8505$bd6c8640$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2919.6700

If Zsh is compiled with dynamic loading, it is near to impossible to run
tests without installing Zsh (at least, Zsh modules and, probably,
functions). Even setting module_path to $srcdir/Src/*(/) does not help,
because Zsh loads modules as zsh/<module> - and we do not have zsh
subdirectories in this case.

One possibility is to use separate directory for compiled binaries. Bin/zsh
for zsh itself and Bin/Modules for modules with the same structure as in
installation directory. Then in ztst.zsh (or, possibly, as parameter) use

module_path=($PWD/../Bin/Modules)

and in Test/Makefile

check:
	$PWD/../Bin/zsh -f ztst.zsh

Of course, if any test runs as interactive, it will pick up wrong module
anyway as we cannot override module_path at Zsh startup.

Is any module loaded at non-interactive shell startup?

/andrej

