From zsh-users-return-3054-mason-zsh=primenet.com.au@sunsite.auc.dk Mon May 01 18:22:45 2000
Return-Path: <zsh-users-return-3054-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 730 invoked from network); 1 May 2000 18:22:43 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 May 2000 18:22:43 -0000
Received: (qmail 1043 invoked by alias); 1 May 2000 18:22:25 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3054
Received: (qmail 1008 invoked from network); 1 May 2000 18:22:24 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000501182216.ZM13391@candle.brasslantern.com>
Date: Mon, 1 May 2000 18:22:16 +0000
In-Reply-To: <20000501131328.A11940@tdc134.comm.mot.com>
Comments: In reply to Paul Ackersviller <paulda@home.com>
        "TRAPZERR() in chpwd()" (May  1,  1:13pm)
References: <20000428161546.A8208@tdc134.comm.mot.com> 
	<1000429044220.ZM30544@candle.brasslantern.com> 
	<20000501131328.A11940@tdc134.comm.mot.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Paul Ackersviller <paulda@home.com>
Subject: Re: TRAPZERR() in chpwd()
Cc: Zsh users list <zsh-users@sunsite.auc.dk>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On May 1,  1:13pm, Paul Ackersviller wrote:
} Subject: TRAPZERR() in chpwd()
}
} [...] what I meant by `tests' was internal shell tests as
} opposed to external programs or other commands.  Here's a simplified example
} of what I'm seeing.
} 	TRAPZERR () { echo exit code $?; }
} 	chpwd () { [ -h $PWD ] && echo symlink; true; }
} When I change to a directory that's not a soft link, I'm getting the `exit
} code' message from 3.1.7-pre-1, whereas I never have with earlier versions.

Hmmmmm ... trying some assorted older builds I have around ...

zagzig% echo $VERSION
zsh 2.4.306 beta
zagzig% TRAPZERR () { echo exit code $?; }
zagzig% chpwd () { [ -h $PWD ] && echo symlink; true; }
zagzig% cd /tmp
exit code 1
zagzig% cd /hosts
symlink
zagzig%

zagzig% echo $ZSH_VERSION
3.0.6-test-1
zagzig% TRAPZERR () { echo exit code $?; }
zagzig% chpwd () { [ -h $PWD ] && echo symlink; true; }
zagzig% cd /tmp
zagzig% cd /hosts
symlink
zagzig% 

This may be a fix that went in to 3.0.x and was never propagated to 3.1.x,
or it may be a bug that was introduced in 3.0.x and fixed in 3.1.x.  I'm
not sure which at this point.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

