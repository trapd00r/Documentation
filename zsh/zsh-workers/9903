From zsh-workers-return-9903-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Feb 28 11:58:02 2000
Return-Path: <zsh-workers-return-9903-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14793 invoked from network); 28 Feb 2000 11:58:00 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 28 Feb 2000 11:58:00 -0000
Received: (qmail 10837 invoked by alias); 28 Feb 2000 11:57:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9903
Received: (qmail 10830 invoked from network); 28 Feb 2000 11:57:45 -0000
Date: Mon, 28 Feb 2000 12:57:44 +0100 (MET)
Message-Id: <200002281157.MAA03238@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Sven Wischnowsky's message of Mon, 28 Feb 2000 12:00:41 +0100
	(MET)
Subject: Re: Bug with push-line-or-edit and here-documents


I wrote:

> ...
>
> -    if (!qt)
> +    if (!qt) {
> +	int ef = errflag;
> +
>  	parsestr(buf);
> +	errflag = ef;
> +    }

Err... we better keep a value != zero coming from parsestr().

Bye
 Sven

diff -ru ../z.old/Src/exec.c Src/exec.c
--- ../z.old/Src/exec.c	Mon Feb 28 12:00:51 2000
+++ Src/exec.c	Mon Feb 28 12:56:24 2000
@@ -2557,7 +2557,9 @@
 	int ef = errflag;
 
 	parsestr(buf);
-	errflag = ef;
+
+	if (!errflag)
+	    errflag = ef;
     }
     s = dupstring(buf);
     zfree(buf, bsiz);

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

