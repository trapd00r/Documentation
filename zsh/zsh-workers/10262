From zsh-workers-return-10262-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Mar 27 08:41:51 2000
Return-Path: <zsh-workers-return-10262-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1752 invoked from network); 27 Mar 2000 08:41:49 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Mar 2000 08:41:49 -0000
Received: (qmail 15988 invoked by alias); 27 Mar 2000 08:41:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10262
Received: (qmail 15969 invoked from network); 27 Mar 2000 08:41:42 -0000
Date: Mon, 27 Mar 2000 10:41:40 +0200 (MET DST)
Message-Id: <200003270841.KAA03638@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: compadd -D


[As I said, from now on my patches are relative to 10230 and 10231. If 
anyone objects to one of them (10231 will partly be taken back by one
of the following patches), please tell me.]

This sometimes deleted the wrong strings when combined with -F.

Bye
 Sven

diff -ru ../z.old/Src/Zle/compcore.c Src/Zle/compcore.c
--- ../z.old/Src/Zle/compcore.c	Mon Mar 27 10:25:02 2000
+++ Src/Zle/compcore.c	Mon Mar 27 10:37:56 2000
@@ -1807,6 +1807,8 @@
 		}
 		if (!addit) {
 		    compignored++;
+		    if (dparr && !*++dparr)
+			dparr = NULL;
 		    continue;
 		}
 	    }

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

