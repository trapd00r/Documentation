From zsh-workers-return-8371-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Oct 22 08:08:16 1999
Return-Path: <zsh-workers-return-8371-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28528 invoked from network); 22 Oct 1999 08:08:14 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Oct 1999 08:08:14 -0000
Received: (qmail 2915 invoked by alias); 22 Oct 1999 08:08:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8371
Received: (qmail 2881 invoked from network); 22 Oct 1999 08:08:08 -0000
Sender: aduret@mars.l2i
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: stat -g
X-Attribution: plx
From: Alexandre Duret-Lutz <alexandre.duret@greyc.ismra.fr>
Date: 22 Oct 1999 11:07:08 +0100
Message-ID: <7dr9inr9o3.fsf@mars.l2i>
Lines: 32
User-Agent: Gnus/5.0700000000000003 (Pterodactyl Gnus v0.97) Emacs/20.2
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Documentation of `stat' says that `-g' should force `-s' on, 
this wasn't the case in zsh-3.1.6-bart-7.


--- Src/Modules/stat.c.old	Fri Oct 22 10:34:02 1999
+++ Src/Modules/stat.c	Fri Oct 22 10:51:54 1999
@@ -462,6 +462,10 @@
 	for (aptr = args; *aptr; aptr++)
 	    nargs++;
 
+    if (ops['g']) {
+	flags |= STF_GMT;
+	ops['s'] = 1;
+    }
     if (ops['s'] || ops['r'])
 	flags |= STF_STRING;
     if (ops['r'] || !ops['s'])
@@ -470,8 +474,6 @@
 	flags |= STF_FILE;
     if (ops['t'])
 	flags |= STF_NAME;
-    if (ops['g'])
-	flags |= STF_GMT;
 
     if (!(arrnam || hashnam)) {
 	if (nargs > 1)


-- 
Alexandre Duret-Lutz


