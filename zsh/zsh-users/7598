From zsh-users-return-7598-mason-zsh=primenet.com.au@sunsite.dk Wed Jun 23 18:48:04 2004
Return-Path: <zsh-users-return-7598-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6390 invoked from network); 23 Jun 2004 18:48:02 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.86)
  by ns1.primenet.com.au with SMTP; 23 Jun 2004 18:48:02 -0000
Received: (qmail 508 invoked from network); 23 Jun 2004 18:46:57 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Jun 2004 18:46:57 -0000
Received: (qmail 27375 invoked by alias); 23 Jun 2004 18:46:18 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7598
Received: (qmail 27364 invoked from network); 23 Jun 2004 18:46:18 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 23 Jun 2004 18:46:15 -0000
Received: (qmail 30146 invoked from network); 23 Jun 2004 18:46:13 -0000
Received: from rwcrmhc13.comcast.net (204.127.198.39)
  by a.mx.sunsite.dk with SMTP; 23 Jun 2004 18:46:08 -0000
Received: from www.muino.org ([24.5.172.109])
          by comcast.net (rwcrmhc13) with ESMTP
          id <2004062318454001500d0ei0e>; Wed, 23 Jun 2004 18:45:40 +0000
Received: by www.muino.org (Postfix, from userid 2555)
	id C697E19D10; Wed, 23 Jun 2004 11:45:16 -0700 (PDT)
Date: Wed, 23 Jun 2004 11:45:16 -0700
From: Daniel Muino <daniel@muino.org>
To: zsh-users@sunsite.dk
Subject: Re: Perl completion problem
Message-ID: <20040623184516.GB6456@muino.org>
References: <20040623001217.GA6456@muino.org> <Pine.LNX.4.44.0406230001230.28797-100000@toltec.zanshin.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <Pine.LNX.4.44.0406230001230.28797-100000@toltec.zanshin.com>
User-Agent: Mutt/1.5.6i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.9 required=6.0 tests=BAYES_30 autolearn=no 
	version=2.63
X-Spam-Hits: -0.9

On Wed, Jun 23, 2004 at 12:05:19AM -0700, Bart Schaefer wrote:
> On Tue, 22 Jun 2004, Daniel Muino wrote:
> 
> > If I set the file-sort to anything other than 'name' every time I hit
> > <TAB> I get no matches for 'Perl script'
> 
> There's a bug in the _path_files completion function.  See zsh-workers
> article 19867, which refers back to 19839 and 19842.
> 

Thanks Bart.

I'm using now a _path_files completion function that has PSW's patch, and it's
working great.

Daniel


--- _path_files.orig	2003-05-08 03:30:49.000000000 -0700
+++ _path_files	2004-06-23 11:43:37.000000000 -0700
@@ -120,7 +120,9 @@
 
     tmp2=()
     for tmp1 in "$pats[@]"; do
-      if [[ "$tmp1" = (#b)(*[^\$])(\(\([^\|~]##\)\)) ]]; then
+      if [[ "$tmp1" = (#b)(*[^\$])"(#q"(*)")" ]]; then
+	tmp2=( "$tmp2[@]" "${match[1]}(#q${sort}${match[2]})" )
+      elif [[ "$tmp1" = (#b)(*[^\$])(\(\([^\|~]##\)\)) ]]; then
         tmp2=( "$tmp2[@]" "${match[1]}((${sort}${match[2][3,-1]}" )
       elif [[ "$tmp1" = (#b)(*[^\$])(\([^\|~]##\)) ]]; then
         tmp2=( "$tmp2[@]" "${match[1]}(${sort}${match[2][2,-1]}" )
@@ -168,7 +170,9 @@
   fi
   tmp2=()
   for tmp1 in "$pats[@]"; do
-    if [[ "$tmp1" = (#b)(*[^\$])(\(\([^\|~]##\)\)) ]]; then
+    if [[ "$tmp1" = (#b)(*[^\$])"(#q"(*)")" ]]; then
+      tmp2=( "$tmp2[@]" "${match[1]}(#q${tmp3}${match[2]})" )
+    elif [[ "$tmp1" = (#b)(*[^\$])(\(\([^\|~]##\)\)) ]]; then
       tmp2=( "$tmp2[@]" "${match[1]}((${tmp3}${match[2][3,-1]}" )
     elif [[ "$tmp1" = (#b)(*[^\$])(\([^\|~]##\)) ]]; then
       tmp2=( "$tmp2[@]" "${match[1]}(${tmp3}${match[2][2,-1]}" )

