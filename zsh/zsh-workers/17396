From zsh-workers-return-17396-mason-zsh=primenet.com.au@sunsite.dk Wed Jul 03 17:08:50 2002
Return-Path: <zsh-workers-return-17396-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4796 invoked from network); 3 Jul 2002 17:08:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 3 Jul 2002 17:08:49 -0000
Received: (qmail 21602 invoked by alias); 3 Jul 2002 17:08:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17396
Received: (qmail 21591 invoked from network); 3 Jul 2002 17:08:41 -0000
Date: Wed, 3 Jul 2002 18:08:39 +0100
From: Adam Spiers <adam@spiers.net>
To: zsh-workers@sunsite.dk
Subject: Re: broken pipe with prompt -h
Message-ID: <20020703180839.A21276@corelli.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh-workers@sunsite.dk
References: <20020629123440.A28494@corelli.new.ox.ac.uk> <1020629171715.ZM8921@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <1020629171715.ZM8921@candle.brasslantern.com>; from schaefer@brasslantern.com on Sat, Jun 29, 2002 at 05:17:15PM +0000
X-URL: http://tigerpig.org/
X-OS: RedHat Linux
Sender: "Adam Spiers,,07775562717,020 88 30 30 35" <adam@corelli.new.ox.ac.uk>
X-Virus-Scanned-Using: AMaViS perl-11 and Sophos Antivirus

Bart Schaefer (schaefer@brasslantern.com) wrote:
> On Jun 29, 12:34pm, Adam Spiers wrote:
> } Subject: broken pipe with prompt -h
> }
> }   $ prompt -h adam2 | grep -q plain
> }   set_prompt:52: write error: broken pipe
> }   set_prompt:53: write error: broken pipe
> 
> This is a result of the changes in zsh-workers/16503 to cause bin_print()
> to report write errors.  There was a follow-on patch in 16556 to suppress
> the errors when stdout is closed.  EPIPE might be another error worthy of
> suppression.

Ahah.

> } Can anyone please tell me the correct fix?
> 
> Other than redirecting stderr, I don't think there is one.  It'd be the
> right idea to do	trap 'ERRNO=0' PIPE	but ERRNO is read-only.

I just upgraded from RedHat 7.3's rpm of 4.0.4 to 4.1.0-dev-5 and the
warning's gone.  Was that supposed to happen?

