From zsh-users-return-4253-mason-zsh=primenet.com.au@sunsite.dk Tue Sep 18 19:21:51 2001
Return-Path: <zsh-users-return-4253-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4861 invoked from network); 18 Sep 2001 19:21:50 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 18 Sep 2001 19:21:50 -0000
Received: (qmail 11454 invoked by alias); 18 Sep 2001 19:21:18 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4253
Received: (qmail 11429 invoked from network); 18 Sep 2001 19:21:15 -0000
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <010918121941.ZM8023@candle.brasslantern.com>
Date: Tue, 18 Sep 2001 12:19:41 -0700
In-Reply-To: <20010918053813.C13299@hq.newdream.net>
Comments: In reply to Will Yardley <william@hq.newdream.net>
        "Re: can't find termcap info" (Sep 18,  5:38am)
References: <20010918142514.A16873@greux.loria.fr> 
	<20010918053813.C13299@hq.newdream.net> 
	<20010918145958.A17178@greux.loria.fr> 
	<20010918062537.G13299@hq.newdream.net> 
	<20010918165111.B17411@greux.loria.fr> 
	<20010918155339.20305.qmail@web12504.mail.yahoo.com> 
	<20010918181329.A17722@greux.loria.fr>
In-Reply-To: <20010918145958.A17178@greux.loria.fr>
Comments: In reply to Vincent Lefevre <vincent@vinc17.org>
        "Re: can't find termcap info" (Sep 18,  2:59pm)
In-Reply-To: <20010918165111.B17411@greux.loria.fr>
Comments: In reply to Vincent Lefevre <vincent@vinc17.org>
        "Re: can't find termcap info" (Sep 18,  4:51pm)
In-Reply-To: <20010918155339.20305.qmail@web12504.mail.yahoo.com>
Comments: In reply to a normal guy <ee_in_co@yahoo.com>
        "Re: can't find termcap info" (Sep 18,  8:53am)
In-Reply-To: <20010918181329.A17722@greux.loria.fr>
Comments: In reply to Vincent Lefevre <vincent@vinc17.org>
        "Re: can't find termcap info" (Sep 18,  6:13pm)
X-Mailer: Z-Mail Lite (5.0.0 30July97)
To: zsh-users@sunsite.dk
Subject: Re: can't find termcap info
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Sep 18,  5:38am, Will Yardley wrote:
> 
> i don't understand this fully (perhaps bart or someone can give a more
> depth explanation), but i believe that unless you specifically compile
> zsh with ncurses (or have a version that was compiled to work with
> ncurses) it uses some sort of system of its own.

No, that's not it.

Zsh's configure looks for the smallest set of libraries that will provide
support for ZLE.  (As in smallest memory footprint, or at least that was
the original intent.)  Curses is the heavyweight of the bunch, so that is
avoided unless nothing else will work (or unless you ask configure to use
it via --with-curses-terminfo).  Zsh's configure looks for termcap first,
then terminfo, and finally curses, except on some specific platforms where
that search order is known to be sub-optimal.

So the chances are that if termcap exists and you didn't pass any options
to configure, then termcap is the only thing that zsh will understand.

On Sep 18,  2:59pm, Vincent Lefevre wrote:
> 
> > export TERMCAP=/etc/termcap (terminfo is better if it works)
> 
> greux:~> export TERMCAP=$HOME/.termcap                                <14:54:42
> greux:~> TERM=nettle                                                  <14:54:55
> rlogin: connection closed.
> 
> Why???

Here's what you do:  Log in to greux.  Start a second copy of zsh inside the
first one, so that you're no longer working directly with the login shell.
Then try the above again and see if (a) the connection still closes or (b)
you get some error messages when the "nested" shell exits.

Then tell us about it.

On Sep 18,  4:51pm, Vincent Lefevre wrote:
> >  are you sure that the termcap and / or terminfo info for your
> > terminal type is correct?
> 
> It works with Mutt, less and emacs. But well, zsh doesn't say that it is
> incorrect; it says that it can't find the termcap info.

It's entirely possible that Mutt, less, emacs, and bash are using terminfo
(which is OK) while zsh is using termcap (which has something wrong).

> nettle|nettle terminal emulator (RISC OS):\
> 	:ke=:ks=:tc=rxvt:

Are you sure there's an rxvt entry?  What happens if you do

TERM=rxvt

?  Is there any value you can assign to TERM that does *not* produce the
warning?

On Sep 18,  6:13pm, Vincent Lefevre wrote:
> 
> Here, until I installed ncurses 5.2 (which is after I compiled zsh),
> tgetent didn't seem to exist; at least, there was no man page about
> this function.

Try "man curs_termcap".  However, tgetent() is unlikely to be the problem.

