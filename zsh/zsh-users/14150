From zsh-users-return-14150-mason-zsh=primenet.com.au@sunsite.dk Wed May 20 09:08:08 2009
Return-Path: <zsh-users-return-14150-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20465 invoked from network); 20 May 2009 09:07:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 20 May 2009 09:07:17 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 38523 invoked from network); 20 May 2009 09:06:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 20 May 2009 09:06:59 -0000
Received: (qmail 22190 invoked by alias); 20 May 2009 09:06:37 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14150
Received: (qmail 22175 invoked from network); 20 May 2009 09:06:37 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 20 May 2009 09:06:37 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 3857E801E289
	for <zsh-users@sunsite.dk>; Wed, 20 May 2009 11:06:34 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly06d.srv.mailcontrol.com (MailControl) with ESMTP id n4K96WwF013524
	for <zsh-users@sunsite.dk>; Wed, 20 May 2009 10:06:32 +0100
Received: from news01 ([10.99.50.25]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 20 May 2009 10:06:32 +0100
Date: Wed, 20 May 2009 10:06:32 +0100
From: Peter Stephenson <pws@csr.com>
To: zsh-users@sunsite.dk
Subject: Re: unset IFS - zsh: segmentation fault (core dumped) zsh
Message-ID: <20090520100632.09159e11@news01>
In-Reply-To: <20090519195114.17059.qmail@smasher.org>
References: <20090518113402.12840.qmail@smasher.org>
	<20090518125753.1931c23d@news01>
	<20090519110848.12650.qmail@smasher.org>
	<200905191139.n4JBdQU8004448@news01.csr.com>
	<20090519195114.17059.qmail@smasher.org>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 20 May 2009 09:06:32.0457 (UTC) FILETIME=[44E65790:01C9D92A]
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.68.0.116
X-Virus-Scanned: ClamAV 0.94.2/9374/Wed May 20 03:44:08 2009 on bifrost
X-Virus-Status: Clean

On Wed, 20 May 2009 07:51:11 +1200 (NZST)
Atom Smasher <atom@smasher.org> wrote:
> On Tue, 19 May 2009, Peter Stephenson wrote:
> 
> > Unfortunately, we don't know what's in $PR_STUFF[FILLBAR], and other 
> > forms don't crash, so this doesn't help.
> ==============
> 
> print ${(V)PR_STUFF[FILLBAR]}
> ${(r:48::q:)}u%b%{^[[38;5;147m%}%{^O%}%{^O%}%D{%H:%M} %{^[[38;5;62m%}Auckland%{^N%}%{^[[38;5;231m%}tu%{^O%}%{^[[38;5;40m%}0.28, 0.22, 0.19%{^N%}%{^[[38;5;231m%}tu${PR_STUFF[BG_LIGHT_BLUE]}${PR_STUFF[WHITE]}AC 100%%${PR_STUFF[NO_COLOUR]}%{^[[38;5;231m%}%{^[[0m%}%{^[[38;5;231m%}t

Thanks.

I wasn't sure whether to replace the two-character ^[, which seem to occur
even in the base 64 version, with escape sequences, but it didn't actually
seem to matter as far as the crash is concerned.  This turned up one
remaining problem in the patch I posted yesterday, which I've fixed, and
I've committed it.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

