From zsh-users-return-11893-mason-zsh=primenet.com.au@sunsite.dk Sat Sep 29 11:02:01 2007
Return-Path: <zsh-users-return-11893-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8990 invoked from network); 29 Sep 2007 11:01:52 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 29 Sep 2007 11:01:52 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 59486 invoked from network); 29 Sep 2007 11:01:46 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 29 Sep 2007 11:01:46 -0000
Received: (qmail 24234 invoked by alias); 29 Sep 2007 11:01:38 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11893
Received: (qmail 24217 invoked from network); 29 Sep 2007 11:01:37 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 29 Sep 2007 11:01:37 -0000
Received: (qmail 58375 invoked from network); 29 Sep 2007 11:01:37 -0000
Received: from potato.vegetable.org.uk (HELO vegetable.org.uk) (62.197.40.130)
  by a.mx.sunsite.dk with SMTP; 29 Sep 2007 11:01:32 -0000
Received: from piglet by vegetable.org.uk with local (Exim 4.67)
	(envelope-from <piglet@stirfried.vegetable.org.uk>)
	id 1Iba4f-0004Ir-L4; Sat, 29 Sep 2007 12:01:29 +0100
Cc: vim.unix@gmail.com
To: zsh-users@sunsite.dk
Subject: Re: nohup dies
From: Tim Haynes <zsh@stirfried.vegetable.org.uk>
In-Reply-To: <30c383e70709290023x46dc7d13o2ff3904a05413496@mail.gmail.com> (Pau Amaro-Seoane's message of "Sat, 29 Sep 2007 09:23:34 +0200")
References: <vim.unix@googlemail.com>
	<30c383e70709281338x1f2609dcsdc4dd7283d387c1c@mail.gmail.com>
	<200709282056.l8SKugEA000576@pws-pc.ntlworld.com>
	<30c383e70709290023x46dc7d13o2ff3904a05413496@mail.gmail.com>
Reply-To: Tim Haynes <zsh@stirfried.vegetable.org.uk>
X-Face: ^U5&X92>b!8p*:'D#4(v,^i:%PY<{42PE:uNu+2b;B.8nWJS?s9p[*f{z#io=NN%z,#?,PFzKhpAO{Mkq{EL<:ZB<MbT5~a{"v9PmTq~@-!kSe+pA?vAug$H9w#N_`SHTU#FEf^nj<wdcy!_rb]?+k2z!#;tTw(pe"pQ0r$(,VU/ROZ)`v.3eOtgf:&j<7qlv-_o
Date: Sat, 29 Sep 2007 12:01:29 +0100
Message-ID: <861wchzqeu.fsf@potato.vegetable.org.uk>
User-Agent: Gnus/5.1008 (Gnus v5.10.8) Emacs/21.4 (gnu/linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Sender: Tim Haynes <piglet@stirfried.vegetable.org.uk>

"Pau Amaro-Seoane" <vim.unix@googlemail.com> writes:

[snip]
>>zsh creates a pipeline
>> zsh forks:
>>    In the subshell, "nohup cat ./input" is run
>> zsh forks again
>>    In the new subshell, ~pau/executables/... is run
>
>>So the "nohup" doesn't cover the second executable.
>
> can you tell me of a more robust/elegant way of doing it?

Well, let's take your original command:

(nohup) cat ./input | ~pau/executables/NB4_NoPN > diagnostic&

Why not add a nohup before the second executable in the pipe?  :

nohup cat ./input | nohup ~pau/executables/NB4_NoPN > diagnostic&

If you don't like that, then why not wrap the whole thing up in a new
invocation of a shell? :

nohup zsh -c 'cat ./input | nohup ~pau/executables/NB4_NoPN > diagnostic ' &

You could disown the job after it's been spawned, too.

While we're here, it should be observed that if you were disciplined or
pedantic enough not to be wasting a fork() running cat justonefile |, you
wouldn't have had this problem in the first place:

nohup ~pau/executables/NB4_NoPN < input > diagnostic &

> But zsh is supposed to emulate ksh, right?

And the polite bits of every other shell ;)

> the "solution" for now is to launch the simulation with ksh... or resort
> to screen... but it's a pity, I stick to zsh a lot

Screen has its place.

HTH,

~Tim
-- 
http://pig.sty.nu/
http://scot-pics.sty.nu/

