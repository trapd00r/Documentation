From zsh-workers-return-12860-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Sep 22 22:27:13 2000
Return-Path: <zsh-workers-return-12860-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24161 invoked from network); 22 Sep 2000 22:27:12 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Sep 2000 22:27:12 -0000
Received: (qmail 21096 invoked by alias); 22 Sep 2000 22:26:36 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12860
Received: (qmail 21089 invoked from network); 22 Sep 2000 22:26:35 -0000
Date: Fri, 22 Sep 2000 18:26:33 -0400
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: setjobpwd() - PATH_MAX
Message-ID: <20000922182633.A21338@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.1.2i

There seems no point in truncating.

Index: Src/jobs.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/jobs.c,v
retrieving revision 1.4
diff -u -r1.4 jobs.c
--- Src/jobs.c	2000/07/28 16:35:48	1.4
+++ Src/jobs.c	2000/09/22 22:23:31
@@ -982,15 +982,11 @@
 void
 setjobpwd(void)
 {
-    int i, l;
+    int i;
 
     for (i = 1; i < MAXJOB; i++)
-	if (jobtab[i].stat && !jobtab[i].pwd) {
-	    if ((l = strlen(pwd)) >= PATH_MAX)
-		jobtab[i].pwd = ztrdup(pwd + l - PATH_MAX);
-	    else
-		jobtab[i].pwd = ztrdup(pwd);
-	}
+	if (jobtab[i].stat && !jobtab[i].pwd)
+	    jobtab[i].pwd = ztrdup(pwd);
 }
 
 /* print pids for & */

