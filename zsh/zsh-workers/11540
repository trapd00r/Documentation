From zsh-workers-return-11540-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 23 16:11:12 2000
Return-Path: <zsh-workers-return-11540-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18977 invoked from network); 23 May 2000 16:11:11 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 23 May 2000 16:11:11 -0000
Received: (qmail 7906 invoked by alias); 23 May 2000 16:10:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11540
Received: (qmail 7899 invoked from network); 23 May 2000 16:10:56 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000523161048.ZM1121@candle.brasslantern.com>
Date: Tue, 23 May 2000 16:10:48 +0000
In-Reply-To: <1000523154455.ZM1095@candle.brasslantern.com>
Comments: In reply to "Bart Schaefer" <schaefer@candle.brasslantern.com>
        "Re: PATCH: Re: Segmentation fault 3.1.7-pre-3/4" (May 23,  3:44pm)
References: <200005230831.KAA23545@beta.informatik.hu-berlin.de> 
	<0FV000FFM9H4SI@la-la.cambridgesiliconradio.com> 
	<1000523154455.ZM1095@candle.brasslantern.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: Re: Segmentation fault 3.1.7-pre-3/4
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On May 23,  3:44pm, Bart Schaefer wrote:
} Subject: Re: PATCH: Re: Segmentation fault 3.1.7-pre-3/4
}
} I personally would prefer the following patch, but I haven't committed
} it yet.

And a good thing, too, as I just realized that it will cause SHTTY to be
closed improperly.

Sigh.

} +	    } else if (!shout) {
} +		haso = 1;
} +		oshout = shout;
} +		init_shout();
}  	    }

What horrible things would happen if `haso' were simply left as 0 here?
Then `shout' would remain open, but as it's only pointing to the fd that
is already open for SHTTY, and no other part of the code ever tests shout
for non-zero-ness (except init_io() which clobbers SHTTY anyway), there
doesn't seem to be any problem except the tiny overhead of one extra FILE
structure.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

