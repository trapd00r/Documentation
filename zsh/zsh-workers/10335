From zsh-workers-return-10335-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Mar 30 14:45:59 2000
Return-Path: <zsh-workers-return-10335-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3775 invoked from network); 30 Mar 2000 14:45:53 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Mar 2000 14:45:53 -0000
Received: (qmail 18184 invoked by alias); 30 Mar 2000 14:45:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 10335
Received: (qmail 18168 invoked from network); 30 Mar 2000 14:45:09 -0000
Date: Thu, 30 Mar 2000 16:44:58 +0200 (MET DST)
Message-Id: <200003301444.QAA02862@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: zrecompile


I overlooked one place where we need to change -r/-m into -R/-M.

And we shouldn't change options affecting parsing[1] in there, so I've
just completely removed the `emulate -L zsh'.


[1] Should we say that in the manual somewhere? That some options do
    that kind of stuff and hence their setting at the time of the call 
    to zcompile is important.

Bye
 Sven

diff -ru ../z.old/Functions/Misc/zrecompile Functions/Misc/zrecompile
--- ../z.old/Functions/Misc/zrecompile	Thu Mar 30 13:33:50 2000
+++ Functions/Misc/zrecompile	Thu Mar 30 15:01:57 2000
@@ -33,8 +33,7 @@
 # that needed re-compilation could be compiled and non-zero if compilation
 # for at least one of the files failed.
 
-emulate -L zsh
-setopt extendedglob
+setopt localoptions extendedglob
 
 local opt check quiet zwc files re file pre ret map tmp mesg pats
 
@@ -68,7 +67,7 @@
     fi
 
     files=( ${files:#*(.zwc|~)} )
-    if [[ $files[1] = -[rm] ]]; then
+    if [[ $files[1] = -[RM] ]]; then
       map=( $files[1] )
       shift 1 files
     else

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

