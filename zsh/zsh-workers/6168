From zsh-workers-return-6168-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Apr 30 09:59:10 1999
Return-Path: <zsh-workers-return-6168-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10212 invoked from network); 30 Apr 1999 09:59:09 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Apr 1999 09:59:09 -0000
Received: (qmail 16336 invoked by alias); 30 Apr 1999 09:58:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6168
Received: (qmail 16329 invoked from network); 30 Apr 1999 09:58:53 -0000
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <990430025824.ZM15661@candle.brasslantern.com>
Date: Fri, 30 Apr 1999 02:58:24 -0700
In-Reply-To: <9904300814.AA46597@ibmth.df.unipi.it>
Comments: In reply to Peter Stephenson <pws@ibmth.df.unipi.it>
        "PATCH: 3.1.5++/3.0.6 Re: Parameter substitution bug" (Apr 30, 10:14am)
References: <9904300814.AA46597@ibmth.df.unipi.it>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Peter Stephenson <pws@ibmth.df.unipi.it>,
        zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: PATCH: 3.1.5++/3.0.6 Re: Parameter substitution bug
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Apr 30, 10:14am, Peter Stephenson wrote:
} Subject: PATCH: 3.1.5++/3.0.6 Re: Parameter substitution bug
}
} This should apply to 3.0.6 as well.

It didn't, because 3.0.x doesn't handle '[' and ']' the same way.  Is
the following a correct patch, or is more extensive surgery required?

Index: Src/glob.c
===================================================================
--- glob.c	1999/04/28 05:21:34	1.1.1.5.2.3
+++ glob.c	1999/04/30 09:56:42
@@ -2203,16 +2203,14 @@
 	    *t = Inang;
 	    *s = Outang;
 	    break;
-	case '^':
-	case '#':
-	case '~':
-	    if (unset(EXTENDEDGLOB))
-		break;
 	case '(':
 	case '|':
 	case ')':
 	    if (isset(SHGLOB))
 		break;
+	case '^':
+	case '#':
+	case '~':
 	case '*':
 	case '?':
 	    for (t = ztokens; *t; t++)

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

