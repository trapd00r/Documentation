From zsh-workers-request@euclid.skiles.gatech.edu Fri Dec 20 00:39:15 1996
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 6243 invoked from network); 20 Dec 1996 00:39:13 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 20 Dec 1996 00:39:13 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id TAA18290; Thu, 19 Dec 1996 19:38:32 -0500 (EST)
Resent-Date: Thu, 19 Dec 1996 19:38:32 -0500 (EST)
Date: Fri, 20 Dec 1996 01:38:39 +0100 (MET)
From: Wolfgang Hukriede <whukriede@ifm.uni-kiel.de>
Message-Id: <199612200038.BAA18599@sally.ifm.uni-kiel.de>
To: zsh-workers@math.gatech.edu
Subject: Re: zsh-3.0.2 repacked
Resent-Message-ID: <"Ld5Nu1.0.jT4.80Uko"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2600
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hi Zoltan!

> It also contains a little fix which is included below to work around a bug
> in the NeXTStep libc which causes slow refresh.  You only need to apply
> this patch if you find zle slow when it refreshes the screen (but first
> try to unset BAUD and see if that helps).

I'm sorry, but definitely there's no such alleged bug in the NeXTStep libc.
Setting BAUD to zero fixes the jumping movement of the cursor, nothing else,
the screen output is as fast/slow as without setting BAUD.

Then, after:

        setvbuf(shout, NULL, _IOFBF, 0);

shout->_bufsiz gives ZERO, as well as shout->_base still is ZERO, in other
words, shout is unbuffered. I cannot imagine this should be different with
other libc's. Have you actually checked this?

Also, to fix that all,

        setvbuf(shout, NULL, _IOFBF, BUFSIZ);

is totally sufficient, and has the advantage, that the buffer only is
allocated if shout is actually used. (Further: imo there's really no need for
conditional compilation here.).

Cheers, till then, Wolfgang.

