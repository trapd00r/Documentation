From zsh-workers-return-5917-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Mar 24 11:11:16 1999
Return-Path: <zsh-workers-return-5917-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10933 invoked from network); 24 Mar 1999 11:11:15 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Mar 1999 11:11:15 -0000
Received: (qmail 11443 invoked by alias); 24 Mar 1999 10:42:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5917
Received: (qmail 11426 invoked from network); 24 Mar 1999 10:42:12 -0000
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: "Sven Wischnowsky" <wischnow@informatik.hu-berlin.de>,
        <zsh-workers@sunsite.auc.dk>
Subject: RE: PATCH: cleanup in zle_tricky.c
Date: Wed, 24 Mar 1999 13:41:23 +0300
Message-ID: <001601be75e2$dc8c8d50$21c9ca95@mowp.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2014.211
In-Reply-To: <199903230951.KAA18666@beta.informatik.hu-berlin.de>
Importance: Normal

> >
> > Bsically, the completion does not work with ambiguous prefix.
> In my case I
> > had /u1/informix* as well - that way _path_files took another branch.
>
> Ah, I thought you had made sure that this didn't happen because we had
> this discussion already -- and hence I didn't test for it (the real
> problem was that without globcomplete there were no matches). At that
> time I had asked if we wanted the path to expand as far as possible in
> such cases.
> Since you perceived this as a bug, the patch below makes the answer
> `yes'.
>
> > In case of `.../*.suffix', the `/.*' was replaced by `/.', that 'course
> > could not match.
>


I am sorry for this misunderstanding - obviously, I was not clear enough
-( What I intended to say, was:

the bug with .../*.suffix (* removal) happened (or had effect) only in case
of ambiguous prefix (at least so my test results). I did not mean anything
else.

Now, that I have been working with this a bit more, the result of this patch
is somewhat unexpected. Now, the /a/b/c/d expands the prefix even if nothing
would match. Returning to my expamle - the bug with /u/i/s/*.h was, that
this does match, but the match failed (because of bug). And current
/u/i/s/*.c -> /usr/include/sys/*.c is a bit too much ...

> Ok, with the patch below and the ones from 5871, 5872, and 5875: does
> everything work as you want (or expect ;-) it now? Including those
> `test/{a1,b1,x1y}' problems you mentioned?

Yes, with your great completers all works as expected - with above exeption.

May I suggest, that this change would be backed off? Probably, with
configuration option (but I fail to see, when it would be useful). If direct
completion of /a/b/c/d fails, this is the job for approximate/correcting
completion then.

To be more precise - the change makes prefix to be expanded even if nothing
matches. I did not intend it, and did not ask for it.

cheers

/andrej

P.S. Sorry for turmoil this week. But when after every patch I get different
results after pressing TAB ... :-)

