From zsh-users-return-14886-mason-zsh=primenet.com.au@zsh.org Thu Feb 25 14:15:06 2010
Return-Path: <zsh-users-return-14886-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29246 invoked by alias); 25 Feb 2010 14:15:06 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14886
Received: (qmail 280 invoked from network); 25 Feb 2010 14:15:04 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00,DKIM_SIGNED,
	DKIM_VERIFIED autolearn=ham version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 74.125.78.147 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type;
        bh=xQcjbPw6pghYKvynb+ukyEQqITdMp3PYE52VAjjqJi4=;
        b=dPzHs8i7OY2neRNjTYhuzrdejiF/CJnjUHJjvWyJkE4t/1XTXyF7e52OSg7VIpdZu9
         vF1+3zpb8DSjhhtpj6nwkbsOk4MpbcmViATG/wEYnhKtuUG8ExR0zRxemf5uyFSTtNFs
         SGnPyXHsFUNFQ1El8mCaRXdHyO4wCqco/4IQs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        b=nkqqtWqqaLY0Z/wBv34IOSHAvVRPzx+G5LqEi9HAvKb2fdYHc0yfPRNg21eY9xsCyL
         9NxINxd0wGVJnPg+ciYOtTldPlnbrgP3Cq3/vHbgaya5gtn+wRCJEak0l58tp0pYDciV
         TysoUAXW/ggEULrhsBf7Ql8idzfsKyHd8rbxQ=
MIME-Version: 1.0
In-Reply-To: <20100224052122.GA27211@s70206.gridserver.com>
References: <20100224052122.GA27211@s70206.gridserver.com>
Date: Thu, 25 Feb 2010 15:14:59 +0100
Message-ID: <237967ef1002250614h3a9c4651j89296d36d271d0b@mail.gmail.com>
Subject: Re: tab completion in an alias
From: Mikael Magnusson <mikachu@gmail.com>
To: John Magolske <listmail@b79.net>
Cc: zsh-users@zsh.org
Content-Type: text/plain; charset=UTF-8

On 24 February 2010 06:21, John Magolske <listmail@b79.net> wrote:
> I was impressed to read in the recent post on dirs & popd how
>
>    cd -<tab>
>
> allows one to tabcomplete the directory stack & scroll down through it
> with the <down> key. I'd like to wrap this in an alias that includes
> the <tab>, something like (and I know this doesn't work):
>
>    alias d='cd -       '
>
> So that I could type d, then the enter key, and be presented with the
> directory stack as a menu to scroll down through. Is there some way to
> accomplish this?

I can only think of one, but it's probably too annoying to use:
bindkey -s 'd^M' $'cd -\x09'

There are two problems here:
1) you need to hit enter pretty quickly.
2) there will be a slight pause after every d you type before it appears.

Actually that's a lie, you can do something up like this too
zle -N accept-line my_accept_line_wrapper
function my_accept_line_wrapper() {
  if [[ $BUFFER = d ]]; then
    BUFFER=
    zle -U $'cd -\x09'
    #doing the above sequence by putting the text in $BUFFER and calling
    #zle expand-or-complete doesn't work, the cursor is in the wrong position
    #setting $CURSOR to 4 doesn't seem to help, nor does zle end-of-line
  else
    zle .$WIDGET
  fi
}

-- 
Mikael Magnusson

