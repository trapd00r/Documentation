From zsh-workers-return-16955-mason-zsh=primenet.com.au@sunsite.dk Wed Apr 10 05:16:04 2002
Return-Path: <zsh-workers-return-16955-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20817 invoked from network); 10 Apr 2002 05:16:03 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 10 Apr 2002 05:16:03 -0000
Received: (qmail 4339 invoked by alias); 10 Apr 2002 05:15:54 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16955
Received: (qmail 4327 invoked from network); 10 Apr 2002 05:15:53 -0000
Message-ID: <20020410051551.57007.qmail@web10407.mail.yahoo.com>
Date: Tue, 9 Apr 2002 22:15:51 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: PATCH: _java_class
To: zsh-workers <zsh-workers@sunsite.auc.dk>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

This is a patch to add a new java class completion function.  It's not quite
right since it is uses opt{cp|classpath}.    It is intended to be used with
_java.  I'll post a separate patch for that.

-FR

Index: Completion/Unix/Type/.distfiles
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/.distfiles,v
retrieving revision 1.7
diff -r1.7 .distfiles
11a12
> _java_class
Index: Completion/Unix/Type/_java_class
===================================================================
RCS file: Completion/Unix/Type/_java_class
diff -N Completion/Unix/Type/_java_class
0a1,15
> local classpath
> #Should probably add some sort of cache.
> #First use -classpath/-cp, then CLASSPATH, then assume .
> classpath=${opt_args[-classpath]:-${opt_args[-cp]:-${CLASSPATH:-.}}}
> local c i
> #Should we call _multipart insteads of compadd
> for i in ${(z)classpath//:/ }; do
> 	if [ -f $i ] && [[ "$i" == *.(jar|zip|war|ear) ]]; then
> 		c=(${${${(M)$(_call_program jar_classes jar -tf
$i)##*.class}%%.class}:gs#/#.#})
> 		compadd -M 'r:|.=* r:|=*' -- $c
> 	elif [ -d $i ]; then
> 		c=(**/*.class(.:r:s/.class//:gs#/#.#))
> 		compadd -M 'r:|.=* r:|=*' -- $c
> 	fi
> done



__________________________________________________
Do You Yahoo!?
Yahoo! Tax Center - online filing with TurboTax
http://taxes.yahoo.com/

