From zsh-workers-return-14597-mason-zsh=primenet.com.au@sunsite.dk Thu May 31 04:58:35 2001
Return-Path: <zsh-workers-return-14597-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29945 invoked from network); 31 May 2001 04:58:34 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 31 May 2001 04:58:34 -0000
Received: (qmail 4525 invoked by alias); 31 May 2001 04:58:28 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14597
Received: (qmail 4514 invoked from network); 31 May 2001 04:58:27 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010531045756.ZM5405@candle.brasslantern.com>
Date: Thu, 31 May 2001 04:57:56 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: PATCH: An alternative nroff fix to 12724
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Add a single space in a strategic spot, and you prevent yodl from running
the PARAGRAPH() macro, which is where all the mess comes in.

The real root of the problem is that the macro definitions in yodl can't
be pushed on a stack, so zman.yo settles for toggling them between two
states.  Of course, when you have a startitem() nested inside another
startitem(), two states is not enough.

--- zsh-forge/current/Doc/Zsh/builtins.yo	Wed May 30 21:47:06 2001
+++ zsh-4.0/Doc/Zsh/builtins.yo	Wed May 30 21:47:20 2001
@@ -831,7 +831,7 @@
 with tt(-c) or tt(-l), with tt(-q) which clears the input queue before
 reading, or within zle where other mechanisms should be used to test for
 input.
-
+ifzman( )
 Note that read does not attempt to alter the input processing mode.  The
 default mode is canonical input, in which an entire line is read at a time,
 so usually `tt(read -t)' will not read anything until an entire line has
@@ -840,8 +840,7 @@
 character is tested, so that e.g. `tt(read -t -k 2)' can still block on the
 second character.
 )
-ifnzman(enditem()
-)
+enditem()
 If the first argument contains a `tt(?)', the remainder of this
 word is used as a var(prompt) on standard error when the shell
 is interactive.
@@ -857,7 +856,6 @@
 cancels both tt(-p) and tt(-u).
 
 The tt(-c) or tt(-l) flags cancel any and all of tt(-kpquz).
-ifzman(enditem())
 )
 cindex(parameters, marking readonly)
 alias(readonly)(typeset -r)

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

