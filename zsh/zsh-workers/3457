From zsh-workers-request@math.gatech.edu Mon Aug 25 05:37:41 1997
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 10295 invoked from network); 25 Aug 1997 05:37:39 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 25 Aug 1997 05:37:39 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id BAA15735;
	Mon, 25 Aug 1997 01:32:07 -0400 (EDT)
Resent-Date: Mon, 25 Aug 1997 01:32:07 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@frontiernet.net>
Message-Id: <199708250420.AAA03728@hzoli.home>
Subject: Re: Parsing change between 3.0.2 and 3.0.4?
In-Reply-To: <199708180110.VAA11007@cyb.org> from Josef Sachs at "Aug 17, 97 09:10:25 pm"
To: sachs@cyb.org (Josef Sachs)
Date: Mon, 25 Aug 1997 00:20:33 -0400 (EDT)
Cc: zsh-workers@math.gatech.edu
X-Mailer: ELM [version 2.4ME+ PL31 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"LmJmB.0.nr3.MZH0q"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3457
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> Was there some change in parsing between 3.0.2 and 3.0.4 that causes me
> to get this error message:
> parse error near `\n'
> when sourcing a file containing this:
> [ "${(M)TERM#xterm}" = xterm ] && \
>   {stty -istrip -ixon ; function chpwd {print -Pn "\e]2;%m: $PWD\C-g"}}

Yes, there were some brace related changes since 3.0.2 since
IGNORE_BRACES did not work properly in some cases.  Now the closing brace
has to be followed by a blank or one of ; | &

[ "${(M)TERM#xterm}" = xterm ] && \
  {stty -istrip -ixon ; function chpwd {print -Pn "\e]2;%m: $PWD\C-g"} }

But the proper syntax required by POSIX is

[ "${(M)TERM#xterm}" = xterm ] && \
  { stty -istrip -ixon ; function chpwd {print -Pn "\e]2;%m: $PWD\C-g";};}

That works even if IGNORE_BRACES is set.  I'd strongly recommend using
this syntax.

Zoltan

