From zsh-workers-return-17255-mason-zsh=primenet.com.au@sunsite.dk Wed May 29 17:27:50 2002
Return-Path: <zsh-workers-return-17255-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16028 invoked from network); 29 May 2002 17:27:50 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 29 May 2002 17:27:50 -0000
Received: (qmail 28830 invoked by alias); 29 May 2002 17:27:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17255
Received: (qmail 28817 invoked from network); 29 May 2002 17:27:36 -0000
Date: Wed, 29 May 2002 10:27:29 -0700 (PDT)
From: Bart Schaefer <schaefer@brasslantern.com>
Sender: schaefer@ns1.sodaware.com
To: Peter Stephenson <pws@csr.com>
cc: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: PATCH: Re: Odd trap return status 
In-Reply-To: <29741.1022681894@csr.com>
Message-ID: <Pine.LNX.4.44.0205291021500.2351-100000@ns1.sodaware.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 29 May 2002, Peter Stephenson wrote:

> We save and restore a whole load of status for all traps, which isn't
> necessary if they are fake traps which are never caused by signals.
> This is a minimal patch for that.

Hrm.  This seems wrong to me.  TRAPDEBUG definitely MUST NOT affect the
return code, etc., of the surrounding function.

It would seem to me that even TRAPEXIT should not change values such as
list_pipe_job and badcshglob.

> However, are execsave() and execrestore() necessary now we queue signals
> until some suitable point?

I think they still are needed, though maybe not in as many cases and
perhaps not for all the globals that currently are saved.

