From zsh-workers-return-7660-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Sep 06 10:35:31 1999
Return-Path: <zsh-workers-return-7660-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18202 invoked from network); 6 Sep 1999 10:35:29 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Sep 1999 10:35:29 -0000
Received: (qmail 256 invoked by alias); 6 Sep 1999 10:35:24 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7660
Received: (qmail 248 invoked from network); 6 Sep 1999 10:35:22 -0000
Message-Id: <199909061035.MAA322209@hydra.ifh.de>
X-Authentication-Warning: hydra.ifh.de: pws owned process doing -bs
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: PATCH: 3.1.6-pws-3: cap modules.
Date: Mon, 06 Sep 1999 12:35:20 +0200
From: Peter Stephenson <pws@ifh.de>

This updates the cap module in accordance with 7591.  The uninitialised
variables were harmless but gcc complained.

--- Src/Modules/cap.c~	Thu Dec 17 12:17:01 1998
+++ Src/Modules/cap.c	Mon Sep  6 11:35:34 1999
@@ -48,7 +48,7 @@
 	    ret = 1;
 	}
     } else {
-	char *result;
+	char *result = NULL;
 	ssize_t length;
 	caps = cap_get_proc();
 	if(caps)
@@ -59,7 +59,7 @@
 	} else
 	    puts(result);
     }
-    cap_free(&caps);
+    cap_free(caps);
     return ret;
 }
 
@@ -69,7 +69,7 @@
     int ret = 0;
 
     do {
-	char *result;
+	char *result = NULL;
 	ssize_t length;
 	cap_t caps = cap_get_file(*argv);
 	if(caps)
@@ -79,7 +79,7 @@
 	    ret = 1;
 	} else
 	    printf("%s %s\n", *argv, result);
-	cap_free(&caps);
+	cap_free(caps);
     } while(*++argv);
     return ret;
 }
@@ -102,7 +102,7 @@
 	    ret = 1;
 	}
     } while(*++argv);
-    cap_free(&caps);
+    cap_free(caps);
     return ret;
 }
 
-- 
Peter Stephenson <pws@ifh.de>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56100 Pisa, Italy

