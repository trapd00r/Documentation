From zsh-workers-return-8729-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Nov 22 17:44:30 1999
Return-Path: <zsh-workers-return-8729-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26443 invoked from network); 22 Nov 1999 17:44:30 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Nov 1999 17:44:30 -0000
Received: (qmail 16831 invoked by alias); 22 Nov 1999 17:44:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8729
Received: (qmail 16823 invoked from network); 22 Nov 1999 17:44:16 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <991122174412.ZM22551@candle.brasslantern.com>
Date: Mon, 22 Nov 1999 17:44:12 +0000
In-Reply-To: <38396A7D.3CEF8AE5@u.genie.co.uk>
Comments: In reply to Oliver Kiddle <opk@u.genie.co.uk>
        "PATCH: broken _netscape" (Nov 22,  4:08pm)
References: <38396A7D.3CEF8AE5@u.genie.co.uk>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Zsh workers <zsh-workers@sunsite.auc.dk>
Subject: Problems with "comparguments" (Re: PATCH: broken _netscape)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Nov 22,  4:08pm, Oliver Kiddle wrote:
} Subject: PATCH: broken _netscape
}
} _netscape in pws-9 seems to be broken. This patch fixes it to a point
} where it atleast runs without errors but for some reason, completion of
} the arguments doesn't work. I suspect that it is a bug somewhere in
} _arguments.

I may be entirely wrong, but based on a scan through the "set -x" output
when completing after "netscape -", I'd say this is the same bug that is
causing "cvs" to complete --allow-root and the directories after it.  I
suspect a parsing bug in "comparguments".

While we're on the topic, I noticed this in the manual page for "rxvt" the
other day:

       -pixmap: file[;geom]
              Specify  XPM  file  for  the  background  and  also
              optionally  specify  its  scaling  with  a geometry
              string.  Note you may need to add quotes  to  avoid
              special shell interpretation of the `;' in the com-
              mand-line; resource backgroundPixmap.

Note that here we have an option whose name actually includes a colon.  As
far as I can tell there's *no* way to represent this in the argument list
for _arguments or comparguments; perhaps _regex_arguments could deal with
it, but it doesn't appear so from a look at _apt.

The mini-language of _arg_compile could handle it:

_arg_compile args option -pixmap: follow next \
	explain "file[;scaling]" \
	means "XPM file for the background" \
	action etc.

(I'm not sure how to specify the "action" for "complete files before a
semicolon, with a quoted semicolon as the auto-suffix, and geometries
after the semicolon", and I don't have time to work it out right now.
I'd love to see it done, though.)  However, since _arg_compile presently
doesn't do anything but paste together things to pass to _arguments, it
isn't helpful that it can initially parse it ...

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

