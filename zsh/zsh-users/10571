From zsh-users-return-10571-mason-zsh=primenet.com.au@sunsite.dk Thu Aug 03 08:29:13 2006
Return-Path: <zsh-users-return-10571-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24314 invoked from network); 3 Aug 2006 08:29:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.4 (2006-07-25) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO,HTML_30_40,HTML_MESSAGE,MIME_HTML_ONLY autolearn=ham 
	version=3.1.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Aug 2006 08:29:09 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 52863 invoked from network); 3 Aug 2006 08:29:01 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Aug 2006 08:29:01 -0000
Received: (qmail 8354 invoked by alias); 3 Aug 2006 08:28:54 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 10571
Received: (qmail 8344 invoked from network); 3 Aug 2006 08:28:53 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 3 Aug 2006 08:28:53 -0000
Received: (qmail 51858 invoked from network); 3 Aug 2006 08:28:53 -0000
Received: from mk-ironport-4.mail.uk.tiscali.com (212.74.114.32)
  by a.mx.sunsite.dk with SMTP; 3 Aug 2006 08:28:51 -0000
Received: from 88-108-35-223.dynamic.dsl.as9105.com (HELO mk-smarthost-8.mail.uk.tiscali.com) ([88.108.35.223])
  by mk-ironport-4.mail.uk.tiscali.com with ESMTP; 03 Aug 2006 09:28:49 +0100
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: Aa4HAIBP0USCe4VPaYEZLA
Received: from 88-108-35-223.dynamic.dsl.as9105.com ([88.108.35.223]:32826)
	by mk-smarthost-8.mail.uk.tiscali.com with esmtp (Exim 4.30)
	id 1G8YZS-0000XG-IL; Thu, 03 Aug 2006 08:28:46 +0000
Message-ID: <44D1C210.3020302@sheffield.ac.uk>
Date: Thu, 03 Aug 2006 10:29:52 +0100
From: Nathan Haigh <n.haigh@sheffield.ac.uk>
User-Agent: Thunderbird 1.5.0.5 (X11/20060719)
MIME-Version: 1.0
To: Peter Stephenson <p.w.stephenson@ntlworld.com>
CC:  zsh-users@sunsite.dk
Subject: Re: autocompletion of file url's
References: <44D11FDF.5060000@sheffield.ac.uk> <20060802223421.a65ccae4.p.w.stephenson@ntlworld.com>
In-Reply-To: <20060802223421.a65ccae4.p.w.stephenson@ntlworld.com>
X-Enigmail-Version: 0.94.0.0
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
</head>
<body bgcolor="#ffffff" text="#000000">
eak!<br>
<br>
When i said "I have no idea where to start" i really meant it!
Therefore i have a few questions...see my comments within your reply.<br>
FYI: i have a debian system with zsh v4.2.5-7 (from a deb package)
installed....in the meantime i'll update this to v4.3.2 available via
the zsh website.<br>
<br>
Cheers<br>
Nathan<br>
<br>
Peter Stephenson wrote:
<blockquote
 cite="mid20060802223421.a65ccae4.p.w.stephenson@ntlworld.com"
 type="cite">
  <pre wrap="">On Wed, 02 Aug 2006 22:57:51 +0100
Nathan Haigh <a class="moz-txt-link-rfc2396E" href="mailto:n.haigh@sheffield.ac.uk">&lt;n.haigh@sheffield.ac.uk&gt;</a> wrote:
  </pre>
  <blockquote type="cite">
    <pre wrap="">I've started using subversion a bit recently and it annoys the hell out
of me when you have to specify repositories etc with file urls since
autocompletion doesn't work. e.g.

svn import tmp/myproject <a class="moz-txt-link-freetext" href="file:///path/to/my/svn/repo">file:///path/to/my/svn/repo</a>
    </pre>
  </blockquote>
  <pre wrap=""><!---->
It looks like the completion function is still not all that
sophisticated, so presumably no subversion user up to now has got to
grips with the nitty gritty.  Here's your chance to become a zsh
completion wizard...
  </pre>
</blockquote>
This makes it sound like there are zsh functions already in place for
subversion, is this correct? If so, where can i find them and how do i
set my shell up to use them as i'm pretty sure they are currently not
in use on my debian machine.<br>
<blockquote
 cite="mid20060802223421.a65ccae4.p.w.stephenson@ntlworld.com"
 type="cite">
  <pre wrap="">
The despatcher for subversion commands doesn't have an explicit entry
for "import", so it tries to synthesize it from the help text and
doesn't get it right.  This adds an explicit entry.  I'm guessing the
  </pre>
</blockquote>
I assume you are talking about zsh functions for subversion command
autocompletion here? e.g. "svn che&lt;tab&gt;" completes to "svn
checkout" - again, i don't think i currently have this working - how do
i do this?<br>
<blockquote
 cite="mid20060802223421.a65ccae4.p.w.stephenson@ntlworld.com"
 type="cite">
  <pre wrap="">first argument will usually be a directory, but that can be changed if
not.  The URL completion for the second argument is standard across the
completion system and should be good enough for your purposes.
  </pre>
</blockquote>
Do you mean generic URL completion for things like
"<a class="moz-txt-link-freetext" href="file:///p">file:///p</a>&lt;tab&gt;" should already work? If so, it is not in my case
- again, how can i get it working?<br>
<blockquote
 cite="mid20060802223421.a65ccae4.p.w.stephenson@ntlworld.com"
 type="cite">
  <pre wrap="">
Say if you come across any more problems; I only use subversion very
occasionally (and the Perforce completion is a good deal more complete
:-)) but it's an important thing to get right.
  </pre>
</blockquote>
The only problem is that i'm a total newbie to this so i apologies for
my ignorance :o)<br>
<blockquote
 cite="mid20060802223421.a65ccae4.p.w.stephenson@ntlworld.com"
 type="cite">
  <pre wrap="">
I've added matching parentheses to the case statement because they
looked nicer.

Index: Completion/Unix/Command/_subversion
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_subversion,v
retrieving revision 1.19
diff -u -r1.19 _subversion
--- Completion/Unix/Command/_subversion	12 Jul 2006 02:40:54 -0000	1.19
+++ Completion/Unix/Command/_subversion	2 Aug 2006 21:33:21 -0000
@@ -34,32 +34,38 @@
         )
 
         case $cmd in;
-          add)
+          (add)
             args+=(
               '*:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g "*(^e:_svn_controlled:)"'
             )
           ;;
-          commit)
+          (commit)
             args+=(
               '*:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g "*(e:_svn_status:)"'
             )
           ;;
-          delete)
+          (delete)
             args+=(
               '*:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g ".svn(/e:_svn_deletedfiles:)"'
             )
           ;;
-          diff)
+          (diff)
             args+=(
 	      '*: : _alternative "files:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g \*\(e:_svn_status:\)" "urls:URL:_svn_urls"'
 	    )
           ;;
-          help)
+          (help)
             args+=(
               '*::sub command:_svn_commands'
             )
+	  ;;
+	  (import)
+	    args+=(
+		'1:project directory:_files -/'
+		'2:import location: _alternative "files:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a>" "urls:URL:_svn_urls"'
+	    )
           ;;
-          log)
+          (log)
             args+=(
               '1: : _alternative "files:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g \*\(e:_svn_controlled:\)" "urls:URL:_svn_urls"'
 	      '*:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g "*(e:_svn_controlled:)"'
@@ -72,17 +78,17 @@
 	    '*:path or url: _alternative "files:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a>" "urls:URL:_svn_urls"'
 	    )
 	  ;;
-          resolved)
+          (resolved)
             args+=(
               '*:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g "*(e:_svn_conflicts:)"'
             )
           ;;
-          revert)
+          (revert)
             args+=(
               '*:<a class="moz-txt-link-freetext" href="file:_files">file:_files</a> -g "(.svn|*)(/e:_svn_deletedfiles:,e:_svn_status:)"'
             )
           ;;
-          *)
+          (*)
             case $usage in
               *(SRC|DST|TARGET|URL*PATH)*)
                 args+=(

  </pre>
</blockquote>
<br>
</body>
</html>

