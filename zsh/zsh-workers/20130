From zsh-workers-return-20130-mason-zsh=primenet.com.au@sunsite.dk Sun Jul 04 17:10:27 2004
Return-Path: <zsh-workers-return-20130-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17289 invoked from network); 4 Jul 2004 17:10:26 -0000
Received: from odin.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.85)
  by ns1.primenet.com.au with SMTP; 4 Jul 2004 17:10:26 -0000
Received: (qmail 6139 invoked from network); 4 Jul 2004 18:24:15 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 4 Jul 2004 18:24:15 -0000
Received: (qmail 15317 invoked by alias); 4 Jul 2004 17:10:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20130
Received: (qmail 15307 invoked from network); 4 Jul 2004 17:10:07 -0000
Received: from odin.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.85)
  by sunsite.dk with SMTP; 4 Jul 2004 17:10:07 -0000
Received: (qmail 5942 invoked from network); 4 Jul 2004 18:24:10 -0000
Received: from cmailm4.svr.pol.co.uk (195.92.193.211)
  by a.mx.sunsite.dk with SMTP; 4 Jul 2004 18:23:57 -0000
Received: from modem-2.electric-blue-damsel.dialup.pol.co.uk ([62.137.5.2] helo=pwstephenson.fsnet.co.uk)
	by cmailm4.svr.pol.co.uk with esmtp (Exim 4.14)
	id 1BhAUz-0006hd-DM
	for zsh-workers@sunsite.dk; Sun, 04 Jul 2004 18:09:53 +0100
Received: by pwstephenson.fsnet.co.uk (Postfix, from userid 501)
	id 0537685BC; Sun,  4 Jul 2004 13:17:56 -0400 (EDT)
Received: from pwstephenson.fsnet.co.uk (localhost [127.0.0.1])
	by pwstephenson.fsnet.co.uk (Postfix) with ESMTP id DC7F184BC
	for <zsh-workers@sunsite.dk>; Sun,  4 Jul 2004 18:17:56 +0100 (BST)
To: Zsh hackers list <zsh-workers@sunsite.dk>
Subject: Re: PATCH: re-expand the prompt automatically 
In-reply-to: "Bart Schaefer"'s message of "Fri, 02 Jul 2004 14:06:21 PDT."
             <Pine.LNX.4.60.0407021402260.22788@toltec.zanshin.com> 
Date: Sun, 04 Jul 2004 18:17:55 +0100
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <20040704171756.0537685BC@pwstephenson.fsnet.co.uk>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: *
X-Spam-Status: No, hits=1.5 required=6.0 tests=BAYES_50,RCVD_IN_SORBS 
	autolearn=no version=2.63
X-Spam-Hits: 1.5

Bart Schaefer wrote:
> On Fri, 2 Jul 2004, Peter Stephenson wrote:
> 
> > Here's the tweak I just proposed to Wayne's patch
> 
> So does this mean "zle reset-prompt" goes away again?  Or does it serve
> a different purpose?

Neither, really, because you still need some way of reexpanding the
prompt when you don't get an asynchronous event.  So it serves the
purpose it always did.

> (It would seem that, with this patch, "zle -I" can be used instead of 
> reset-prompt.

That's not quite true.  zle -I invalidates the display, redrawing the
prompt below.  So at the minimum you get a new line, whether or not the
prompt changed.  zle reset-prompt reexpands the prompt on the current
line.  This is much less intrusive.

> Further, it seems odd to make reset-prompt a built-in 
> widget rather than a zle option.)

I don't understand that.  How would the option know when to reexpand the
prompt?  Are you suggesting it be tied to zle -R or zle redisplay or
both?  (Probably the latter since the former is supposed just to make
the changes requested by widgets explicit rather than refresh the
display.)  Why is that more natural?

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Work: pws@csr.com
Web: http://www.pwstephenson.fsnet.co.uk

