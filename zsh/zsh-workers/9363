From zsh-workers-return-9363-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jan 19 11:05:26 2000
Return-Path: <zsh-workers-return-9363-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20993 invoked from network); 19 Jan 2000 11:05:26 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Jan 2000 11:05:26 -0000
Received: (qmail 27780 invoked by alias); 19 Jan 2000 11:05:17 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9363
Received: (qmail 27769 invoked from network); 19 Jan 2000 11:05:12 -0000
To: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
Cc: zsh-workers@math.gatech.edu
Subject: Re: If someone wants to try...
References: <200001190859.JAA12126@beta.informatik.hu-berlin.de>
X-Attribution: adl
From: Alexandre Duret-Lutz <duret_g@epita.fr>
Date: 19 Jan 2000 12:05:09 +0100
In-Reply-To: Sven Wischnowsky's message of "Wed, 19 Jan 2000 09:59:34 +0100 (MET)"
Message-ID: <mvbln5mz5i2.fsf@phobos.lrde.epita.fr>
Lines: 39
User-Agent: Gnus/5.070096 (Pterodactyl Gnus v0.96) Emacs/20.5
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

With the three patches applied I can reproduce the following segfault.
The idea is to make a completion (here on filenames, after cat)
just before completing for $functions (it look like it will
hang only when completing the varname `$functions').

% zsh -f
phobos% autoload -U compinit; compinit
phobos% cat <TAB>
foo.tar.gz   foo.tgz      foobar/
phobos% echo $funct<TAB>
zsh: segmentation fault (core dumped)  zsh -f

(gdb) bt
#0  0x400f19db in strlen () from /lib/libc.so.6
#1  0x80a038a in taddstr (s=0x81636d3 <Address 0x81636d3 out of bounds>)
    at ../../last/Src/text.c:60
#2  0x80a19ad in gettext2 (state=0xbffff0c0) at ../../last/Src/text.c:672
#3  0x80a0576 in getpermtext (prog=0x8113d80, c=0x813d330)
    at ../../last/Src/text.c:125
#4  0x401bc602 in scanfunctions (ht=0x81146b0, func=0x8086594 <scanparamvals>, 
    flags=32, dis=0) at ../../../last/Src/Modules/parameter.c:530
#5  0x401bc696 in scanpmfunctions (ht=0x81146b0, 
    func=0x8086594 <scanparamvals>, flags=32)
    at ../../../last/Src/Modules/parameter.c:546
#6  0x806c35d in scanhashtable (ht=0x81146b0, sorted=0, flags1=0, 
    flags2=1048576, scanfunc=0x8086594 <scanparamvals>, scanflags=32)
    at ../../last/Src/hashtable.c:367
#7  0x808682e in paramvalarr (ht=0x81146b0, flags=32)
    at ../../last/Src/params.c:416
#8  0x80868fa in getvaluearr (v=0x400160c8) at ../../last/Src/params.c:434
#9  0x808971c in getarrvalue (v=0x400160c8) at ../../last/Src/params.c:1365
#10 0x809d212 in paramsubst (l=0x400160b0, n=0x400160b8, str=0xbffff400, qt=1, 
    ssub=4) at ../../last/Src/subst.c:1120
#11 0x809a293 in stringsubst (list=0x400160b0, node=0x400160b8, ssub=4)
    at ../../last/Src/subst.c:122
...

-- 
Alexandre Duret-Lutz

