From zsh-workers-return-21553-mason-zsh=primenet.com.au@sunsite.dk Sun Jul 31 17:56:34 2005
Return-Path: <zsh-workers-return-21553-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19132 invoked from network); 31 Jul 2005 17:56:30 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 31 Jul 2005 17:56:30 -0000
Received: (qmail 40704 invoked from network); 31 Jul 2005 17:56:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 31 Jul 2005 17:56:23 -0000
Received: (qmail 26458 invoked by alias); 31 Jul 2005 17:56:18 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21553
Received: (qmail 26448 invoked from network); 31 Jul 2005 17:56:17 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 31 Jul 2005 17:56:17 -0000
Received: (qmail 40107 invoked from network); 31 Jul 2005 17:56:17 -0000
Received: from cmailm3.svr.pol.co.uk (195.92.193.19)
  by a.mx.sunsite.dk with SMTP; 31 Jul 2005 17:56:11 -0000
Received: from modem-3778.parera.dialup.pol.co.uk ([81.78.190.194] helo=pwstephenson.fsnet.co.uk)
	by cmailm3.svr.pol.co.uk with esmtp (Exim 4.41)
	id 1DzI2k-0000wi-2Q
	for zsh-workers@sunsite.dk; Sun, 31 Jul 2005 18:56:10 +0100
Received: by pwstephenson.fsnet.co.uk (Postfix, from userid 501)
	id 6AD168638; Sun, 31 Jul 2005 14:03:33 -0400 (EDT)
Received: from pwstephenson.fsnet.co.uk (localhost [127.0.0.1])
	by pwstephenson.fsnet.co.uk (Postfix) with ESMTP id 48AD28635
	for <zsh-workers@sunsite.dk>; Sun, 31 Jul 2005 19:03:33 +0100 (BST)
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: PATCH: PDF and PostScript generation
Date: Sun, 31 Jul 2005 19:03:32 +0100
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <20050731180333.6AD168638@pwstephenson.fsnet.co.uk>
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.0.4

This improves PDF generation by using texi2dvi to ensure indexes and
cross-references are properly handled.

As previously threatened, I'm removing the PostScript files from the
doc distribution:  they are much bulkier than PDF, printing from the
various freely available PDF viewers allows more flexible formatting
options, and the PDF output from pdfetex is much better than the
PostScript output from dvips.

Index: Doc/Makefile.in
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/Makefile.in,v
retrieving revision 1.26
diff -u -r1.26 Makefile.in
--- Doc/Makefile.in	20 Jul 2005 16:40:03 -0000	1.26
+++ Doc/Makefile.in	31 Jul 2005 17:54:43 -0000
@@ -82,7 +82,7 @@
 all: man texi ../META-FAQ
 .PHONY: all
 
-everything: all dvi ps html pdf
+everything: all dvi html pdf
 .PHONY: everything
 
 dvi: zsh.dvi
@@ -95,7 +95,7 @@
 .PHONY: pdf
 
 zsh.pdf: $(sdir)/zsh.texi
-	$(PDFETEX) $(sdir)/zsh.texi
+	PDFTEX=$(PDFETEX) $(TEXI2DVI) --pdf $(sdir)/zsh.texi
 
 texi: $(sdir)/zsh.texi
 .PHONY: texi
@@ -120,6 +120,9 @@
 	    $(YODL) -I$(sdir) -w zman.yo version.yo $< | sed -e '1s/\\-/-/g' -e '/^\.'\''/d' > $$target \
 	;; esac; \
 
+# These targets are no longer made by default, nor
+# distributed with the -doc.tar.gz, since the PDF
+# output is generally better.  However, they still work.
 ps: us_ps a4_ps
 .PHONY: ps
 
@@ -322,7 +325,7 @@
 # ========== DEPENDENCIES FOR CLEANUP ==========
 
 clean-here:
-	rm -f *.html *.info* *.dvi *.ps
+	rm -f *.html *.info* *.dvi *.ps *.pdf
 	rm -f *.aux *.cp *.cps *.fn *.fns *.ky *.log
 	rm -f *.pg *.pgs *.toc *.tp *.tps *.vr *.vrs
 	rm -rf infodir
Index: Doc/.distfiles
===================================================================
RCS file: /cvsroot/zsh/zsh/Doc/.distfiles,v
retrieving revision 1.5
diff -u -r1.5 .distfiles
--- Doc/.distfiles	4 Feb 2005 16:59:41 -0000	1.5
+++ Doc/.distfiles	31 Jul 2005 17:54:43 -0000
@@ -14,6 +14,6 @@
 DISTFILES_DOC='
     zsh.info zsh.info-[0-9]*
     zsh.html zsh_*toc.html zsh_[0-9]*.html
-    zsh.dvi zsh_us.ps zsh_a4.ps
+    zsh.dvi
     zsh.pdf
 '

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Work: pws@csr.com
Web: http://www.pwstephenson.fsnet.co.uk

