From zsh-workers-request@euclid.skiles.gatech.edu Sat Jan 11 22:06:00 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 4567 invoked from network); 11 Jan 1997 22:05:54 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 11 Jan 1997 22:05:54 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id RAA04967; Sat, 11 Jan 1997 17:12:30 -0500 (EST)
Resent-Date: Sat, 11 Jan 1997 17:12:30 -0500 (EST)
From: Zefram <zefram@dcs.warwick.ac.uk>
Message-Id: <23659.199701112213@stone.dcs.warwick.ac.uk>
Subject: removable suffixes in ZLE
To: zsh-workers@math.gatech.edu (Z Shell workers mailing list)
Date: Sat, 11 Jan 1997 22:13:43 +0000 (GMT)
X-Patch: 192
X-Loop: zefram@dcs.warwick.ac.uk
X-Stardate: [-31]8714.63
X-US-Congress: Moronic fuckers
Content-Type: text
Resent-Message-ID: <"AE-_h.0.YD1.E11so"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2779
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

This patch modifies ZLE's removable suffix mechanism.  It is in some
respects cleaned up (e.g., addedsuffix is now *always* set if a suffix
has been added), and it no longer depends on lastcmd.  The magic behaviour
of insert commands is now handled all in one function, doinsert(), which
the insert commands all use, making the ZLE_INSERT flag unnecessary.
The ZLE_DELETE flag is also replaced; there is now a ZLE_KEEPSUFFIX flag
that is set wherever ZLE_MENUCMP or ZLE_DELETE was set.

Except in that I have made insert-last-word do suffix removal, there
should be no functional changes.

 -zefram

begin 644 suffix_patch.gz
M'XL("%33US("`W-U9F9I>%]P871C:`#M/&MWV\2VG\.OF'"XU"\YENW$B4-@
M]4*X=)&V+%KN>7!+CR*/;:W(DHXDVZ0E__WNO>>AD31R3%L*/8=`$\UHS\Q^
M[ST/3:?38<]2_^@?(3^:\3"/_:67]OT#]^QL<C1PCP8C-IA,AZ/I\/C`[0\_
M<AQG)[SK,O=X>GP\';D?=<H_6&:346]RQJC(6!#E\/LZCO.7NJ_6XWBV#CE;
MM>'5ZX\.&?X\7P;1XI9%?#M?1SZ[8-YL]BKD6,B#.&I]#,UYSIT\=K"/CWM,
M]]=C_[BZ?/G5Y=7E\\OV^4?4'0OFK"4[:\,@C!T8&$#W\AV"'Z0\7Z<1&YP3
M[0)_>'+>*_[?7EY^]^R'K[]^]+>WI*%CR!LPZ"\+R0W88#`=3:;'$Y"T.RZ)
MN@(JA'PR'9Q8A7Q\TCN9*"'?(0;P_U&'??7HV</_OKK\B@49:[F??39HL\X1
ML.@O,SX/(DZ4/KY\\L.7C[\[P/<N\M!\^?>'3[ZE-Z-VI=G5HR>7CY_^[R6]
M'5?;??OHZHK>G%3;/7KR[/+[Y_3NK/I.*(W`9-#65'SC9<O<NP89QW.6HV0#
MGO49NXRP<L:B>,8SYJ4<7L89_O9REO(Y3UD>,R5S:`&T,QSH;\\OOW]"W3ZG
M;JG/6QA"J!QR\T2IW%MQ$]4&&SY]\N`Y*._&"X.9EW/FQZL$]`^P8F&0Y0*Q
M-^*['`$Z7'G1##'SH,N(.W$:\"@'[JSB#5_!8WV09B$5VB\%52(DY=@GFA1T
MGZWG\^!GT?G[%Y?-&-S1I.>.1\H<`*/#BP%:KZ?XKG#W%/:`0+[DC`,'8P,.
MY5-&`AR0:"L:DFX<XA`N#K"%+GY.N)^S#'X'7LAN^"V0.L^!-M5GM(`!$B_U
M5ARK(_AK&41`4V>%`CX''/UUFJ(TEZ`W<7I+PF8H>GB1Q2E+XBP@Q.=00*+R
M.!%`'5)N=W1"W)'J_0%P!U1GB.T[Z-L[A$J%?:#U0<0^>=WO]^_Z;)^?]\3P
MBO-_>1U$,R`Q,^/]*1L,I\,)!`*(`I-J$+`UT2'_V![RQR>]R5BI_VL9O;YL
M?>SY/D]R!W!WEG$X@Z`G:J`"RSU&/K<.'$1@FT[$?\X=R02S*;W%E_(==7-H
MZ0:<T-I1.F;V@"]4?<_THG5TD*^Z*1:L2),#Q"%G\3:JX8QOX26^,U'6G5Q[
M_LW62V<J,U!ED1R8Q&E(F4U4&HC:6D[4W'X;I[-:>ZR\K_U-$(:*-ZH2ZP2'
ME*]O;%D9%^N*4;$E^Z6$0)U5E1Y$ZQ)3^2*((E!D)YX[U^`>0*/BU)"-!HCG
MXG6<VJ5C=F1M?G\SQ:FB35V5:@UHL'HKK"VW]+TDR"'2O]("+6HT8[0D_)![
MJ9/Y*><1@F)1E"JF4+20IJ)[E^5"9'7S\>/DUDE2OBD:);=8MB"$H"D0&4>.
MEY&"2'A1Z6589=6JLAG<J_X&..I"*/A;-(O3D)AK9T/99NZU%<@Y_#2XY@X$
M'><:DJ-Y>$OM1#74RLK&\8)%`(XL7:PQF\*F6*'*38PG#^1[68$H5&"Y;B(5
M9]7HGPA.YG@5>*PU[,;,%]L4641HD+'_0PX-TB,9T[1_KUAA$O:F\6)W'_O%
M#`N?WS*(6$7V9R!Y7X%DET#WCBR[1/E;A1H;PKL#SGU-]@TZNUBV.PHU-'F3
M2+03B?U#TR[)_8%BE6U:<SKNG;EJ6B/[YS]S?PW\QVD@..$58OWDAZNK,A8P
MK4,/#Z^=Q,N7`"-JH`++5N`"65%A#6$2%F@S@I>HC-.&*<V.QF@V,&^V]"%>
M-"49LB<I-5&JRPSFIV:HDD4=J6IPLCM9U/UA&B%$(=.(#U44NRSJ+66SR\K>
MJ[!L=G1VVG-'DXHA29XZ&40-?^FH^`M=RC?BA:HO(U%I+)&HMI75Y:;6!')W
MWAA$&4\A<?.R7)$MJK"F\+UBH=D8BK(4D1)`$RR)@CF5*0/+\&Z;29<!1;B2
MH*+0#+R%C)J;?5/%[@$DG?6DRN`+QBW0ESCP>0:P6)2E)@]$+80&R@:BT.1G
M5MXB\)TL\7Q$G4I4*,NGFLSO6-XIM[&:,+[9UZ-&?&%&02C>-SV+-SS=I@&8
M]RJ>X7"Z`LME54WB-<UX4-4`DHJB5(%;9TL`2]8$!05ZML!(%<#G>MJH(9`?
M?!;D!F2<8D69Z_]:QSDWT!-EA9_5(`A$84&%.AH"1NLW%96"F\,C1ED2>FB^
M^KF)ZP`0"[BXV@NP'_*/J@K)^GTT*5U#8L+#!-F5QJ#\&826)N",A_."95BR
M,<P&[JRC%<^]4BM1U<#LC(/R7*?<NZ$VT8R>R^1G/'=67GKCR.T<@LRQ1E8T
M,31+>.$DJ%"/*'GJ15D29R+W10^A:ZBB"1I[*D%311D:+($VCV:8TP*L+D.Q
M!AD+@(KHUU&`,O9"TX)UY7UVO$Y*B>LZL:>M`%9$F75B35D!IIZPKI-[EU9D
M6"TG1?]^876/#.?/0'MO?KE7Y-W%XW<<BG?A^A:Q>5>W>P;K74SX3XK>>[#C
M_<;S79B\\P"_2Y'NC_B[6N].`7Y=!_<E!7MP[MVG"3M'^X_,&W9QY'=.)*SG
M6<:#GCL^J4S8-X'CS684XJ';30`%?"ZC`$!Z9?TZ]*(;1=<F4/5472?0;"G7
M((HV]=T-$[R\*%NT:MH/M(YI!N.B"UM8MC:OM;13:%G+AR:6U7PZ.2/E4,[P
M/GPY6.W@#RP+JXT<@VR.+38"9$8+7DX%-X&H-=+!"C*X/"E3"@!>S>KI!``)
M/A*(>+0FBQJP$,0^AB"6],%UV/E"K^-TY\83]F)??H?V]RW`F[U@2#('AW+5
M-"3[:Z;Q(;"_2?\_'!%8+>)TU'-/S^H644F$-T%C*HS`Z]RA`WH"<IU3H:?/
MJ-:AKSE,2+D"%R43WI1,->O=!'NL6D&[E"?<RZ5R43M1(RIJ1$AP2"QF!C`6
MFT#%S-H`%A6%ODOFUO3]`V/N'@G1[\UNJVZ?N3WW[+2NV]`ZA$FPSE2I/ZRQ
M9*H$OK%@N]F)\,:*]*:&MRD*3-CU>L@F@**Y(%)?EI1-,*-7#?"Y:?$+P=?7
M61[D:^D0BV*-@FSKB117`$()"S4P3+1-B6/9D#<9@91"S0@^9"GLFNGM(Y9[
M3.E]R\EF/<.!VQL.+-9S"QDH=8(/M9&PTN%QJ"'@V0Y4B?985X[UFJ/;)4^Y
M$Z"2T&/0N%6U74+68$QX&]?V-3:2&D&+Q:42JDF<2!AXLH&)'6R]CXUZK_A7
MT_L_'/]V*?.>#-VES[\)AZM'YC$Y,L^^ESZ:.JL=EZ^"N\P=3<?'T^'$?E3>
M'?3&[DGQ?9RYX-W:Q,&L;1R4I`^].L#C3G[^D2,^"HMR%O)(?2/V#:[DXL<"
MO/B(8+4.\R`).?.],,S8%N9-+(JW3+@I.NK&\F4:KQ=+^GY`IX,)7^&'"G1N
MD_`\%CIG)^2L-QX>FT:-J/$-]L8N\&,%>@*WW6.9MU'XJ0_;D&9!?9L^HCL@
MPJ`2B(/F69["@PE%G[DA4!)GV'\F.SQ0O6']9Q?T^M-/)1&G@./8-)QWB>.K
MM\71RM?C46]\,C;YB@TEQ@+U<^.%.9*J$]@(#&?KI)4!8L(.:<D^H&E`JT1$
MUM8P8*B@._C:<23="/^CGW6[+Z!%!P:\8(]Y[K$O6*?;S=A/;#1D4WB!71P`
MF.KJ#OY*O#J(C^+Q';*%)'0\[(V/2WGM.Z3V%5H"O'!5Q2P6P`33A%?5(:R\
M(&K\?L:M?T!3@4>/,)F.Q]/!J5W@@TEO/-)?CQT<T`(L:9)@H7Q`%<)O<VY0
M)@[`T4=$'-EA?DGD,/$2H`\%O//Y//06H'"EN-4F,&$2ZC-!W!9JM<_WZX",
M3'9A?(,%U<S:3BXZF,T.6S9`.0'#CGQV>,$>P']&(\9:HOKH`?OEE]+0GS,7
MJZ2V.NX+A//;;<4Q;(S>#R;D+:.=I/BNH)NV!5:)H.4>'(\ZK]%G0E,<P)`%
M6LE04`%/#^X>&#PWL;[`KW91\'B@37XS+"4MZB&[FH7RU!?/6K(6'#U^`+8)
MF%BM6'DWG&5K^LJ1JV_%@BQZD+,L7G$*UPQ"`5]XH?@<31`+XE=+'BW!]`P8
MB6GP=1Q2#8$*QI/I0S@IN/R"B/N_"*E3<,![I]`BU-&2DM(@G)@K&5TPIL0_
MQ1BT<D`1*DQ1G&L2,`<-HD6!@.`85I,ZHZ-!*W-/=\2STW%O7!SW/,B6\7:5
M+5KP3S#\539/.2_*<\Z3EG8U=XR'&:=Z$)_S>4!2;&NG0H$YB((\`%O+N/Y^
M%M@>S`.>9CKPGD!</=,K6V^&AXQ6<[!@@8ZINT9JA>D9,4Q\82L44G36U%K[
M#S&&W8'(%V4MKXD6H.[$2,PR4+$N)7O;!*AR*4XUA$^O,[LKHTZ7_L'_1QU@
M:Y=A7@5_2E2*7*L+9'1EP"_Y!*H_L'L+>'$/:5U,`ZI<4=C]&I6H!:,@\ZW!
MZ!2"T6D]%I7!12QRW:98-!KV)GJ>IK[/?O3D)<@#*X+(#]<SSCZFRP(^5D20
M,R$6'QK[D$8R>ZA3K\@7\9MU17"F_,C1"5?%2009S'A;#W]X_O2[A]\_?/SM
MY=^?*5]>A5:^EKQQX7$%L.I>^_5RD+BP!1,SR@9"J%@T$RA7!HY9;,07U6^`
MJ9(NP#`RR*CTJML-V&>L'H5*[7U1YU-*A4_BFH=S112%+&GRQ!&B94JTB.<?
MZ=G&*HVQ;/47H]5_&<\./A?15U1^80!TC>>+!SK:*J97`K1P]1:[PBR\K?*7
MMY&8A,/^#!Y:.2=5[\[(^47.^!G,#,65&RJ'=*2^0C.EQ"J%O%,*3M$TPTA*
M^(84]S)R8*;>4$_:8VOAB9&Z(OZ&8:T9].>84+6,G5Y!SE[+V'V%*2$>"<SO
M#/-%MP&V[PYTW-G+^+O"@U'Z[3$\=@!^:X9S-XC&/9AXYDOX-5OPG'Q9M^XN
M=$(N9[IY:GH,67EN.)`;I&!`IW=4$#%FQ<9\!GHZ+SL>L^B[-)')4V,J`Z4?
MW1<_R:E,GE8F@R7%`/\N,!!AJ*HDA5[(,8%/7X9XY$1=<4"A"!*Q,%X$_I3M
M]].1O;$.>X3W(I!VX&4$UYSN,4!;Z*G;,C`+%(/UF02'/&I9@!N]R988?8IF
MXFX/:F3I]%P\4Y<5W`QLQ.*#7(UE0=[?E](CPZ906&(:0*[,5>8/[KX4AD$:
M6%?V$[XKLIQZAE,ROCTC#W1$MS0`:Q(/M3Y)PH!G+(["6W&GA41FZV7J5@NZ
M;L*\8Z)#&4V'KI(03*?C=#`U67J;(%[3K0XI"9:+*TP$U)9#8KOAF-$KCF,W
M7@@3QMFM%-&L+/BO@Q0_+@OF#==8%-W`_,+GB/#U+?ODM1H0;TT!.L0U&7?J
MA";KB*T@<3E&"1LQLD#X!E)3$#I#7D2EZUOZ.P5_7W1WC?!^2/&1.1?"-91N
M`Z%WMJS3D+MKADSWOIAYJ&.F:P9-UXR:KA$V#W78=,VXZ9J!TRTBITIU0<>>
MH@YL`UR!E\)#;^CY*#S3P"(.].(]-H`N+P0A+#%8K?@LP!3T5NIA70NL#D.(
MP3XS,$.>"(7H"K_`X#(U4CL8GM8IM0^T31/VFB7([%R&5GLX%:-5[;I516=7
M9*W"5N)K*;R"\K<RL4QYCA&*0:35TMM_M:P:E6G.(LD]1*Z"SM]D.$M!'>]>
M5'AU0TVL4YU:'EY,="BJ9C^.7O18)T$:RN,&&,=;?EN&N4[2[3)!`$UK?/;3
M!1!@SK5(UP28?Z[+:B)D67<S4X_J!`=R!__FUISB3-AP,!T>3\=#ZP)\K8&8
MY!P/I@/[;36XBS@H%EA5!H->%DT`)+^`O"461B=R&7%E%/IT!4LKCSU]39$P
M/.I-7\\C+J/*5!=!)*Q8SO+TK3[Y-F8T[YW2\>:M=LO46Q1'SBN>QMH)B'4=
M"B^E6Y+P$?<06(LV6J`O+\HDWEQ=9>0+-RS-'(^/\_ZBKU,#7$^:!1`'<KS,
M*VO+X(0I.&&USC"\Q*HW7#4]2CEN'@CO`?:]IDNX3".>K8E\/P;.^>L\`$^#
M/5:RFHYQR5-6]KUJX.T2[->\MHD<VC\_><!B_//Z`6&K<;O-L`5Z45K_*MPG
M2&09KT,(=(`UA$Z4IKP@"C^!IF%46).]Q0E)U%OG,3E/ND<*1<OS-H0RI`<4
MP\<J$)B2EX='47'18B'Y*WO#/5P14!6S;RG70MO>-T%25TKAE#OW<L@>,*U%
M1$#_Q$'Y$#_$IQ/SN*,M=$N>R)=_$>?RW5-T.1P(<(6'+>@2M;E\1`'F7D`Z
MQ=5[5*TY9A@L6$2H!5)KK[GO@<RPI[EX\ROH*LBCKUS06H_U!L&?UMIHK0V*
MJ'JS*>0;:.*;:YW0MD-Y0QOET(9/06?2[$2N>;[E8)<+CBN`N9Z^=,JWPY'Z
MHI@`NY2@R-44$/V&C+-.D,__R)9A7;P;#7JCD=Y:IE2$*%GC9:&>0JS+(O7H
MR.FK6KHV6L@%_'(V5O#E@";[MR\I?1+KT+/X908<AT2I(_L0]>)[!`.6%AM&
M+N':N!P_&9[U)J/2]C+@(8--2^_>)7&RY%Y25,C5\7^A<;75GKF,8!?5._?P
MIX:>L3LID!COP/+8[4V.2Y^V?W/Y\+N'5U=/OQ3+1[2(!6F?8DFS8';S&[2P
MW^^3;LLI&,RK0%?CFIN2UUCN*R&B\W@`9.S8[!\.3\:]X7`R4)1*8G%98\G]
M&WG;XI)L.#;N=:S>K-CO:P=2W^W18AJ<EX9X#EX)+^H,(KPC$@*^[`1_T`FV
M*(L%Q8[G<TC%$TCR<7L=<]##"_:,'#I40^HNR`5JAD#-B3Y1\YM0\QL28171
MV634@U_Z`*Z81/NX&XT]?.K[+V?KU>I6JR`:"J+LYZ&$:U=7--7JZP6F3%O4
M';$Q3Q,Y^3PH[W']#\]U=,M@C'@%Y&Z\-!`7M*;28<.@S+DAK]I7H1ZP=Y$$
M_4WKNR`!([^WN@X62L'>"SE6_^RZ9[V1.Y13#W*#KCO!*GT[*MKYLSC-'8@/
M(M:%#(_A3;5"8DZ`Y*SC=68$-I&J>RFM#@GWWVF,@H@W[9A"HUNZW!:F^9C]
MPBA!BI'_KYP6%G1/H+EJG3>Z!9]9H""VI470E4L_(#5(![(`.-0W@U87G9+=
M$Q_8]GUQ1^Y:RQK&S^6I(`JLJQZ>V@&`\P9NGXZ!M6>#T@DEO:4`OD\X:&#X
M7\4RE[QW%;@0Q>A;:4F[^&J0F*PY&V/N+U935`:IM"+K6U:T=&96$,=:099X
M.7B32.*B%P.V_-P,%.+4RU;>%CW"P^"CRFGPWX^R\I+$.Z+3OCGIGO9&P^'(
ML)\AVL_0L!\<3N%0'4UFI7I(7,'$32A7;.DVG<N@$SBA;&\<O3-6$0L"FS*S
M$TAW7..03PVA`T._Y6Y(^U,1KGW2=+>MX7QUIDD<?Y!0\JQ,6R\Z&K)PB[;%
MWI5QV&7+S=,;"($@(E-3N"L6OU/<3;O_Y1?61$JCDKT9878AC4"71N.AH5ZR
M:E2]P+(().ZY644)'9XL50M?3?F<6!13Z9A*`7\<O&C7^RL21`Q,U?6R35!9
M*QM.W9/I^.3`[9_4ULI*P/)6YS'`-W_B=C(P\HG6S1`7,\79)&5%ZM9JF8+>
M<)I"BH/Q?#8%7Q.M5]>0,D%(PV14S_I4HBIX89SND"=(Y$$6"6$>CKH9ML_-
M7>*;8=/1$=SYK9T;<:1-`T'X:=A"X*H)4IMY^,>8'Q6?G9GYR?MG22-#?C5%
MUCOOSH:]T[-)]3)OZ/C5*I[U%9<?/_WJY?/'/US1=U('I=O_RIMK^+KV5:6:
E9M'-;J=G-&#%PMYX0'50UW(DZ9Z-AB9,S6,[_P^(*YJ1364`````
`
end

-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBMtfUynD/+HJTpU/hAQHtHwQAifbuzO4kgdup69jnNgEgGGaZRDwiGqfk
wnt/RkE8IjaItZJjyUsbL8cgTrtz91BXMdmqyvIBXSdGOkVGqUlxM0MLnveQmUKl
/9rmvWnec7dyUB5AjXMi0odCBlleXkNepWCPymJ8Gb+zdTSgyTIdVomEKHXu4u95
d2wiM9pqScw=
=9AcZ
-----END PGP SIGNATURE-----

