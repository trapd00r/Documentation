From zsh-users-return-11988-mason-zsh=primenet.com.au@sunsite.dk Thu Oct 11 10:01:55 2007
Return-Path: <zsh-users-return-11988-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15256 invoked from network); 11 Oct 2007 10:01:45 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Oct 2007 10:01:45 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 32648 invoked from network); 11 Oct 2007 10:01:37 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Oct 2007 10:01:37 -0000
Received: (qmail 4918 invoked by alias); 11 Oct 2007 10:01:27 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11988
Received: (qmail 4898 invoked from network); 11 Oct 2007 10:01:26 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 11 Oct 2007 10:01:26 -0000
Received: (qmail 31384 invoked from network); 11 Oct 2007 10:01:26 -0000
Received: from mta-1.ms.rz.rwth-aachen.de (134.130.7.72)
  by a.mx.sunsite.dk with SMTP; 11 Oct 2007 10:01:20 -0000
Received: from ironport-out-1.rz.rwth-aachen.de ([134.130.3.58])
 by mta-1.ms.rz.RWTH-Aachen.de
 (Sun Java System Messaging Server 6.2-8.04 (built Feb 28 2007))
 with ESMTP id <0JPQ0028BRU7YJ10@mta-1.ms.rz.RWTH-Aachen.de> for
 zsh-users@sunsite.dk; Thu, 11 Oct 2007 12:01:19 +0200 (CEST)
Received: from relay.rwth-aachen.de ([134.130.3.1])
 by ironport-in-1.rz.rwth-aachen.de with ESMTP; Thu, 11 Oct 2007 12:01:19 +0200
Received: from numa-i.igpm.rwth-aachen.de
 (numa-i.igpm.RWTH-Aachen.DE [134.130.161.252])
	by relay.rwth-aachen.de (8.13.7/8.13.3/1) with ESMTP id l9BA1JVG028098; Thu,
 11 Oct 2007 12:01:19 +0200 (MEST)
Received: by numa-i.igpm.rwth-aachen.de (Postfix, from userid 230)
	id 015AF1072D8; Thu, 11 Oct 2007 12:01:17 +0200 (CEST)
Date: Thu, 11 Oct 2007 12:01:17 +0200 (CEST)
From: Helmut Jarausch <jarausch@igpm.rwth-aachen.de>
Subject: Re: ZSH (CVS) configure problem?
In-reply-to: <200710101024.l9AAOFA7004025@news01.csr.com>
To: Peter Stephenson <pws@csr.com>
Cc: Zsh users list <zsh-users@sunsite.dk>
Reply-to: jarausch@igpm.rwth-aachen.de
Message-id: <tkrat.27dff2f532060939@igpm.rwth-aachen.de>
MIME-version: 1.0
Content-type: TEXT/PLAIN; CHARSET=us-ascii
Content-transfer-encoding: 7BIT
Content-disposition: INLINE
X-IronPort-AV: E=Sophos;i="4.21,258,1188770400";   d="scan'208";a="27883912"
References: <tkrat.a5fb7653e65efa90@igpm.rwth-aachen.de>
 <200710101024.l9AAOFA7004025@news01.csr.com>

On 10 Oct, Peter Stephenson wrote:
> Helmut Jarausch wrote:
>> I've tried to build zsh (from CVS) with the "multibyte" configure
>> option. But in that case, the linker fails because it now needs
>> -lncursesw -ldl  instead of just -lncurses.
>> The build without this options ran just fine.
> 
> I don't understand what you're saying; configure doesn't search ncursesw
> unless you tell it to.  Do you mean configure is finding ncurses but
> linking is failing at some point?  Also, multibyte mode is now handled
> automatically if it's avilable:  what options are you changing that cause
> it to fail?  Could you say
> 
> - what arguments you're passing to configure
> - what libraries configure is coming up with
> - what error is being produced during building.

I'm using a GenToo ebuild which amounts to
	econf \
		--bindir=/bin \
		--libdir=/usr/$(get_libdir) \
		--enable-etcdir=/etc/zsh \
		--enable-zshenv=/etc/zsh/zshenv \
		--enable-zlogin=/etc/zsh/zlogin \
		--enable-zlogout=/etc/zsh/zlogout \
		--enable-zprofile=/etc/zsh/zprofile \
		--enable-zshrc=/etc/zsh/zshrc \
		--enable-fndir=/usr/share/zsh/${PV%_*}/functions \
		--enable-site-fndir=/usr/share/zsh/site-functions \
		--enable-function-subdirs \
		--enable-ldflags="${LDFLAGS}" \
		--with-tcsetpgrp \
		--with-curses-terminfo \
		--with-maildir-support \
		--with-pcre \
		--with-cap \
		--with-multibyte

The final link links the library -lncurses and fails because external
references ( I don't remember the 4 names ? add_wch) couldn't be
resolved. Linking to -lncursesw -ldl, instead, was successful.
For the moment I've stepped back to not using --with-multibyte .

Many thanks,
Helmut.

-- 
Helmut Jarausch

Lehrstuhl fuer Numerische Mathematik
RWTH - Aachen University
D 52056 Aachen, Germany

