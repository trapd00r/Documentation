From zsh-workers-return-12448-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Aug 01 07:13:05 2000
Return-Path: <zsh-workers-return-12448-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4561 invoked from network); 1 Aug 2000 07:13:04 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Aug 2000 07:13:04 -0000
Received: (qmail 21767 invoked by alias); 1 Aug 2000 07:12:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12448
Received: (qmail 21758 invoked from network); 1 Aug 2000 07:12:54 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000801071236.ZM27240@candle.brasslantern.com>
Date: Tue, 1 Aug 2000 07:12:36 +0000
In-Reply-To: <20000731231407.A32629@thelonious.new.ox.ac.uk>
Comments: In reply to Adam Spiers <adam@spiers.net>
        "missing -o kshautoload checks" (Jul 31, 11:14pm)
References: <200003131029.LAA18257@beta.informatik.hu-berlin.de> 
	<20000731231407.A32629@thelonious.new.ox.ac.uk>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Adam Spiers <adam@spiers.net>, zsh-workers@sunsite.auc.dk
Subject: Re: missing -o kshautoload checks
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Jul 31, 11:14pm, Adam Spiers wrote:
} 
} A recursive grep for '_[a-z_]* "$@"' in the Completion directory
} reveals that there are quite a few of these [[ -o kshautoload ]]
} checks missing.  I'm a bit short on time right now; any kind soul care
} to add them in?

I think there was at least a semi-conscious decision to stop including
those lines.  Chapter "Completion System" section "Initialization" heading
"Autoloaded files" explains:

  Note also that the functions for the completion system assume that the
  KSH_AUTOLOAD option is not set and cannot be loaded when it is set.  To
  avoid having to unset KSH_AUTOLOAD, you can instead use one or more zwc
  file which have been created with the command zcompile -z to load
  the functions for the completion system; see *Note Shell Builtin
  Commands::.  This forces the functions to be autoloaded the way zsh
  normally loads functions.

I haven't actually tried it, but I'm pretty sure that if you `zcompile -z'
a file that ends with `[[ -o kshautoload ]] && $0 "$@"', and you have
kshautoload set, you'll end up executing the function *twice* the first
time it's autoloaded.  So really we should be *removing* all the checks
for kshautoload, not adding more of them.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

