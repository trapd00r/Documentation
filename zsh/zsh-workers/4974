Delivered-To: mason-zsh@primenet.com.au
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
Date: Mon, 25 Jan 1999 10:51:38 +0100 (MET)
Message-Id: <199901250951.KAA13801@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: fix for compctl -y
X-Mailing-List: <zsh-workers@sunsite.auc.dk> 4974


If you have a compctl (or complist) with a display list which contains
only one string this string wasn't shown (since a single normal match
don't need to be shown).

This patch should work with any 3.1.5-pws-[1-5] (or was it [2-5]?).

Bye
 Sven

diff -c os/Zle/zle_tricky.c Src/Zle/zle_tricky.c
*** os/Zle/zle_tricky.c	Mon Jan 25 10:23:16 1999
--- Src/Zle/zle_tricky.c	Mon Jan 25 10:26:51 1999
***************
*** 5021,5029 ****
  				   &nn, &nl);
  	    g->mcount = nn;
  	    g->lcount = nn - nl;
! 	    if (g->ylist) 
  		g->lcount = arrlen(g->ylist);
! 
  	    g->expls = (Cexpl *) makearray(g->lexpls, 0, &(g->ecount), NULL);
  
  	    g->ccount = 0;
--- 4995,5004 ----
  				   &nn, &nl);
  	    g->mcount = nn;
  	    g->lcount = nn - nl;
! 	    if (g->ylist) {
  		g->lcount = arrlen(g->ylist);
! 		smatches = 2;
! 	    }
  	    g->expls = (Cexpl *) makearray(g->lexpls, 0, &(g->ecount), NULL);
  
  	    g->ccount = 0;

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

