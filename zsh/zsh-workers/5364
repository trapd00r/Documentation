From zsh-workers-return-5364-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Feb 13 14:45:51 1999
Return-Path: <zsh-workers-return-5364-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20431 invoked from network); 13 Feb 1999 14:45:49 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Feb 1999 14:45:49 -0000
Received: (qmail 20290 invoked by alias); 13 Feb 1999 14:45:26 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5364
Received: (qmail 20282 invoked from network); 13 Feb 1999 14:45:25 -0000
Message-Id: <9902131429.AA23777@ibmth.df.unipi.it>
To: Vincent Lefevre <Vincent.Lefevre@ens-lyon.fr>,
        zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: PATCH: 3.1.5*: Re: [bug] Resizing an xterm while zsh queries the user 
In-Reply-To: "Vincent Lefevre"'s message of "Sat, 13 Feb 1999 15:35:27 NFT."
             <19990213153527.A11128@vin.ens-lyon.fr> 
Date: Sat, 13 Feb 1999 15:29:37 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>

Vincent Lefevre wrote:
> It doesn't work very well. For instance:
> 
> $ echo blaj
> zsh: correct 'blaj' to 'blah' [nyae]?
> 
> If I type Ctrl-C, it displays:
> 
> zsh: correct 'blaj' to 'blah' [nyae]? ^C
> 
> but still waits for a character. Then, if I type "y", it displays nothing
> and "echo " goes to the history.

Sorry, I missed that.

--- Src/utils.c.err	Fri Feb  5 13:59:27 1999
+++ Src/utils.c	Sat Feb 13 15:26:32 1999
@@ -1160,7 +1160,7 @@
     char c;
 
     while (read(SHTTY, &c, 1) != 1) {
-	if (errno != EINTR)
+	if (errno != EINTR || errflag)
 	    return -1;
     }
     return STOUC(c);

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

