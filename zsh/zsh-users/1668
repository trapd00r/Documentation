From zsh-workers-request@math.gatech.edu Thu Jul 09 16:50:05 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2690 invoked from network); 9 Jul 1998 16:50:03 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 9 Jul 1998 16:50:03 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id MAA22738;
	Thu, 9 Jul 1998 12:32:51 -0400 (EDT)
Resent-Date: Thu, 9 Jul 1998 12:29:04 -0400 (EDT)
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <980709093010.ZM14181@candle.brasslantern.com>
Date: Thu, 9 Jul 1998 09:30:10 -0700
In-Reply-To: <19980709110457.A8279@ens-lyon.fr>
Comments: In reply to Vincent Lefevre <Vincent.Lefevre@ens-lyon.fr>
        "Completion bug with zsh 3.1.4? (-S '')" (Jul  9, 11:04am)
References: <19980709110457.A8279@ens-lyon.fr>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Vincent Lefevre <Vincent.Lefevre@ens-lyon.fr>, zsh-users@math.gatech.edu
Subject: Re: Completion bug with zsh 3.1.4? (-S '')
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"vckqP1.0.gV5.5_Efr"@math>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/1668
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Jul 9, 11:04am, Vincent Lefevre wrote:
} Subject: Completion bug with zsh 3.1.4? (-S '')
}
} In a completion, -S '' doesn't work any longer (with zsh 3.1.4).
} It behaves as if there were no -S ''.

He's right; the behavior should be to prevent a trailing space from being
appended after a completed word, but (using Misc/compctl-examples):

zsh-3.1.4> nslookup -class=  
                            ^
                            Cursor here

zsh-3.0.5> nslookup -class=
                           ^
                           Cursor here

I think the fix is this easy:

Index: zle_tricky.c
===================================================================
*** zle_tricky.c	1998/06/23 18:58:12	1.6
--- zle_tricky.c	1998/07/09 16:23:44
***************
*** 3380,3385 ****
--- 3380,3386 ----
  	    if (remsuffix && menuwe)
  		makesuffix(menuinsc);
  	}
+ 	havesuff = 1;
      } else {
  	/* There is no user-specified suffix, *
  	 * so generate one automagically.     */


-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

