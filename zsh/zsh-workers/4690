From zsh-workers-request@math.gatech.edu Tue Dec 01 05:43:33 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13428 invoked from network); 1 Dec 1998 05:43:32 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 1 Dec 1998 05:43:31 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id AAA03101;
	Tue, 1 Dec 1998 00:38:00 -0500 (EST)
Resent-Date: Tue, 1 Dec 1998 00:38:00 -0500 (EST)
Message-ID: <19981201024758.60618@athenaeum.demon.co.uk>
Date: Tue, 1 Dec 1998 02:47:58 +0000
From: Phil Pennock <phil@athenaeum.demon.co.uk>
To: Zsh Development Workers <zsh-workers@math.gatech.edu>
Subject: Non-intuitive completion
Mail-Followup-To: Zsh Development Workers <zsh-workers@math.gatech.edu>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.89.1
Organisation: Organisation?  Here?  No, over there ---->
X-Disclaimer: Any views expressed in this message, where not explicitly
	attributed otherwise, are mine and mine alone.  Such views
	do not necessarily coincide with those of any organisation
	or company with which I am or have been affiliated.
X-Phase-of-Moon: The Moon is Waxing Gibbous (91% of Full)
Resent-Message-ID: <"bxxq_2.0.Om.u2uOs"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4690
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

I've not tested this against Peter Stephenson's patched 3.1.5, only
stock release.  And I'm lost as to what's changed in the new stuff.
Also, this isn't necessarily a bug, as it's 'daft' on my part.  But the
results are counter-intuitive, to me at least.

longprompt% zsh-3.1.5 -f
athenaeum% compctl -L print
compctl: no compctl defined for print
athenaeum% print $ZSH_*<TAB>

At which point the leading $ZSH_ is completely ignored and removed, and
the * is expanded out to files in the current directory, as per usual.

Nothing special about the above choice of variable, except that <TAB>
after the Z provides the next three characters.  I'm lazy and wanted
both, so tried '*' to see what zsh would do.  I /know/ it's a filename
glob, but shouldn't the leading text have some effect instead of being
treated as null?

Notably:
athenaeum% print $ZSH_VERSION*<TAB>
beeps whilst
athenaeum% print $ZSH_VERSIO*<TAB>
loses everything before the *.

It looks as though expansion of wibble* doesn't account for wibble being
a 'variable' with null value.  Evidence:
athenaeum% FOO=
athenaeum% print $FOO*<TAB>
produces the file list.  If FOO has a non-null value, it doesn't.

Is this comprehensive enough?
-- 
--> Phil Pennock ; GAT d- s+:+ a22 C++(++++) UL++++/I+++/S+++/H+ P++@ L+++
E-@ W(+) N>++ o !K w--- O>+ M V !PS PE Y+ PGP+ t-- 5++ X+ R !tv b++>+++ DI+ D+
G+ e+ h* r y?

