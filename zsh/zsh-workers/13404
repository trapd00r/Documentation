From zsh-workers-return-13404-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 30 08:26:14 2001
Return-Path: <zsh-workers-return-13404-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26921 invoked from network); 30 Jan 2001 08:26:13 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Jan 2001 08:26:13 -0000
Received: (qmail 4008 invoked by alias); 30 Jan 2001 08:25:50 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13404
Received: (qmail 3997 invoked from network); 30 Jan 2001 08:25:45 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "Zsh hackers list" <zsh-workers@sunsite.dk>
Subject: RE: termcap moodule problem on Cygwin 
Date: Tue, 30 Jan 2001 11:25:41 +0300
Message-ID: <000301c08a96$3b80acf0$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
In-Reply-To: <Tc0a8890c516786f052@mailsweeper01.cambridgesiliconradio.com>
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400
Importance: Normal

Answering both Peter and Zefram:

- it is not possible to simply link termcap into libzsh and then link termcap
module against libzsh (if that is what Peter means). AFAIK it may be
impossible on Win32 (it is not Cygwin limitation)

- in any case, it needs completely different configuration system to find out
exact set of libraries for every module. I am not even sure if any general
solution is possible. I have to look what libtool can do.

- even if it is possible to check for static vs. shared libtermcap (like
currently with environ) it will disable  modules (note, that on Cygwin environ
check is explicitly disabled as it is misleading there). What is worse modules
will be disabled on all systems that have static termcap/curses, and that are
possibly many SVR4-derivates, mine including :-) Having termcap/terminfo as
separate modules hardly justifies this.

- the problem is not limited to Cygwin (obviously). Depending of used terminal
library program may crash, echotc may not track terminal changes or everything
may be O.K. You cannot tell in advance, sigh.

- finally, having the whole terminal related code in main zsh and moving just
a single builtin in seperate module looks funny.

what we can do know is

- add wrappers for tgetent & Co. and add note to zsh-development-guide that
people should not use original functions.

- move termcap (and terminfo) back into main zsh.

Somehow I'm inclined to the latter.

cheers

-andrej

