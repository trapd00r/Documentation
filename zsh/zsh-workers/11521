From zsh-workers-return-11521-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 23 03:13:22 2000
Return-Path: <zsh-workers-return-11521-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10343 invoked from network); 23 May 2000 03:13:20 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 23 May 2000 03:13:20 -0000
Received: (qmail 13356 invoked by alias); 23 May 2000 03:13:07 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11521
Received: (qmail 13346 invoked from network); 23 May 2000 03:13:06 -0000
Message-ID: <20000523031303.27094.qmail@web1303.mail.yahoo.com>
Date: Mon, 22 May 2000 20:13:03 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: BUG: using z parameter expansion flag in a completion function
To: zsh-workers <zsh-workers@sunsite.auc.dk>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

There seems to be a bug when using the z parameter expansion flag in
a completion function:
host% bindkey -e; autoload -U compinit; compinit -D 
host% _tst () { compadd --  ${(z)history[1]} }
host% compdef _tst tst
host% tst a<TAB>

Generates many of these error messages:
	BUG: attempt to free storage at invalid address

Here's the stack trace from the first error:

#0  zfree (p=0x18c2f0, sz=0) at mem.c:1066
#1  0x75f84 in free (p=0x18c2f0) at mem.c:1135
#2  0x65630 in lexrestore () at lex.c:292
#3  0x130be0 in docomplete (lst=0) at zle_tricky.c:780
#4  0x12e6fc in expandorcomplete (args=0x167bd8) at zle_tricky.c:287
#5  0x12e120 in completecall (args=0x167bd8) at zle_tricky.c:181
#6  0x11e86c in execzlefunc (func=0x165b94, args=0x167bd8) at zle_main.c:645
#7  0x11e3a0 in zleread (lp=0x174da0 "%m%# ", rp=0x0, flags=3)
    at zle_main.c:564
#8  0x5e2e8 in inputline () at input.c:265
#9  0x5e0b4 in ingetc () at input.c:210
#10 0x52e4c in ihgetc () at hist.c:242
#11 0x6673c in gettok () at lex.c:621
#12 0x658ec in yylex () at lex.c:337
#13 0x88fd4 in parse_event () at parse.c:421
#14 0x5a0e0 in loop (toplevel=1, justonce=0) at init.c:121
#15 0x23ce8 in main (argc=2, argv=0xefffed5c) at ./main.c:86


-FR.


__________________________________________________
Do You Yahoo!?
Send instant messages & get email alerts with Yahoo! Messenger.
http://im.yahoo.com/

