From zsh-workers-return-23412-mason-zsh=primenet.com.au@sunsite.dk Thu May 10 09:40:02 2007
Return-Path: <zsh-workers-return-23412-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8625 invoked from network); 10 May 2007 09:39:59 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.0 (2007-05-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=no
	version=3.2.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 10 May 2007 09:39:59 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 71158 invoked from network); 10 May 2007 09:39:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 10 May 2007 09:39:52 -0000
Received: (qmail 22139 invoked by alias); 10 May 2007 09:39:49 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23412
Received: (qmail 22129 invoked from network); 10 May 2007 09:39:49 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 10 May 2007 09:39:49 -0000
Received: (qmail 70914 invoked from network); 10 May 2007 09:39:49 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 10 May 2007 09:39:45 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly20c.srv.mailcontrol.com (MailControl) with ESMTP id l4A9ZA8X011873
	for <zsh-workers@sunsite.dk>; Thu, 10 May 2007 10:39:31 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Thu, 10 May 2007 10:38:35 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.8/8.13.4) with ESMTP id l4A9cZU7001084
	for <zsh-workers@sunsite.dk>; Thu, 10 May 2007 10:38:35 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.8/8.13.8/Submit) with ESMTP id l4A9cZbC001081
	for <zsh-workers@sunsite.dk>; Thu, 10 May 2007 10:38:35 +0100
Message-Id: <200705100938.l4A9cZbC001081@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: Prompt redrawing bug with ctrl-d 
In-reply-to: <200705101002.08584.arvidjaar@newmail.ru> 
References: <237967ef0705010238y5155269ev1738d449460e3b90@mail.gmail.com> <200705100018.58161.arvidjaar@newmail.ru> <200705101002.08584.arvidjaar@newmail.ru>
Comments: In-reply-to Andrey Borzenkov <arvidjaar@newmail.ru>
   message dated "Thu, 10 May 2007 10:02:03 +0400."
Date: Thu, 10 May 2007 10:38:35 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 10 May 2007 09:38:35.0612 (UTC) FILETIME=[FB17C1C0:01C792E6]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.67.0.130

Andrey Borzenkov wrote:
> OK here is the attempt to fix it. It is using use_exit_printed as flag and
> moves its resetting a bit later, so flag is available in preprompt (where
> prompt was overwritten in case promptsp). If there are no objections
> I'll commit it.

I dream about a better interface from the main shell to zle, but this
is entirely in the spirit of what we have at the moment, so it'll do
fine (until we find there's some other reason to use the same flag).

> P.S. git cvsimport still runs for over 9 hours now :)

At some point I fixed a double trashzle() that was causing the prompt to
move down a line that had been obscured by a corresponding bug somewhere
else.  It may be a side effect of that.  I can't find it at the moment,
possibly because since it was mostly to delete things it's not obvious
in the annotation.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

To get further information regarding CSR, please visit our Investor Relations page at http://ir.csr.com/csr/about/overview

