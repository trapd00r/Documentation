From zsh-users-return-14834-mason-zsh=primenet.com.au@zsh.org Sun Feb 14 20:55:15 2010
Return-Path: <zsh-users-return-14834-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28502 invoked by alias); 14 Feb 2010 20:55:15 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14834
Received: (qmail 11584 invoked from network); 14 Feb 2010 20:55:12 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at ntlworld.com designates 81.103.221.47 as permitted sender)
Message-Id: <201002142055.o1EKsxfr003143@pws-pc.ntlworld.com>
From: Peter Stephenson <p.w.stephenson@ntlworld.com>
To: Zsh Users <zsh-users@zsh.org>
Subject: Re: Standard 'filtering' mechanism?
In-Reply-To: Message from "Benjamin R. Haskell" <zsh@benizi.com>
   of "Sun, 14 Feb 2010 15:05:17 EST." <alpine.LNX.2.01.1002141420590.2729@hp.internal>
Date: Sun, 14 Feb 2010 20:54:59 +0000
X-Cloudmark-Analysis: v=1.1 cv=W3tOLUehizD4qj6VhtReFuw5MKb8d+XqjIxlDsIazEA= c=1 sm=0 a=Xt3Vk0zSdBwA:10 a=NLZqzBF-AAAA:8 a=dKZCu9HnXteFziHLzj4A:9 a=SU_8dRE9nY9GhMTnakk02KvFLpoA:4 a=_dQi-Dcv4p4A:10 a=HpAAvcLHHh0Zw7uRqdWCyQ==:117

"Benjamin R. Haskell" wrote:
> I'm still getting acquainted with the intricacies of Zsh completion and 
> pattern matching.  One thing I've wanted to do for a while is prevent 
> 'vim' completion from matching the various 'junk' files that are 
> associated with various phases of TeX compilation.

If I've worked out correctly what you're trying to do (exclude files
which have the same basename as a .tex file), how about something like
this...


vim-files() {
  local dir
  if [[ $PREFIX = */* ]]; then
    if [[ $PREFIX[-1] = / ]]; then
      dir=$PREFIX[1,-2]
    else
      dir=${PREFIX:h}
    fi
  else
    dir=.
  fi
  local -a texfiles nontexfiles
  local -aU suffixes
  texfiles=($dir/*.tex(N))
  if (( $#texfiles )); then
    notexfiles=(${texfiles:r}.*)
    suffixes=(${${notexfiles:e}:#tex})
    reply=("^*.(${(j.|.)suffixes})")
  fi
}
zstyle -e ':completion:*:*:vim:*' file-patterns vim-files


-- 
Peter Stephenson <p.w.stephenson@ntlworld.com>
Web page now at http://homepage.ntlworld.com/p.w.stephenson/

