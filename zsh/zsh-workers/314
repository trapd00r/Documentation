From zsh-workers-request@math.gatech.edu  Wed Aug 16 03:38:56 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id DAA06491 for <mason@werple.mira.net.au>; Wed, 16 Aug 1995 03:38:54 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA16951
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Tue, 15 Aug 1995 13:40:30 -0400
Received: by math (5.x/SMI-SVR4)
	id AA08449; Tue, 15 Aug 1995 13:35:33 -0400
Resent-Date: 15 Aug 1995 18:36:43 U
Old-Return-Path: <heading_anthony@jpmorgan.com>
Message-Id: <n1403628615.31686@smtpgwprod.ny.jpmorgan.com>
Date: 15 Aug 1995 18:36:43 U
From: "Heading, Anthony" <heading_anthony@jpmorgan.com>
Subject: RE: hzoli change:  $foo:s//r/
To: "Zoltan Hidvegi" <hzoli@cs.elte.hu>
Cc: zsh-workers@math.gatech.edu
X-Mailer: Mail*Link SMTP-MS 3.0.1
Resent-Message-Id: <"reGM72.0.t32.ahDCm"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/314
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Umm, I remember patching this a couple of years ago to give its recent
behaviour. It used to loop infinitely I think. The change never made it into
the manual, so I agree it's undocumented and it's quite reasonable to
change it.   But it did work, I don't consider it a bug, quite a number
of my scripts turned out to use it [they all fell over today :-( ] and I'm
a bit upset at seeing it go just to introduce an unnecessary error message.

Can't we just document it?

A
_______________________________________________________________________________
From: Zoltan Hidvegi on Tue, Aug 15, 1995 1:05 pm
Subject: Re: hzoli change:  $foo:s//r/
To: Heading Anthony
Cc: zsh-workers

Anthony Heading wrote:
> 
> Sorry I missed this first time round.
> 
> hzoli changelog of Jul 10 says:
> - $foo:s//r/ gives ... error message ... (194)
> 
> Now the following used to work
> 
> % array=(a b c d e)
> % echo $array:s//\&-\&/
> a-a b-b c-c d-d e-e
> 
> I remember I had a use for this once...

The problem is that the manual says that zsh should use the left-hand-side of
the last substitution if the substitution string is empty.  And the history
code also does this.  Also the code in hist.c which produced that feature you
describe was buggy and it sometimes got into an infinite loop (or did some
even worse thing).  So what you used so far was probably an undocumented bug.
Maybe we can find an other syntax for that.

Zoltan

