From zsh-workers-request@euclid.skiles.gatech.edu  Tue Aug 13 01:47:09 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id BAA03067 for <mason@primenet.com.au>; Tue, 13 Aug 1996 01:47:07 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id LAA07083; Mon, 12 Aug 1996 11:34:56 -0400 (EDT)
Resent-Date: Mon, 12 Aug 1996 11:34:56 -0400 (EDT)
X-Authentication-Warning: bullwinkle.tc.it.mtu.edu: jfblank owned process doing -bs
Date: Mon, 12 Aug 1996 11:33:42 -0400 (EDT)
From: Jeff Blank <jfblank@mtu.edu>
X-Sender: jfblank@bullwinkle.tc.it.mtu.edu
To: zsh-workers@math.gatech.edu
Subject: 3.0-pre6 on Alpha/Linux 2.0.x
Message-ID: <Pine.LNX.3.95.960812110949.32661A-100000@bullwinkle.tc.it.mtu.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Resent-Message-ID: <"KeAPR3.0.ck1.Wyq3o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1951
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

When compiling zsh on said Alpha, I was hit by the
#error there are some unknown limits...
in builtin.c.  Limits 0-5 are the same as under Intel-based Linux, but 6-9
are as follows...

from <asm/resource.h>:
#define RLIMIT_NOFILE   6	/* max number of open files */
#define RLIMIT_AS       7	/* address space limit(?) */
#define RLIMIT_NPROC    8	/* max number of processes */
#define RLIMIT_MEMLOCK  9	/* max locked-in-memory address space */

The patch below is how I got around the problem, but I don't know enough
about this section of code to say whether this is the correct solution.
All comments and corrections are welcome.

Jeff


*** Src/builtin.c.orig	Fri Aug  2 22:43:24 1996
--- Src/builtin.c	Sun Aug 11 00:55:15 1996
***************
*** 3607,3612 ****
--- 3607,3622 ----
  #  define NEXT_RLIM (RLIMIT_AS + 1)
      "addressspace",
  # endif /* RLIMIT_AS */
+ # if defined RLIMIT_NPROC && RLIMIT_NPROC == NEXT_RLIM
+ #  undef NEXT_RLIM
+ #  define NEXT_RLIM (RLIMIT_NPROC + 1)
+     "maxproc",
+ # endif /* RLIMIT_NPROC */
+ # if defined RLIMIT_MEMLOCK && RLIMIT_MEMLOCK == NEXT_RLIM
+ #  undef NEXT_RLIM
+ #  define NEXT_RLIM (RLIMIT_MEMLOCK + 1)
+     "memorylocked",
+ # endif /* RLIMIT_MEMLOCK */
  # if defined RLIMIT_NOFILE && RLIMIT_NOFILE == NEXT_RLIM
  #  undef NEXT_RLIM
  #  define NEXT_RLIM (RLIMIT_NOFILE + 1)

