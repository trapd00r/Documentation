From zsh-workers-return-21458-mason-zsh=primenet.com.au@sunsite.dk Thu Jul 14 03:44:42 2005
Return-Path: <zsh-workers-return-21458-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20639 invoked from network); 14 Jul 2005 03:44:41 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Jul 2005 03:44:41 -0000
Received: (qmail 89991 invoked from network); 14 Jul 2005 03:44:35 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Jul 2005 03:44:35 -0000
Received: (qmail 12588 invoked by alias); 14 Jul 2005 03:44:32 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21458
Received: (qmail 12578 invoked from network); 14 Jul 2005 03:44:30 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 Jul 2005 03:44:30 -0000
Received: (qmail 89670 invoked from network); 14 Jul 2005 03:44:30 -0000
Received: from snoopy.microcomaustralia.com.au (202.173.153.89)
  by a.mx.sunsite.dk with SMTP; 14 Jul 2005 03:44:24 -0000
Received: from localhost (localhost [127.0.0.1])
	by snoopy.microcomaustralia.com.au (Postfix) with ESMTP id 4E762D8E8B;
	Thu, 14 Jul 2005 13:44:10 +1000 (EST)
Received: from snoopy.microcomaustralia.com.au ([127.0.0.1])
	by localhost (snoopy [127.0.0.1]) (amavisd-new, port 10024) with LMTP
	id 03812-04; Thu, 14 Jul 2005 13:44:03 +1000 (EST)
Received: by snoopy.microcomaustralia.com.au (Postfix, from userid 10003)
	id E1661D8BDA; Thu, 14 Jul 2005 13:44:02 +1000 (EST)
From: Brian May <bam@snoopy.apana.org.au>
To: Bart Schaefer <schaefer@brasslantern.com>
Cc: zsh-workers@sunsite.dk
Subject: Re: [Brian May] zsh random behaviour
References: <sa4hdf2i0uq.fsf@snoopy.microcomaustralia.com.au>
 <1050711030705.ZM24700@candle.brasslantern.com>
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Date: Thu, 14 Jul 2005 13:44:02 +1000
In-Reply-To: <1050711030705.ZM24700@candle.brasslantern.com> (Bart Schaefer's message of "Mon, 11 Jul 2005 03:07:04 +0000")
Message-ID: <sa43bqi6ohp.fsf@snoopy.microcomaustralia.com.au>
User-Agent: T-gnus/6.17.2 (based on No Gnus v0.2) SEMI/1.14.6 (Maruoka) FLIM/1.14.6 (Marutamachi) APEL/10.6 Emacs/21.4 (i386-pc-linux-gnu) MULE/5.0 (SAKAKI)
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at snoopy.apana.org.au
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

>>>>> "Bart" == Bart Schaefer <schaefer@brasslantern.com> writes:

    Bart> On Jul 11, 11:32am, Brian May wrote:
    Bart> }
    Bart> } Is a return value of 255 treated specially by zsh?

    Bart> A return value > 127 is interpreted as "killed by a signal"
    Bart> where the signal number is the return value minus 127.  This
    Bart> is pretty standard for shells, though not well-documented by
    Bart> any of them.

    Bart> } I was about to start pulling my hair out, but I will let
    Bart> you pull your } hair out instead <grin>.

    Bart> See the "subtle 'echo' bug" thread from last month in the
    Bart> zsh-workers archive, finishing with the patch in article
    Bart> 21391.

I assume you mean the thread starting at
<URL:http://www.zsh.org/mla/workers/2005/msg00690.html>.

I am not sure how it is related, in this case there appears to be a
process (echo) writing its output to another process (echo) that never
reads it's stdin.

In my case though, one process is writing (or maybe not) to another
process (read) that always reads it's stdin. This second process is
suppose to return 1 if it gets EOF. So, AFAIK, SIGPIPE should not be
getting generated.

Or is it a matter that zsh is getting confused when the first process
returns 255, and aborts because it thinks the program was killed due
to a signal?

Also, there was the comment "...this only effects interactive shells",
but it my case I first encountered the problem in a shell script.
-- 
Brian May <bam@snoopy.apana.org.au>

