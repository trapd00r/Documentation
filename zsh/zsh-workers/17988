From zsh-workers-return-17988-mason-zsh=primenet.com.au@sunsite.dk Sat Dec 07 15:24:59 2002
Return-Path: <zsh-workers-return-17988-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13750 invoked from network); 7 Dec 2002 15:24:58 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 7 Dec 2002 15:24:58 -0000
Received: (qmail 23746 invoked by alias); 7 Dec 2002 15:24:48 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17988
Received: (qmail 23725 invoked from network); 7 Dec 2002 15:24:46 -0000
Date: Sat, 7 Dec 2002 10:24:12 -0500
From: Clint Adams <clint@zsh.org>
To: Bart Schaefer <schaefer@brasslantern.com>
Cc: zsh-workers@sunsite.dk, phil@fifi.org, 171716@bugs.debian.org
Subject: Re: GNU nohup oddness
Message-ID: <20021207152412.GA15901@dman.com>
References: <20021206003013.GA10400@dman.com> <1021206101446.ZM10013@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <1021206101446.ZM10013@candle.brasslantern.com>
User-Agent: Mutt/1.4i
X-Virus-Scanned: by amavisd-milter (http://amavis.org/)

> (3) In Src/init.c:init_signals(), zsh explicitly installs a SIGHUP
>     handler, even in non-interactive shells.  It has done so for a
>     very long time -- as far back as recorded in my CVS of 3.0.x,
>     which means prior to 27-Jun-97.

So is this the right thing to do?

Index: Src/init.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/init.c,v
retrieving revision 1.29
diff -u -r1.29 init.c
--- Src/init.c	13 Nov 2002 10:24:24 -0000	1.29
+++ Src/init.c	7 Dec 2002 15:22:23 -0000
@@ -897,13 +897,13 @@
     signal_ignore(SIGQUIT);
 #endif
 
-    install_handler(SIGHUP);
     install_handler(SIGCHLD);
 #ifdef SIGWINCH
     install_handler(SIGWINCH);
 #endif
     if (interact) {
 	install_handler(SIGALRM);
+	install_handler(SIGHUP);
 	signal_ignore(SIGTERM);
     }
     if (jobbing) {

