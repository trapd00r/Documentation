From zsh-workers-request@euclid.skiles.gatech.edu Tue Dec 31 08:41:17 1996
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 6335 invoked from network); 31 Dec 1996 08:41:14 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 31 Dec 1996 08:41:14 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id DAA04668; Tue, 31 Dec 1996 03:45:28 -0500 (EST)
Resent-Date: Tue, 31 Dec 1996 03:45:28 -0500 (EST)
Date: Tue, 31 Dec 1996 11:47:28 +0300 (MSK)
From: Andrej Borsenkow <borsenkow.msk@sni.de>
X-Sender: bor@itsrm1.mow.sni.de
Reply-To: borsenkow.msk@sni.de
To: Zoltan Hidvegi <hzoli@cs.elte.hu>
cc: Zsh hacking and development <zsh-workers@math.gatech.edu>
Subject: Re: zsh-3.0.3-test1 and zsh-3.1.1-test1
In-Reply-To: <199612310239.DAA07466@hzoli.ppp.cs.elte.hu>
Message-ID: <Pine.SV4.3.95.961231112412.10844B-100000@itsrm1.mow.sni.de>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Resent-Message-ID: <"l22fh3.0.q81.dADoo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2682
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

I experienced some problems with 3.1.1-test1. I am using Sinix 5.42 with
native C-DS compiler and GNU make 3.75. I have to use gmake, because I
make both static and dynamic version from single source and our make
doesn't handle VPATH :-(

Here is the story:

I. Static version.
 1. gmake doesn't make anything for $(MODBINS) (aka modules-bltin) target;
    that is, zsh just doesn't include any compiled modules. Here is
    excerpt from running gmake (note also sed error):


 ....
cc -W0 -c -I.. -I. -I../../zsh-3.1.1/Src -IModules -IZle -I../../zsh-3.1.1/Src/Zle  -DHAVE_CONFIG_H -O2  -o hist.o ../../zsh-3.1.1/Src/hist.c                   
Creating `bltinmods.list'.                                                      
sed: Cannot open modules-bltin: No such file or directory                       
sed: Label too long: :1;/\\$/{N;s/\\\n//;b1;};s/        / /g;/^ *$/d;/^[^#:>]*>[^#:>]*$/{s/>.*//;p;}                                                            
`zshpaths.h' is up to date.                                                     
Creating `zshxmods.h'.                                                          
sed: Cannot open modules-bltin: No such file or directory                       
sed: Label too long: :1;/\\$/{N;s/\\\n//;b1;};s/        / /g;/^ *$/d;/^[^#:>]*>[^#:>]*$/{s/>.*//;p;}                                                            
cc -W0 -c -I.. -I. -I../../zsh-3.1.1/Src -IModules -IZle -I../../zsh-3.1.1/Src/Zle  -DHAVE_CONFIG_H -O2  -o init.o ../../zsh-3.1.1/Src/init.c                   
  ......

    If I go into Src and do "gmake modules-bltin" it tells me
    "modules-bltin is up to date". Funny enough, our native make works in
    this case ;)

  2. Some problems with texi documentation

  ...

Making info file `zsh.info' from `../../zsh-3.1.1/Doc/zsh.texi'.                
../../zsh-3.1.1/Doc/zsh.texi:5295: This `table' doesn't have a matching `@end table'.                                                      
../../zsh-3.1.1/Doc/zsh.texi:6835: Unknown command `br'.                        
../../zsh-3.1.1/Doc/zsh.texi:6835: Misplaced `{'.                               
../../zsh-3.1.1/Doc/zsh.texi:6835: Misplaced `}'.                               
Info documentation cannot be compiled without makeinfo.                         
You can find precompiled info files in zsh-doc.tar.gz.                 
 
  ...

   I have texinfo-3.9 (makeinfo 1.67).

II. Dynamic version
 1. The same problem with mudules-bltin
 2. The same problem with makeinfo
 3. libzsh is not linked with any library; as I already said, we have
    static versions of some libraries (notably termcap; libc is also
    spplitted in static and dynamic parts). It generates run time error
    for any function, defined in this static libraries.

    Is there any objection against linking zsh against -lzsh and libzsh 
    against $(LIBS)? If it won't break things somewhere  else, it will add
    one more plattform on which zsh compiles out of the box.

  4. For some reasons compctl.so fails to load. I can load all other
     modules just fine. I don't know, how it was in 3.1.0, because
     this versions didn't run on my system (couldn't resolve trashzle at
     runtime). I have no idea, how to debug it - it all happens in
     dlload(); could it possibly be related to the problem with
     modules-bltin?

greetings


-------------------------------------------------------------------------
Andrej Borsenkow 		Fax:   +7 (095) 252 01 05
SNI ITS Moscow			Tel:   +7 (095) 252 13 88

NERV:  borsenkow.msk		E-Mail: borsenkow.msk@sni.de
-------------------------------------------------------------------------


