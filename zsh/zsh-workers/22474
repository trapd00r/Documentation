From zsh-workers-return-22474-mason-zsh=primenet.com.au@sunsite.dk Tue May 30 22:29:49 2006
Return-Path: <zsh-workers-return-22474-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20735 invoked from network); 30 May 2006 22:29:45 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.2 (2006-05-25) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.2
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 30 May 2006 22:29:45 -0000
Received: (qmail 70873 invoked from network); 30 May 2006 22:29:39 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 30 May 2006 22:29:39 -0000
Received: (qmail 14900 invoked by alias); 30 May 2006 22:29:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22474
Received: (qmail 14890 invoked from network); 30 May 2006 22:29:36 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 30 May 2006 22:29:36 -0000
Received: (qmail 70525 invoked from network); 30 May 2006 22:29:36 -0000
Received: from mta09-winn.ispmail.ntl.com (HELO mtaout03-winn.ispmail.ntl.com) (81.103.221.49)
  by a.mx.sunsite.dk with SMTP; 30 May 2006 22:29:35 -0000
Received: from aamtaout01-winn.ispmail.ntl.com ([81.103.221.35])
          by mtaout03-winn.ispmail.ntl.com with ESMTP
          id <20060530222933.IPHA27969.mtaout03-winn.ispmail.ntl.com@aamtaout01-winn.ispmail.ntl.com>
          for <zsh-workers@sunsite.dk>; Tue, 30 May 2006 23:29:33 +0100
Received: from pwslaptop.csr.com ([81.107.41.155])
          by aamtaout01-winn.ispmail.ntl.com with ESMTP
          id <20060530222933.WGSO19763.aamtaout01-winn.ispmail.ntl.com@pwslaptop.csr.com>
          for <zsh-workers@sunsite.dk>; Tue, 30 May 2006 23:29:33 +0100
Received: from pwslaptop.csr.com (pwslaptop.csr.com [127.0.0.1])
	by pwslaptop.csr.com (8.13.6/8.13.4) with ESMTP id k4UMTPiv031244
	for <zsh-workers@sunsite.dk>; Tue, 30 May 2006 23:29:27 +0100
Message-Id: <200605302229.k4UMTPiv031244@pwslaptop.csr.com>
From: Peter Stephenson <p.w.stephenson@ntlworld.com>
To: zsh-workers@sunsite.dk
Subject: Re: Vanishing files ? 
In-Reply-To: Message from Peter Stephenson <pws@csr.com> 
   of "Tue, 30 May 2006 18:48:59 BST." <20060530184859.1185ebdc.pws@csr.com> 
Date: Tue, 30 May 2006 23:29:25 +0100

Peter Stephenson wrote:
> To fix this properly we need to be able to display two properly formatted
> strings in an error message: it's many, many years past the point where
> error messages should have used variable-length argument lists.  This would
> be a nice, self-contained project for someone; we can probably assume
> stdarg is available now (since we seem to assume a lot of ISO C elsewhere).

OK, guess what...  This was not the most interesting hour and a half of
my life.  I won't bore you with the patch, instead check it straight in;
see changes in utils.c for the important bit.  It's possible I've
mistyped something, so please create as many errors as possible to
check...

If anyone wants to supplement this with varargs support, be my guest.
gcc 4 doesn't even support it any more, but it would extend the backward
compatibility back a bit further.

-- 
Peter Stephenson <p.w.stephenson@ntlworld.com>
Web page now at http://homepage.ntlworld.com/p.w.stephenson/

