From zsh-workers-return-11401-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 16 08:03:26 2000
Return-Path: <zsh-workers-return-11401-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9359 invoked from network); 16 May 2000 08:03:23 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 16 May 2000 08:03:23 -0000
Received: (qmail 23836 invoked by alias); 16 May 2000 08:03:17 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11401
Received: (qmail 23828 invoked from network); 16 May 2000 08:03:17 -0000
Date: Tue, 16 May 2000 10:03:06 +0200 (MET DST)
Message-Id: <200005160803.KAA23295@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Mon, 15 May 2000 16:06:04 +0100
Subject: Re: Odd autoremoveslash behaviour


Peter Stephenson wrote:

> I don't think this is anything I've done...  it may be only with menu
> completion:
> 
> % echo <TAB>
> % echo dir1/
> dir1/ dir2/
> 
> type `/':
> 
> % echo /
>       ^gorn.

(Hey, super woody word...)


Oops. That was a more general problem, caused by the ^G-change, it
didn't accept the currently inserted match when a normal character was 
pressed (and the undid it).

One question is if typing a character should make it be inserted
directly after the match (as in menucompletion) or if it should first
really accept the match as in a completion with only one match. After
very little testing I decided to make it be really accepted, but that
can be changed if our menu-completion experts say that we should...

Bye
 Sven

Index: Src/Zle/complist.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/complist.c,v
retrieving revision 1.15
diff -u -r1.15 complist.c
--- Src/Zle/complist.c	2000/05/11 08:40:11	1.15
+++ Src/Zle/complist.c	2000/05/16 08:02:46
@@ -2112,6 +2112,7 @@
 	    continue;
 	} else {
 	    ungetkeycmd();
+	    acc = 1;
 	    break;
 	}
 	do_single(**p);

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

