From zsh-workers-return-5423-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Feb 19 09:24:33 1999
Return-Path: <zsh-workers-return-5423-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1794 invoked from network); 19 Feb 1999 09:24:32 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Feb 1999 09:24:32 -0000
Received: (qmail 3663 invoked by alias); 19 Feb 1999 09:23:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5423
Received: (qmail 3651 invoked from network); 19 Feb 1999 09:23:56 -0000
Date: Fri, 19 Feb 1999 10:23:14 +0100 (MET)
Message-Id: <199902190923.KAA09591@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: compadd end-of-options


The patch below makes `compadd' accept both `--' and `-' as a marker for 
the end-of-options, the way `print' and `echo' behave (I hadn't
noticed that they accept a single hyphen for that).

Bye
 Sven

--- os/Zle/compctl.c	Mon Feb 15 12:51:55 1999
+++ Src/Zle/compctl.c	Fri Feb 19 10:17:31 1999
@@ -1685,6 +1685,10 @@
 	return 1;
     }
     for (; *argv && **argv ==  '-'; argv++) {
+	if (!(*argv)[1]) {
+	    argv++;
+	    break;
+	}
 	for (p = *argv + 1; *p; p++) {
 	    sp = NULL;
 	    dm = 0;
--- od/Zsh/compwid.yo	Tue Feb 16 15:02:19 1999
+++ Doc/Zsh/compwid.yo	Fri Feb 19 10:22:32 1999
@@ -300,7 +300,7 @@
 option tt(AUTO_MENU) is set, the completion code will immediatly
 switch to menucompletion.
 )
-item(tt(--))(
+item(tt(-), tt(--))(
 This flag ends the list of flags and options. All arguments after it
 will be taken as the words to use as matches even if they begin with
 hyphens.

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

