From zsh-users-return-3593-mason-zsh=primenet.com.au@sunsite.dk Thu Jan 25 09:33:22 2001
Return-Path: <zsh-users-return-3593-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8392 invoked from network); 25 Jan 2001 09:33:20 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Jan 2001 09:33:20 -0000
Received: (qmail 10378 invoked by alias); 25 Jan 2001 09:33:07 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 3593
Received: (qmail 10367 invoked from network); 25 Jan 2001 09:33:07 -0000
Message-ID: <23649114.980415184798.JavaMail.wls@webwl02>
Date: Thu, 25 Jan 2001 09:33:04 +0000 (GMT+00:00)
From: Tarmo =?ISO-8859-1?Q?J=E4rvi?= <tarmoj@iobox.com>
To: zsh-users@sunsite.auc.dk
Subject: process limit/su problem
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Hello dear list,

I have following lines in /etc/zshenv to prevent fork-bombing etc by ordinary users :

if [ `id -gn` = `id -un` -a `id -u` -gt 14 ]
then
        ulimit -H -u 64 -c 65536 -f 2097152 -n 128
else
        ulimit -u 2048 -c 65536 -f 4194394 -n 1024
fi

Everything works nicely except 'su root' (by few selected "power users"). Usually my server is running about 100 processes owned by root. When I'm logged in as, for example, tarmoj and do 'su root',  I get following errors:

/etc/zshenv: fork failed: resource temporarily unavailable [33]

So, obviously, the process limit for user is limiting the execution of /etc/zshenv etc and thus (as root after 'su' )I have to manually set  higher process limit and set other variables.

So, my question is, is there any other way to prevent this (otherthan ssh root@localhost)?

