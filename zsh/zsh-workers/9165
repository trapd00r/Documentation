From zsh-workers-return-9165-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Dec 29 02:57:30 1999
Return-Path: <zsh-workers-return-9165-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5026 invoked from network); 29 Dec 1999 02:57:28 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 29 Dec 1999 02:57:28 -0000
Received: (qmail 11284 invoked by alias); 29 Dec 1999 02:57:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9165
Received: (qmail 11277 invoked from network); 29 Dec 1999 02:57:22 -0000
Date: Tue, 28 Dec 1999 21:57:15 -0500
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: dpkg -s style support for _dpkg
Message-ID: <19991228215715.A8279@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0i

This allows user-level configuration of how dpkg -s calls _deb_packages.

Index: Completion/Debian/_dpkg
===================================================================
RCS file: /cvs/zsh/zsh/Completion/Debian/_dpkg,v
retrieving revision 1.1.1.3
diff -u -r1.1.1.3 _dpkg
--- Completion/Debian/_dpkg	1999/12/22 17:19:44	1.1.1.3
+++ Completion/Debian/_dpkg	1999/12/29 02:53:15
@@ -1,5 +1,7 @@
 #compdef dpkg dpkg-deb
 
+local dds
+
 _dpkg_deb_args=('(--build)-b[build archive]:directory:_files -/' \
            '(-b)--build:directory:_files -/' \
            '(--contents)-c[list contents]:Debian package:_files -g \*.deb' \
@@ -20,6 +22,9 @@
            '--version[show version]' \
            '--licence[show licensing]')
 
+zstyle -s ':completion${curcontext}:deb:dpkg' status dds
+[[ "$dds" == installed ]] || dds="avail"
+
 case "$words[1]" in
 dpkg)
 _arguments -s '(--install)-i[install packages]:Debian package:_files -g \*.deb' \
@@ -38,8 +43,8 @@
            '--merge-avail[merge available]:package file:_files' \
            '--clear-avail[clear available]' \
            '--forget-old-unavail[forget uninstalled unavailable]' \
-           '(--status)-s[display package status]:packages:_deb_packages avail' \
-           '(-s)--status:packages:_deb_packages avail' \
+           '(--status)-s[display package status]:packages:_deb_packages $dds' \
+           '(-s)--status:packages:_deb_packages $dds' \
            '(--print-avail)-p[display available details]:packages:_deb_packages avail' \
            '(-p)--print-avail:packages:_deb_packages avail' \
            '(--listfiles)-L[list owned files]:packages:_deb_packages installed' \

