From zsh-workers-return-20371-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 15 09:46:55 2004
Return-Path: <zsh-workers-return-20371-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8431 invoked from network); 15 Sep 2004 09:46:54 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 15 Sep 2004 09:46:54 -0000
Received: (qmail 26924 invoked from network); 15 Sep 2004 09:46:48 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 15 Sep 2004 09:46:48 -0000
Received: (qmail 24521 invoked by alias); 15 Sep 2004 09:46:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20371
Received: (qmail 24512 invoked from network); 15 Sep 2004 09:46:35 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 15 Sep 2004 09:46:35 -0000
Received: (qmail 26593 invoked from network); 15 Sep 2004 09:46:13 -0000
Received: from lhuumrelay3.lnd.ops.eu.uu.net (62.189.58.19)
  by a.mx.sunsite.dk with SMTP; 15 Sep 2004 09:46:11 -0000
Received: from MAILSWEEPER01.csr.com (mailhost1.csr.com [62.189.183.235])
	by lhuumrelay3.lnd.ops.eu.uu.net (8.11.0/8.11.0) with ESMTP id i8F9kBv13996
	for <zsh-workers@sunsite.dk>; Wed, 15 Sep 2004 09:46:11 GMT
Received: from EXCHANGE02.csr.com (unverified [192.168.137.45]) by MAILSWEEPER01.csr.com
 (Content Technologies SMTPRS 4.3.12) with ESMTP id <T6c0e1af798c0a88d01858@MAILSWEEPER01.csr.com> for <zsh-workers@sunsite.dk>;
 Wed, 15 Sep 2004 10:45:16 +0100
Received: from news01.csr.com ([192.168.143.38]) by EXCHANGE02.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Wed, 15 Sep 2004 10:47:26 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.12.11/8.12.11) with ESMTP id i8F9k8wL008662
	for <zsh-workers@sunsite.dk>; Wed, 15 Sep 2004 10:46:08 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.12.11/8.12.11/Submit) with ESMTP id i8F9k81A008659
	for <zsh-workers@sunsite.dk>; Wed, 15 Sep 2004 10:46:08 +0100
Message-Id: <200409150946.i8F9k81A008659@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: PATCH: exit after 10 EOF's 
In-reply-to: <Pine.LNX.4.61.0409131047340.10799@toltec.zanshin.com> 
References: <200409131118.i8DBIM5B005245@news01.csr.com> <Pine.LNX.4.61.0409131047340.10799@toltec.zanshin.com>
Date: Wed, 15 Sep 2004 10:46:08 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 15 Sep 2004 09:47:26.0568 (UTC) FILETIME=[021CF680:01C49B09]
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

Bart Schaefer wrote:
> On Mon, 13 Sep 2004, Peter Stephenson wrote:
> 
> > The shell is supposed to exit after 10 EOFs if ignore_eof is set.
> > When zle is in use this appears to have been broken for a long time.
> 
> Actually I think that was intentional.  ZLE is able to distinguish a real
> end-of-file from a press of the EOF key, so it doesn't need the failsafe
> to prevent it from going into an infinite loop when the SHIN descriptor
> is closed.

You mean, because canonical input is turned off.

> In other words, the shell is supposed to exit after 10 real end-of-files,
> not after 10 keyboard-initiated end-of-files.
> 
> Unless I've missed or forgotten something ...

Hmm... the documentation for ignore_eof says:

  However, ten consecutive EOFs will cause the shell to exit anyway,
  to avoid the shell hanging if its tty goes away.

  Also, if this option is set and the Zsh Line Editor is used, widgets
  implemented by shell functions can be bound to EOF (normally
  Control-D) without printing the normal warning message.  This works
  only for normal widgets, not for completion widgets.

This implies there's not even an error message, which isn't right.  The
error message implies it *is* being treated as EOF, which is what really
made me change it.  I would suggest either followng the documentation or
the standard 10-character practice.

The documentation could imply that if you bound ^D to something other
than the default, you wouldn't get the message, but there doesn't appear
to be any support for that, and I don't think it's useful.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 692070


**********************************************************************
This email and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this email in error please notify
the system manager.

This footnote also confirms that this email message has been swept by
MIMEsweeper for the presence of computer viruses.

www.mimesweeper.com
**********************************************************************

