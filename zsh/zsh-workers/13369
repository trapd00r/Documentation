From zsh-workers-return-13369-mason-zsh=primenet.com.au@sunsite.dk Wed Jan 17 07:53:48 2001
Return-Path: <zsh-workers-return-13369-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1229 invoked from network); 17 Jan 2001 07:53:47 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 17 Jan 2001 07:53:47 -0000
Received: (qmail 14008 invoked by alias); 17 Jan 2001 07:53:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13369
Received: (qmail 13997 invoked from network); 17 Jan 2001 07:53:42 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: <koen.van_hoof@alcatel.be>,
   "Zsh hackers list" <zsh-workers@sunsite.auc.dk>
Subject: RE: TERMCAP problem. 
Date: Wed, 17 Jan 2001 10:53:33 +0300
Message-ID: <000001c0805a$97397130$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
In-Reply-To: <Tc0a8890c5124fd0fa1@mailsweeper01.cambridgesiliconradio.com>
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400
Importance: Normal

>
> It's changed since then.  If you have HAVE_PUTENV defined in config.h, try
> undefining it for something a bit more like (but not identical to) the old
> behaviour to see if that makes a difference.
>

I believe, I know what happens. When zsh creates parameters from environment,
it splits env string in-place; when tgetent is called (from init_term from
termsetfn), envronment string for TERM looks like

TERM\0xterm

Obviously, tgetent (or some functions called from it) does not like this. But
it was there for at least half an year already. I am not sure, but I think, it
was there before my patch as well.

I'll send a patch later, hopefully today.

-andrej

