From zsh-workers-return-25101-mason-zsh=primenet.com.au@sunsite.dk Sun May 25 00:41:28 2008
Return-Path: <zsh-workers-return-25101-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11832 invoked from network); 25 May 2008 00:41:26 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 25 May 2008 00:41:26 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 83618 invoked from network); 25 May 2008 00:41:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 25 May 2008 00:41:17 -0000
Received: (qmail 22920 invoked by alias); 25 May 2008 00:41:09 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25101
Received: (qmail 22906 invoked from network); 25 May 2008 00:41:08 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 25 May 2008 00:41:07 -0000
Received: from prunille.vinc17.org (vinc17.pck.nerim.net [213.41.242.187])
	by bifrost.dotsrc.org (Postfix) with ESMTP id D163180589A4
	for <zsh-workers@sunsite.dk>; Sun, 25 May 2008 02:41:02 +0200 (CEST)
Received: by prunille.vinc17.org (Postfix, from userid 501)
	id 332F222B702B; Sun, 25 May 2008 02:41:02 +0200 (CEST)
Date: Sun, 25 May 2008 02:41:01 +0200
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-workers@sunsite.dk
Cc: 482346@bugs.debian.org
Subject: Re: Bug#482346: zsh doesn't always wait for its children (->
	zombie)
Message-ID: <20080525004101.GT7056@prunille.vinc17.org>
Mail-Followup-To: zsh-workers@sunsite.dk, 482346@bugs.debian.org
References: <20080521235008.GA5600@ay.vinc17.org> <20080521235930.GW7056@prunille.vinc17.org> <20080522233327.GA24953@scru.org> <080523073940.ZM13804@torch.brasslantern.com> <20080523145722.GA12096@scru.org> <20080523224305.GN7056@prunille.vinc17.org> <20080524025556.GA30511@scru.org> <20080524124445.GQ7056@prunille.vinc17.org> <20080524234002.GA35143@redoubt.spodhuis.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <20080524234002.GA35143@redoubt.spodhuis.org>
X-Mailer-Info: http://www.vinc17.org/mutt/
User-Agent: Mutt/1.5.17-vl-r21552 (2008-04-09)
X-Virus-Scanned: ClamAV 0.91.2/7228/Sat May 24 20:09:29 2008 on bifrost
X-Virus-Status: Clean

On 2008-05-24 16:40:02 -0700, Phil Pennock wrote:
> Since you're on a rarer architecture that doesn't see so much Linux
> kernel debugging, I'd be inclined to look at what has changed in the
> kernel's architecture-specific signal handling code.  (But see below).

I don't know if the bug is new. I've never killed vlc in such a way
in the past. The current kernel is linux-image-2.6.24-1-powerpc
2.6.24-7.

> Further, it's strange that zombies are contributing to load average; if
> zsh is gone (killed off and no longer even possibly stuck in a tight
> loop)  and there's the zombie and init left, then there shouldn't be
> anything contributing to load avg.

Yes, that's strange.

> If you use tools such as top(1), what processes are they attributing the
> load to?

None, and the CPU is idle:

top - 02:31:55 up 22:19,  6 users,  load average: 4.09, 4.24, 4.25
Tasks: 117 total,   1 running, 115 sleeping,   0 stopped,   1 zombie
Cpu(s):  0.7%us,  0.7%sy,  0.0%ni, 98.4%id,  0.0%wa,  0.3%hi,  0.0%si,  0.0%st
Mem:    255432k total,   233456k used,    21976k free,     3004k buffers
Swap:   524280k total,    22820k used,   501460k free,   105548k cached

(The zombie is vlc.)

>  Is the high load average confirmed by vmstat reports of idle
> CPU, or is the load avg really out of sync with CPU reality?

Here's vmstat output:

ay:~> vmstat
procs -----------memory---------- ---swap-- -----io---- -system-- ----cpu----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa
 0  0  22820  26456   5520  99688    0    0    15    35   30  196  8  1 88  3

-- 
Vincent Lefèvre <vincent@vinc17.org> - Web: <http://www.vinc17.org/>
100% accessible validated (X)HTML - Blog: <http://www.vinc17.org/blog/>
Work: CR INRIA - computer arithmetic / Arenaire project (LIP, ENS-Lyon)

