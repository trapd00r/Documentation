From zsh-users-return-4840-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 16 13:41:11 2002
Return-Path: <zsh-users-return-4840-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 10770 invoked from network); 16 Apr 2002 13:41:10 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 16 Apr 2002 13:41:10 -0000
Received: (qmail 14797 invoked by alias); 16 Apr 2002 13:40:47 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4840
Received: (qmail 14777 invoked from network); 16 Apr 2002 13:40:43 -0000
To: zsh-users@sunsite.dk (Zsh users list)
Subject: Re: listing all executables by prefix - solution! 
In-reply-to: "Dan Kenigsberg"'s message of "Tue, 16 Apr 2002 15:03:04 +0300."
             <200204161203.PAA16978@csd.cs.technion.ac.il> 
Date: Tue, 16 Apr 2002 14:40:13 +0100
Message-ID: <9003.1018964413@csr.com>
From: Peter Stephenson <pws@csr.com>

Dan Kenigsberg wrote:
> and something like:
> 
>   function _lap { tmp="${(@f)$(whence -pm $1\*)}"; [[ ! -z $tmp ]] && 
>     ls -l ${=tmp} }
> 
> will produce fewer processes on the way.

Except... see below.

> P.S. I wouldn't know why
> 
>   function _lap { tmp=$(whence -pm $1\*); [[ ! -z $tmp ]] && ls -l ${=tmp} }
> 
> is not as good, but I'm such a shameless newbie, so it is not that surprising
> .

It's not obvious at first sight.  The problem here (and above) is with
spaces.  Both ${=...} and normal $(...) split words on spaces.  So if
you have directories with names like `Program Files' the filename will
be split at that point.  The "${(@f)...}"  stuff makes sure you get the
`whence output', including newlines, verbatim and then splits on the
newlines.  Of course, if you have newlines in your filenames your are
totally screwed, but at least the GUI-masqeurading-as-an-OS I alluded to
before isn't in the habit of using them.

Hence your solution is better written using an array:

function _lap {
  local tmp
  tmp=("${(@f)$(whence -pm $1\*)}")
  (( $#tmp )) && ls -l $tmp
}

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 392070


**********************************************************************
The information transmitted is intended only for the person or
entity to which it is addressed and may contain confidential 
and/or privileged material. 
Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by 
persons or entities other than the intended recipient is 
prohibited.  
If you received this in error, please contact the sender and 
delete the material from any computer.
**********************************************************************

