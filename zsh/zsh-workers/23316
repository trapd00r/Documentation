From zsh-workers-return-23316-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 24 14:12:44 2007
Return-Path: <zsh-workers-return-23316-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15071 invoked from network); 24 Apr 2007 14:12:41 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 24 Apr 2007 14:12:41 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 98680 invoked from network); 24 Apr 2007 14:12:35 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 24 Apr 2007 14:12:35 -0000
Received: (qmail 27956 invoked by alias); 24 Apr 2007 14:12:31 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23316
Received: (qmail 27947 invoked from network); 24 Apr 2007 14:12:29 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 24 Apr 2007 14:12:29 -0000
Received: (qmail 98324 invoked from network); 24 Apr 2007 14:12:29 -0000
Received: from cluster-c.mailcontrol.com (168.143.177.190)
  by a.mx.sunsite.dk with SMTP; 24 Apr 2007 14:12:26 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly26c.srv.mailcontrol.com (MailControl) with ESMTP id l3OECJhp018604
	for <zsh-workers@sunsite.dk>; Tue, 24 Apr 2007 15:12:20 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 24 Apr 2007 15:12:19 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.8/8.13.4) with ESMTP id l3OECIeF001555
	for <zsh-workers@sunsite.dk>; Tue, 24 Apr 2007 15:12:18 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.8/8.13.8/Submit) with ESMTP id l3OECIfa001552
	for <zsh-workers@sunsite.dk>; Tue, 24 Apr 2007 15:12:18 +0100
Message-Id: <200704241412.l3OECIfa001552@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk
Subject: Re: zsh 4.3.4: bindkey -s xx 'yyy\n' no longer works (with bindkey -v)
In-reply-to: <loom.20070424T152752-311@post.gmane.org> 
References: <loom.20070424T152752-311@post.gmane.org>
Comments: In-reply-to Jim Meyering <jim@meyering.net>
   message dated "Tue, 24 Apr 2007 13:31:49 -0000."
Date: Tue, 24 Apr 2007 15:12:17 +0100
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 24 Apr 2007 14:12:19.0191 (UTC) FILETIME=[91B30870:01C7867A]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.67.0.136

Jim Meyering wrote:
> But with 4.3.4, the latter bindkey seems to have no effect:
> 
>   r$ zsh -f
>   r% bindkey -v
>   r% bindkey -s '^x^x' '!!\n'
>   r% echo foo
>   foo
>   r% ^X^X                <<=== here I typed control-X twice,
>                                and it merely echos them

The only feature I can see that would have an effect on this is
$KEYTIMEOUT.  This is the delay in 100ths of a second for which the chip
will wait for an additional key if the key typed so far is also bound in
its own right.  However, the default (40) hasn't changed.  What does
"echo $KEYTIMEOUT" say?  Do this behaviour change if you set KEYTIMEOUT
to something larger?

Although, again, I'm not aware of the behaviour deliberately being
changed, the reason $KEYTIMEOUT is applied is because most characters,
including ^X, are bound by default to self-insert in vi insert mode.
You can stop this happening for ^X:

bindkey -r -M viins '^x'

Now it doesn't matter what delay there is between the two ^x's.

Possibly displaying the binding of ^x with

bindkey -M viins '^x'

will shed some light on differences between versions.

(I don't think you need the "-M viins" in either case, but I'm paranoid
about vi keymaps since I can never remember which is the "alternate"
keymap.)

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

To get further information regarding CSR, please visit our Investor Relations page at http://ir.csr.com/csr/about/overview

