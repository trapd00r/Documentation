From zsh-users-return-14768-mason-zsh=primenet.com.au@zsh.org Tue Feb 02 11:50:28 2010
Return-Path: <zsh-users-return-14768-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2322 invoked by alias); 2 Feb 2010 11:50:28 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14768
Received: (qmail 9975 invoked from network); 2 Feb 2010 11:50:26 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at seiken.de does not designate permitted sender hosts)
From: Joke de Buhr <joke@seiken.de>
Organization: http://www.seiken.de/
To: zsh-users@zsh.org
Subject: Re: Want to replace bash w zsh as system shell on Ubuntu
Date: Tue, 2 Feb 2010 12:50:17 +0100
User-Agent: KMail/1.12.2 (Linux/2.6.31-17-generic; KDE/4.3.2; x86_64; ; )
References: <20100202081546.GA5930@panix.com> <201002021007.35234.joke@seiken.de> <2d460de71002020211y57ef49eaq32bfd97403dd7d25@mail.gmail.com>
In-Reply-To: <2d460de71002020211y57ef49eaq32bfd97403dd7d25@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart1473469.k9PHaGu8fS";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <201002021250.17528.joke@seiken.de>

--nextPart1473469.k9PHaGu8fS
Content-Type: Text/Plain;
  charset="utf-8"
Content-Transfer-Encoding: quoted-printable

On Tuesday 02 February 2010 11:11:40 Richard Hartmann wrote:
> I tried to use zsh as the system shell on Debian unstable a year or so ag=
o.
>=20
> After lots of things breaking, I gave up.

It should be easier on ubuntu because they switched their default system sh=
ell=20
from bash to dash and had to change some init scripts to posix sh compliant=
=20
syntax.

Second they use upstart scripts to replace some common sysv init scripts.=20
These upstart scripts were rewritten from scratch and are posix sh complian=
t=20
too.

> The general consensus on the mailing list is that it is a bad idea to use
> it as /bin/sh -- search the archives for details.
> The main reason is probably that zsh predates most standards and thus
> still has a few quirks and edges that are not worth ironing out as no one
> uses zsh as /bin/sh, anyway. Hen and egg, I guess.

Zsh runs in sh compatibility mode if it's executable was called via symlink=
=20
from /bin/sh. But the problem is most distribution's init scripts are only=
=20
bash compliant but are called via symlink from /bin/sh.

Sh compliant shell scripting can't use stuff like associative arrays,=20
subshell commands like "echo $(date -R)" or "[["-style tests. But some init=
=20
scripts do.

> Also, please note that you need to link to /bin/zsh not /usr/bin/zsh or
> you _might_ break stuff (admittedly unlikely on today's single-user
> systems).

Dynamic linking problems (libpcre) have been fixed in recent ubuntu zsh=20
releases. Probable the same in debian (unstable) releases. It's save to lin=
k=20
to /bin/zsh.

=20
> I would just
>=20
>   chsh
>=20
> as root and be done with it.

There's a difference between running "sudo -s" and changing the shell via=20
"chsh" and using "su". Sudo doesn't change the HOME environmental variable =
to=20
HOME=3D/root. It's set to "HOME=3D$HOME" so the root session uses the=20
configuration files of the user. That's why you don't have to copy your=20
~/.vimrc configuration to /root/.vimrc.

This behavior is very important if you're running a system with multiple=20
admins.

--nextPart1473469.k9PHaGu8fS
Content-Type: application/pgp-signature; name=signature.asc 
Content-Description: This is a digitally signed message part.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iQIcBAABCgAGBQJLaBF5AAoJEMcNQWzYfbLsswYQANDIBcEGQFUpZCU6JdNppqyp
sSKaUy+pS6ILwQv521fOfGqKmmrXtT7+9bpKozrAfpmrrJD4wRXR2R+vbso6MoDR
Do4tRaY5p6Vzw17yRzyzQ3axke2UMFKFiiXvvTOUZSSvzir/yFb9ooOD0xKwkeBZ
OfcKg9OAsR4kIInOZNPKMVzoO7gdvJpehSPHxBnjhmWBwyHlfk501GjM7qLHdGZx
Q6zBTA2YJQ/d9vAQMeSVZLjf3iHO8iKM0lvt1iQ46oJfPKqIr9Vcz89gVnaZ42iR
bADfEQnVd8R/Leik8eqhBXbQMRcB3pdJ8rR6RWbPab3UKEQdMUSqw8RLBf5mk+pS
ZrdbKXR+5q43LzJzl9duJUKsFwq7ua215dDz5b+VaKNbcRsTPdrV6HmLil7xRDSf
d4G2cc93vXNwgXzAVGaIjILUVU2flJ1E0JZGjv21b4jxXoCRZCSt/wu8ZsDPfRGI
miUARTbSiiqN3sBoYU65nM1jjvKq7XCos4zVc/Uoqg+6PzCj3kyNF/utCTDLb1UM
fcqCLiEisjJ2Qln5vZ0ms8ItDe+e6/wj6TMoqypnJ4CH1loURZiiFfiltkFJK64+
Jz9lunTyZMiBq+5pLsuhMD5V5J6tQyqX7yLzaJOz1dXt9wJAZvhFNNYP5T+SKVrJ
LJzdQB1R0FmLio4myqLU
=nAP3
-----END PGP SIGNATURE-----

--nextPart1473469.k9PHaGu8fS--

