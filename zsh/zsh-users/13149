From zsh-users-return-13149-mason-zsh=primenet.com.au@sunsite.dk Sun Aug 17 20:44:28 2008
Return-Path: <zsh-users-return-13149-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27494 invoked from network); 17 Aug 2008 20:44:26 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 Aug 2008 20:44:26 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 32952 invoked from network); 17 Aug 2008 20:43:36 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 Aug 2008 20:43:36 -0000
Received: (qmail 4806 invoked by alias); 17 Aug 2008 20:42:52 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13149
Received: (qmail 4785 invoked from network); 17 Aug 2008 20:42:49 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 17 Aug 2008 20:42:49 -0000
Received: from vms046pub.verizon.net (vms046pub.verizon.net [206.46.252.46])
	by bifrost.dotsrc.org (Postfix) with ESMTP id E23C980F75A3
	for <zsh-users@sunsite.dk>; Sun, 17 Aug 2008 22:42:45 +0200 (CEST)
Received: from torch.brasslantern.com ([96.238.220.178])
 by vms046.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0K5R00K3XIUIZGK4@vms046.mailsrvcs.net> for
 zsh-users@sunsite.dk; Sun, 17 Aug 2008 15:42:19 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id m7HKgIDn029728	for
 <zsh-users@sunsite.dk>; Sun, 17 Aug 2008 13:42:18 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id m7HKgHZm029727	for zsh-users@sunsite.dk; Sun,
 17 Aug 2008 13:42:17 -0700
Date: Sun, 17 Aug 2008 13:42:15 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: rfc patch, abort rm instead of only removing the * from the cmdline
In-reply-to: <237967ef0808151649j1d14ce23s1acad02da98fdfdf@mail.gmail.com>
To: zsh-users <zsh-users@sunsite.dk>
Message-id: <080817134217.ZM29726@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <237967ef0808151649j1d14ce23s1acad02da98fdfdf@mail.gmail.com>
	<2d460de70808160858p5312805dlf1c9976a9b702a51@mail.gmail.com>
	<237967ef0808160902p4dbc6d73w6620f6c69471ea20@mail.gmail.com>
	<2d460de70808160914h2c3706ebs312a0bbd62afbf57@mail.gmail.com>
	<20080816205209.GA5176@sc.homeunix.net>
	<237967ef0808161358y5deae840xe3bd399d01d198f@mail.gmail.com>
	<20080817065717.GA5175@sc.homeunix.net>
Comments: In reply to "Mikael Magnusson" <mikachu@gmail.com>
 "rfc patch, abort rm instead of only removing the * from the cmdline" (Aug 16,
  1:49am)
X-Virus-Scanned: ClamAV 0.92.1/8051/Sat Aug 16 05:44:59 2008 on bifrost
X-Virus-Status: Clean

On Aug 16,  1:49am, Mikael Magnusson wrote:
}
} It surprised me that this isn't already what happens, what do others think?
} Imagine for example the typo
} % rm -rf * /tmp
} Before, even if you said no to the prompt, it will remove all your
} files in /tmp.

On Aug 16,  6:14pm, Richard Hartmann wrote:
} 
} Agree 100%! This must be changed asap!
} 
} As Peter is on holidays, can Bart chip in on this?

Well ...

It having been this way for far more than a decade without anyone ever
complaining before, I'm not sure "asap!" really applies.

The existing behavior really is what Paul Falstad wanted the shell to
do, all those years ago.  Like several of the very oldest features,
it's rather woefully under-documented in the man pages.  If you want
to abort the whole command, you're supposed to interrupt it with ^C,
not answer "n" -- the prompt is really just to give you an extra moment
to think about what a stupid thing you might be about to do, not to
second-guess your entire command line; compare the RM_STAR_WAIT option
(which is a lot more recent).

That said, if it were going to be changed, Stephane's patch is better.

Ideally I suppose this prompt should work like the prompt for "correct",
giving you "nyae" as choices so you can choose to abort or to edit your
typo.  Then it would be more obvious that "n" was not going to entirely
whack the command.

-- 

