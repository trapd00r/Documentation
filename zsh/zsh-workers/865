From wayne@tenor.clarinet.com Thu Mar 28 10:25:53 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id KAA10865 for <mason@werple.mira.net.au>; Thu, 28 Mar 1996 10:25:51 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id SAA12756; Wed, 27 Mar 1996 18:19:49 -0500 (EST)
Resent-Date: Wed, 27 Mar 1996 18:19:49 -0500 (EST)
Message-Id: <199603272306.PAA00382@tenor.clari.net>
To: Mark Borges <mdb@cdc.noaa.gov>
Cc: Zoltan Hidvegi <hzoli@cs.elte.hu>,
        Zsh hacking and development <zsh-workers@math.gatech.edu>
Subject: Re: Still there's a little zle_refresh bug 
In-reply-to: mdb's message of 27 Mar 1996 13:16:16 -0700.
	     <vkybom5m27.fsf@suomi.cdc.noaa.gov> 
Date: Wed, 27 Mar 1996 15:06:54 -0800
From: Wayne Davison <wayne@tenor.clarinet.com>
Resent-Message-ID: <"9OMaz1.0.E73.KqSMn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/865
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1188
Status: OR

Mark Borges writes:
> I'm still seeing [a zle_refresh bug] on my solaris-2.3/2.5 platforms

It's a problem that depends on the insert-character terminal attribute
being present.  Using your example of a series of '1234567890's on a
line with a '0' as the last character before the line-wrap, I get the
following output when I type the '*' prior to the '5' (using an xterm
that includes the insert-character attribute as "^[[@"):

*567890^M^[[@0

As you can see, it outputs enough characters to get down to the next
line (which includes outputting the NEW first character on the next
line) and then tries to do an insert at the start of the line.  If
it had output the OLD first character when forcing a line wrap (or
had done the insert of the '1' at the second position) it would have
worked correctly.

In the case of a terminal without any insert character, it outputs the
following:

*567890^M01234567890

In this case it would still be OK for the force-a-line-wrap character
to be the OLD first character on the line since it gets overwritten.

I don't have time to fix the problem at the moment, but I hope that
this diagnosis will allow someone else to tweak the code.

..wayne..


