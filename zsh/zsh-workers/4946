From zsh-workers-request@math.gatech.edu Fri Jan 22 09:50:22 1999
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15183 invoked from network); 22 Jan 1999 09:47:15 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 22 Jan 1999 09:47:15 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id EAA19039;
	Fri, 22 Jan 1999 04:45:28 -0500 (EST)
Resent-Date: Fri, 22 Jan 1999 04:45:28 -0500 (EST)
Date: Fri, 22 Jan 1999 10:44:16 +0100 (MET)
Message-Id: <199901220944.KAA24675@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@math.gatech.edu
In-reply-to: Peter Stephenson's message of Fri, 22 Jan 1999 10:10:25 +0100
Subject: Re:  PATCH: zsh-3.1.5-pws-4 + Sven's new completion: dl fix (+ problem)
Resent-Message-ID: <"DpbZU3.0.Qf4.tY4gs"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4946
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu


Peter Stephenson wrote:

> 
> Here's a patch which allows Sven's patches for the new completion
> system to work with dynamic loading when the symbols in zle aren't
> directly available from compctl and vice versa.  I added a warning
> where it wasn't obvious you could be sure the pointers to zle
> functions were properly set, however I haven't chased the calling
> sequence and it may be this is unnecessary.  This all now compiles
> OK.

Thanks!

> However ----  Sven, I can't find any changes to the widget definitions
> in your patches.  Have I missed a patch, or should there be some
> more hunks to add ZLE_ISCOMP flags to some widgets?  Otherwise zle -c
> won't recognize widgets as being of the right type to use.

My fault, it seems, I somehow didn't include the following patch. Sorry.


Bye
 Sven

*** ../zdy/Src/Zle/iwidgets.list	Fri Nov  6 09:47:38 1998
--- Src/Zle/iwidgets.list	Wed Dec 16 14:11:40 1998
***************
*** 25,35 ****
  "beginning-of-line-hist", beginningoflinehist, 0
  "capitalize-word", capitalizeword, 0
  "clear-screen", clearscreen, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL | ZLE_NOTCOMMAND
! "complete-word", completeword, ZLE_MENUCMP | ZLE_KEEPSUFFIX
  "copy-prev-word", copyprevword, 0
  "copy-region-as-kill", copyregionaskill, ZLE_KEEPSUFFIX
  "delete-char", deletechar, ZLE_KEEPSUFFIX
! "delete-char-or-list", deletecharorlist, ZLE_MENUCMP | ZLE_KEEPSUFFIX
  "delete-word", deleteword, ZLE_KEEPSUFFIX
  "describe-key-briefly", describekeybriefly, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "digit-argument", digitargument, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL | ZLE_NOTCOMMAND
--- 25,35 ----
  "beginning-of-line-hist", beginningoflinehist, 0
  "capitalize-word", capitalizeword, 0
  "clear-screen", clearscreen, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL | ZLE_NOTCOMMAND
! "complete-word", completeword, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_ISCOMP
  "copy-prev-word", copyprevword, 0
  "copy-region-as-kill", copyregionaskill, ZLE_KEEPSUFFIX
  "delete-char", deletechar, ZLE_KEEPSUFFIX
! "delete-char-or-list", deletecharorlist, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_ISCOMP
  "delete-word", deleteword, ZLE_KEEPSUFFIX
  "describe-key-briefly", describekeybriefly, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "digit-argument", digitargument, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL | ZLE_NOTCOMMAND
***************
*** 48,55 ****
  "execute-named-cmd", NULL, 0
  "expand-cmd-path", expandcmdpath, 0
  "expand-history", expandhistory, 0
! "expand-or-complete", expandorcomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX
! "expand-or-complete-prefix", expandorcompleteprefix, ZLE_MENUCMP | ZLE_KEEPSUFFIX
  "expand-word", expandword, 0
  "forward-char", forwardchar, 0
  "forward-word", forwardword, 0
--- 48,55 ----
  "execute-named-cmd", NULL, 0
  "expand-cmd-path", expandcmdpath, 0
  "expand-history", expandhistory, 0
! "expand-or-complete", expandorcomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_ISCOMP
! "expand-or-complete-prefix", expandorcompleteprefix, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_ISCOMP
  "expand-word", expandword, 0
  "forward-char", forwardchar, 0
  "forward-word", forwardword, 0
***************
*** 68,78 ****
  "kill-region", killregion, ZLE_KILL | ZLE_KEEPSUFFIX
  "kill-whole-line", killwholeline, ZLE_KILL | ZLE_KEEPSUFFIX
  "kill-word", killword, ZLE_KILL | ZLE_KEEPSUFFIX
! "list-choices", listchoices, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "list-expand", listexpand, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "magic-space", magicspace, 0
! "menu-complete", menucomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX
! "menu-expand-or-complete", menuexpandorcomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX
  "neg-argument", negargument, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL | ZLE_NOTCOMMAND
  "overwrite-mode", overwritemode, 0
  "pound-insert", poundinsert, 0
--- 68,78 ----
  "kill-region", killregion, ZLE_KILL | ZLE_KEEPSUFFIX
  "kill-whole-line", killwholeline, ZLE_KILL | ZLE_KEEPSUFFIX
  "kill-word", killword, ZLE_KILL | ZLE_KEEPSUFFIX
! "list-choices", listchoices, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL | ZLE_ISCOMP
  "list-expand", listexpand, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "magic-space", magicspace, 0
! "menu-complete", menucomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_ISCOMP
! "menu-expand-or-complete", menuexpandorcomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_ISCOMP
  "neg-argument", negargument, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL | ZLE_NOTCOMMAND
  "overwrite-mode", overwritemode, 0
  "pound-insert", poundinsert, 0
***************
*** 84,90 ****
  "quote-region", quoteregion, 0
  "redisplay", redisplay, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "redo", redo, 0
! "reverse-menu-complete", reversemenucomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX
  "run-help", processcmd, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "self-insert", selfinsert, ZLE_MENUCMP | ZLE_KEEPSUFFIX
  "self-insert-unmeta", selfinsertunmeta, ZLE_MENUCMP | ZLE_KEEPSUFFIX
--- 84,90 ----
  "quote-region", quoteregion, 0
  "redisplay", redisplay, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "redo", redo, 0
! "reverse-menu-complete", reversemenucomplete, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_ISCOMP
  "run-help", processcmd, ZLE_MENUCMP | ZLE_KEEPSUFFIX | ZLE_LASTCOL
  "self-insert", selfinsert, ZLE_MENUCMP | ZLE_KEEPSUFFIX
  "self-insert-unmeta", selfinsertunmeta, ZLE_MENUCMP | ZLE_KEEPSUFFIX

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

