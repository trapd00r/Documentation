From hzoli@cs.elte.hu Fri Jul 12 05:14:19 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id FAA17837 for <mason@werple.mira.net.au>; Fri, 12 Jul 1996 05:14:17 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id OAA26657; Thu, 11 Jul 1996 14:33:29 -0400 (EDT)
Resent-Date: Thu, 11 Jul 1996 14:33:29 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199607111832.UAA03358@bolyai.cs.elte.hu>
Subject: Re: Zle display bug with LONG expansions
To: schaefer@nbn.com
Date: Thu, 11 Jul 1996 20:32:51 +0200 (MET DST)
Cc: zsh-workers@math.gatech.edu
In-Reply-To: <960711100059.ZM8587@candle.brasslantern.com> from Bart Schaefer at "Jul 11, 96 10:00:57 am"
Organization: Dept. of Comp. Sci., Eotvos University, Budapest, Hungary
Phone: (36 1)2669833 ext: 2667, home phone: (36 1) 2752368
X-Mailer: ELM [version 2.4ME+ PL16 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"YKRtL1.0.PW6.pZKvn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1612
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1176
Status: OR

> In an 80x32 (or smaller?) xterm, do the following:
> 
> zagzig[38] echo **/*<TAB>

zle doen not handle the case when a line does not fit onto the screen.

> I don't know why the first expansion uses only 25 lines.  The second bug
> with the blank line at the end of the screen and the prompt scrolled off
> is caused by auto-wraparound in the xterm, but if you turn that off, the
> line *never* wraps, so you can never see more than the last line of the
> expansion.  The third bug is just weird.

Geoff told me that for some reason zsh have to know in advance wether the
current terminal automatically wraps the line.  He is probably right since
some terminals start a new line when a character is printed in the last
column while most terminals start a new line only is a character is printed
after the last column.  It uses the termcap information to determine wether
the terminal automatically wraps.  Unfortunately this means that if
auto-wrap is turned off in xterm, zle will stop working :-).  I do not like
it either but I do not know how can this be fixed.  I do not know much
about zle_refresh.c in general.  It is mostly written (or rewritten) by
Geoff.

Zoltan


