From zsh-workers-request@math.gatech.edu  Tue May 23 04:25:06 1995
Received: from gatech.edu (gatech.edu [128.61.1.1]) by werple.mira.net.au (8.6.10/8.6.9) with SMTP id EAA08200 for <mason@werple.mira.net.au>; Tue, 23 May 1995 04:25:03 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA09905
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Mon, 22 May 1995 14:21:16 -0400
Received: by math (5.x/SMI-SVR4)
	id AA02651; Mon, 22 May 1995 14:18:33 -0400
Resent-Date: Mon, 22 May 1995 20:17:29 +0100 (MET DST)
Old-Return-Path: <hzoli@cs.elte.hu>
From: hzoli@cs.elte.hu (Zoltan Hidvegi)
Message-Id: <9505221817.AA06091@turan.elte.hu>
Subject: Re: Redirected function output
To: zsh-workers@math.gatech.edu (zsh-workers)
Date: Mon, 22 May 1995 20:17:29 +0100 (MET DST)
In-Reply-To: <9505220913.AA17221@sdlunix.ug.eds.com> from "Daniel Dignam" at May 22, 95 10:12:59 am
X-Mailer: ELM [version 2.4 PL21]
Content-Type: text
Resent-Message-Id: <"L6R7q1.0.Lf.uLDml"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/20
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> 
> Redirect function output appears to screw up the shell.
> 
> sdlhpp33:daniel 5820> echo $ZSH_VERSION 
> 2.6-beta9-test2
> 
> sdlhpp33:daniel 5821> a()
> > {
> > echo a
> > }
> 
> sdlhpp33:daniel 5822> a > /dev/null
> 
> 
> In this case the lkast command does not return, if ran in a script then the 
> function returns, but the output of following commands is redirected to who 
> knows where ..... ^C does not even get the prompt back.

You can fix it with exec >& /dev/tty.

Here are some more details about that bug from my BUGS file I posted some time
ago (Richard, would you please update the BUGS file, it's very old. thaks).

Zoltan

------------------------------------------------------------------------
% foo () { : }
% true | true
% foo > /dev/null
The prompt will not come back and what you type is not echoed on the
terminal. You can get back the prompt if you blindly type
% exec >& /dev/tty
 
The following commands terminate an interactive shell:
% foo () { : }
% true | true
% foo <<< bar
% bar      <------ you do not have to type that. That's the result
zsh: command not found: bar
 
In both cases the problem is that the whole shell's stdin/stdout is
redirected instead of only the functions input/output. E.g. the the
second example does the same as
% exec <<< bar
% bar      <------ you do not have to type that. That's the result
zsh: command not found: bar
Termination is caused by EOF in stdin.
------------------------------------------------------------------------

