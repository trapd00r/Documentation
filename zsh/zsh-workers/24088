From zsh-workers-return-24088-mason-zsh=primenet.com.au@sunsite.dk Mon Nov 12 01:32:14 2007
Return-Path: <zsh-workers-return-24088-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7614 invoked from network); 12 Nov 2007 01:32:06 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Nov 2007 01:32:06 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 28981 invoked from network); 12 Nov 2007 01:31:56 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Nov 2007 01:31:56 -0000
Received: (qmail 5189 invoked by alias); 12 Nov 2007 01:31:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24088
Received: (qmail 5173 invoked from network); 12 Nov 2007 01:31:50 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 12 Nov 2007 01:31:50 -0000
Received: (qmail 28596 invoked from network); 12 Nov 2007 01:31:50 -0000
Received: from smtp02.lnh.mail.rcn.net (207.172.157.102)
  by a.mx.sunsite.dk with SMTP; 12 Nov 2007 01:31:44 -0000
Received: from mr02.lnh.mail.rcn.net ([207.172.157.22])
  by smtp02.lnh.mail.rcn.net with ESMTP; 11 Nov 2007 20:31:42 -0500
Received: from smtp01.lnh.mail.rcn.net (smtp01.lnh.mail.rcn.net [207.172.4.11])
	by mr02.lnh.mail.rcn.net (MOS 3.8.3-GA)
	with ESMTP id OAC93449;
	Sun, 11 Nov 2007 20:31:41 -0500 (EST)
Received: from 209-6-218-101.c3-0.nwt-ubr2.sbo-nwt.ma.cable.rcn.com (HELO samwise.rcn.com) ([209.6.218.101])
  by smtp01.lnh.mail.rcn.net with ESMTP; 11 Nov 2007 20:30:38 -0500
Received: by samwise.rcn.com (Postfix, from userid 1000)
	id 9B7D7214214; Sun, 11 Nov 2007 20:31:42 -0500 (EST)
To: zsh-workers@sunsite.dk
Subject: Build Failure
From: Vin Shelton <acs@alumni.princeton.edu>
Organization: EtherSoft, Inc
Date: Sun, 11 Nov 2007 20:31:42 -0500
Message-ID: <874pfsxn9d.fsf@alumni.princeton.edu>
Lines: 19
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="=-=-="
X-Junkmail-Status: score=10/50, host=mr02.lnh.mail.rcn.net
X-Junkmail-SD-Raw: score=unknown,
	refid=str=0001.0A090206.4737AB8F.0002,ss=1,fgs=0,
	ip=207.172.4.11,
	so=2006-12-09 10:45:40,
	dmn=5.4.3/2007-09-06

--=-=-=

Without the attached patch I'm getting the following error:

gcc -c -I. -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -DMODULE -Wall -Wmissing-prototypes -O2 -fPIC -o curses..o /opt/src/zsh-2007-11-11/Src/Modules/curses.c
/opt/src/zsh-2007-11-11/Src/Modules/curses.c: In function 'zccmd_querychar':
/opt/src/zsh-2007-11-11/Src/Modules/curses.c:1383: error: 'attrs' undeclared (first use in this function)
/opt/src/zsh-2007-11-11/Src/Modules/curses.c:1383: error: (Each undeclared identifier is reported only once
/opt/src/zsh-2007-11-11/Src/Modules/curses.c:1383: error: for each function it appears in.)
make[3]: *** [curses..o] Error 1
make[3]: Leaving directory `/opt/build/zsh-2007-11-11/Src/Modules'
make[2]: *** [modules] Error 1
make[2]: Leaving directory `/opt/build/zsh-2007-11-11/Src'
make[1]: *** [modules] Error 2
make[1]: Leaving directory `/opt/build/zsh-2007-11-11/Src'
make: *** [all] Error 1


--=-=-=
Content-Type: text/x-patch
Content-Disposition: inline; filename=d
Content-Description: Fix curses.c compilation error

--- Src/Modules/curses.c~	2007-11-11 12:59:05.000000000 -0500
+++ Src/Modules/curses.c	2007-11-11 20:22:55.000000000 -0500
@@ -1331,10 +1331,10 @@
     Colorpairnode cpn;
     const struct zcurses_namenumberpair *zattrp;
     LinkList clist;
+    attr_t attrs;
 #if defined(HAVE_WIN_WCH) && defined(HAVE_GETCCHAR)
     wchar_t c;
     cchar_t cc;
-    attr_t attrs;
     int count;
     VARARR(char, instr, 2*MB_CUR_MAX+1);
 #else

--=-=-=


  - Vin

--=-=-=--

