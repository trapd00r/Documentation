From zsh-users-return-13556-mason-zsh=primenet.com.au@sunsite.dk Tue Dec 09 16:48:38 2008
Return-Path: <zsh-users-return-13556-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19375 invoked from network); 9 Dec 2008 16:48:34 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 9 Dec 2008 16:48:34 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 23565 invoked from network); 9 Dec 2008 16:48:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 Dec 2008 16:48:23 -0000
Received: (qmail 27198 invoked by alias); 9 Dec 2008 16:48:08 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13556
Received: (qmail 27188 invoked from network); 9 Dec 2008 16:48:08 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 9 Dec 2008 16:48:08 -0000
Received: from qw-out-2122.google.com (qw-out-2122.google.com [74.125.92.27])
	by bifrost.dotsrc.org (Postfix) with ESMTP id BEA3C80308BE
	for <zsh-users@sunsite.dk>; Tue,  9 Dec 2008 17:47:52 +0100 (CET)
Received: by qw-out-2122.google.com with SMTP id 9so28735qwb.3
        for <zsh-users@sunsite.dk>; Tue, 09 Dec 2008 08:47:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to
         :subject:mime-version:content-type:content-transfer-encoding
         :content-disposition;
        bh=erwpmRUWhvsdgza3nQ7Ermf7Rf2Wq+1w41Xc9+sN17E=;
        b=GNWtTZoLtrlHn3rLmodQyzulF1WVhACDIDGJFo/Pw0OG0gN6ymUkSSKpvobLhWN7r0
         IsW+/EMa8laUJx37MI90OkSId3Sd95tSCJ2+huTCpUjsPkH5hyBnwn/rHXX4zNPuThXf
         5PdgElcqJXXnq8+JMTWiD26y8ne8iH183EPy0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type
         :content-transfer-encoding:content-disposition;
        b=HYGWznE/7qPTqGAKI7D1v2XTJTF6p1uDPrVXk9fYRgnK9wFRK7NspNLFxas6CAGuvo
         duyiFND37fL7gwEbj1u5uAsC/b7C2WuW958EstZnecXW4Vw7CDIjWjmZFZ/PEkRMbw/A
         u2329yCeO9hgannebcBhmukXCog6smnogY4WQ=
Received: by 10.114.169.2 with SMTP id r2mr212962wae.161.1228841271112;
        Tue, 09 Dec 2008 08:47:51 -0800 (PST)
Received: by 10.114.60.16 with HTTP; Tue, 9 Dec 2008 08:47:51 -0800 (PST)
Message-ID: <6cd6de210812090847i1d0d76b8wf107e5c8ea2f0f9e@mail.gmail.com>
Date: Tue, 9 Dec 2008 11:47:51 -0500
From: "Rocky Bernstein" <rocky.bernstein@gmail.com>
To: "Zsh users list" <zsh-users@sunsite.dk>
Subject: Testing if a file is a terminal?
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Scanned: ClamAV 0.92.1/8736/Tue Dec  9 16:58:37 2008 on bifrost
X-Virus-Status: Clean

First, many thanks to Peter and St=E9phane for the very informative
answers on terminal redirection.

Before allowing a terminal to be set, the zshdb debugger uses this test:

    [[ -r "$1" && -w "$1" ]] && return 0 # Ok

$1 is a string --  the device name (e.g. /dev/pts/1) -- not a file descript=
or.

But is this really the best one can do? I suppose on could also add a
test if the device is a character device but I just wonder if there
isn't a better way.

isatty()  works on a file descriptor, but we don't have that yet. I
suppose one could try to open that and then test but then care needs
to be made to use that opened file descriptor and not say close and
reopen that.

Any other thoughts or suggestions?

Thanks again.

