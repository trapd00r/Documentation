From zsh-workers-request@euclid.skiles.gatech.edu  Sun Nov 10 16:19:03 1996
Return-Path: zsh-workers-request@euclid.skiles.gatech.edu
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id QAA03828 for <mason@primenet.com.au>; Sun, 10 Nov 1996 16:19:00 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id AAA24220; Sun, 10 Nov 1996 00:15:00 -0500 (EST)
Resent-Date: Sun, 10 Nov 1996 00:15:00 -0500 (EST)
From: Geoff Wing <gwing@primenet.com.au>
Message-Id: <199611100512.QAA03809@coral.primenet.com.au>
Subject: Re: Purified zsh-3.0.1
To: hniksic@srce.hr (Hrvoje Niksic)
Date: Sun, 10 Nov 1996 16:12:41 +1100 (EST)
Cc: zsh-workers@math.gatech.edu
In-Reply-To: <kigohh6tw4g.fsf@jagor.srce.hr> from "Hrvoje Niksic" at Nov 10, 96 05:25:03 am
X-Mailer: ELM [version 2.4 PL25]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"3TOaY2.0.Mw5.JJMXo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2359
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hrvoje Niksic wrote:
:I have run a purified version of zsh-3.0.1 on solaris2.5, and here is
:what I got:
:ABR: Array bounds read
:This is in refreshline [zle_refresh.c:583]:
:               /* 3: main display loop - write out the buffer using whatever tricks we can */
:                   for (;;) {
:            =>         if (*nl && nl[1] == ol[1])      /* skip only if second chars match */
:I hope this will help debugging...  Those ABR-s in line editor could
:be the cause of coredumps seen on Ultrix, that are quite hard to
:repeat.

This is a patch (on top of 2351 and its predecessor though it'll patch without
them)
I believe it will fix said problem.  It doesn't seem likely to me that it
would be the cause of any coredumps.

*** zle_refresh.c.~2~	Sat Nov  9 21:08:12 1996
--- zle_refresh.c	Sun Nov 10 16:01:03 1996
***************
*** 615,621 ****
  /* 3: main display loop - write out the buffer using whatever tricks we can */
  
      for (;;) {
! 	if (*nl && nl[1] == ol[1])	/* skip only if second chars match */
  	/* skip past all matching characters */
  	    for (; *nl && (*nl == *ol); nl++, ol++, ccs++) ;
  
--- 615,621 ----
  /* 3: main display loop - write out the buffer using whatever tricks we can */
  
      for (;;) {
! 	if (*nl && *ol && nl[1] == ol[1]) /* skip only if second chars match */
  	/* skip past all matching characters */
  	    for (; *nl && (*nl == *ol); nl++, ol++, ccs++) ;
  

-- 
Geoff Wing [gwing@primenet.com.au]   Technical Manager
  Phone    : +61-3-9818 2977	     PrimeNet - Internet Consultancy
  Facsimile: +61-3-9819 3788	     Web : <URL:http://www.primenet.com.au/>
  Mobile   : 0412 162 441

