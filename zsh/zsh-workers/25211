From zsh-workers-return-25211-mason-zsh=primenet.com.au@sunsite.dk Wed Jun 18 17:11:50 2008
Return-Path: <zsh-workers-return-25211-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17061 invoked from network); 18 Jun 2008 17:11:48 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 Jun 2008 17:11:48 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 14437 invoked from network); 18 Jun 2008 17:11:45 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 Jun 2008 17:11:45 -0000
Received: (qmail 16170 invoked by alias); 18 Jun 2008 17:11:42 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25211
Received: (qmail 16157 invoked from network); 18 Jun 2008 17:11:42 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 18 Jun 2008 17:11:42 -0000
Received: from vms173003pub.verizon.net (vms173003pub.verizon.net [206.46.173.3])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 2025F8084FA0
	for <zsh-workers@sunsite.dk>; Wed, 18 Jun 2008 19:11:33 +0200 (CEST)
Received: from torch.brasslantern.com ([71.121.0.2]) by vms173003.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0K2O007S052MFHS5@vms173003.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Wed, 18 Jun 2008 12:11:11 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id m5IHB9Xt012753	for
 <zsh-workers@sunsite.dk>; Wed, 18 Jun 2008 10:11:09 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id m5IHB8TS012752	for zsh-workers@sunsite.dk; Wed,
 18 Jun 2008 10:11:08 -0700
Date: Wed, 18 Jun 2008 10:11:08 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: environment settings
In-reply-to: <20080618115227.GZ5016@sc.homeunix.net>
To: zsh-workers@sunsite.dk
Message-id: <080618101108.ZM12751@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <20080617125834.GI5016@sc.homeunix.net>
	<20080617131154.GM10734@prunille.vinc17.org>
	<20080617132611.GL5016@sc.homeunix.net>
	<237967ef0806170628m56b80d3anaf252e68ad6c497d@mail.gmail.com>
	<20080617142557.GO5016@sc.homeunix.net>
	<20080617155429.GT10734@prunille.vinc17.org>
	<20080617160009.GS5016@sc.homeunix.net>
	<20080617195007.GV10734@prunille.vinc17.org>
	<20080617203229.GU5016@sc.homeunix.net>
	<20080618103808.GB10734@prunille.vinc17.org>
	<20080618115227.GZ5016@sc.homeunix.net>
Comments: In reply to Stephane Chazelas <Stephane_Chazelas@yahoo.fr>
 "Re: environment settings" (Jun 18, 12:52pm)
X-Virus-Scanned: ClamAV 0.92.1/7499/Wed Jun 18 15:02:05 2008 on bifrost
X-Virus-Status: Clean

On Jun 18, 12:52pm, Stephane Chazelas wrote:
}
} Most of the processes a user every runs are run during his login
} session.
}
} Basically, there's nothing for "a file that should set env
} variable for every process run by this given user".

The definition of a "login session" has unfortunately become very
uncertain.  The Gnome desktop via GDM on Ubuntu, for example, does
not perform "login session"-type initialization (or at least, does
not do so in a way specific to the user's shell from /etc/passwd).
The default gnome-terminal configuration also does not create login
shells when opening new windows.  Without some more-than-trivial
knowledge of Gnome configuration, there is no way for a user to
accomplish the things that you attribute to a single login session.

} - ~/.forward: depends on the MTA, I don't think the user's shell
}   is involved.

It depends on the program invoked (procmail derives $SHELL from
/etc/passwd -- users are often advised to add SHELL=/bin/sh early
in their .procmailrc unless they know exactly what they are doing).
Also, there are ways other than the .forward that filter programs,
etc. can be invoked from an MTA.

} But in all the cases above, the user can explicitely call a "sh"
} that sources a file that does the "exports".

Even granting that this is true, why solve the same problem again
every time a new situation comes up?

For example purposes, here's part of what I do in .zshenv:

----
if [[ -O $HOME ]]
then 
  # Use version-controlled configuration library if available
  [[ -d $HOME/.zsh ]] && ZDOTDIR=$HOME/.zsh
else
  # Not me, or not my home directory, don't read the startup files
  setopt NO_RCS
  return 0
fi
PATH=${ZSH_ENVPATH:-$PATH}
export ZSH_ENVPATH=$PATH
----

This is followed by some miscellaneous stuff to delete stupid settings
that misguided Linux packagers have at various times placed in the
/etc/zshenv file, and set $fpath in case $0 indicates I'm running zsh
from a non-standard location (like out of my development sandbox).  The
ZSH_ENVPATH setting assures that I can always reset $PATH to the system
default before modifying it.

