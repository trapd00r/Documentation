From zsh-workers-request@math.gatech.edu  Sun Jul  9 14:57:34 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id OAA23018 for <mason@werple.mira.net.au>; Sun, 9 Jul 1995 14:57:27 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA08944
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Sun, 9 Jul 1995 00:57:56 -0400
Received: by math (5.x/SMI-SVR4)
	id AA09939; Sun, 9 Jul 1995 00:54:51 -0400
Resent-Date: Sun, 09 Jul 1995 00:53:47 -0400
Old-Return-Path: <coleman@math.gatech.edu>
Message-Id: <9507090453.AA10898@redwood.skiles.gatech.edu>
X-Mailer: exmh version 1.5.3 12/28/94
To: zsh-workers@math.gatech.edu
Subject: Re: A couple of queries 
In-Reply-To: Your message of "Sun, 09 Jul 1995 05:28:18 BST."
             <25792.199507090428@stone.dcs.warwick.ac.uk> 
Mime-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Date: Sun, 09 Jul 1995 00:53:47 -0400
From: Richard Coleman <coleman@math.gatech.edu>
Resent-Message-Id: <"rCO0J3.0.9R2.Q4s_l"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/188
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> In glob.c, in the function file_type() (which contains the delightful
> comment "screw POSIX"), there is commented-out code that would return a
> character '&' instead of '@' for a symbolic link that doesn't point
> anywhere accessible.  Considering that compatibility with "ls -F" isn't
> really an issue here (and '%' and '#' are returned for devices which ls
> doesn't do), why is this code not used?

I haven't seen that code.  I was going to remove that comment, but forgot.
The code has been posix-ified considerably since the start of the 2.6
cycle.

> Secondly, I had an idea for a new option for a couple of builtins.
> compctl has an option -L that makes zsh output the actual compctl
> commands that one would have to input in order to get to the current
> set of completion options.  A similar option would be very useful for
> alias, bindkey (especially), limit, sched and typeset.  (typeset -L is
> already taken, so it would have to be something else, but the others
> can be -L.)  These options would not only be useful in normal use of
> the shell, but would also simplify the reporter script greatly (which
> btw won't run here -- awk syntax errors).  This option could be added
> to each of the builtins quite easily, and without (much) risk of
> breaking anything else.  What are people's opinions on this idea?
> Richard, would you be willing to add this to the baseline before the
> 2.7 release?

I'm not against adding them if they don't add too much code.  I think these
would be useful.  But I would prefer to use the same option for all of them.
So we need an option letter that is free on all of these builtins, and would
have to change compctl -L to match this.  Since compctl -L is new, this
shouldn't cause too much problem.  Also, in order to make things easier,
I would prefer that the changes to each builtin be put in a separate patch
if possible.

But I would prefer that we wait until the next beta release before this is
implemented.  My box is overflowing with patches.  I'm in the process
of making more changes to the code dealing with internal hash tables.  So
any patch adding these features would be broken by the time I receive it.
Also, with the big patches from Peter (for the history code) and some of the
other big patches, the code will change a lot in the next couple of releases.

Also, just to let everyone know, I'll probably also add the compctl -Q option
either in this release or the next one.

But, my current priority is still to continue the process of cleaning up the
code.  I want to fix the structural problems first, so things like Peter's
patch for history.c will go in first.  I'm also doing some work on param.c.

So the next beta release might take a while.  So what I'll probably do is
make code snapshots (test releases) available starting in about a week,
so people can help me work out all the bugs I'll probably be adding.

rc

