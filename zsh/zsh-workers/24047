From zsh-workers-return-24047-mason-zsh=primenet.com.au@sunsite.dk Thu Nov 01 10:44:22 2007
Return-Path: <zsh-workers-return-24047-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17011 invoked from network); 1 Nov 2007 10:44:12 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Nov 2007 10:44:12 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 99284 invoked from network); 1 Nov 2007 10:44:07 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Nov 2007 10:44:07 -0000
Received: (qmail 18742 invoked by alias); 1 Nov 2007 10:44:03 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24047
Received: (qmail 18705 invoked from network); 1 Nov 2007 10:44:01 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 1 Nov 2007 10:44:01 -0000
Received: (qmail 98772 invoked from network); 1 Nov 2007 10:44:01 -0000
Received: from norsk.toidinamai.de (78.47.249.60)
  by a.mx.sunsite.dk with SMTP; 1 Nov 2007 10:43:55 -0000
Received: from [172.22.13.12] (i59F76207.versanet.de [89.247.98.7])
	(Authenticated sender: frank)
	by norsk.toidinamai.de (Postfix) with ESMTP id 30538280926;
	Thu,  1 Nov 2007 10:43:54 +0000 (UTC)
Message-ID: <4729AD5C.7030808@benkstein.net>
Date: Thu, 01 Nov 2007 11:41:32 +0100
From: Frank Benkstein <frank@benkstein.net>
User-Agent: Icedove 1.5.0.14pre (X11/20071018)
MIME-Version: 1.0
To:  zsh-workers@sunsite.dk
Subject: Bug in compdef()
X-Enigmail-Version: 0.94.3.0
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="------------enig61962C12472AA8FA6DA689AE"

This is an OpenPGP/MIME signed message (RFC 2440 and 3156)
--------------enig61962C12472AA8FA6DA689AE
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi,

there seems to be a bug in compdef that prevents more than three
commands from using the same completion service.  The problem can be
illustrated by the following commands:

  $ compdef foo=3Dmount
  $ compdef bar=3Dmount
  $ compdef baz=3Dmount
  compdef: unknown command or service: mount

The cause of this error is an invalid use of the 'R' array subscript
flag.  The following patch fixes the issue.

Best regards
Frank Benkstein.

diff -ur zsh-4.3.4/Completion/compinit zsh-4.3.4.fixed/Completion/compini=
t
--- zsh-4.3.4/Completion/compinit	2006-11-01 13:25:22.000000000 +0100
+++ zsh-4.3.4.fixed/Completion/compinit	2007-11-01 11:22:16.739402608 +01=
00
@@ -271,7 +271,7 @@
         if [[ "$1" =3D *\=3D* ]]; then
 	  cmd=3D"${1%%\=3D*}"
 	  svc=3D"${1#*\=3D}"
-          func=3D"$_comps[${_services[(R)$svc]:-$svc}]"
+          func=3D"$_comps[${_services[(r)$svc]:-$svc}]"
           [[ -n ${_services[$svc]} ]] &&
               svc=3D${_services[$svc]}
 	  [[ -z "$func" ]] &&

--=20
GPG (Mail): 7093 7A43 CC40 463A 5564  599B 88F6 D625 BE63 866F
GPG (XMPP): 2243 DBBA F234 7C5A 6D71  3983 9F28 4D03 7110 6D51


--------------enig61962C12472AA8FA6DA689AE
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFHKa1jiPbWJb5jhm8RAnvAAJ9o7qpJ+Gz0xS0OGXvfiPc2BBw7UACcDbh2
GmBjGXeamOMvpYGYIxaaJdY=
=A8E3
-----END PGP SIGNATURE-----

--------------enig61962C12472AA8FA6DA689AE--

