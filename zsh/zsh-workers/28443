From zsh-workers-return-28443-mason-zsh=primenet.com.au@zsh.org Wed Nov 24 16:59:18 2010
Return-Path: <zsh-workers-return-28443-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13199 invoked by alias); 24 Nov 2010 16:59:18 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 28443
Received: (qmail 10822 invoked from network); 24 Nov 2010 16:59:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.0 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,FREEMAIL_FROM,MISSING_HEADERS,RCVD_IN_DNSWL_NONE,
	T_TO_NO_BRKTS_FREEMAIL,URIBL_RED autolearn=no version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 74.125.83.43 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:content-type:mime-version
         :subject:from:in-reply-to:date:cc:content-transfer-encoding
         :message-id:references:x-mailer;
        bh=Wn+SJpGJH42IuuH06vXYFo2XWTPx/QWWgTqV/M1Lhj8=;
        b=tbiCKa4twWC1ZyuNdWx+rtslGDeeIhLQ39C/1FZ9BZ9TFvf2dJemQ5gPTX7HS89qB5
         eWGAPVTMG4LteccJw2Q6zXgmC2wneLcbejBZLdw2wTbcXdqdQ6P7xnU6cytIjqte2sVo
         s3vm9ss4zP2PUREhUQnJyk+iE7l1Df3pKnqhs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=content-type:mime-version:subject:from:in-reply-to:date:cc
         :content-transfer-encoding:message-id:references:x-mailer;
        b=cd+NEs5YVOf83FI2URqRvPvSanjknLuvx+UEaXS1qTTfl2Z+B0NrNd1bXPy5jJqKzt
         zmLLNdZQAhVeRPYCBMrYR3LGBIoyypRnBpQjcHbFAErKH0jHWpCdfG3UCc6JfgRnWWK/
         MJ3ZoPgEBj0CtdTB8iYhfd7d7p8Yb//Lut++4=
Content-Type: text/plain; charset=iso-8859-1
Mime-Version: 1.0 (Apple Message framework v1082)
Subject: Re: Mac OS X Prompt Bug
From: Sorin Ionescu <sorin.ionescu@gmail.com>
In-Reply-To: <20101124153007.GF1727@prunille.vinc17.org>
Date: Wed, 24 Nov 2010 11:59:11 -0500
Cc: zsh-workers@zsh.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <9ADAD50F-12F2-4B0A-A494-F339583AEDEC@gmail.com>
References: <BAB9C52A-B68A-4B5A-99C2-F85B310B1380@gmail.com> <20101124153007.GF1727@prunille.vinc17.org>
X-Mailer: Apple Mail (2.1082)

Yes, iTerm2 does not have this problem. While unsetopt PROMPT_SP removes =
the %, the blank lines are still echoed. The easiest way to test this is =
to touch ~/.hushlogin and open Terminal.app. Notice the scrollbar.

So, PROMPT_SP is definitely not the problem. It seems the prompt is =
being pushed down by the blank lines. Hence why % is not being =
overwritten by the prompt in the screenshot.

On 24 Nov 2010, at 10:30, Vincent Lefevre wrote:

> Hi,
>=20
> On 2010-11-24 08:58:26 -0500, Sorin Ionescu wrote:
>> Please have a look at the screenshot at
>> http://i.imgur.com/huNpI.jpg. Otherwise, the following text may not
>> make sense.
>>=20
>> A % character appears before every prompt then it is replaced by the
>> prompt;
>=20
> This is a very useful feature (which can be disabled), to know when
> some output hasn't been followed by a newline character, e.g. try
>=20
>  echo -n foo
>=20
> Other shells do not do this, hence the difference.
>=20
>> so, it only flashes for a fraction of a second. However, if
>> the buffer is empty when ZSH starts, such as when one has a
>> ~/.hushlogin file, it results in the behaviour in the screenshot,
>> which is % character followed by blank lines.
>=20
> I don't have such a problem under Mac OS X (using iTerm, but I hadn't
> noticed it with Terminal either in the past). This may come from the
> terminal (a bug?) or its configuration.
>=20
> --=20
> Vincent Lef=E8vre <vincent@vinc17.net> - Web: <http://www.vinc17.net/>
> 100% accessible validated (X)HTML - Blog: =
<http://www.vinc17.net/blog/>
> Work: CR INRIA - computer arithmetic / Ar=E9naire project (LIP, =
ENS-Lyon)

