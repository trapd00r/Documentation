From zsh-workers-return-24212-mason-zsh=primenet.com.au@sunsite.dk Tue Dec 11 14:18:30 2007
Return-Path: <zsh-workers-return-24212-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24788 invoked from network); 11 Dec 2007 14:18:22 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Dec 2007 14:18:22 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 40964 invoked from network); 11 Dec 2007 14:18:17 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Dec 2007 14:18:17 -0000
Received: (qmail 21282 invoked by alias); 11 Dec 2007 14:18:13 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24212
Received: (qmail 21270 invoked from network); 11 Dec 2007 14:18:12 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 11 Dec 2007 14:18:12 -0000
Received: from virusfilter.dotsrc.org (bifrost [127.0.0.1])
	by spamfilter.dotsrc.org (Postfix) with ESMTP id CB1608058F3B
	for <zsh-workers@sunsite.dk>; Tue, 11 Dec 2007 15:15:38 +0100 (CET)
Received: from prunille.vinc17.org (vinc17.pck.nerim.net [213.41.242.187])
	by bifrost.dotsrc.org (Postfix) with ESMTP
	for <zsh-workers@sunsite.dk>; Tue, 11 Dec 2007 15:15:38 +0100 (CET)
Received: by prunille.vinc17.org (Postfix, from userid 501)
	id D28551C63612; Tue, 11 Dec 2007 15:18:09 +0100 (CET)
Date: Tue, 11 Dec 2007 15:18:09 +0100
From: Vincent Lefevre <vincent@vinc17.org>
To: zsh-workers@sunsite.dk
Subject: Re: Shared history and locales (charmap)
Message-ID: <20071211141809.GU13079@prunille.vinc17.org>
Mail-Followup-To: zsh-workers@sunsite.dk
References: <20071211135412.GB7651@prunille.vinc17.org> <237967ef0712110559r1475c4dek92dc4cc732b68a09@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <237967ef0712110559r1475c4dek92dc4cc732b68a09@mail.gmail.com>
X-Mailer-Info: http://www.vinc17.org/mutt/
User-Agent: Mutt/1.5.17-vl-r19795 (2007-12-08)
X-Virus-Scanned: ClamAV using ClamSMTP

On 2007-12-11 14:59:33 +0100, Mikael Magnusson wrote:
> On 11/12/2007, Vincent Lefevre <vincent@vinc17.org> wrote:
[...]
> > IMHO, there should be an option so that the history is stored and
> > retrieved in UTF-8. And if for some reason, zsh finds an invalid
> > UTF-8 sequence in the history, it should use the current charmap
> > as a fallback. In practice, this would allow zsh to continue to
> > work with old history files.
> 
> I think it should insert any invalid bytes as a $'\abc' sequence.
> Just because I'm running a terminal in another locale doesn't mean
> all my files were renamed...

Well, this should be controlled by an option, and possibly shell
functions as hooks to be able to do smart recoding. The problem is
that one has basically two kinds of arguments: filenames and user
text. For user text, it sometimes makes sense to recode the argument.

BTW, due to these encoding problems, I never put non-ASCII characters
in my filenames. So, for me, this is almost only user text.

-- 
Vincent Lefèvre <vincent@vinc17.org> - Web: <http://www.vinc17.org/>
100% accessible validated (X)HTML - Blog: <http://www.vinc17.org/blog/>
Work: CR INRIA - computer arithmetic / Arenaire project (LIP, ENS-Lyon)

