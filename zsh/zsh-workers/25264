From zsh-workers-return-25264-mason-zsh=primenet.com.au@sunsite.dk Fri Jul 04 17:40:19 2008
Return-Path: <zsh-workers-return-25264-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24176 invoked from network); 4 Jul 2008 17:40:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 4 Jul 2008 17:40:17 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 52851 invoked from network); 4 Jul 2008 17:40:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 4 Jul 2008 17:40:09 -0000
Received: (qmail 8011 invoked by alias); 4 Jul 2008 17:40:06 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25264
Received: (qmail 4645 invoked from network); 4 Jul 2008 17:33:25 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 4 Jul 2008 17:33:25 -0000
Received: from userg501.nifty.com (userg501.nifty.com [202.248.238.81])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id D0EA880524FA
	for <zsh-workers@sunsite.dk>; Fri,  4 Jul 2008 19:33:17 +0200 (CEST)
Received: from vdr.jp (nttyma063133.tyma.nt.ftth4.ppp.infoweb.ne.jp [116.81.157.133])by userg501.nifty.com with ESMTP id m64HXC52010528;
	Sat, 5 Jul 2008 02:33:12 +0900
X-Nifty-SrcIP: [116.81.157.133]
Received: by vdr.jp (Postfix, from userid 1000)
	id 861809101D8; Sat,  5 Jul 2008 02:33:12 +0900 (JST)
Date: Sat, 5 Jul 2008 02:33:12 +0900
From: d+zsh@vdr.jp
Sender: d+zsh@vdr.jp
To: zsh-workers@sunsite.dk
Subject: strange w3m completion
Message-ID: <20080704173312.GA5619@vdr.jp>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-2022-jp
Content-Disposition: inline
User-Agent: Mutt/1.5.18 (2008-05-17)
X-Virus-Scanned: ClamAV 0.92.1/7638/Fri Jul  4 13:41:46 2008 on bifrost
X-Virus-Status: Clean

Hi,

I got strange w3m completion in zsh 4.3.6-4 (Debian).

For example,

----- ~/.zshrc -----
autoload -U compinit
compinit
--------------------

----- ~/.w3m/history -----
http://example.com/index.html
http://example.com/file.html
--------------------------

behavior 1) 
% w3m http://example.com

If I hit tab, then I get below result.

% w3m http://example.com/.html

and I hit tab in a row,
but I cannot get another results.

behavior 2)
% w3m http://example.com/

If I hit tab, then I get below result.

% w3m http://example.com/
http://example.com/file.html   http://example.com/index.html

Behavior 1) is not intentional and I am inconvenienced.
So, I modified zsh/functions/Completion/Unix/_w3m,
It makes behavior 1) gets the same result that behavior 2)'s.

--- /usr/share/zsh/functions/Completion/Unix/_w3m.bak	2008-07-05 00:39:20.000000000 +0900
+++ /usr/share/zsh/functions/Completion/Unix/_w3m	2008-07-05 02:20:08.000000000 +0900
@@ -83,9 +83,10 @@
     fi
     _alternative \
       'files:file:_files -g "*.x#html(-.)"' \
-      'urls:URL:_urls' \
       'bookmarks:bookmarks:compadd -a bookmarks' \
-      'history:history:compadd -a w3mhistory' && ret=0
+      'history:history:compadd -a w3mhistory' \
+      'urls:URL:_urls' \
+      && ret=0
   ;;
   option)
     local -a options

But I do not know whether it is correct approarch,
it is feared that it makes a bad side effect.
Please let me know better approach if exists.

Regards,
-- 
	dai

