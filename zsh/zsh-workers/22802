From zsh-workers-return-22802-mason-zsh=primenet.com.au@sunsite.dk Sun Oct 01 16:48:56 2006
Return-Path: <zsh-workers-return-22802-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22228 invoked from network); 1 Oct 2006 16:48:54 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.5 (2006-08-29) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 1 Oct 2006 16:48:54 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 22820 invoked from network); 1 Oct 2006 16:48:47 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 1 Oct 2006 16:48:47 -0000
Received: (qmail 19886 invoked by alias); 1 Oct 2006 16:48:45 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22802
Received: (qmail 2316 invoked from network); 26 Sep 2006 19:05:23 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 26 Sep 2006 19:05:23 -0000
Received: (qmail 76893 invoked from network); 26 Sep 2006 19:05:23 -0000
Received: from lucien.blight.com (204.10.50.50)
  by a.mx.sunsite.dk with SMTP; 26 Sep 2006 19:05:19 -0000
Received: from lucien.blight.com (localhost [127.0.0.1])
	by lucien.blight.com (0.0.0/0.0.0) with ESMTP id k8QJ5ET8016018;
	Tue, 26 Sep 2006 14:05:14 -0500
Received: (from larold@localhost)
	by lucien.blight.com (0.0.0/0.0.0) id k8QJ5EsU016016;
	Tue, 26 Sep 2006 14:05:14 -0500
Date: Tue, 26 Sep 2006 14:05:14 -0500
From: "Larry P. Schrof" <larry@schrof.net>
To: Andrey Borzenkov <arvidjaar@newmail.ru>
Cc: zsh-workers@sunsite.dk
Subject: Re: (Revisited): zsh + less == hard hang of tty.
Message-ID: <20060926190514.GA14473@lucien.blight.com>
References: <20060926142946.GA1608@lucien.blight.com> <20060926172651.GB29060@lucien.blight.com> <200609261750.k8QHoAXv002753@news01.csr.com> <200609262215.24576.arvidjaar@newmail.ru>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <200609262215.24576.arvidjaar@newmail.ru>
User-Agent: Mutt/1.4.2i

Good call.

There was one env variable set - LESSOPEN.
It was set to: |/usr/bin/lesspipe.sh %s

As soon as I did 'unset LESSOPEN', less ceased to hang.

I apologize if this is falling too far out of the jurisdiction
of zsh development, but I can't reproduce the problem in any other
shells.

I swear, I'll get strace output soon.

- Larry

On Tue, Sep 26, 2006 at 10:15:24PM +0400, Andrey Borzenkov wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> On Tuesday 26 September 2006 21:50, Peter Stephenson wrote:
> > "Larry P. Schrof" wrote:
> > > - When I get a Linux tty to hang by doing this, log in on another tty,
> > >   and kill the *less* process, it terminates, and any I/O that was in
> > >   the buffer (from my extra keystrokes while less was hung) get
> > >   interpreted by the shell. zsh becomes responsive again.
> >
> > Sounds from this you may need to run strace on the less inside
> > the zsh -c (or just do it interactively), since zsh appears to be
> > just blithely waiting.  We'll probably find less is trying to
> > grab the terminal and failing, or something like that... quite
> > what we do if that's the case, I'm not sure.
> 
> I have been running the same versions for quite some time without any problem 
> (nor do I now have problem with zsh CVS).  One thing to check is what 
> LESSPIPE (or other LESSxxxx) environments set to and try with all of them 
> unset first.
> 
> The only other thing that comes in mind is some weird interaction with job 
> control. 
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.5 (GNU/Linux)
> 
> iD8DBQFFGW48R6LMutpd94wRAoVkAJ9lxLqhk565YT2ttHqdBwjt0OtlQACgnJdx
> Zn4+97A0rtI16apU0XSkQak=
> =RUyL
> -----END PGP SIGNATURE-----

