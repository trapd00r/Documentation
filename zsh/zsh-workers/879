From hzoli@cs.elte.hu Sun Mar 31 10:00:13 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id KAA09209 for <mason@werple.mira.net.au>; Sun, 31 Mar 1996 10:00:11 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id SAA16593; Sat, 30 Mar 1996 18:48:11 -0500 (EST)
Resent-Date: Sat, 30 Mar 1996 18:48:11 -0500 (EST)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199603302309.AAA01573@hzoli.ppp.cs.elte.hu>
Subject: Math substitution core dumps
To: zsh-workers@math.gatech.edu (Zsh hacking and development)
Date: Sun, 31 Mar 1996 00:09:17 +0100 (MET)
X-Mailer: ELM [version 2.4ME+ PL11 (25)]
MIME-Version: 1.0
Content-Type: application/pgp; format=text; x-action=sign
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"sugV22.0.B34.wWSNn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/879
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1467
Status: O

-----BEGIN PGP SIGNED MESSAGE-----

$[*2] type bad math substitutions can cause core dumps.

The fix below is already included in beta13-hzoli13

Bye,

Zoltan

 rcsdiff -qc -kk -r1.8 -r1.9 math.c
 *** math.c
 --- math.c	1996/03/04 00:22:39	1.9
 ***************
 *** 454,461 ****
       return 1;
   }
   
 ! #define pop2() { b = stack[sp--].val; a = stack[sp--].val; }
 ! #define pop3() {c=stack[sp--].val;b=stack[sp--].val;a=stack[sp--].val;}
   #define nolval() {stack[sp].lval= -1;}
   #define pushv(X) { push(X,-1); }
   #define pop2lv() { pop2() lv = stack[sp+1].lval; }
 --- 454,476 ----
       return 1;
   }
   
 ! #define pop2() {\
 ! 	if (sp < 1) {\
 !  	    zerr("bad math expression: unbalanced stack", NULL, 0);\
 ! 	    return;\
 ! 	}\
 ! 	b = stack[sp--].val;\
 ! 	a = stack[sp--].val;\
 !     }
 ! #define pop3() {\
 ! 	if (sp < 2) {\
 !  	    zerr("bad math expression: unbalanced stack", NULL, 0);\
 ! 	    return;\
 ! 	}\
 ! 	c = stack[sp--].val;\
 ! 	b = stack[sp--].val;\
 ! 	a = stack[sp--].val;\
 !     }
   #define nolval() {stack[sp].lval= -1;}
   #define pushv(X) { push(X,-1); }
   #define pop2lv() { pop2() lv = stack[sp+1].lval; }

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3i
Charset: noconv

iQCVAwUBMV2/GwupSCiLN749AQEslgP9EWb64gSDn5xW9uWCGoRS8pGvI406Fvni
E2wDJwbRed1zjKv5Tgc96AG2UClj92hKf/yAfVliq8jSTFaZLZ2gx1NE0kBFeMOR
AFec1jjA52oxoxpUL0OGsYN/a6RPtiN03Oz2pTV5ejvU4SDSyeY+nQpyWkTYEyKx
lqzOj+rYAos=
=ov5U
-----END PGP SIGNATURE-----
