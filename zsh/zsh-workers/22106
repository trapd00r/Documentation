From zsh-workers-return-22106-mason-zsh=primenet.com.au@sunsite.dk Mon Dec 26 23:48:28 2005
Return-Path: <zsh-workers-return-22106-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23915 invoked from network); 26 Dec 2005 23:48:25 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Dec 2005 23:48:25 -0000
Received: (qmail 75500 invoked from network); 26 Dec 2005 23:48:18 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Dec 2005 23:48:18 -0000
Received: (qmail 24424 invoked by alias); 26 Dec 2005 23:48:15 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22106
Received: (qmail 24093 invoked from network); 26 Dec 2005 23:40:53 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 26 Dec 2005 23:40:53 -0000
Received: (qmail 71631 invoked from network); 26 Dec 2005 23:40:53 -0000
Received: from mail.gmx.net (213.165.64.21)
  by a.mx.sunsite.dk with SMTP; 26 Dec 2005 23:40:53 -0000
Received: (qmail invoked by alias); 26 Dec 2005 23:40:51 -0000
Received: from p54AC4A06.dip.t-dialin.net (EHLO [192.168.1.90]) [84.172.74.6]
  by mail.gmx.net (mp038) with SMTP; 27 Dec 2005 00:40:51 +0100
X-Authenticated: #7810190
Message-ID: <43B07F7F.7010206@gmx.net>
Date: Tue, 27 Dec 2005 00:40:47 +0100
From: Jonas Kramer <jonas.kramer@gmx.net>
User-Agent: Mozilla Thunderbird 1.0.7 (X11/20051208)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To:  zsh-workers@sunsite.dk
Subject: ZSH-Bug (?): glibc, "double-free or corruption"
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0

Hi,

I think I found a bug here. I'm just writing a CGI page in ZSH script 
and the server (lighttpd 1.4.7) kills my script and logs messages like 
the followings to the error log file:

(\M-x^M^HH($\M-3init.z:13: no matches found: ()
*** glibc detected *** double free or corruption (!prev): 0x080df4f8 ***
2005-12-27 00:16:55: (mod_cgi.c.553) cgi died, pid: 10981
\M-T^M^HHx\M-/\M-%init.z:13: no matches found: ()
*** glibc detected *** double free or corruption (!prev): 0x080dd168 ***
2005-12-27 00:21:25: (mod_cgi.c.553) cgi died, pid: 30457
\M-(*^N^HH\M-(\M-C\M-/init.z:13: no matches found: ()
*** glibc detected *** double free or corruption (!prev): 0x080e8478 ***
2005-12-27 00:23:16: (mod_cgi.c.553) cgi died, pid: 10287
\M-b^M^HHX5\M-"init.z:13: no matches found: ()
*** glibc detected *** double free or corruption (!prev): 0x080ddf68 ***
2005-12-27 00:23:44: (mod_cgi.c.553) cgi died, pid: 21509
\M-h]^N^HHx\M--\M-)init.z:13: no matches found: ()
*** glibc detected *** double free or corruption (!prev): 0x080e5ab8 ***
2005-12-27 00:25:17: (mod_cgi.c.553) cgi died, pid: 19649
x\M-4^M^HH\M-8\M-B\M-)init.z:13: no matches found: ()
*** glibc detected *** double free or corruption (!prev): 0x080db148 ***
2005-12-27 00:25:24: (mod_cgi.c.553) cgi died, pid: 27245
(\M-[^M^HHXQ\M-&init.z:13: no matches found: ()
*** glibc detected *** double free or corruption (!prev): 0x080dd7f8 ***
2005-12-27 00:26:13: (mod_cgi.c.553) cgi died, pid: 30891

The relevant source in init.z is the following:

typeset -A POST
if [ $CONTENT_LENGTH -gt 0 ]; then
  read -n 0 -k $CONTENT_LENGTH BUF
  IFS="\r\n"
  for LINE in ($(print $BUF)); do
    IFS="="
    X=($(print $LINE))
                print "$X[1] -> $X[2]<br>"
  done
fi

I'd be grateful for any ideas to avoid this behaviour until the bug is 
fixed. :)

Greetings,

Jonas

