From zsh-workers-return-26086-mason-zsh=primenet.com.au@sunsite.dk Mon Nov 24 10:02:59 2008
Return-Path: <zsh-workers-return-26086-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18533 invoked from network); 24 Nov 2008 10:02:46 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.3 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 24 Nov 2008 10:02:46 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 83059 invoked from network); 24 Nov 2008 10:02:35 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 24 Nov 2008 10:02:35 -0000
Received: (qmail 10924 invoked by alias); 24 Nov 2008 10:02:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 26086
Received: (qmail 10907 invoked from network); 24 Nov 2008 10:02:28 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 24 Nov 2008 10:02:28 -0000
Received: from cluster-g.mailcontrol.com (cluster-g.mailcontrol.com [208.87.233.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id B882880525B4
	for <zsh-workers@sunsite.dk>; Mon, 24 Nov 2008 11:02:24 +0100 (CET)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly18g.srv.mailcontrol.com (MailControl) with ESMTP id mAOA12fD010716
	for <zsh-workers@sunsite.dk>; Mon, 24 Nov 2008 10:02:19 GMT
Received: from news01 ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 24 Nov 2008 10:02:05 +0000
Date: Mon, 24 Nov 2008 10:02:05 +0000
From: Peter Stephenson <pws@csr.com>
To: zsh-workers@sunsite.dk
Subject: Re: _history-complete-older buggy
Message-ID: <20081124100205.748b858b@news01>
In-Reply-To: <081123105116.ZM25424@torch.brasslantern.com>
References: <237967ef0811230401j7bcceb0bg5e68b95483c344bf@mail.gmail.com>
	<081123105116.ZM25424@torch.brasslantern.com>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 24 Nov 2008 10:02:05.0450 (UTC) FILETIME=[B466F6A0:01C94E1B]
X-Scanned-By: MailControl A_08_51_00 (www.mailcontrol.com) on 10.71.0.128
X-Virus-Scanned: ClamAV 0.92.1/8669/Mon Nov 24 09:21:48 2008 on bifrost
X-Virus-Status: Clean

On Sun, 23 Nov 2008 10:51:16 -0800
Bart Schaefer <schaefer@brasslantern.com> wrote:
> On Nov 23,  1:01pm, Mikael Magnusson wrote:
> }
> } If i type a * and press _history-complete-older, i get this output
> } 
> } _all_labels:39: unmatched "
>
> I note this comment in comp_match():
> 
> 	     * Almost certainly this fails in some complicated cases
> 	     * but it should catch the basic ones.
> 
> I wonder if comp_match() should set noerrs before parse_subst_string()?
> Or perhaps there's a more comprehensive (and less hackish) fix.

Unfortunately quotation in completion has proved too horrific for me even
to be able to make it better rather than worse so far...  I didn't look at
this particular example, but the similar case of nested quotes was using up
vast amounts of my time without me really getting very far.  I suspect,
without looking at this case in detail, that the noerrs route and an
extended comment is the best that's likely to happen this side of the
fourth millenium.  It's possible there's a local fix of some sort; finding
it is another matter.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

