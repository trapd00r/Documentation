From zsh-workers-return-6491-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 07 09:46:31 1999
Return-Path: <zsh-workers-return-6491-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 703 invoked from network); 7 Jun 1999 09:46:29 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Jun 1999 09:46:29 -0000
Received: (qmail 8846 invoked by alias); 7 Jun 1999 09:46:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6491
Received: (qmail 8839 invoked from network); 7 Jun 1999 09:46:04 -0000
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: "Peter Stephenson" <pws@ibmth.df.unipi.it>,
        "Zsh hackers list" <zsh-workers@sunsite.auc.dk>
Subject: RE: Function installation
Date: Mon, 7 Jun 1999 13:37:24 +0400
Message-ID: <000501beb0c9$597a60a0$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2314.1300
In-Reply-To: <9906070753.AA23487@ibmth.df.unipi.it>
Importance: Normal

>
> * --enable-fndir=directory allows you to specify a function installation
>   directory; default is ${datadir}/zsh-fns, almost certainly
>   ${prefix}/share/zsh-fns
>

Peter, are you so fond of cryptic names? Why not simply {datadir}/zsh or, at
least, ${datadir}/zsh/functions ? (In hope, that may be some more stuff will
evtl go into base dir).

> * The given directory is compiled as the default value for $fpath/$FPATH
>
> * `make install' or `make install.fns' will install all functions from
>   under Completion and Functions into that directory, `make uninstall' or
>   `make uninstall.fns' will delete them.
>

May I argue that? Most functions in Functions are hardly more than examples;
some of them are outdated (who needs cdmatch/multi_comp with new
completion?). I believe, this choice should be left to those, who maintains
ZSH distributions (RPMs), and it should default to off for source install.

The same with new completion stuff. The files, that must be installed (if at
all) are Core, Base and (probably) Builtins. Without them new completion
won't run. But again, I don't want to see a bunch of completions for GNUish
systems here - I don't use GNU tools.

So. I'd prefer the way to separately install Completion and Functions, with
Functions being off by default. And to select, what part is installed.

Peter, what about something like this:

use variables like FUNCTIONS_INCLUDE and/or FUNCTIONS_EXCLUDE. They could be
initialized by configure; and then I could set FUNCTIONS_EXCLUDE='Commands/*
User/*' FUNCTIONS_INCLUDE='Users/_configure' to get only this one installed?


> * --disable-fndir or --enable-fndir=no turns off both installation of
>   functions and the default $fpath/$FPATH
>

See above.



New Completion Intialisation. Again.

Now, that we (almost) have the stuff there in fpath automagically, please,
consider once again making compinit a function. It would provide for
system-independent rc files - instead of figuring out, where the hell these
functions are placed here, you simply write compinit - and you're done.

I would even opt for a simple builtin that simply sources this file (may be,
under different name to avoid confusion). That file could be then placed in
different dir - let's say, smply ${datadir}/zsh, so, that it won't mess up
in $fpath.

/andrej


