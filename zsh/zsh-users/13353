From zsh-users-return-13353-mason-zsh=primenet.com.au@sunsite.dk Mon Oct 20 22:19:44 2008
Return-Path: <zsh-users-return-13353-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3922 invoked from network); 20 Oct 2008 22:19:11 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00,SPF_HELO_PASS
	autolearn=ham version=3.2.5
Received: from ns2.primenet.com.au (HELO primenet.com.au) (203.24.36.3)
  by ns1.primenet.com.au with (DHE-RSA-AES256-SHA encrypted) SMTP; 20 Oct 2008 22:19:11 -0000
Received: (qmail 11016 invoked from network); 20 Oct 2008 15:24:33 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns2.melb.primenet.com.au with SMTP; 20 Oct 2008 15:24:33 -0000
Received-SPF: none (ns2.melb.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 98927 invoked from network); 20 Oct 2008 15:23:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 20 Oct 2008 15:23:26 -0000
Received: (qmail 22347 invoked by alias); 20 Oct 2008 15:22:35 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 13353
Received: (qmail 22322 invoked from network); 20 Oct 2008 15:22:31 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 20 Oct 2008 15:22:31 -0000
Received: from vms172069pub.verizon.net (vms172069pub.verizon.net [206.46.172.69])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 5929180524C0
	for <zsh-users@sunsite.dk>; Mon, 20 Oct 2008 17:22:28 +0200 (CEST)
Received: from torch.brasslantern.com ([96.238.220.215])
 by vms172069.mailsrvcs.net
 (Sun Java System Messaging Server 6.2-6.01 (built Apr  3 2006))
 with ESMTPA id <0K910071NMPAMG24@vms172069.mailsrvcs.net> for
 zsh-users@sunsite.dk; Mon, 20 Oct 2008 10:22:23 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id m9KFMLNq021196	for
 <zsh-users@sunsite.dk>; Mon, 20 Oct 2008 08:22:22 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id m9KFMLHN021195	for zsh-users@sunsite.dk; Mon,
 20 Oct 2008 08:22:21 -0700
Date: Mon, 20 Oct 2008 08:22:21 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Globbing on what the completion function would suggest?
In-reply-to: <2d460de70810191426q7e03f770o9dd8e3f74da166c@mail.gmail.com>
To: zsh-users <zsh-users@sunsite.dk>
Message-id: <081020082221.ZM21194@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <2d460de70810191312x4d9cedfm48e1b24e19aa51b6@mail.gmail.com>
	<237967ef0810191319q41af9dfcl70af836211ac4395@mail.gmail.com>
	<2d460de70810191426q7e03f770o9dd8e3f74da166c@mail.gmail.com>
Comments: In reply to "Richard Hartmann" <richih.mailinglist@gmail.com>
 "Re: Globbing on what the completion function would suggest?" (Oct 19, 11:26pm)
X-Virus-Scanned: ClamAV 0.92.1/8449/Mon Oct 20 15:48:09 2008 on bifrost
X-Virus-Status: Clean

On Oct 19, 11:26pm, Richard Hartmann wrote:
}
} I should have been clearer in my initial email: I don't want to do
} this interactively, I want to do this on the CLI or in a script.

In order to do this, you'd have to write a wrapper function that sets
up a fake completion context (the compstate hash, the words array,
the values of all the ZLE special variables, and so on), and that
also defines compset and compadd functions, etc.  Then you'd have to
examine whatever arguments were passed to your dummy compadd after
you invoke the completer function.

Or equivalently you need to re-implement all the completion modules in
non-interactive versions that don't need the ZLE line context.

A third possibility is to do what comptest.zsh in the test suite does:
Create a psuedo-terminal with zpty running an interactive shell, send
it a partial command line and a list-choices keystroke to produce a
completion listing, and then read back the results.

