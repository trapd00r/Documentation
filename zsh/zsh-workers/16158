From zsh-workers-return-16158-mason-zsh=primenet.com.au@sunsite.dk Thu Oct 25 16:18:28 2001
Return-Path: <zsh-workers-return-16158-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7599 invoked from network); 25 Oct 2001 16:18:27 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 25 Oct 2001 16:18:27 -0000
Received: (qmail 23205 invoked by alias); 25 Oct 2001 16:18:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16158
Received: (qmail 23176 invoked from network); 25 Oct 2001 16:18:17 -0000
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <1011025161814.ZM9048@candle.brasslantern.com>
Date: Thu, 25 Oct 2001 16:18:14 +0000
In-Reply-To: <1011025160950.ZM9018@candle.brasslantern.com>
Comments: In reply to Bart Schaefer <schaefer@brasslantern.com>
        ""read -q" and TAB" (Oct 25,  4:09pm)
References: <1011025160950.ZM9018@candle.brasslantern.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk
Subject: PATCH (proposed): Re: "read -q" and TAB
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Oct 25,  4:09pm, Bart Schaefer wrote:
}
} Does anyone remember why utils.c:getquery() interprets TAB as 'y'?  This
} has been this way forever (or at least as far back as my own CVS records
} go) and my only guess is that it has something to do with spckword().

In particular, I suggest the following patch:

Index: Src/utils.c
===================================================================
--- Src/utils.c	2001/10/22 14:36:45	1.9
+++ Src/utils.c	2001/10/25 16:15:05
@@ -1477,7 +1477,7 @@
     }
 
     while ((c = read1char()) >= 0) {
-	if (c == 'Y' || c == '\t')
+	if (c == 'Y')
 	    c = 'y';
 	else if (c == 'N')
 	    c = 'n';
@@ -1641,11 +1641,11 @@
 		free(pptbuf);
 		fflush(shout);
 		zbeep();
-		x = getquery("nyae ", 0);
+		x = getquery("nyae \t", 0);
 	    }
 	} else
 	    x = 'y';
-	if (x == 'y' || x == ' ') {
+	if (x == 'y' || x == ' ' || x == '\t') {
 	    *s = dupstring(best);
 	    if (hist)
 		hwrep(best);


-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

