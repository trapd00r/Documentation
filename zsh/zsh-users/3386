From zsh-users-return-3386-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Aug 21 17:48:46 2000
Return-Path: <zsh-users-return-3386-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16639 invoked from network); 21 Aug 2000 17:48:45 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 21 Aug 2000 17:48:45 -0000
Received: (qmail 3772 invoked by alias); 21 Aug 2000 17:48:24 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3386
Received: (qmail 3765 invoked from network); 21 Aug 2000 17:48:22 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <000821104808.ZM29840@candle.brasslantern.com>
Date: Mon, 21 Aug 2000 10:48:08 -0700
In-Reply-To: <14752.50467.89781.100331@paullew-ultra.cisco.com>
Comments: In reply to Paul Lew <paullew@cisco.com>
        "TRAPNAL with TMOUT problem" (Aug 20, 10:58pm)
References: <14752.50467.89781.100331@paullew-ultra.cisco.com>
X-Mailer: Z-Mail Lite (5.0.0 30July97)
To: Paul Lew <paullew@cisco.com>, zsh-users@sunsite.auc.dk
Subject: Re: TRAPNAL with TMOUT problem
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Aug 20, 10:58pm, Paul Lew wrote:
> Subject: TRAPNAL with TMOUT problem
> 
> The 'idle' time for command 'w' is now affected by the invocation of
> TRAPALRM function, i.e., if I defined TMOUT to be 3600, zsh will never
> show idle more than 60 minutes.

The "idle" time is nothing more than the difference between the access
time and the modification time of the tty device file for the associated
terminal.  I have a TMOUT/TRAPALRM that updates the title bar of my xterm
every 60 seconds, yet my w output still shows me as having been idle all
weekend on terminals I haven't touched yet this morning.

Probably what's happening is that the terminal is getting "accessed" when
the background job runs.  (My traps use only builtins, so no new job group
needs to become associated with the terminal.)

Try starting the background jobs with stdin/out/err all redirected and a
trailing &! token to "disown" them.  I'm not certain that wll prevent zsh
from associating the job with the terminal, but it's easy to test.

