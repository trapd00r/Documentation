From zsh-workers-return-22675-mason-zsh=primenet.com.au@sunsite.dk Thu Sep 07 18:44:11 2006
Return-Path: <zsh-workers-return-22675-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9669 invoked from network); 7 Sep 2006 18:44:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.4 (2006-07-25) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Sep 2006 18:44:09 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 67117 invoked from network); 7 Sep 2006 18:44:02 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Sep 2006 18:44:02 -0000
Received: (qmail 22155 invoked by alias); 7 Sep 2006 18:44:00 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22675
Received: (qmail 22145 invoked from network); 7 Sep 2006 18:43:59 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Sep 2006 18:43:59 -0000
Received: (qmail 66832 invoked from network); 7 Sep 2006 18:43:59 -0000
Received: from mtaout03-winn.ispmail.ntl.com (81.103.221.49)
  by a.mx.sunsite.dk with SMTP; 7 Sep 2006 18:43:57 -0000
Received: from aamtaout03-winn.ispmail.ntl.com ([81.103.221.35])
          by mtaout03-winn.ispmail.ntl.com with ESMTP
          id <20060907184357.GJME1865.mtaout03-winn.ispmail.ntl.com@aamtaout03-winn.ispmail.ntl.com>;
          Thu, 7 Sep 2006 19:43:57 +0100
Received: from pwslaptop.csr.com ([81.107.41.155])
          by aamtaout03-winn.ispmail.ntl.com with SMTP
          id <20060907184357.WLSJ11710.aamtaout03-winn.ispmail.ntl.com@pwslaptop.csr.com>;
          Thu, 7 Sep 2006 19:43:57 +0100
Date: Thu, 7 Sep 2006 19:43:52 +0100
From: Peter Stephenson <p.w.stephenson@ntlworld.com>
To: "Gene Carter" <gananda@gmail.com>, zsh-workers@sunsite.dk
Subject: Re: zsh hangs on AIX 4.3.3
Message-Id: <20060907194352.2e63cd0c.p.w.stephenson@ntlworld.com>
In-Reply-To: <bf7e3eaf0609010856l753eb484pe863afafaf4c660c@mail.gmail.com>
References: <bf7e3eaf0609010856l753eb484pe863afafaf4c660c@mail.gmail.com>
X-Mailer: Sylpheed version 2.2.6 (GTK+ 2.8.20; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Fri, 1 Sep 2006 11:56:15 -0400
"Gene Carter" <gananda@gmail.com> wrote:
> I'm trying to use zsh on an AIX 4.3.3 box. Unfortunately, I appear to be
> hitting a bug related to a wait
> on signals.

Unfortunately it looks like there's no AIX host at Sourceforge, so
there's no way for us to debug this, unless it turns up on another
system.  That seems unlikely (for common systems like Linux and Solaris,
anyway), since someone ought to have tripped over it by now, I would
think.

> The script seems to make it through about 351 interations, and then
> hangs.

Do you mean the second number output would be 351, or 35100?  In any
case I seem to have got to about 300000 with no problems (Fedora Core 5
on x86 with the latest zsh source), but I'll leave it running.

sigsuspend(), which is where the shell is hanging, is the standard POSIX
mechanism.  The only suggestion I can make is that you try defining
BROKEN_POSIX_SIGSUSPEND in config.h and recompiling to see if that
helps.  It's not very likely, however.  Alternatively, try one of the
other signal handling styles: undefine POSIX_SIGNALS in config.h and define
BSD_SIGNALS or SYSV_SIGNALS.  (They won't necessarily compile and link.)

Other than that, someone is going to have take a deeper look with a
debugger.  Are there jobs in the table given by the jobtab variable that
aren't done (the index maxjob gives the highest possible valid one)?  If
so, what is the state of them and the process structures pointed to by
them?

-- 
Peter Stephenson <p.w.stephenson@ntlworld.com>
Web page now at http://homepage.ntlworld.com/p.w.stephenson/

