From zsh-users-return-3424-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Sep 13 15:06:02 2000
Return-Path: <zsh-users-return-3424-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4066 invoked from network); 13 Sep 2000 15:06:00 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Sep 2000 15:06:00 -0000
Received: (qmail 4197 invoked by alias); 13 Sep 2000 15:04:07 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3424
Received: (qmail 4170 invoked from network); 13 Sep 2000 15:03:41 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000913150238.ZM6854@candle.brasslantern.com>
Date: Wed, 13 Sep 2000 15:02:38 +0000
In-Reply-To: <mvbu2bkd4cd.fsf@phobos.lrde.epita.fr>
Comments: In reply to Alexandre Duret-Lutz <duret_g@lrde.epita.fr>
        "Re: more wishes with automounter" (Sep 13, 11:32am)
References: <200009111436.KAA02215@soup.ads.apexinc.com> 
	<mvb66o27s0g.fsf@phobos.lrde.epita.fr> 
	<1000912065847.ZM5756@candle.brasslantern.com> 
	<mvbu2bkd4cd.fsf@phobos.lrde.epita.fr>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Alexandre Duret-Lutz <duret_g@lrde.epita.fr>, zsh-users@sunsite.auc.dk
Subject: Re: more wishes with automounter
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Sep 13, 11:32am, Alexandre Duret-Lutz wrote:
} Subject: Re: more wishes with automounter
}
}     zstyle -e ':completion:*' file-patterns \
}       '[[ $PREFIX == /nfs/[^/]# ]] && \
}         { setopt noglob ; reply=(*(@,/)) ; setopt glob }'
} 
} Leads to:
} 
} ~ % ls /nfs/<TAB>
} _path_files:327: bad pattern: /nfs/*(@

This is because _files splits the file-patterns at commas on line 58.  I'm
not sure why, or how to fix it.  It might be to replace

    pat="${${${sdef%%:${tag}*}//\\:/:}//,/ }"

with

    pat="${${${sdef%%:${tag//,/ }*}//\\:/:}}"

but I fear that only Sven knows for sure.  In any case, a qualifier with
a comma in it would interact badly with the file-sort tag, because it will
be rewritten as e.g. *(@,/Om), which is not what you meant.

The workaround is to use reply=(*(@) *(/)) in your style instead.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

