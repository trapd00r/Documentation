From zsh-workers-request@euclid.skiles.gatech.edu  Thu Aug  1 18:39:25 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id SAA04626 for <mason@primenet.com.au>; Thu, 1 Aug 1996 18:39:22 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id EAA04660; Thu, 1 Aug 1996 04:32:18 -0400 (EDT)
Resent-Date: Thu, 1 Aug 1996 04:32:18 -0400 (EDT)
Message-Id: <199608010831.KAA28871@hydra.ifh.de>
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: Announcement draft 
In-reply-to: "bas@astro.uva.nl"'s message of "01 Aug 1996 08:36:50 MET."
             <ja3f27happ.fsf@leda.astro.uva.nl> 
Date: Thu, 01 Aug 1996 10:31:03 +0200
From: Peter Stephenson <pws@ifh.de>
Resent-Message-ID: <"lusLF2.0.k81.Hk60o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1860
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

bas@astro.uva.nl wrote:
> > /bin/sh can be safely linked to zsh.
> 
> This sounded too good to be true, so I just tested this on the perl
> Configure script and it failed, sorry.  (To be slightly more precise:
> when typing '& -d' at a prompt to make it use the defaults zsh gives
> me a parse error, while /bin/sh (POSIX, not traditional Bourne) has no
> problems.  This on HPUX 10.10.)

Irix, too.  I think I've pinpointed this: it happens when the `myread'
file for later sourcing is set up as a here document.

% <testscr
cat <<EOSC >test.out
eval "ans=\"\$answ\""
EOSC
% zsh -fc 'emulate sh; . ./testscr' 
% <test.out
eval "ans="$answ""
% sh -c '. ./testscr'
% <test.out
eval "ans=\"$answ\""

Zsh is stripping the backslash from the double quotes.  This looks
wrong to me.  `answ' contains the user input, here "& -d", which is
causing the problem.  (I didn't look into the specific nature of the
problem, but the errors is reported on that line, which is the only
one which is significantly different from the sh version of myread.)

Anyone know the proper backslash rules for here documents?


By the way: some time after 3.0 is released and stable (preferably not
in that order :-/) it would be quite nice to have ksh/sh emulation as
a command line option, to avoid what I had to do above (linking zsh
under sh, when there's a real sh on the machine, is no nicer).

-- 
Peter Stephenson <pws@ifh.de>       Tel: +49 33762 77366
WWW:  http://www.ifh.de/~pws/       Fax: +49 33762 77330
Deutches Electronen-Synchrotron --- Institut fuer Hochenergiephysik Zeuthen
DESY-IfH, 15735 Zeuthen, Germany.

