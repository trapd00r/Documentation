From zsh-workers-return-11924-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 15 09:31:31 2000
Return-Path: <zsh-workers-return-11924-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18940 invoked from network); 15 Jun 2000 09:31:30 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Jun 2000 09:31:30 -0000
Received: (qmail 23501 invoked by alias); 15 Jun 2000 09:31:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11924
Received: (qmail 23494 invoked from network); 15 Jun 2000 09:31:22 -0000
Date: Thu, 15 Jun 2000 11:31:20 +0200 (MET DST)
Message-Id: <200006150931.LAA06433@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Sven Wischnowsky's message of Thu, 15 Jun 2000 11:29:22 +0200
	(MET DST)
Subject: PATCH: Re: Unitialized memory reads again.


Sigh.


Bye
 Sven

Index: Src/Zle/compmatch.c
===================================================================
RCS file: /cvsroot/zsh/zsh/Src/Zle/compmatch.c,v
retrieving revision 1.19
diff -u -r1.19 compmatch.c
--- Src/Zle/compmatch.c	2000/06/13 09:05:37	1.19
+++ Src/Zle/compmatch.c	2000/06/15 09:30:31
@@ -488,7 +488,7 @@
 	 */
 
 	bslash = 0;
-	if (test && !sfx &&
+	if (test && !sfx && lw &&
 	    (l[ind] == w[ind] ||
 	     (bslash = (lw > 1 && w[ind] == '\\' &&
 			(ind ? (w[0] == l[0]) : (w[1] == l[0])))))) {
@@ -803,7 +803,7 @@
 	/* Same code as at the beginning, used in top-level calls. */
 
 	bslash = 0;
-	if ((!test || sfx) &&
+	if ((!test || sfx) && lw &&
 	    (l[ind] == w[ind] ||
 	     (bslash = (lw > 1 && w[ind] == '\\' &&
 			(ind ? (w[0] == l[0]) : (w[1] == l[0])))))) {

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

