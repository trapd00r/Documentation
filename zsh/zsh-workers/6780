From zsh-workers-return-6780-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jun 22 09:56:59 1999
Return-Path: <zsh-workers-return-6780-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21506 invoked from network); 22 Jun 1999 09:56:58 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Jun 1999 09:56:58 -0000
Received: (qmail 12047 invoked by alias); 22 Jun 1999 09:56:30 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6780
Received: (qmail 12039 invoked from network); 22 Jun 1999 09:56:29 -0000
Date: Tue, 22 Jun 1999 11:56:28 +0200 (MET DST)
Message-Id: <199906220956.LAA24677@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Peter Stephenson's message of Tue, 22 Jun 1999 11:04:35 +0200
Subject: Re: PATCH: collist v2.0


Peter Stephenson wrote:

> - go somewhere with too many files
> - type `echo <menu-select key>'  (without the quotes, of course)
> - answer n to the message
> - the first menucompletion match is inserted; hit TAB to go to the next

Forgot to clear showinglist...

Btw.: If you start with menu-select you can't `continue'
menu-completion with a different widget. That's caused by the test at
zle_tricky.c:809 that was changed when we were working on _oldlist.

However, you can continue menu-completion by repeatedly invoking
menu-select (it degenerates into normal menu-completion when it
doesn't get its list).

Bye
 Sven

diff -u os/Zle/collist.c Src/Zle/collist.c
--- os/Zle/collist.c	Tue Jun 22 11:51:28 1999
+++ Src/Zle/collist.c	Tue Jun 22 11:52:03 1999
@@ -292,9 +292,10 @@
     int mc, ml = 0, cc, hasm = 0;
     struct listcols col;
 
-    if (minfo.asked == 2)
+    if (minfo.asked == 2) {
+	showinglist = 0;
 	return (noselect = 1);
-
+    }
     getcols(&col);
 
     /* Set the cursor below the prompt. */

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

