From zsh-users-return-2156-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Feb 15 15:33:33 1999
Return-Path: <zsh-users-return-2156-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21178 invoked from network); 15 Feb 1999 15:33:32 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 15 Feb 1999 15:33:32 -0000
Received: (qmail 25840 invoked by alias); 15 Feb 1999 15:32:07 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 2156
Received: (qmail 25833 invoked from network); 15 Feb 1999 15:32:03 -0000
Comments: ( Received on motgate.mot.com from client pobox.mot.com, sender schrof@cig.mot.com )
Message-Id: <199902151522.KAA06190@po_box.cig.mot.com>
Date: Mon, 15 Feb 1999 09:20:59 -0600
From: "Larry P . Schrof" <schrof@cig.mot.com>
To: vherva@turing.netspan.fi
Cc: zsh-users@sunsite.auc.dk, skarkkai@turing.netspan.fi
Subject: Re: Terminal problem with linux-2.0.34
References: <19990214112653.A22618@turing.netspan.fi>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.1i
In-Reply-To: <19990214112653.A22618@turing.netspan.fi>; from vherva@turing.netspan.fi on Sun, Feb 14, 1999 at 11:26:53AM +0200

This is amazing. I never thought anyone else would actually be having
this problem. I also have a machine running 2.0.34, and it has a lot
of uptime. You describe it perfectly, but I have additional
symptoms:

- Any time the user runs a program that makes a stat() call, the
shell hangs forever, until the user breaks out of it. Even after sending
the process, say ls -l, a signal, it takes awhile to get the shell prompt
back.

At first, this problem would go away simply by running another zsh
and thus incrementing SHLVL. Another solution was to ssh in, run an xterm
that then ran zsh - this put me one shell level deeper as well, which
fixed the problem.

However, after a fwew more months of uptime, the bug would KICK ME OFF the
system when I tried to log in. I ssh'ed in and ran an xterm, which
spawned zsh. So now, I was a shell level deeper, which USED to fix
the problem. Instead, it exhibited the behavior that we described above -
no echoing of characters, hitting return twice (honestly, it sounds like
a lag behind by a certain # of keystrokes problem), etc. etc.

Once the behaviort got the state describe in the last paragraph, zsh
would also unexpectedly seg fault when running certain processes.
(I could not correlate a pattern as to which ones bailed and which ones
didn't)

My guess is that it's either zsh or something with Linux.  To those of
you who have not seen this problem, it is NASTY. It makes interactive
sessions nearly impossible.

- Larry

On Sun, Feb 14, 1999 at 11:26:53AM +0200, vherva@turing.netspan.fi wrote:
> I have been using zsh on a linux-2.0.34 machine without any problems.
> However, when the uptime exceeded 250 days, the zsh began having problems
> with the terminal. Of course, the uptime should have nothing to do with
> this, but on the other hand, there where no software updates that I could 
> imagine having affect to zsh's terminal handling. Zsh, termcap, libc or 
> anything like that was not updated.
> 
> The flaw in the terminal handling appears as follows: when I type text
> on the command line, only the first two characters are echoed. The line
> does show up, if erase a character. Also, the command line is only
> executed after I press return twice.
> 
> I tried updating to 3.0.7 and 3.1.5, and the bug still appeared.
> 
> Needless to say, bash and other shell and tools are unaffected.
> 
> I have not experienced this problem on any other machine. Since the 
> problem only appeared after 250 days of uptime its rather hard to trace 
> down on other machines. However, I would appreciate any clues on where 
> to look. For now, I forced to use bash -- which is clearly not satisfactory 
> -- so I am keen to find fix or workaround for this.
> 
> 
>  
> -- v --
> 
> --
> Ville Herva   Ville.Herva@netspan.fi   +358-50-5164500
> Netspan Oy    netspan@netspan.fi       PL 65  FIN-02151 Espoo    
>               http://www.netspan.fi
> For my PGP key, finger vherva@netspan.fi.

