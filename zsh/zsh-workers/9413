From zsh-workers-return-9413-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jan 24 08:57:21 2000
Return-Path: <zsh-workers-return-9413-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11647 invoked from network); 24 Jan 2000 08:57:20 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 24 Jan 2000 08:57:20 -0000
Received: (qmail 7980 invoked by alias); 24 Jan 2000 08:57:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9413
Received: (qmail 7970 invoked from network); 24 Jan 2000 08:57:13 -0000
Date: Mon, 24 Jan 2000 09:57:11 +0100 (MET)
Message-Id: <200001240857.JAA02632@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: misc.


Just some cleanups... a missing `zsh/' module name prefix, the test
for the new completion system in zfinit wasn't correct and some
`... might be used uninitialized' warnings.

Bye
 Sven

diff -ru ../z.old/Functions/Zftp/zfinit Functions/Zftp/zfinit
--- ../z.old/Functions/Zftp/zfinit	Mon Jan 24 09:22:57 2000
+++ Functions/Zftp/zfinit	Mon Jan 24 09:55:12 2000
@@ -2,7 +2,7 @@
 
 [[ $1 = -n ]] || zmodload -e zsh/zftp || zmodload -ia zsh/zftp zftp || return 1
 
-if zmodload -i zutil; then
+if zmodload -i zsh/zutil; then
   local arr
   # Set defaults for styles if none set.
   zstyle -g arr ':zftp:*' progress || zstyle ':zftp:*' progress bar
@@ -31,7 +31,7 @@
 # zftp completions: only use these if new-style completion is not
 # active.
 #
-if [[ ${#_patcomps} -eq 0 || -z ${_patcomps[(r)zf*]} ]]; then
+if [[ ${#_patcomps} -eq 0 || -z ${_patcomps[(r)_zf*]} ]]; then
   # only way of getting that noglob out of the way: this is unnecessary with
   # widget-based completion
   setopt completealiases
diff -ru ../z.old/Src/Modules/zutil.c Src/Modules/zutil.c
--- ../z.old/Src/Modules/zutil.c	Mon Jan 24 09:22:04 2000
+++ Src/Modules/zutil.c	Mon Jan 24 09:55:12 2000
@@ -785,7 +785,7 @@
 	RParseState *st;
 	RParseBranch *br;
 	char *pattern, *lookahead;
-	int patternlen, lookaheadlen;
+	int patternlen, lookaheadlen = 0;
 
 	l = strlen(s);
 	if (!((2 <= l && s[l - 1] == '/') ||
diff -ru ../z.old/Src/loop.c Src/loop.c
--- ../z.old/Src/loop.c	Mon Jan 24 09:21:54 2000
+++ Src/loop.c	Mon Jan 24 09:55:13 2000
@@ -52,9 +52,9 @@
     Wordcode end, loop;
     wordcode code = state->pc[-1];
     int iscond = (WC_FOR_TYPE(code) == WC_FOR_COND);
-    char *name, *str, *cond, *advance;
+    char *name, *str, *cond = NULL, *advance = NULL;
     zlong val = 0;
-    LinkList args;
+    LinkList args = NULL;
 
     name = ecgetstr(state, 0);
     end = state->pc + WC_FOR_SKIP(code);

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

