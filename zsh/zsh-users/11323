From zsh-users-return-11323-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 21 11:53:18 2007
Return-Path: <zsh-users-return-11323-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25588 invoked from network); 21 Mar 2007 11:53:15 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.2 required=5.0 tests=AWL,BAYES_00,FORGED_RCVD_HELO,
	PLING_QUERY autolearn=no version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 21 Mar 2007 11:53:15 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 87146 invoked from network); 21 Mar 2007 11:53:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 21 Mar 2007 11:53:09 -0000
Received: (qmail 21570 invoked by alias); 21 Mar 2007 11:53:03 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11323
Received: (qmail 21561 invoked from network); 21 Mar 2007 11:53:03 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 21 Mar 2007 11:53:03 -0000
Received: (qmail 85983 invoked from network); 21 Mar 2007 11:53:03 -0000
Received: from cluster-d.mailcontrol.com (217.69.20.190)
  by a.mx.sunsite.dk with SMTP; 21 Mar 2007 11:53:00 -0000
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly15d.srv.mailcontrol.com (MailControl) with ESMTP id l2LBqlDb029360
	for <zsh-users@sunsite.dk>; Wed, 21 Mar 2007 11:52:57 GMT
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.1830);
	 Wed, 21 Mar 2007 11:52:55 +0000
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.13.8/8.13.4) with ESMTP id l2LBqoIl005245
	for <zsh-users@sunsite.dk>; Wed, 21 Mar 2007 11:52:51 GMT
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.13.8/8.13.8/Submit) with ESMTP id l2LBqn1r005242
	for <zsh-users@sunsite.dk>; Wed, 21 Mar 2007 11:52:50 GMT
Message-Id: <200703211152.l2LBqn1r005242@news01.csr.com>
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-users@sunsite.dk
Subject: Re: echo "!" ... what's wrong with the exclamation point ? 
In-reply-to: <20070321124237.0e17eace@louve.localdomain> 
References: <20070321124237.0e17eace@louve.localdomain>
Comments: In-reply-to Mildred <ml.mildred593@online.fr>
   message dated "Wed, 21 Mar 2007 12:42:37 +0100."
Date: Wed, 21 Mar 2007 11:52:49 +0000
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 21 Mar 2007 11:52:55.0850 (UTC) FILETIME=[76B6F8A0:01C76BAF]
Content-Type: text/plain
MIME-Version: 1.0
X-Scanned-By: MailControl A-07-06-85 (www.mailcontrol.com) on 10.68.0.125

Mildred wrote:
> I'm using zsh for some time but I just needed to put an exclamation
> point inside double quotes and I get something wierd:

This is traditional C shell "bang history".  It's described in the
zshexpn manual page under HISTORY EXPANSION.  You can turn it off
with

unsetopt banghistory

if you never use it (it sounds like you don't).  Alternatively,
- single quotes quote the !'s (double quotes don't)
- sticking a !" near the start of the line will turn off bang history
  for that line.
- add an extra \ before an exclamation mark.

Note that !'s are never active in text read from files (including
autoloaded functions), so you only see this effect at the command
line.

> $ echo "abc ! def"
> abc ! def

This still works because a ! followed by a space is specially treated.
That's so other uses of exclamation marks in tests still work.

> $ echo "abc !"
> dquote> "
> abc

This is the use I mentioned above to turn off special handling of !'s
for the rest of the line.  The !" gets swallowed up in one go by
the history mechanism---that's way it's still waiting for a double
quote and you don't get a ! in the output.

> $ echo "abc !! def"
> echo "abc echo "abc
> " def"
> abc echo abc
> zsh: command not found:  def

The !! refers to the complete previous line.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070


To access the latest news from CSR copy this link into a web browser:  http://www.csr.com/email_sig.php

To get further information regarding CSR, please visit our Investor Relations page at http://ir.csr.com/csr/about/overview

