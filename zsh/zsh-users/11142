From zsh-users-return-11142-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 23 15:16:13 2007
Return-Path: <zsh-users-return-11142-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16965 invoked from network); 23 Jan 2007 15:16:08 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 23 Jan 2007 15:16:08 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 19444 invoked from network); 23 Jan 2007 15:16:02 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 23 Jan 2007 15:16:02 -0000
Received: (qmail 10021 invoked by alias); 23 Jan 2007 15:15:51 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11142
Received: (qmail 10012 invoked from network); 23 Jan 2007 15:15:50 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 23 Jan 2007 15:15:50 -0000
Received: (qmail 17785 invoked from network); 23 Jan 2007 15:15:50 -0000
Received: from potato.vegetable.org.uk (HELO vegetable.org.uk) (62.197.40.130)
  by a.mx.sunsite.dk with SMTP; 23 Jan 2007 15:15:45 -0000
Received: from piglet by vegetable.org.uk with local (Exim 4.62)
	(envelope-from <piglet@stirfried.vegetable.org.uk>)
	id 1H9NIz-000402-Ig; Tue, 23 Jan 2007 15:11:25 +0000
From: Tim Haynes <zsh@stirfried.vegetable.org.uk>
X-Anti-Echelon: NSP
Original-Sender: zsh@potato.vegetable.org.uk
To: zsh-users@sunsite.dk
Subject: Re: What makes %# tick?
References: <86lkjurkpa.fsf@potato.vegetable.org.uk>
	<20070123143906.146ce338.pws@csr.com>
In-Reply-To: <20070123143906.146ce338.pws@csr.com>
Reply-To: Tim Haynes <zsh@stirfried.vegetable.org.uk>
X-Face: ^U5&X92>b!8p*:'D#4(v,^i:%PY<{42PE:uNu+2b;B.8nWJS?s9p[*f{z#io=NN%z,#?,PFzKhpAO{Mkq{EL<:ZB<MbT5~a{"v9PmTq~@-!kSe+pA?vAug$H9w#N_`SHTU#FEf^nj<wdcy!_rb]?+k2z!#;tTw(pe"pQ0r$(,VU/ROZ)`v.3eOtgf:&j<7qlv-_o
Date: 23 Jan 2007 15:11:24 +0000
Message-ID: <86fya1srqb.fsf@potato.vegetable.org.uk>
Lines: 39
User-Agent: Gnus/5.0808 (Gnus v5.8.8) XEmacs/21.4 (Jumbo Shrimp)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Sender: Tim Haynes <piglet@stirfried.vegetable.org.uk>

Peter Stephenson <pws@csr.com> writes:

> Tim Haynes <zsh@stirfried.vegetable.org.uk> wrote:
> >  | zsh, sauce 12:15PM piglet/ # id
> >  | uid=1000(piglet) gid=1000(piglet)
> >  | groups=10(wheel),16(cron),18(audio),19(cdrom),250(portage),1000(piglet)
> >  | zsh, sauce 12:15PM piglet/ # 
> >                               ^oops.
> > 
> > I'm running zsh-4.2.5 on an amd64 box (gentoo linux) and am rather
> > attached to my %# prompt specifier.
> 
> The test of %# uses the function privasserted which is commented thus:
> 
> /* Check whether the shell is running with privileges in effect.  *
>  * This is the case if EITHER the euid is zero, OR (if the system *
>  * supports POSIX.1e (POSIX.6) capability sets) the process'      *
>  * Effective or Inheritable capability sets are non-empty.        */
> 
> I'm not sure what this feature gains in practice but it's possible your
> realtime module means that there is something in the capability sets and
> the shell therefore thinks that you are an enchanced lifeform.

:) Yes, I remember reading about capabilities in this stuff to do with
jackd. Sounds likely.

> There is a workaround. The shell allows you to test for a particular
> effective UID, and in this case there's no funny business about
> capability sets. You can make this otherwise mimic the behaviour of "%#"
> by replacing that with "%(#.#.%%)".

That works perfectly. Thank ye greatly!

Cheers,

~Tim
-- 
Ideologies come, ideologies go         |zsh@stirfried.vegetable.org.uk
A waste of words, and endless flow     |http://pig.sty.nu/Pictures/gallery/

