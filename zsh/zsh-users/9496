From zsh-users-return-9496-mason-zsh=primenet.com.au@sunsite.dk Fri Oct 14 09:26:04 2005
Return-Path: <zsh-users-return-9496-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16975 invoked from network); 14 Oct 2005 09:25:57 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Oct 2005 09:25:57 -0000
Received: (qmail 2194 invoked from network); 14 Oct 2005 09:25:41 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Oct 2005 09:25:41 -0000
Received: (qmail 2085 invoked by alias); 14 Oct 2005 09:25:34 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9496
Received: (qmail 2070 invoked from network); 14 Oct 2005 09:25:33 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 Oct 2005 09:25:33 -0000
Received: (qmail 1029 invoked from network); 14 Oct 2005 09:25:32 -0000
Received: from dsl3-63-249-88-2.cruzio.com (HELO dot.blorf.net) (63.249.88.2)
  by a.mx.sunsite.dk with SMTP; 14 Oct 2005 09:25:30 -0000
Received: by dot.blorf.net (Postfix, from userid 1000)
	id B83F31095; Fri, 14 Oct 2005 02:25:28 -0700 (PDT)
Date: Fri, 14 Oct 2005 02:25:28 -0700
From: Wayne Davison <wayned@users.sourceforge.net>
To: Com MN PG P E B Consultant 3 <mn-pg-p-e-b-consultant-3.com@siemens.com>
Cc: zsh-users Mailinglist <zsh-users@sunsite.dk>
Subject: Re: Bug or Feature? Clear line before prompt.
Message-ID: <20051014092528.GA7663@blorf.net>
References: <6F0CB04509C11D46A54232E852E390AC44B902@MCHP7R6A.ww002.siemens.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <6F0CB04509C11D46A54232E852E390AC44B902@MCHP7R6A.ww002.siemens.net>
User-Agent: Mutt/1.5.9i
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

On Fri, Oct 14, 2005 at 08:16:36AM +0200, Com MN PG P E B Consultant 3 wrote:
> Is there a way to tell zsh not to erase the line before writing the
> prompt?

This is taken from the FAQ:

  A better solution than disabling PROMPT_CR (for most terminals) is adding
  a simpler version of the PROMPT_SP (new in 4.3.0) functionality to an
  older zsh using a custom precmd function, like this one:

    # Skip defining precmd if the PROMPT_SP option is available.
    if ! eval '[[ -o promptsp ]] 2>/dev/null'; then
      function precmd {
        # Output an inverse char and a bunch spaces.  We include
        # a CR at the end so that any user-input that gets echoed
        # between this output and the prompt doesn't cause a wrap.
        print -nP "%B%S%#%s%b${(l:$((COLUMNS-1)):::):-}\r"
      }
    fi

  That precmd function will only bump the screen down to a new line if there
  was output on the prompt line, otherwise the extra chars get removed by
  the PROMPT_CR action.  Although this typically looks fine it may result
  in the spaces preceding the prompt being included when you select a line
  of preserved text with the mouse.

..wayne..

