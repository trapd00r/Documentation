From zsh-workers-return-7564-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Aug 31 09:49:50 1999
Return-Path: <zsh-workers-return-7564-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19149 invoked from network); 31 Aug 1999 09:49:46 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 31 Aug 1999 09:49:46 -0000
Received: (qmail 11784 invoked by alias); 31 Aug 1999 08:20:44 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7564
Received: (qmail 11762 invoked from network); 31 Aug 1999 08:20:37 -0000
Date: Tue, 31 Aug 1999 10:15:36 +0200 (MET DST)
Message-Id: <199908310815.KAA27365@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
CC: pws@ifh.de
In-reply-to: Peter Stephenson's message of Mon, 30 Aug 1999 18:00:22 +0200
Subject: Re: 6-pws-2


Peter Stephenson wrote:

> I have probably uploaded
> http://www.ifh.de/~pws/computing/zsh-3.1.6-pws-2.tar.gz
> 
> - This covers patches to 7551 with exceptions noted

Impressive. Everything is there. Thanks! (And sorry for the turmoil of 
patches.)

> - Updates to the completion system may be bungled.  I received some of the
>   patches in random order and could have skipped others because there were
>   many similar.

So far I've only seen the problem mentioned by Bart. The first hunk of 
the patch below fixes this (just for everyones convenience).

> - I only deleted Completion/User/_cvs after making 6-pws-2, delete it
>   by hand for now.  Let me know of other completion functions which are
>   now redundant.

It goes like this:

  cd Completion
  rm User/_{pbm,cvs} Base/_complete_opts
  mv User/_colors X/_x_color
  mv User/_cursors X/_x_cursor
  mv X/_x_options X/_x_arguments

... plus the second to n'th hunk from the patch below.

> - Personally, I prefer one single completion function for a suite of
>   related commands like cvs or pbm, since the accumulated clutter (and
>   added time to process completion files the first time) is large.  If it
>   stays the way it is I will change the default for function installation
>   to keep the subdirectories.

I agree that the increase in processing time is very ugly but I don't
have a problem with the many functions. However, you won't find it
hard to convince to support any attempt to clean this up. The
increasing use of `_arguments' already made me wish to find a better
way to give descriptions to it then by writing lots of functions that
just call `_arguments'. I don't have any ideas about this yet, though.

> - I still feel the new glob qualifiers for calling code to decide on files
>   to include may be overcomplicated.

Hm, I thought it is quite simple now... suggestions?

> - I've moved some files around and corrected a small typo (_arguements) in
>   _tar.

Thanks!


Bye
 Sven

diff -u oc/X/_xterm Completion/X/_xterm
--- oc/X/_xterm	Tue Aug 31 09:11:43 1999
+++ Completion/X/_xterm	Tue Aug 31 09:13:43 1999
@@ -22,75 +22,3 @@
   '-ziconbeep:iconbeep (percent):' \
   '-C' \
   '-S-:pseudo-terminal and file descriptor:'
-#compdef xterm
-
-_arguments \
-  '-version' \
-  '-help' \
-  '-132' \
-  '-ah' '+ah' \
-  '-ai' '+ai' \
-  '-aw' '+aw' \
-  '-b:inner border size:' \
-  '-bc' '+bc' \
-  '-bcf:time text cursor is off when blinking (milliseconds):' \
-  '-bcn:time text cursor is on when blinking (milliseconds):' \
-  '-bdc' '+bdc' \
-  '-cb' '+cb' \
-  '-cc:character class:' \
-  '-cm' '+cm' \
-  '-cn' '+cn' \
-  '-cr:text cursor color:_color' \
-  '-cu' '+cu' \
-  '-dc' '+dc' \
-  '-e:*::program: _normal' \
-  '-fb:bold font:' \
-  '-fi:icon font:' \
-  '-hc:background color for highlighted text:_color' \
-  '-hf' '+hf' \
-  '-ie' '+ie' \
-  '-im' '+im' \
-  '-j' '+j' \
-  '-leftbar' \
-  '-ls' '+ls' \
-  '-mb' '+mb' \
-  '-mc:multi-click threshold (milliseconds):' \
-  '-ms:pointer cursor color:_color' \
-  '-nb:margin bell number:' \
-  '-nul' '+nul' \
-  '-pc' '+pc' \
-  '-rightbar' \
-  '-rw' '+rw' \
-  '-s' '+s' \
-  '-samename' '+samename' \
-  '-sb' '+sb' \
-  '-sf' '+sf' \
-  '-si' '+si' \
-  '-sk' '+sk' \
-  '-sl:save lines:' \
-  '-sp' '+sp' \
-  '-t' '+t' \
-  '-ti:terminal ID:(vt52 vt100 vt101 vt102 vt220)' \
-  '-tm:terminal setting:' \
-  '-tn:terminal type:' \
-  '-u8' '+u8' \
-  '-ulc' '+ulc' \
-  '-ut' '+ut' \
-  '-vb' '+vb' \
-  '-wc' '+wc' \
-  '-wf' '+wf' \
-  '-ziconbeep:iconbeep (percent):' \
-  '-C' \
-  '-S-:pseudo-terminal and file descriptor:' \
-  '-bd:border color:_color' \
-  '-bg:background color:_color' \
-  '-bw:border width:' \
-  '-display:display:' \
-  '-fg:foreground color:_color' \
-  '-fn:font:' \
-  '-geometry:geometry:' \
-  '-iconic' \
-  '-name:name:' \
-  '-rv' \
-  '-title:title:' \
-  '-xrm:resource:'
diff -u -r oc/Pbmplus/_pgmtoppm Completion/Pbmplus/_pgmtoppm
--- oc/Pbmplus/_pgmtoppm	Tue Aug 31 09:11:33 1999
+++ Completion/Pbmplus/_pgmtoppm	Tue Aug 31 09:24:07 1999
@@ -4,10 +4,10 @@
 
 if [[ CURRENT -eq 2 ]]; then
   if compset -P '?*-'; then
-    _colors
+    _x_color
     return
   fi
-  _colors && ret=0
+  _x_color && ret=0
 
   _description expl option
   compadd "$expl[@]" - -map && ret=0
diff -u -r oc/Pbmplus/_pnmalias Completion/Pbmplus/_pnmalias
--- oc/Pbmplus/_pnmalias	Tue Aug 31 09:11:33 1999
+++ Completion/Pbmplus/_pnmalias	Tue Aug 31 09:24:21 1999
@@ -1,6 +1,6 @@
 #compdef pnmalias
 
-_arguments '-bgcolor:background color:_colors' \
-           '-fgcolor:foreground color:_colors' \
+_arguments '-bgcolor:background color:_x_color' \
+           '-fgcolor:foreground color:_x_color' \
 	   '-bonly' '-fonly' '-balias' '-falias' \
 	   '-weight:central aliasing weight:' ':file: _pbm_file'
diff -u -r oc/Pbmplus/_pnmmargin Completion/Pbmplus/_pnmmargin
--- oc/Pbmplus/_pnmmargin	Tue Aug 31 09:11:34 1999
+++ Completion/Pbmplus/_pnmmargin	Tue Aug 31 09:24:39 1999
@@ -1,4 +1,4 @@
 #compdef pnmmargin
 
-_arguments '-white' '-black' '-color:color: _colors' \
+_arguments '-white' '-black' '-color:color: _x_color' \
            ':border width:' ':file: _pbm_file'
diff -u -r oc/Pbmplus/_ppmchange Completion/Pbmplus/_ppmchange
--- oc/Pbmplus/_ppmchange	Tue Aug 31 09:11:35 1999
+++ Completion/Pbmplus/_ppmchange	Tue Aug 31 09:24:53 1999
@@ -10,6 +10,6 @@
   _description expl 'old color'
 fi
 
-_colors "$expl[@]" && ret=0
+_x_color "$expl[@]" && ret=0
 
 return ret
diff -u -r oc/Pbmplus/_ppmmake Completion/Pbmplus/_ppmmake
--- oc/Pbmplus/_ppmmake	Tue Aug 31 09:11:35 1999
+++ Completion/Pbmplus/_ppmmake	Tue Aug 31 09:25:03 1999
@@ -1,3 +1,3 @@
 #compdef ppmmake
 
-_arguments ':color: _colors' ':width:' ':height:'
+_arguments ':color: _x_color' ':width:' ':height:'
diff -u -r oc/Pbmplus/_ppmtoacad Completion/Pbmplus/_ppmtoacad
--- oc/Pbmplus/_ppmtoacad	Tue Aug 31 09:11:36 1999
+++ Completion/Pbmplus/_ppmtoacad	Tue Aug 31 09:25:15 1999
@@ -1,4 +1,4 @@
 #compdef ppmtoacad
 
-_arguments '-dxb' '-poly' '-background:background color:_colors' \
+_arguments '-dxb' '-poly' '-background:background color:_x_color' \
            '-white' '-aspect:pixel aspect ratio:' '-8' ':file: _pbm_file'
diff -u -r oc/User/_gs Completion/User/_gs
--- oc/User/_gs	Tue Aug 31 09:11:40 1999
+++ Completion/User/_gs	Tue Aug 31 10:01:34 1999
@@ -8,7 +8,7 @@
     return 1
   fi
 else
-  _x_options \
+  _x_arguments \
     -q \
     '-g-:device size (<width>x<height>):' \
     '-r-:resolution (<val> or <x>x<y>):' \
diff -u -r oc/X/_xdvi Completion/X/_xdvi
--- oc/X/_xdvi	Tue Aug 31 09:11:43 1999
+++ Completion/X/_xdvi	Tue Aug 31 10:02:09 1999
@@ -6,13 +6,13 @@
   '-altfont:default font:' \
   '-base:base URL:' \
   '-browser:WWW browser:_command_names -e' \
-  '-cr:cursor color:_colors' \
+  '-cr:cursor color:_x_color' \
   '-debug:debugging bitmask:((1\:bitmaps 2\:dvi\ translation 4\:pk\ reading 8\:batch\ operation 16\:events 32\:file\ opening 64\:PostScript\ communication 128\:Kpathsea\ statistics 256\:Kpathsea\ hash\ table\ lookups 512\:Kpathsea\ path\ definitions 1024\:Kpathsea\ path\ expansion 2048\:Kpathsea\ searches))' \
   '-density:font shrink density:' \
   '-gamma:anti-aliasing factor (default 1.0):' \
-  -grid{1,2,3}':grid color:_colors' \
+  -grid{1,2,3}':grid color:_x_color' \
   '-gspalette:Ghostscript palette:(Color Greyscale Monochrome)' \
-  '-hl:page highlight color:_colors' \
+  '-hl:page highlight color:_x_color' \
   '-icongeometry:icon geometry:_x_geometry' \
   '-interpreter:Ghostscript program:_command_names -e' \
   '-margin:margin size:' \
diff -u -r oc/X/_xfig Completion/X/_xfig
--- oc/X/_xfig	Tue Aug 31 09:11:43 1999
+++ Completion/X/_xfig	Tue Aug 31 10:02:32 1999
@@ -1,12 +1,12 @@
 #compdef xfig
 
-_x_options \
+_x_arguments \
   -{help,Landscape,Portrait,debug,dontswitchcmap,flushleft,inches,inverse,latexfonts,left,metric,monochrome,multiple,noscalablefonts,notrack,right,scalablefonts,showallbuttons,single,specialtext,tablet,track} \
   '-bold:bold font:_x_font' \
   '-button:button font:_x_font' \
   '-but_per_row:number of buttons:' \
-  '-cbg:canvas background color:_colors' \
-  '-cfg:canvas foreground color:_colors' \
+  '-cbg:canvas background color:_x_color' \
+  '-cfg:canvas foreground color:_x_color' \
   '-depth:visual depth:_x_visdepth' \
   '-exportlanguage:export language:(box latex epic eepic eepicemu pictex ibmgl eps ps pstex textyl tpic pic mf acad pcx png gif jpeg tiff ppm xbm xpm)' \
   '-iconGeometry:icon geometry:_x_geometry' \
diff -u -r oc/X/_xsetroot Completion/X/_xsetroot
--- oc/X/_xsetroot	Tue Aug 31 09:11:43 1999
+++ Completion/X/_xsetroot	Tue Aug 31 10:05:26 1999
@@ -1,12 +1,12 @@
 #compdef xsetroot
 
-_x_options \
+_x_arguments \
   -{help,def,gray,grey,rv} \
   '-cursor:cursor file:_files -g \*.\(\#i\)\(xbm\|curs\(\|or\)\):mask file:_files -g \*.\(\#i\)\(xbm\|curs\(\|or\)\|mask\)' \
-  '-cursor_name:cursor name:_cursors' \
+  '-cursor_name:cursor name:_x_cursor' \
   '-bitmap:bitmap file:_files -g \*.\(\#i\)xbm' \
   '-mod:x grid distance (1-16): :y grid distance (1-16):' \
-  '-fg:foreground color:_colors' \
-  '-bg:background color:_colors' \
-  '-solid:screen solid color:_colors' \
+  '-fg:foreground color:_x_color' \
+  '-bg:background color:_x_color' \
+  '-solid:screen solid color:_x_color' \
   '-name:root window name:'
diff -u -r oc/X/_xt_arguments Completion/X/_xt_arguments
--- oc/X/_xt_arguments	Tue Aug 31 09:11:43 1999
+++ Completion/X/_xt_arguments	Tue Aug 31 10:03:22 1999
@@ -23,17 +23,17 @@
 _arguments \
   -+{rv,synchronous} \
   -{reverse,iconic} \
-  '-background:background color:_colors' \
-  '-bd:border color:_colors' \
-  '-bg:background color:_colors' \
-  '-bordercolor:border color:_colors' \
+  '-background:background color:_x_color' \
+  '-bd:border color:_x_color' \
+  '-bg:background color:_x_color' \
+  '-bordercolor:border color:_x_color' \
   '-borderwidth:border width:_x_borderwidth' \
   '-bw:border width:_x_borderwidth' \
   '-display:display:_x_display' \
-  '-fg:foreground color:_colors' \
+  '-fg:foreground color:_x_color' \
   '-font:font:_x_font' \
   '-fn:font:_x_font' \
-  '-foreground:foreground color:_colors' \
+  '-foreground:foreground color:_x_color' \
   '-geometry:geometry:_x_geometry' \
   '-name:name:_x_name' \
   '-selectionTimeout:selection timeout (milliseconds):_x_selection_timeout' \
diff -u -r oc/X/_xterm Completion/X/_xterm
--- oc/X/_xterm	Tue Aug 31 10:01:12 1999
+++ Completion/X/_xterm	Tue Aug 31 10:03:50 1999
@@ -7,13 +7,13 @@
   '-bcf:time text cursor is off when blinking (milliseconds):' \
   '-bcn:time text cursor is on when blinking (milliseconds):' \
   '-cc:character class:' \
-  '-cr:text cursor color:_colors' \
+  '-cr:text cursor color:_x_color' \
   '-e:program: _command_names -e:*::program arguments: _normal' \
   '-fb:bold font:_x_font' \
   '-fi:icon font:_x_font' \
-  '-hc:background color for highlighted text:_colors' \
+  '-hc:background color for highlighted text:_x_color' \
   '-mc:multi-click threshold (milliseconds):' \
-  '-ms:pointer cursor color:_colors' \
+  '-ms:pointer cursor color:_x_color' \
   '-nb:margin bell number:' \
   '-sl:save lines:' \
   '-ti:terminal ID:(vt52 vt100 vt101 vt102 vt220)' \
diff -u -r oc/X/_xv Completion/X/_xv
--- oc/X/_xv	Tue Aug 31 09:11:44 1999
+++ Completion/X/_xv	Tue Aug 31 10:06:06 1999
@@ -1,20 +1,20 @@
 #compdef xv
 
-_x_options \
+_x_arguments \
   -{help,quick24,slow24,best24,noqcheck,pkludge,RM} \
   -+{fixed,rw,perfect,owncmap,stdcmap,cecmap,ninstall,8,24,root,noresetroot,max,maxpect,quit,clear,cmap,imap,cemap,cmtmap,vsmap,nopos,dither,smooth,raw,acrop,4x3,hflip,vflip,norm,hist,mono,rv,wloop,random,loadclear,nofreecols,rgb,hsv,lbrowse,nostat,2xlimit,nolimits,close,iconic,viewonly,poll,vsperfect,vsdisable,nodecor} \
-  '-fg:foreground color:_colors' \
-  '-bg:background color:_colors' \
-  '-hi:top left shadow color:_colors' \
-  '-lo:bottom right shadow color:_colors' \
+  '-fg:foreground color:_x_color' \
+  '-bg:background color:_x_color' \
+  '-hi:top left shadow color:_x_color' \
+  '-lo:bottom right shadow color:_x_color' \
   '-bw:border width:' \
   '-geometry:geometry:_x_geometry' \
   '-expand:expansion factor:' \
   '-aspect:aspect ratio (e.g. 4:3):' \
   '-ncols:maximum number of colors used:' \
   '-rmode:root display mode:((0\:tiling 1\:integer\ tiling 2\:mirrored\ tiling 3\:integer\ mirrored\ tiling 4\:centered\ tiling 5\:centered\ tiling\ on\ solid\ background 6\:centered\ tiling\ on\ '\\\''warp'\\\''\ background 7\:centered\ tiling\ on\ '\\\''brick'\\\''\ background 8\:symmetrical\ tiling 9\:symmetrical\ mirrored\ tiling))' \
-  '-rfg:root foreground color:_colors' \
-  '-rbg:root background color:_colors' \
+  '-rfg:root foreground color:_x_color' \
+  '-rbg:root background color:_x_color' \
   '-cgeom:control window geometry:_x_geometry' \
   '-igeom:info window geometry:_x_geometry' \
   '-cegeom:color editor window geometry:_x_geometry' \
@@ -26,8 +26,8 @@
   '-gamma:gamma value:' \
   '-cgamma:red gamma value: :green gamma value: :blue gamma value:' \
   '-preset:default preset (1-4):(1 2 3 4)' \
-  '-white:'"'"'white'"'"' color:_colors' \
-  '-black:'"'"'black'"'"' color:_colors' \
+  '-white:'"'"'white'"'"' color:_x_color' \
+  '-black:'"'"'black'"'"' color:_x_color' \
   '-wait:seconds to wait:' \
   '-visual:visual:(TrueColor StaticColor DirectColor StaticGray GrayScale PseudoColor)' \
   '-cursor:cursor character number:' \

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

