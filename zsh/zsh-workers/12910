From zsh-workers-return-12910-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Oct 05 18:33:06 2000
Return-Path: <zsh-workers-return-12910-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7332 invoked from network); 5 Oct 2000 18:33:05 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 5 Oct 2000 18:33:05 -0000
Received: (qmail 804 invoked by alias); 5 Oct 2000 18:32:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12910
Received: (qmail 797 invoked from network); 5 Oct 2000 18:32:54 -0000
Date: Thu, 05 Oct 2000 19:32:26 +0100
From: Peter Stephenson <pws@csr.com>
Subject: Re: Bug report + feature request
In-reply-to: "Your message of Thu, 05 Oct 2000 14:11:21 EDT."
 <20001005181121.ADB45DCE4@mail.cise.ufl.edu>
To: "Sullivan N. Beck" <sbeck@cise.ufl.edu>,
 zsh-workers@sunsite.auc.dk (Zsh hackers list)
Message-id: <0G1Y00JMAZI1EJ@la-la.cambridgesiliconradio.com>
Content-transfer-encoding: 7BIT

>    ls -l /tmp/z   3>&1 1>&2 2>&3 | while read line ;do echo ":: "$line; done
>    
>    total 16
>    -rw-r--r--   1 sbeck    apps         396 Oct  5 13:44 foo
>    :: total 16
>    :: -rw-r--r--   1 sbeck    apps         396 Oct  5 13:44 foo
> 
> Notice that in the 3rd section, the output from the command ends up on
> both STDOUT and STDERR.  All other shells (ksh, sh, bash) that I tested
> give the correct output for the 3rd case:
> 
>    total 16
>    -rw-r--r--   1 sbeck    apps         396 Oct  5 13:44 foo

That's not a bug, it's due to zsh's `multios' feature, where a repeated
mention of an fd means that it should be used twice:  on input this does
cat, and on output it does tee.  In this case fd 1 is used for copying to 2
and as a pipe, so stdout goes to both.  You need to `setopt nomultios' to
turn this off.

It's about time we had a `no_pipe_multios' option --- this gets so many
people (including me, before now).

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

