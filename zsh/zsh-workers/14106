From zsh-workers-return-14106-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 26 12:37:02 2001
Return-Path: <zsh-workers-return-14106-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27083 invoked from network); 26 Apr 2001 12:37:01 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 Apr 2001 12:37:01 -0000
Received: (qmail 24045 invoked by alias); 26 Apr 2001 12:36:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14106
Received: (qmail 24028 invoked from network); 26 Apr 2001 12:36:54 -0000
To: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Cc: zsh-workers@sunsite.dk
Subject: Re: Make Failure on SunOS-4.1 (correction)
References: <54566fu13tt.fsf@icd.teradyne.com>
	<1010425041307.ZM10317@candle.brasslantern.com>
	<545y9spyrwy.fsf@icd.teradyne.com>
	<1010425145840.ZM11172@candle.brasslantern.com>
	<545itjsx3ec.fsf@icd.teradyne.com>
	<1010426042751.ZM11961@candle.brasslantern.com>
	<1010426043555.ZM12272@candle.brasslantern.com>
From: Vin Shelton <shelton@icd.teradyne.com>
Organization: Teradyne
Date: 26 Apr 2001 08:50:16 -0400
In-Reply-To: <1010426043555.ZM12272@candle.brasslantern.com>
Message-ID: <5457l07n7uf.fsf@icd.teradyne.com>
Lines: 80
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Yes, that did it.  With this patch, zsh from the latest CVS sources
builds and runs on SunOS-4.1.

Thanks, bart.

  - vin

"Bart Schaefer" <schaefer@candle.brasslantern.com> writes:
> On Apr 26, Bart Schaefer wrote:
> }
> } Ah, distant memory begins to return ... try the following patch
> 
> Except that I botched it and sent a broken patch.  Here's the right one:
> 
> diff -u -x CVS zsh-forge/current/Src/Modules/termcap.c zsh-4.0/Src/Modules/termcap.c
> --- zsh-forge/current/Src/Modules/termcap.c	Mon Apr 23 23:43:27 2001
> +++ zsh-4.0/Src/Modules/termcap.c	Wed Apr 25 21:29:17 2001
> @@ -27,36 +27,37 @@
>   *
>   */
>  
> -#define USES_TERMCAP_H 1
> -#define USES_TERM_H 1
> +#ifdef HAVE_TGETENT
> +# if defined(HAVE_CURSES_H) && defined(HAVE_TERM_H)
> +#  define USES_TERM_H 1
> +# else
> +#  ifdef HAVE_TERMCAP_H
> +#   define USES_TERMCAP_H 1
> +#  endif
> +# endif
> +#endif
> +
>  #include "termcap.mdh"
>  #include "termcap.pro"
>  
>  static char termcap_nam[] = "termcap";
>  
> -/* echotc: output a termcap */
> -
>  #ifdef HAVE_TGETENT
> -# if defined(HAVE_CURSES_H) && defined(HAVE_TERM_H)
> +# ifdef USES_TERM_H
>  #  ifdef HAVE_TERMIO_H
>  #   include <termio.h>
>  #  endif
>  #  include <curses.h>
>  #  include <term.h>
>  # else
> -#  ifdef HAVE_TERMCAP_H
> +#  ifdef USES_TERMCAP_H
>  #   include <termcap.h>
> -#  else
> -#   ifdef HAVE_CURSES_H
> -#    include <curses.h>
> -#   endif
> -#   ifdef HAVE_TERM_H
> -#    include <term.h>
> -#   endif
>  #  endif
>  # endif
>  
>  static Param termcap_pm;
> +
> +/* echotc: output a termcap */
>  
>  /**/
>  static int
> 
> -- 
> Bart Schaefer                                 Brass Lantern Enterprises
> http://www.well.com/user/barts              http://www.brasslantern.com
> 
> Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   
> 

-- 
In a minute there is time
For decisions and revisions which a minute will reverse.         T.S. Eliot
[URL: http://www.cs.amherst.edu/~ccm/prufrock.html]

