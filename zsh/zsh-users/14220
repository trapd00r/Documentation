From zsh-users-return-14220-mason-zsh=primenet.com.au@sunsite.dk Mon Jul 06 03:56:00 2009
Return-Path: <zsh-users-return-14220-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4570 invoked from network); 6 Jul 2009 03:55:47 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00,HTML_MESSAGE
	autolearn=ham version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 6 Jul 2009 03:55:47 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 99030 invoked from network); 6 Jul 2009 03:55:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 6 Jul 2009 03:55:23 -0000
Received: (qmail 5845 invoked by alias); 6 Jul 2009 03:55:00 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14220
Received: (qmail 5828 invoked from network); 6 Jul 2009 03:54:59 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 6 Jul 2009 03:54:59 -0000
Received: from mail-px0-f198.google.com (mail-px0-f198.google.com [209.85.216.198])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 11E2F8027106
	for <zsh-users@sunsite.dk>; Mon,  6 Jul 2009 05:54:52 +0200 (CEST)
Received: by pxi36 with SMTP id 36so3224608pxi.9
        for <zsh-users@sunsite.dk>; Sun, 05 Jul 2009 20:54:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=ck8KFmLCD0sZZcZvd3bjHi3IZGm3U+JCkSYwQ6eTcRk=;
        b=X0BCmyPMOiXq6AgYPcKxwRfUVjp0tqS8E6wzeUMuXsvlZD66LEVpRj+7Vcv9RUlR+F
         dCtDHgfe1TnfpKdf86Ou5/1d2iUlESuJlTchF+pdZzPjUqbnF5TfObOQ9iraPCfAm8Nu
         eWdecwXEn0fp9mvyhSQJvGkFt7Bq0l6jTlyrM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=K2g9J1roYqFZlKcExYN1BaYnMcxPHjnwYRruiiotPaJ1JzHGVJXuh9LJmKBCb9qz0r
         rUV1/Yw3jIuPROtPGbgjmi7J7QrQNIKeM5jYZFyIlv172y2c5c068QualkhXFDjdzO2O
         914SRlHHPy4ZffoZ0ZRG9/42JphPmg9+sheH4=
MIME-Version: 1.0
Received: by 10.142.254.6 with SMTP id b6mr1225957wfi.265.1246852490882; Sun, 
	05 Jul 2009 20:54:50 -0700 (PDT)
Date: Mon, 6 Jul 2009 11:54:50 +0800
Message-ID: <291b78b50907052054q52e5515cp3104fa34b19e670a@mail.gmail.com>
Subject: git completion really slow in a big repo
From: Ryan Ye <yejianye@gmail.com>
To: zsh-users@sunsite.dk
Content-Type: multipart/alternative; boundary=00504502c3ccce6e26046e017792
X-Virus-Scanned: ClamAV 0.94.2/9538/Fri Jul  3 16:27:11 2009 on bifrost
X-Virus-Status: Clean

--00504502c3ccce6e26046e017792
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I am using zsh 4.3.10. When I type 'git checkout master-<TAB>', the
completion for the rest of the branch name is really slow (take more than 15
secs).
When I use strace to log all system calls in the completion, I found zsh
access all the files in all sub dirs under current working directory.
Because I'm executing the command at the root of my tree, there're more than
10,000 files, which really slows things down. To prove that's the cause of
the problem, I cd into a leaf directory and do 'git checkout master-<TAB>'
again. This time the completion finishing in less than one sec.

So my question is that why a git checkout need reading the full file list
under a directory? it's unacceptable for a large tree. Is there any options
I could tweak to change this behavior ?

Thanks,
Ryan

--00504502c3ccce6e26046e017792
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

I am using zsh 4.3.10. When I type &#39;git checkout master-&lt;TAB&gt;&#39=
;, the completion for the rest of the branch name is really slow (take more=
 than 15 secs). <br>When I use strace to log all system calls in the comple=
tion, I found zsh access all the files in all sub dirs under current workin=
g directory. Because I&#39;m executing the command at the root of my tree, =
there&#39;re more than 10,000 files, which really slows things down. To pro=
ve that&#39;s the cause of the problem, I cd into a leaf directory and do &=
#39;git checkout master-&lt;TAB&gt;&#39; again. This time the completion fi=
nishing in less than one sec. <br>
<br>So my question is that why a git checkout need reading the full file li=
st under a directory? it&#39;s unacceptable for a large tree. Is there any =
options I could tweak to change this behavior ?<br><br>Thanks,<br>Ryan<br>

--00504502c3ccce6e26046e017792--

