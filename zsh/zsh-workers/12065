From zsh-workers-return-12065-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jun 26 06:46:00 2000
Return-Path: <zsh-workers-return-12065-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4907 invoked from network); 26 Jun 2000 06:45:58 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 26 Jun 2000 06:45:58 -0000
Received: (qmail 12626 invoked by alias); 26 Jun 2000 06:45:41 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12065
Received: (qmail 12619 invoked from network); 26 Jun 2000 06:45:40 -0000
Message-ID: <20000626064537.12022.qmail@web1303.mail.yahoo.com>
Date: Sun, 25 Jun 2000 23:45:37 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: Possible zle_tricky.c memory leak & history typo
To: zsh-workers <zsh-workers@sunsite.auc.dk>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

There are several typos in the latest changes to the history completers.
The last line of the completer looks like:
	(( $compstate[namtches] ))

I don't think the "$" sign is needed, (_history_complete_word, also has this
problem then.)  Also, the "am" need to be switched in "namtches".

I've been tight on time, otherwise I would send the patch or make the change
myself. (if no one fixes this, i'll fix it when i get time.)


Also, there was (and might still be) a memory leak in the version of
zle_tricky.c from June 9th.  Below is the stack trace where the memory is
allocated.  (The line numbers are from the june 10th version. Sorry not to use
the current version).  I think the bug might be at line 607, where s is not
freed before we return.
               zalloc         [mem.c:453]
               ztrdup         [mem.c:530]
               get_comp_string [zle_tricky.c:1595]
               docomplete     [zle_tricky.c:586]
               expandorcomplete [zle_tricky.c:282]


-FR

__________________________________________________
Do You Yahoo!?
Get Yahoo! Mail - Free email you can access from anywhere!
http://mail.yahoo.com/

