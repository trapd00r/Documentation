From zsh-workers-return-8915-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Dec 06 16:15:43 1999
Return-Path: <zsh-workers-return-8915-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27754 invoked from network); 6 Dec 1999 16:15:42 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Dec 1999 16:15:42 -0000
Received: (qmail 18639 invoked by alias); 6 Dec 1999 16:15:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8915
Received: (qmail 18631 invoked from network); 6 Dec 1999 16:15:35 -0000
Date: Mon, 6 Dec 1999 11:15:21 -0500
From: Clint Adams <schizo@debian.org>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: the transform saga, Doc
Message-ID: <19991206111521.A25416@dman.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.0i

Well, I've come to agree that everything should be transformed,
including the manpages.  My only problem with this is that the
manpages will still refer to one another by their "correct names".
For example, zsh-suffixcompsys.1 instructs the reader to see
zshcompwid rather than zsh-suffixcompwid.

Index: Doc/Makefile.in
===================================================================
RCS file: /cvs/zsh/zsh/Doc/Makefile.in,v
retrieving revision 1.1.1.33
diff -u -r1.1.1.33 Makefile.in
--- Doc/Makefile.in	1999/12/06 04:40:27	1.1.1.33
+++ Doc/Makefile.in	1999/12/06 16:10:17
@@ -168,14 +168,15 @@
 install.man: $(MAN)
 	$(sdir_top)/mkinstalldirs $(DESTDIR)$(mandir)/man1
 	for file in $(MAN); do \
-	  tzsh=`echo $$file | sed '$(transform)'`; \
+	  tzsh=`echo zsh | sed '$(transform)'`; \
+	  tfile=`echo $$file | sed "s/zsh/$$tzsh/"`; \
 	  if test -f $$file; then \
-	    cp -f $$file $$tzsh; \
+	    cp -f $$file $$tfile; \
 	  elif test -f $(sdir)/$$file; then \
-	    cp -f $(sdir)/$$file $$tzsh; \
+	    cp -f $(sdir)/$$file $$tfile; \
 	  else :; \
 	  fi || exit 1; \
-	  $(INSTALL_DATA) $$tzsh $(DESTDIR)$(mandir)/man1 || exit 1; \
+	  $(INSTALL_DATA) $$tfile $(DESTDIR)$(mandir)/man1 || exit 1; \
 	done
 
 # install info pages, creating install directory if necessary
@@ -203,7 +204,8 @@
 uninstall.man:
 	for file in $(MAN); do \
 	  tzsh=`echo zsh | sed '$(transform)'`; \
-	  rm -f $(DESTDIR)$(mandir)/man1/$$tzsh; \
+	  tfile=`echo $$file | sed "s/zsh/$$tzsh/"`; \
+	  rm -f $(DESTDIR)$(mandir)/man1/$$tfile; \
 	done
 
 # uninstall info pages

