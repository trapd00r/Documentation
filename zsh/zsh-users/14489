From zsh-users-return-14489-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 13 09:07:56 2009
Return-Path: <zsh-users-return-14489-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13264 invoked from network); 13 Oct 2009 09:07:53 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 13 Oct 2009 09:07:53 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 77544 invoked from network); 13 Oct 2009 09:07:43 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 13 Oct 2009 09:07:43 -0000
Received: (qmail 5119 invoked by alias); 13 Oct 2009 09:07:34 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14489
Received: (qmail 5105 invoked from network); 13 Oct 2009 09:07:34 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 13 Oct 2009 09:07:34 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id F0B3C80EB234
	for <zsh-users@sunsite.dk>; Tue, 13 Oct 2009 11:07:25 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly07d.srv.mailcontrol.com (MailControl) with ESMTP id n9D977Jw022864
	for <zsh-users@sunsite.dk>; Tue, 13 Oct 2009 10:07:15 +0100
Received: from news01 ([10.99.50.25]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 13 Oct 2009 10:07:11 +0100
Date: Tue, 13 Oct 2009 10:07:10 +0100
From: Peter Stephenson <pws@csr.com>
To: zsh-users ml <zsh-users@sunsite.dk>
Subject: Re: expansion in conditional expression patterns
Message-ID: <20091013100710.27e3c2fb@news01>
In-Reply-To: <F851A022-A342-41EE-9BC8-692B7E7D3025@biskalar.de>
References: <F851A022-A342-41EE-9BC8-692B7E7D3025@biskalar.de>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 13 Oct 2009 09:07:11.0107 (UTC) FILETIME=[8C3F5D30:01CA4BE4]
X-Scanned-By: MailControl A-09-22-01 (www.mailcontrol.com) on 10.68.0.117
X-Virus-Scanned: ClamAV 0.94.2/9882/Mon Oct 12 05:15:10 2009 on bifrost
X-Virus-Status: Clean

On Mon, 12 Oct 2009 19:51:14 +0200
Sebastian Stark <seb-zsh@biskalar.de> wrote:
> % limit=5
> % if [[ 1 != <2-$limit> ]]; then print outside; fi
> zsh: parse error: condition expected: 1
>
> What part of this do I misunderstand?

Logically this ought to work:  parameter substitution is performed before
pattern matching or globbing.  However, "<" is rather overloaded and when
the expression is parsed the shell only decides it's a numeric glob if the
expression is in the strict form with digits.  It could probably be made
smarter in this case, where "<" can't be a redirection, but as a knock-on
effect pattern matching would have to be made smarter about deciding later
on if the expression was a numeric glob, so it's not entirely trivial.

Your best bet for now is to do numeric comparisons with -ge and -le or with
<= and >= in (( ... )) expressions.  You can use an "eval" but that's probably
a bit too ugly for what you're trying to do.

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

