From zsh-workers-request@euclid.skiles.gatech.edu Thu Jul 10 10:40:26 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 20034 invoked from network); 10 Jul 1997 10:40:23 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 10 Jul 1997 10:40:23 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id GAA21611; Thu, 10 Jul 1997 06:05:37 -0400 (EDT)
Resent-Date: Thu, 10 Jul 1997 06:05:37 -0400 (EDT)
Message-Id: <199707101009.MAA13766@hydra.ifh.de>
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Libraries on HP-UX 10.20
Date: Thu, 10 Jul 1997 12:09:54 +0200
From: Peter Stephenson <pws@ifh.de>
Resent-Message-ID: <"jCXz03.0.cH5.mFBnp"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3360
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

I can't remember if this has been pointed out before, but it's not in
MACHINES: I just compiled zsh 3.1.2 on a local box running HP-UX
10.20.  configure picked -ltermcap for linking, but the resulting zle
behaved very strangely on my xterm.  I replaced it with -lcurses,
relinked and everything is fine.  (At a guess, since changing TERM
gives `terminal unknown' messages, -ltermcap is trying to use the
rather minimal /etc/termcap instead of using the much larger terminfo
database as the emulation in -lcurses does. Hasn't anybody else seen
this?)

This should presumably be written into termcap_curses_order in
configure.in, where it already changes the order for AIX.
Unfortunately I have no idea which other versions of HP-UX will endure
this behaviour.  $host_os in this case is 'hpux10.20'.  This patch to
configure.in applies the change for any hpux10.*.  (Perhaps better to
change the 10 to 1[[0-9]] for future-proofing.)

*** configure.in~	Thu May 29 06:47:33 1997
--- configure.in	Thu Jul 10 12:02:01 1997
***************
*** 417,424 ****
  dnl CHECK FOR LIBRARIES
  dnl -------------------
  dnl Prefer BSD termcap library to SysV curses library, except on certain
! dnl versions of AIX.
! if test `echo $host_os | sed 's/^.*\(aix\)[[1-9]]\.[[0-9]].*$/\1/'` = aix; then
    termcap_curses_order="curses ncurses termcap"
  else
    termcap_curses_order="termcap curses ncurses"
--- 417,425 ----
  dnl CHECK FOR LIBRARIES
  dnl -------------------
  dnl Prefer BSD termcap library to SysV curses library, except on certain
! dnl versions of AIX and HP-UX.
! if test `echo $host_os | sed 's/^.*\(aix\)[[1-9]]\.[[0-9]].*$/\1/'` = aix ||
!    test `echo $host_os | sed 's/^.*\(hpux\)10.*$/\1/'` = hpux; then
    termcap_curses_order="curses ncurses termcap"
  else
    termcap_curses_order="termcap curses ncurses"

-- 
Peter Stephenson <pws@ifh.de>       Tel: +49 33762 77366
WWW:  http://www.ifh.de/~pws/       Fax: +49 33762 77413
Deutsches Elektronen-Synchrotron --- Institut fuer Hochenergiephysik Zeuthen
DESY-IfH, 15735 Zeuthen, Germany.

