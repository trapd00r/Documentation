From zsh-workers-return-9181-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Jan 02 19:37:32 2000
Return-Path: <zsh-workers-return-9181-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16817 invoked from network); 2 Jan 2000 19:37:31 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 Jan 2000 19:37:31 -0000
Received: (qmail 25601 invoked by alias); 2 Jan 2000 19:37:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9181
Received: (qmail 25593 invoked from network); 2 Jan 2000 19:37:21 -0000
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: PATCH: phony make targets
Date: Sun, 02 Jan 2000 19:39:06 +0000
From: Peter Stephenson <pws@pwstephenson.fsnet.co.uk>
Message-Id: <E124qoZ-0005hI-00.2000-01-02-19-37-19@cmailg3.svr.pol.co.uk>

GNU make sometimes creates empty files with the names of phony targets such
as `FORCE' and `all'.  This should help in this case, I hope other forms of
make will just ignore it.  It's not a complete set but it includes the
targets I most frequently find created unnecessarily.

Index: Src/Makefile.in
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/Src/Makefile.in,v
retrieving revision 1.9
diff -u -r1.9 Makefile.in
--- Src/Makefile.in	1999/12/22 23:17:29	1.9
+++ Src/Makefile.in	2000/01/02 17:47:49
@@ -39,6 +39,12 @@
 
 @DEFS_MK@
 
+.PHONY: all bin headers modules modobjs modules prep rm-modobjs-tmp \
+	FORCE mostlyclean-here clean-here distclean-here mostlyclean \
+	clean distclean realclean mostlyclean-modules clean-modules \
+	distclean-modules realclean-modules install.modules \
+	uninstall.modules proto
+
 sdir_src      = $(sdir)
 dir_src       = .
 
Index: Src/Makemod.in.in
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/Src/Makemod.in.in,v
retrieving revision 1.4
diff -u -r1.4 Makemod.in.in
--- Src/Makemod.in.in	1999/12/21 15:18:27	1.4
+++ Src/Makemod.in.in	2000/01/02 17:50:53
@@ -40,6 +40,12 @@
 
 @DEFS_MK@
 
+.PHONY: all modobjs modules headers proto prep FORCE install uninstall \
+	install.bin uninstall.bin install.modules uninstall.modules \
+	install.bin-here uninstall.bin-here install.modules-here \
+	uninstall.modules-here mostlyclean-here clean-here distclean-here \
+	
+
 sdir_src      = $(sdir_top)/Src
 dir_src       = $(dir_top)/Src
 
Index: Doc/Makefile.in
===================================================================
RCS file: /home/pws/CVSROOT/projects/zsh/Doc/Makefile.in,v
retrieving revision 1.17
diff -u -r1.17 Makefile.in
--- Doc/Makefile.in	1999/12/21 15:18:27	1.17
+++ Doc/Makefile.in	2000/01/02 17:55:28
@@ -37,6 +37,10 @@
 
 @DEFS_MK@
 
+.PHONY: all everything install uninstall install.man uninstall.man \
+	install.info uninstall.info install.html uninstall.html \
+	clean-here distclean-here realclean-here
+
 MAKEINFO = makeinfo
 TEXI2DVI = texi2dvi
 DVIPS = dvips -D 300

-- 
Peter Stephenson <pws@pwstephenson.fsnet.co.uk>

