From zsh-workers-return-23955-mason-zsh=primenet.com.au@sunsite.dk Sun Oct 14 22:17:05 2007
Return-Path: <zsh-workers-return-23955-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7377 invoked from network); 14 Oct 2007 22:16:57 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Oct 2007 22:16:57 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 59698 invoked from network); 14 Oct 2007 22:16:48 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Oct 2007 22:16:48 -0000
Received: (qmail 17616 invoked by alias); 14 Oct 2007 22:16:45 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23955
Received: (qmail 17603 invoked from network); 14 Oct 2007 22:16:45 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 Oct 2007 22:16:45 -0000
Received: (qmail 59400 invoked from network); 14 Oct 2007 22:16:45 -0000
Received: from vms048pub.verizon.net (206.46.252.48)
  by a.mx.sunsite.dk with SMTP; 14 Oct 2007 22:16:38 -0000
Received: from torch.brasslantern.com ([71.116.76.59])
 by vms048.mailsrvcs.net (Sun Java System Messaging Server 6.2-6.01 (built Apr
 3 2006)) with ESMTPA id <0JPX00DLI9UYRETA@vms048.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Sun, 14 Oct 2007 17:16:11 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id l9EMG92j026590	for
 <zsh-workers@sunsite.dk>; Sun, 14 Oct 2007 15:16:09 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id l9EMG8gr026589	for zsh-workers@sunsite.dk; Sun,
 14 Oct 2007 15:16:08 -0700
Date: Sun, 14 Oct 2007 15:16:08 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: PATCH: make curses module not need wideness
In-reply-to: <20071014170856.GA14631@scowler.net>
To: zsh-workers@sunsite.dk
Message-id: <071014151608.ZM26588@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <20071014042142.GA27713@scowler.net>
	<071014092646.ZM21802@torch.brasslantern.com>
	<20071014170856.GA14631@scowler.net>
Comments: In reply to Clint Adams <clint@zsh.org>
 "Re: PATCH: make curses module not need wideness" (Oct 14,  1:08pm)

On Oct 14,  1:08pm, Clint Adams wrote:
}
} Oops. -s outputs strings to a window. Perhaps -c and -s should be
} combined.

Please pardon that everything that follows is griping.

I'm not having much luck with this.  The doc should mention that window
zero is automatically created as the whole terminal.  Also there's no
check that the targetwin argument is really an integer; I typo'd a "q"
for a "1", got some errors about the window already existing (apparently
because non-integers are read as "0"), and ended up with a core dump:

(gdb) where
#0  doupdate () at ../../ncurses/tty/tty_update.c:873
#1  0x035d7fe9 in wrefresh (win=0x87f29c0)
    at ../../ncurses/base/lib_refresh.c:58
#2  0x00817e67 in bin_zcurses (nam=0xb7d2d460 "zcurses", args=0xbfe3eab8, 
    ops=0xbfe3eb00, func=0) at ../../../zsh-4.0/Src/Modules/curses.c:148
#3  0x080537f4 in execbuiltin (args=0xb7d2d430, bn=0x8195e0)
    at ../../zsh-4.0/Src/builtin.c:438
(etc.)

The doc for "zcurses -m" says "moves targetwin to new coordinates" but
really it positions the cursor within the target window, doesn't it?
Maybe better phrasing is all that's needed.

Also I none of the strings I send with "zcurses -s" show up in the
window.  A border added with "zcurses -b" will display, but that's all.
"zcurses -c" has a similar problem.

