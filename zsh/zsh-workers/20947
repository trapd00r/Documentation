From zsh-workers-return-20947-mason-zsh=primenet.com.au@sunsite.dk Mon Mar 07 19:15:49 2005
Return-Path: <zsh-workers-return-20947-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 14322 invoked from network); 7 Mar 2005 19:15:48 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 Mar 2005 19:15:48 -0000
Received: (qmail 91333 invoked from network); 7 Mar 2005 19:15:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Mar 2005 19:15:42 -0000
Received: (qmail 24908 invoked by alias); 7 Mar 2005 19:15:39 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20947
Received: (qmail 21205 invoked from network); 7 Mar 2005 19:08:57 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 7 Mar 2005 19:08:57 -0000
Received: (qmail 84679 invoked from network); 7 Mar 2005 19:08:57 -0000
Received: from mx2.mail.ru (194.67.23.122)
  by a.mx.sunsite.dk with SMTP; 7 Mar 2005 19:08:53 -0000
Received: from [83.237.228.225] (port=32804 helo=[10.0.0.1])
	by mx2.mail.ru with asmtp 
	id 1D8Nb0-0004x0-00
	for zsh-workers@sunsite.dk; Mon, 07 Mar 2005 22:08:50 +0300
From: Andrey Borzenkov <arvidjaar@mail.ru>
To: zsh-workers@sunsite.dk
Subject: [PATCH] more general kfmclient openProfile completion
Date: Mon, 7 Mar 2005 22:08:49 +0300
User-Agent: KMail/1.7.2
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200503072208.49417.arvidjaar@mail.ru>
X-Spam: Not detected
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=6.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.2
X-Spam-Hits: -2.6

Index: Completion/X/Command/_kfmclient
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/X/Command/_kfmclient,v
retrieving revision 1.4
diff -u -p -r1.4 _kfmclient
--- Completion/X/Command/_kfmclient     5 Mar 2005 10:31:21 -0000       1.4
+++ Completion/X/Command/_kfmclient     7 Mar 2005 19:05:32 -0000
@@ -73,8 +73,9 @@ case $line[1] in
     _webbrowser
     return
   elif [[ $state = firstarg ]]; then
+    local appdata=${$(kde-config --path data 
2> /dev/null):-~/.kde/share/apps/}
     _wanted profile expl 'Konqueror profile' \
-      compadd -- ~/.kde/share/apps/konqueror/profiles/*(:t)
+      compadd -- ${(s/:/)^${appdata}}konqueror/profiles/*(:t)
     return
   fi
   ;;

