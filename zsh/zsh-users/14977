From zsh-users-return-14977-mason-zsh=primenet.com.au@zsh.org Wed Mar 31 14:39:46 2010
Return-Path: <zsh-users-return-14977-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18451 invoked by alias); 31 Mar 2010 14:39:45 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14977
Received: (qmail 8282 invoked from network); 31 Mar 2010 14:39:43 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_NONE,
	SPF_HELO_PASS autolearn=ham version=3.3.1
Received-SPF: none (ns1.primenet.com.au: domain at bewatermyfriend.org does not designate permitted sender hosts)
From: Frank Terbeck <ft@bewatermyfriend.org>
To: David Evans <David.Evans@cl.cam.ac.uk>
Cc: zsh-users@zsh.org
Subject: Re: Beefing up vcs_info's Subversion revision number
In-Reply-To: <20100331131304.GA4605@cl.cam.ac.uk> (David Evans's message of
	"Wed, 31 Mar 2010 14:13:04 +0100")
References: <20100331131304.GA4605@cl.cam.ac.uk>
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.1 (gnu/linux)
Date: Wed, 31 Mar 2010 16:32:07 +0200
Message-ID: <8739zgsgt4.fsf@ft.bewatermyfriend.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Df-Sender: 430444

David Evans wrote:
>   vcs_info's subversion back-end parses the output from "svn info" for
> branch revision (%r) numbers.  Fair enough.  What's the best way to
> instead use the output of "svnversion", assuming of course that I'm
> happy with the cost?  Have at the var myself after calling vcs_info()?
> Hooks?  Hack up VCS_INFO_get_data_svn?  Make a new, fictitious back-end?

With vcs_info from CVS you can modify `%r' from a `set-branch-format'
hook.  The basic idea would look something like this:

zstyle =E2=80=99:vcs_info:svn+set-branch-format:*=E2=80=99 hooks fixrevision
function +vi-fixrevision() {
  hook_com[revision]=3D"$(the_command_that_does_it_better)"
}

The manual should have all the info you need.

When you got it working, I'd be interested in the hook, because I'm
compiling a set of vcs_info configuration examples. :-)

Regards, Frank

--=20
In protocol design, perfection has been reached not when there is
nothing left to add, but when there is nothing left to take away.
                                                  -- RFC 1925

