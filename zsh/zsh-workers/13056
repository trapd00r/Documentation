From zsh-workers-return-13056-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Oct 21 12:35:46 2000
Return-Path: <zsh-workers-return-13056-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19114 invoked from network); 21 Oct 2000 12:35:44 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 21 Oct 2000 12:35:44 -0000
Received: (qmail 27924 invoked by alias); 21 Oct 2000 12:35:37 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13056
Received: (qmail 27917 invoked from network); 21 Oct 2000 12:35:36 -0000
Date: Sat, 21 Oct 2000 14:34:26 +0200
From: =?iso-8859-1?Q?Thomas_K=F6hler?= <jean-luc@picard.franken.de>
To: ZSH workers mailing list <zsh-workers@sunsite.auc.dk>
Subject: zsh-3.1.9-dev-6 crashes occassionally
Message-ID: <20001021143426.A23149@picard.franken.de>
Mail-Followup-To: =?iso-8859-1?Q?Thomas_K=F6hler?= <jean-luc@picard.franken.de>,
	ZSH workers mailing list <zsh-workers@sunsite.auc.dk>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="tKW2IUtsqtDRztdT"
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
X-Operating-System: Linux picard 2.2.17
X-Editor: VIM - Vi IMproved 6.0h ALPHA http://www.vim.org/
X-IRC: tirc; Nick: jeanluc
X-URL: http://jeanluc-picard.de/


--tKW2IUtsqtDRztdT
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hi there,
I have the following problem with zsh-3.1.9-dev-6 on Debian GNU/Linux
for i386:
Sometimes, while trying to complete, zsh crashes and dumps core. In
fact, the problem has been there for quite a while now, perhaps it has
been there since the new completions system has been introduced - I
don't know. The problem is: I can't reproduce the bug. It just happens
to occur every once in a while.
Well, this is not the only problem: Sometimes, zsh forgets its
completion settings. I use this line in my .zshrc:
zstyle ':completion:*' completer _complete _ignored _match _correct _approx=
imate _prefix
Now, sometimes, for some strange reason, zsh forgets to complete on tab
and starts to _correct things right away: For example, I had a directory
"abcdef" and a directory "abx" and typed "cd abc<TAB>" which resulted in
"cd abx".

Why do I report both things in one mail? Because I guess there might be
a problem in that "function calls function calls function"-way of doing
things: perhaps there's some functions that use a global variable by
accident instead of a local one, resulting in ill side-effects or such?

I use Debian's zsh-package (the one in woody aka unstable), but the
problem also occurs with self-compiled zsh (so it doesn't seem to be
specific to Debian's compiled version anyways).

Well... here's a gdb backtrace of a zsh core dump:

/scratch2/mp3> gdb =3Dzsh core=20
GNU gdb 5.0
Copyright 2000 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain condition=
s.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...(no debugging symbols foun=
d)...
Core was generated by `zsh'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /lib/libdl.so.2...(no debugging symbols found)...done.
Loaded symbols for /lib/libdl.so.2
Reading symbols from /lib/libnsl.so.1...(no debugging symbols found)...done.
Loaded symbols for /lib/libnsl.so.1
Reading symbols from /lib/libncurses.so.5...(no debugging symbols found)...=
done.
Loaded symbols for /lib/libncurses.so.5
Reading symbols from /lib/libm.so.6...(no debugging symbols found)...done.
Loaded symbols for /lib/libm.so.6
Reading symbols from /lib/libc.so.6...(no debugging symbols found)...done.
Loaded symbols for /lib/libc.so.6
Reading symbols from /lib/ld-linux.so.2...(no debugging symbols found)...do=
ne.
Loaded symbols for /lib/ld-linux.so.2
Reading symbols from /lib/libnss_compat.so.2...(no debugging symbols found)=
...done.
Loaded symbols for /lib/libnss_compat.so.2
Reading symbols from /usr/lib/zsh/3.1.9-dev-6/zsh/zle.so...(no debugging sy=
mbols found)...done.
Loaded symbols for /usr/lib/zsh/3.1.9-dev-6/zsh/zle.so
Reading symbols from /usr/lib/zsh/3.1.9-dev-6/zsh/parameter.so...(no debugg=
ing symbols found)...done.
Loaded symbols for /usr/lib/zsh/3.1.9-dev-6/zsh/parameter.so
Reading symbols from /usr/lib/zsh/3.1.9-dev-6/zsh/rlimits.so...(no debuggin=
g symbols found)...done.
Loaded symbols for /usr/lib/zsh/3.1.9-dev-6/zsh/rlimits.so
Reading symbols from /usr/lib/zsh/3.1.9-dev-6/zsh/complete.so...(no debuggi=
ng symbols found)...done.
Loaded symbols for /usr/lib/zsh/3.1.9-dev-6/zsh/complete.so
Reading symbols from /usr/lib/zsh/3.1.9-dev-6/zsh/zutil.so...(no debugging =
symbols found)...done.
Loaded symbols for /usr/lib/zsh/3.1.9-dev-6/zsh/zutil.so
Reading symbols from /usr/lib/zsh/3.1.9-dev-6/zsh/complist.so...(no debuggi=
ng symbols found)...done.
Loaded symbols for /usr/lib/zsh/3.1.9-dev-6/zsh/complist.so
Reading symbols from /usr/lib/zsh/3.1.9-dev-6/zsh/computil.so...(no debuggi=
ng symbols found)...done.
Loaded symbols for /usr/lib/zsh/3.1.9-dev-6/zsh/computil.so
#0  0x401011cb in free () from /lib/libc.so.6
(gdb) bt
#0  0x401011cb in free () from /lib/libc.so.6
#1  0x40101053 in free () from /lib/libc.so.6
#2  0x807613e in zsfree ()
#3  0x80925e3 in freearray ()
#4  0x807cd66 in arrsetfn ()
#5  0x807cc82 in stdunsetfn ()
#6  0x807cb5a in unsetparam_pm ()
#7  0x807de6d in endparamscope ()
#8  0x8065a49 in scanhashtable ()
#9  0x807dd8f in endparamscope ()
#10 0x8060304 in runshfunc ()
#11 0x4021f682 in comp_setunset () from /usr/lib/zsh/3.1.9-dev-6/zsh/comple=
te.so
#12 0x80602aa in runshfunc ()
#13 0x806013c in doshfunc ()
#14 0x805fc67 in getproc ()
#15 0x805e16c in execsubst ()
#16 0x805bc15 in execlist ()
#17 0x805b3f3 in execlist ()
#18 0x805af9b in execlist ()
#19 0x8073768 in execif ()
#20 0x805dfef in execsubst ()
#21 0x805bc15 in execlist ()
#22 0x805b3f3 in execlist ()
#23 0x805af71 in execlist ()
#24 0x805ad46 in execode ()
#25 0x80602f0 in runshfunc ()
#26 0x4021f682 in comp_setunset () from /usr/lib/zsh/3.1.9-dev-6/zsh/comple=
te.so
#27 0x80602aa in runshfunc ()
#28 0x806013c in doshfunc ()
#29 0x805fc67 in getproc ()
#30 0x805e16c in execsubst ()
#31 0x805bc15 in execlist ()
#32 0x805b3f3 in execlist ()
#33 0x805af9b in execlist ()
#34 0x8073768 in execif ()
#35 0x805dfef in execsubst ()
#36 0x805bc15 in execlist ()
#37 0x805b3f3 in execlist ()
#38 0x805af71 in execlist ()
#39 0x805ad46 in execode ()
#40 0x80602f0 in runshfunc ()
#41 0x4021f682 in comp_setunset () from /usr/lib/zsh/3.1.9-dev-6/zsh/comple=
te.so
#42 0x80602aa in runshfunc ()
#43 0x806013c in doshfunc ()
#44 0x805fc67 in getproc ()
#45 0x805e16c in execsubst ()
#46 0x805bc15 in execlist ()
#47 0x805b3f3 in execlist ()
#48 0x805af71 in execlist ()
#49 0x80736b1 in execif ()
#50 0x805dfef in execsubst ()
#51 0x805bc15 in execlist ()
#52 0x805b3f3 in execlist ()
#53 0x805af71 in execlist ()
#54 0x8072bfe in execfor ()
#55 0x805dfef in execsubst ()
#56 0x805bc15 in execlist ()
#57 0x805b3f3 in execlist ()
#58 0x805af71 in execlist ()
#59 0x8072bfe in execfor ()
#60 0x805dfef in execsubst ()
#61 0x805bc15 in execlist ()
#62 0x805b3f3 in execlist ()
#63 0x805af71 in execlist ()
#64 0x805ad46 in execode ()
#65 0x80602f0 in runshfunc ()
#66 0x4021f682 in comp_setunset () from /usr/lib/zsh/3.1.9-dev-6/zsh/comple=
te.so
#67 0x80602aa in runshfunc ()
#68 0x806013c in doshfunc ()
#69 0x40221627 in after_complete () from /usr/lib/zsh/3.1.9-dev-6/zsh/compl=
ete.so
#70 0x40221d61 in after_complete () from /usr/lib/zsh/3.1.9-dev-6/zsh/compl=
ete.so
#71 0x402202b6 in do_completion () from /usr/lib/zsh/3.1.9-dev-6/zsh/comple=
te.so
#72 0x80784a1 in runhookdef ()
#73 0x401deb4b in inststrlen () from /usr/lib/zsh/3.1.9-dev-6/zsh/zle.so
#74 0x401dc55c in parambeg () from /usr/lib/zsh/3.1.9-dev-6/zsh/zle.so
#75 0x401db64b in expandorcomplete () from /usr/lib/zsh/3.1.9-dev-6/zsh/zle=
.so
#76 0x401db282 in completecall () from /usr/lib/zsh/3.1.9-dev-6/zsh/zle.so
#77 0x401d34b8 in execzlefunc () from /usr/lib/zsh/3.1.9-dev-6/zsh/zle.so
#78 0x401d30f1 in zleread () from /usr/lib/zsh/3.1.9-dev-6/zsh/zle.so
#79 0x806ca95 in ingetc ()
#80 0x806c9c6 in ingetc ()
#81 0x8066f00 in iaddtoline ()
#82 0x8070407 in gettok ()
#83 0x806fe45 in yylex ()
#84 0x807e6d1 in parse_event ()
#85 0x806a63d in loop ()
#86 0x806c744 in zsh_main ()
#87 0x80515d8 in main ()
#88 0x400adbcc in __libc_start_main () from /lib/libc.so.6
(gdb)=20

CU,
Thomas

--=20
 Thomas K=F6hler Email:   jean-luc@picard.franken.de     | LCARS - Linux
     <><        WWW:     http://jeanluc-picard.de      | for Computers
                IRC:             jeanluc               | on All Real
               PGP public key available from Homepage! | Starships

--tKW2IUtsqtDRztdT
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.4 (GNU/Linux)
Comment: For info see http://www.gnupg.org

iD8DBQE58Y1STEYXWMJlHuYRAv90AJ4uK8UwFqWci6rS9xNrn7PrsP971wCffmGP
9FiVWBo+c27VTyAVInhVWgE=
=QTUd
-----END PGP SIGNATURE-----

--tKW2IUtsqtDRztdT--

