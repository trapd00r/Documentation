From zsh-workers-return-14024-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 19 08:53:38 2001
Return-Path: <zsh-workers-return-14024-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9472 invoked from network); 19 Apr 2001 08:53:37 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Apr 2001 08:53:37 -0000
Received: (qmail 18437 invoked by alias); 19 Apr 2001 08:53:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14024
Received: (qmail 18425 invoked from network); 19 Apr 2001 08:53:29 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
Date: Thu, 19 Apr 2001 12:53:21 +0400 (MSD)
From: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
X-X-Sender:  <bor@itsrm2.mow.siemens.ru>
To: <zsh-workers@sunsite.dk>
Subject: fpath problem on clean install
In-Reply-To: <200104190705.JAA10878@beta.informatik.hu-berlin.de>
Message-ID: <Pine.SV4.4.33.0104191247500.8235-100000@itsrm2.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I did almost clean install on Linux Mdk (hard to tell version - it is
mostly updated to the 8.0 state from 7.2). The fpath agains was set
incorrectly:

bor@localhost% zsh -f
localhost% echo $fpath
/usr/share/zsh/site-functions
/usr/share/zsh/4.0.1-pre-3/functions/Completion/*
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/share/zsh/4.0.1-pre-3/functions/Completion
/usr/share/zsh/4.0.1-pre-3/functions/Misc
/usr/share/zsh/4.0.1-pre-3/functions/Prompts
/usr/share/zsh/4.0.1-pre-3/functions/Zftp
/usr/share/zsh/4.0.1-pre-3/functions/Zle

Looking in Makemod, it is expected result - I do not quite understand, how
I can get something different:

zshpaths.h: Makemod $(CONFIG_INCS)
......
            fpath_tmp="`grep ' functions=.' \
            $(dir_top)/config.modules | sed -e '/^#/d' -e '/ link=no/d' \
            -e 's/^.* functions=//'`"; \
            fpath_tmp=`for f in $$fpath_tmp; do \
              echo $$f | sed -e 's%^Functions/%%' -e 's%/[^/]*$$%%' -e
's%/\*%%'; \
            done | sort | uniq`; \

PLease, note, that it assumes dir/* syntax for functions. In reality we
have

bor@localhost% grep complete config.modules
name=zsh/complete modfile=Src/Zle/complete.mdd link=dynamic auto=yes
load=yes functions=Completion/comp* Completion/*/*/*

I wonder, how it can get installed at all ... O.K. without function
subdirs it works.

-andrej

