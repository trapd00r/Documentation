From zsh-users-return-14936-mason-zsh=primenet.com.au@zsh.org Sun Mar 14 00:45:53 2010
Return-Path: <zsh-users-return-14936-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4889 invoked by alias); 14 Mar 2010 00:45:53 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14936
Received: (qmail 28949 invoked from network); 14 Mar 2010 00:45:51 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at ckhb.org does not designate permitted sender hosts)
Date: Sat, 13 Mar 2010 16:37:13 -0800 (PST)
From: "S. Cowles" <scowles@ckhb.org>
X-X-Sender: picmar@ckhb06.ckhb.org
To: zsh-users@zsh.org
Subject: building zsh on windows 7 with cygwin 1.7.1(0.218/5/3)
Message-ID: <alpine.LN8.2.00.1003131550240.6686@ckhb06.ckhb.org>
User-Agent: Alpine 2.00 (LN8 1167 2008-08-23)
X-Face: Ek1c-Ll9]E|9mF*Z|hf5VSHqF.]0Qv%;h%=Zne"Y3am*(:Tf_BlXI;j'}FMhu%sNCjSk|</(~~v,k&/W^J;>cxD~oD:g5Tv,gN}{Y8("m<8<%%=_vy
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII


When I build current zsh sources on Windows 7 with cygwin 
1.7.1(0.218/5/3), the build fails at Modules/curses.c.  The command issued 
by the makefile is:

gcc -s -shared -Wl,--export-all-symbols -o curses.dll curses..o 
../../Src/libzsh-4.3.10-dev-1.dll -lgdbm -L/usr/lib -lpcre -liconv -ldl 
-lncurses

If I modify the link command for curses.dll to include the ncursesw 
library, the build proceeds to completion:

gcc -s -shared -Wl,--export-all-symbols -o curses.dll curses..o 
../../Src/libzsh-4.3.10-dev-1.dll -lgdbm -L/usr/lib -lpcre -liconv -ldl 
-lncurses -lncursesw


The LIBS value defined in zsh/Src/Modules/Makefile is:

LIBS = -lgdbm -L/usr/lib -lpcre -liconv -ldl -lncursesw -lm -lc

Yet, the value used in the link line is:

-lgdbm -L/usr/lib -lpcre -liconv -ldl -lncurses

I have not yet discovered where/when the definition changes.  Has anyone 
else seen a similar error?

