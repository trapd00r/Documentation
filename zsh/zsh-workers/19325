From zsh-workers-return-19325-mason-zsh=primenet.com.au@sunsite.dk Fri Dec 19 11:14:27 2003
Return-Path: <zsh-workers-return-19325-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2272 invoked from network); 19 Dec 2003 11:14:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 19 Dec 2003 11:14:26 -0000
Received: (qmail 16458 invoked by alias); 19 Dec 2003 11:14:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19325
Received: (qmail 16412 invoked from network); 19 Dec 2003 11:14:19 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 19 Dec 2003 11:14:19 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [202.214.225.228] by sunsite.dk (MessageWall 1.0.8) with SMTP; 19 Dec 2003 11:14:18 -0000
Received: from exchangejp.csr.com (unverified) by mailsweeperjp.CSR.COM
 (Content Technologies SMTPRS 4.3.1) with ESMTP id <T669c89c77ec0a87901358@mailsweeperjp.CSR.COM> for <zsh-workers@sunsite.dk>;
 Fri, 19 Dec 2003 20:15:39 +0900
Received: from EXCHANGE02.csr.com ([192.168.137.45]) by exchangejp.csr.com with Microsoft SMTPSVC(5.0.2195.5329);
	 Fri, 19 Dec 2003 11:15:54 +0000
Received: from csr.com ([192.168.144.127]) by EXCHANGE02.csr.com with Microsoft SMTPSVC(5.0.2195.5329);
	 Fri, 19 Dec 2003 11:15:51 +0000
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: autoconf 2.5 (Re: PATCH: terminfo horor) 
In-reply-to: "Oliver Kiddle"'s message of "Fri, 19 Dec 2003 09:59:31 +0100."
             <3816.1071824371@gmcs3.local> 
Date: Fri, 19 Dec 2003 11:14:11 +0000
Message-ID: <15713.1071832451@csr.com>
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 19 Dec 2003 11:15:51.0203 (UTC) FILETIME=[75F9C730:01C3C621]

Oliver Kiddle wrote:
> This line of the patch looks suspicious:
> 
> +link='if test "x$ac_cv_func_tigetstr" = xyes -a "x$ac_cv_header_curses_h"; t
> hen
>
> Testing just "x$ac_cv_header_curses_h" will always be true. Did you
> intend an ` = xyes' or ` = xno' in there?

Aha, this may be why Mads was seeing problems.  Although it should still
compile the module without the curses stuff as a fallback, so I'm
not convinced...

Mads Martin Joergensen <mmj@suse.de> wrote:
> Ok, I've tweaked the buildenvironment to not having ncurses-devel, and
> without it:
> 
> gcc  -s -rdynamic -o zsh main.o  `cat stamp-modobjs`   -ldl -lnsl -lm -lc
> utils.o(.text+0x2aa9): In function `gettempname':
> : the use of `mktemp' is dangerous, better use `mkstemp'
> init.o(.text+0x1277): In function `init_term':
> : undefined reference to `tgetent'

Is termcap still available?  I can't see it in the link line, which is
suspicious.  What did configure say when it was looking for tgetent
and tigetflag (from config.log)?

Oliver:
> The configure script is creating config.modules twice. Second time
> round when evaluating $link using the code in terminfo.mdd,
> $ac_cv_func_tigetstr was unset. It seems the configure script runs
> config.status. By running configure with --no-create, it was happy to
> build terminfo.so. Switching from autoconf 2.57 to 2.13 also solved the
> issue.

I thought it stored the configure variables somewhere?  I haven't seen this
problem for some reason.  I've got 2.50 here and something later at home.

> We really ought to ditch support for autoconf 2.13 in the 4.1 branch.
> Not having a mixture will just make things simpler.

Yes, I was thinking that.

pws


**********************************************************************
The information transmitted is intended only for the person or
entity to which it is addressed and may contain confidential 
and/or privileged material. 
Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by 
persons or entities other than the intended recipient is 
prohibited. 
If you received this in error, please contact the sender and 
delete the material from any computer.
**********************************************************************

