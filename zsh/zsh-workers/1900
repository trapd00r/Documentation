From zsh-workers-request@euclid.skiles.gatech.edu  Sat Aug  3 04:48:55 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id EAA01707 for <mason@primenet.com.au>; Sat, 3 Aug 1996 04:48:52 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id OAA26524; Fri, 2 Aug 1996 14:44:12 -0400 (EDT)
Resent-Date: Fri, 2 Aug 1996 14:44:12 -0400 (EDT)
From: Bill Pemberton <wfp5p@tigger.itc.virginia.edu>
Message-Id: <199608021842.OAA75406@tigger.itc.Virginia.EDU>
Subject: Re: more on crashes
To: acs@world.std.com
Date: Fri, 2 Aug 1996 14:42:34 -0400 (EDT)
Cc: zsh-workers@math.gatech.edu
In-Reply-To: <199608021804.OAA06999@spacely.icd.teradyne.com> from "Vinnie Shelton" at Aug 02, 1996 02:04:04 PM
X-Mailer: ELM [version 2.5 PL0a11]
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"IG0Wu.0.MU6.xna0o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1900
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Vinnie Shelton writes:
> 
> 
> wfp5p@tigger.itc.virginia.edu said:
> > Ok, here's a way that makes pre5 crash on me every time -- just 
> > backspace (or otherwise delete) 10 chars.  On the 10th backspace it 
> > seg faults....
> 
> I don't see *anything* like this under either:
> 
> SunOS 4.1.3U1 compiled with gcc-2.7.2
> 
> Solaris 2.4/2.5 compiled with Sparcworks 4.1.
> 
> What's your platform/config?  setopts??  More info, please.
> 

In all cases I'm doing --enable-zsh-mem .

Compiled on AIX 4.2 it crashes right when I hit the backspace for the 10th
time.

Compiled on AIX 4.1.4 it doesn't reliably crash with 10 backspaces.  It
does, however, crash often.  Here's a trace:

Segmentation fault in unnamed block $b178 at line 593 in file "mem.c"
  593               m->free = sh->next;
  (dbx) t
  unnamed block $b178, line 593 in "mem.c"
  mem.malloc(size = 4), line 593 in "mem.c"
  zalloc(size = 1), line 329 in "mem.c"
  unnamed block $b409, line 121 in "zle_utils.c"
  cut(0x7, 0x1, 0x1), line 121 in "zle_utils.c"
  backkill(0x1, 0x1), line 66 in "zle_utils.c"
  vibackwarddeletechar(), line 657 in "zle_vi.c"
  unnamed block $b332, line 464 in "zle_main.c"
  unnamed block $b331, line 464 in "zle_main.c"
  unnamed block $b330, line 464 in "zle_main.c"
  zleread(0x20024f80, 0x0), line 464 in "zle_main.c"
  inputline(), line 264 in "input.c"
  ingetc(), line 220 in "input.c"
  hgetc(), line 109 in "hist.c"
  gettok(), line 372 in "lex.c"
  lex.yylex(), line 182 in "lex.c"
  parse_event(), line 59 in "parse.c"
  init.loop(toplevel = 1), line 115 in "init.c"
  main(argc = 1, argv = 0x2ff22a78), line 74 in "init.c"
  

Compiled on AIX 3.2.5 it crashes if I hit return after 10 backspaces.

segmentation violation in resetvideo at line 95 in file "zle_refresh.c"
   95               *nbuf[ln] = '\0';
   (dbx) t
   resetvideo(0x0), line 95 in "zle_refresh.c"
   refresh(0x1), line 230 in "zle_refresh.c"
   unnamed block $b465, line 428 in "zle_main.c"
   unnamed block $b464, line 428 in "zle_main.c"
   zleread(lp = warning: Unable to access address 0x200a57d0 from core
   (invalid char ptr (0x200a57d0)), rp = (nil)), line 428 in "zle_main.c"
   inputline(0x0), line 264 in "input.c"
   unnamed block $b224, line 220 in "input.c"
   ingetc(0x0), line 220 in "input.c"
   hgetc(0x0), line 109 in "hist.c"
   gettok(0x23), line 372 in "lex.c"
   yylex(0x1), line 182 in "lex.c"
   parse_event(0x86), line 59 in "parse.c"
   init.loop(toplevel = 1), line 115 in "init.c"
   main(argc = 1, argv = 0x2ff7fabc), line 74 in "init.c"
   
   

Compiled on SunOS 4.1.3, it doesn't crash but gives the error "attempt to
free more than allocated".

It also appears to have something to do with having vi mode set.  It appears
that I can backspace all I want with bindkey -e set, however, I can crashes
with bindkey -v set.....

-- 
Bill Pemberton                           wfp5p@virginia.edu
ITC/Unix Systems                         flash@virginia.edu
University of Virginia                   uunet!virginia!wfp5p

