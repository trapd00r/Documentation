From zsh-workers-return-5783-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Mar 13 20:31:56 1999
Return-Path: <zsh-workers-return-5783-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3004 invoked from network); 13 Mar 1999 20:31:54 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 13 Mar 1999 20:31:54 -0000
Received: (qmail 3387 invoked by alias); 13 Mar 1999 20:31:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5783
Received: (qmail 3380 invoked from network); 13 Mar 1999 20:31:36 -0000
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <990313092650.ZM633@candle.brasslantern.com>
Date: Sat, 13 Mar 1999 09:26:50 -0800
In-Reply-To: <199812031148.MAA14745@beta.informatik.hu-berlin.de>
Comments: In reply to Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
        "Re: Non-intuitive completion" (Dec  3, 12:48pm)
References: <199812031148.MAA14745@beta.informatik.hu-berlin.de>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: zsh-workers@math.gatech.edu
Subject: Re: Non-intuitive completion
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Dec 3, 12:48pm, Sven Wischnowsky wrote:
} Subject: Re: Non-intuitive completion
}
} Bart Schaefer wrote:
} 
} > ...
} > 
} > Now, if you'd like to see some REALLY strange behavior, which definitely
} > IS a bug in my book, try
} > 
} > zsh% bindkey '^I' expand-or-complete
} > zsh% setopt nounset
} > zsh% print $ZSH_*<TAB>
} 
} The patch below fixes the problem by making zerr() set errflag
} independent of the setting of noerrs. I am far from knowing if this
} should go there (or in paramsubst() or in prefork(), or in...).

I notice this patch isn't in pws-11.  Is it made irrelevant by the new
completion stuff?  If not, can anyone think of a way to test whether
it's the right thing to do WRT not breaking other uses of zerr() ?

Here it is again so you don't have to search the archives:

} *** os/utils.c	Thu Dec  3 09:10:46 1998
} --- Src/utils.c	Thu Dec  3 12:07:49 1998
} ***************
} *** 52,59 ****
}   void
}   zerr(const char *fmt, const char *str, int num)
}   {
} !     if (errflag || noerrs)
}   	return;
}       errflag = 1;
}       trashzle();
}       /*
} --- 52,61 ----
}   void
}   zerr(const char *fmt, const char *str, int num)
}   {
} !     if (errflag || noerrs) {
} ! 	errflag = 1;
}   	return;
} +     }
}       errflag = 1;
}       trashzle();
}       /*

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

