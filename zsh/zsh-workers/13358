From zsh-workers-return-13358-mason-zsh=primenet.com.au@sunsite.dk Tue Jan 16 10:54:54 2001
Return-Path: <zsh-workers-return-13358-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23538 invoked from network); 16 Jan 2001 10:54:52 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 16 Jan 2001 10:54:52 -0000
Received: (qmail 18510 invoked by alias); 16 Jan 2001 10:54:47 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13358
Received: (qmail 18498 invoked from network); 16 Jan 2001 10:54:46 -0000
Message-ID: <Tc0a8890c5123a97d52@mailsweeper01.cambridgesiliconradio.com>
To: koen.van_hoof@alcatel.be,
    zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: TERMCAP problem. 
In-Reply-To: Your message of "Tue, 16 Jan 2001 11:42:02 +0100."
             <3A64257A.5FEA2B99@alcatel.be> 
Date: Tue, 16 Jan 2001 10:54:19 +0000
From: Peter Stephenson <pws@csr.com>

> I've unset TGETENT_ACCEPTS_NULL.
> 
> $ export TERMCAP=abc
> $ ./zhs
> zsh: 26119 segmentation fault (core dumped)  ./zsh
> $ ddd ./zsh core
> 
> And the backtrace is
> #0  0xef5a4274 in strcmp () from /usr/lib/libc.so.1
> #1  0x126c04 in tgetent (bp=0x14d018 "", name=0x15cae8 "xterm") at termcap.c:
> 469
...

The next thing to try is Andrej's other point: increase the declared size
of termbuf until it doesn't crash any more (or increase it to 65536 and
start halving it).  If that works, we'll just have to add a few kb to the
shell to make sure (or use curses).

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

