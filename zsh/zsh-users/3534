From zsh-users-return-3534-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Nov 29 20:02:18 2000
Return-Path: <zsh-users-return-3534-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8536 invoked from network); 29 Nov 2000 20:02:17 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 29 Nov 2000 20:02:17 -0000
Received: (qmail 20112 invoked by alias); 29 Nov 2000 20:02:01 -0000
Mailing-List: contact zsh-users-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.auc.dk
X-Seq: 3534
Received: (qmail 20093 invoked from network); 29 Nov 2000 20:02:00 -0000
Date: Wed, 29 Nov 2000 22:01:34 +0200
From: Mircea Damian <dmircea@linux.kappa.ro>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: zsh-users@sunsite.auc.dk
Subject: Re: [zsh 3.1.9] history bug?
Message-ID: <20001129220134.D4770@linux.kappa.ro>
References: <20001129141451.A24159@lepois.loria.fr> <1001129155002.ZM26865@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <1001129155002.ZM26865@candle.brasslantern.com>; from schaefer@candle.brasslantern.com on Wed, Nov 29, 2000 at 03:50:02PM +0000

I'm seeing a problem with history too. Ok. It saves history but if for any
reason (like kill -9 when it's saving history) the file .history.LOCK
remains and a process with the pid of zsh is running I will not be able to
login (/bin/zsh is my default shell).

For example I do a shutdown, the system is very busy and zsh receives
SIGHUP from shutdown, it starts to write the history (creates to lock) but
the shutdown sends (after a while) SIGKILL and it doesn't finish (the .LOCK
remains) the system reboots.. and voila I'm not able to login because
sendmail is running with the same PID that zsh had.

Is that ok?

(I have here Linux with glibc-2.1.3 and zsh-3.1.9)

PS: Should I try 3.1.9-dev-7?


On Wed, Nov 29, 2000 at 03:50:02PM +0000, Bart Schaefer wrote:
> On Nov 29,  2:14pm, Vincent Lefevre wrote:
> }
> } But all command lines are not stored to the history (even when the
> } previous one was different).
> 
> Can you give an actual example of this, please?
> 
> There have been several changes/fixes to history handling since the June
> release of 3.1.9, so it may very well be fixed in 3.1.9-dev-7.
> 

-- 
Mircea Damian
E-mails: dmircea@kappa.ro, dmircea@roedu.net
WebPage: http://taz.mania.k.ro/~dmircea/

