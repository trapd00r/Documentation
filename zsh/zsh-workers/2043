From zsh-workers-request@euclid.skiles.gatech.edu  Thu Aug 22 13:42:32 1996
Received: from dns.primenet.com.au (dns.primenet.com.au [203.24.36.40]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id NAA00337 for <mason@primenet.com.au>; Thu, 22 Aug 1996 13:42:16 +1000 (EST)
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by dns.primenet.com.au (8.7.5/8.7.3) with ESMTP id FAA00791 for <mason@primenet.com.au>; Thu, 22 Aug 1996 05:20:00 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id PAA06437; Wed, 21 Aug 1996 15:13:50 -0400 (EDT)
Resent-Date: Wed, 21 Aug 1996 15:13:50 -0400 (EDT)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <960821121437.ZM11481@candle.brasslantern.com>
Date: Wed, 21 Aug 1996 12:14:37 -0700
In-Reply-To: Matt Liggett <mliggett@pobox.com>
        "bug in 3.0.0?" (Aug 21, 12:39pm)
References: <199608211739.MAA06080@seven.ucs.indiana.edu>
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (4.0b.729 29jul96)
To: Matt Liggett <mliggett@pobox.com>, zsh-workers@math.gatech.edu
Subject: Re: bug in 3.0.0?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"tkI8f.0.Va1.k_r6o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2043
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

On Aug 21, 12:39pm, Matt Liggett wrote:
- Subject: bug in 3.0.0?
-
- if [[ -z $MAIL ]] {
-     if [[ $OSTYPE = (ultrix4|osf)* ]] {
-        export MAIL=/usr/spool/mail/$USER 
-     } elif [[ $OSTYPE = hpux9* ]] {
-        export MAIL=/usr/mail/$USER 
-     } elif [[ $OSTYPE = solaris2* ]] {
-        export MAIL=/var/mail/$USER 
-     } elif [[ $OSTYPE = sunos4* ]] {
-        export MAIL=/usr/spool/mail/$USER 
-     } else {
-        echo 'WARNING: $MAIL' "not set for $OSTYPE."
-     }
- }

The problem is with "else { ... }".  3.0 wants a "fi" at the end of the
if/elif/else chain, even when using the { ... } form -- but only when
it ends with "else { ... }".

This seems to fix it.

*** Src/parse.c.0	Wed Aug 14 09:43:09 1996
--- Src/parse.c	Wed Aug 21 12:12:50 1996
***************
*** 676,685 ****
  	cmdpush(CS_ELSE);
  	while (tok == SEPER)
  	    yylex();
! 	l = par_list();
! 	if (tok != FI) {
! 	    cmdpop();
! 	    YYERRORV;
  	}
  	addlinknode(thensl, l);
  	nt++;
--- 676,694 ----
  	cmdpush(CS_ELSE);
  	while (tok == SEPER)
  	    yylex();
! 	if (tok == INBRACE) {
! 	    yylex();
! 	    l = par_list();
! 	    if (tok != OUTBRACE) {
! 		cmdpop();
! 		YYERRORV;
! 	    }
! 	} else {
! 	    l = par_list();
! 	    if (tok != FI) {
! 		cmdpop();
! 		YYERRORV;
! 	    }
  	}
  	addlinknode(thensl, l);
  	nt++;

-- 
Bart Schaefer                             Brass Lantern Enterprises
http://www.well.com/user/barts            http://www.nbn.com/people/lantern

New male in /home/schaefer:
>N  2 Justin William Schaefer  Sat May 11 03:43  53/4040  "Happy Birthday"

