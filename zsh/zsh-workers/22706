From zsh-workers-return-22706-mason-zsh=primenet.com.au@sunsite.dk Thu Sep 14 21:02:53 2006
Return-Path: <zsh-workers-return-22706-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8486 invoked from network); 14 Sep 2006 21:02:51 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.5 (2006-08-29) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-0.9 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO,
	RCVD_IN_BL_SPAMCOP_NET autolearn=no version=3.1.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Sep 2006 21:02:51 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 24117 invoked from network); 14 Sep 2006 21:02:45 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Sep 2006 21:02:45 -0000
Received: (qmail 20954 invoked by alias); 14 Sep 2006 21:02:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22706
Received: (qmail 20945 invoked from network); 14 Sep 2006 21:02:37 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 Sep 2006 21:02:37 -0000
Received: (qmail 23537 invoked from network); 14 Sep 2006 21:02:37 -0000
Received: from qb-out-0506.google.com (72.14.204.232)
  by a.mx.sunsite.dk with SMTP; 14 Sep 2006 21:02:36 -0000
Received: by qb-out-0506.google.com with SMTP id a10so740360qbd
        for <zsh-workers@sunsite.dk>; Thu, 14 Sep 2006 14:02:35 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:sender:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition:x-google-sender-auth;
        b=I5eYOYc3ookGu4FeV3n4qd5g3LmPh6Hy+dbjrMNIHrlV5SV89Vo6z4kraN2uk+1pCKvrvlr/379jErhPBawxtX1/a/lQvzEi8zm3lSXGBraXSyDdEscf2KbbM4XDrSfFwzw3S5ENNfu1YP4OBLHzKRe251+zl1v32MOgCvUN+CE=
Received: by 10.90.66.9 with SMTP id o9mr1137671aga;
        Thu, 14 Sep 2006 14:02:34 -0700 (PDT)
Received: by 10.90.27.3 with HTTP; Thu, 14 Sep 2006 14:02:34 -0700 (PDT)
Message-ID: <20a807210609141402v31714a98wab9b75ff7736327@mail.gmail.com>
Date: Thu, 14 Sep 2006 17:02:34 -0400
From: "Vin Shelton" <acs@alumni.princeton.edu>
Sender: ethersoft@gmail.com
To: "Zsh hackers list" <zsh-workers@sunsite.dk>
Subject: Core dump with latest CVS
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Google-Sender-Auth: c9fc476c3b661adb

Peter,

I think your latest prompt/subst changes broke something.  Here's a recipe:

zsh -f
setopt NO_PROMPT_SP
autoload -U promptinit
promptinit
prompt bart

zsh: floating point exception (core dumped)
/usr/local/build/zsh-$(today)/Src/zsh -f


(gdb) bt
#0  0x080a718b in dopadding (str=0xb7ffc810 "", prenum=140, postnum=0,
preone=0x0, postone=0x0, premul=0xb7ffc808 "\b",
    postmul=0x80b8eaf " ") at /usr/local/src/zsh-2006-09-14/Src/subst.c:986
#1  0x080ab1e0 in paramsubst (l=0xb7ffc600, n=Variable "n" is not available.
) at /usr/local/src/zsh-2006-09-14/Src/subst.c:3141
#2  0x080a5969 in stringsubst (list=0xb7ffc600, node=0xb7ffc624,
ssub=0, asssub=0) at /usr/local/src/zsh-2006-09-14/Src/subst.c:156
#3  0x080a5457 in prefork (list=0xb7ffc600, flags=0) at
/usr/local/src/zsh-2006-09-14/Src/subst.c:91
#4  0x08066bb7 in execcmd (state=0xbff3ce38, input=0, output=0,
how=18, last1=2) at /usr/local/src/zsh-2006-09-14/Src/exec.c:1961
#5  0x08065669 in execpline2 (state=0xbff3ce38, pcode=1091, how=18,
input=0, output=0, last1=0)
    at /usr/local/src/zsh-2006-09-14/Src/exec.c:1301
#6  0x08064d79 in execpline (state=0xbff3ce38, slcode=140, how=18,
last1=0) at /usr/local/src/zsh-2006-09-14/Src/exec.c:1087
#7  0x080647c5 in execlist (state=0xbff3ce38, dont_change_job=1,
exiting=0) at /usr/local/src/zsh-2006-09-14/Src/exec.c:893
#8  0x08084a72 in execif (state=0xbff3ce38, do_exec=140) at
/usr/local/src/zsh-2006-09-14/Src/loop.c:520
#9  0x08068330 in execcmd (state=0xbff3ce38, input=0, output=0, how=2,
last1=2) at /usr/local/src/zsh-2006-09-14/Src/exec.c:2528
#10 0x08065669 in execpline2 (state=0xbff3ce38, pcode=835, how=2,
input=0, output=0, last1=0)
    at /usr/local/src/zsh-2006-09-14/Src/exec.c:1301
#11 0x08064d79 in execpline (state=0xbff3ce38, slcode=140, how=2,
last1=0) at /usr/local/src/zsh-2006-09-14/Src/exec.c:1087
#12 0x080647c5 in execlist (state=0xbff3ce38, dont_change_job=1,
exiting=0) at /usr/local/src/zsh-2006-09-14/Src/exec.c:893
#13 0x08064561 in execode (p=0x97f1f90, dont_change_job=140,
exiting=140) at /usr/local/src/zsh-2006-09-14/Src/exec.c:793
#14 0x0806afb0 in runshfunc (prog=0x97f1f90, wrap=0x0, name=0xb7ffc0b0
"prompt_bart_precmd")
    at /usr/local/src/zsh-2006-09-14/Src/exec.c:3905
#15 0x0806ad26 in doshfunc (name=0x98031c8 "prompt_bart_precmd",
prog=0x97f1f90, doshargs=0xb7ffc050, flags=0, noreturnval=0)
    at /usr/local/src/zsh-2006-09-14/Src/exec.c:3814
#16 0x0806a771 in execshfunc (shf=0x97fd3a0, args=0xb7ffc050) at
/usr/local/src/zsh-2006-09-14/Src/exec.c:3604
#17 0x080684c5 in execcmd (state=0xbff3d248, input=0, output=0,
how=18, last1=2) at /usr/local/src/zsh-2006-09-14/Src/exec.c:2576
#18 0x08065669 in execpline2 (state=0xbff3d248, pcode=195, how=18,
input=0, output=0, last1=0)
    at /usr/local/src/zsh-2006-09-14/Src/exec.c:1301
#19 0x08064d79 in execpline (state=0xbff3d248, slcode=140, how=18,
last1=0) at /usr/local/src/zsh-2006-09-14/Src/exec.c:1087
#20 0x080647c5 in execlist (state=0xbff3d248, dont_change_job=1,
exiting=0) at /usr/local/src/zsh-2006-09-14/Src/exec.c:893
#21 0x08064561 in execode (p=0x97f2080, dont_change_job=140,
exiting=140) at /usr/local/src/zsh-2006-09-14/Src/exec.c:793
#22 0x0806afb0 in runshfunc (prog=0x97f2080, wrap=0x0, name=0xb7ffc048
"precmd") at /usr/local/src/zsh-2006-09-14/Src/exec.c:3905
#23 0x0806ad26 in doshfunc (name=0x80bd22f "precmd", prog=0x97f2080,
doshargs=0x0, flags=0, noreturnval=1)
    at /usr/local/src/zsh-2006-09-14/Src/exec.c:3814
#24 0x080ae9ca in callhookfunc (name=0x80bd22f "precmd", lnklst=0x8c)
at /usr/local/src/zsh-2006-09-14/Src/utils.c:1094
#25 0x080aeadb in preprompt () at /usr/local/src/zsh-2006-09-14/Src/utils.c:1137
#26 0x0807875c in loop (toplevel=1, justonce=0) at
/usr/local/src/zsh-2006-09-14/Src/init.c:118
#27 0x0807af33 in zsh_main (argc=2, argv=0xbff3d724) at
/usr/local/src/zsh-2006-09-14/Src/init.c:1324
#28 0x08052d52 in main (argc=140, argv=0x8c) at
/usr/local/src/zsh-2006-09-14/Src/main.c:93
(gdb)

This is on a linux box at work.  uname -a reports

Linux cvs-srvr.aoainc.com 2.6.9-5.EL #1 Wed Jan 5 19:22:18 EST 2005
i686 i686 i386 GNU/Linux

Sorry I don't currently have the time to look into this further right now.

  - Vin
-- 
Whoever you are, no matter how lonely,
the world offers itself to your imagination,
calls to you like the wild geese, harsh and exciting--
over and over announcing your place
in the family of things.			Mary Oliver

