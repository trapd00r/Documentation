From zsh-workers-return-14754-mason-zsh=primenet.com.au@sunsite.dk Wed Jun 06 11:15:47 2001
Return-Path: <zsh-workers-return-14754-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6033 invoked from network); 6 Jun 2001 11:15:46 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Jun 2001 11:15:46 -0000
Received: (qmail 22224 invoked by alias); 6 Jun 2001 11:15:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14754
Received: (qmail 22196 invoked from network); 6 Jun 2001 11:15:19 -0000
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
Date: Wed, 6 Jun 2001 13:14:18 +0200 (MET DST)
Message-Id: <200106061114.NAA24021@beta.informatik.hu-berlin.de>
To: zsh-workers@sunsite.dk
Subject: Re: autoloading from deleted wordcode digest files
In-Reply-To: <1010606104439.ZM1317@candle.brasslantern.com>

Bart Schaefer wrote:

> ...
> 
> You have it backwards.  Clint wants check_dump_file() to search for a
> function in the already-mapped files because load_dump_header() fails
> if it can't do an open().

Ahem.  Yes, that makes more sense.

Note that check_dump_file() does search mapped files, but only if
try_dump_file() could stat the file to compare st_ino and st_dev.

I think I actually considered saving only the filename in the funcdump
struct and compare that (for the equality test, we'd still need
something like that to find out which is the youngest file).

So, to answer Clint's question: with a bit of tweaking on the tests done
I think this would be fine (so that the current behaviour is kept as far
as possible -- only changing what happens when the digest file is
removed).  And, no, I can't see anything that would break -- I'm not
quite sure how the time-stamp comparisons should work with a deleted
file, though, but that seems solvable.


Bye
  Sven


-- 
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

