From zsh-users-return-7572-mason-zsh=primenet.com.au@sunsite.dk Sun Jun 20 21:21:53 2004
Return-Path: <zsh-users-return-7572-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26959 invoked from network); 20 Jun 2004 21:21:52 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.86)
  by ns1.primenet.com.au with SMTP; 20 Jun 2004 21:21:52 -0000
Received: (qmail 16560 invoked from network); 20 Jun 2004 21:21:25 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 20 Jun 2004 21:21:25 -0000
Received: (qmail 9387 invoked by alias); 20 Jun 2004 21:20:59 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7572
Received: (qmail 9378 invoked from network); 20 Jun 2004 21:20:59 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 20 Jun 2004 21:20:56 -0000
Received: (qmail 15678 invoked from network); 20 Jun 2004 21:20:55 -0000
Received: from lakermmtao06.cox.net (68.230.240.33)
  by a.mx.sunsite.dk with SMTP; 20 Jun 2004 21:20:54 -0000
Received: from quark.hightek.org ([68.12.75.33]) by lakermmtao06.cox.net
          (InterMail vM.6.01.03.02 201-2131-111-104-20040324) with ESMTP
          id <20040620212025.FCHR26998.lakermmtao06.cox.net@quark.hightek.org>
          for <zsh-users@sunsite.dk>; Sun, 20 Jun 2004 17:20:25 -0400
Received: by quark.hightek.org (Postfix, from userid 501)
	id F378A12422; Sun, 20 Jun 2004 16:20:37 -0500 (CDT)
Date: Sun, 20 Jun 2004 16:20:37 -0500
From: Vincent Stemen <zsh@hightek.org>
To: zsh-users@sunsite.dk
Subject: Re: pcre module help
Message-ID: <20040620212037.GA39276@quark.hightek.org>
References: <D289C58E-C2AF-11D8-8B47-000A95D2C79E@kalama.no-ip.org> <20040620144844.GA24131@scowler.net> <20040620173608.GA38615@quark.hightek.org> <20040620193711.GA15629@scowler.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20040620193711.GA15629@scowler.net>
User-Agent: Mutt/1.4.1i
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

On Sun, Jun 20, 2004 at 03:37:11PM -0400, Clint Adams wrote:
> > I tried this under zsh-4.2.0 on FreeBSD with the pcre module statically
> > linked in.
> 
> Is the zsh binary actually linked against libpcre?
> Does configure detect the existence of pcre_compile() and pcre_exec()?
> You shouldn't get the "not available on this system" message unless it
> didn't find one of them.

Looks like you are right.  I thought it would automatically use it if
it was available on the system and I enabled it in config.modules.
Especially since it still went through pcre detection, because I saw
output from configure that said,

checking pcre.h usability... yes
checking pcre.h presence... yes
checking for pcre.h... yes

However, further down I disovered it said,

checking for pcre_compile... no
checking for pcre_study... no
checking for pcre_exec... no

because it did not use -lpcre.

Enabling it with the configure option, --enable-pcre, seems to have
corrected that, although I have not recompiled and tested it yet.


> >    pcre_compile: not available on this system
> > 
> >    pcre_match: not available on this system
> 
> > 
> >    # if [[ $PATH -pcre-match '^/.*local' ]]; then echo "matched"; fi
> > 
> >    zsh: unrecognized condition: `$PATH'
> > 
> >    # pcre_compile "^/.*local"
> > 
> >    pcre_compile: not available on this system
> > 
> >    # if [[ $PATH -pcre-match '^/.*local' ]]; then echo "matched"; fi
> > 
> >    -- shell crashes leaving a core file --
> > 
> > The shell crashing is consistent when I try to use -pcre-match after
> > attempting to run pcre_compile.  Also, the -pcre-match method is not
> > mentioned in the zshmodules manual.
> 
> Could you send a gdb backtrace to zsh-workers?

I would still think it should not crash because of a missing feature.
If you still would like a backtrace to find that problem, I will try
to get around to recompiling it with debugging turned on and generate
one for you.  Just let me know.

Vincent

-- 
Vincent Stemen
Avoid the VeriSign/Network Solutions domain registration trap!
Read how Network Solutions (NSI) was involved in stealing our domain name.
http://www.InetAddresses.net

