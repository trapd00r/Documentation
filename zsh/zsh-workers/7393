From zsh-workers-return-7393-mason-zsh=primenet.com.au@sunsite.auc.dk Sat Aug 07 07:00:34 1999
Return-Path: <zsh-workers-return-7393-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28769 invoked from network); 7 Aug 1999 07:00:33 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 7 Aug 1999 07:00:33 -0000
Received: (qmail 24983 invoked by alias); 7 Aug 1999 07:00:24 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7393
Received: (qmail 24976 invoked from network); 7 Aug 1999 07:00:22 -0000
Date: Sat, 7 Aug 1999 17:00:16 +1000
From: Geoff Wing <gcw@pobox.com>
To: Zsh Hackers <zsh-workers@sunsite.auc.dk>
Cc: Ed Osinski <osinski@cs.nyu.edu>
Subject: Re: gawk problem during build, and patches
Message-ID: <19990807170016.A28635@primenet.com.au>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.6i
In-Reply-To: <19990806193107.B29273@valis.NYU.EDU>
Organization: PrimeNet Computer Consultancy

Ed Osinski <osinski@cs.nyu.edu> typed:
:While building zsh 3.0.6, I got the following:
:gawk -f ./rlimits.awk /usr/include/sys/resource.h > rlimits.h
:gcc -c -I.. -I. -I. -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=3D64 -DHAVE_CON=
:FIG_H -Wall -Wno-implicit -Wmissing-prototypes -O2 builtin.c
:In file included from builtin.c:3679:
:rlimits.h:7: parse error at null character
:-----------------------------------------------------------
:signames.h had similar problems.  The culprits were lines like
:             printf("\t%c%s%c,\n", 034, lim[i], 034)

Note: 3.1.6 uses ``34'' not ``034''.  The reasoning behind 034 escapes
me at the moment; I don't think it was random but I can't find
anything about it in my zsh email from 1996 and I don't think we were
using RCS back then so who knows?
Also note my comment at the top of the file: \" can't be used generally
because some systems barf on it.

sed 's/034/34/g' might have been quicker :-)

:in the .awk files.  Somehow, the 034 was not being interpreted as a
:quote (").  I have gawk 3.0.4 installed, but I see that I configured
:it with the --enable-non-decimal-data switch.  I assume this means
:that 034 is taken to be an octal number, which is not intended.  I
:changed the .awk files to just use \" in the format string instead of
:%c and a parameter.  I've included patches below.  (I'm not a
:subscriber to the list, so if there are any problems, please send me
:email.)

Regards,
-- 
Geoff Wing : <gcw@pobox.com>     Work URL: http://www.primenet.com.au/
Rxvt Stuff : <gcw@rxvt.org>      Ego URL : http://pobox.com/~gcw/
Zsh Stuff  : <gcw@zsh.org>       Phone   : (Australia) 0413 431 874

