From zsh-users-return-9530-mason-zsh=primenet.com.au@sunsite.dk Thu Oct 20 01:01:40 2005
Return-Path: <zsh-users-return-9530-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13846 invoked from network); 20 Oct 2005 01:01:38 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 20 Oct 2005 01:01:38 -0000
Received: (qmail 59775 invoked from network); 20 Oct 2005 01:01:29 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 20 Oct 2005 01:01:29 -0000
Received: (qmail 21897 invoked by alias); 20 Oct 2005 01:01:20 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9530
Received: (qmail 21888 invoked from network); 20 Oct 2005 01:01:20 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 20 Oct 2005 01:01:20 -0000
Received: (qmail 58814 invoked from network); 20 Oct 2005 01:01:20 -0000
Received: from vms040pub.verizon.net (206.46.252.40)
  by a.mx.sunsite.dk with SMTP; 20 Oct 2005 01:01:18 -0000
Received: from candle.brasslantern.com ([71.116.81.225])
 by vms040.mailsrvcs.net
 (Sun Java System Messaging Server 6.2 HotFix 0.04 (built Dec 24 2004))
 with ESMTPA id <0IOM00EX2W6305G3@vms040.mailsrvcs.net> for
 zsh-users@sunsite.dk; Wed, 19 Oct 2005 20:01:16 -0500 (CDT)
Received: from candle.brasslantern.com (IDENT:schaefer@localhost [127.0.0.1])
	by candle.brasslantern.com (8.12.11/8.12.11) with ESMTP id j9K11FuN001771;
 Wed, 19 Oct 2005 18:01:15 -0700
Received: (from schaefer@localhost)	by candle.brasslantern.com
 (8.12.11/8.12.11/Submit) id j9K11F35001770; Wed, 19 Oct 2005 18:01:15 -0700
Date: Thu, 20 Oct 2005 01:01:14 +0000
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: How to "STTY" when "setopt nointeractive"?
In-reply-to: <20051019193326.GB150@DervishD>
To: DervishD <zsh@dervishd.net>
Cc: Zsh Users <zsh-users@sunsite.dk>
Message-id: <1051020010114.ZM1769@candle.brasslantern.com>
MIME-version: 1.0
X-Mailer: Z-Mail (5.0.0 30July97)
Content-type: text/plain; charset=us-ascii
References: <20051018191756.GA407@DervishD>
	<1051019014535.ZM32070@candle.brasslantern.com>
	<20051019072418.GA1012@DervishD>
	<1051019153601.ZM1348@candle.brasslantern.com>	<20051019193326.GB150@DervishD>
Comments: In reply to DervishD <zsh@dervishd.net>
 "Re: How to "STTY" when "setopt nointeractive"?" (Oct 19,  9:33pm)
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

On Oct 19,  9:33pm, DervishD wrote:
}
}     Do you mean that STTY doesn't work *on purpose* because ZLE
} couldn't reset the tty if STTY were used?

That is what I meant.

} I took a look at the source code, just in case, but I didn't
} discovered any hint about STTY and INTERACTIVE relations.

It's actually not scripts/interactive, it's that STTY only applies
to the foreground job process leader, and commands in scripts do not
normally become process leaders.  Forcing zsh to think that it is
interactive causes the script to put the commands in their own
process groups (for job control).

    /* If the parameter STTY is set in the command's environment, *
     * we first run the stty command with the value of this       *
     * parameter as it arguments.                                 */
    if ((s = STTYval) && isatty(0) && (GETPGRP() == getpid())) {

