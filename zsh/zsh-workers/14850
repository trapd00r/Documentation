From zsh-workers-return-14850-mason-zsh=primenet.com.au@sunsite.dk Mon Jun 11 17:58:50 2001
Return-Path: <zsh-workers-return-14850-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7861 invoked from network); 11 Jun 2001 17:58:49 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 11 Jun 2001 17:58:49 -0000
Received: (qmail 12427 invoked by alias); 11 Jun 2001 17:58:23 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14850
Received: (qmail 12407 invoked from network); 11 Jun 2001 17:58:23 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer goliath.siemens.de)
Date: Mon, 11 Jun 2001 21:58:37 +0400 (MSD)
From: Andrej Borsenkow <Andrej.Borsenkow@mow.siemens.ru>
X-X-Sender:  <bor@itsrm2.mow.siemens.ru>
To: Timothy Miller <tsm@cs.brown.edu>
cc: <zsh-workers@sunsite.dk>, <tjaalton@cc.hut.fi>
Subject: Re: AIX-problem: the main module won't link statically
In-Reply-To: <yehk82jugj3.fsf@water.cs.brown.edu>
Message-ID: <Pine.SV4.4.33.0106112146580.6656-100000@itsrm2.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On 11 Jun 2001, Timothy Miller wrote:

>
> There's no zshconfig.ac in the zsh-4.0.1 source I have so I presume that's
> what you meant about needing to patch configure.in directly.

Yes.

cd /some/path/zsh-4.0.1
patch -p0 configure.in < patch.file

 However, I was
> unsure about what was meant about autoconf (the currently installed version
> is either 2.14.1 or 2.13), so I patched configure directly (substituting
> AC_DEFINE and dnl the way they were done in configure).

2.14.1 never existed; there are 2.13 or 2.50; anything in between is
development version that was never officially released. You can just use
2.13 after patching configure.in.

 On doing plain
> configure (which uses gcc), it compiles ok up until:
>

Oliver, is it possible to compile zsh with gcc on AIX? I understand,
currently it is assumed that we use native compiler. Or does gcc support
the same options as native compiler?

> Updated `stamp-modobjs'.
> rm -f libzsh-4.0.1.so

Have you removed config.cache after creating new configure? AIX should not
build libzsh.so; it is hardcoded and does not depend on compiler.

> On doing a "CC=cc ./configure --prefix=/cs" it compiles and runs the tests,
> failing A04 and C02 as before, and now also Y0[123] (with failure to load
> module zsh/zpty). Apparently the modules aren't built separately? And I
> can't load zsh/zftp, so something is wrong. It looks like a bunch of modules
> are specified in config.modules as link=no auto=yes but they don't appear to
> be built, installed, or loadable from zsh.


Please

- make clean source tree
- apply the patch and run autoconf-2.13 as above;
- run configure; make
- send config.log, config.h, config.cache and conifg.modules.

Probably, typescript of make does not harm. You may send them directly to
me so as to not clutter list.

-andrej

