From zsh-users-return-11809-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 05 09:03:38 2007
Return-Path: <zsh-users-return-11809-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19735 invoked from network); 5 Sep 2007 09:03:28 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 5 Sep 2007 09:03:28 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 37584 invoked from network); 5 Sep 2007 09:03:22 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 Sep 2007 09:03:22 -0000
Received: (qmail 20664 invoked by alias); 5 Sep 2007 09:03:13 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11809
Received: (qmail 20655 invoked from network); 5 Sep 2007 09:03:12 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 Sep 2007 09:03:12 -0000
Received: (qmail 36298 invoked from network); 5 Sep 2007 09:03:12 -0000
Received: from atom.smasher.org (69.55.237.145)
  by a.mx.sunsite.dk with SMTP; 5 Sep 2007 09:03:04 -0000
Received: (qmail 72430 invoked by uid 1000); 5 Sep 2007 09:03:02 -0000
Message-ID: <20070905090302.72429.qmail@smasher.org>
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
Date: Wed, 5 Sep 2007 21:02:59 +1200 (NZST)
From: Atom Smasher <atom@smasher.org>
In-Reply-To: <070904083104.ZM25598@torch.brasslantern.com>
MIME-Version: 1.0
OpenPGP: id=0xB88D52E4D9F57808; algo=1 (RSA); size=4096; url=http://atom.smasher.org/pgp.txt
References: <20070902154306.35880.qmail@smasher.org>
 <070902105953.ZM22915@torch.brasslantern.com> <20070903163147.GA14017@mastermind>
 <20070904111631.81486.qmail@smasher.org> <070904083104.ZM25598@torch.brasslantern.com>
Subject: Re: fg jobs info
To: zsh-users@sunsite.dk
X-POM: The Moon is Waning Crescent (37% of Full)
X-Hashcash: 1:20:0709050903:zsh-users@sunsite.dk::Er6cMpFjiSV9rJ2a:0000000000000
	0000000000000000000000001KIo

maybe in the process of working out the bugs, there can be some added 
functionality to add a variable that automagically returns the text of the 
fg'd job.

in the meantime, i'm keeping it (relatively) simple and assuming that i've 
only got one job at a time suspended (for me, that's a reasonable 
assumption; YMMV). my preexec runs a function (to display the command name 
in tabs, title bars, icons, etc), and part of the function is simply:

     if [ 'fg' = "${${(z)@}[1]}" ]
     then
       cmnd_name="${(vV)jobtexts}"
     fi

as far as i can tell, the worst case failure is that it will display the 
commands of more than one job. considering the lengths i'd have to go 
through to fix that, and the chances of introducing more bugs, and how 
often i have multiple jobs suspended within a shell (not very often) i 
think this is good enough, for now.

thanks...


On Tue, 4 Sep 2007, Bart Schaefer wrote:

> You're right.  $(jobs) and (jobs) produce different output.  I thought 
> that because the latter worked, the former would also.
>
> Looks to me as if there's a bug here; compare
>
>    print $(jobs)
>    (print $(jobs))
>
> Also, although "jobs" or "jobs -l" prints out the entire jobs listing
> even in subshells/pipelines/etc., "jobs %2" (for example) produces a
> "no such job" error, which surprised me.  That should at least be
> documented.  Try:
>
>    sleep 40 & sleep 30 &
>    jobs | cat
>    jobs %1 | cat
>
> So the easy way out is not going to work here after all.

~~~~~~~~~~~

> Incidentally, yet another bug:
>
>    % sleep 30 & sleep 50 &
>    % fg %- %-
>    [1]  - running    sleep 30
>    fg: %3: no such job
>
> Where did I ever ask for job 3 ?
>


-- 
         ...atom

  ________________________
  http://atom.smasher.org/
  762A 3B98 A3C3 96C9 C6B7 582A B88D 52E4 D9F5 7808
  -------------------------------------------------

         "Human beings, who are almost unique in having the ability
          to learn from the experience of others, are also remarkable
          for their apparent disinclination to do so."
                 -- Douglas Adams, Last Chance to See

