From zsh-workers-return-9185-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jan 03 12:01:46 2000
Return-Path: <zsh-workers-return-9185-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22391 invoked from network); 3 Jan 2000 12:01:42 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 3 Jan 2000 12:01:42 -0000
Received: (qmail 14353 invoked by alias); 3 Jan 2000 12:01:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9185
Received: (qmail 14346 invoked from network); 3 Jan 2000 12:01:29 -0000
Date: Mon, 03 Jan 2000 13:01:13 +0100
From: jarausch@igpm.rwth-aachen.de
Subject: 64_bit logical is broken (was Re: Glob problem with memory)
In-reply-to: <200001031011.LAA11708@numa1.igpm.rwth-aachen.de>
To: pws@pwstephenson.fsnet.co.uk
Cc: zsh-workers@sunsite.auc.dk
Reply-to: jarausch@igpm.rwth-aachen.de
Message-id: <200001031201.NAA18846@numa1.igpm.rwth-aachen.de>
MIME-version: 1.0
Content-type: TEXT/plain; charset=us-ascii

in zsh.h we have
struct heap {
    struct heap *next;		/* next one                                  */
    size_t size;		/* size of heap                              */
    size_t used;		/* bytes used from the heap                  */
    struct heapstack *sp;	/* used by pushheap() to save the value used */
#ifdef PAD_64_BIT
    size_t dummy;		/* Make sure sizeof(heap) is a multiple of 8 */
#endif

with 
#ifndef LONG_IS_64_BIT
# define PAD_64_BIT 1
#endif

Now here

sizeof(long)== 4   so  PAD_64_BIT is defined as 1

but
sizeof(size_t) == 4  and sizeof(void*) == 4 too
so that the padding of struct heap is just wrong here.

What's the intent?

Helmut.

-- 
Helmut Jarausch
Lehrstuhl fuer Numerische Mathematik
Institute of Technology, RWTH Aachen
D 52056 Aachen, Germany

