From zsh-workers-return-25131-mason-zsh=primenet.com.au@sunsite.dk Tue Jun 03 09:27:19 2008
Return-Path: <zsh-workers-return-25131-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9612 invoked from network); 3 Jun 2008 09:27:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 3 Jun 2008 09:27:17 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 97188 invoked from network); 3 Jun 2008 09:27:09 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 3 Jun 2008 09:27:09 -0000
Received: (qmail 16957 invoked by alias); 3 Jun 2008 09:27:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25131
Received: (qmail 16921 invoked from network); 3 Jun 2008 09:27:03 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 3 Jun 2008 09:27:03 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [217.69.20.190])
	by bifrost.dotsrc.org (Postfix) with ESMTP id F1DFB80589A4
	for <zsh-workers@sunsite.dk>; Tue,  3 Jun 2008 11:26:59 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([62.189.241.200])
	by rly20d.srv.mailcontrol.com (MailControl) with ESMTP id m539QucL013263
	for <zsh-workers@sunsite.dk>; Tue, 3 Jun 2008 10:26:57 +0100
Received: from news01.csr.com ([10.103.143.38]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 3 Jun 2008 10:26:56 +0100
Received: from news01.csr.com (localhost.localdomain [127.0.0.1])
	by news01.csr.com (8.14.2/8.13.4) with ESMTP id m539QuP5020666
	for <zsh-workers@sunsite.dk>; Tue, 3 Jun 2008 10:26:56 +0100
Received: from csr.com (pws@localhost)
	by news01.csr.com (8.14.2/8.14.2/Submit) with ESMTP id m539QqK8020654
	for <zsh-workers@sunsite.dk>; Tue, 3 Jun 2008 10:26:56 +0100
X-Authentication-Warning: news01.csr.com: pws owned process doing -bs
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: PATCH: zstat typo in completion
X-Mailer: MH-E 8.0.3; nmh 1.3-RC1; GNU Emacs 22.1.1
Date: Tue, 03 Jun 2008 10:26:52 +0100
Message-ID: <20653.1212485212@csr.com>
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 03 Jun 2008 09:26:56.0264 (UTC) FILETIME=[F75A3880:01C8C55B]
X-Scanned-By: MailControl A-08-50-03 (www.mailcontrol.com) on 10.68.0.130
X-Virus-Scanned: ClamAV 0.91.2/7338/Mon Jun  2 23:48:13 2008 on bifrost
X-Virus-Status: Clean

I can see how often these features get used...

Index: Completion/Unix/Command/_chmod
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_chmod,v
retrieving revision 1.4
diff -u -r1.4 _chmod
--- Completion/Unix/Command/_chmod	28 May 2007 22:57:39 -0000	1.4
+++ Completion/Unix/Command/_chmod	3 Jun 2008 09:25:54 -0000
@@ -54,7 +54,7 @@
   ;;
   files)
     if [[ -n $opt_args[--reference] ]]; then
-      zmodload -F zsh/stat zstat 2>/dev/null
+      zmodload -F zsh/stat b:zstat 2>/dev/null
       typeset -i8 ref=$(zstat +mode $opt_args[--reference])
       _wanted files expl file _files -g "*(-.^f${ref#??})" && ret=0
     elif [[ $words[2] = [0-7]## ]]; then
Index: Completion/Unix/Command/_chown
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_chown,v
retrieving revision 1.11
diff -u -r1.11 _chown
--- Completion/Unix/Command/_chown	28 May 2007 22:57:39 -0000	1.11
+++ Completion/Unix/Command/_chown	3 Jun 2008 09:25:54 -0000
@@ -50,7 +50,7 @@
   files)
     (( $+opt_args[-h] || $+opt_args[--no-dereference] )) || deref="-"
     if (( $+opt_args[--reference] )); then
-      zmodload -F zsh/stat zstat 2>/dev/null
+      zmodload -F zsh/stat b:zstat 2>/dev/null
       usr=$(zstat +uid $opt_args[--reference])
       grp=$(zstat +gid $opt_args[--reference])
       _wanted files expl file _files -g "*($deref^u$usr,$deref^g$grp)" && ret=0
Index: Completion/Unix/Command/_cvs
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_cvs,v
retrieving revision 1.29
diff -u -r1.29 _cvs
--- Completion/Unix/Command/_cvs	11 Jan 2008 21:06:29 -0000	1.29
+++ Completion/Unix/Command/_cvs	3 Jun 2008 09:25:55 -0000
@@ -561,7 +561,7 @@
 _cvs_loadstat() {
   (( $+_cvs_loadstat_status )) && return $_cvs_loadstat_status
 
-  zmodload -F zsh/stat zstat 2>/dev/null
+  zmodload -F zsh/stat b:zstat 2>/dev/null
   (( _cvs_loadstat_status = ! $+builtins[zstat] ))
   return $_cvs_loadstat_status
 }
Index: Completion/Unix/Type/_list_files
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Type/_list_files,v
retrieving revision 1.6
diff -u -r1.6 _list_files
--- Completion/Unix/Type/_list_files	28 May 2007 22:57:40 -0000	1.6
+++ Completion/Unix/Type/_list_files	3 Jun 2008 09:25:55 -0000
@@ -46,7 +46,7 @@
 
 (( ok )) || return 1
 
-zmodload -F zsh/stat zstat 2>/dev/null || return 1
+zmodload -F zsh/stat b:zstat 2>/dev/null || return 1
 
 dir=${2:+$2/}
 dir=${(Q)dir}
Index: Completion/Zsh/Type/_file_descriptors
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Zsh/Type/_file_descriptors,v
retrieving revision 1.5
diff -u -r1.5 _file_descriptors
--- Completion/Zsh/Type/_file_descriptors	28 May 2007 22:57:40 -0000	1.5
+++ Completion/Zsh/Type/_file_descriptors	3 Jun 2008 09:25:55 -0000
@@ -7,7 +7,7 @@
 if zstyle -T ":completion:${curcontext}:" verbose && [[ -e /proc/$$/fd ]]; then
   zstyle -s ":completion:${curcontext}:" list-separator sep || sep=--
 
-  if zmodload -F zsh/stat zstat; then
+  if zmodload -F zsh/stat b:zstat; then
     for i in "${fds[@]}"; do
       zstat +link -A link /proc/$$/fd/$i
       list+=( "$i $sep ${link[1]}" )


-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR PLC, Churchill House, Cambridge Business Park, Cowley Road
Cambridge, CB4 0WZ, UK                          Tel: +44 (0)1223 692070

