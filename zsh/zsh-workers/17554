From zsh-workers-return-17554-mason-zsh=primenet.com.au@sunsite.dk Thu Aug 15 22:10:38 2002
Return-Path: <zsh-workers-return-17554-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18089 invoked from network); 15 Aug 2002 22:10:37 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 15 Aug 2002 22:10:37 -0000
Received: (qmail 10662 invoked by alias); 15 Aug 2002 22:10:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17554
Received: (qmail 10648 invoked from network); 15 Aug 2002 22:10:26 -0000
Date: Thu, 15 Aug 2002 18:10:21 -0400
From: Clint Adams <clint@zsh.org>
To: Peter Stephenson <pws@csr.com>
Cc: Zsh Workers <zsh-workers@sunsite.dk>
Subject: Re: 4.0.6
Message-ID: <20020815221021.GA2824@dman.com>
References: <12293.1029326663@csr.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <12293.1029326663@csr.com>
User-Agent: Mutt/1.4i
X-Virus-Scanned: by amavisd-milter (http://amavis.org/)

> Bart pointed out Karl Tomlinson's termcap/terminfo fix from 17482 should
> be in 4.0 and Thomas Stromberg sent a fix for _mount in 17542, so I have
> updated 4.0.5 to 4.0.6 and sent it to Sourceforge.

4.0.6 segfaults on startup for me (due to use of $terminfo in
/etc/zshrc); this patch seems to help:


Index: Src/Modules/terminfo.c
===================================================================
RCS file: /var/lib/cvs/debian/zsh/Src/Modules/terminfo.c,v
retrieving revision 1.1.1.2
diff -u -r1.1.1.2 terminfo.c
--- Src/Modules/terminfo.c	14 Aug 2002 17:28:52 -0000	1.1.1.2
+++ Src/Modules/terminfo.c	15 Aug 2002 21:49:49 -0000
@@ -198,6 +198,8 @@
     {
 	pm->u.str = dupstring(tistr);
 	pm->flags |= PM_SCALAR;
+	pm->sets.cfn = NULL;
+	pm->gets.cfn = strgetfn;
     }
     else
     {

