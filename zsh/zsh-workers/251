From zsh-workers-request@math.gatech.edu  Sat Jul 22 04:34:50 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id EAA12182 for <mason@werple.mira.net.au>; Sat, 22 Jul 1995 04:34:47 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA18668
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Fri, 21 Jul 1995 14:35:42 -0400
Received: by math (5.x/SMI-SVR4)
	id AA20118; Fri, 21 Jul 1995 14:32:10 -0400
Resent-Date: Fri, 21 Jul 1995 20:31:17 +0100 (MET DST)
Old-Return-Path: <hzoli@cs.elte.hu>
From: hzoli@cs.elte.hu (Zoltan Hidvegi)
Message-Id: <9507211831.AA09153@turan.elte.hu>
Subject: Bugfix for hzoli10
To: zsh-workers@math.gatech.edu (zsh-workers)
Date: Fri, 21 Jul 1995 20:31:17 +0100 (MET DST)
X-Mailer: ELM [version 2.4 PL21]
Content-Type: text
Resent-Message-Id: <"rq3I4.0.Gw4.fA_3m"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/251
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

The bug:

% foo=(a b c)
% echo $foo[$$]
zsh: oops. In parsestr

The fix is here.

Zoltan

--- 1.13	1995/07/06 12:28:04
+++ Src/lex.c	1995/07/19 23:26:32
@@ -969,8 +969,11 @@
 		add(Qstring);
 		c = Inbrace;
 		bct++;
-	    } else {
+	    } else if (c == '$')
+		add(Qstring);
+	    else {
 		hungetc(c);
+		lexstop = 0;
 		c = Qstring;
 	    }
 	    break;

