From zsh-users-return-12790-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 17 21:54:00 2008
Return-Path: <zsh-users-return-12790-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7545 invoked from network); 17 Apr 2008 21:53:59 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 Apr 2008 21:53:59 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 48508 invoked from network); 17 Apr 2008 21:53:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 Apr 2008 21:53:42 -0000
Received: (qmail 16119 invoked by alias); 17 Apr 2008 21:53:33 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12790
Received: (qmail 16101 invoked from network); 17 Apr 2008 21:53:32 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 17 Apr 2008 21:53:32 -0000
Received: from an-out-0708.google.com (an-out-0708.google.com [209.85.132.242])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 43D0D8043AC7
	for <zsh-users@sunsite.dk>; Thu, 17 Apr 2008 23:53:24 +0200 (CEST)
Received: by an-out-0708.google.com with SMTP id c14so69726anc.13
        for <zsh-users@sunsite.dk>; Thu, 17 Apr 2008 14:53:23 -0700 (PDT)
Received: by 10.101.69.10 with SMTP id w10mr3488354ank.68.1208469203396;
        Thu, 17 Apr 2008 14:53:23 -0700 (PDT)
Received: by 10.100.123.8 with HTTP; Thu, 17 Apr 2008 14:53:23 -0700 (PDT)
Message-ID: <cb59c2d10804171453m66cc202bof01e3ca15e32bd3e@mail.gmail.com>
Date: Thu, 17 Apr 2008 21:53:23 +0000
From: "Johann \"Myrkraverk\" Oskarsson" <johann@myrkraverk.com>
To: "ZSH Users" <zsh-users@sunsite.dk>
Subject: Compilation errors on OpenSolaris snv 77
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Scanned: ClamAV 0.91.2/6813/Thu Apr 17 19:00:03 2008 on bifrost
X-Virus-Status: Clean

Hi all,

Trying to compile zsh, both 4.2.7 and 4.3.6 I ran into the following error:

Undefined               first referenced
 symbol                     in file
libiconv_close                      utils.o
libiconv_open                       utils.o
libiconv                            utils.o

My ./configure line is: CC=cc CXX=CC ./configure --enable-pcre

uname -a: SunOS asuka 5.11 snv_77 i86pc i386 i86pc

A "workaround" was to add the following into Src/utils.c:

#ifdef iconv_open
#undef iconv_open
#endif
#ifdef iconv_close
#undef iconv_close
#endif
#ifdef iconv
#undef iconv
#endif

I have no idea where the macros are defined.

Is this generally known?  If anyone has a clue as to how I can find
the macros and/or tell me how I should patch the shell, I just might
submit one.


Johann

