From zsh-workers-return-23241-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 28 00:25:28 2007
Return-Path: <zsh-workers-return-23241-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5876 invoked from network); 28 Mar 2007 00:25:26 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 28 Mar 2007 00:25:26 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 1188 invoked from network); 27 Mar 2007 18:58:41 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Mar 2007 18:58:41 -0000
Received: (qmail 21079 invoked by alias); 27 Mar 2007 18:58:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 23241
Received: (qmail 21070 invoked from network); 27 Mar 2007 18:58:38 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 27 Mar 2007 18:58:38 -0000
Received: (qmail 858 invoked from network); 27 Mar 2007 18:58:38 -0000
Received: from web36814.mail.mud.yahoo.com (209.191.85.65)
  by a.mx.sunsite.dk with SMTP; 27 Mar 2007 18:58:32 -0000
Received: (qmail 78156 invoked by uid 60001); 27 Mar 2007 18:58:30 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=equ51HX4RWs/gyaoN1Uyo+3WVEk2xM61asaC19yB79nP4y/VacO5zG/eK5CbVh9Pm0L4ZcxWJ9X1F6J9/mEIRwEBtz5fxUI8cuTQmL5zpjtM2Rd8O+V2DDKZUvCXL+MUtolAA1ldJ2rtQco+XDyE8D9qR+yps/6ygMzES2PNBuY=;
X-YMail-OSG: HSlC8PwVM1lOM8iYluFnhrLlyKyMgACKqDbGek1HER9AHsHRPq6zX1K0tyIw5HEYO07l6bqXX5TFqnQPYdTy3f3OZ0CB45n6Nq9IV9fJVCF9lQ79ZtTdkmFLuboW6g--
Received: from [88.114.230.68] by web36814.mail.mud.yahoo.com via HTTP; Tue, 27 Mar 2007 11:58:30 PDT
Date: Tue, 27 Mar 2007 11:58:30 -0700 (PDT)
From: Daniel Qarras <dqarras@yahoo.com>
Subject: Re: PATCH: _module
To: zsh-workers@sunsite.dk
In-Reply-To: <20070314211105.GA24978@scowler.net>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="0-1956232770-1175021910=:77772"
Content-Transfer-Encoding: 8bit
Message-ID: <611422.77772.qm@web36814.mail.mud.yahoo.com>

--0-1956232770-1175021910=:77772
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Content-Id: 
Content-Disposition: inline

Hi,

as some of you might know, there are two implementations of the Modules
system, C and Tcl versions. They should be compatible and I had done my
testing with C version but now I happened to try also the Tcl version.
It turned out that the attached small patch was needed.

Please apply, sorry for the inconvenience.

Thanks!


 
____________________________________________________________________________________
No need to miss a message. Get email on-the-go 
with Yahoo! Mail for Mobile. Get started.
http://mobile.yahoo.com/mail 
--0-1956232770-1175021910=:77772
Content-Type: text/x-patch; name="_module.patch"
Content-Description: 3112873836-_module.patch
Content-Disposition: inline; filename="_module.patch"

--- zsh/Completion/Unix/Command/_module.orig
+++ zsh/Completion/Unix/Command/_module
@@ -85,7 +85,7 @@
 {
   if (( [[ -n "$MODULEPATH" ]] && [[ ${+_available_modules} -eq 0 ]] ));
   then
-    _available_modules=($(find ${(e)=MODULEPATH//:/ } -xtype f -print 2>/dev/null | grep -v \.version | sed -e 's,\('${${(e)=MODULEPATH//:/\/\\\|}%\\\|}'\),,g'))
+    _available_modules=($(find ${(e)=MODULEPATH//:/ } -xtype f -print 2>/dev/null | grep -v \.version | sed -e 's,\('${${(e)=MODULEPATH//:/\/\\\|}%\\\|}'\),,g' -e 's,^/*,,g'))
   fi
 }
 

--0-1956232770-1175021910=:77772--

