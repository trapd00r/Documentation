From zsh-workers-return-27093-mason-zsh=primenet.com.au@sunsite.dk Tue Jul 07 14:15:45 2009
Return-Path: <zsh-workers-return-27093-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7397 invoked from network); 7 Jul 2009 14:15:33 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 7 Jul 2009 14:15:33 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 75915 invoked from network); 7 Jul 2009 14:15:23 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 Jul 2009 14:15:23 -0000
Received: (qmail 29546 invoked by alias); 7 Jul 2009 14:15:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 27093
Received: (qmail 29529 invoked from network); 7 Jul 2009 14:15:13 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 7 Jul 2009 14:15:13 -0000
Received: from QMTA09.westchester.pa.mail.comcast.net (qmta09.westchester.pa.mail.comcast.net [76.96.62.96])
	by bifrost.dotsrc.org (Postfix) with ESMTP id E97E980307FB
	for <zsh-workers@sunsite.dk>; Tue,  7 Jul 2009 16:15:09 +0200 (CEST)
Received: from OMTA02.westchester.pa.mail.comcast.net ([76.96.62.19])
	by QMTA09.westchester.pa.mail.comcast.net with comcast
	id Cz1N1c0020QuhwU592F9Vt; Tue, 07 Jul 2009 14:15:09 +0000
Received: from smtp.klanderman.net ([98.217.254.247])
	by OMTA02.westchester.pa.mail.comcast.net with comcast
	id D2F91c0095M2Np63N2F9UB; Tue, 07 Jul 2009 14:15:09 +0000
Received: from lwm.klanderman.net (unknown [192.168.100.50])
	by smtp.klanderman.net (Postfix) with ESMTP id 1BCD1B30144
	for <zsh-workers@sunsite.dk>; Tue,  7 Jul 2009 10:15:08 -0400 (EDT)
Received: by lwm.klanderman.net (Postfix, from userid 500)
	id 0429A9FC61C; Tue,  7 Jul 2009 10:15:08 -0400 (EDT)
From: Greg Klanderman <gak@klanderman.net>
To: zsh-workers@sunsite.dk
Subject: Re: need help debugging cvs completion problem
Reply-To: gak@klanderman.net
Date: Tue, 07 Jul 2009 10:15:07 -0400
In-Reply-To: <20090628205428.77cd5198@pws-pc> (Peter Stephenson's message of "Sun, 28 Jun 2009 20:54:28 +0100")
Message-ID: <m363e4lgus.fsf@klanderman.net>
User-Agent: Gnus/5.1007 (Gnus v5.10.7) XEmacs/21.4.17 (linux)
References: <19013.18790.978774.551126@gargle.gargle.HOWL>
	<20090627212418.36848701@pws-pc> <m3ljndmbe8.fsf@klanderman.net>
	<m3iqihmabi.fsf@klanderman.net>
	<20090628113802.GA3707@primenet.com.au>
	<m3fxdkmeob.fsf@klanderman.net> <m3d48ombqw.fsf@klanderman.net>
	<20090628205428.77cd5198@pws-pc>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Scanned: ClamAV 0.94.2/9540/Tue Jul  7 12:52:52 2009 on bifrost
X-Virus-Status: Clean

>>>>> Peter Stephenson <p.w.stephenson@ntlworld.com> writes:

> That sounds plausible---I think you're on the right lines.  You might
> need a -U argument to compadd in that case, too.

> Basically, you are (anybody is) on your (their) own in this type of
> thing---lots of us have been somewhere similar once or twice and it was
> so complicated we've forgotten and won't remember again without devoting
> hours to remembering why we thought it was better to forget in the first
> place.

Hi Peter, sorry I had to put this aside for a bit, and am still not
quite ready to dig back into it.  Seems like to fix this right, I'm
headed down a path where I have to reinvent much of the cruft that's
already in _path_files, which is probably why the logic had been
trying to leverage that, albeit in a somewhat hacky way.  My next step
is to understand what was actually broken that you fixed in 2003, and
if there's not some way to go back to using _path_files.

Unfortunately, it seems that when the new completion system was
designed, it did not abstract stuff like handling parameter
references, quoting, etc like the compctl stuff did.  So if you're
doing file completion, _path_files has all that logic (at the expense
of being completely incomprehensible) and it mostly works, but other
sorts of completion either have to reimplement that logic (sometimes
partially and/or buggily), or just not handle these complications.

cheers,
Greg

