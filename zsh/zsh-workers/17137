From zsh-workers-return-17137-mason-zsh=primenet.com.au@sunsite.dk Mon May 13 10:14:33 2002
Return-Path: <zsh-workers-return-17137-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 9226 invoked from network); 13 May 2002 10:14:32 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 13 May 2002 10:14:32 -0000
Received: (qmail 3283 invoked by alias); 13 May 2002 10:14:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17137
Received: (qmail 3269 invoked from network); 13 May 2002 10:14:26 -0000
From: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
To: "'Sven Wischnowsky'" <wischnow@berkom.de>, zsh-workers@sunsite.dk
Subject: RE: completion in quotes - " vs ' - no suffix added
Date: Mon, 13 May 2002 14:14:19 +0400
Message-ID: <6134254DE87BD411908B00A0C99B044F02E89A8C@mowd019a.mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.3416
x-mimeole: Produced By Microsoft MimeOLE V6.00.2600.0000
In-Reply-To: <15583.34740.981994.404489@wischnow.berkom.de>
Importance: Normal

> 
> Bart Schaefer wrote:
> 
> > ...
> >
> > Sven, what you're missing is that although the result is correct
after
> > you execute the command, the completion is not correct while the
command
> > line is being built.  That is, if the completion system is going to
turn
> > the file name `a\ b' into the string `"a\\ b"' when it inserts it on
the
> > line, then `compset -q' should also UNDO the backslash-doubling
again
> > when the quote character is a double-quote, so that it's possible to
> > correctly complete the file path on the second and subsequent calls
to
> > the completion system.
> 
> (Sorry for the delay, I was away on Thursday and Friday.)
> 
> (Also sorry for being so bone-headed. Ahem.)
> 
> Whew, this was pretty complicated, we have to special-case this stuff.
> Because a quoting a single quote inserts more single quotes. This
> wasn't even handled correctly (in the case that there was one quoted
> single quote in the string) by get_comp_string().
> 
> The patch below should fix it. At least it does for the pretty
> complicated cases I tried.
> 

I do not see any difference with this patch. As before, listing
pathnames with spaces in single quotes correctly adds slash to
directories and in double quotes adds nothing.

-andrej

