From zsh-workers-request@math.gatech.edu  Sat Jul  8 02:32:30 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id CAA15520 for <mason@werple.mira.net.au>; Sat, 8 Jul 1995 02:32:25 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA25564
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Fri, 7 Jul 1995 12:33:26 -0400
Received: by math (5.x/SMI-SVR4)
	id AA26873; Fri, 7 Jul 1995 12:30:14 -0400
Resent-Date: Fri, 7 Jul 95 09:58:41 EDT
Old-Return-Path: <chen@adi.com>
Date: Fri, 7 Jul 95 09:58:41 EDT
From: chen@adi.com
Message-Id: <9507071358.AA04372@grunt>
To: zsh-workers@math.gatech.edu
Subject: Re: Serious HP-UX problem ! Shell hangs ! 
In-Reply-To: <9507062245.AA18180@redwood.skiles.gatech.edu>
References: <9507061805.AA06920@turan.elte.hu>
	<9507062245.AA18180@redwood.skiles.gatech.edu>
Resent-Message-Id: <"iCnF22.0.pZ6.L4M_l"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/177
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Richard Coleman writes:
> > > This is a *serious* HP-UX 9 problem of the zsh, which it didn't have
> > > with previous versions (not with beta6 at least).
> > > 
> > >   Situation :
> > > 
> > >   $ sleep 10 (any process will do)
> > >   [Ctrl-Z] 
> > >   zsh: 16763 suspended  sleep 10
> > >   $ sleep 5 (any process)
> > >   *hang*
> > > 
> > > Fiddling with gdb shows that we are hanging in sigsuspend(), which is
> > > called exactly once: signals.c with POSIX_SIGNALS defined.
> > 
> > This is a quite old problem (it is present at least since beta6). It is OS
> > dependent, and it is also present on ULTRIX. As I remember it appeared after
> > Richard rewrote the signals code. He promised to fix that.
> 
> I don't have any HP or DEC machines, so it is difficult for me to
> track down.  Does this still happen if you change POSIX_SIGNALS to
> BSD_SIGNALS?  It might be bugs in the Posix code for these machines.
> If this fixes it, I can just force configure to use BSD signals on
> these machines.

I have been unable to reproduce this problem.

6 ~ chen@gar$ uname -a
HP-UX gar A.09.03 A 9000/720 2000519265 two-user license
7 ~ chen@gar$ echo $ZSH_VERSION
2.6-beta10
8 ~ chen@gar$ sleep 10

zsh: 11651 suspended  sleep 10
9 ~ chen@gar$ sleep 5
10 ~ chen@gar$ jobs
[1]  + suspended  sleep 10
11 ~ chen@gar$ fg
[1]  + continued  sleep 10
12 ~ chen@gar$ jobs
13 ~ chen@gar$



I build zsh (and all other autoconf-based software) with
	CC="c89 -D_HPUX_SOURCE" configure
and below is the config.cache I have accumulated:

# This file is a shell script that caches the results of configure
# tests run on this system so they can be shared between configure
# scripts and configure runs.  It is not useful on other systems.
# If it contains results you don't want to keep, you may remove or edit it.
#
# By default, configure uses ./config.cache as the cache file,
# creating it if it does not exist already.  You can give configure
# the --cache-file=FILE option to use a different cache file; that is
# what configure does when it calls configure scripts in
# subdirectories, so they share the cache.
# Giving --cache-file=/dev/null disables caching, for debugging configure.
# config.status only pays attention to the cache file if you give it the
# --recheck option to rerun configure.
#
: ${ac_cv_c_const='yes'}
: ${ac_cv_c_cross='no'}
: ${ac_cv_c_stack_direction='1'}
: ${ac_cv_check_symbol__sys_siglist='no'}
: ${ac_cv_check_symbol_sys_siglist='no'}
: ${ac_cv_decl_sys_siglist='no'}
: ${ac_cv_func__getpty='no'}
: ${ac_cv_func__setjmp='yes'}
: ${ac_cv_func_access='yes'}
: ${ac_cv_func_alarm='yes'}
: ${ac_cv_func_alloca='no'}
: ${ac_cv_func_closedir_void='no'}
: ${ac_cv_func_difftime='yes'}
: ${ac_cv_func_dup2='yes'}
: ${ac_cv_func_ftime='yes'}
: ${ac_cv_func_getcwd='yes'}
: ${ac_cv_func_getdomainname='yes'}
: ${ac_cv_func_getdtablesize='no'}
: ${ac_cv_func_getgroups='yes'}
: ${ac_cv_func_gethostent='yes'}
: ${ac_cv_func_gethostname='yes'}
: ${ac_cv_func_getloadavg='no'}
: ${ac_cv_func_getloadavg_setgid='no'}
: ${ac_cv_func_getlogin='yes'}
: ${ac_cv_func_getpagesize='no'}
: ${ac_cv_func_getpgrp_void='yes'}
: ${ac_cv_func_gettimeofday='yes'}
: ${ac_cv_func_getwd='no'}
: ${ac_cv_func_grantpt='no'}
: ${ac_cv_func_killpg='no'}
: ${ac_cv_func_link='yes'}
: ${ac_cv_func_memcpy='yes'}
: ${ac_cv_func_mkdir='yes'}
: ${ac_cv_func_mkfifo='yes'}
: ${ac_cv_func_mkstemp='yes'}
: ${ac_cv_func_mktemp='yes'}
: ${ac_cv_func_poll='yes'}
: ${ac_cv_func_psignal='no'}
: ${ac_cv_func_rand48='no'}
: ${ac_cv_func_random='no'}
: ${ac_cv_func_select='yes'}
: ${ac_cv_func_setegid='no'}
: ${ac_cv_func_seteuid='no'}
: ${ac_cv_func_setlinebuf='no'}
: ${ac_cv_func_setlocale='yes'}
: ${ac_cv_func_setpgid='yes'}
: ${ac_cv_func_setregid='no'}
: ${ac_cv_func_setresuid='yes'}
: ${ac_cv_func_setreuid='no'}
: ${ac_cv_func_setsid='yes'}
: ${ac_cv_func_setuid='yes'}
: ${ac_cv_func_setvbuf='yes'}
: ${ac_cv_func_setvbuf_reversed='no'}
: ${ac_cv_func_sigaction='yes'}
: ${ac_cv_func_sigaltstack='no'}
: ${ac_cv_func_sigblock='yes'}
: ${ac_cv_func_sighold='no'}
: ${ac_cv_func_sigprocmask='yes'}
: ${ac_cv_func_sigrelse='no'}
: ${ac_cv_func_sigsetmask='yes'}
: ${ac_cv_func_sigstack='yes'}
: ${ac_cv_func_sigvec='no'}
: ${ac_cv_func_strchr='yes'}
: ${ac_cv_func_strcoll='yes'}
: ${ac_cv_func_strerror='yes'}
: ${ac_cv_func_strftime='yes'}
: ${ac_cv_func_strrchr='yes'}
: ${ac_cv_func_strsignal='no'}
: ${ac_cv_func_strstr='yes'}
: ${ac_cv_func_strtol='yes'}
: ${ac_cv_func_system='yes'}
: ${ac_cv_func_tcgetattr='yes'}
: ${ac_cv_func_tcsetpgrp='yes'}
: ${ac_cv_func_times='yes'}
: ${ac_cv_func_tmpfile='yes'}
: ${ac_cv_func_ttyname='yes'}
: ${ac_cv_func_unlink='yes'}
: ${ac_cv_func_utime='yes'}
: ${ac_cv_func_utimes='no'}
: ${ac_cv_func_vfork='yes'}
: ${ac_cv_func_vprintf='yes'}
: ${ac_cv_func_wait3='no'}
: ${ac_cv_func_waitpid='yes'}
: ${ac_cv_header_alloca_h='no'}
: ${ac_cv_header_ctype_h='yes'}
: ${ac_cv_header_dirent_dirent_h='yes'}
: ${ac_cv_header_elf_h='no'}
: ${ac_cv_header_errno_h='yes'}
: ${ac_cv_header_fcntl_h='yes'}
: ${ac_cv_header_getopt_h='no'}
: ${ac_cv_header_inq_stats_cpustats_h='no'}
: ${ac_cv_header_ioctl_h='no'}
: ${ac_cv_header_libc_h='no'}
: ${ac_cv_header_limits_h='yes'}
: ${ac_cv_header_locale_h='yes'}
: ${ac_cv_header_mach_mach_h='no'}
: ${ac_cv_header_malloc_h='yes'}
: ${ac_cv_header_memory_h='yes'}
: ${ac_cv_header_minix_config_h='no'}
: ${ac_cv_header_nlist_h='yes'}
: ${ac_cv_header_poll_h='yes'}
: ${ac_cv_header_select_h='no'}
: ${ac_cv_header_setjmp_h='yes'}
: ${ac_cv_header_sgtty_h='yes'}
: ${ac_cv_header_siginfo_h='no'}
: ${ac_cv_header_signal_h='yes'}
: ${ac_cv_header_stat_broken='no'}
: ${ac_cv_header_stdc='yes'}
: ${ac_cv_header_stddef_h='yes'}
: ${ac_cv_header_stdio_h='yes'}
: ${ac_cv_header_stdlib_h='yes'}
: ${ac_cv_header_string_h='yes'}
: ${ac_cv_header_stropts_h='no'}
: ${ac_cv_header_sys_cpustats_h='no'}
: ${ac_cv_header_sys_dg_sys_info_h='no'}
: ${ac_cv_header_sys_filio_h='no'}
: ${ac_cv_header_sys_ioctl_h='yes'}
: ${ac_cv_header_sys_param_h='yes'}
: ${ac_cv_header_sys_ptem_h='no'}
: ${ac_cv_header_sys_resource_h='yes'}
: ${ac_cv_header_sys_select_h='no'}
: ${ac_cv_header_sys_socket_h='yes'}
: ${ac_cv_header_sys_stat_h='yes'}
: ${ac_cv_header_sys_stream_h='no'}
: ${ac_cv_header_sys_systeminfo_h='no'}
: ${ac_cv_header_sys_time_h='yes'}
: ${ac_cv_header_sys_timeb_h='yes'}
: ${ac_cv_header_sys_times_h='yes'}
: ${ac_cv_header_sys_types_h='yes'}
: ${ac_cv_header_sys_utsname_h='yes'}
: ${ac_cv_header_sys_wait_h='yes'}
: ${ac_cv_header_termcap_h='no'}
: ${ac_cv_header_termio_h='yes'}
: ${ac_cv_header_termios_h='yes'}
: ${ac_cv_header_time='yes'}
: ${ac_cv_header_time_h='yes'}
: ${ac_cv_header_unistd_h='yes'}
: ${ac_cv_header_utime_h='yes'}
: ${ac_cv_header_values_h='yes'}
: ${ac_cv_header_vfork_h='no'}
: ${ac_cv_lib_ICE='no'}
: ${ac_cv_lib_PW='yes'}
: ${ac_cv_lib_curses='yes'}
: ${ac_cv_lib_dir='no'}
: ${ac_cv_lib_dnet='no'}
: ${ac_cv_lib_dnet_stub='no'}
: ${ac_cv_lib_elf='no'}
: ${ac_cv_lib_fl='no'}
: ${ac_cv_lib_gen='no'}
: ${ac_cv_lib_getloadavg='no'}
: ${ac_cv_lib_intl='no'}
: ${ac_cv_lib_kvm='no'}
: ${ac_cv_lib_nsl='no'}
: ${ac_cv_lib_seq='no'}
: ${ac_cv_lib_socket='no'}
: ${ac_cv_lib_sun='no'}
: ${ac_cv_lib_termcap='yes'}
: ${ac_cv_lib_termlib='yes'}
: ${ac_cv_lib_ucb='no'}
: ${ac_cv_lib_util='no'}
: ${ac_cv_os_cray='no'}
: ${ac_cv_path_AWKPATH='/usr/bin/awk'}
: ${ac_cv_path_PERLPATH='/usr/bin/perl'}
: ${ac_cv_path_install='./install-sh -c'}
: ${ac_cv_path_x='no_x= ac_x_includes=/usr/include/X11R5 ac_x_libraries=/usr/lib/X11R5'}
: ${ac_cv_prog_AR='ar'}
: ${ac_cv_prog_AWK='gawk'}
: ${ac_cv_prog_CC='c89 -D_HPUX_SOURCE'}
: ${ac_cv_prog_COULD_BE_SCO='maybenot'}
: ${ac_cv_prog_CPP='c89 -D_HPUX_SOURCE -E'}
: ${ac_cv_prog_LEX='flex'}
: ${ac_cv_prog_LINT='lint'}
: ${ac_cv_prog_LN_S='ln -s'}
: ${ac_cv_prog_NROFF='nroff -man'}
: ${ac_cv_prog_RANLIB='ranlib'}
: ${ac_cv_prog_RSH='remsh'}
: ${ac_cv_prog_YACC='bison -y'}
: ${ac_cv_prog_cc_c89_c_o='yes'}
: ${ac_cv_prog_cc_stdc=''}
: ${ac_cv_prog_gcc='no'}
: ${ac_cv_prog_make_make_set='yes'}
: ${ac_cv_sizeof_long='4'}
: ${ac_cv_struct_nlist_n_un='no'}
: ${ac_cv_struct_st_blksize='yes'}
: ${ac_cv_struct_st_blocks='yes'}
: ${ac_cv_struct_st_rdev='yes'}
: ${ac_cv_struct_tm='time.h'}
: ${ac_cv_sys_long_file_names='yes'}
: ${ac_cv_td_popen='no'}
: ${ac_cv_td_size_t='yes'}
: ${ac_cv_td_yyerror='no'}
: ${ac_cv_type_mode_t='yes'}
: ${ac_cv_type_off_t='yes'}
: ${ac_cv_type_pid_t='yes'}
: ${ac_cv_type_signal='void'}
: ${ac_cv_type_size_t='yes'}
: ${ac_cv_type_uid_t='yes'}
: ${make_cv_sysconf_open_max='yes'}
: ${make_cv_union_wait='no'}
: ${zsh_cv_func_ut_host_in_utmp='yes'}
: ${zsh_cv_getpgrp_takes_arguments='no'}
: ${zsh_cv_have_nis='yes'}
: ${zsh_cv_have_superroot='no'}
: ${zsh_cv_include_defines_ospeed='no'}
: ${zsh_cv_must_define_ospeed='no'}
: ${zsh_cv_sigset_t='yes'}
: ${zsh_cv_sys_errlist='no'}
: ${zsh_cv_sys_posix_termios='yes'}
: ${zsh_cv_sys_tiocgwinsz_in_termios_h='yes'}

-- 
Franklin Chen                                              chen@adi.com
Applied Dynamics International
3800 Stone School Road
Ann Arbor, MI 48108-2499

