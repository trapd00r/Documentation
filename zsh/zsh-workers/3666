From zsh-workers-request@math.gatech.edu Sat Jan 03 02:05:47 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 13420 invoked from network); 3 Jan 1998 02:05:45 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 3 Jan 1998 02:05:45 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.8.5/8.8.5) id UAA29079;
	Fri, 2 Jan 1998 20:51:00 -0500 (EST)
Resent-Date: Fri, 2 Jan 1998 20:51:00 -0500 (EST)
Message-ID: <XFMail.980102205144.bitt@mci.net>
X-Mailer: XFMail 1.2-beta-120897 [p0] on Solaris
X-Priority: 3 (Normal)
MIME-Version: 1.0
Content-Type: multipart/signed;
 boundary="_=XFMail.1.2.p0.Solaris:980102205144:25707=_";
 micalg=pgp-md5; protocol="application/pgp-signature"
Date: Fri, 02 Jan 1998 20:51:44 -0500 (EST)
X-Face: /:$Tsf21f;`&aUq26|p4,8LRp]V8iHqv=~7Fi:O$pJl|;EB3[^n{cmI&X^bH(aVQm||vLW~
 b/i.*%Ed(8y%cg,4q[&mxj!wyO1:NumE_liFNaXYYzG
From: Bitt Faulk <bitt@mci.net>
To: zsh-workers@math.gatech.edu
Subject: ZSH/nxterm bug
Resent-Message-ID: <"MJ4en1.0.I67.4cPhq"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3666
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

This message is in MIME format
--_=XFMail.1.2.p0.Solaris:980102205144:25707=_
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

I have a bug with zsh under nxterm not setting $LINES.  nxterm is a patched
xterm upon which I will expand in a minute.

When resizing the nxterm, zsh 3.0.5 fails to set $LINES to the new size of =
the
window.  It does receive a SIGWINCH.  It also works properly when using the
standard distributed xterm.  bash and tcsh work properly under nxterm, at l=
east
as far as setting $LINES.  The bug is repeatable when started with -f.

This is under Solaris 2.5.1 using X11R6.3.

nxterm is one of the many color xterms that have been patched from the stan=
dard,
specifically one that is distributed with RedHat Linux.  I liked it, so I
compiled it from the source in xterm-color-1.1-6.src.rpm.  I applied all of=
 the
patches that come in the rpm to the source and it compiled without any chan=
ges.=20
I can supply the source in a more standard form if you need.

Here is a little system trace of zsh under each term:

Standard X11R6.3 xterm (works)
cobalt% truss -wall -p 5624
read(10, 0xEFFFF57F, 1)         (sleeping...)
    Received signal #20, SIGWINCH, in read() [caught]
read(10, 0xEFFFF57F, 1)                         Err#4 EINTR
sigprocmask(SIG_BLOCK, 0xEFFFF258, 0xEFFFF1B8)  =3D 0
sigprocmask(SIG_SETMASK, 0xEFFFF248, 0xEFFFF1B8) =3D 0
ioctl(10, TIOCGWINSZ, 0x00095464)               =3D 0
ioctl(10, TIOCGSID, 0xEFFFEF74)                 =3D 0
getsid(0)                                       =3D 5624
ioctl(10, TIOCSPGRP, 0xEFFFF020)                =3D 0
ioctl(10, TCSETSW, 0xEFFFF0A8)                  =3D 0
getuid()                                        =3D 710 [710]
write(10, 0x0008EDE8, 21)                       =3D 21
  \r1B [ m1B [ m1B [ m1B [ J c o b a l t % =20
setcontext(0xEFFFF358)
read(10, 0xEFFFF57F, 1)         (sleeping...)

nxterm (doesn't work)
cobalt% truss -wall -p 8037
read(10, 0xEFFFF547, 1)         (sleeping...)
    Received signal #20, SIGWINCH, in read() [caught]
read(10, 0xEFFFF547, 1)                         Err#4 EINTR
sigprocmask(SIG_BLOCK, 0xEFFFF220, 0xEFFFF180)  =3D 0
sigprocmask(SIG_SETMASK, 0xEFFFF210, 0xEFFFF180) =3D 0
ioctl(10, TIOCGWINSZ, 0x00095464)               =3D 0
setcontext(0xEFFFF320)
read(10, 0xEFFFF547, 1)         (sleeping...)

I hope that you haven't listed this somewhere already.  I'd hate to be a sp=
ammer.

I do not subscribe to this list, so I'd appreciate a direct reply if you ha=
ve
one.  Also, please reply directly if you need any more information.

Thanks for the shell.

-Bitt Faulk

--_=XFMail.1.2.p0.Solaris:980102205144:25707=_
Content-Type: application/pgp-signature

-----BEGIN PGP MESSAGE-----
Version: 2.6.2

iQCVAwUBNK2Zrw9hT8rrQn6FAQEgHgP+IjcrCfSg31VB0dZlevhSUrOYn22q97dw
NMF7mhkD6Yj5Rok6R0uWVt699nAN84ocb9brdxqoESUqjvEksKEm89XlNOGEqijP
WIZ0E1p8KBwphJFhkjQz95u/T9p8+yp0KAnftUhiMNS//R+biYxKXzeD7Y34JeOM
YmGc3AbDchE=
=Rd2Q
-----END PGP MESSAGE-----

--_=XFMail.1.2.p0.Solaris:980102205144:25707=_--
End of MIME message

