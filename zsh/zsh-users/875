From zsh-workers-request@euclid.skiles.gatech.edu Sun Jun 01 08:26:48 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 13541 invoked from network); 1 Jun 1997 08:26:47 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 1 Jun 1997 08:26:47 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id EAA10596; Sun, 1 Jun 1997 04:10:50 -0400 (EDT)
Resent-Date: Sun, 1 Jun 1997 04:10:16 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@ny.frontiercomm.net>
Message-Id: <199706010800.EAA10399@hzoli.home>
Subject: Re: VDISABLEVAL should be -1 for HP-UX?
In-Reply-To: <199705292323.AA078588228@hpbs2245.boi.hp.com> from "Rodger V. Anderson" at "May 29, 97 05:23:46 pm"
To: rodger@hpbs2245.boi.hp.com (Rodger V. Anderson)
Date: Sun, 1 Jun 1997 04:00:40 -0400 (EDT)
Cc: zsh-users@math.gatech.edu
X-Mailer: ELM [version 2.4ME+ PL31 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"oWWMT1.0.Za2.evIap"@euclid>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/875
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> Some time ago (a year and a half) I asked about a problem I was having
> with the "set-mark-command" being ignored when it was ^@ (ascii nul).
> I think I have figured out what the problem is.
> 
> The routine setterm() in zle_main.c uses VDISABLEVAL, as defined in
> system.h with a value of 0, to disable certain keys.  Unfortunately,
> HP-UX appears to treat a value of 0 as valid character, namely ^@
> (ascii nul), instead of as undefined.  I've recompiled zsh with
> VDISABLEVAL set to -1 and the set-mark-command now works.

This patch should fix the problem.

Zoltan


*** Src/system.h	1997/05/06 05:56:36	3.1.2.3
--- Src/system.h	1997/04/28 05:44:20
***************
*** 257,263 ****
  # else
  #  include <termios.h>
  # endif
! # define VDISABLEVAL 0
  # define HAS_TIO 1
  #else    /* not TERMIOS */
  # ifdef HAVE_TERMIO_H
--- 257,267 ----
  # else
  #  include <termios.h>
  # endif
! # ifdef _POSIX_VDISABLE
! #  define VDISABLEVAL _POSIX_VDISABLE
! # else
! #  define VDISABLEVAL 0
! # endif
  # define HAS_TIO 1
  #else    /* not TERMIOS */
  # ifdef HAVE_TERMIO_H

