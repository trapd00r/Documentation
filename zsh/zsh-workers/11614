From zsh-workers-return-11614-mason-zsh=primenet.com.au@sunsite.auc.dk Sun May 28 18:15:15 2000
Return-Path: <zsh-workers-return-11614-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3519 invoked from network); 28 May 2000 18:15:12 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 28 May 2000 18:15:12 -0000
Received: (qmail 27080 invoked by alias); 28 May 2000 18:14:57 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11614
Received: (qmail 27073 invoked from network); 28 May 2000 18:14:55 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000528181451.ZM28029@candle.brasslantern.com>
Date: Sun, 28 May 2000 18:14:51 +0000
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: _path_files and glob qualifiers
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

zagzig[20] zstyle -L | grep completer
zstyle ':completion:*' completer _oldlist _expand _complete _match _ignored _approximate _prefix

At first I thought the following was a problem with _expand:

zagzig[21] echo *zshenv(D)
.zshenv zshenv
zagzig[22] ls *zshenv(D)<TAB>
zagzig[23] ls zshenv
Completing corrections
zshenv 
Completing original
*zshenv(D) 

Comparing an example that does work against the above via ^X?, I find that
the real problem is that on line 305, _path_files tests [[ ! -o globdots ]]
and therefore fails to generate dot-files as possible matches, even though
the pattern includes the glob-dots qualifier.

A potential solution is to change [[ "$PREFIX" = .* ]] on lines 305 and 311
to [[ "$PREFIX" = (.*|*\([^^]#D*\)) ]] or something like that, but I'm not
entirely sure if that's correct (particularly when there is a suffix).  It
might instead be necessary to test earlier and setopt localoptions globdots
if the qualifier is spotted.

But then there's the problem of generalizing to other qualifiers ...

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

