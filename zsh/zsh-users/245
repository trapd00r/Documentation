From steve@miranova.com Tue Jun 11 03:54:36 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id DAA22032 for <mason@werple.mira.net.au>; Tue, 11 Jun 1996 03:54:33 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id NAA26323; Mon, 10 Jun 1996 13:41:23 -0400 (EDT)
Resent-Date: Mon, 10 Jun 1996 13:40:47 -0400 (EDT)
Sender: steve@miranova.com
To: zsh-users@math.gatech.edu
Subject: Re: zsh-2.6beta20 doesn't compile under Linux pre2.0.14
References: <199606101703.TAA05789@bolyai.cs.elte.hu>
X-Url: http://www.miranova.com/%7Esteve/
Mail-Copies-To: never
From: Steven L Baur <steve@miranova.com>
In-Reply-To: Zoltan Hidvegi's message of 10 Jun 1996 10:03:16 -0700
Mime-Version: 1.0 (generated by tm-edit 7.67)
Content-Type: text/plain; charset=US-ASCII
Date: 10 Jun 1996 10:39:38 -0700
Message-ID: <m2hgsjimn9.fsf@deanna.miranova.com>
Lines: 77
X-Mailer: Gnus v5.2.14/XEmacs 19.14
Resent-Message-ID: <"dpMS61.0.FQ6.Uu5ln"@euclid>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/245
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 3415
Status: O

>>>>> "Zoltan" == Zoltan Hidvegi <hzoli@cs.elte.hu> writes:

(Your patch produces a compilable zsh on Linux 2.0, thanks).

Zoltan> It is surprising that the there days before the final 2.0
Zoltan> release a new feature appeared.  Here is the patch.  I think
Zoltan> zsh will be the first shell which can set this new limit.
Zoltan> There is no patch to the manual simply because I do not know
Zoltan> what is this limit.  Also a new flag should be inveted to set
Zoltan> this limit with ulimit.

It's related to the problem found recently where ``grep x /dev/zero''
would crash the system.  I don't believe it does anything, at least I
haven't found any code via grep in the kernel source that does
anything with it.

Zoltan> Please tell me your suggestions.

Here's the only authoritative information about it I'm aware of:
X-From-Line: owner-linux-kernel-outgoing@vger.rutgers.edu  Fri Jun  7 17:17:37 1996
Return-Path: owner-linux-kernel-outgoing@vger.rutgers.edu
Received: from wolverine.hq.cic.net (work.nether.net [198.87.18.3]) by deanna.miranova.com (8.7.5/8.6.9) with ESMTP id RAA23647 for <steve@miranova.com>; Fri, 7 Jun 1996 17:17:36 -0700
Received: from vger.rutgers.edu (vger.rutgers.edu [128.6.190.2]) by wolverine.hq.cic.net (8.7.5/8.6.9+jared) with ESMTP id UAA12029; Fri, 7 Jun 1996 20:08:13 -0400
Received: by vger.rutgers.edu id <106459-20973>; Fri, 7 Jun 1996 07:46:19 -0500
Date: 	Fri, 7 Jun 1996 09:22:26 +0300 (EET DST)
From: Linus Torvalds <torvalds@cs.helsinki.fi>
To: Michael Meskes <meskes@informatik.rwth-aachen.de>
cc: Linux-Kernel Mailinglist <linux-kernel@vger.rutgers.edu>
Subject: Re: the mmap() problem, a'la "grep x /dev/zero"
In-Reply-To: <199606070607.IAA00447@circe.informatik.rwth-aachen.de>
Message-ID: <Pine.LNX.3.91.960607091748.10892A-100000@linux.cs.Helsinki.FI>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Sender: owner-linux-kernel@vger.rutgers.edu
Precedence: bulk
Lines: 33
Xref: deanna.miranova.com linux-kernel:1385



On Fri, 7 Jun 1996, Michael Meskes wrote:
> 
> circe:meskes 105) grep x /dev/zero
> grep: memory exhausted

Umm, this looks ok - that's what supposed to happen. Linux can't fix the 
fact that grep doesn't work well on /dev/null (or any file that is that 
huge), but at least the above isn't a crash..

> It allocated much more memory than it should. I had a limit of 4MB, but the
> size went up to 12MB (5MB resident).

Umm, _what_ size? If you set a RLIMIT_DATA (or whatever the name is), 
that will only make a difference for the process bss (*), and if grep 
uses mmap(), then we'd need to have a "virtual memory" limit. However, we 
don't have any such limit, although I added a RLIMIT_AS for 2.0 (but it's 
currently unchecked).

(*) that's the curent Linux interpretation, at least. Do other unixes 
consider mmap'ed data part of RLIMIT_DATA?

>	 			Also I was able to run the memtest
> program on 8MB despite datasize limited to 1MB. Hmm I have to check the
> sources to see what happened. And my program with a global definition of
> 'char a[128MB]' still dumpos core.

Well, dumping core is the corect thing to do - it failed to get the BSS 
at exec time, so when the program actually ran it was "kind of" unhappy..

		Linus


-- 
steve@miranova.com baur
Unsolicited commercial e-mail will be proofread for $250/hour.
Andrea Seastrand: For your vote on the Telecom bill, I will vote for anyone
except you in November.


