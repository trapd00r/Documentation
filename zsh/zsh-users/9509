From zsh-users-return-9509-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 18 15:34:58 2005
Return-Path: <zsh-users-return-9509-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8873 invoked from network); 18 Oct 2005 15:34:56 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 18 Oct 2005 15:34:56 -0000
Received: (qmail 55185 invoked from network); 18 Oct 2005 15:34:48 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 18 Oct 2005 15:34:48 -0000
Received: (qmail 15110 invoked by alias); 18 Oct 2005 15:34:41 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 9509
Received: (qmail 15101 invoked from network); 18 Oct 2005 15:34:41 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 18 Oct 2005 15:34:41 -0000
Received: (qmail 54236 invoked from network); 18 Oct 2005 15:34:41 -0000
Received: from vms046pub.verizon.net (206.46.252.46)
  by a.mx.sunsite.dk with SMTP; 18 Oct 2005 15:34:40 -0000
Received: from candle.brasslantern.com ([71.116.81.225])
 by vms046.mailsrvcs.net
 (Sun Java System Messaging Server 6.2 HotFix 0.04 (built Dec 24 2004))
 with ESMTPA id <0IOK0042SB87MYM0@vms046.mailsrvcs.net> for
 zsh-users@sunsite.dk; Tue, 18 Oct 2005 10:33:44 -0500 (CDT)
Received: from candle.brasslantern.com (IDENT:schaefer@localhost [127.0.0.1])
	by candle.brasslantern.com (8.12.11/8.12.11) with ESMTP id j9IFXgDc031656;
 Tue, 18 Oct 2005 08:33:42 -0700
Received: (from schaefer@localhost)	by candle.brasslantern.com
 (8.12.11/8.12.11/Submit) id j9IFXg5O031655; Tue, 18 Oct 2005 08:33:42 -0700
Date: Tue, 18 Oct 2005 15:33:41 +0000
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Looks like "zpty -r" is adding 0x0d characters...
In-reply-to: <20051018084545.GF620@DervishD>
To: DervishD <zsh@dervishd.net>
Cc: Zsh Users <zsh-users@sunsite.dk>
Message-id: <1051018153341.ZM31654@candle.brasslantern.com>
MIME-version: 1.0
X-Mailer: Z-Mail (5.0.0 30July97)
Content-type: text/plain; charset=us-ascii
References: <20051017211318.GA576@DervishD>
	<1051018022949.ZM30950@candle.brasslantern.com>	<20051018084545.GF620@DervishD>
Comments: In reply to DervishD <zsh@dervishd.net>        "Re: Looks like "zpty
 -r" is adding 0x0d characters..." (Oct 18, 10:45am)
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

On Oct 18, 10:45am, DervishD wrote:
}
} I assumed that, by default, things like "echo" or
} "oeche", "echok", etc. were controlled by the "-e" option to "zpty",

Nope, the zpty options only affect the file descriptors, not the tty
modes.

} and things like onlcr were deactivated (any translation, for that
} matter) since the pty is treated like a file more than like a tty.

But the whole point is that it's NOT treated like a file, especially
by the process running on the "slave" side.
 
} > If you don't want this to happen, the program that zpty runs on the
} > pseudo-terminal needs to do the equivalent of "stty -onlcr".
} 
}     That's a bit difficult, because the command I'm running doesn't
} deal with the tty in any way, it just prints output (but for some
} errors it goes interactive, that's why I need zpty in my wrapper).

Remember that the command passed to zpty is run as if with eval, and
zsh already has a mechanism for controlling the stty settings of an
individual command.

    zpty cdda2wav STTY=-onlcr cdda2wav -v toc,sectors -J -H

