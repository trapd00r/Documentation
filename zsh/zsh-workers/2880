From zsh-workers-request@euclid.skiles.gatech.edu Thu Feb 06 17:35:30 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 8988 invoked from network); 6 Feb 1997 17:35:28 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 6 Feb 1997 17:35:28 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id MAA15927; Thu, 6 Feb 1997 12:25:30 -0500 (EST)
Resent-Date: Thu, 6 Feb 1997 12:25:30 -0500 (EST)
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <970206093209.ZM22215@candle.brasslantern.com>
Date: Thu, 6 Feb 1997 09:32:08 -0800
Reply-To: schaefer@nbn.com
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: zsh-workers@math.gatech.edu
Subject: Bug with backgrounding shell functions
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"YW0LV.0.ou3.9GX-o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2880
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

zsh 3.0.3-test4

I have the following autoloaded shell function, named xosview:

#!/usr/local/bin/zsh -f
command xosview -net 0 $*

While the function was still undefined (not yet autoloaded), I ran it in
the background with `xosview &'.  No problem so far.

I then inadvertently brought it to the foreground (`fg' on the wrong job
number), so I stopped it with ctrl-Z and backgrounded it again with `bg'.

At this point, xosview continued running normally; but the copy of zsh
that had been forked to run the shell function went berserk, consuming
85.5% of my CPU (which, fortunately, I could see because xosview's CPU
meter suddenly pegged) until I found it with `top' and killed it.

Killing the zsh left xosview running as an orphaned job.  That may not be
a bug, but the CPU-hogging behavior certainly is.

-- 
Bart Schaefer                             Brass Lantern Enterprises
http://www.well.com/user/barts            http://www.nbn.com/people/lantern

