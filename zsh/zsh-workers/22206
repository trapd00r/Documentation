From zsh-workers-return-22206-mason-zsh=primenet.com.au@sunsite.dk Thu Feb 09 22:17:56 2006
Return-Path: <zsh-workers-return-22206-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25898 invoked from network); 9 Feb 2006 22:17:54 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.0 (2005-09-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.0
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 9 Feb 2006 22:17:54 -0000
Received: (qmail 68454 invoked from network); 9 Feb 2006 22:17:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 Feb 2006 22:17:49 -0000
Received: (qmail 28662 invoked by alias); 9 Feb 2006 22:17:45 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22206
Received: (qmail 28653 invoked from network); 9 Feb 2006 22:17:45 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 9 Feb 2006 22:17:45 -0000
Received: (qmail 68105 invoked from network); 9 Feb 2006 22:17:45 -0000
Received: from dsl3-63-249-88-2.cruzio.com (HELO dot.blorf.net) (63.249.88.2)
  by a.mx.sunsite.dk with SMTP; 9 Feb 2006 22:17:44 -0000
Received: by dot.blorf.net (Postfix, from userid 1000)
	id 44B17610D; Thu,  9 Feb 2006 14:17:43 -0800 (PST)
Date: Thu, 9 Feb 2006 14:17:43 -0800
From: Wayne Davison <wayned@users.sourceforge.net>
To: zsh-workers@sunsite.dk
Subject: Re: Bug in { completion's comma removal
Message-ID: <20060209221743.GD11858@dot.blorf.net>
References: <20060106180019.GB10111@dot.blorf.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20060106180019.GB10111@dot.blorf.net>
User-Agent: Mutt/1.5.11

On Fri, Jan 06, 2006 at 10:00:19AM -0800, Wayne Davison wrote:
> I haven't tried to trace this down yet

OK, I finally looked into this.  This turns out to be as simple as
iremovesuffix() using memchr() on a wide-character string instead of
wmemchr().  I created a ZS_memchr() define in zle.h and changed the
two places that called memchr() to use it, and all is now well.  This
also fixed the removal of other suffixes too, such as the removal of
an auto-added space when ';' is typed.

..wayne..

