From zsh-workers-request@euclid.skiles.gatech.edu  Wed Sep 11 00:30:48 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id AAA05628 for <mason@primenet.com.au>; Wed, 11 Sep 1996 00:30:46 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id JAA03952; Tue, 10 Sep 1996 09:59:06 -0400 (EDT)
Resent-Date: Tue, 10 Sep 1996 09:59:06 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199609101357.PAA05991@bolyai.cs.elte.hu>
Subject: Re: Various problems with 3.0.1-test1
To: pws@ifh.de (Peter Stephenson)
Date: Tue, 10 Sep 1996 15:57:34 +0200 (MET DST)
Cc: zsh-workers@math.gatech.edu
In-Reply-To: <199609101210.OAA23148@hydra.ifh.de> from Peter Stephenson at "Sep 10, 96 02:10:35 pm"
Organization: Dept. of Comp. Sci., Eotvos University, Budapest, Hungary
Phone: (36 1)2669833 ext: 2667, home phone: (36 1) 2752368
X-Mailer: ELM [version 2.4ME+ PL16 (25)]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"_-ICZ2.0.dz.fGNDo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2122
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

> 1) 
> 
> % ./zsh -fc 'shift 2; print $*' first second third fourth               
> second third fourth fourth

The fix is included below.  I broke it in 3.0.1-test.  It worked in 3.0.0
but in 3.0.0 shift array did not work when KSH_ARRAYS was set.

> 2) This is very puzzling.
> 
> % ./zsh -fc 'setopt extendedglob;  [[ PATH = [A-Z]# ]] || print Failed.'
> Failed.

This is know and probably not a bug.  extendedglob affects parsing and
parsing the -c argument is dode before anything is executed.  Similarily
aliases do not work here.

./zsh -o extendedglob -fc '[[ PATH = [A-Z]# ]] || print Failed.'

works.

> 3) This is minor but probably wrong:
> 
> % ./zsh -fc '1this_is_ignored=foo; print $1'
> foo
> 
> ksh prints:
> ksh: 1this_is_ignored=foo:  not found

It is probably trivial but I have no more time no (I would need some other
5 minutes for that).

Zoltan

*** Src/params.c	1996/09/07 15:19:40	2.37
--- Src/params.c	1996/09/10 13:49:02
***************
*** 964,972 ****
  {
      Value v;
  
!     if (!((v = getvalue(&s, 0)) && PM_TYPE(v->pm->flags) == PM_ARRAY))
! 	return NULL;
!     return v->pm->gets.afn(v->pm);
  }
  
  /**/
--- 964,973 ----
  {
      Value v;
  
!     if (!idigit(*s) && (v = getvalue(&s, 0)) &&
! 	PM_TYPE(v->pm->flags) == PM_ARRAY)
! 	return v->pm->gets.afn(v->pm);
!     return NULL;
  }
  
  /**/

