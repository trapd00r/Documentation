<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Git Magic - Chapitre&nbsp;4.&nbsp;La sorcellerie des branches</title>
  <link rel="stylesheet" href="default.css" type="text/css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
  <link rel="home" href="index.html" title="Git Magique">
  <link rel="up" href="index.html" title="Git Magique">
  <link rel="prev" href="ch03.html" title=
  "Chapitre&nbsp;3.&nbsp;Clonons gaiement">
  <link rel="next" href="ch05.html" title=
  "Chapitre&nbsp;5.&nbsp;Les leçons de l’histoire">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
    <div class="toc">
      <ul>
<li><b>Git Magic</b></li>
        <li>
          <span class="preface"><a href=
          "index.html">Préface</a></span>

          <ul>
            <li><span class="section"><a href=
            "index.html#_merci">Merci&nbsp;!</a></span></li>

            <li><span class="section"><a href=
            "index.html#_licence">Licence</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch01.html">1.
          Introduction</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch01.html#_le_travail_comme_un_jeu">Le travail comme
            un jeu</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_gestion_de_versions">Gestion de
            versions</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_gestion_distribu%C3%A9e">Gestion
            distribuée</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_une_superstition_idiote">Une superstition
            idiote</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_conflits_fusionnels">Conflits
            fusionnels</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch02.html">2. Astuces de
          base</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch02.html#_enregistrer_l_%C3%A9tat_courant">Enregistrer
            l'état courant</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_ajouter_supprimer_renommer">Ajouter,
            supprimer, renommer</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_annuler_reprendre_avanc%C3%A9">Annuler/Reprendre
            avancé</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_reprise_revert">Reprise
            (revert)</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_g%C3%A9n%C3%A9ration_du_journal_des_modifications_changelog">
            Génération du journal des modifications
            (changelog)</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_t%C3%A9l%C3%A9charger_des_fichiers">Télécharger
            des fichiers</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_le_dernier_cri">Le dernier
            cri</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_publication_instantan%C3%A9e">Publication
            instantanée</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_qu_8217_ai_je_fait">Qu’ai-je
            fait&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_exercice">Exercice</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch03.html">3. Clonons
          gaiement</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch03.html#_synchronisation_entre_machines">Synchronisation
            entre machines</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_gestion_classique_des_sources">Gestion
            classique des sources</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_d%C3%A9p%C3%B4ts_nus">Dépôts
            nus</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_envoi_vs_rapatriement_push_vs_pull">Envoi
            vs rapatriement (push vs pull)</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_forker_un_projet">Forker un
            projet</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_syst%C3%A8me_ultime_de_sauvegarde">Système
            ultime de sauvegarde</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_le_multi_t%C3%A2che_%C3%A0_la_vitesse_de_la_lumi%C3%A8re">
            Le multi-tâche à la vitesse de la
            lumière</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_gu%C3%A9rilla_de_la_gestion_de_versions">Guérilla
            de la gestion de versions</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_mercurial">Mercurial</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bazaar">Bazaar</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_pourquoi_j_8217_utilise_git">Pourquoi
            j’utilise Git</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch04.html">4. La
          sorcellerie des branches</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch04.html#_la_touche_du_chef">La touche du
            chef</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_travail_temporaire">Travail
            temporaire</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_corrections_rapides">Corrections
            rapides</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_fusionner">Fusionner</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_workflow_sans_interruption">Workflow sans
            interruption</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_r%C3%A9organiser_le_foutoir">Réorganiser le
            foutoir</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_gestion_des_branches">Gestion des
            branches</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_les_branches_temporaires">Les branches
            temporaires</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_travailler_comme_il_vous_chante">Travailler
            comme il vous chante</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch05.html">5. Les leçons
          de l’histoire</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch05.html#_je_me_corrige_8230">Je me
            corrige…</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_8230_et_bien_plus">… et bien
            plus</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_les_changements_locaux_en_dernier">Les
            changements locaux en dernier</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_r%C3%A9%C3%A9criture_de_l_8217_histoire">Réécriture
            de l’histoire</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_faire_l_8217_histoire">Faire
            l’histoire</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_qu_8217_est_ce_qui_a_tout_cass%C3%A9">Qu’est-ce
            qui a tout cassé&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_qui_a_tout_cass%C3%A9">Qui a tout
            cassé&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_exp%C3%A9rience_personnelle">Expérience
            personnelle</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch06.html">6. Git
          multijoueur</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch06.html#_qui_suis_je">Qui
            suis-je&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_via_ssh_et_http">Git via SSH et
            HTTP</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_via_n_8217_importe_quoi">Git via
            n’importe quoi</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_les_patches_la_monnaie_d_%C3%A9change_globale">
            Les patches&nbsp;: la monnaie d'échange
            globale</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_le_num%C3%A9ro_de_votre_correspondant_a_chang%C3%A9">
            Le numéro de votre correspondant a
            changé</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_les_branches_distantes">Les branches
            distantes</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_d%C3%A9p%C3%B4ts_distants_multiples">Dépôts
            distants multiples</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_mes_pr%C3%A9f%C3%A9rences">Mes
            préférences</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch07.html">7. La maîtrise
          de Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch07.html#_publication_de_sources">Publication de
            sources</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_g%C3%A9rer_le_changement">Gérer le
            changement</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_mon_commit_est_trop_gros">Mon commit est
            trop gros&nbsp;!</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_l_8217_index_l_8217_aire_d_8217_assemblage">
            L’index&nbsp;: l’aire d’assemblage</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_ne_perdez_pas_la_t%C3%AAte">Ne perdez pas
            la tête</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_chasseur_de_t%C3%AAte">Chasseur de
            tête</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_construire_au_dessus_de_git">Construire
            au-dessus de Git</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_audacieuses_acrobaties">Audacieuses
            acrobaties</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_se_pr%C3%A9munir_des_commits_erron%C3%A9s">Se
            prémunir des commits erronés</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch08.html">8. Les secrets
          révélés</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch08.html#_l_8217_invisibilit%C3%A9">L’invisibilité</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_l_8217_int%C3%A9grit%C3%A9">L’intégrité</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_l_8217_intelligence">L’intelligence</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_l_8217_indexation">L’indexation</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_origines_de_git">Les origines de
            Git</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_la_base_d_8217_objets">La base
            d’objets</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_blobs">Les blobs</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_arbres_literal_trees_literal">Les
            arbres (<code class=
            "literal">trees</code>)</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_commits">Les commits</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_indiscernable_de_la_magie">Indiscernable de
            la magie</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch09.html">9. Appendix A:
          Les lacunes de Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch09.html#_les_faiblesses_de_sha1">Les faiblesses de
            SHA1</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_microsoft_windows">Microsoft
            Windows</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_des_fichiers_sans_relation">Des fichiers
            sans relation</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_qui_modifie_quoi">Qui modifie
            quoi&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_l_8217_historique_d_8217_un_fichier">L’historique
            d’un fichier</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_le_clone_initial">Le clone
            initial</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_les_projets_versatiles">Les projets
            versatiles</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_compteur_global">Compteur
            global</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_les_dossiers_vides">Les dossiers
            vides</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_le_premier_commit">Le premier
            commit</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_bizarreries_de_l_8217_interface">Bizarreries
            de l’interface</a></span></li>
          </ul>
        </li>

        <li><span class="chapter"><a href="ch10.html">10. Appendix
        B: Traduire ce guide</a></span></li>
      </ul>
    </div>
<div class="content">
  <div class="chapter" title=
  "Chapitre&nbsp;4.&nbsp;La sorcellerie des branches">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title"><a name=
          "_la_sorcellerie_des_branches"></a>Chapitre&nbsp;4.&nbsp;La
          sorcellerie des branches</h2>
        </div>
      </div>
    </div>

    <p>Des branchements et des fusions quasi-instantanés sont les
    fonctionnalités les plus puissantes qui font de Git un vrai
    tueur.</p>

    <p><span class="strong"><strong>Problème</strong></span>&nbsp;:
    des facteurs externes amènent nécessairement à des changements
    de contexte. Un gros bug se manifeste sans avertissement dans
    la version déployée. La date limite pour une fonctionnalité
    particulière est avancée. Un développeur qui vous aidait pour
    une partie clé du projet n’est plus disponible. Bref, en tous
    cas, vous devez brusquement arrêter la tâche en cours pour vous
    focaliser sur une tâche tout autre.</p>

    <p>Interrompre votre réflexion peut être nuisible à votre
    productivité et le changement de contexte amène encore plus de
    perte. Avec un système de gestion de versions centralisé, il
    faudrait télécharger une nouvelle copie de travail depuis le
    serveur central. Un système de gestion de versions décentralisé
    est bien meilleur puisqu’il peut cloner localement la version
    voulue.</p>

    <p>Mais un clone implique encore la copie de tout le dossier de
    travail ainsi que de l’historique complet jusqu’au point voulu.
    Même si Git réduit ce coût grâce aux fichiers partagés et au
    liens matériels, les fichiers du projet doivent tout de même
    être entièrement recréés dans le nouveau dossier de
    travail.</p>

    <p><span class="strong"><strong>Solution</strong></span>&nbsp;:
    dans ce genre de situations, Git offre un outil bien meilleur
    puisque plus rapide et moins consommateur d’espace
    disque&nbsp;: les branches.</p>

    <p>Grâce à un mot magique, les fichiers de votre dossier se
    transforment d’une version à une autre. Cette transformation
    peut être bien plus qu’un simple voyage dans l’historique. Vos
    fichiers peuvent se transformer de la dernière version stable
    vers une version expérimentale, vers la version courante de
    développement, vers la version d’un collègue, etc.</p>

    <div class="section" title="La touche du chef">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="_la_touche_du_chef"></a>La
            touche du chef</h2>
          </div>
        </div>
      </div>

      <p>N’avez-vous jamais joué à l’un de ces jeux qui, à l’appui
      d’une touche particulière (la «touche du chef»), affiche
      instantanément une feuille de calcul&nbsp;? Ceci vous permet
      de cacher votre écran de jeu dès que le chef arrive.</p>

      <p>Dans un dossier vide&nbsp;:</p>
      <pre class="literallayout">
$ echo "Je suis plus intelligent que mon chef." &gt; myfile.txt
$ git init
$ git add .
$ git commit -m "Commit initial"
</pre>

      <p>Vous venez de créer un dépôt Git qui gère un fichier
      contenant un message. Maintenant tapez&nbsp;:</p>
      <pre class="literallayout">
$ git checkout -b chef  # rien ne semble avoir changé
$ echo "Mon chef est plus intelligent que moi." &gt; myfile.txt
$ git commit -a -m "Un autre commit"
</pre>

      <p>Tout se présente comme si vous aviez réécrit votre fichier
      et intégrer (commit) ce changement. Mais ce n’est qu’une
      illusion. Tapez&nbsp;:</p>
      <pre class="literallayout">
$ git checkout master  # bascule vers la version originale du fichier
</pre>

      <p>et ça y est&nbsp;! Le fichier texte est restauré. Et si le
      chef repasse pour regarder votre dossier, tapez&nbsp;:</p>
      <pre class="literallayout">
$ git checkout chef  # bascule vers la version visible par le chef
</pre>

      <p>Vous pouvez basculer entre ces deux versions autant de
      fois que voulu, et intégrer (commit) vos changements à
      chacune d’elles indépendamment.</p>
    </div>

    <div class="section" title="Travail temporaire">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_travail_temporaire"></a>Travail temporaire</h2>
          </div>
        </div>
      </div>

      <p><a name="branch" id="branch"></a> Supposons que vous
      travailliez sur une fonctionnalité et que, pour une raison
      quelconque, vous ayez besoin de revenir trois versions en
      arrière afin d’ajouter temporairement quelques instructions
      d’affichage pour voir comment quelque chose fonctionne.
      Faites&nbsp;:</p>
      <pre class="literallayout">
$ git commit -a
$ git checkout HEAD~3
</pre>

      <p>Maintenant vous pouvez ajouter votre code temporaire là où
      vous le souhaitez. Vous pouvez même intégrer (commit) vos
      changements. Lorsque vous avez terminé, tapez&nbsp;:</p>
      <pre class="literallayout">
$ git checkout master
</pre>

      <p>pour retourner à votre travail d’origine. Notez que tous
      les changement non intégrés sont définitivement perdus
      (NdT&nbsp;: les changements intégrés via commit sont
      conservés quelques jours et sont accessibles en connaissant
      leur empreinte SHA1).</p>

      <p>Que faire si vous voulez nommer ces changements
      temporaires&nbsp;? Rien de plus simple&nbsp;:</p>
      <pre class="literallayout">
$ git checkout -b temporaire
</pre>

      <p>et faites un commit avant de rebasculer vers la branche
      master. Lorsque vous souhaitez revenir à vos changements
      temporaires, tapez simplement&nbsp;:</p>
      <pre class="literallayout">
$ git checkout temporaire
</pre>

      <p>Nous aborderons la commande <span class=
      "emphasis"><em>checkout</em></span> plus en détail lorsque
      nous parlerons du chargement d’anciens états. Mais nous
      pouvons tout de même en dire quelques mots&nbsp;: les
      fichiers sont bien amenés dans l'état demandé mais en
      quittant la branche master. À ce moment, tout commit poussera
      nos fichiers sur une route différente, qui pourra être nommée
      plus tard.</p>

      <p>En d’autres termes, après un checkout vers un état ancien,
      Git nous place automatiquement dans une nouvelle branche
      anonyme qui pourra être nommée et enregistrée grâce à
      <span class="strong"><strong>git checkout
      -b</strong></span>.</p>
    </div>

    <div class="section" title="Corrections rapides">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_corrections_rapides"></a>Corrections rapides</h2>
          </div>
        </div>
      </div>

      <p>Vous travaillez sur une tâche particulière et on vous
      demande de tout laisser tomber pour corriger un nouveau bug
      découvert dans la version `1b6d…`&nbsp;:</p>
      <pre class="literallayout">
$ git commit -a
$ git checkout -b correction 1b6d
</pre>

      <p>Puis quand vous avez corrigé le bug, saisissez&nbsp;:</p>
      <pre class="literallayout">
$ git commit -a -m "Bug corrigé"
$ git checkout master
</pre>

      <p>pour vous ramener à votre tâche originale. Vous pouvez
      même fusionner (<span class="emphasis"><em>merge</em></span>)
      avec la correction de bug toute fraîche&nbsp;:</p>
      <pre class="literallayout">
$ git merge correction
</pre>
    </div>

    <div class="section" title="Fusionner">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_fusionner"></a>Fusionner</h2>
          </div>
        </div>
      </div>

      <p>Dans certains systèmes de gestion de versions, la création
      de branches est facile mais les fusionner est difficile. Avec
      Git, la fusion est si simple que vous n’y prêterez plus
      attention.</p>

      <p>En fait, nous avons déjà rencontré la fusion. La commande
      <span class="strong"><strong>pull</strong></span> ramène
      (<span class="emphasis"><em>fetch</em></span>) une série de
      versions puis les fusionne (<span class=
      "emphasis"><em>merge</em></span>) dans votre branche
      courante. Si vous n’avez effectué aucun changement local
      alors la fusion est un simple bon en avant (un <span class=
      "emphasis"><em>fast forward</em></span>), un cas dégénéré qui
      s’apparente au rapatriement de la dernière version dans un
      système de gestion de versions centralisé. Si vous avez
      effectué des changements locaux, Git les fusionnera
      automatiquement et préviendra s’il y a des conflits.</p>

      <p>Habituellement, une version à une seule <span class=
      "emphasis"><em>version parente</em></span>, qu’on appelle la
      version précédente. Une fusion de branches entre elles
      produit une version avec plusieurs parents. Ce qui pose la
      question suivante&nbsp;: à quelle version se réfère
      `HEAD~10`&nbsp;? Puisqu’une version peut avoir plusieurs
      parents, par quel parent remonterons-nous&nbsp;?</p>

      <p>Il s’avère que cette notation choisit toujours le premier
      parent. C’est souhaitable puisque la branche courante devient
      le premier parent lors d’une fusion. Nous nous intéressons
      plus fréquemment aux changements que nous avons faits dans la
      branche courante qu'à ceux fusionnés depuis d’autres
      branches.</p>

      <p>Vous pouvez choisir un parent spécifique grâce à l’accent
      circonflexe. Voici, par exemple, comment voir le log depuis
      le deuxième parent&nbsp;:</p>
      <pre class="literallayout">
$ git log HEAD^2
</pre>

      <p>Vous pouvez omettre le numéro pour le premier parent.
      Voici, par exemple, comment voir les différences avec le
      premier parent&nbsp;;</p>
      <pre class="literallayout">
$ git diff HEAD^
</pre>

      <p>Vous pouvez combiner cette notation avec les autres. Par
      exemple&nbsp;:</p>
      <pre class="literallayout">
$ git checkout 1b6d^^2~10 -b ancien
</pre>

      <p>démarre la nouvelle branche «ancien» dans l'état
      correspondant à 10 versions en arrière du deuxième parent du
      premier parent de la version 1b6d.</p>
    </div>

    <div class="section" title="Workflow sans interruption">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_workflow_sans_interruption"></a>Workflow sans
            interruption</h2>
          </div>
        </div>
      </div>

      <p>La plupart du temps dans un projet de réalisation
      matérielle, la seconde étape du plan ne peut commencer que
      lorsque la première étape est terminée. Une voiture en
      réparation reste bloquée au garage jusqu'à la livraison d’une
      pièce. Le montage d’un prototype est suspendu en attendant la
      fabrication d’une puce.</p>

      <p>Les projets logiciels peuvent être similaires. La deuxième
      partie d’une nouvelle fonctionnalité doit attendre que la
      première partie soit sortie et testée. Certains projets
      exigent une validation de votre code avant son acceptation,
      vous êtes donc obligé d’attendre que la première partie soit
      validée avant de commencer la seconde.</p>

      <p>Grâce aux branches et aux fusions faciles, vous pouvez
      contourner les règles et travailler sur la partie 2 avant que
      la partie 1 soit officiellement prête. Supposons que vous
      ayez terminé la version correspondant à la partie 1 et que
      vous l’ayez envoyée pour validation. Supposons aussi que vous
      soyez dans la branche <code class="literal">master</code>.
      Alors, branchez-vous&nbsp;:</p>
      <pre class="literallayout">
$ git checkout -b part2
</pre>

      <p>Ensuite, travaillez sur la partie 2 et intégrez (via
      <code class="literal">commit</code>) vos changements autant
      que nécessaire. L’erreur étant humaine, vous voudrez parfois
      revenir en arrière pour effectuer des corrections dans la
      partie 1. Évidemment, si vous êtes chanceux ou très bon, vous
      pouvez sauter ce passage.</p>
      <pre class="literallayout">
$ git checkout master  # Retour à la partie 1
$ correction_des_bugs
$ git commit -a        # Intégration de la correction
$ git checkout part2   # Retour à la partie 2
$ git merge master     # Fusion de la correction.
</pre>

      <p>Finalement, la partie 1 est validée.</p>
      <pre class="literallayout">
$ git checkout master    # Retour à la partie 1
$ diffusion des fichiers # Diffusion au reste du monde !
$ git merge part2        # Fusion de la partie 2
$ git branch -d part2    # Suppression de la branche 'part2'.
</pre>

      <p>À cet instant vous êtes à nouveau dans la branche
      <code class="literal">master</code> avec la partie 2 dans
      votre dossier de travail.</p>

      <p>Il est facile d'étendre cette astuce à de nombreuses
      branches. Il est aussi facile de créer une branche
      rétroactivement&nbsp;: imaginons qu’après 7 commits, vous
      vous rendiez compte que vous auriez dû créer une branche.
      Tapez alors&nbsp;:</p>
      <pre class="literallayout">
$ git branch -m master part2  # Renommer la branche "master" en "part2".
$ git branch master HEAD~7    # Recréer une branche "master" 7 commits en arrière.
</pre>

      <p>La branche <code class="literal">master</code> contient
      alors uniquement la partie 1 et la branche <code class=
      "literal">part2</code> contient le reste&nbsp;; nous avons
      créé <code class="literal">master</code> sans basculer vers
      elle car nous souhaitons continuer à travailler sur
      <code class="literal">part2</code>. Ce n’est pas très
      courant. Jusqu'à présent nous avions toujours basculé vers
      une branche dès sa création, comme dans&nbsp;:</p>
      <pre class="literallayout">
$ git checkout HEAD~7 -b master  # Créer une branche et basculer vers elle.
</pre>
    </div>

    <div class="section" title="Réorganiser le foutoir">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_r%C3%A9organiser_le_foutoir"></a>Réorganiser le
            foutoir</h2>
          </div>
        </div>
      </div>

      <p>Peut-être aimez-vous travailler sur tous les aspects d’un
      projet dans la même branche. Vous souhaitez que votre travail
      en cours ne soit accessible qu'à vous-même et donc que les
      autres ne puissent voir vos versions que lorsqu’elles sont
      proprement organisées. Commencez par créer deux
      branches&nbsp;:</p>
      <pre class="literallayout">
$ git branch propre       # Créer une branche pour les versions propres
$ git checkout -b foutoir # Créer et basculer vers une branche pour le foutoir
</pre>

      <p>Ensuite, faites tout ce que vous voulez&nbsp;: corriger
      des bugs, ajouter des fonctionnalités, ajouter du code
      temporaire et faites-en des versions autant que voulu.
      Puis&nbsp;:</p>
      <pre class="literallayout">
$ git checkout propre
$ git cherry-pick foutoir^^
</pre>

      <p>applique les modifications de la version grand-mère de la
      version courante du «foutoir» à la branche «propre». Avec les
      cherry-picks appropriés vous pouvez construire une branche
      qui ne contient que le code permanent et où toutes les
      modifications qui marchent ensemble sont regroupées.</p>
    </div>

    <div class="section" title="Gestion des branches">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_gestion_des_branches"></a>Gestion des branches</h2>
          </div>
        </div>
      </div>

      <p>Pour lister toutes les branches, tapez&nbsp;:</p>
      <pre class="literallayout">
$ git branch
</pre>

      <p>Par défaut, vous commencez sur la branche nommée «master».
      Certains préconisent de laisser la branche «master» telle
      quelle et de créer de nouvelles branches pour vos propres
      modifications.</p>

      <p>Les options <span class=
      "strong"><strong>-d</strong></span> et <span class=
      "strong"><strong>-m</strong></span> vous permettent de
      supprimer et renommer les branches. Voir <span class=
      "strong"><strong>git help branch</strong></span>.</p>

      <p>La branche «master» est une convention utile. Les autres
      supposent que votre dépôt possède une telle branche et
      qu’elle contient la version officielle de votre projet. Bien
      qu’il soit possible de renommer ou d’effacer cette branche
      «master», il peut-être utile de respecter les traditions.</p>
    </div>

    <div class="section" title="Les branches temporaires">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_les_branches_temporaires"></a>Les branches
            temporaires</h2>
          </div>
        </div>
      </div>

      <p>Après un certain temps d’utilisation, vous vous apercevrez
      que vous créez fréquemment des branches éphémères toujours
      pour les mêmes raisons&nbsp;: elles vous servent juste à
      sauvegarder l'état courant, vous permettant ainsi de revenir
      momentanément à état précédent pour corriger un bug.</p>

      <p>C’est exactement comme si vous zappiez entre deux chaînes
      de télévision. Mais au lieu de presser deux boutons, il vous
      faut créer, basculer, fusionner et supprimer des branches
      temporaires. Par chance, Git propose un raccourci qui est
      aussi pratique que la télécommande de votre
      télévision&nbsp;:</p>
      <pre class="literallayout">
$ git stash
</pre>

      <p>Cela mémorise l'état courant dans un emplacement
      temporaire (un <span class="emphasis"><em>stash</em></span>)
      et restaure l'état précédent. Votre dossier courant apparaît
      alors exactement comme il était avant que vous ne commenciez
      à faire des modifications et vous pouvez corriger des bugs,
      aller rechercher (pull) une modification de dépôt central ou
      toute autre chose. Lorsque vous souhaitez revenir à l'état
      mémorisé dans votre <span class=
      "emphasis"><em>stash</em></span>, tapez&nbsp;:</p>
      <pre class="literallayout">
$ git stash apply  # Peut-être faudra-t-il résoudre quelques conflits.
</pre>

      <p>Vous pouvez avoir plusieurs <span class=
      "emphasis"><em>stash</em></span> et les manipuler de
      différents manières. Voir <span class="strong"><strong>git
      help stash</strong></span>. Comme vous l’aurez deviné, pour
      faire ces tours de magie, dans les coulisses Git gère des
      branches.</p>
    </div>

    <div class="section" title="Travailler comme il vous chante">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_travailler_comme_il_vous_chante"></a>Travailler comme
            il vous chante</h2>
          </div>
        </div>
      </div>

      <p>Vous vous demandez sans doute si l’usage des branches en
      vaut la peine. Après tout, des clones sont tout aussi rapides
      et vous pouvez basculer de l’un à l’autre par un simple
      <span class="strong"><strong>cd</strong></span> au lieu de
      commandes Git ésotériques.</p>

      <p>Considérez les navigateurs Web. Pourquoi proposer
      plusieurs onglets ainsi que plusieurs fenêtres&nbsp;? Parce
      proposer les deux permet de s’adapter à une large gamme
      d’utilisations. Certains préfèrent n’avoir qu’une seule
      fenêtre avec plein d’onglets. D’autres font tout le
      contraire&nbsp;: plein de fenêtres avec un seul onglet.
      D’autres encore mélangent un peu des deux.</p>

      <p>Les branches ressemblent à des onglets de votre dossier de
      travail et les clones ressemblent aux différents fenêtres de
      votre navigateur. Ces opérations sont toutes rapides et
      locales. Alors expérimentez pour trouver la combinaison qui
      vous convient. Git vous laisse travailler exactement comme
      vous le souhaitez.</p>
    </div>
  </div><script type="text/javascript" src="find_selflink.js">
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1901330-2");
  pageTracker._initData();
  pageTracker._trackPageview();
  </script>
</div>
</div><div class="footer"><a href="/~blynn/">Ben Lynn</a></div>
</body>
</html>
