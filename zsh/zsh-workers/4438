From zsh-workers-request@math.gatech.edu Thu Oct 22 10:05:29 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1550 invoked from network); 22 Oct 1998 10:05:28 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 22 Oct 1998 10:05:28 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id FAA21357;
	Thu, 22 Oct 1998 05:51:09 -0400 (EDT)
Resent-Date: Thu, 22 Oct 1998 05:51:09 -0400 (EDT)
Message-Id: <9810220941.AA31273@ibmth.df.unipi.it>
To: zsh-workers@math.gatech.edu (Zsh hackers list)
Subject: Re: PATCH: Re: Backticks In zshenv 
In-Reply-To: ""Bart Schaefer""'s message of "Tue, 20 Oct 1998 12:54:49 DFT."
             <981020125449.ZM6543@candle.brasslantern.com> 
Date: Thu, 22 Oct 1998 11:41:04 +0200
From: Peter Stephenson <pws@ibmth.df.unipi.it>
Resent-Message-ID: <"sE1ow3.0.bD5.D0mBs"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4438
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

"Bart Schaefer" wrote:
> I'm now 99% certain that the SIGWINCH is causing read() to fail with EINTR
> during the fgetc() in readoutput() in exec.c.
> 
> I'm unable to adequately test the following patch at the moment, as it's
> inconvenient to muck with the shells on the RH5.1 machine, but it doesn't
> break anything obvious on my RH4.2 machine at home.  If anyone has time to
> try this out, please tell the list whether it works.

I wasn't seeing the problems reported, but the patch works in the
following sense:  I have a test script

foo=$(sleep 10; id -u)
print "foo=$foo"

which I ran with a background zsh.  I sent that a SIGWINCH while the
$(...) was sleeping, and without the patch the final message was

foo=

while with it I got

foo=295

which is correct.  This appears to be repeatable.

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarotti 2, 56100 Pisa, Italy

