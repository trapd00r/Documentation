From zsh-workers-return-15925-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 02 14:52:27 2001
Return-Path: <zsh-workers-return-15925-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15862 invoked from network); 2 Oct 2001 14:52:26 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 2 Oct 2001 14:52:26 -0000
Received: (qmail 12470 invoked by alias); 2 Oct 2001 14:52:20 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 15925
Received: (qmail 12453 invoked from network); 2 Oct 2001 14:52:18 -0000
From: Bart Schaefer <schaefer@brasslantern.com>
Message-Id: <1011002145208.ZM24576@candle.brasslantern.com>
Date: Tue, 2 Oct 2001 14:52:08 +0000
In-Reply-To: <22658.1002022881@csr.com>
Comments: In reply to Peter Stephenson <pws@csr.com>
        "expand style `suffix' option" (Oct  2, 12:41pm)
References: <22658.1002022881@csr.com>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: expand style `suffix' option
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Oct 2, 12:41pm, Peter Stephenson wrote:
}
}   zstyle ':completion:*' expand prefix suffix
} 
} When it does seem to be on, I would expect
}   ~/b/b<TAB>
} to list or cycle through all files ~/b*/b* when menu completion is in use,
} but it doesn't.  Is this assumption wrong?

I get the exact same behavior out of that no matter what `expand' is set
to.  E.g. I happen to have two files

	~/netmanage/record
	~/newmail/record

but no matter what the setting of the expand style, I always get:

schaefer<512> ls ~/n/r<TAB>
schaefer<512> ls ~/ne/r

(with cursor on the second `/').  Using menucomplete instead of automenu,
I get the menu:

schaefer<514> ls ~/n/r<TAB>
schaefer<515> ls ~/netmanage/r
Completing files
netmanage/  newmail/  

but once again the `expand' style has no effect on this.

It looks like _path_files applies the `expand prefix' style only if the
number of matches generated is the same as the number that existed at
the time _path_files was called (line 655, nm -eq compstate[nmatches]).
But that never seems to be true.

Also, _path_files only checks that `expand suffix' is NOT set, and then
as part of a larger test to decide whether to clear compstate[to_end]
(lines 508-515), and I can't figure out what circumstances cause all the
other ||'d conditions to be false so that `expand suffix' will matter.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

