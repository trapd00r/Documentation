From zsh-users-return-11161-mason-zsh=primenet.com.au@sunsite.dk Wed Jan 31 04:03:51 2007
Return-Path: <zsh-users-return-11161-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29136 invoked from network); 31 Jan 2007 04:03:43 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO 
	autolearn=ham version=3.1.7
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 31 Jan 2007 04:03:43 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 22417 invoked from network); 31 Jan 2007 04:03:33 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 31 Jan 2007 04:03:33 -0000
Received: (qmail 26251 invoked by alias); 31 Jan 2007 04:03:25 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11161
Received: (qmail 26242 invoked from network); 31 Jan 2007 04:03:24 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 31 Jan 2007 04:03:24 -0000
Received: (qmail 21276 invoked from network); 31 Jan 2007 04:03:24 -0000
Received: from vms044pub.verizon.net (206.46.252.44)
  by a.mx.sunsite.dk with SMTP; 31 Jan 2007 04:03:17 -0000
Received: from torch.brasslantern.com ([71.116.79.148])
 by vms044.mailsrvcs.net (Sun Java System Messaging Server 6.2-6.01 (built Apr
 3 2006)) with ESMTPA id <0JCP0053CSL7S2J1@vms044.mailsrvcs.net> for
 zsh-users@sunsite.dk; Tue, 30 Jan 2007 22:03:08 -0600 (CST)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id l0V436HD014404	for
 <zsh-users@sunsite.dk>; Tue, 30 Jan 2007 20:03:07 -0800
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id l0V4359Z014403	for zsh-users@sunsite.dk; Tue,
 30 Jan 2007 20:03:05 -0800
Date: Tue, 30 Jan 2007 20:03:05 -0800
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: zsh handling of non-standard if-evaluations
In-reply-to: <163305.96211.qm@web36812.mail.mud.yahoo.com>
In-reply-to: <20070130211418.67359.qmail@web36807.mail.mud.yahoo.com>
To: zsh-users@sunsite.dk
Message-id: <070130200305.ZM14402@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <163305.96211.qm@web36812.mail.mud.yahoo.com>
	<20070130211418.67359.qmail@web36807.mail.mud.yahoo.com>
Comments: In reply to Daniel Qarras <dqarras@yahoo.com>
 "Re: zsh handling of non-standard if-evaluations" (Jan 30, 10:30am)
Comments: In reply to Daniel Qarras <dqarras@yahoo.com>
 "Re: zsh handling of non-standard if-evaluations" (Jan 30,  1:14pm)

On Jan 30, 10:30am, Daniel Qarras wrote:
}
} I am testing this under RHEL4 / FC6, both have zsh RPMs that comes with
} /etc/zprofile

Yes, I've been annoyed with RedHat's zsh packaging for years now.  At
least it's gotten slightly better; if you saw what they had back in
RH5 and RH6 you'd be using stronger expletives than "uh, oh."

} For example, admin sets locales in /etc/profile but I want use locale
} settings I set up in my init files in any case. .zshenv would be
} logical, I guess, but it's too early as /etc/profile gets sources
} later.

The thing to do is put

	setopt no_global_rcs

in your ~/.zshenv.  That will disable reading of all the /etc/z* files
except /etc/zshenv.  Then you can put the settings you want wherever
it is you want them, including the "emulate sh" snippet around loading
the /etc/profile.

} .zprofile won't work because it's not sources when starting an
} xterm. And .zshrc is no good because it's not sourced when session is
} not interactive!

But /etc/profile isn't read by non-login shells either, so anything
that works from there should work from ~/.zprofile, once you get
around the problem of having to override something that was set
incorrectly by the /etc/z* files.

On Jan 30,  1:14pm, Daniel Qarras wrote:
} Subject: Re: zsh handling of non-standard if-evaluations
}
} Oh, crap.. It turned out that Red Hat defaults source /etc/profile et
} al both from /etc/zprofile and /etc/zshrc! I'll be complaining to them
} at the above mentioned bug :(

The skel ~/.bashrc sources /etc/bashrc which does the /etc/profile.d
dance as well, so they're just trying to cover all of their bases.

