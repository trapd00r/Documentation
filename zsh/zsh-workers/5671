From zsh-workers-return-5671-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Mar 08 08:51:51 1999
Return-Path: <zsh-workers-return-5671-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25416 invoked from network); 8 Mar 1999 08:51:49 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Mar 1999 08:51:49 -0000
Received: (qmail 21916 invoked by alias); 8 Mar 1999 08:51:26 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5671
Received: (qmail 21904 invoked from network); 8 Mar 1999 08:51:25 -0000
Date: Mon, 8 Mar 1999 09:50:42 +0100 (MET)
Message-Id: <199903080850.JAA11456@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: small parameter fix


...although I'm not sure if it was not intentional. If it was, I'd
like to hear the reason. This:

  ${${...}[...]}

previously didn't really work: if the inner ${...} produced an array
with only one element, the outer ${...} treated it as a string and the 
subscript gave the n'th character.


Bye
 Sven

--- os/subst.c	Fri Mar  5 20:10:39 1999
+++ Src/subst.c	Sat Mar  6 13:28:41 1999
@@ -263,7 +263,7 @@
 	    *isarr = 0;
 	return 0;
     }
-    if ((l = countlinknodes(foo)) > 1) {
+    if ((l = countlinknodes(foo)) > 1 || a) {
 	p = r = ncalloc((l + 1) * sizeof(char*));
 	while (nonempty(foo))
 	    *p++ = (char *)ugetnode(foo);

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

