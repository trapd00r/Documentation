From zsh-workers-return-7671-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Sep 06 18:11:33 1999
Return-Path: <zsh-workers-return-7671-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2240 invoked from network); 6 Sep 1999 18:11:32 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Sep 1999 18:11:32 -0000
Received: (qmail 6336 invoked by alias); 6 Sep 1999 18:11:24 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7671
Received: (qmail 6329 invoked from network); 6 Sep 1999 18:11:23 -0000
Date: Mon, 6 Sep 1999 19:11:23 +0100
From: Adam Spiers <adam@thelonious.new.ox.ac.uk>
To: zsh-workers@sunsite.auc.dk
Subject: _rpm fixes
Message-ID: <19990906191123.A1322@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh-workers@sunsite.auc.dk
References: <199909061150.NAA02176@beta.informatik.hu-berlin.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.4i
In-Reply-To: <199909061150.NAA02176@beta.informatik.hu-berlin.de>; from Sven Wischnowsky on Mon, Sep 06, 1999 at 01:50:39PM +0200

Sven Wischnowsky (wischnow@informatik.hu-berlin.de) wrote:
> 
> Peter Stephenson wrote:
> 
> > There were some minor typo fixes in the completion functions which I didn't
> > post.

Did you get this one?  I also fixed -b to complete .spec files.  It 
was completing installed rpms before for some reason.

diff -urN -x *~ zsh-3.1.6-4/Completion/Linux/_rpm zsh-3.1.6-adam/Completion/Linux/_rpm
--- zsh-3.1.6-4/Completion/Linux/_rpm	Mon Sep  6 13:15:25 1999
+++ zsh-3.1.6-adam/Completion/Linux/_rpm	Mon Sep  6 18:28:24 1999
@@ -44,7 +44,7 @@
 # Used by `_arguments', made local here.
 
 local state lstate line
-tyeset -A options
+typeset -A options
 
 state=''
 
@@ -139,7 +139,7 @@
       '*:RPM package:->package' && ret=0
     ;;
   build_b)
-    tmp=( '*:RPM package:->package' )
+    tmp=( '*:spec file:_files -g \*.spec' )
     ;&
   build_t)
     (( $#tmp )) || tmp=( '*:tar file:_files -g \*.\(\#i\)tar\(.\*\|\)' )

