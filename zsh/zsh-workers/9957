From zsh-workers-return-9957-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Mar 01 15:37:29 2000
Return-Path: <zsh-workers-return-9957-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5211 invoked from network); 1 Mar 2000 15:37:29 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Mar 2000 15:37:29 -0000
Received: (qmail 28984 invoked by alias); 1 Mar 2000 15:37:19 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9957
Received: (qmail 28976 invoked from network); 1 Mar 2000 15:37:19 -0000
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: completion tests
References: <200003011528.QAA28206@beta.informatik.hu-berlin.de>
MIME-Version: 1.0 (generated by AKEMI 1.13.2 - =?ISO-2022-JP?B?Ig==?=
 =?ISO-2022-JP?B?GyRCQTA0Y0s8GyhCIg==?=)
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 02 Mar 2000 00:37:07 +0900
In-Reply-To: Sven Wischnowsky's message of "Wed, 1 Mar 2000 16:28:41 +0100 (MET)"
Message-ID: <rsqd7pe66sc.fsf@crane.jaist.ac.jp>
Lines: 52
User-Agent: Chao-gnus/6.12.5 AKEMI/1.13.2 (=?ISO-2022-JP?B?GyRCQTAbKEI=?=
 =?ISO-2022-JP?B?GyRCNGNLPBsoQg==?=) FLAM-DOODLE/1.12.6
 (=?ISO-2022-JP?B?GyRCM3cbKEI=?= 10R4.0/5.0) Emacs/20.4
 (sparc-sun-solaris2.6) MULE/4.0 (HANANOEN)

In article <200003011528.QAA28206@beta.informatik.hu-berlin.de>,
  Sven Wischnowsky <wischnow@informatik.hu-berlin.de> writes:

> Ah, I forgot to say: this is intentional. It comes from the printfmt() 
> functions to ensure that printing a completion list over a completion
> list doesn't flicker. No way around that.

Ok.  I modified comptest to remove it.

Index: Test/.distfiles
===================================================================
RCS file: /projects/zsh/zsh/Test/.distfiles,v
retrieving revision 1.1.1.7
diff -u -r1.1.1.7 .distfiles
--- Test/.distfiles	2000/02/20 01:27:22	1.1.1.7
+++ Test/.distfiles	2000/03/01 15:34:31
@@ -1,7 +1,7 @@
 DISTFILES_SRC='
     .cvsignore .distfiles Makefile.in
-    ztst.zsh
+    ztst.zsh comptest
     01grammar.ztst 02alias.ztst 03quoting.ztst 04redirect.ztst
     05command.ztst 06arith.ztst 07cond.ztst 08traps.ztst 09funcdef.ztst
-    10prompt.ztst 50cd.ztst 51xtrace.ztst
+    10prompt.ztst 50cd.ztst 51xtrace.ztst 52zregexparse.ztst 53completion.ztst
 '
Index: Test/comptest
===================================================================
RCS file: /projects/zsh/zsh/Test/comptest,v
retrieving revision 1.1.1.2
diff -u -r1.1.1.2 comptest
--- Test/comptest	2000/03/01 13:14:50	1.1.1.2
+++ Test/comptest	2000/03/01 15:34:31
@@ -7,6 +7,7 @@
 dump=(-D)
 code=
 zsh=${ZSH:-zsh}
+termcap_ce="$(echotc ce)"
 
 while getopts Dd:c:z: opt; do
   case $opt in
@@ -91,7 +92,7 @@
     log="${log[$mend[1]+1,-1]}"
     if (( 0 <= $mbegin[2] )); then
       if [[ $match[2] != TC && $match[3] != \ # ]]; then
-	print -lr "$match[2]:{$match[3]}"
+	print -lr "$match[2]:{${match[3]%$termcap_ce}}"
       fi
     elif (( 0 <= $mbegin[4] )); then
       print -lr "DESCRIPTION:{$match[4]}"
-- 
Tanaka Akira

