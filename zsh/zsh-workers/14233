From zsh-workers-return-14233-mason-zsh=primenet.com.au@sunsite.dk Sun May 06 15:01:18 2001
Return-Path: <zsh-workers-return-14233-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8334 invoked from network); 6 May 2001 15:01:15 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 May 2001 15:01:15 -0000
Received: (qmail 16404 invoked by alias); 6 May 2001 15:01:08 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14233
Received: (qmail 16387 invoked from network); 6 May 2001 15:01:07 -0000
Date: Sun, 6 May 2001 16:51:06 +0200
From: Andreas Ferber <aferber@techfak.uni-bielefeld.de>
To: zsh-workers@sunsite.auc.dk
Subject: Lockup on tab completion with compinit+list_packed
Message-ID: <20010506165106.A4154@kallisto.sind-doof.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
X-Operating-System: Debian GNU/Linux (Linux 2.4.4-int1-vlan101-nf20010504 i686)
X-Disclaimer: Are you really taking me serious?
Sender: Andreas Ferber <aferber@techfak.uni-bielefeld.de>

Hi,

Recently zsh totally locked up using 100% CPU on doing a tab
completion.

I can reproduce this actually with (running zsh -f):

kallisto% echo $ZSH_VERSION
3.1.9-dev-8
kallisto% ls
alsa-modules-2.4.4-int1-vlan101-nf20010428_0.5.10b-4+p3+1.kallisto.0_i386.deb
alsa-modules-2.4.4-int1-vlan101-nf20010428_0.5.10b-4+p3+2.kallisto.0_i386.deb
alsa-modules-2.4.4-int1-vlan101-nf20010504_0.5.10b-4+p3+1.kallisto.0_i386.deb
kallisto% autoload compinit
kallisto% compinit
kallisto% setopt list_packed 
kallisto% ls <----- here it locks up on pressing TAB once, after the space

If I leave out "setopt list_packed", completion works fine, as does
without the "compinit". Only the combination of the two (in any order)
leads to lockup.

The odd is, with another set of files, with very similar names, it
works perfectly well. For example:

kallisto% ls alsa-modules-2.4.3-ac
             ^<TAB>

On first tab, it completes up to the "-ac". If I then continue to type
in the name and eventually try completing again, everything is fine
for the files

alsa-modules-2.4.3-ac1_0.5.10b-4+p3+kallisto.1.0_i386.deb
alsa-modules-2.4.3-ac14-int1-vlan101-nf20010426-swapb3_0.5.10b-4+p3+1.kallisto.0_i386.deb
alsa-modules-2.4.3-ac1-dc_0.5.10b-4+p3+kallisto.1.0_i386.deb

but it locks up again for

alsa-modules-2.4.3-ac4-int1-nf20010411-dc1_0.5.10b-4+p3+kallisto.1.0_i386.deb
alsa-modules-2.4.3-ac4-int1-nf20010411-dc1_0.5.10b-4+p3+kallisto.1.1_i386.deb
alsa-modules-2.4.3-ac5-int1-nf20010413-dc1_0.5.10b-4+p3+kallisto.1.0_i386.deb

(regardless of how much of the filename I actually typed in)

If I press <TAB> twice after getting to the "-ac", all 6 files show up
fine in the listing.

If I [sl]trace the locked process, no activity shows up, so the
process seems to be doing some internal calculations in an endless
loop. Due to time constraints, I could not look any closer on the
problem.

Please contact me if you need any further information or if I should
do any further investigation.

Andreas

PS: Please Cc me on replies as I don't read the mailinglist.
-- 
<SomeLamer> what's the difference between chattr and chmod?
<SomeGuru> SomeLamer: man chattr > 1; man chmod > 2; diff -u 1 2 | less
	-- Seen on #linux on irc

