From zsh-workers-return-13332-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jan 08 16:50:22 2001
Return-Path: <zsh-workers-return-13332-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11263 invoked from network); 8 Jan 2001 16:50:21 -0000
Received: from sunsite.dk (HELO sunsite.auc.dk) (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Jan 2001 16:50:21 -0000
Received: (qmail 15016 invoked by alias); 8 Jan 2001 16:50:13 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13332
Received: (qmail 15009 invoked from network); 8 Jan 2001 16:50:12 -0000
Message-ID: <Tc0a8890c50fbbc1f27@mailsweeper01.cambridgesiliconradio.com>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: PATCH: completion listing (was: zsh hangup with listpacked and Problem with zle completion listing function) 
In-Reply-To: Your message of "Mon, 08 Jan 2001 16:22:52 +0100."
             <200101081522.QAA10124@beta.informatik.hu-berlin.de> 
Date: Mon, 08 Jan 2001 16:49:44 +0000
From: Peter Stephenson <pws@csr.com>

Sven wrote:
> Peter Stephenson wrote:
> > I have the following function set up as an ordinary zle widget, with zle
> > -N, and bound to ^D.  It's supposed to make sure that when I type ^D I
> > always get a freshly calculated list, so that I can list the contents of a
> > directory which appears with menu completion --- otherwise it will just
> > redraw the current menu list.  (Of course, what I *really* want is
> > something smarter: if a list is already displayed, assume I want it updated
> > based on what's currently on the command line, but I couldn't work out how
> > to do that.)
> 
> Hm. I don't exactly understand how this would differ from your
> version...?

If a list wasn't displayed, it should do what it currently does, displaying
the relevant list for the active completion.  It's extremely minor --- I
have autolist on, so I get the list willy-nilly.
 
> I can't reproduce this. I tried it with and without autolist and with
> and without _oldlist in the completer list. Even if the patch below
> fixes the main problem I'd like to be able to track this down.

It does fix the problem, thanks.  _oldlist was the reason I needed to hit
^D twice.  Setting the old-list style should fix this, although I haven't
worked out if that's going to make me cross somewhere else.  So at the
moment everything is now working.
 
The completers I had, by the way, were

zstyle ':completion:*' completer _oldlist _expand _complete _approximate

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

