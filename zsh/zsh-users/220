From venus!juno!harman@hclhprnd.hclt.com Thu May 23 15:57:53 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id PAA20435 for <mason@werple.mira.net.au>; Thu, 23 May 1996 15:57:50 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id BAA04314; Thu, 23 May 1996 01:40:38 -0400 (EDT)
Resent-Date: Thu, 23 May 1996 01:38:42 -0400 (EDT)
Date: Thu, 23 May 96 09:35:14 IST
Message-Id: <9605230405.AA22926@juno.venus.hclt.com>
From: Harmanjit Singh <venus!juno!harman@hclhprnd.hclt.com>
To: zsh-users@math.gatech.edu
Subject: completion ?bug
Resent-Message-ID: <"fLiMG3.0.z21.Sd_en"@euclid>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/220
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1053
Status: O


host configuration: i386-unknown-sysv4.2
zsh-2.6-beta17 invoked as zsh -f		# zle in vi mode

% unsetopt extended_glob
% setopt interactive_comments

% compctl -Q -K joblist kill disown

% joblist()
{
	jobs >& foo
	eval reply=(`procjobs < foo`)	# eval seems necessary
}

% cat procjobs
#! /home/harman/local/bin/perl

# perl 5.001 on i386-unknown-sysv4.2

while (<STDIN>)
{
    chop;			# remove newline
    /\[([0-9]+)\]/;		# get job number   [__]
    $jobno = $1;
    s/\[[0-9]\]* *\+?\-?[ ]*(suspended|running)[ ]*//;
    # removed everything except job names and argv's
    $output = $output."\"%$jobno  #  $_\" ";
    # append to a string
}
chop $output;			# remove the space at the end
print "$output";		# output the concat'ed string

# first test procjobs by doing:
# sleep 1000 & sleep 2000 & sleep 4500 &   # startup some jobs
# satisfy yourself that the output is correct
# joblist; echo $reply[1], $reply[2], ...


Now type kill <TAB>
Observed behaviour is not as expected, please try it out.

Thanks,
-- 
With Warm Regards,
Harmanjit Singh.


