From zsh-users-return-7440-mason-zsh=primenet.com.au@sunsite.dk Mon May 10 00:00:41 2004
Return-Path: <zsh-users-return-7440-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1262 invoked from network); 10 May 2004 00:00:40 -0000
Received: from ns2.primenet.com.au (HELO primenet.com.au) (?R0GZttPx4jIgiLClh4QXIIciegj+WVwO?@203.24.36.3)
  by ns1.primenet.com.au with SMTP; 10 May 2004 00:00:40 -0000
Received: (qmail 3036 invoked from network); 9 May 2004 22:00:48 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.86)
  by proxy.melb.primenet.com.au with SMTP; 9 May 2004 22:00:48 -0000
Received: (qmail 15004 invoked from network); 9 May 2004 21:59:11 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 May 2004 21:59:11 -0000
Received: (qmail 4296 invoked by alias); 9 May 2004 21:59:02 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7440
Received: (qmail 4286 invoked from network); 9 May 2004 21:59:01 -0000
Received: from thor.dotsrc.org (HELO a.mx.sunsite.dk) (qmailr@130.225.247.86)
  by sunsite.dk with SMTP; 9 May 2004 21:58:58 -0000
Received: (qmail 14277 invoked from network); 9 May 2004 21:58:58 -0000
Received: from unknown (HELO moonbase.zanshin.com) (root@167.160.213.139)
  by a.mx.sunsite.dk with SMTP; 9 May 2004 21:58:54 -0000
Received: from toltec.zanshin.com (toltec.zanshin.com [167.160.213.166])
	by moonbase.zanshin.com (8.12.11/8.12.11) with ESMTP id i49LwdcW019470
	for <zsh-users@sunsite.dk>; Sun, 9 May 2004 14:58:40 -0700
Date: Sun, 9 May 2004 14:58:00 -0700 (PDT)
From: Bart Schaefer <schaefer@brasslantern.com>
Sender: schaefer@toltec.zanshin.com
Reply-To: Bart Schaefer <schaefer@brasslantern.com>
To: zsh-users@sunsite.dk
Subject: Re: ksh Emulation Not Clearing Envariables
In-Reply-To: <95E51012-A151-11D8-B3B9-000A95B34D8E@blasted-heath.com>
Message-ID: <Pine.LNX.4.44.0405091449250.29962-100000@toltec.zanshin.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=-0.0 required=6.0 tests=BAYES_44 autolearn=no 
	version=2.63
X-Spam-Hits: -0.0

On Sat, 8 May 2004, Chris Jepeway wrote:

> I'd expect the output to be
> 
> 	X=one
> 
> Instead, I see
> 
> 	X=one
> 	X=one
> 
> Without ksh emulation enabled, I see the expected output.
> 
> This is a bug, right?

It's the intended behavior.  Whether the intention is wrong, I'm not sure.
I believe there was a discussion of the POSIX requirements for this at
some point in the past, and the non-zsh-emulation modes follow POSIX while
(as usual, e.g. shwordsplit) zsh-mode does what it thinks is preferable.

It's possible that ksh also does not follow POSIX and therefore zsh's ksh
emulation shouldn't do so.  Or its possible that ksh does two different
things depending on the form of the function declaration, e.g. whether

	function e { ... }
vs
	e() { ... }

and zsh is only able to emulate one or the other because it does not 
distinguish the two the way ksh does.  (There is no promise made that zsh
will be able to run ksh scripts unmodified; zsh doesn't support namerefs,
among other things.)

> If so, should I file a report @ sourceforge.net?

I keep thinking we should just disable the bug tracker at sourceforge.  I
don't think anyone pays regular attention to it any more.  Bug reports are
usually "filed" by sending them to the zsh-workers mailing list.

