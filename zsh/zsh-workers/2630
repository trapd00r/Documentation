From zsh-workers-request@euclid.skiles.gatech.edu Tue Dec 24 11:35:10 1996
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 6399 invoked from network); 24 Dec 1996 11:35:08 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 24 Dec 1996 11:35:08 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id GAA01878; Tue, 24 Dec 1996 06:33:47 -0500 (EST)
Resent-Date: Tue, 24 Dec 1996 06:33:47 -0500 (EST)
From: Zefram <zefram@dcs.warwick.ac.uk>
Message-Id: <23616.199612241134@stone.dcs.warwick.ac.uk>
Subject: Re: linked-in modules
To: hzoli@cs.elte.hu (Zoltan Hidvegi)
Date: Tue, 24 Dec 1996 11:34:46 +0000 (GMT)
Cc: zefram@dcs.warwick.ac.uk, zsh-workers@math.gatech.edu
In-Reply-To: <199612240301.EAA02653@hzoli.ppp.cs.elte.hu> from "Zoltan Hidvegi" at Dec 24, 96 04:01:42 am
X-Patch: 157
X-Loop: zefram@dcs.warwick.ac.uk
X-Stardate: [-31]8622.41
X-US-Congress: Moronic fuckers
Content-Type: text
Resent-Message-ID: <"Lx49p2.0.GT.Q-xlo"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/2630
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

Zoltan Hidvegi wrote:
>         Unfortunately with my previous patch in my attempt to get parallel
>make work I did too much and make always wants to rebuild everything.  The
>patch below backs up a bit so that parallel make will not work again (but
>make -j3 proto && make -j3 still works).

This alternative patch fixes that problem, and should also make
parallel building safe.

 -zefram

      *** Src/Makefile.in	1996/12/24 03:11:46	1.20
      --- Src/Makefile.in	1996/12/24 03:18:38
      ***************
      *** 186,196 ****
        # default target
        all: bin modules
        
      ! modules: $(ANSI@U@KNR) $(MO@D@ULE_DIRS)
        
      ! bin: zsh
        
      ! zsh: $(ANSI@U@KNR) $(@L@IBZSH) $(@L@OBJS) $(@L@STMP)
        	$(LINK) $(@L@OBJS) $(@L@LIST) $(LIBS)
        
        $(LIBZSH): $(LIBOBJS) $(NSTMP)
      --- 186,198 ----
        # default target
        all: bin modules
        
      ! modules: proto $(HDRS) $(ANSI@U@KNR)
      ! 	@test -z '$(MO@D@ULE_DIRS)' || $(MAKE) $(MAKEDEFS) $(MODULE_DIRS)
        
      ! bin: proto $(ANSI@U@KNR)
      ! 	@$(MAKE) $(MAKEDEFS) zsh
        
      ! zsh: $(@L@IBZSH) $(@L@OBJS) $(@L@STMP)
        	$(LINK) $(@L@OBJS) $(@L@LIST) $(LIBS)
        
        $(LIBZSH): $(LIBOBJS) $(NSTMP)
      ***************
      *** 211,221 ****
        	$(AWK) -f $(srcdir)/rlimits.awk $(RLIMITS_INC_H) > rlimits.h || \
        	    echo WARNING: unknown limits:  mail rlimits.h to developers
        
      ! $(OBJS): proto $(HDRS)
        
        init.o: bltinmods.list zshpaths.h
        
      ! $(MODULE_DIRS): $(PROTO) $(HDRS) FORCE
        	@cd $@ && $(MAKE) $(MAKEDEFS) modules
        
        zshpaths.h: FORCE
      --- 213,223 ----
        	$(AWK) -f $(srcdir)/rlimits.awk $(RLIMITS_INC_H) > rlimits.h || \
        	    echo WARNING: unknown limits:  mail rlimits.h to developers
        
      ! $(OBJS): $(HDRS)
        
        init.o: bltinmods.list zshpaths.h
        
      ! $(MODULE_DIRS): FORCE
        	@cd $@ && $(MAKE) $(MAKEDEFS) modules
        
        zshpaths.h: FORCE
      *** Src/Modules/Makefile.in	1996/12/24 03:11:49	1.8
      --- Src/Modules/Makefile.in	1996/12/24 03:19:35
      ***************
      *** 30,35 ****
      --- 30,36 ----
        VERSION = @VERSION@
        
        SHELL = /bin/sh
      + @SET_MAKE@
        
        top_srcdir = @top_srcdir@
        srcdir     = @srcdir@
      ***************
      *** 96,104 ****
        # default target
        all: modules
        
      ! modules: $(MODULES)
      ! 
      ! $(MODULES): proto
        
        proto: $(PROTO)
        
      --- 97,104 ----
        # default target
        all: modules
        
      ! modules: proto
      ! 	@$(MAKE) $(MAKEDEFS) $(MODULES)
        
        proto: $(PROTO)
        
      *** Src/Zle/Makefile.in	1996/12/24 03:11:50	1.7
      --- Src/Zle/Makefile.in	1996/12/24 03:16:52
      ***************
      *** 30,35 ****
      --- 30,36 ----
        VERSION = @VERSION@
        
        SHELL = /bin/sh
      + @SET_MAKE@
        
        top_srcdir = @top_srcdir@
        srcdir     = @srcdir@
      ***************
      *** 105,116 ****
        # default target
        all: modules
        
      ! modules: $(MODULES)
        
        zle.so: $(ZLEOBJS)
        	$(LINK) $(ZLEOBJS)
        
      ! $(OBJS): proto $(HDRS)
        
        proto: $(PROTO)
        
      --- 106,118 ----
        # default target
        all: modules
        
      ! modules: proto
      ! 	@$(MAKE) $(MAKEDEFS) $(MODULES)
        
        zle.so: $(ZLEOBJS)
        	$(LINK) $(ZLEOBJS)
        
      ! $(OBJS): $(HDRS)
        
        proto: $(PROTO)
        

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3i
Charset: ascii

iQCVAwUBMr+/unD/+HJTpU/hAQGNLAP+NLgRir2p38vFX8dQzVUkpaqNs2Eh5p06
Q3ThaE4babo9cam8rCELhYDr4IpSaO5oTOPiDuKXxdXVe1XhzfFPo09JauflLpxn
ERz8EO2kHByLuQClUZSDGI0nlW+ee1jFWVX7Wc52l15wbn0GBg8VZhlAkPUziWVh
7QfD0/vg/hU=
=1WYI
-----END PGP SIGNATURE-----

