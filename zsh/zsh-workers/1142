From mason@werple.net.au Thu May 23 23:38:40 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3) with ESMTP id XAA03721 for <mason@werple.mira.net.au>; Thu, 23 May 1996 23:38:38 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id JAA07543; Thu, 23 May 1996 09:16:21 -0400 (EDT)
Resent-Date: Thu, 23 May 1996 09:16:21 -0400 (EDT)
From: Geoff Wing <mason@werple.net.au>
Message-Id: <199605231316.NAA02924@werple.net.au>
Subject: signames.awk fix
To: zsh-workers@math.gatech.edu (zsh-list)
Date: Thu, 23 May 1996 23:16:11 +1000 (EST)
X-Mailer: ELM [version 2.4 PL25]
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"MBdVx.0.gr1.bK6fn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1142
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 2329
Status: OR

Heyla,
  since changes to signames.h seemed to stuff people up, try this patch:
(the code in this file is getting more and more roundabout to combat
everyone's stuffed up awks)

*** signames.awk        Thu May 23 23:09:15 1996
--- signames.awk.orig   Thu May 23 22:46:39 1996
***************
*** 2,8 ****
  # $Id: signames.awk,v 2.1 1996/05/20 01:24:24 hzoli Exp $
  #
  # {g,n}awk script to generate signals.h
! # provided by Geoff Wing <mason@werple.net.au>
  # NB: On SunOS 4.1.3 - user-functions don't work properly, also \" problems
  #
  /^[\t ]*#[\t ]*define[\t _]*SIG[A-Z][A-Z0-9]*[\t ]*[1-9][0-9]*/ { 
--- 2,8 ----
  # $Id: signames.awk,v 2.1 1996/05/20 01:24:24 hzoli Exp $
  #
  # {g,n}awk script to generate signals.h
! # provided by Geoff Wing <mason@werple.apana.org.au>
  # NB: On SunOS 4.1.3 - user-functions don't work properly, also \" problems
  #
  /^[\t ]*#[\t ]*define[\t _]*SIG[A-Z][A-Z0-9]*[\t ]*[1-9][0-9]*/ { 
***************
*** 51,59 ****
  }
  
  END {
-     hash = "#"
      ps = "%s"
!     ifdstr = sprintf("#ifdef USE_SUSPENDED\n\t%csuspended%s%c,\n%celse\n\t%cst
opped%s%c,\n#endif\n", 034, ps, 034, hash, 034, ps, 034)
  
      printf("%s\n%s\n\n%s\t%d\n\n%s\n\n%s\n\t%c%s%c,\n", "/** signals.h        
                         **/", "/** architecture-customized signals.h for zsh **
/", "#define SIGCOUNT", max, "#ifdef GLOBALS", "char *sigmsg[SIGCOUNT+2] = {", 0
34, "done", 034)
  
--- 51,58 ----
  }
  
  END {
      ps = "%s"
!     ifdstr = sprintf("#ifdef USE_SUSPENDED\n\t%csuspended%s%c,\n\#else\n\t%cst
opped%s%c,\n#endif\n", 034, ps, 034, 034, ps, 034)
  
      printf("%s\n%s\n\n%s\t%d\n\n%s\n\n%s\n\t%c%s%c,\n", "/** signals.h        
                         **/", "/** architecture-customized signals.h for zsh **
/", "#define SIGCOUNT", max, "#ifdef GLOBALS", "char *sigmsg[SIGCOUNT+2] = {", 0
34, "done", 034)
  
***************
*** 88,94 ****
      print "\tNULL"
      print "};"
      print ""
!     printf("%celse\n", hash)
      print "extern char *sigs[SIGCOUNT+4],*sigmsg[SIGCOUNT+2];"
      print "#endif"
  }
--- 87,93 ----
      print "\tNULL"
      print "};"
      print ""
!     print "\#else"
      print "extern char *sigs[SIGCOUNT+4],*sigmsg[SIGCOUNT+2];"
      print "#endif"
  }


-- 
Mason [G.C.W]  mason@werple.mira.net.au    "Hurt...Agony...Pain...LOVE-IT"


