From zsh-users-return-3963-mason-zsh=primenet.com.au@sunsite.dk Wed Jun 27 07:30:49 2001
Return-Path: <zsh-users-return-3963-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26659 invoked from network); 27 Jun 2001 07:30:48 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 27 Jun 2001 07:30:48 -0000
Received: (qmail 15837 invoked by alias); 27 Jun 2001 07:29:47 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 3963
Received: (qmail 15819 invoked from network); 27 Jun 2001 07:29:45 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1010627072822.ZM5007@candle.brasslantern.com>
Date: Wed, 27 Jun 2001 07:28:21 +0000
In-Reply-To: =?iso-8859-1?Q?=3C20010626233435=2EA4263=40acmex=2Egatech=2Ee?=
 =?iso-8859-1?Q?du=3E?=
 =?iso-8859-1?Q?Comments=3A_In_reply_to_J=F6rg_Ziefle_=3Cgt4556a=40prism?=
 =?iso-8859-1?Q?=2Egatech=2Eedu=3E?=
 =?iso-8859-1?Q?________=222nd_mail_question_=3A=29=22_=28Jun_26=2C_11=3A3?=
 =?iso-8859-1?Q?4pm=29?=
References: <20010626233435.A4263@acmex.gatech.edu>
X-Mailer: Z-Mail (5.0.0 30July97)
To: =?iso-8859-1?Q?J=F6rg_Ziefle?= <gt4556a@prism.gatech.edu>,
        zsh-users@sunsite.dk
Subject: Re: 2nd mail question :)
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

On Jun 26, 11:34pm, J=F6rg Ziefle wrote:
} Subject: 2nd mail question :)
}
} Does anybody see a way to execute an external program when new mail has=

} come in?  Events, for example?

It's not really documented, but you can put any $-expansion you like in
the notification message in mailpath.  E.g.:

    mailpath=3D( $HOME/Mail'?New mail in $_ at $(date)' )

} What I wanna do is when new mail arrives, I want to have a little
} program executed that starts my mailer with the right folder
} (user-specified if several folders have received mail).

Hrm.  Why not just leave your mailer running and let it do the new mail
checking?  (Secondary question, why not get a better mailer?)

The thing to remember about stuff in $(...) is that zsh wants to read
the output from it -- so zsh will wait not just until the program exits,
but until it actually reads end-of-file, which means even putting the
program in the background won't necessarily unblock zsh.  At the same
time, the program's output (and maybe input) are directed away from the
terminal, so unless you explicitly point them back you can't interact
with the program.

So if you really want zsh to automatically fire up some kind of mail
client when new mail arrives, you need something like:

    mailpath=3D( $HOME/Mail'?$(mutt -f "$_" </dev/tty >&/dev/tty)' )

Note placement of single vs. double quotes.  Note also that zsh will run
this once for every file that has new mail.  A better solution might be
something like this:

    mailpath=3D( $HOME/Mail'?$(echo "$_" >>| ~/.newmail) )
    precmd() {
	if [[ -f ~/.newmail ]]; then
	    # There'll be one line for each mailbox.
	    # Run your mailer appropriately.
	    mutt -f "$(head -1 ~/.newmail)" # or whatever
	    rm ~/.newmail
	fi
    }

I predict, however, that after at most a day of having your mail client
repeatedly pop open in the middle of whatever else you're doing, you will=

abandon this idea.

-- =

Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net  =
 =

