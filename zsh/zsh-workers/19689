From zsh-workers-return-19689-mason-zsh=primenet.com.au@sunsite.dk Thu Mar 25 14:06:20 2004
Return-Path: <zsh-workers-return-19689-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6481 invoked from network); 25 Mar 2004 14:06:18 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 25 Mar 2004 14:06:18 -0000
Received: (qmail 15852 invoked by alias); 25 Mar 2004 14:06:11 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19689
Received: (qmail 15838 invoked from network); 25 Mar 2004 14:06:10 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 25 Mar 2004 14:06:10 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 25 Mar 2004 14:6:10 -0000
Received: (qmail 2266 invoked from network); 25 Mar 2004 14:06:10 -0000
Received: from unknown (HELO mailsweeperjp.CSR.COM) (202.214.225.228)
  by a.mx.sunsite.dk with SMTP; 25 Mar 2004 14:06:08 -0000
Received: from exchangejp.csr.com (unverified) by mailsweeperjp.CSR.COM
 (Content Technologies SMTPRS 4.3.1) with ESMTP id <T68907961aec0a879017b0@mailsweeperjp.CSR.COM>;
 Thu, 25 Mar 2004 22:07:52 +0900
Received: from EXCHANGE02.csr.com ([192.168.137.45]) by exchangejp.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Thu, 25 Mar 2004 13:08:04 +0000
Received: from csr.com ([192.168.144.127]) by EXCHANGE02.csr.com with Microsoft SMTPSVC(5.0.2195.6713);
	 Thu, 25 Mar 2004 13:08:00 +0000
To: cygwin@cygwin.com, zsh-workers@sunsite.dk (Zsh hackers list)
Subject: dllwrap fails to find last exported symbol alphabetically
Date: Thu, 25 Mar 2004 13:05:23 +0000
Message-ID: <11205.1080219923@csr.com>
From: Peter Stephenson <pws@csr.com>
X-OriginalArrivalTime: 25 Mar 2004 13:08:00.0546 (UTC) FILETIME=[330BC820:01C4126A]
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.2 required=6.0 tests=EXCUSE_16 autolearn=no 
	version=2.63
X-Spam-Hits: 0.2

A problem now seen by two of us with recent Cygwin installations:
mine was updated to `current' status last week.  However, I don't think
this is new since I've been seeing it on my own setup for a while.

Zsh uses `dllwrap --export-all-symbols' to link against it's own DLL's.
On the systems in question, dllwrap failed to identify the last symbol
exported from the main dll (zsh.dll) against which all the other DLL's
are linked.  The symbol in question is `zwarnnam'; we've verified it
really is the last symbol by adding a dummy one later in the alphabet,
and the problem goes away.  (This is an easy workaround so consequently
finding a real fix isn't a high priority for us.)

It sounds like if this is fundamental lots of people would have fallen
over it, but I've no idea what else might be relevant.

Anyway, on systems where it does trigger, it will show up by downloading
zsh 4.2.0 from ftp://ftp.zsh.org/pub/ and trying to compile with default
options.  You will see warnings about failures to find the symbol
zwarnnam when linking DLL's.  (The failure seen by users is a crash on
an attempt to print warning messages form libraries.  Running `vared
nonexistentvar' form the installed shell will do this.)  We haven't
narrowed it down any further.

If you (the Cygwin people) need more information, it's probably best to
prod zsh@sunsite.org (this list runs qconfirm but you only need to
confirm once).

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 692070


**********************************************************************
The information transmitted is intended only for the person or
entity to which it is addressed and may contain confidential 
and/or privileged material. 
Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by 
persons or entities other than the intended recipient is 
prohibited. 
If you received this in error, please contact the sender and 
delete the material from any computer.
**********************************************************************

