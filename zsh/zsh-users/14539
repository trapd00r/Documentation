From zsh-users-return-14539-mason-zsh=primenet.com.au@zsh.org Wed Nov 11 00:08:57 2009
Return-Path: <zsh-users-return-14539-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20382 invoked by alias); 11 Nov 2009 00:08:57 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 14539
Received: (qmail 22260 invoked from network); 11 Nov 2009 00:08:54 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: pass (ns1.primenet.com.au: SPF record at narod.ru designates 77.88.46.7 as permitted sender)
X-Yandex-Spam: 1
X-Yandex-Front: webmail89 
X-Yandex-TimeMark: 1257897633 
From: Dmitry Bolshakov <bdimych@narod.ru>
To: zsh-users@zsh.org
Subject: the function to show a digit argument while it is being typed
MIME-Version: 1.0
Message-Id: <10081257897632@webmail89.yandex.ru>
Date: Wed, 11 Nov 2009 03:00:32 +0300
X-Mailer: Yamail [ http://yandex.ru ] 5.0
Content-Transfer-Encoding: 7bit
Content-Type: text/plain

hi

in bash a digit argument is showed when it is being typed

i have writed small function which do the same

#####
function digit-argument-show-while-entering {
	arg="${KEYS[2]}"
	if [[ $arg == - ]]
	then
		zle .neg-argument
	else
		zle .digit-argument
	fi
	while true
	do
		PREDISPLAY="(arg: $arg) "
		zle -R

		read -k k1
		if [[ $k1 == $'\C-g' ]]
		then
			NUMERIC=1
			break
		elif [[ $k1 != $'\e' ]]
		then
			zle -U $k1
			break
		fi

		read -k k2
		if [[ $k2 == <0-9> ]]
		then
			arg=$arg$k2
			NUMERIC=$arg
		else
			zle -U "$k1$k2"
			break
		fi
	done
	PREDISPLAY=""
}
zle -N digit-argument digit-argument-show-while-entering
zle -N neg-argument digit-argument-show-while-entering
#####

it is not well tested but seems to be working

-- 
with best regards
Dmitry Bolshakov

