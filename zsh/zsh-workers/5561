From zsh-workers-return-5561-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Mar 01 10:53:14 1999
Return-Path: <zsh-workers-return-5561-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5148 invoked from network); 1 Mar 1999 10:53:12 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Mar 1999 10:53:12 -0000
Received: (qmail 13017 invoked by alias); 1 Mar 1999 10:52:32 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 5561
Received: (qmail 13008 invoked from network); 1 Mar 1999 10:52:26 -0000
Message-Id: <9903011036.AA32482@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list), probin@qnx.com
Subject: PATCH: 3.1.5-pws-10: QNX4
Date: Mon, 01 Mar 1999 11:36:30 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>

This is an attempt to get the latest development version of zsh,
http://www.ifh.de/~pws/computing/zsh-3.1.5-pws-10.tar.gz , to work on
QNX4.  I haven't been able to test it, except that it doesn't blow up
elsewhere.

Most of it is simply changing halloc() to zhalloc(); #defining it out of
the way is asking for trouble, as I know from trying to debug such things.
Also, if one system has its own halloc(), it won't be long before someone
else has it.  People will need to remember the z from now on.

There's now a direct test for QNX in configure, to see if it should use the
system's getcwd() instead of zgetcwd().  In that case it uses the code Matt
added to support cygwin (i.e. it doesn't simply call getcwd(), there are
still a few extra frills).  If this works, it would be neater to move the
test for cygwin back to configure as well.  It would be even neater if we
could work out a test for whether zsh can successfully use the system's
getcwd().

It's possible I haven't got the checks for the terminal mode definitions
right, in which case we'll just have to add another ad hoc system test in
configure.

begin 644 qnx.dif.gz
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
(R96ZT%1#```"
`
end

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

