From zsh-workers-return-21465-mason-zsh=primenet.com.au@sunsite.dk Thu Jul 14 19:19:33 2005
Return-Path: <zsh-workers-return-21465-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18426 invoked from network); 14 Jul 2005 19:19:32 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Jul 2005 19:19:32 -0000
Received: (qmail 71132 invoked from network); 14 Jul 2005 19:19:26 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Jul 2005 19:19:26 -0000
Received: (qmail 16289 invoked by alias); 14 Jul 2005 19:19:24 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21465
Received: (qmail 12662 invoked from network); 14 Jul 2005 19:04:21 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 Jul 2005 19:04:21 -0000
Received: (qmail 54025 invoked from network); 14 Jul 2005 19:04:20 -0000
Received: from wproxy.gmail.com (64.233.184.198)
  by a.mx.sunsite.dk with SMTP; 14 Jul 2005 19:03:30 -0000
Received: by wproxy.gmail.com with SMTP id i7so471300wra
        for <zsh-workers@sunsite.dk>; Thu, 14 Jul 2005 12:03:29 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:reply-to:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=eX9wsldAES5KAo++7/P25yk6TOKFiCxJWdz8Ymm+KQMXJWtDpCAqtSOQpDlotrjO2RVsUr15RxSL+cJ+JA0tOWU0PyWXGZKuvOkfyOoyAiCHO6WxBZe4uxkRLEEJ5Zo+SrJ568i+zwhhnYOxrkF0w8byW+2G85W23LcgrvonAXw=
Received: by 10.54.53.39 with SMTP id b39mr833826wra;
        Thu, 14 Jul 2005 12:02:33 -0700 (PDT)
Received: by 10.54.48.29 with HTTP; Thu, 14 Jul 2005 12:02:33 -0700 (PDT)
Message-ID: <f6879d2c05071412024c9afaf9@mail.gmail.com>
Date: Thu, 14 Jul 2005 23:02:33 +0400
From: George Kouryachy <frbrgeorge@gmail.com>
Reply-To: George Kouryachy <frbrgeorge@gmail.com>
To: zsh-workers@sunsite.dk
Subject: mkdir -p buldtin is possibly incorrect?
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.0.2 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=6.0 tests=BAYES_00,RCVD_BY_IP 
	autolearn=ham version=3.0.2
X-Spam-Hits: -2.5

Hi.

Look at this, this is a part of zsh-4.3.0-20050611/Src/Modules/files.c:

    120 static int
    121 domkdir(char *nam, char *path, mode_t mode, int p)
    122 {
    123     int err;
    124     mode_t oumask;
    125     char const *rpath =3D unmeta(path);
    126=20
    127     if(p) {
    128         struct stat st;
    129=20
    130         if(!lstat(rpath, &st) && S_ISDIR(st.st_mode))
    131             return 0;
    132     }

Why do you use "lstat" instead of "stat" in line 130?
I have my $HOME symlinked as "/home -> /var/home",
so any first attempt to use completion smaps like tths:
_store_cache:mkdir:16: cannot make directory `/home': file exists

--=20
George V Kouryachy (aka Fr. Br. George)
mailto:george at gmail dot com

