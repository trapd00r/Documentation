From zsh-workers-return-13518-mason-zsh=primenet.com.au@sunsite.dk Thu Feb 22 11:49:51 2001
Return-Path: <zsh-workers-return-13518-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16600 invoked from network); 22 Feb 2001 11:49:49 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Feb 2001 11:49:49 -0000
Received: (qmail 22564 invoked by alias); 22 Feb 2001 11:49:44 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 13518
Received: (qmail 22553 invoked from network); 22 Feb 2001 11:49:44 -0000
Message-ID: <Tc0a8890c51e267e2e1@mailsweeper01.cambridgesiliconradio.com>
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Completion services + xterm auto-margin revisited
Date: Thu, 22 Feb 2001 11:49:15 +0000
From: Peter Stephenson <pws@csr.com>

I just updated the zsh guide at http://sunsite.dk/zsh/Guide/ thanks to some
suggestions from Sven.  One of the new things that went in is some mention
of `services':

compdef mycmd=cmd

where completion for mycmd is supposed to behave as closely as possible to
that for cmd.

If I've got this right, this depends on the completion in question
implementing any command-specific behaviour using the parameter $service.
That would imply it's a good idea to alter some of the standard completions
to use $service instead of $words[1].  This was prompted in particular by
looking at _vars_eq --- if you do `compdef myexport=export', you probably
want export arguments, not typeset ones.

Is this correct?  It seems to work correctly in this case, and it's
probably an easy set of changes but I thought I'd better ask.

By the way, completion listing for `typeset -' seems to tickle a relative
of an ancient bug with xterm auto-margin: one of the possible descriptions
is exactly 80 characters, but doesn't cause wraparound since there's
nothing to follow, and redisplaying the command line happens one line too
high.  There was a sizeable discussion about this once, but I've forgotten
the punchline.  The new element here is that it only happens if the screen
needs scrolling --- if the cursor is at the top of the screen, it works
fine.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

