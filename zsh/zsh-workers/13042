From zsh-workers-return-13042-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Oct 19 14:51:30 2000
Return-Path: <zsh-workers-return-13042-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13296 invoked from network); 19 Oct 2000 14:51:29 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 19 Oct 2000 14:51:29 -0000
Received: (qmail 6342 invoked by alias); 19 Oct 2000 14:50:57 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13042
Received: (qmail 6332 invoked from network); 19 Oct 2000 14:50:57 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>
Subject: Absolute pathnames on cygwin
Date: Thu, 19 Oct 2000 18:50:54 +0400
Message-ID: <001d01c039db$fb803b80$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400

mw1g017@MW1G17C% print $PWD
/cygdrive/c/win32app/bin
mw1g017@MW1G17C% cd d:/temp
mw1g017@MW1G17C% print $PWD
/cygdrive/c/win32app/bin/d:/temp

The reason is obvious - Zsh does not understand that d:/temp is the absolute
path. The solution is not.

Simply adding test for `x:/' in cd_do_chdir did not work. Even if it would
prevent concatenation, it would leave pathname as d:/temp that may cause
problems in the future.

Current cygwin has a "superroot" notion to present Windows drives in Unix-like
tree form. By default it is `/cygdrive' prefix; /cygdrive/x refers to drive x.
There is a set of routines, notably cygwin_conv_to_posix_path, that are used
to convert all filenames to standard Unix-like form.

I believe, it makes no sense to try to recognize all possible forms of Windows
pathnames in Zsh - rather, we should simply call the above function and deal
with single Unix form. The only problem is, when should such function be
called.

There are possibly other places where this may cause confusion.

-andrej

Have a nice DOS!
B >>

