From zsh-workers-request@euclid.skiles.gatech.edu  Sat Mar  2 09:04:38 1996
Received: from euclid.skiles.gatech.edu (euclid.skiles.gatech.edu [130.207.146.50]) by werple.net.au (8.7/8.7.1) with ESMTP id JAA16867 for <mason@werple.mira.net.au>; Sat, 2 Mar 1996 09:04:34 +1100 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id QAA10393; Fri, 1 Mar 1996 16:50:12 -0500 (EST)
Resent-Date: Fri, 1 Mar 1996 16:50:12 -0500 (EST)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199603012149.WAA07677@bolyai.cs.elte.hu>
Subject: Time printing bugfix
To: zsh-workers@math.gatech.edu (zsh-workers)
Date: Fri, 1 Mar 1996 22:49:53 +0100 (MET)
Organization: Dept. of Comp. Sci., Eotvos University, Budapest, Hungary
Phone: (36 1)2669833 ext: 2667, home phone: (36 1) 2752368
X-Mailer: ELM [version 2.4 PL24 PGP3 *ALPHA*]
Mime-Version: 1.0
Content-Type: application/pgp
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"J5nLS.0.JY2.I4tDn"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/793
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

If the thousands of second is less that 100 in a time it is not printed
correctly.  E.g. 0.099 is printed as 0.99.  I must confess that this bug
is my mistake :-(.  Here is the patch which hopefully saves my reputation.

Zoltan

 rcsdiff -qc -kk -r1.1 -r1.2 Src/jobs.c
 *** Src/jobs.c
 --- Src/jobs.c	1996/03/01 20:48:56	1.2
 ***************
 *** 643,661 ****
   void
   printhhmmss(double secs)
   {
 !     int intsecs = secs;
 !     int tsecs = 1000 * (secs - intsecs);
 !     int mins = intsecs / 60;
       int hours = mins / 60;
   
 !     intsecs -= 60 * mins;
       mins -= 60 * hours;
       if (hours)
 ! 	fprintf(stderr, "%d:%02d:%02d.%02d", hours, mins, intsecs, tsecs);
       else if (mins)
 ! 	fprintf(stderr,      "%d:%02d.%02d",        mins, intsecs, tsecs);
       else
 ! 	fprintf(stderr,           "%d.%02d",              intsecs, tsecs);
   }
   
   /**/
 --- 643,659 ----
   void
   printhhmmss(double secs)
   {
 !     int mins = (int) secs / 60;
       int hours = mins / 60;
   
 !     secs -= 60 * mins;
       mins -= 60 * hours;
       if (hours)
 ! 	fprintf(stderr, "%d:%02d:%05.2f", hours, mins, secs);
       else if (mins)
 ! 	fprintf(stderr,      "%d:%05.2f",        mins, secs);
       else
 ! 	fprintf(stderr,           "%.3f",              secs);
   }
   
   /**/

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3i
Charset: noconv

iQCVAwUBMTdw+wupSCiLN749AQF7tAQAi1XNjTYXM7rsrOGzXoMc6rBDKcdTNMAH
5YfvDjAor2kipuJgKAKCj/zC2xWxjerfIErcBYLfbnM5YQbcL/Un2UmGWwq0qRKc
56O6AAx8EIW73K2ve1EO1VvaEnkH06GYJvAg+xKDthzoAIXS/VZbQR0euv0zYmSA
0JDiEaY9Gqc=
=+mte
-----END PGP SIGNATURE-----

