From zsh-workers-return-8206-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Oct 11 12:31:50 1999
Return-Path: <zsh-workers-return-8206-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22354 invoked from network); 11 Oct 1999 12:31:47 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 11 Oct 1999 12:31:47 -0000
Received: (qmail 28079 invoked by alias); 11 Oct 1999 12:31:34 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8206
Received: (qmail 28072 invoked from network); 11 Oct 1999 12:31:34 -0000
Date: Mon, 11 Oct 1999 14:31:29 +0200 (MET DST)
Message-Id: <199910111231.OAA03679@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Mon, 11 Oct 1999 15:25:13 +0400
Subject: Re: BUG: RE: What happened to _path_files?


Andrej Borsenkow wrote:

> It looks, like ambiguous completion does not work any more. It is not
> _path_files - it works correctly and compadd's all needed info. But for whatever
> reason completion C-code does not like it.

Only if the thing starts with a slash, right? The PREFIX parameter
wasn't set correctly.

Bye
 Sven

diff -u oldcompletion/Core/_path_files Completion/Core/_path_files
--- oldcompletion/Core/_path_files	Mon Oct 11 13:30:19 1999
+++ Completion/Core/_path_files	Mon Oct 11 14:30:01 1999
@@ -354,10 +354,10 @@
       # it as far as possible.
 
       if [[ "$tmp3" = */* ]]; then
-        PREFIX="${linepath}${cpre}${tmp3%%/*}"
+        PREFIX="${donepath}${linepath}${cpre}${tmp3%%/*}"
 	SUFFIX="/${tmp3#*/}"
       else
-        PREFIX="${linepath}${cpre}${tmp3}"
+        PREFIX="${donepath}${linepath}${cpre}${tmp3}"
 	SUFFIX=""
       fi
 

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

