From zsh-workers-return-20176-mason-zsh=primenet.com.au@sunsite.dk Tue Jul 20 18:47:50 2004
Return-Path: <zsh-workers-return-20176-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 18222 invoked from network); 20 Jul 2004 18:47:49 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 20 Jul 2004 18:47:49 -0000
Received: (qmail 98327 invoked from network); 20 Jul 2004 18:47:43 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 20 Jul 2004 18:47:43 -0000
Received: (qmail 7006 invoked by alias); 20 Jul 2004 18:47:31 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 20176
Received: (qmail 6996 invoked from network); 20 Jul 2004 18:47:30 -0000
Received: from unknown (HELO a.mx.sunsite.dk) (130.225.247.88)
  by 130.225.247.90 with SMTP; 20 Jul 2004 18:47:30 -0000
Received: (qmail 97210 invoked from network); 20 Jul 2004 18:45:32 -0000
Received: from tantale.fifi.org (216.27.190.146)
  by a.mx.sunsite.dk with SMTP; 20 Jul 2004 18:45:30 -0000
Received: from ceramic.fifi.org (mail@ceramic.fifi.org [216.27.190.147])
	by tantale.fifi.org (8.9.3p2/8.9.3/Debian 8.9.3-21) with ESMTP id LAA10258;
	Tue, 20 Jul 2004 11:45:27 -0700
Received: from phil by ceramic.fifi.org with local (Exim 4.22)
	id 1BmzcD-0001eb-TZ; Tue, 20 Jul 2004 11:45:25 -0700
To: Clint Adams <schizo@debian.org>
Cc: zsh-workers@sunsite.dk, 205685-forwarded@bugs.debian.org
Subject: Re: [vincent@vinc17.org: Re: Bug#205685: clone corruption]
References: <20040720181612.GA18242@scowler.net>
Mail-Copies-To: nobody
From: Philippe Troin <phil@fifi.org>
Date: 20 Jul 2004 11:45:25 -0700
In-Reply-To: <20040720181612.GA18242@scowler.net>
Message-ID: <87658ifrga.fsf@ceramic.fifi.org>
Lines: 50
User-Agent: Gnus/5.09 (Gnus v5.9.0) Emacs/21.2
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Sender: Philippe Troin <phil@fifi.org>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

Clint Adams <schizo@debian.org> writes:

> I haven't used clone before this, but I can reproduce the behavior
> described below.
> 
> ----- Forwarded message from Vincent Lefevre <vincent@vinc17.org> -----
> 
> On 2004-07-17 16:10:04 -0400, Clint Adams wrote:
> > Hmm, is this still a problem?
> 
> clone doesn't even work any longer. For instance:
> 
> In the first terminal:
> 
> greux:~> exec zsh -f
> greux% tty
> /dev/pts/240
> greux% foo=bar
> greux% echo $foo
> bar
> greux% zmodload zsh/clone
> greux% clone /dev/pts/241
> greux% 
> 
> In the second terminal:
> 
> greux:~> exec zsh -f
> greux% tty
> /dev/pts/241
> greux% clone: could not make /dev/pts/241 my controlling tty, job control disabled
> greux% echo $foo
> 
> greux% 
> 
> (The message "clone: could not make..." appeared just after executing
> "clone /dev/pts/241" in the first terminal.)
> 
> ----- End forwarded message -----

Probably two shells running on the same terminal, this is NOT
supported and can only lead to bad results.

The only way to use clone is to start it on an unused terminal,
started with eg:

  xterm -e sh -c 'trap : INT QUIT TSTP; tty; while :; do sleep 100000000; done'

or on an unused virtual console.

Phil.

