From zsh-workers-return-24601-mason-zsh=primenet.com.au@sunsite.dk Tue Feb 26 19:48:03 2008
Return-Path: <zsh-workers-return-24601-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 19742 invoked from network); 26 Feb 2008 19:48:00 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 26 Feb 2008 19:48:00 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 4569 invoked from network); 26 Feb 2008 19:47:56 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 26 Feb 2008 19:47:56 -0000
Received: (qmail 17631 invoked by alias); 26 Feb 2008 19:47:52 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24601
Received: (qmail 17615 invoked from network); 26 Feb 2008 19:47:52 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 26 Feb 2008 19:47:52 -0000
Received: from mail.blastwave.org (mail.blastwave.org [147.87.98.10])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 28B448026E0B
	for <zsh-workers@sunsite.dk>; Tue, 26 Feb 2008 20:47:48 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by mail.blastwave.org (Postfix) with ESMTP id 616C426F2
	for <zsh-workers@sunsite.dk>; Tue, 26 Feb 2008 20:47:48 +0100 (MET)
X-Virus-Scanned: amavisd-new at blastwave.org
Received: from mail.blastwave.org ([127.0.0.1])
	by localhost (enterprise.blastwave.org [127.0.0.1]) (amavisd-new, port 10024)
	with LMTP id 38oJSI6bhuCz for <zsh-workers@sunsite.dk>;
	Tue, 26 Feb 2008 20:47:39 +0100 (MET)
Received: from [192.168.1.102] (i577A594B.versanet.de [87.122.89.75])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.blastwave.org (Postfix) with ESMTP id 872D72D50
	for <zsh-workers@sunsite.dk>; Tue, 26 Feb 2008 20:47:31 +0100 (MET)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <3C810A28-FD80-4DE3-9E70-E48F35DB2525@blastwave.org>
References: <8AABEECB-A9A6-43EA-BED2-4BE376CBE349@blastwave.org> <20080226141459.76dc362c@news01> <BD1EA7D6-C784-4ED9-9558-5B655CBC5096@blastwave.org> <20080226145741.6e74fc22@news01> <656429B3-438B-4ECF-85C4-04E38D837D1A@blastwave.org> <200802261610.m1QGAwJ3008939@news01.csr.com> <20080226180807.10cd1476@news01> <3C810A28-FD80-4DE3-9E70-E48F35DB2525@blastwave.org>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <36DDE5D8-3712-4184-9EAE-61ED914C70C2@blastwave.org>
Content-Transfer-Encoding: 7bit
From: Dagobert Michelsen <dam@blastwave.org>
Subject: Re: Failed tests of zsh 4.3.5 in Solaris 10 w/Sun Studio 12 CC
Date: Tue, 26 Feb 2008 20:47:23 +0100
To: zsh-workers@sunsite.dk
X-Mailer: Apple Mail (2.753)
X-Virus-Scanned: ClamAV 0.91.2/6004/Tue Feb 26 20:08:16 2008 on bifrost
X-Virus-Status: Clean

Hi all,

Am 26.02.2008 um 20:19 schrieb Dagobert Michelsen:
> Do you have a clue about the other failing tests?

The testsuite now runs fine with my fix for the last fix
with the exception of one remaining failing test:

thor% ZTST_verbose=1 gmake TESTNUM=C02 check
if test -n "cc"; then \
           cd .. && DESTDIR= \
           gmake MODDIR=`pwd`/Test/Modules install.modules > /dev/ 
null; \
         fi
if ZTST_testlist="`for f in ./C02*.ztst; \
            do echo $f; done`" \
          ZTST_srcdir="." \
          ZTST_exe=../Src/zsh \
          ../Src/zsh +Z -f ./runtests.zsh; then \
          stat=0; \
         else \
          stat=1; \
         fi; \
         rm -rf Modules .zcompdump; \
         exit $stat
./C02cond.ztst: starting.
Running test: -a cond
Test successful.
Running test: -b cond
Test successful.
Running test: -c cond
Test successful.
Running test: -d cond
Test successful.
Running test: -e cond
Test successful.
Running test: -f cond
Test successful.
Running test: -g cond
Test successful.
Running test: -h cond
Test successful.
Running test: -k cond
Test successful.
Running test: -n cond
Test successful.
Running test: -o cond
Test successful.
Running test: -p cond
Test successful.
Running test: -r cond
Test successful.
Running test: -s cond
Test successful.
Running test: -u cond
Test successful.
Running test: -x cond
Test successful.
Running test: -z cond
Test successful.
Running test: -L cond
Test successful.
Running test: -O cond
Test successful.
Running test: -G cond
Test successful.
Running test: -N cond
Warning: not testing [[ -N file ]] (not supported with NFS)
Test successful.
Running test: -nt cond
Test ./C02cond.ztst failed: bad status 1, expected 0 from:
   [[ newnewnew -nt zerolength && ! (unmodified -nt zerolength) ]]
Was testing: -nt cond
./C02cond.ztst: test failed.
**************************************
0 successful test scripts, 1 failure, 0 skipped
**************************************
gmake: *** [check] Error 1


I suspect this part here from C02cond.ztst:

> # can't be bothered with -S
>
>   if [[ $OSTYPE == "cygwin" ]]; then
>     print -u$ZTST_fd "Warning: not testing [[ -N file ]] (not  
> supported on Cygwin)"
>     true
>   elif [[ "$(find . -prune -fstype nfs 2>/dev/null)" == "." ]]; then
>     print -u$ZTST_fd "Warning: not testing [[ -N file ]] (not  
> supported with NFS)"
>     true
>   else
>     print -u $ZTST_fd 'This test takes two seconds...'
>     sleep 2
>     cat unmodified
>     touch newnewnew
>     [[ -N newnewnew && ! -N unmodified ]]
>   fi
> 0:-N cond
> F:This test can fail on NFS-mounted filesystems as the access and
> F:modification times are not updated separately.  The test will fail
> F:on HFS+ (Apple Mac OS X default) filesystems because access times
> F:are not recorded.  Also, Linux ext3 filesystems may be mounted
> F:with the noatime option which does not update access times.
> F:Failures in these cases do not indicate a problem in the shell.
>
>   [[ newnewnew -nt zerolength && ! (unmodified -nt zerolength) ]]
> 0:-nt cond


If this is on NFS (which it is in my build environment) the
file 'newnewnew' is not generated and the following tests fail
instead of being skipped on NFS.


Best regards

   -- Dagobert

