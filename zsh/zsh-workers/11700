From zsh-workers-return-11700-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 01 03:27:58 2000
Return-Path: <zsh-workers-return-11700-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3646 invoked from network); 1 Jun 2000 03:27:56 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 1 Jun 2000 03:27:56 -0000
Received: (qmail 27126 invoked by alias); 1 Jun 2000 03:27:21 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11700
Received: (qmail 27115 invoked from network); 1 Jun 2000 03:27:18 -0000
Message-ID: <20000601032714.13056.qmail@web1303.mail.yahoo.com>
Date: Wed, 31 May 2000 20:27:14 -0700 (PDT)
From: Felix Rosencrantz <f_rosencrantz@yahoo.com>
Subject: PATCH: Memorey leak with PS4 usage.
To: zsh-workers <zsh-workers@sunsite.auc.dk>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="0-846930886-959830034=:12923"

--0-846930886-959830034=:12923
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

There seems to be a memory leak issue with the use of promptexpand.
I've included a patch for utils.c.

I think there are additional problems with promptexpand's use in subst.c, which
I'll leave for someone who understands the code better.

-FR


__________________________________________________
Do You Yahoo!?
Send instant messages & get email alerts with Yahoo! Messenger.
http://im.yahoo.com/
--0-846930886-959830034=:12923
Content-Type: text/plain; name="patch5.txt"
Content-Description: patch5.txt
Content-Disposition: inline; filename="patch5.txt"

Index: Src/utils.c
===================================================================
--- zsh/Src/outils.c	Sat May 20 08:56:03 2000
+++ zsh/Src/utils.c	Wed May 31 20:12:20 2000
@@ -807,6 +807,7 @@
 	opts[XTRACE] = t;
 
 	fprintf(xtrerr, "%s", s);
+	free(s);
     }
 }
 

--0-846930886-959830034=:12923--

