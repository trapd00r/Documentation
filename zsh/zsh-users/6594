From zsh-users-return-6594-mason-zsh=primenet.com.au@sunsite.dk Wed Sep 17 12:51:37 2003
Return-Path: <zsh-users-return-6594-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13616 invoked from network); 17 Sep 2003 12:51:36 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 17 Sep 2003 12:51:36 -0000
Received: (qmail 10722 invoked by alias); 17 Sep 2003 12:51:22 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 6594
Received: (qmail 10712 invoked from network); 17 Sep 2003 12:51:22 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 17 Sep 2003 12:51:22 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [212.227.126.201] by sunsite.dk (MessageWall 1.0.8) with SMTP; 17 Sep 2003 12:51:21 -0000
Received: from [172.17.36.7] (helo=erdbeere.use.schlund.de)
	by mxintern.kundenserver.de with esmtp (Exim 3.35 #1)
	id 19zbmD-0003Gb-00
	for zsh-users@sunsite.dk; Wed, 17 Sep 2003 14:51:21 +0200
Received: from luthien by erdbeere.use.schlund.de with local
	id 19zbnK-0002Av-00
	for <zsh-users@sunsite.dk>; Wed, 17 Sep 2003 14:52:30 +0200
Date: Wed, 17 Sep 2003 14:52:30 +0200
From: Dominik Vogt <zsh-users@sunsite.dk>
To: Zsh Users <zsh-users@sunsite.dk>
Subject: Re: security risk in source builtin?
Message-ID: <20030917125230.GA3539@gmx.de>
Reply-To: zsh-users@sunsite.dk
Mail-Followup-To: Zsh Users <zsh-users@sunsite.dk>
References: <20030916145820.GC4583@gmx.de> <20030917102420.GA2522@mail.guild.uwa.edu.au> <20030917110731.GA535@gmx.de> <20030917114853.GB5827@mail.guild.uwa.edu.au>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20030917114853.GB5827@mail.guild.uwa.edu.au>
User-Agent: Mutt/1.3.28i

On Wed, Sep 17, 2003 at 07:48:53PM +0800, James Devenish wrote:
> In message <20030917110731.GA535@gmx.de>
> on Wed, Sep 17, 2003 at 01:07:31PM +0200, Dominik Vogt wrote:
> > > >   $ source test
> > > >   /usr/bin/test:3: bad pattern: ^@^F^@(...
> [...]
> > To the casual user, it is not obvious why the $PATH should be
> > searched.  After all, scripts read with "source" or "." should
> > usually not be executable, so they do not belong into any
> > directory in the $PATH.
> [...]
> > At the very least, I
> > think "source" and "." should not attempt to read files in the
> > $PATH that are not executable.  Of course this is only my mersonal
> 
> As you mentioned, the . command is provided by the POSIX shell. I would
> expect that changing its behaviour would cause existing scripts to fail,
> as well as affecting portability. I think that it is bad to be scripting
> with ". test" if you desire the semantics of ". ./test" (in the case
> that you use "./test", $path will not be searched). You are right that
> it is a "trap" to fall into, but there is a definite difference between
> ". test" and ". ./test" and it is probably more important that authors
> code carefully (as always applies to coding).

Okay, this is what POSIX says for ".":

  If file does not contain a slash, the shell shall use the search
  path specified by PATH to find the directory containing file.
  Unlike normal command search, however, the file searched for by
  the dot utility need not be executable.

which is implemented correctly in zsh, but not in bash (who cares
;-) ) or pdksh.  I.e. zsh looks in the $PATH only while bash tries
. if $PATH fails.  "source" is not part of POSIX.  So it seems the
security problem is in the POSIX spec itself :-P

Ciao

Dominik ^_^  ^_^

