From zsh-workers-return-22492-mason-zsh=primenet.com.au@sunsite.dk Wed Jun 14 04:20:38 2006
Return-Path: <zsh-workers-return-22492-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4373 invoked from network); 14 Jun 2006 04:20:36 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.3 (2006-06-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 14 Jun 2006 04:20:36 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 1225 invoked from network); 14 Jun 2006 04:20:30 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 14 Jun 2006 04:20:30 -0000
Received: (qmail 15242 invoked by alias); 14 Jun 2006 04:20:26 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22492
Received: (qmail 15232 invoked from network); 14 Jun 2006 04:20:25 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 14 Jun 2006 04:20:25 -0000
Received: (qmail 724 invoked from network); 14 Jun 2006 04:20:25 -0000
Received: from vms042pub.verizon.net (206.46.252.42)
  by a.mx.sunsite.dk with SMTP; 14 Jun 2006 04:20:24 -0000
Received: from torch.brasslantern.com ([71.116.105.50])
 by vms042.mailsrvcs.net (Sun Java System Messaging Server 6.2-4.02 (built Sep
 9 2005)) with ESMTPA id <0J0U0036X1DVI4H8@vms042.mailsrvcs.net> for
 zsh-workers@sunsite.dk; Tue, 13 Jun 2006 23:20:20 -0500 (CDT)
Received: from torch.brasslantern.com (localhost.localdomain [127.0.0.1])
	by torch.brasslantern.com (8.13.1/8.13.1) with ESMTP id k5E4KJRK027092	for
 <zsh-workers@sunsite.dk>; Tue, 13 Jun 2006 21:20:19 -0700
Received: (from schaefer@localhost)	by torch.brasslantern.com
 (8.13.1/8.13.1/Submit) id k5E4KIGA027091	for zsh-workers@sunsite.dk; Tue,
 13 Jun 2006 21:20:18 -0700
Date: Tue, 13 Jun 2006 21:20:18 -0700
From: Bart Schaefer <schaefer@brasslantern.com>
Subject: Re: Bug in url-quote-magic?
In-reply-to: <060613070829.ZM12175@torch.brasslantern.com>
To: zsh-workers@sunsite.dk
Message-id: <060613212018.ZM27090@torch.brasslantern.com>
MIME-version: 1.0
X-Mailer: OpenZMail Classic (0.9.2 24April2005)
Content-type: text/plain; charset=us-ascii
References: <20060612161052.GG27340@beaver.spamt.net>
	<060613070829.ZM12175@torch.brasslantern.com>
Comments: In reply to Bart Schaefer <schaefer@brasslantern.com>
 "Re: Bug in url-quote-magic?" (Jun 13,  7:08am)

On Jun 13,  7:08am, Bart Schaefer wrote:
} Subject: Re: Bug in url-quote-magic?
}
} On Jun 12,  6:10pm, Ulrich Dangel wrote:
} }
} } while using url-quote-magic i discoverd a strange behaviour.
} } If i enter an url, followed by space, and after that a semicolon, the
} } semicolon is escaped.
} 
} I can see where this might be unexpected, but I'm not sure your fix is
} the right one.  I think it might be preferable to change line 117

This seems to do the trick; let me know.

Index: Functions/Zle/url-quote-magic
===================================================================
--- Functions/Zle/url-quote-magic	14 Feb 2004 19:39:27 -0000
+++ Functions/Zle/url-quote-magic	14 Jun 2006 04:18:31 -0000
@@ -114,7 +114,7 @@
 	if [[ "${(Q)LBUFFER}$KEYS" == "${(Q)lbuf}" ]]
 	then
 	    local -a words
-	    words=("${(@Q)${(q)=LBUFFER}}")
+	    words=("${(@Q)${(z)lbuf}}")
 	    local urlseps urlmetas urlglobbers localschema otherschema
 	    if [[ "$words[-1]" == (#b)([^:]##):* ]]
 	    then

