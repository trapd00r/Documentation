From zsh-workers-return-13297-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Dec 19 12:39:55 2000
Return-Path: <zsh-workers-return-13297-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20587 invoked from network); 19 Dec 2000 12:39:50 -0000
Received: from postoffice.telstra.net (203.50.1.76)
  by ns1.primenet.com.au with SMTP; 19 Dec 2000 12:39:50 -0000
Received: from sunsite.auc.dk (sunsite.dk [130.225.51.30])
	by postoffice.telstra.net (8.9.3/8.9.3) with SMTP id XAA96689
	for <mason-zsh@primenet.com.au>; Tue, 19 Dec 2000 23:39:02 +1100 (EST)
	(envelope-from zsh-workers-return-13297-mason-zsh=primenet.com.au@sunsite.auc.dk)
Received: (qmail 4496 invoked by alias); 19 Dec 2000 12:36:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 13297
Received: (qmail 4489 invoked from network); 19 Dec 2000 12:36:55 -0000
Message-ID: <Bc0a8890c5093d430a7@mailsweeper01.cambridgesiliconradio.com>
To: zsh-workers@sunsite.auc.dk (Zsh hackers list)
Subject: Re: bug with for and |& 
In-Reply-To: Your message of "Tue, 19 Dec 2000 10:33:56 GMT."
             <Bc0a8890c50936400e1@mailsweeper01.cambridgesiliconradio.com> 
Date: Tue, 19 Dec 2000 12:36:28 +0000
From: Peter Stephenson <pws@csr.com>

The problem is general to cases where a current-shell construct on the left
of the pipeline contains an external command.  It doesn't matter what's on
the right of the pipeline.  The code on the left seems to be executing all
right.

% exec 3>&2
% { ls; print Finished >&3 } |& cat
Finished

and it hangs in zwaitjobs, waiting for the job to finish, which it never
does.  Change `ls' to `print foo' and the problem goes away.

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
Cambridge Silicon Radio, Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070

