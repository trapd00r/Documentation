From zsh-workers-return-18365-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 19 08:30:52 2003
Return-Path: <zsh-workers-return-18365-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1386 invoked from network); 19 Mar 2003 08:30:52 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 19 Mar 2003 08:30:52 -0000
Received: (qmail 25130 invoked by alias); 19 Mar 2003 08:30:44 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18365
Received: (qmail 25118 invoked from network); 19 Mar 2003 08:30:44 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 19 Mar 2003 08:30:44 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [80.91.224.249] by sunsite.dk (MessageWall 1.0.8) with SMTP; 19 Mar 2003 8:30:44 -0000
Received: from root by main.gmane.org with local (Exim 3.35 #1 (Debian))
	id 18vYxn-00071D-00
	for <zsh-workers@sunsite.dk>; Wed, 19 Mar 2003 09:30:19 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: zsh-workers@sunsite.dk
Received: from news by main.gmane.org with local (Exim 3.35 #1 (Debian))
	id 18vWss-0001bU-00
	for <gmane-comp-shells-zsh-devel@m.gmane.org>; Wed, 19 Mar 2003 07:17:06 +0100
From: Miciah Dashiel Butler Masters <miciah@myrealbox.com>
Subject: Crash with 'print -s' with no further arguments
Date: Wed, 19 Mar 2003 06:17:06 +0000 (UTC)
Lines: 33
Message-ID: <b59211$60n$1@main.gmane.org>
X-Complaints-To: usenet@main.gmane.org
User-Agent: slrn/0.9.7.4 (Linux)
Sender: news <news@main.gmane.org>

When I execute 'print -s' with no further arguments twice -- not
necessarily successively -- then ZSH segfaults.

I run Debian's zsh 4.0.6-28 package (libc6 2.3.1-14 and libncurses5
5.3.20021109-2).

This bug seems similar to, but apparently not the same as, a bug
reported in zsh-workers/15085 which Bart Schaefer reports fixed in a
follow-up.  The difference is that that bug triggers when the next
command after 'print -s' is executed, whereas this bug I'm reporting
triggers when 'print -s' is executed a second time.  Another slightly
similar bug is zsh-workers/4073.  I found no others.

Backtrace, FWIW:

#0  0x400fa299 in free () from /lib/libc.so.6
#1  0x08069d08 in freehistdata ()
#2  0x08069cd6 in freehistnode ()
#3  0x080589a3 in bin_print ()
#4  0x08051a34 in execbuiltin ()
#5  0x0805ffe7 in execsubst ()
#6  0x0805eb3b in execlist ()
#7  0x0805e121 in execlist ()
#8  0x0805dea7 in execlist ()
#9  0x0805da1f in execode ()
#10 0x0806e2a6 in loop ()
#11 0x08070770 in zsh_main ()
#12 0x08051477 in main ()
#13 0x400a6a51 in __libc_start_main () from /lib/libc.so.6

Thanks,

 -- Miciah <miciah@myrealbox.com>

