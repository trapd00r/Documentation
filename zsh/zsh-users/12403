From zsh-users-return-12403-mason-zsh=primenet.com.au@sunsite.dk Wed Jan 09 09:59:12 2008
Return-Path: <zsh-users-return-12403-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2541 invoked from network); 9 Jan 2008 09:59:02 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 9 Jan 2008 09:59:02 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 82988 invoked from network); 9 Jan 2008 09:58:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 9 Jan 2008 09:58:49 -0000
Received: (qmail 25690 invoked by alias); 9 Jan 2008 09:58:38 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12403
Received: (qmail 25675 invoked from network); 9 Jan 2008 09:58:38 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 9 Jan 2008 09:58:38 -0000
Received: from virusfilter.dotsrc.org (bifrost [127.0.0.1])
	by spamfilter.dotsrc.org (Postfix) with ESMTP id 746088058FF2
	for <zsh-users@sunsite.dk>; Wed,  9 Jan 2008 10:58:35 +0100 (CET)
Received: from atom.smasher.org (atom.smasher.org [69.55.237.145])
	by bifrost.dotsrc.org (Postfix) with SMTP
	for <zsh-users@sunsite.dk>; Wed,  9 Jan 2008 10:58:34 +0100 (CET)
Received: (qmail 49228 invoked by uid 1000); 9 Jan 2008 09:13:35 -0000
Message-ID: <20080109091335.49226.qmail@smasher.org>
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
Date: Wed, 9 Jan 2008 22:13:32 +1300 (NZDT)
From: Atom Smasher <atom@smasher.org>
MIME-Version: 1.0
OpenPGP: id=0xB88D52E4D9F57808; algo=1 (RSA); size=4096; url=http://atom.smasher.org/pgp.txt
Subject: [ -f glob ]
To: zsh-users@sunsite.dk
X-POM: The Moon is Waxing Crescent (1% of Full)
X-Hashcash: 1:20:0801090913:zsh-users@sunsite.dk::MjFYMmNjxy236gdx:0000000000000
	000000000000000000000000DP8f
X-Virus-Scanned: ClamAV using ClamSMTP

here's a weird one...

this is part of a sanity test on line 369 of my zshrc (link below):
     [ -f /usr/{share,lib,share/lib}/{zoneinfo,locale/TZ}/${TZ} ]

here it works:	  zsh 4.2.1 (i386-portbld-freebsd4.7)
here it doesn't:  zsh 4.2.1 (sparc-sun-solaris2.10)

on _both_ systems, the command below will show errors for non-existent 
files (to stderr), and will show that a tz-file exists (to stdout). on 
both systems the command returns >0.
  % ls -l  /usr/{share,lib,share/lib}/{zoneinfo,locale/TZ}/${TZ}

this works on both bsd and solaris:
  % ls /usr/{share,lib,share/lib}/{zoneinfo,locale/TZ}/${TZ} 2> /dev/null | grep -q $TZ

i can use the return status from grep to determine if the file exists. but 
i'd prefer to keep this in zsh, as much as possible. i suppose i could 
assign stdout to a variable, test for the variable, and do it that way... 
but it seems a bit convoluted.

1) why does this behave differently with two different builds of 
zsh-4.2.1? has it likely been fixed since 4.2.1?

2) is there a simple fix? or simple workaround?

my zshrc is v0.119 - http://smasher.org/zsh/


-- 
         ...atom

  ________________________
  http://atom.smasher.org/
  762A 3B98 A3C3 96C9 C6B7 582A B88D 52E4 D9F5 7808
  -------------------------------------------------

 	"The capitalists owned everything in the world, and everyone
 	 else was their slave. They owned all the land, all the
 	 houses, all the factories, and all the money. If anyone
 	 disobeyed them they could throw him into prison, or they
 	 could take his job away and starve him to death. When any
 	 ordinary person spoke to a capitalist he had to cringe and
 	 bow to him, and take off his cap and address him as 'Sir'"
 		-- George Orwell

