From zsh-workers-return-4972-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Jan 25 09:57:46 1999
Return-Path: <zsh-workers-return-4972-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8455 invoked from network); 25 Jan 1999 09:57:45 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Jan 1999 09:57:45 -0000
Received: (qmail 14461 invoked by alias); 25 Jan 1999 09:36:28 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 4972
Received: (qmail 14450 invoked from network); 25 Jan 1999 09:36:27 -0000
Resent-Date: Mon, 25 Jan 1999 04:36:43 -0500 (EST)
From: "Andrej Borsenkow" <borsenkow.msk@sni.de>
To: "Peter Stephenson" <pws@ibmth.df.unipi.it>,
        "Zsh hackers list" <zsh-workers@math.gatech.edu>
Subject: RE: zsh-3.1.5-pws-5 available
Date: Sun, 24 Jan 1999 15:50:16 +0300
Message-ID: <000501be4798$1753c6c0$21c9ca95@mowp.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook 8.5, Build 4.71.2377.0
In-Reply-To: <9901231125.AA13246@ibmth.df.unipi.it>
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.0810.800
Importance: Normal
Resent-Message-ID: <"c7Txg3.0.zZ3.hi3hs"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4966
X-Loop: zsh-workers@math.gatech.edu
Resent-Sender: zsh-workers-request@math.gatech.edu


The patch below makes it possible to compile ZSH dynamic on ReliantUNIX. It
avoids building shared lib by exporting executables symbols.

I don't claim, that it works on all versions. It should work on 5.43 and
above, that are current.

Question:

   sysv4*|esix*) DLLDFLAGS="${DLLDFLAGS=-G $ldflags}" ;;
                                            ^^^^^^^^

ldflags does not appear to be used (or set) anywhere else. What is the point
of it? Also, as I noted, configure seems to ignore values of CPPFLAGS and
LDFLAGS. Is it intentional?

/andrej

--- zsh-3.1.5-pws-5/configure.in.org    Thu Jan 21 12:02:34 1999
+++ zsh-3.1.5-pws-5/configure.in        Sun Jan 24 15:38:01 1999
@@ -1008,9 +1008,10 @@
     aix*)         DLLDFLAGS="${DLLDFLAGS=-G -bexpall -lc}" ;;
     solaris*|sysv4*|esix*) DLLDFLAGS="${DLLDFLAGS=-G}" ;;
   esac
-  case "$host_os" in
-    hpux*)  EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-Wl,-E}" ;;
-    linux*) EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-rdynamic}" ;;
+  case "$host" in
+    *-hpux*)  EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-Wl,-E}" ;;
+    *-linux*) EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-rdynamic}" ;;
+    mips-sni-sysv4) EXTRA_LDFLAGS="${EXTRA_LDFLAGS=-Wl,-Blargedynsym}" ;;
   esac
   AC_CACHE_CHECK(if your dlsym() needs a leading underscore,
    zsh_cv_func_dlsym_needs_underscore,

