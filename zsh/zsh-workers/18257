From zsh-workers-return-18257-mason-zsh=primenet.com.au@sunsite.dk Tue Feb 18 10:31:51 2003
Return-Path: <zsh-workers-return-18257-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8615 invoked from network); 18 Feb 2003 10:31:49 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 18 Feb 2003 10:31:49 -0000
Received: (qmail 863 invoked by alias); 18 Feb 2003 10:31:38 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 18257
Received: (qmail 854 invoked from network); 18 Feb 2003 10:31:38 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 18 Feb 2003 10:31:38 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [193.109.254.147] by sunsite.dk (MessageWall 1.0.8) with SMTP; 18 Feb 2003 10:31:36 -0000
X-VirusChecked: Checked
X-Env-Sender: kiddleo@logica.com
X-Msg-Ref: server-2.tower-27.messagelabs.com!1045564298!1774
Received: (qmail 15942 invoked from network); 18 Feb 2003 10:31:38 -0000
Received: from iris.logica.co.uk (158.234.9.163)
  by server-2.tower-27.messagelabs.com with SMTP; 18 Feb 2003 10:31:38 -0000
Received: from finches.logica.co.uk ([158.234.142.11])
	by iris.logica.co.uk (8.9.3/8.9.3/Debian 8.9.3-21) with ESMTP id KAA13237;
	Tue, 18 Feb 2003 10:31:31 GMT
X-Authentication-Warning: iris.logica.co.uk: Host [158.234.142.11] claimed to be finches.logica.co.uk
Received: from finches.logica.co.uk (localhost [127.0.0.1])
	by finches.logica.co.uk (8.11.6/8.11.6/SuSE Linux 0.5) with ESMTP id h1IAZ1g01585;
	Tue, 18 Feb 2003 11:35:01 +0100
cc: zsh-workers@sunsite.dk
In-reply-to: <20030218061442.GA17147@localhost.localdomain>
From: Oliver Kiddle <okiddle@yahoo.co.uk>
References: <20030218061442.GA17147@localhost.localdomain>
To: Doug Kearns <djkea2@mugca.its.monash.edu.au>
Subject: Re: PATCH: xmllint completion
Date: Tue, 18 Feb 2003 11:35:00 +0100
Message-ID: <1583.1045564500@finches.logica.co.uk>
Sender: kiddleo@logica.com

On 18 Feb, Doug Kearns wrote:
> 
> Here's a new completion function for xmllint which comes with the
> libxml2 library - http://xmlsoft.org/

Thanks, I've added this. We should perhaps clump it together with
_xsltproc in an _xmlsoft (any views?). An xmlcatalog completion if/when
written could go in there too.

On 4.1 only, I'll apply the following patch on top of it. It just makes
it call _webbrowser (formerly would have been _urls -f; see 16323)
instead of repeating the content of _webbrowser in a state. 16323 is not
on 4.0 so I'll just add in the missing `local state line
curcontext="$curcontext"' and _arguments -C for 4.0.

Oliver

Index: _xmllint
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_xmllint,v
retrieving revision 1.1
diff -u -r1.1 _xmllint
--- _xmllint	18 Feb 2003 10:02:55 -0000	1.1
+++ _xmllint	18 Feb 2003 10:09:15 -0000
@@ -35,7 +35,7 @@
   '--nowrap[do not put HTML doc wrapper]' \
   '--valid[validate the document in addition to std well-formed check]' \
   '(--dtdvalid --relaxng)--postvalid[do a posteriori validation, i.e after parsing]' \
-  '(--postvalid --relaxng)--dtdvalid[do a posteriori validation against a given DTD]:DTD:->url' \
+  '(--postvalid --relaxng)--dtdvalid[do a posteriori validation against a given DTD]:DTD:_webbrowser' \
   '--timing[print some timings]' \
   '(--noout --output -o)'{--output,-o}'[save to a given file]:output file:_files' \
   '--repeat[repeat 100 times, for timing or profiling]' \
@@ -59,13 +59,5 @@
   '--dropdtd[remove the DOCTYPE of the input docs]' \
   '--stream[use the streaming interface to process very large files]' \
   '--chkregister[verify the node registration code]' \
-  '(--dtdvalid --postvalid)--relaxng[do RelaxNG validation against the schema]:schema:->url' \
-  '*:XML file:->url' && return
-
-if [[ "$state" = url ]]; then
-  _alternative \
-    'files:file:_files' \
-    'urls:url:_urls' && return
-fi
-
-return 1
+  '(--dtdvalid --postvalid)--relaxng[do RelaxNG validation against the schema]:schema:_webbrowser' \
+  '*:XML file:_webbrowser'

This e-mail and any attachment is for authorised use by the intended recipient(s) only.  It may contain proprietary material, confidential information and/or be subject to legal privilege.  It should not be copied, disclosed to, retained or used by, any other party.  If you are not an intended recipient then please promptly delete this e-mail and any attachment and all copies and inform the sender.  Thank you.

