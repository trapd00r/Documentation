From zsh-workers-return-19781-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 15 17:04:07 2004
Return-Path: <zsh-workers-return-19781-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 20953 invoked from network); 15 Apr 2004 17:04:06 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 15 Apr 2004 17:04:06 -0000
Received: (qmail 2845 invoked by alias); 15 Apr 2004 17:03:57 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19781
Received: (qmail 2834 invoked from network); 15 Apr 2004 17:03:56 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 15 Apr 2004 17:03:56 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 15 Apr 2004 17:3:55 -0000
Received: (qmail 22730 invoked from network); 15 Apr 2004 17:03:55 -0000
Received: from ip-66-80-62-153.dsl.sca.megapath.net (HELO ripple.fruitbat.org) (66.80.62.153)
  by a.mx.sunsite.dk with SMTP; 15 Apr 2004 17:03:54 -0000
Received: (from daemon@localhost)
	by ripple.fruitbat.org (8.10.2/8.8.8/PAC-1.3) id i3FH1F507688;
	Thu, 15 Apr 2004 10:01:15 -0700
Received: from ming.fruitbat.org(192.168.1.2) by ripple.fruitbat.org via smap (V2.1/2.1+anti-relay+anti-spam)
	id xma007686; Thu, 15 Apr 04 10:00:31 -0700
Received: from gremlin.fruitbat.org (IDENT:202@gremlin.fruitbat.org [192.168.1.4])
	by ming.fruitbat.org (8.10.2/8.10.2/PAC-1.6) with ESMTP id i3FHvMi10765;
	Thu, 15 Apr 2004 10:57:22 -0700
Date: Thu, 15 Apr 2004 09:57:28 -0700 (PDT)
From: "Peter A. Castro" <doctor@fruitbat.org>
To: Clint Adams <clint@zsh.org>
cc: zsh-workers@sunsite.dk
Subject: Re: zsh and line breaks
In-Reply-To: <20040415103541.GA9060@scowler.net>
Message-ID: <Pine.LNX.4.53.0404150916160.1010@gremlin.fruitbat.org>
References: <29767.1081186817@csr.com> <Pine.LNX.4.53.0404051424500.11532@gremlin.fruitbat.org>
 <20040415050315.GA26270@scowler.net> <Pine.LNX.4.53.0404142318450.1010@gremlin.fruitbat.org>
 <20040415103541.GA9060@scowler.net>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: 
X-Spam-Status: No, hits=0.0 required=6.0 tests=none autolearn=no version=2.63
X-Spam-Hits: 0.0

On Thu, 15 Apr 2004, Clint Adams wrote:

> > The use of the shell wildcard (zsh*.html) makes the shell do a pattern
> > match against the list of files in the directory in which it is run.  If
> > I was building from a work directory (say zsh-4.2.0/.build/Doc) and
> > installing into a destination root other that "/" (say zsh-4.2.0/.inst)
> > make executes this bit of shell code and it fails to find any zsh*.html
> > files because make isn't currently in that directory (it's in
> > .build/Doc).  Prepending ${sdir} ensures the zsh*.html files are
>
> Yes, and the html files are generated in the build directory, so it
> won't find them in ${sdir}.

Ah!  Now I see what's going on.  I've been applying the -doc tar over the
source directory which gives me the .html files in the source dir and not
in the build dir, and since they are the same date or newer as the
zsh.texi source, no processing of it into html is done.  Hmmm... Ok, this
is will break a full build (sans -doc), I see that now.  So, you are
correct, the ${sdir} reference should be removed.  Sorry!  And, thanks
for pointing it out!

I'll have to decide what I want to do for the Cygwin port, but certainly
this should be corrected in cvs.  So, what's the procedure?  Do I need to
submit a patch to undo my original patch or can someone with cvs access
(Peter S?) simply back that part of the patch out?

> > So how, exactly, does this break VPATH?  Can you give me an example?
> > I'll try and correct it, but I don't yet see how it's broken.
>
> Is Cygwin texi2html outputting to your source directory?

Well, this has been part of the problem.  See texi2html is "back-level"
for cygwin, so I end up having to change the makefile to specify
different options for texi2html to actually work.  I'd gotten around that
by just overlaying the -doc tar (plus it was faster than regenerating
it), but I completely forgot about the fact that the man and html files
are generated and should rightly be created in the build dir, not the
source dir.  I'll update my build process for Cygwin to do the right
thing.  In the mean time, that change in cvs should be backed out.

-- 
Peter A. Castro <doctor@fruitbat.org> or <Peter.Castro@oracle.com>
	"Cats are just autistic Dogs" -- Dr. Tony Attwood

