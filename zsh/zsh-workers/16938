From zsh-workers-return-16938-mason-zsh=primenet.com.au@sunsite.dk Fri Apr 05 02:49:05 2002
Return-Path: <zsh-workers-return-16938-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6517 invoked from network); 5 Apr 2002 02:49:05 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 5 Apr 2002 02:49:05 -0000
Received: (qmail 14970 invoked by alias); 5 Apr 2002 02:48:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16938
Received: (qmail 14958 invoked from network); 5 Apr 2002 02:48:56 -0000
Date: Fri, 5 Apr 2002 12:48:50 +1000
From: Geoff Wing <gcw@zsh.org>
To: David Rhodus <david@catpa.com>
Cc: Zsh Hackers <zsh-workers@sunsite.dk>
Subject: Re: tgetent on hpux11.0
Message-ID: <20020405024850.GA6289@primenet.com.au>
References: <3CAC7167.791654BA@catpa.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <3CAC7167.791654BA@catpa.com>
User-Agent: Mutt/1.3.28i
Organization: PrimeNet Computer Consultancy

David Rhodus <david@catpa.com> typed:
:The tgetent function was erroring out and not loading and termcaps.
:Here is some code I hacked up to get zsh working right on hpux11.0
:Is this a know bug is some versions of hpux?

Thanks for the file.  In future, please send a diff to make it clear
to people what you've changed and to apply any fixes.  Also, please
tell us which version of zsh you're using.  It seems you're using
zsh-4.0.4.   I've put a unified diff from 4.0.4 and your file below.

To zsh-workers: Bart proposed a fix for this in February (workers/16613)
Is this on hold awaiting indication of sufficient testing/feedback?


--- Src/init.c	Tue Oct 23 17:30:51 2001
+++ /tmp/z1	Fri Apr  5 12:41:19 2002
@@ -35,6 +35,7 @@
 #include "init.pro"
 
 #include "version.h"
+#include <curses.h>
 
 /**/
 int noexitct = 0;
@@ -535,9 +536,9 @@
 
 #ifdef TGETENT_ACCEPTS_NULL
     /* If possible, we let tgetent allocate its own termcap buffer */
-    if (tgetent(NULL, term) != 1) {
+    if (tgetent(NULL, term) != OK) {
 #else
-    if (tgetent(termbuf, term) != 1) {
+    if (tgetent(termbuf, term) != OK) {
 #endif
 
 	if (isset(INTERACTIVE))


Regards,
-- 
Geoff Wing : <gcw@pobox.com>
Rxvt Stuff : <gcw@rxvt.org>
Zsh Stuff  : <gcw@zsh.org>

