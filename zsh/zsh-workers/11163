From zsh-workers-return-11163-mason-zsh=primenet.com.au@sunsite.auc.dk Thu May 04 17:39:23 2000
Return-Path: <zsh-workers-return-11163-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7044 invoked from network); 4 May 2000 17:39:22 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 4 May 2000 17:39:22 -0000
Received: (qmail 20863 invoked by alias); 4 May 2000 17:39:16 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11163
Received: (qmail 20839 invoked from network); 4 May 2000 17:39:14 -0000
From: "Bart Schaefer" <schaefer@candle.brasslantern.com>
Message-Id: <1000504173903.ZM28133@candle.brasslantern.com>
Date: Thu, 4 May 2000 17:39:03 +0000
In-Reply-To: <200005041534.RAA12349@beta.informatik.hu-berlin.de>
Comments: In reply to Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
        "Re: PATCH: Re: History bug (Re: Completion debugging)" (May  4,  5:34pm)
References: <200005041534.RAA12349@beta.informatik.hu-berlin.de>
X-Mailer: Z-Mail (5.0.0 30July97)
To: zsh-workers@sunsite.auc.dk
Subject: Re: PATCH: Re: History bug (Re: Completion debugging)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On May 4,  5:34pm, Sven Wischnowsky wrote:
} Subject: Re: PATCH: Re: History bug (Re: Completion debugging)
}
} There is so much mucking around curhist (and histline) in zle that I
} wonder if there is a clean way (other than changing the meaning of
} curhist in the core and then adapting zle).

Cf. "The one icky bit" in my "Dear old literal history" message.

} Maybe we should just make `print -s' put the strings added while zle
} is active into some list and then add those strings only after zle is
} left? I.e. in a toplevel-loop() or somewhere around that.

That's approximately what "print -z" does.  At least for _complete_debug,
the whole point is to get them into the history while you can still scroll
around and look at them.

Unfortunately that means either putting them into the future history or
changing the event number of the current command.  Neither works, at
least not easily, because the history is now stored as a ring rather
than as a simple linked list.  Wayne, are you out there?

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

