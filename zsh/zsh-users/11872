From zsh-users-return-11872-mason-zsh=primenet.com.au@sunsite.dk Mon Sep 24 05:05:18 2007
Return-Path: <zsh-users-return-11872-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 23659 invoked from network); 24 Sep 2007 05:05:17 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 24 Sep 2007 05:05:17 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 46516 invoked from network); 24 Sep 2007 05:05:10 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 24 Sep 2007 05:05:10 -0000
Received: (qmail 14604 invoked by alias); 24 Sep 2007 05:04:58 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11872
Received: (qmail 14589 invoked from network); 24 Sep 2007 05:04:57 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 24 Sep 2007 05:04:57 -0000
Received: (qmail 44859 invoked from network); 24 Sep 2007 05:04:57 -0000
Received: from lorien.comfychair.org (64.81.241.43)
  by a.mx.sunsite.dk with SMTP; 24 Sep 2007 05:04:53 -0000
Received: from lorien.comfychair.org (localhost [127.0.0.1])
	by lorien.comfychair.org (8.13.7/8.13.7) with ESMTP id l8O54pTI008599
	for <zsh-users@sunsite.dk>; Sun, 23 Sep 2007 22:04:51 -0700
Received: (from duvall@localhost)
	by lorien.comfychair.org (8.13.7/8.13.7/Submit) id l8O54o80008598
	for zsh-users@sunsite.dk; Sun, 23 Sep 2007 22:04:51 -0700
Date: Sun, 23 Sep 2007 22:04:50 -0700
From: Danek Duvall <duvall@comfychair.org>
To: zsh-users@sunsite.dk
Subject: _values and specifying -M to compadd
Message-ID: <20070924050450.GA32335@lorien.comfychair.org>
Mail-Followup-To: Danek Duvall <duvall@comfychair.org>,
	zsh-users@sunsite.dk
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: mutt-ng/devel-r535 (Linux)

I've spent a couple of hours trying to figure out how to do this, but am
stumped.  I'm working on completion for the Solaris command pfexec, one
option of which takes an argument of a fixed set of tokens, separated by
commas, where each token may optionally be prefixed by a "!".

I can do the simple

    _values -s , "descr" $tokens

where $tokens was set earlier to be ( $tokens \!$^tokens ), but that's
cheap, and it doubles the list of tokens, which isn't very nice looking.
I'd like it to just ignore a "!" when it's there, a la setopt's ignoring of
"no", but I can't figure out how to make that work with _values, which
doesn't seem to give an option to pass options (specifically -M) on to
compadd.

Is there some other reasonably simple way of doing this, or will I have to
invoke compadd directly?

Thanks,
Danek

