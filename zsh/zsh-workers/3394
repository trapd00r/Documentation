From zsh-workers-request@euclid.skiles.gatech.edu Wed Jul 30 07:12:36 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 3360 invoked from network); 30 Jul 1997 07:12:34 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 30 Jul 1997 07:12:34 -0000
Received: (from list@localhost)
	by euclid.skiles.gatech.edu (8.8.5/8.8.5) id CAA00335;
	Wed, 30 Jul 1997 02:52:37 -0400 (EDT)
Resent-Date: Wed, 30 Jul 1997 02:52:37 -0400 (EDT)
Message-Id: <199707300652.XAA14604@hiro.zanshin.com>
Date: Tue, 29 Jul 1997 23:52:32 -0700 (PDT)
From: Bart Schaefer <schaefer@zanshin.com>
Reply-To: schaefer@zanshin.com
Subject: zsh 3.0.4 core dump when HISTSIZE exceeded
To: zsh-workers@math.gatech.edu
MIME-Version: 1.0
Content-Type: TEXT/plain; CHARSET=US-ASCII
Resent-Message-ID: <"BDoQU3.0.55.qIktp"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3394
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

With the following options set:

autocd
cdablevars
noclobber
ignoreeof
listtypes

(In addition to the default settings of

interactive
monitor
norcs
shinstdin
zle

for zsh -f)

`zsh -f` will dump core in malloc() shortly after exceeding HISTSIZE
commands.  The stack is completely trashed at this point; even running
inside gdb I was unable to get a backtrace beyond malloc().

I'm not sure exactly which of those options is pertinent; I know only
that I was unable to get `zsh -f` to crash without first setting them,
and that it crashed rapidly after setting HISTSIZE=5 with those options
in effect.  I set those options by copying the $- value of another user
here who has repeatedly encountered this crash (he typically gets it
upon executing his 101st command with HISTSIZE=100; this most recent
time, he mailed me the output of `set`, from which I grabbed $-).

SAVEHIST is not set.  I tend to suspect ignoreeof, but I'm not sure why.

-- 
Bart Schaefer                                                   Zanshin
http://www.well.com/user/barts                   http://www.zanshin.com

