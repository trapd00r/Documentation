From zsh-workers-return-22880-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 17 19:06:16 2006
Return-Path: <zsh-workers-return-22880-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28366 invoked from network); 17 Oct 2006 19:06:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.6 (2006-10-03) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.1 required=5.0 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO autolearn=ham version=3.1.6
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 Oct 2006 19:06:09 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 5618 invoked from network); 17 Oct 2006 19:05:59 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 Oct 2006 19:05:59 -0000
Received: (qmail 17120 invoked by alias); 17 Oct 2006 19:05:56 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 22880
Received: (qmail 17108 invoked from network); 17 Oct 2006 19:05:56 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 17 Oct 2006 19:05:56 -0000
Received: (qmail 5322 invoked from network); 17 Oct 2006 19:05:55 -0000
Received: from master.altlinux.org (62.118.250.235)
  by a.mx.sunsite.dk with SMTP; 17 Oct 2006 19:05:46 -0000
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by master.altlinux.org (Postfix) with ESMTP id 7BE77E363B
	for <zsh-workers@sunsite.dk>; Tue, 17 Oct 2006 23:05:43 +0400 (MSD)
Received: by localhost.localdomain (Postfix, from userid 500)
	id 5122C35A7F5; Tue, 17 Oct 2006 23:05:46 +0400 (MSD)
Date: Tue, 17 Oct 2006 23:05:46 +0400
From: Alexey Tourbin <at@altlinux.ru>
To: zsh-workers@sunsite.dk
Subject: Re: compaudit problem
Message-ID: <20061017190546.GB11317@localhost.localdomain>
Mail-Followup-To: zsh-workers@sunsite.dk
References: <20060819115030.GE25959@localhost.localdomain> <060819103035.ZM28413@torch.brasslantern.com>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="TiqCXmo5T1hvSQQg"
Content-Disposition: inline
In-Reply-To: <060819103035.ZM28413@torch.brasslantern.com>


--TiqCXmo5T1hvSQQg
Content-Type: multipart/mixed; boundary="7iMSBzlTiPOCCT2k"
Content-Disposition: inline


--7iMSBzlTiPOCCT2k
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Sat, Aug 19, 2006 at 10:30:33AM -0700, Bart Schaefer wrote:
> I can't reproduce any of these with my build of 08/17 sources from CVS.
> I've tried compiling both with and without multibyte support.  I've even
> tried forcing Test/D07multibyte.ztst to use ru_RU.UTF-8 as $LANG when
> running "make check".
>=20
> Does anything change if you run "zsh -o posix_identifiers"?  Have you
> tried building with "configure --disable-multibyte"?
>=20
> Changes between 06/19 and 07/29 that may have affected this:
>=20
>         * 22518: Src/params.c, Src/utils,c, Src/zsh.h,
>         Test/B02typeset.ztst: Initial go at making parameter subscripts
>         use multibyte characters.
>=20
>         * 22524: Src/params.c, Test/D07multibyte.ztst: searchable
>         subscripts with multibyte characters.
>=20
>         * 22544: README, Doc/Zsh/options.yo, Src/builtin.c, Src/glob.c,
>         Src/lex.c, Src/math.c, Src/module.c, Src/options.c, Src/params.c,
>         Src/parse.c, Src/subst.c, Src/utils.c, Src/zsh.h, Src/ztype.h,
>         Src/Zle/compcore.c, Src/Zle/zle_tricky.c, Test/D07multibyte.ztst:
>         Improve use of ztype tests for multibyte characters.  Add
>         POSIX_IDENTIFIERS option to control allowability of multibyte
>         alphanumeric characters in parameter and module names.
>=20
>         * 22556: Doc/Zsh/builtins.yo, Functions/Zle/insert-composed-char,
>         Src/builtin.c, Src/pattern.c, Src/subst.c, Src/utils.c, Src/zsh.h,
>         Src/ztype.h, Src/Zle/zle.h, Src/Zle/zle_main.c,
>         Test/D04parameter.ztst, Test/D07multibyte.ztst: Multibyte
>         separators and delimiters.
>=20
>         * unposted: Src/pattern.c, Src/utils.c: minor typos in
>         22556 found when MULTIBYTE_SUPPORT is not defined.
>=20
>         * 22557: Doc/Zsh/options.yo, Misc/globtests, Src/options.c,
>         Src/pattern.c, Test/D02glob.ztst, Test/D07multibyte.ztst:
>         Turn on multibyte option by default for MULTIBYTE_SUPPORT and fix
>         tests and patterns.

I can still reproduce this with current cvs snapshot.
I imported cvs sources into git and tried git-bisect.
git-bisect says the problem started with change #22557.

[refs/bisect/bad] [bisect] 22557: turn on multibyte option by default
[refs/bisect/good-b76d3fa3515823810784266bbf0c9cc1c58c504d] fix typos in 22=
556

Build script is attached.

--7iMSBzlTiPOCCT2k
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename=bzsh
Content-Transfer-Encoding: quoted-printable

#!/bin/sh -e
autoreconf -fisv

# Disable libnsl/NIS support.
export ac_cv_search_yp_all=3Dno zsh_cv_sys_nis=3Dno zsh_cv_sys_nis_plus=3Dno

# YODL is not required, pre-generated man pages are shipped.
export YODL=3Dyodl PDFETEX=3Dpdfetex

# Avoid autoconf thinking it should strip when linking.
export LDFLAGS=3D

# Disable sys/capability.h (see #8142).
export ac_cv_header_sys_capability_h=3Dno


  CFLAGS=3D"${CFLAGS:--pipe -Wall -O2 -march=3Dathlon -mtune=3Dathlon-xp}" =
; export CFLAGS ;=20
  CXXFLAGS=3D"${CXXFLAGS:--pipe -Wall -O2 -march=3Dathlon -mtune=3Dathlon-x=
p}" ; export CXXFLAGS ;=20
  FFLAGS=3D"${FFLAGS:--pipe -Wall -O2 -march=3Dathlon -mtune=3Dathlon-xp}" =
; export FFLAGS ;=20
  =20
  =20
  export lt_cv_deplibs_check_method=3Dpass_all ;=20
  [ -f configure.ac -o -f configure.in ] && libtoolize --copy --force ;=20
  ./configure --build=3Dathlon-alt-linux --host=3Dathlon-alt-linux \
 	--prefix=3D/usr \
	--exec-prefix=3D/usr \
	--bindir=3D/usr/bin \
	--sbindir=3D/usr/sbin \
	--sysconfdir=3D/etc \
	--datadir=3D/usr/share \
	--includedir=3D/usr/include \
	--libdir=3D/usr/lib \
	--libexecdir=3D/usr/lib \
	--localstatedir=3D/var/lib \
	--sharedstatedir=3D/usr/com \
	--mandir=3D/usr/share/man \
	--infodir=3D/usr/share/info \
	--disable-dependency-tracking \
	--without-included-gettext \
	--enable-etcdir=3D/etc \
	--enable-fndir=3D/usr/share/zsh \
	--enable-scriptdir=3D/usr/share/zsh/scripts \
	--enable-site-fndir=3D/usr/local/share/zsh \
	--enable-site-scriptdir=3D/usr/local/share/zsh/scripts \
	--enable-function-subdirs \
	--enable-maildir-support \
	--with-curses-terminfo \
	--with-tcsetpgrp \
	--disable-cap \
	--enable-pcre \
	--enable-multibyte \
	 \
	 \
	#

# We don't expect that something is broken.
grep '^#define.*BROKEN' config.h && exit 1

# SMP-incompatible.
make MODDIR=3D/usr/lib
make -C Etc

--7iMSBzlTiPOCCT2k--

--TiqCXmo5T1hvSQQg
Content-Type: application/pgp-signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)

iD8DBQFFNSmKfBKgtDjnu0YRAvrAAKC3ciga930WWpNbkUqcxyD0D7fqmQCg45yT
Ws35Dp37pj1fShq+7T8js4g=
=MLuZ
-----END PGP SIGNATURE-----

--TiqCXmo5T1hvSQQg--

