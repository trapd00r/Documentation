From zsh-workers-return-11812-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Jun 08 04:39:38 2000
Return-Path: <zsh-workers-return-11812-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28092 invoked from network); 8 Jun 2000 04:39:36 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 8 Jun 2000 04:39:36 -0000
Received: (qmail 15748 invoked by alias); 8 Jun 2000 04:39:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11812
Received: (qmail 15740 invoked from network); 8 Jun 2000 04:39:25 -0000
Date: Wed, 7 Jun 2000 00:13:20 -0700
From: Dan Wilder <wilder@eskimo.com>
To: zsh-workers@sunsite.auc.dk
Subject: zsh-3.1.9 compile failure on newer Linux
Message-ID: <20000607001320.A16993@eskimo.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0i

I write to report failure of zsh-3.1.9 to build on Linux with
kernel 2.4-test1, glibc-2.1.2, gcc-2.95.2.  This failure is
redeemed by a simple but heavy-handed hack in config.h.  No
doubt somebody with more finesse than I could make it build
without modification on such a sytem.

The config.h hack is to change

/* #undef HAVE_SYS_RESOURCE_H */

to

#define HAVE_SYS_RESOURCE_H 1

in config.h.

My configure is:

./configure --prefix=

some time after "make" I get:

make[2]: Entering directory `/usr/src/zsh-3.1.9/Src'
gcc -c -I. -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -Wall -Wno-implicit -Wmissing-prototypes -O2  -o builtin.o builtin.c
In file included from zsh.mdh:26,
                 from builtin.c:30:
		 exec.epro:26: `RLIM_NLIMITS' undeclared here (not in a function)
		 exec.epro:27: `RLIM_NLIMITS' undeclared here (not in a function)
		 make[2]: *** [builtin.o] Error 1
		 make[2]: Leaving directory `/usr/src/zsh-3.1.9/Src'
		 make[1]: *** [modobjs] Error 2
		 make[1]: Leaving directory `/usr/src/zsh-3.1.9/Src'
		 make: *** [all] Error 1


>From the current getrlimit manpage, I see:

       #include <sys/time.h>
       #include <sys/resource.h>
       #include <unistd.h>

I see "system.h" includes <sys/time.h> and <unistd.h> but not
<sys/resource.h>.

With the modification, I get a bunch of warnings
about RLIM_INFINITY being redefined, but zsh now compiles.

Thanks for this fine shell ... I may yet succeed in getting
users at Specialized Systems Consultants, publishers of Linux
Journal, to standardize on zsh for all new user shells, and
perhaps even persuade some of the old-line ksh users to come
over!

Output of Util/reporter:

# START zsh saveset
# uname:  Linux klister 2.4.0-test1 #1 Thu Jun 1 05:54:09 PDT 2000 i586 unknown

# Aliases.

alias run-help=man
alias which-command=whence

# Key bindings.

bindkey -N .safe
bindkey -N emacs
bindkey -N main
bindkey -N vicmd
bindkey -N viins

bindkey -R -M .safe "^@"-"^I" self-insert
bindkey -M .safe "^J" accept-line
bindkey -R -M .safe "^K"-"^L" self-insert
bindkey -M .safe "^M" accept-line
bindkey -R -M .safe "^N"-"\M-^?" self-insert

bindkey -M emacs "^@" set-mark-command
bindkey -M emacs "^A" beginning-of-line
bindkey -M emacs "^B" backward-char
bindkey -M emacs "^D" delete-char-or-list
bindkey -M emacs "^E" end-of-line
bindkey -M emacs "^F" forward-char
bindkey -M emacs "^G" send-break
bindkey -M emacs "^H" backward-delete-char
bindkey -M emacs "^I" expand-or-complete
bindkey -M emacs "^J" accept-line
bindkey -M emacs "^K" kill-line
bindkey -M emacs "^L" clear-screen
bindkey -M emacs "^M" accept-line
bindkey -M emacs "^N" down-line-or-history
bindkey -M emacs "^O" accept-line-and-down-history
bindkey -M emacs "^P" up-line-or-history
bindkey -M emacs "^Q" push-line
bindkey -M emacs "^R" history-incremental-search-backward
bindkey -M emacs "^S" history-incremental-search-forward
bindkey -M emacs "^T" transpose-chars
bindkey -M emacs "^U" kill-whole-line
bindkey -M emacs "^V" quoted-insert
bindkey -M emacs "^W" backward-kill-word
bindkey -M emacs "^X^B" vi-match-bracket
bindkey -M emacs "^X^F" vi-find-next-char
bindkey -M emacs "^X^J" vi-join
bindkey -M emacs "^X^K" kill-buffer
bindkey -M emacs "^X^N" infer-next-history
bindkey -M emacs "^X^O" overwrite-mode
bindkey -M emacs "^X^U" undo
bindkey -M emacs "^X^V" vi-cmd-mode
bindkey -M emacs "^X^X" exchange-point-and-mark
bindkey -M emacs "^X*" expand-word
bindkey -M emacs "^X=" what-cursor-position
bindkey -M emacs "^XG" list-expand
bindkey -M emacs "^Xg" list-expand
bindkey -M emacs "^Xr" history-incremental-search-backward
bindkey -M emacs "^Xs" history-incremental-search-forward
bindkey -M emacs "^Xu" undo
bindkey -M emacs "^Y" yank
bindkey -M emacs "^[^D" list-choices
bindkey -M emacs "^[^G" send-break
bindkey -M emacs "^[^H" backward-kill-word
bindkey -M emacs "^[^I" self-insert-unmeta
bindkey -M emacs "^[^J" self-insert-unmeta
bindkey -M emacs "^[^L" clear-screen
bindkey -M emacs "^[^M" self-insert-unmeta
bindkey -M emacs "^[^_" copy-prev-word
bindkey -M emacs "^[ " expand-history
bindkey -M emacs "^[!" expand-history
bindkey -M emacs "^[\"" quote-region
bindkey -M emacs "^[\$" spell-word
bindkey -M emacs "^['" quote-line
bindkey -M emacs "^[-" neg-argument
bindkey -M emacs "^[." insert-last-word
bindkey -M emacs "^[0" digit-argument
bindkey -M emacs "^[1" digit-argument
bindkey -M emacs "^[2" digit-argument
bindkey -M emacs "^[3" digit-argument
bindkey -M emacs "^[4" digit-argument
bindkey -M emacs "^[5" digit-argument
bindkey -M emacs "^[6" digit-argument
bindkey -M emacs "^[7" digit-argument
bindkey -M emacs "^[8" digit-argument
bindkey -M emacs "^[9" digit-argument
bindkey -M emacs "^[<" beginning-of-buffer-or-history
bindkey -M emacs "^[>" end-of-buffer-or-history
bindkey -M emacs "^[?" which-command
bindkey -M emacs "^[A" accept-and-hold
bindkey -M emacs "^[B" backward-word
bindkey -M emacs "^[C" capitalize-word
bindkey -M emacs "^[D" kill-word
bindkey -M emacs "^[F" forward-word
bindkey -M emacs "^[G" get-line
bindkey -M emacs "^[H" run-help
bindkey -M emacs "^[L" down-case-word
bindkey -M emacs "^[N" history-search-forward
bindkey -M emacs "^[OA" up-line-or-history
bindkey -M emacs "^[OB" down-line-or-history
bindkey -M emacs "^[OC" forward-char
bindkey -M emacs "^[OD" backward-char
bindkey -M emacs "^[P" history-search-backward
bindkey -M emacs "^[Q" push-line
bindkey -M emacs "^[S" spell-word
bindkey -M emacs "^[T" transpose-words
bindkey -M emacs "^[U" up-case-word
bindkey -M emacs "^[W" copy-region-as-kill
bindkey -M emacs "^[[A" up-line-or-history
bindkey -M emacs "^[[B" down-line-or-history
bindkey -M emacs "^[[C" forward-char
bindkey -M emacs "^[[D" backward-char
bindkey -M emacs "^[_" insert-last-word
bindkey -M emacs "^[a" accept-and-hold
bindkey -M emacs "^[b" backward-word
bindkey -M emacs "^[c" capitalize-word
bindkey -M emacs "^[d" kill-word
bindkey -M emacs "^[f" forward-word
bindkey -M emacs "^[g" get-line
bindkey -M emacs "^[h" run-help
bindkey -M emacs "^[l" down-case-word
bindkey -M emacs "^[n" history-search-forward
bindkey -M emacs "^[p" history-search-backward
bindkey -M emacs "^[q" push-line
bindkey -M emacs "^[s" spell-word
bindkey -M emacs "^[t" transpose-words
bindkey -M emacs "^[u" up-case-word
bindkey -M emacs "^[w" copy-region-as-kill
bindkey -M emacs "^[x" execute-named-cmd
bindkey -M emacs "^[y" yank-pop
bindkey -M emacs "^[z" execute-last-named-cmd
bindkey -M emacs "^[|" vi-goto-column
bindkey -M emacs "^[^?" backward-kill-word
bindkey -M emacs "^_" undo
bindkey -R -M emacs " "-"~" self-insert
bindkey -M emacs "^?" backward-delete-char
bindkey -R -M emacs "\M-^@"-"\M-^?" self-insert

bindkey "^@" set-mark-command
bindkey "^A" beginning-of-line
bindkey "^B" backward-char
bindkey "^D" delete-char-or-list
bindkey "^E" end-of-line
bindkey "^F" forward-char
bindkey "^G" send-break
bindkey "^H" backward-delete-char
bindkey "^I" expand-or-complete
bindkey "^J" accept-line
bindkey "^K" kill-line
bindkey "^L" clear-screen
bindkey "^M" accept-line
bindkey "^N" down-line-or-history
bindkey "^O" accept-line-and-down-history
bindkey "^P" up-line-or-history
bindkey "^Q" push-line
bindkey "^R" history-incremental-search-backward
bindkey "^S" history-incremental-search-forward
bindkey "^T" transpose-chars
bindkey "^U" kill-whole-line
bindkey "^V" quoted-insert
bindkey "^W" backward-kill-word
bindkey "^X^B" vi-match-bracket
bindkey "^X^F" vi-find-next-char
bindkey "^X^J" vi-join
bindkey "^X^K" kill-buffer
bindkey "^X^N" infer-next-history
bindkey "^X^O" overwrite-mode
bindkey "^X^U" undo
bindkey "^X^V" vi-cmd-mode
bindkey "^X^X" exchange-point-and-mark
bindkey "^X*" expand-word
bindkey "^X=" what-cursor-position
bindkey "^XG" list-expand
bindkey "^Xg" list-expand
bindkey "^Xr" history-incremental-search-backward
bindkey "^Xs" history-incremental-search-forward
bindkey "^Xu" undo
bindkey "^Y" yank
bindkey "^[^D" list-choices
bindkey "^[^G" send-break
bindkey "^[^H" backward-kill-word
bindkey "^[^I" self-insert-unmeta
bindkey "^[^J" self-insert-unmeta
bindkey "^[^L" clear-screen
bindkey "^[^M" self-insert-unmeta
bindkey "^[^_" copy-prev-word
bindkey "^[ " expand-history
bindkey "^[!" expand-history
bindkey "^[\"" quote-region
bindkey "^[\$" spell-word
bindkey "^['" quote-line
bindkey "^[-" neg-argument
bindkey "^[." insert-last-word
bindkey "^[0" digit-argument
bindkey "^[1" digit-argument
bindkey "^[2" digit-argument
bindkey "^[3" digit-argument
bindkey "^[4" digit-argument
bindkey "^[5" digit-argument
bindkey "^[6" digit-argument
bindkey "^[7" digit-argument
bindkey "^[8" digit-argument
bindkey "^[9" digit-argument
bindkey "^[<" beginning-of-buffer-or-history
bindkey "^[>" end-of-buffer-or-history
bindkey "^[?" which-command
bindkey "^[A" accept-and-hold
bindkey "^[B" backward-word
bindkey "^[C" capitalize-word
bindkey "^[D" kill-word
bindkey "^[F" forward-word
bindkey "^[G" get-line
bindkey "^[H" run-help
bindkey "^[L" down-case-word
bindkey "^[N" history-search-forward
bindkey "^[OA" up-line-or-history
bindkey "^[OB" down-line-or-history
bindkey "^[OC" forward-char
bindkey "^[OD" backward-char
bindkey "^[P" history-search-backward
bindkey "^[Q" push-line
bindkey "^[S" spell-word
bindkey "^[T" transpose-words
bindkey "^[U" up-case-word
bindkey "^[W" copy-region-as-kill
bindkey "^[[A" up-line-or-history
bindkey "^[[B" down-line-or-history
bindkey "^[[C" forward-char
bindkey "^[[D" backward-char
bindkey "^[_" insert-last-word
bindkey "^[a" accept-and-hold
bindkey "^[b" backward-word
bindkey "^[c" capitalize-word
bindkey "^[d" kill-word
bindkey "^[f" forward-word
bindkey "^[g" get-line
bindkey "^[h" run-help
bindkey "^[l" down-case-word
bindkey "^[n" history-search-forward
bindkey "^[p" history-search-backward
bindkey "^[q" push-line
bindkey "^[s" spell-word
bindkey "^[t" transpose-words
bindkey "^[u" up-case-word
bindkey "^[w" copy-region-as-kill
bindkey "^[x" execute-named-cmd
bindkey "^[y" yank-pop
bindkey "^[z" execute-last-named-cmd
bindkey "^[|" vi-goto-column
bindkey "^[^?" backward-kill-word
bindkey "^_" undo
bindkey -R " "-"~" self-insert
bindkey "^?" backward-delete-char
bindkey -R "\M-^@"-"\M-^?" self-insert

bindkey -a "^D" list-choices
bindkey -a "^G" list-expand
bindkey -a "^H" vi-backward-char
bindkey -a "^J" accept-line
bindkey -a "^L" clear-screen
bindkey -a "^M" accept-line
bindkey -a "^N" down-history
bindkey -a "^P" up-history
bindkey -a "^R" redisplay
bindkey -a "^[OA" up-line-or-history
bindkey -a "^[OB" down-line-or-history
bindkey -a "^[OC" vi-forward-char
bindkey -a "^[OD" vi-backward-char
bindkey -a "^[[A" up-line-or-history
bindkey -a "^[[B" down-line-or-history
bindkey -a "^[[C" vi-forward-char
bindkey -a "^[[D" vi-backward-char
bindkey -a " " vi-forward-char
bindkey -a "\"" vi-set-buffer
bindkey -a "#" pound-insert
bindkey -a "\$" vi-end-of-line
bindkey -a "%" vi-match-bracket
bindkey -a "'" vi-goto-mark-line
bindkey -a "+" vi-down-line-or-history
bindkey -a "," vi-rev-repeat-find
bindkey -a -- "-" vi-up-line-or-history
bindkey -a "." vi-repeat-change
bindkey -a "/" vi-history-search-backward
bindkey -a "0" vi-digit-or-beginning-of-line
bindkey -R -a "1"-"9" digit-argument
bindkey -a ";" vi-repeat-find
bindkey -a "<" vi-unindent
bindkey -a "=" list-choices
bindkey -a ">" vi-indent
bindkey -a "?" vi-history-search-forward
bindkey -a "A" vi-add-eol
bindkey -a "B" vi-backward-blank-word
bindkey -a "C" vi-change-eol
bindkey -a "D" vi-kill-eol
bindkey -a "E" vi-forward-blank-word-end
bindkey -a "F" vi-find-prev-char
bindkey -a "G" vi-fetch-history
bindkey -a "I" vi-insert-bol
bindkey -a "J" vi-join
bindkey -a "N" vi-rev-repeat-search
bindkey -a "O" vi-open-line-above
bindkey -a "P" vi-put-before
bindkey -a "R" vi-replace
bindkey -a "S" vi-change-whole-line
bindkey -a "T" vi-find-prev-char-skip
bindkey -a "W" vi-forward-blank-word
bindkey -a "X" vi-backward-delete-char
bindkey -a "Y" vi-yank-whole-line
bindkey -a "\^" vi-first-non-blank
bindkey -a "\`" vi-goto-mark
bindkey -a "a" vi-add-next
bindkey -a "b" vi-backward-word
bindkey -a "c" vi-change
bindkey -a "d" vi-delete
bindkey -a "e" vi-forward-word-end
bindkey -a "f" vi-find-next-char
bindkey -a "h" vi-backward-char
bindkey -a "i" vi-insert
bindkey -a "j" down-line-or-history
bindkey -a "k" up-line-or-history
bindkey -a "l" vi-forward-char
bindkey -a "m" vi-set-mark
bindkey -a "n" vi-repeat-search
bindkey -a "o" vi-open-line-below
bindkey -a "p" vi-put-after
bindkey -a "r" vi-replace-chars
bindkey -a "s" vi-substitute
bindkey -a "t" vi-find-next-char-skip
bindkey -a "u" vi-undo-change
bindkey -a "w" vi-forward-word
bindkey -a "x" vi-delete-char
bindkey -a "y" vi-yank
bindkey -a "|" vi-goto-column
bindkey -a "~" vi-swap-case
bindkey -a "^?" vi-backward-char

bindkey -R -M viins "^A"-"^C" self-insert
bindkey -M viins "^D" list-choices
bindkey -R -M viins "^E"-"^F" self-insert
bindkey -M viins "^G" list-expand
bindkey -M viins "^H" vi-backward-delete-char
bindkey -M viins "^I" expand-or-complete
bindkey -M viins "^J" accept-line
bindkey -M viins "^K" self-insert
bindkey -M viins "^L" clear-screen
bindkey -M viins "^M" accept-line
bindkey -R -M viins "^N"-"^P" self-insert
bindkey -M viins "^Q" vi-quoted-insert
bindkey -M viins "^R" redisplay
bindkey -R -M viins "^S"-"^T" self-insert
bindkey -M viins "^U" vi-kill-line
bindkey -M viins "^V" vi-quoted-insert
bindkey -M viins "^W" vi-backward-kill-word
bindkey -R -M viins "^X"-"^Z" self-insert
bindkey -M viins "^[" vi-cmd-mode
bindkey -R -M viins "^\\\\"-"~" self-insert
bindkey -M viins "^?" vi-backward-delete-char
bindkey -R -M viins "\M-^@"-"\M-^?" self-insert

# Completions.

compctl -C -c -tn
compctl -D -f -tn
compctl -T

# Undefined functions.


# Defined functions.


# Limits.

limit stacksize       8MB
limit coredumpsize    0kB
limit maxproc         2047
limit descriptors     1024

# Modules.

zmodload -d zsh/complete zsh/zle
zmodload -d zsh/compctl zsh/complete zsh/zle
zmodload -d zsh/complist zsh/complete zsh/zle
zmodload -d zsh/zutil zsh/complete
zmodload -d zsh/computil zsh/complete zsh/zle
zmodload -d zsh/zleparameter zsh/zle
zmodload -d cap zsh/cap
zmodload -d clone zsh/clone
zmodload -d compctl zsh/compctl
zmodload -d complete zsh/complete
zmodload -d complist zsh/complist
zmodload -d computil zsh/computil
zmodload -d deltochar zsh/deltochar
zmodload -d example zsh/example
zmodload -d files zsh/files
zmodload -d mapfile zsh/mapfile
zmodload -d mathfunc zsh/mathfunc
zmodload -d parameter zsh/parameter
zmodload -d rlimits zsh/rlimits
zmodload -d sched zsh/sched
zmodload -d stat zsh/stat
zmodload -d zftp zsh/zftp
zmodload -d zle zsh/zle
zmodload -d zleparameter zsh/zleparameter
zmodload -d zutil zsh/zutil

zmodload -ab zsh/sched sched
zmodload -ab zsh/zutil zparseopts
zmodload -ab zsh/computil comptags
zmodload -ab zsh/computil compdescribe
zmodload -ab zsh/zutil zregexparse
zmodload -ab zsh/computil comparguments
zmodload -ab zsh/zutil zstyle
zmodload -ab zsh/computil comptry
zmodload -ab zsh/computil compvalues
zmodload -ab zsh/computil compquote
zmodload -ab zsh/zutil zformat


zmodload -ap zsh/parameter aliases
zmodload -ap zsh/parameter builtins
zmodload -ap zsh/parameter commands
zmodload -ap zsh/parameter dirstack
zmodload -ap zsh/parameter dis_aliases
zmodload -ap zsh/parameter dis_builtins
zmodload -ap zsh/parameter dis_functions
zmodload -ap zsh/parameter dis_galiases
zmodload -ap zsh/parameter dis_reswords
zmodload -ap zsh/parameter funcstack
zmodload -ap zsh/parameter functions
zmodload -ap zsh/parameter galiases
zmodload -ap zsh/parameter history
zmodload -ap zsh/parameter historywords
zmodload -ap zsh/parameter jobdirs
zmodload -ap zsh/parameter jobstates
zmodload -ap zsh/parameter jobtexts
zmodload -ap zsh/zleparameter keymaps
zmodload -ap zsh/parameter modules
zmodload -ap zsh/parameter nameddirs
zmodload -ap zsh/parameter options
zmodload -ap zsh/parameter parameters
zmodload -ap zsh/parameter reswords
zmodload -ap zsh/parameter userdirs
zmodload -ap zsh/zleparameter widgets

zmodload zsh/complete
zmodload zsh/compctl
zmodload zsh/main
zmodload zsh/zle
zmodload zsh/rlimits

# Non-array variables.

TERMCAP=''
TERM='xterm-color'
Binary file (standard input) matches"
prompt='test%'

# Array variables.

argv=()

# Exported variables.

export TERMCAP
export TERM
export CPLUS_INCLUDE_PATH=/usr/lib/qt/include:/usr/lib/qt/include:
export DISPLAY=:0.0
export HOME=/they/dan
export HOSTNAME=klister.org
export HOSTTYPE=i386
export IGNOREEOF=0
export KDEDIR=/opt/kde
export LESS=-MM
export LESSOPEN='|lesspipe.sh %s'
export LOGNAME=dan
export LS_COLORS=''
export LS_OPTIONS=' --color=auto -F -b -T 0'
export MACHTYPE=i586
export MANPATH=/usr/local/man:/usr/man/preformat:/usr/man:/usr/X11R6/man:/usr/openwin/man:/usr/share/texmf/man
export MINICOM='-c on'
export MOZILLA_HOME=/opt/netscape
export OLDPWD=/usr/src/zsh-3.1.9
export OPENWINHOME=/usr/openwin
export OSTYPE=linux-gnu
export PATH=.:/they/dan/bin:.:/they/dan/bin:/usr/local/bin:/usr/bin:/bin:/usr/X11R6/bin:/usr/openwin/bin:/usr/games:.:/opt/kde/bin:/usr/share/texmf/bin:/usr/bin/X11:/usr/TeX/bin:/usr/openwin/bin:/usr/games:/opt/postfix/bin:/they/dan/bin:/usr/bin/X11:/usr/TeX/bin:/usr/openwin/bin:/usr/games:/opt/postfix/bin
export PS1='`hostname`:`pwd`# '
export PS2='> '
export PWD=/usr/src/zsh-3.1.9
export QTDIR=/usr/lib/qt
export SHELL=/bin/bash
export SHLVL=3
export SUDO_COMMAND=/usr/bin/bash
export SUDO_GID=100
export SUDO_UID=201
export SUDO_USER=wilder
export TERM=xterm-color
export TOOLDIR=.tools
export USER=root
export ignoreeof=10

# Setopt.


# END zsh saveset


-- 
Dan Wilder <wilder@eskimo.com> <dan@ssc.com>

