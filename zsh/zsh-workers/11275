From zsh-workers-return-11275-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 09 11:44:00 2000
Return-Path: <zsh-workers-return-11275-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15909 invoked from network); 9 May 2000 11:43:59 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 May 2000 11:43:59 -0000
Received: (qmail 21718 invoked by alias); 9 May 2000 11:43:48 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11275
Received: (qmail 21665 invoked from network); 9 May 2000 11:43:44 -0000
To: zsh-workers@sunsite.auc.dk
Subject: zfanon and nslookup
MIME-Version: 1.0 (generated by SEMI 1.13.7 - "Awazu")
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@m17n.org>
Date: 09 May 2000 20:44:59 +0900
Message-ID: <hvozoq0gd6s.fsf@serein.m17n.org>
Lines: 58
User-Agent: T-gnus/6.14.1 (based on Gnus v5.8.3) (revision 16) SEMI/1.13.7 (Awazu) FLIM/1.13.2 (Kasanui) Emacs/20.6 (i686-pc-linux-gnu) MULE/4.0 (HANANOEN)

I found that the function nslookup may causes trouble with zfanon.

Z:akr@coulee% Src/zsh -f
coulee% autoload -U nslookup zfinit
coulee% zfinit
coulee% zfanon ftp.zsh.org
> 

Hm.  This prompt is for nslookup.

coulee% set -x
coulee% zfanon ftp.zsh.org
+Src/zsh:5> zfanon ftp.zsh.org
+zfanon:3> emulate -L zsh
+zfanon:5> [[  == :zf* ]]
+zfanon:5> local curcontext=:zfanon
+zfanon:6> local opt opt_1 dir
+zfanon:8> getopts :1 opt
+zfanon:12> ((  OPTIND > 1  ))
+zfanon:14> [[ -z  ]]
+zfanon:19> local domain host
+zfanon:21> [[ coulee == *.* ]]
+zfanon:24> [[ -f /etc/resolv.conf ]]
+zfanon:26> domain=+zfanon:26> awk /domain/ { print $2 } /etc/resolv.conf
+zfanon:26> domain= 
+zfanon:27> [[ -n  ]]
+zfanon:30> [[ -z  ]]
+zfanon:31> host=+zfanon:31> host=+zfanon:31> awk /Name:/ { print $2 }
+zfanon:31> nslookup coulee
+nslookup:4> setopt localoptions localtraps completealiases
+nslookup:6> local tmp line compcontext=nslookup curcontext=nslookup::: pmpt
+nslookup:7> local pager opager=less
+nslookup:8> typeset +g -x PAGER=cat
+nslookup:10> zmodload -e zsh/zpty
+nslookup:10> zmodload -i zsh/zpty
+nslookup:12> trap return 130 INT
+nslookup:13> trap zpty -d nslookup EXIT
+nslookup:15> pmpt=( ) 
+nslookup:16> zstyle -s :nslookup prompt tmp
+nslookup:17> zstyle -s :nslookup rprompt tmp
+nslookup:18> zstyle -s :nslookup pager tmp
+nslookup:20> ((  0  ))
+nslookup:20> pmpt=( -p >  ) 
+nslookup:22> zpty nslookup nslookup
+nslookup:24> zpty -r nslookup line *
> 
+nslookup:26> print -nr Default Server:  fs.m17n.org
Address:  192.47.44.2

> 
+nslookup:28> line= 
+nslookup:28> vared -he -p >  line
> 

So, the function nslookup shouldn't work interactively if a query is
specified on a command line.
-- 
Tanaka Akira

