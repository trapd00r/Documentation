From zsh-workers-request@math.gatech.edu  Wed Aug 16 23:55:42 1995
Received: from gatech.edu (gatech.edu [130.207.244.244]) by werple.mira.net.au (8.6.12/8.6.9) with SMTP id XAA22575 for <mason@werple.mira.net.au>; Wed, 16 Aug 1995 23:55:40 +1000
Received: from math (math.skiles.gatech.edu) by gatech.edu with SMTP id AA29790
  (5.65c/Gatech-10.0-IDA for <mason@werple.mira.net.au>); Wed, 16 Aug 1995 09:49:49 -0400
Received: by math (5.x/SMI-SVR4)
	id AA15300; Wed, 16 Aug 1995 09:43:51 -0400
Resent-Date: Wed, 16 Aug 1995 15:41:59 +0200 (MET DST)
Old-Return-Path: <hzoli@cs.elte.hu>
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199508161341.PAA09049@bolyai.cs.elte.hu>
Subject: ~username<TAB> problem on SunOS
To: zsh-workers@math.gatech.edu (zsh-workers)
Date: Wed, 16 Aug 1995 15:41:59 +0200 (MET DST)
X-Mailer: ELM [version 2.4 PL24]
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Resent-Message-Id: <"73qRd.0.zk3.MOVCm"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/321
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

At least two people reported that ~username completion causes SEGV on machines
with NIS.  It turned out that this problem only occurs on SunOS 4.1.3 but it
doesn't on SunOS 4.1.2.  The SEGV happens in the yp_all libc function.  Zsh
used yp_all to prefech all usernames from the NIS map.  Other shells probably
do not use this function (bash, tcsh).  I noticed that zsh can complete
usernames much faster that bash or tcsh and it is probably because zsh uses
yp_all.  If you use SunOS 4.1.3 and you experience such problems, either try
to upgrade or downgrade your OS to fix the libc bug, or get a statically
linked binary which compiled with a working libc.  The bug may disappear if
you undefine the HAVE_NIS macro in config.h.  I think username completion will
work even if HAVE_NIS undefined but it will be much slower (I didn't try that
so it is possible that it doesn't work at all).

It is known that some libc.so.1.9.x versions have this bug but libc.so.1.8.1
doesn't.

Zoltan

