Delivered-To: mason-zsh@primenet.com.au
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
Message-Id: <9902050948.AA57511@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk
Subject: Re: Make dependencies broken in pws-6 + latest patches 
In-Reply-To: ""Bart Schaefer""'s message of "Thu, 04 Feb 1999 08:25:35 NFT."
             <990204082535.ZM17968@candle.brasslantern.com> 
Date: Fri, 05 Feb 1999 10:48:44 +0100
From: Peter Stephenson <pws@ibmth.df.unipi.it>
X-Mailing-List: <zsh-workers@sunsite.auc.dk> 5272

"Bart Schaefer" wrote:
> I've noticed previously that changes to Config/version.mk don't cause the
> Src/version.h file to be updated.
> 
> Now, with PWS's bashautolist patch, rebuilding with the changed zsh.h left
> the opts[] array messed up.  I had to `make clean` and then rebuild to get
> zsh working again; I was in the middle of reporting that ZLE wasn't getting
> initialized properly when I remembered that the option numbering had been
> changed.
> 
> I don't have time to track this down this morning, and frankly I'm not very
> familiar with the way the build works since dynamic modules were introduced,
> so it might be better for someone else to do it anyway.

Me not neither.  I noticed this, too, and discovered that main.o
wasn't being remade --- removing main.o and making should work.  This
is because $(MAIN_OBJS) depends on Makemod, which was up to date.
I could add an explicit dependence for zsh.h to Makefile.in, even
though zsh.h isn't otherwise mentioned there.  Does anyone know if
this is OK?

As for the version number, there are already explicit dependencies for
this in Makemod.

 params.o: version.h

 version.h: $(sdir_top)/Config/version.mk
	echo '#define ZSH_VERSION "'$(VERSION)'"' > $@

Also, I've found that the Zle/*.mdh files are sometimes not remade
properly, and this moring comp1.pro wasn't remade.

Summary: someone else will have to fix all this.

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

