From zsh-workers-return-27349-mason-zsh=primenet.com.au@zsh.org Wed Nov 04 13:20:14 2009
Return-Path: <zsh-workers-return-27349-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21738 invoked by alias); 4 Nov 2009 13:20:14 -0000
Mailing-List: contact zsh-workers-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Workers List <zsh-workers.zsh.org>
List-Post: <mailto:zsh-workers@zsh.org>
List-Help: <mailto:zsh-workers-help@zsh.org>
Delivered-To: mailing list zsh-workers@zsh.org
X-Seq: 27349
Received: (qmail 20078 invoked from network); 4 Nov 2009 13:20:09 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received-SPF: none (ns1.primenet.com.au: domain at picard.franken.de does not designate permitted sender hosts)
Date: Wed, 4 Nov 2009 14:08:44 +0100
From: Thomas =?iso-8859-1?Q?K=F6hler?= <jean-luc@picard.franken.de>
To: zsh workers <zsh-workers@zsh.org>
Subject: zsh-4.3.9 compilation fails with multibyte disabled
Message-ID: <20091104130843.GA27520@picard.franken.de>
Mail-Followup-To: zsh workers <zsh-workers@zsh.org>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="ZPt4rx8FFjLCG7dd"
Content-Disposition: inline
X-Operating-System: Linux
X-Editor: VIM - Vi IMproved 7.2 http://www.vim.org/
X-IRC: tirc; Nick: tkoehler
X-URL: http://gott-gehabt.de/800_wer_wir_sind/thomas/Homepage/index.html
User-Agent: Mutt/1.5.4i

--ZPt4rx8FFjLCG7dd
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hello all,
the compiler complains because the int now_off is not declared at
the beginning of a block. As I don't know if someone else already
discovered this, here's a patch. Just ignore if it is already
fixed :-)

~/zsh/zsh-4.3.9> diff -u Src/Zle/zle_refresh.c.ORG Src/Zle/zle_refresh.c
--- Src/Zle/zle_refresh.c.ORG   Wed Nov  4 13:54:32 2009
+++ Src/Zle/zle_refresh.c       Wed Nov  4 14:02:01 2009
@@ -2044,8 +2044,9 @@
 	 */
 	if (!nl->chr)
 	    break;
-	do {
+	do
 #endif
+	{
 	    /*
 	     * If an attribute was on here but isn't any more,
 	     * output the sequence to turn it off.
@@ -2057,12 +2058,13 @@
 	    zputc(nl);
 	    nl++, ol++;
 	    ccs++, vcs++;
+	}
 #ifdef MULTIBYTE_SUPPORT
 	    /*
 	     * Make sure we always overwrite the complete width of
 	     * a character that was there before.
 	     */
-	} while ((ol->chr =3D=3D WEOF && nl->chr) ||
+	while ((ol->chr =3D=3D WEOF && nl->chr) ||
 		  (nl->chr =3D=3D WEOF && ol->chr));
 #endif
     }
~/zsh/zsh-4.3.9>=20

Bye,
Thomas

--=20
 Thomas K=F6hler       Email:       jean-luc@picard.franken.de
     <><             WWW:              http://gott-gehabt.de
                     IRC:                           tkoehler
                     PGP public key available from Homepage!

--ZPt4rx8FFjLCG7dd
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQFK8XzbTEYXWMJlHuYRAj1IAJ4mG6P4ZEH/fBEVHzvM8oyvafq+EACgiqda
B9xmexONe7E0yLgPbOOtgRs=
=S8RE
-----END PGP SIGNATURE-----

--ZPt4rx8FFjLCG7dd--

