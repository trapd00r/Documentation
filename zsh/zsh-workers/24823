From zsh-workers-return-24823-mason-zsh=primenet.com.au@sunsite.dk Thu Apr 17 09:41:08 2008
Return-Path: <zsh-workers-return-24823-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2693 invoked from network); 17 Apr 2008 09:41:06 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.1 required=5.0 tests=AWL,BAYES_00,
	DATE_IN_PAST_12_24 autolearn=no version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 17 Apr 2008 09:41:06 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 8946 invoked from network); 17 Apr 2008 09:41:04 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 17 Apr 2008 09:41:03 -0000
Received: (qmail 7336 invoked by alias); 17 Apr 2008 09:41:00 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24823
Received: (qmail 7316 invoked from network); 17 Apr 2008 09:41:00 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 17 Apr 2008 09:41:00 -0000
Received: from acolyte.scowler.net (acolyte.scowler.net [216.254.112.45])
	by bifrost.dotsrc.org (Postfix) with ESMTP id C48DC808A37A
	for <zsh-workers@sunsite.dk>; Thu, 17 Apr 2008 11:40:44 +0200 (CEST)
Received: by acolyte.scowler.net (Postfix, from userid 1000)
	id 331CD5C3F2; Wed, 16 Apr 2008 13:45:25 -0400 (EDT)
Date: Wed, 16 Apr 2008 13:45:25 -0400
From: Clint Adams <clint@zsh.org>
To: zsh-workers@sunsite.dk
Subject: PATCH: _git tweaks
Message-ID: <20080416174524.GA27117@scowler.net>
Mail-Followup-To: zsh-workers@sunsite.dk
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.17+20080114 (2008-01-14)
X-Virus-Scanned: ClamAV 0.91.2/6801/Wed Apr 16 18:40:47 2008 on bifrost
X-Virus-Status: Clean

Someone should do completion for 'git stash'.

Index: Completion/Unix/Command/_git
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Unix/Command/_git,v
retrieving revision 1.63
diff -u -r1.63 _git
--- Completion/Unix/Command/_git	23 Mar 2008 16:18:20 -0000	1.63
+++ Completion/Unix/Command/_git	16 Apr 2008 17:41:21 -0000
@@ -35,6 +35,7 @@
   '(--name-only --name-status -u -p --stat --patch-with-stat --patch-with-raw --raw --numstat --shortstat --summary)--numstat[generate a more machine-friendly diffstat]' \
   '(--name-only --name-status -u -p --stat --patch-with-stat --patch-with-raw --raw --numstat --shortstat --summary)--shortstat[generate a summary diffstat]' \
   '(--name-only --name-status -u -p --stat --patch-with-stat --patch-with-raw --raw --numstat --shortstat --summary)--summary[generate a condensed summary of extended header information]' \
+  '(--name-only --name-status -u -p --stat --patch-with-stat --patch-with-raw --raw --numstat --shortstat --summary)--dirstat[generate a dirstat]' \
   '-B-[break complete rewrite changes into pairs of given size]: :_guard "[[\:digit\:]]#" size'
   '-C-[detect copies as well as renames with given scope]: :_guard "[[\:digit\:]]#" size'
   $diff_l_arg
@@ -58,6 +59,7 @@
   $nul_arg
   '--exit-code[report exit code 1 if differences, 0 otherwise]'
   '(--exit-code)--quiet[disable all output]'
+  '--relative=:path:_files -/'
 )
 
 pretty_arg='--pretty=-[pretty print commit messages]::pretty print:((raw\:"the raw commits"
@@ -1629,7 +1631,9 @@
 (( $+functions[_git-gc] )) ||
 _git-gc () {
   _arguments \
-    '--prune[remove unreferenced loose objects]' && ret=0
+    '--aggressive[more aggressively optimize]' \
+    '--auto[check whether housekeeping is required]' \
+    '--quiet[suppress all progress reports]' && ret=0
 }
 
 (( $+functions[_git-grep] )) ||
@@ -1658,7 +1662,7 @@
     '(-E --extended-regexp -G --basic-regexp)'{-E,--extended-regexp}'[use POSIX extended regexes]' \
     '(-E --extended-regexp -G --basic-regexp)'{-G,--basic-regexp}'[use POSIX basic regexes]' \
     '-n[prefix the line number to matching lines]' \
-    '(-l --files-with-matches -L --files-without-match)'{-l,--files-with-match}'[show only names of matching files]' \
+    '(-l --files-with-matches -L --files-without-match --name-only)'{-l,--files-with-matches,--name-only}'[show only names of matching files]' \
     '(-l --files-with-matches -L --files-without-match)'{-L,--files-without-match}'[show only names of non-matching files]' \
     '(-c --count)'{-c,--count}'[show number of matching lines in files]' \
     '-A[show trailing context]: :_guard "[[\:digit\:]]#" lines' \
@@ -2009,7 +2013,7 @@
     '-i[do not perform a checkout after importing]' \
     '-k[remove keywords from source files in the CVS archive]' \
     '-m[attempt to detect merges based on the commit message]' \
-    '-M[attempt to detect merges based on the commit message with custom pattern]:pattern' \
+    '*-M[attempt to detect merges based on the commit message with custom pattern]:pattern' \
     '-o[specify the branch into which you wish to import]:branch:__git_branch_names' \
     '-P[read cvsps output file]:file:_files' \
     '-p[specify additionaly options for cvsps]:cvsps-options' \
@@ -2050,7 +2054,8 @@
 (( $+functions[_git-prune] )) ||
 _git-prune () {
   _arguments -S \
-    '-n[do not remove anything; just report what would have been removed]'
+    '-n[do not remove anything; just report what would have been removed]' \
+    '--expire:time:' \
     '*::heads:__git_heads' && ret=0
 }
 

