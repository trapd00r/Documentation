From zsh-workers-return-17094-mason-zsh=primenet.com.au@sunsite.dk Wed May 08 13:27:24 2002
Return-Path: <zsh-workers-return-17094-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24121 invoked from network); 8 May 2002 13:27:24 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 8 May 2002 13:27:24 -0000
Received: (qmail 4511 invoked by alias); 8 May 2002 13:27:14 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17094
Received: (qmail 4498 invoked from network); 8 May 2002 13:27:13 -0000
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: PATCH: zselect builtin. 
In-reply-to: "Peter Stephenson"'s message of "Tue, 07 May 2002 12:25:15 BST."
             <17029.1020770715@csr.com> 
Date: Wed, 08 May 2002 14:26:44 +0100
Message-ID: <21268.1020864404@csr.com>
From: Peter Stephenson <pws@csr.com>

Peter Stephenson wrote:
> Here's a builtin to act as a front end to a `select' system call.

I've committed this, with subtle changes over the form I posted mostly as
indicated in previous postings.  I've added `-A assoc' for associative
array handling.

It's still called zselect, and still lives in zsh/zselect.  I'm happy to
consider more logical overall naming, but until then I don't see any
point in introducing new conventions piecemeal.  (Another argument
against tying the name more closely to the system call is that it is
possible and probably useful to provide an alternative implementation
based on poll().)

Warning:  I used this overnight as part of a test and there seems to be
a memory leak somewhere, not necessarily zselect itself (where I can't
see where it would be).  I was using ztcp, but it was the same TCP
connection all the time, so I don't think that's it either.  It's just
possible I was accumulating some humongous array, but I couldn't see
where that would have been, either.  Unfortunately I had to kill the
shell because I made it uninteruptible.

Another note: the zmodload manual page is written to imply that having a
module name the same as a builtin, or other autoloadable entity, is
useful.  As far as I can see, this is never the case now, due to the
hierarchical naming.  It might be better to remove this feature or at
least add implied aliasing into the zsh/* name segment when there's only
one argument.  (You can add module aliases by hand, but it takes away
the point of the shortcut.)

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Science Park, Milton Road,
Cambridge, CB4 0WH, UK                          Tel: +44 (0)1223 392070


**********************************************************************
The information transmitted is intended only for the person or
entity to which it is addressed and may contain confidential 
and/or privileged material. 
Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by 
persons or entities other than the intended recipient is 
prohibited.  
If you received this in error, please contact the sender and 
delete the material from any computer.
**********************************************************************

