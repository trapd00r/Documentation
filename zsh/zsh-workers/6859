From zsh-workers-return-6859-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Jun 25 16:23:52 1999
Return-Path: <zsh-workers-return-6859-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13278 invoked from network); 25 Jun 1999 16:23:50 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Jun 1999 16:23:50 -0000
Received: (qmail 7223 invoked by alias); 25 Jun 1999 16:23:25 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6859
Received: (qmail 7215 invoked from network); 25 Jun 1999 16:23:24 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>,
        "Sven Wischnowsky" <wischnow@informatik.hu-berlin.de>,
        <zsh-workers@sunsite.auc.dk>
Subject: RE: PATCH: loop killing
Date: Fri, 25 Jun 1999 20:23:16 +0400
Message-ID: <002001bebf27$07d01620$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2314.1300
In-reply-to: <001d01bebf1b$85f76dc0$21c9ca95@mow.siemens.ru>
Importance: Normal

>
> The only difference, that I currently can see, is, that when it does not work,
> zsh is session leader:

Well, it does work with csh (that starts programs in seperate program group) and
does not work with ksh (that starts porgrams in it's own program group). It does
work if program is started alone and not as part of loop. Note the difference
(this is ksh, but the same is true for zsh):

This is for while true; zcat; done case:

bor@itsrm2:/tools/src/zsh-3.1.5-pws-23%> ps -jt pts/12
   PID  PGID   SID TTY      TIME CMD
  9064  9002  9002 pts/12   0:00 zcat
  9002  9002  9002 pts/12   0:00 ksh

And this is for the simple zcat case:

bor@itsrm2:/tools/src/zsh-3.1.5-pws-23%> ps -jt pts/12
   PID  PGID   SID TTY      TIME CMD
  9072  9072  9002 pts/12   0:00 zcat
  9002  9002  9002 pts/12   0:00 ksh

In the first case job PGID == SID and ^Z does not work (zcat gets TSTP but
[zk]sh never gets SIGCLD). In the second case job PGID != SID and all works like
a charm

Now, is it my system bug? Any idea?

/andrej

