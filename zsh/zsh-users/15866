From zsh-users-return-15866-mason-zsh=primenet.com.au@zsh.org Fri Mar 11 17:10:06 2011
Return-Path: <zsh-users-return-15866-mason-zsh=primenet.com.au@zsh.org>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7533 invoked by alias); 11 Mar 2011 17:10:06 -0000
Mailing-List: contact zsh-users-help@zsh.org; run by ezmlm
Precedence: bulk
X-No-Archive: yes
List-Id: Zsh Users List <zsh-users.zsh.org>
List-Post: <mailto:zsh-users@zsh.org>
List-Help: <mailto:zsh-users-help@zsh.org>
Delivered-To: mailing list zsh-users@zsh.org
X-Seq: 15866
Received: (qmail 24523 invoked from network); 11 Mar 2011 17:10:04 -0000
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.0 required=5.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,FREEMAIL_FROM,RCVD_IN_DNSWL_NONE autolearn=ham
	version=3.3.1
Received-SPF: pass (ns1.primenet.com.au: SPF record at _spf.google.com designates 209.85.220.171 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:cc:content-type;
        bh=xJlpQp73TWRWpb7lY0s2Ri3mSvsZlgUbcmIZQSCJ5Fk=;
        b=mJ7hgu3QmsXcmrkN3BJIMxp2Hq+gJ/lwvtDA7HyKWxmQlcFOs+lP1PQTpHqyoTncz6
         6gxsc4wo85iSSGyDRHJ/Yzm+vy25BgyRvW9EaWzAU7/O1iAa/02j1iazi3yqWRHTDKjB
         fBszeCKN8nGStsn2V/tCPL+88YKmPGGoy9l44=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        b=Ys6OxoQK9IMCyRkKRb8X71af57W7/57VkGnaPfdZuH9CXKuyHsKw4hH+oM5zM8cFfv
         l4CEuDFo7wayhJmCsfVhOjlwZt1HUNiOHFRZbg8hoFOrsixEeoma9eZwpckJoQEVVMcj
         NmXbHH13VLsIvSxkGOeiqnjCVoIneE5YTAbZc=
MIME-Version: 1.0
In-Reply-To: <20110311163325.2bc05b6b@pwslap01u.europe.root.pri>
References: <AANLkTin+cCxFRYtwZXGSUWyLjfe7NV-eDx1mcS9sSau0@mail.gmail.com>
	<20110311104402.6a411b10@pwslap01u.europe.root.pri>
	<20110311162514.255fe6b6@pwslap01u.europe.root.pri>
	<20110311163325.2bc05b6b@pwslap01u.europe.root.pri>
Date: Fri, 11 Mar 2011 18:09:57 +0100
Message-ID: <AANLkTikvpOu6KZADcxBEPiiGPhpNMP6shVFBd0bocXaJ@mail.gmail.com>
Subject: Re: possibly useful zsh_directory_name implementation
From: Mikael Magnusson <mikachu@gmail.com>
To: Peter Stephenson <Peter.Stephenson@csr.com>
Cc: Zsh Users <zsh-users@zsh.org>
Content-Type: text/plain; charset=UTF-8

On 11 March 2011 17:33, Peter Stephenson <Peter.Stephenson@csr.com> wrote:
> On Fri, 11 Mar 2011 16:25:14 +0000
> Peter Stephenson <Peter.Stephenson@csr.com> wrote:
>> +local func
>> +
>> +if [[ -n $functions[zsh_directory_name] || \
>> +  ${+zsh_directory_name_functions} -ne 0 ]] ; then
>> +  zsh_directory_name c && return 0
>> +  for func in $zsh_directory_name_functions; do
>> +    $func c && return 0
>> +  done
>> +  return 1
>
> Instantly after sending this, I realised it should try all functions and
> return status 0 or 1 based on whether any were successful.  I've
> submitted it in that form.

Can you really just call a bunch of completions in series and get a
useful result? The documentation still seems to imply running will
stop as soon as one hook returns 0 status.

More importantly, shouldn't you only run zsh_directory_name if that
function exists? As it is now, it will be run even if only the array
is defined. Also, why the mix of -n $foo and ${+foo}?

% ls ~[<tab>_dynamic_directory_name:8: command not found: zsh_directory_name

-- 
Mikael Magnusson

