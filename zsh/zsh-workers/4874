From zsh-workers-request@math.gatech.edu Sun Jan 03 20:38:15 1999
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 6010 invoked from network); 3 Jan 1999 20:38:13 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 3 Jan 1999 20:38:13 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id PAA22007;
	Sun, 3 Jan 1999 15:35:35 -0500 (EST)
Resent-Date: Sun, 3 Jan 1999 15:35:35 -0500 (EST)
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <990103123338.ZM973@candle.brasslantern.com>
Date: Sun, 3 Jan 1999 12:33:38 -0800
In-Reply-To: <19981220044847.53415@athenaeum.demon.co.uk>
Comments: In reply to Phil Pennock <phil@athenaeum.demon.co.uk>
        "BUG: array splices" (Dec 20,  4:48am)
References: <19981220044847.53415@athenaeum.demon.co.uk>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Phil Pennock <phil@athenaeum.demon.co.uk>,
        Zsh Development Workers <zsh-workers@math.gatech.edu>
Subject: PATCH: 3.1.5-pws-4: Re: BUG: array splices
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Resent-Message-ID: <"nMOfH2.0.lN5.MIzZs"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4874
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Catching up on mail that arrived during my winter vacation ...

On Dec 20,  4:48am, Phil Pennock wrote:
} Subject: BUG: array splices
}
} Basically, for any ${arrayname[start,stop]} zsh now seems to ignore the
} comma and everything after it

Some of the associative array code getting in the way of the old behavior.
This should fix it, and should apply to pws-4.

Index: Src/params.c
===================================================================
--- params.c	1998/12/18 16:09:26	1.19
+++ params.c	1999/01/03 20:24:37
@@ -765,7 +765,7 @@
 	} else if (rev) {
 	    v->isarr |= SCANPM_WANTVALS;
 	}
-	if (!down)
+	if (!down && PM_TYPE(v->pm->flags) == PM_HASHED)
 	    v->isarr &= ~SCANPM_MATCHMANY;
 	*inv = ind;
     }

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

