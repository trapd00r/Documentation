From zsh-workers-return-14165-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 30 15:48:17 2001
Return-Path: <zsh-workers-return-14165-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 735 invoked from network); 30 Apr 2001 15:48:16 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Apr 2001 15:48:16 -0000
Received: (qmail 18855 invoked by alias); 30 Apr 2001 15:47:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14165
Received: (qmail 18789 invoked from network); 30 Apr 2001 15:47:56 -0000
Message-ID: <Tc0a88d01533c851c99@mailsweeper01.cambridgesiliconradio.com>
To: zsh-workers@sunsite.dk (Zsh hackers list)
Subject: Re: Use of named directories in completions broken. 
In-Reply-To: Your message of "Mon, 30 Apr 2001 11:37:27 BST."
             <Tc0a88d01533b695b1d@mailsweeper01.cambridgesiliconradio.com> 
Date: Mon, 30 Apr 2001 16:47:23 +0100
From: Peter Stephenson <pws@csr.com>

Still having problems with this...

% echo ~dev/<TAB>

does menu completion as expected.

% echo ~dev/sr<TAB>

should complete to ~dev/src/ but expands instead (then does completion on
that the next time round).  Similar problem with plain ~/ .  Here's the
_expand part of the trace for the first example.  Should that pattern on
line 36 begin (~*/*| rather than (~*/| ?

+_expand:10> setopt localoptions nonomatch
+_expand:12> [[ _matcher_num -gt 1 ]]
+_expand:14> local exp word sort expr expl subd suf=  force opt asp tmp opre pre epre
+_expand:16> ((  0  ))
+_expand:21> [[ _main_complete == _prefix ]]
+_expand:24> word=~dev/sr 
+_expand:27> [[ ~dev/sr == *$(|{[^}]#) || ~dev/sr == *$[a-zA-Z0-9_]## ]]
+_expand:35> zstyle -T :completion::expand::: suffix
+_expand:36> [[ ~dev/sr == (~*/|*$(|[=~#^+])[a-zA-Z0-9_[]]##[^a-zA-Z0-9_[]]|*${*}?) ]]
+_expand:40> zstyle -t :completion::expand::: accept-exact
+_expand:41> [[ 2 -eq 2 && ! -o recexact ]]
+_expand:50> exp=( ~dev/sr ) 
+_expand:56> [[  == *s* ]]
+_expand:57> zstyle -T :completion::expand::: substitute
+_expand:58> [[ ! -o ignorebraces && 0 == 0 ]]
+_expand:59> eval exp=( \~dev/sr )
+_expand:59> exp=( ~dev/sr ) 
+_expand:60> eval exp=( ${${(e)exp//\\[ 	
]/ }//(#b)([ 	
])/\\$match[1]} )
+_expand:60> exp=( ~dev/sr ) 
+_expand:69> [[ -z ~dev/sr ]]
+_expand:71> subd=( ~dev/sr ) 
+_expand:75> [[  == *g* ]]
+_expand:75> zstyle -T :completion::expand::: glob
+_expand:76> eval exp=( ${~exp//(#b)\\[ 	
]/$match[1]} ); exp=( ${(q)exp} )
+_expand:76> exp=( /home/pws/bc01/bc01/dev/sr ) 
+_expand:76> exp=( /home/pws/bc01/bc01/dev/sr ) 
+_expand:85> ((  1  ))
+_expand:87> [[ 1 -eq 1 && /home/pws/bc01/bc01/dev/sr == ~dev/sr(|(N)) ]]
+_expand:92> [[  == *o* ]]
+_expand:93> zstyle -t :completion::expand::: subst-globs-only
+_expand:96> zstyle -s :completion::expand::: keep-prefix tmp
+_expand:96> tmp=changed 
+_expand:98> [[ ~dev/sr == (~*/*|*$*/*) && changed == (yes|true|on|1|changed) ]]
+_expand:99> [[ ~dev/sr == *$* ]]
+_expand:102> opre=~dev 
+_expand:104> eval epre=( ${(e)~opre} )
+_expand:104> epre=( /home/pws/bc01/bc01/dev ) 
+_expand:106> [[ -n /home/pws/bc01/bc01/dev && 1 -eq 1 ]]
+_expand:107> pre=/home/pws/bc01/bc01/dev 
+_expand:108> [[ changed != changed || 1 -gt 1 || ~dev/sr != ~dev/sr ]]
+_expand:111> [[ 1 -eq 1 && /home/pws/bc01/bc01/dev/sr == ~dev/sr ]]
+_expand:116> zstyle -s :completion::expand::: sort sort
+_expand:118> [[  == (yes|true|1|on) ]]
+_expand:120> zstyle -s :completion::expand::: add-space tmp
+_expand:126> asp=file 
+_expand:131> ((  1 == 1  ))
+_expand:132> [[ -d /home/pws/bc01/bc01/dev/sr ]]
+_expand:134> [[ file == yes* || file == *file && -f /home/pws/bc01/bc01/dev/sr ]]
+_expand:138> suf= 
+_expand:142> [[ -z menu ]]
+_expand:151> _tags all-expansions expansions original
+_expand:193> compstate[insert]=menu 
+_expand:196> return 0

-- 
Peter Stephenson <pws@csr.com>                  Software Engineer
CSR Ltd., Unit 300, Science Park, Milton Road,
Cambridge, CB4 0XL, UK                          Tel: +44 (0)1223 392070


**********************************************************************
The information transmitted is intended only for the person or
entity to which it is addressed and may contain confidential 
and/or privileged material. 
Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by 
persons or entities other than the intended recipient is 
prohibited.  
If you received this in error, please contact the sender and 
delete the material from any computer.
**********************************************************************

