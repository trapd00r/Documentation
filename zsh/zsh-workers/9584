From zsh-workers-return-9584-mason-zsh=primenet.com.au@sunsite.auc.dk Sun Feb 06 06:38:55 2000
Return-Path: <zsh-workers-return-9584-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 22138 invoked from network); 6 Feb 2000 06:38:54 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 6 Feb 2000 06:38:54 -0000
Received: (qmail 27564 invoked by alias); 6 Feb 2000 06:38:48 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9584
Received: (qmail 27555 invoked from network); 6 Feb 2000 06:38:47 -0000
To: zsh-workers@sunsite.auc.dk
Path: mason
From: mason@primenet.com.au (Geoff Wing)
X-Newsgroups: lists.zsh.workers
Subject: PATCH: zsh-3.1.6-dev-17: Doc/Makefile.in rule: Zsh/modlist.yo
Date: 6 Feb 2000 06:38:38 GMT
Organization: PrimeNet Computer Consultants
Lines: 55
Distribution: local
Message-ID: <slrn89q5ne.l7g.mason@coral.primenet.com.au>
Reply-To: mason@primenet.com.au
NNTP-Posting-Host: coral.primenet.com.au
X-Trace: coral.primenet.com.au 949819118 21745 203.43.15.2 (6 Feb 2000 06:38:38 GMT)
X-Complaints-To: usenet@coral.primenet.com.au
NNTP-Posting-Date: 6 Feb 2000 06:38:38 GMT
User-Agent: slrn/0.9.6.2 (NetBSD)

Heyla,
here's a patch for building Zsh/modlist.yo.  It subdues some temperamental
sh variants (namely mine) over ``unset'' and for some reason the test was
failing but it works when reversed.  Note also that I've removed the
CTRL-A's from the includefile() lines: any reason they were there?

Regards,
Geoff

*** Doc/Makefile.in.~1~	Mon Jan 31 07:52:30 2000
--- Doc/Makefile.in	Sun Feb  6 17:29:57 2000
***************
*** 178,195 ****
  		echo ")"; \
  	    done; \
  	    echo "enditem()"; \
! 	    echo "includefile(Zsh/modmenu.yo)"; \
  	    set '' $(MODDOCSRC); \
! 	    unset mod1 mod2 mod3; \
! 	    test ".$$2" != . && \
  		mod2=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < $(sdir)/$$2`; \
  	    while test ".$$2" != .; do \
! 		unset mod3; \
! 		test ".$$3" != . && \
  		    mod3=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < $(sdir)/$$3`; \
  		echo "texinode(The $$mod2 Module)($${mod3+The $$mod3 Module})($${mod1:+The $$mod1 Module})(Zsh Modules)"; \
  		echo "sect(The $$mod2 Module)"; \
! 		echo "includefile($${2})"; \
  		shift; \
  		mod1=$$mod2; \
  		mod2=$$mod3; \
--- 178,195 ----
  		echo ")"; \
  	    done; \
  	    echo "enditem()"; \
! 	    echo "includefile(Zsh/modmenu.yo)"; \
  	    set '' $(MODDOCSRC); \
! 	    unset mod1 mod2 mod3 || true; \
! 	    test ".$$2" = . || \
  		mod2=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < $(sdir)/$$2`; \
  	    while test ".$$2" != .; do \
! 		unset mod3 || true; \
! 		test ".$$3" = . || \
  		    mod3=`sed -n '1{s|^COMMENT(!MOD!||;p;q;}' < $(sdir)/$$3`; \
  		echo "texinode(The $$mod2 Module)($${mod3+The $$mod3 Module})($${mod1:+The $$mod1 Module})(Zsh Modules)"; \
  		echo "sect(The $$mod2 Module)"; \
! 		echo "includefile($${2})"; \
  		shift; \
  		mod1=$$mod2; \
  		mod2=$$mod3; \

-- 
Geoff Wing : <gcw@pobox.com>     Work URL: http://www.primenet.com.au/
Rxvt Stuff : <gcw@rxvt.org>      Ego URL : http://pobox.com/~gcw/
Zsh Stuff  : <gcw@zsh.org>       Phone   : (Australia) 0413 431 874

