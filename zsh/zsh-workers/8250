From zsh-workers-return-8250-mason-zsh=primenet.com.au@sunsite.auc.dk Thu Oct 14 12:30:42 1999
Return-Path: <zsh-workers-return-8250-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2538 invoked from network); 14 Oct 1999 12:30:41 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 14 Oct 1999 12:30:41 -0000
Received: (qmail 1671 invoked by alias); 14 Oct 1999 12:27:22 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8250
Received: (qmail 1663 invoked from network); 14 Oct 1999 12:27:21 -0000
Date: Thu, 14 Oct 1999 13:27:17 +0100
From: Adam Spiers <adam@thelonious.new.ox.ac.uk>
To: zsh-workers@sunsite.auc.dk
Subject: CVS again (Re: Module idea to help developers)
Message-ID: <19991014132717.A12940@thelonious.new.ox.ac.uk>
Reply-To: Adam Spiers <adam@spiers.net>
Mail-Followup-To: zsh-workers@sunsite.auc.dk
References: <991013162014.ZM14485@candle.brasslantern.com> <19991013144233.A23715@dman.com> <991014034839.ZM15300@candle.brasslantern.com> <3805B5F1.E70D351A@u.genie.co.uk> <991013162014.ZM14485@candle.brasslantern.com> <19991013144233.A23715@dman.com> <991014034839.ZM15300@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0pre2i
In-Reply-To: <991014034839.ZM15300@candle.brasslantern.com>
X-URL: http://www.new.ox.ac.uk/~adam/
X-OS: Linux 2.2.12 i686

Bart Schaefer (schaefer@candle.brasslantern.com) wrote:
> I agree, but that presupposes a CVS archive, which we've made no progress
> on establishing over the last two or three months that it's been under
> serious consideration.  The Sunsite Denmark folks are completely silent
> (I don't think they're even looking at the zsh-*-owner mail right now)
> and PWS is apparently offline for an indeterminate time.  I was hoping
> for something quick but effective in the meantime.

I have access to a well-specced and reliable RedHat box with a
high-bandwidth connection in the UK, use of which as a temporary
zsh-workers CVS facility would be welcome.  Then when the Sunsite
people re-emerge, it could be moved there if so desired.

Oliver Kiddle (opk@u.genie.co.uk) wrote:
> How do you extract patches from e-mails - I'd be inclined to write a
> filter which takes the message header to grab the message number and
> puts it in a file.

I already did that:

-------- 8< -------- 8< --------
#!/usr/bin/perl -w

use strict;

use Mail::Util qw(read_mbox);
use Mail::Internet;

my $tmp_file = "/tmp/zsh.patch.delivery.$$";
my $dest_dir = '/home/localadams/IN/zsh-patches';

open(TMP, ">$tmp_file") or die $!;
print TMP <>;
close(TMP) or die $!;

my @msgs = read_mbox($tmp_file);

foreach my $msg (@msgs) {
  my $mail = new Mail::Internet $msg;
  if ($mail->head->get('From ') =~ /^zsh-workers-return-(\d+)/) {
    my $id = $1;
    my $dest = "$dest_dir/$id";
    if (-e $dest) {
      warn "File $dest already existed!  Skipping ...\n";
    }
    else {
      open(OUT, ">$dest_dir/$id") or die $!;
      $mail->print(\*OUT);
      close(OUT) or die $!;
    }
  }
  else {
    my $subject = $mail->head->get('Subject');
    warn "Couldn't get id from message `$subject'; discarding.\n";
  }  
}

unlink $tmp_file;

exit 0;
-------- 8< -------- 8< --------

(Temp file security risk ignored 'cos I wrote it for my laptop.)

I also automated the rpm-building process.

> It can then also cut out the patch.

Why bother?  It's nice to keep the text, and patch extracts the patch
automatically anyway.

> > and PWS is apparently offline for an indeterminate time.  I was hoping
> > for something quick but effective in the meantime.

Eek, I hadn't realised.

> If PWS is going to be away for a while then it might help a lot if
> someone else releases an intermediate release. 

Agreed.  Bart? :-)

> I rarely apply c-code patches because it's not normally a long wait
> to the next pws release but I had wanted to apply a couple of Sven's
> recent patches. I had little success with this so I'll either have
> to get all the patches from the archive or wait.

This should be a good kickstart excuse for getting a CVS repository
into action.

