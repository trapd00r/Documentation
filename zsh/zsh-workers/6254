From zsh-workers-return-6254-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 11 08:31:17 1999
Return-Path: <zsh-workers-return-6254-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 11402 invoked from network); 11 May 1999 08:31:16 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 11 May 1999 08:31:16 -0000
Received: (qmail 6016 invoked by alias); 11 May 1999 08:30:45 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6254
Received: (qmail 6009 invoked from network); 11 May 1999 08:30:44 -0000
Message-Id: <9905110806.AA14078@ibmth.df.unipi.it>
To: zsh-workers@sunsite.auc.dk
Subject: Re: success (mostly) pws 17 under NeXTStep 3.3 
In-Reply-To: "Timothy J Luoma"'s message of "Mon, 10 May 1999 22:40:11 DFT."
             <199905110240.WAA18115@ocalhost> 
Date: Tue, 11 May 1999 10:06:23 +0200
From: Peter Stephenson <pws@ibmth.df.unipi.it>

Timothy J Luoma wrote:
> Using regular NeXT 3.3 'cc' and 'make'
> 
> 	configure ok
> 	
> 	make dies with '.pro' errors

That's a strange make, since it hasn't built the .pro files at all, which
are in the dependencies for zsh.mdh.

> (it failed at the end, after making 'zsh' -- I think because I don't have  
> the 'yodl' program -- shouldn't it recognize that and not try and build the  
> documentation?)

In the released version, the documentation is up to date, so that yodl is
only necessary if you alter the files.  You can avoid this here by getting
hold of the .doc.tar file from the same place and untarring it on top of
the source code.

> Users/                  private/
> 
> # /bin/ls -F /U[tab]
> # /bin/ls -F /U[cursor still here]
> 
> (ALL of the other files in / complete successfully)

The code in question is in get_matches_files() in Src/Zle/zle_tricky.c.
The main possibilities are that either zreaddir() and hence readdir() are
missing out Users, in which case ls probably wouldn't show it up, or that
the stat() call later on fails and the directory is skipped.  You can test
the effect of stat() if you have compiled zsh with dynamically loaded
libraries, by using `zmodload stat; stat -rs /Users', or see the main
README file about how to get the file stat.so compiled into the base
executable.  Maybe ls -ld /Users would give a clue, since that's basically
a stat() as well.

Another possibility is that the macro access(..., F_OK) is failing.  The
following shell code should do exactly the same check:

[[ -e /Users ]] && print file exists || print file doesn\'t exist

-- 
Peter Stephenson <pws@ibmth.df.unipi.it>       Tel: +39 050 844536
WWW:  http://www.ifh.de/~pws/
Dipartimento di Fisica, Via Buonarroti 2, 56127 Pisa, Italy

