From zsh-workers-return-21634-mason-zsh=primenet.com.au@sunsite.dk Tue Aug 16 07:58:36 2005
Return-Path: <zsh-workers-return-21634-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 27513 invoked from network); 16 Aug 2005 07:58:34 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 16 Aug 2005 07:58:34 -0000
Received: (qmail 2239 invoked from network); 16 Aug 2005 07:58:27 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 16 Aug 2005 07:58:27 -0000
Received: (qmail 6394 invoked by alias); 16 Aug 2005 07:58:24 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 21634
Received: (qmail 6384 invoked from network); 16 Aug 2005 07:58:23 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 16 Aug 2005 07:58:23 -0000
Received: (qmail 2003 invoked from network); 16 Aug 2005 07:58:23 -0000
Received: from flock1.newmail.ru (212.48.140.157)
  by a.mx.sunsite.dk with SMTP; 16 Aug 2005 07:58:19 -0000
Received: (qmail 31177 invoked from network); 16 Aug 2005 07:50:51 -0000
Received: from unknown (HELO ?10.0.0.53?) (arvidjaar@newmail.ru@83.237.61.42)
  by smtpd.newmail.ru with SMTP; 16 Aug 2005 07:50:51 -0000
From: Andrey Borzenkov <arvidjaar@newmail.ru>
To: zsh-workers@sunsite.dk
Subject: Re: crash in completing code with unicode support
Date: Tue, 16 Aug 2005 11:57:58 +0400
User-Agent: KMail/1.8.2
Cc: Mikael Magnusson <mikachu@gmail.com>
References: <237967ef05081518376385563e@mail.gmail.com>
In-Reply-To: <237967ef05081518376385563e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/signed;
  boundary="nextPart1542171.3RAI88cETa";
  protocol="application/pgp-signature";
  micalg=pgp-sha1
Content-Transfer-Encoding: 7bit
Message-Id: <200508161157.59407.arvidjaar@newmail.ru>
X-Spam-Checker-Version: SpamAssassin 3.0.4 (2005-06-05) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=AWL,BAYES_00 autolearn=ham 
	version=3.0.4

--nextPart1542171.3RAI88cETa
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

On Tuesday 16 August 2005 05:37, Mikael Magnusson wrote:
> I tried the recent developments with unicode support, and it's going
> pretty well. I can write text in zle without it showing up as
> ^{saa'*^+{^ instaed of actual text. Backspacing over doublewidth
> characters only steps back one cell, but i understand this has not
> been worked on yet.

this works for me using UTF-8 Russian. Backward word has problems but backw=
ord=20
char works. Or do you mean, characters with double display width? I am not=
=20
aware of these in European languages?

> One problem i have encountered though, is if i=20
> have a couple file that starts with the same multibyte character (it
> seems to be important that it is at the very beginning of the name),
> and then different endings, zsh crashes when i try to tabcomplete
> them. An obvious case where this happens is tabcompleting mp3 files
> where the artist's name starts with =C3=98 (a danish capital O with a /
> through it, any of =C3=A5=C3=A4=C3=B6=C3=A6=C3=B8=C3=85=C3=84=C3=96=C3=86=
=C3=98 seems to do the same thing too).

Does not crash here but looks pretty weird:

{pts/1}% pkg/bin/zsh -f
localhost% cd tmp/foo
localhost% autoload -U compinit; compinit
localhost% la =D0=A4
\M-P\M-$1  \M-P\M-$2
localhost% ls
=D0=A41  =D0=A42

When I continue to complete it inserts correct string in command line so it=
 is=20
just listing that is wrong.

Using complist/menuselect works just nicely. Could you please try to reprod=
uce=20
it using zsh -f with the smallest set of extra options. And please, show=20
UTF-8 (or UNICDOE) representation of characters that crash zsh and yuor OS=
=20
and locale settings.

=2Dandrey


--nextPart1542171.3RAI88cETa
Content-Type: application/pgp-signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.0 (GNU/Linux)

iD8DBQBDAZyHR6LMutpd94wRAo94AKCTAXlelY6Y7F0OpOCf8OdXwOm7IgCgx9Kc
mQ1uTE4IekGYjyNivi7Qx+A=
=vcyf
-----END PGP SIGNATURE-----

--nextPart1542171.3RAI88cETa--

