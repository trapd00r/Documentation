From zsh-workers-return-11272-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 09 09:42:45 2000
Return-Path: <zsh-workers-return-11272-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15142 invoked from network); 9 May 2000 09:42:44 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 May 2000 09:42:44 -0000
Received: (qmail 16067 invoked by alias); 9 May 2000 09:42:35 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 11272
Received: (qmail 16049 invoked from network); 9 May 2000 09:42:34 -0000
Date: Tue, 9 May 2000 11:42:33 +0200 (MET DST)
Message-Id: <200005090942.LAA13744@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: Tanaka Akira's message of 08 May 2000 20:14:17 +0900
Subject: PATCH: Re: `no more arguments' is not displayed.


Tanaka Akira wrote:

> Z(4):akr@serein% Src/zsh -f  
> serein% bindkey -e; fpath=($PWD/Completion/*(/)); autoload -U compinit; compinit -D; compdef _tst tst
> serein% zstyle ':completion:*' group-name ''
> serein% zstyle ':completion:*:messages' format %d
> serein% zstyle ':completion:*:descriptions' format %d
> serein% _tst () { _arguments ":desc1:(arg1)" }
> serein% tst a <TAB>
> 
> This doesn't show `no more arguments' now.
> (Try `make check'.)

Oops.

Bye
 Sven

Index: Completion/Base/_arguments
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Base/_arguments,v
retrieving revision 1.12
diff -u -r1.12 _arguments
--- Completion/Base/_arguments	2000/05/08 10:37:58	1.12
+++ Completion/Base/_arguments	2000/05/09 09:41:04
@@ -182,8 +182,10 @@
     else
       noargs='no arguments'
     fi
-    comparguments -O next direct odirect equal || return 1
-
+    if ! comparguments -O next direct odirect equal; then
+      _message "$noargs"
+      return 1
+    fi
     opts=yes
     _tags options
   fi

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

