From zsh-workers-return-25861-mason-zsh=primenet.com.au@sunsite.dk Sun Oct 12 19:43:15 2008
Return-Path: <zsh-workers-return-25861-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4409 invoked from network); 12 Oct 2008 19:43:01 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.3 required=5.0 tests=AWL autolearn=unavailable
	version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 12 Oct 2008 19:43:01 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 54449 invoked from network); 12 Oct 2008 19:42:53 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 12 Oct 2008 19:42:53 -0000
Received: (qmail 15295 invoked by alias); 12 Oct 2008 19:42:46 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 25861
Received: (qmail 15279 invoked from network); 12 Oct 2008 19:42:44 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 12 Oct 2008 19:42:44 -0000
Received: from mtaout01-winn.ispmail.ntl.com (mtaout01-winn.ispmail.ntl.com [81.103.221.47])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 4CB6E80524C0
	for <zsh-workers@sunsite.dk>; Sun, 12 Oct 2008 21:42:40 +0200 (CEST)
Received: from aamtaout03-winn.ispmail.ntl.com ([81.103.221.35])
          by mtaout01-winn.ispmail.ntl.com with ESMTP
          id <20081012194239.JCPQ2285.mtaout01-winn.ispmail.ntl.com@aamtaout03-winn.ispmail.ntl.com>
          for <zsh-workers@sunsite.dk>; Sun, 12 Oct 2008 20:42:39 +0100
Received: from pws-pc ([81.107.43.40]) by aamtaout03-winn.ispmail.ntl.com
          with ESMTP
          id <20081012194239.CHHQ2093.aamtaout03-winn.ispmail.ntl.com@pws-pc>
          for <zsh-workers@sunsite.dk>; Sun, 12 Oct 2008 20:42:39 +0100
Date: Sun, 12 Oct 2008 20:42:36 +0100
From: Peter Stephenson <p.w.stephenson@ntlworld.com>
To: "Zsh Hackers' List" <zsh-workers@sunsite.dk>
Subject: Re: Regression in braces completion
Message-ID: <20081012204236.6669a668@pws-pc>
In-Reply-To: <081012001051.ZM30706@torch.brasslantern.com>
References: <20a807210810111932r1b32b746l3cca788a383e84ed@mail.gmail.com>
	<081011213249.ZM29979@torch.brasslantern.com>
	<081012001051.ZM30706@torch.brasslantern.com>
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.12; x86_64-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-Cloudmark-Analysis: v=1.0 c=1 a=NLZqzBF-AAAA:8 a=16T6j15PpQN3NG4XuIsA:9 a=WdzASjF2_EiFHra1h7MA:7 a=-KujoLycydyHtHw6ux8hVggPQ6IA:4 a=I6wTmPyJxzYA:10 a=_dQi-Dcv4p4A:10 a=LY0hPdMaydYA:10
X-Virus-Scanned: ClamAV 0.92.1/8414/Sun Oct 12 05:30:50 2008 on bifrost
X-Virus-Status: Clean

On Sun, 12 Oct 2008 00:10:51 -0700
Bart Schaefer <schaefer@brasslantern.com> wrote:
> (That took *way* longer to track down than it should have, because I
> didn't realize just how *many* calls to "compadd -U" there are, and I
> missed the crucial one the first time and ended up chasing a different
> red herring for an hour.  Oy.)

I don't know what they're all doing, either.

> Removing the -U *only* from the compadd on line 634 of _path_files is
> sufficient to fix this particular example, but I wonder if it should be
> removed from all three of the compadd calls in the "we are listing, or
> something" branch (see comment line 605), or if it needs to be omitted
> based on some other condition ... or if we need to know when spelling
> correction has been done so we can only add -U when we have to, or some
> even more complicated set of conditions.

There will be an underlying reason why this particular case inserts the
brace in the wrong place.  It will take many hours of work to find out.

-- 
Peter Stephenson <p.w.stephenson@ntlworld.com>
Web page now at http://homepage.ntlworld.com/p.w.stephenson/

