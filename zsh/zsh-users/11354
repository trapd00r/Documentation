From zsh-users-return-11354-mason-zsh=primenet.com.au@sunsite.dk Tue Mar 27 23:34:39 2007
Return-Path: <zsh-users-return-11354-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 1412 invoked from network); 27 Mar 2007 23:34:37 -0000
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.5 required=5.0 tests=BAYES_00,FORGED_RCVD_HELO
	autolearn=ham version=3.1.8
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 27 Mar 2007 23:34:37 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 93433 invoked from network); 27 Mar 2007 23:34:30 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 27 Mar 2007 23:34:30 -0000
Received: (qmail 21236 invoked by alias); 27 Mar 2007 23:34:23 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 11354
Received: (qmail 21226 invoked from network); 27 Mar 2007 23:34:22 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 27 Mar 2007 23:34:22 -0000
Received: (qmail 92238 invoked from network); 27 Mar 2007 23:34:22 -0000
Received: from s1tank.virtdom.com (216.240.101.50)
  by a.mx.sunsite.dk with SMTP; 27 Mar 2007 23:34:17 -0000
Received: (qmail 88912 invoked by uid 89); 27 Mar 2007 23:41:47 -0000
Received: from ool-4577886b.dyn.optonline.net (HELO venti) (brian@aljex.com@69.119.136.107)
  by s1tank.virtdom.com with SMTP; 27 Mar 2007 23:41:47 -0000
Message-ID: <000701c770c8$6d497810$9502a8c0@venti>
From: "Brian K. White" <brian@aljex.com>
To: <zsh-users@sunsite.dk>
References: <20070327175336.GA22601@solfire> <003c01c770a2$5bb43ca0$9502a8c0@venti> <20070327193132.GD4885@sc.homeunix.net> <007001c770ad$1da98310$9502a8c0@venti> <20070327203233.GB21656@fsst.voodoo.lan>
Subject: Re: Lonely spacecowboy
Date: Tue, 27 Mar 2007 19:34:12 -0400
Organization: Aljex Software
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="iso-8859-1";
	reply-type=original
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3028
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3028


----- Original Message ----- 
From: "Frank Terbeck" <ft@bewatermyfriend.org>
To: <zsh-users@sunsite.dk>
Sent: Tuesday, March 27, 2007 4:32 PM
Subject: Re: Lonely spacecowboy


> Brian K. White <brian@aljex.com>:
>> Stephane Chazelas <Stephane_Chazelas@yahoo.fr>:
>> >On Tue, Mar 27, 2007 at 03:01:42PM -0400, Brian K. White wrote:
> [...]
>> >>The difference is "|read" creates a child process that read runs in, 
>> >>and
>> >>any env variables set in that child process are not visible from the
>> >>parent, and the while-do-done command (and all commands in that loop) 
>> >>ar
>> >>running in the parent.
>> >
>> >While this is true for bash and pdksh it's not true for zsh:
>> >
>> >~$ echo foo | read
>> >~$ echo $REPLY
>> >foo
> [...]
>> It doesn't work in one enviroment I use zsh a lot in.
>>
>> $P$Gecho this is a test |read aa bb cc
>> $P$Gecho $aa $bb $cc
>>
>> $P$G
>>
>> This is latest freestanding (static binary not needing cygwin dll) 
>> version
>> of zsh for windows that I have been able to locate, which is quite old,
>> $P$Gecho $VERSION
>> 3.0.5.001
>> $P$G
>
> Hm, I don't know about the specifics of the native windows port of
> zsh. But AFAIK, zsh versions v3 and above do not set $VERSION but
> $ZSH_VERSION. I tried the above on a linux v2.6 system:
>
> [snip]
> zsh% echo this is a test |read aa bb cc
> zsh% echo $aa $bb $cc
> this is a test
> zsh% echo $ZSH_VERSION
> 3.0.4
> zsh% echo $VERSION
>
> [snap]
>
> I don't know if the technique used to make this possible on unixoid
> systems is not applicable on windows systems.
>
> Regards, Frank

Aha. Turned out VERSION was coming from the parent. cmd.exe shows:
C:\Documents and Settings\bkw>echo %VERSION%
3.0.5.001


The real versions are:

The stand-alone version:
----------------
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\Documents and Settings\bkw>cd \aljex

C:\Aljex>.\zsh.exe
$P$Gecho $ZSH_VERSION
3.0.5-nt-sniff-4.1.1p2
$P$Gecho this is a test |read aa bb cc
$P$Gecho $aa $bb $cc
this is a test
$P$G
----------------


The cygwin version (just updated a minute ago):
----------------
bash-3.2$ zsh
$P$Gecho $ZSH_VERSION
4.3.2
$P$Gecho this is a test |read aa bb cc
$P$Gecho $aa $bb $cc
this is a test
$P$G
----------------


I can't explain why |read didn't work 20 minutes ago in the standalone 
version and does now, but I'll happily take it. :)

Brian K. White    brian@aljex.com    http://www.myspace.com/KEYofR
+++++[>+++[>+++++>+++++++<<-]<-]>>+.>.+++++.+++++++.-.[>+<---]>++.
filePro  BBx    Linux  SCO  FreeBSD    #callahans  Satriani  Filk!

