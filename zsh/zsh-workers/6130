From zsh-workers-return-6130-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Apr 28 07:49:05 1999
Return-Path: <zsh-workers-return-6130-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 24557 invoked from network); 28 Apr 1999 07:49:04 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 28 Apr 1999 07:49:04 -0000
Received: (qmail 3666 invoked by alias); 28 Apr 1999 07:48:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6130
Received: (qmail 3623 invoked from network); 28 Apr 1999 07:48:15 -0000
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <990428001558.ZM848@candle.brasslantern.com>
Date: Wed, 28 Apr 1999 00:15:58 -0700
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: zsh-workers@sunsite.auc.dk
Subject: Release candidate patch for 3.0.6
Cc: Greg Badros <gjb@cs.washington.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

I've made up a a third pre-patch for 3.0.6, which carries the version number
3.0.6-pre-2.  The set is now:
        ftp://ftp.brasslantern.com/pub/zsh/zsh-3.0.5-3.0.6-pre-0.diff
        ftp://ftp.brasslantern.com/pub/zsh/zsh-3.0.6-pre-0-pre-1.diff
        ftp://ftp.brasslantern.com/pub/zsh/zsh-3.0.6-pre-1-pre-2.diff

Remember that after applying patches to 3.0.5, you must "touch stamp-h.in"
before running configure to prevent make from attempting to rerun autoconf
and autoheader.

Checksums on the latest diff:

(BSD)  47228   107
(SYSV) 55939 214 zsh-3.0.6-pre-1-pre-2.diff

This patch is slightly larger than the others, although it includes fewer
real changes.  The accumulated FAQ changes form a large diff, and deleting
all the RCS $Id...$ lines made for a whole lot of small ones.

A word on zsh.h macros:  I didn't change STOPHIST and ALLOWHIST, which
include trailing semicolons in their definitions and hence must be used
without one.  Strictly speaking, those macros should be used the way that
PERMALLOC and LASTALLOC are, but to actually make them include matching
braces would force a considerable reorganization of the lexer code; not
worth doing in 3.0.  So ...

Except for the minor items noted below, I believe the code to be ready for
release as 3.0.6.  However, I'm going to wait a bit to see if any other
comments or bugs crop up (Ville Herva's timing was good today).  I'm a bit
concerned that 3.0.6 is not getting tested much because most zsh-workers
are running -pws-16.

Things that still might happen:

* The config.log and an empty config.cache were erroneously (?) included
  in the 3.0.5 tar file. Unless somebody can tell me why not to, I'll
  delete them from the final 3.0.6.

* I'll also likely delete the Src/tags and Src/TAGS files.  Looks like
  they were actually in RCS at some point (see the Makefile), but my
  ctags program produces a file almost twice as large as the old one,
  so I'm not confident I can regenerate them reliably.  Suggestions?

* I might still be talked out of the macro changes in zsh.h.

* I haven't done anything with Greg Badros's color completion patches;
  nobody on zsh-workers has commented on this, but it just occurred to
  me that Greg himself might not be on zsh-workers, so I've explicitly
  Cc'd him.  I personally am completely indifferent to colorizing.

Here are the new ChangeLog entries since -pre-1:

+ 1999-04-28 05:29  Bart Schaefer <schaefer@zsh.org>
+ 
+ 	* Src/zle_main.c: Move setting of timeval tv_sec = 0 to immediately
+ 	before select() to work around obscure Linux problem where select()
+ 	may write garbage into tv_sec after the kernel has been running for
+ 	248 days.  Linux problem and its workaround reported by Ville Herva
+ 	<vherva@babbage.tky.hut.fi> in zsh-workers 6126.
+ 
+ 1999-04-28 05:20  Bart Schaefer <schaefer@zsh.org>
+ 
+ 	* INSTALL, Makefile.in, configure.in, Doc/Makefile.in,
+ 	Etc/Makefile.in, Functions/Makefile.in, Misc/Makefile.in,
+ 	Misc/compctl-examples, Src/Makefile.in, Src/builtin.c,
+ 	Src/compat.c, Src/cond.c, Src/exec.c, Src/glob.c, Src/globals.h,
+ 	Src/hashtable.c, Src/hashtable.h, Src/hist.c, Src/init.c,
+ 	Src/input.c, Src/jobs.c, Src/lex.c, Src/linklist.c, Src/loop.c,
+ 	Src/math.c, Src/mem.c, Src/params.c, Src/parse.c, Src/prototypes.h,
+ 	Src/rlimits.awk, Src/signals.c, Src/signals.h, Src/signames.awk,
+ 	Src/subst.c, Src/system.h, Src/text.c, Src/utils.c, Src/watch.c,
+ 	Src/zle.h, Src/zle_bindings.c, Src/zle_hist.c, Src/zle_main.c,
+ 	Src/zle_misc.c, Src/zle_move.c, Src/zle_refresh.c,
+ 	Src/zle_tricky.c, Src/zle_utils.c, Src/zle_vi.c, Src/zle_word.c,
+ 	Src/ztype.h, StartupFiles/Makefile.in, StartupFiles/zlogin,
+ 	StartupFiles/zshenv, StartupFiles/zshrc, Util/Makefile.in,
+ 	Util/reporter, Util/zsh-development-guide: Remove $Id...$ line.
+ 
+ 	* Src/zsh.h: Remove $Id...$ line.  Change all macros that use "if
+ 	(...) {;} else ..." to be unambiguous statements, mostly by
+ 	wrapping in "do { ... } while (0)".
+ 
+ 1999-04-28 05:16  Bart Schaefer <schaefer@zsh.org>
+ 
+ 	* Etc/FAQ: Update to latest FAQ.  Remove $ from around $Id ... $
+ 	line to freeze RCS id.
+ 
+ 1999-04-25 17:17  schaefer
+ 
+ 	* Src/globals.h, Src/zle_refresh.c, Src/zsh.h: Tatsuo Furukawa
+ 	<frkwtto@osk3.3web.ne.jp> change to use absolute cursor move when
+ 	available, from zsh-workers 6073, as modified by Geoff Wing in
+ 	6096.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

