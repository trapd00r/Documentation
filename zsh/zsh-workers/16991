From zsh-workers-return-16991-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 16 07:55:15 2002
Return-Path: <zsh-workers-return-16991-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 7651 invoked from network); 16 Apr 2002 07:55:14 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 16 Apr 2002 07:55:14 -0000
Received: (qmail 2655 invoked by alias); 16 Apr 2002 07:55:05 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16991
Received: (qmail 2640 invoked from network); 16 Apr 2002 07:55:05 -0000
From: Sven Wischnowsky <wischnow@berkom.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15547.55463.213608.45857@wischnow.berkom.de>
Date: Tue, 16 Apr 2002 09:54:15 +0200
To: zsh-workers@sunsite.dk
Subject: Re: _values does not quote inserted matches
In-Reply-To: <1020413232614.ZM7461@candle.brasslantern.com>
References: <1018730307.16430.1.camel@localhost.localdomain>
	<1020413232614.ZM7461@candle.brasslantern.com>
X-Mailer: VM 6.95 under 21.5 (patch 3) "asparagus" XEmacs Lucid


Bart Schaefer wrote:

> On Apr 14, 12:38am, Borsenkow Andrej wrote:
> } Subject: _values does not quote inserted matches
> }
> } note, that match inserted into command line is not quoted that makes it
> } impossible to complete more than one value.
> 
> The problem is this stuff at lines 54-58 of _values:
> 
>       if [[ ${#noargs}+${#args}+${#opts} -ne 1 ]] && compvalues -s sep; then
>         sep=( "-qQS" "$sep" )
>       else
>         sep=()
>       fi
> 
> I don't know why the Q is included on line 55?  It seems to all work OK if
> I take it out.

Same for me. And I couldn't find when we added this, so it's probably
very old, from a time when _values was less sophisticated about
separators with special characters or something.

So, let's try.


Bye
  Sven

Index: Completion/Base/Utility/_values
===================================================================
RCS file: /cvsroot/zsh/zsh/Completion/Base/Utility/_values,v
retrieving revision 1.7
diff -u -r1.7 _values
--- Completion/Base/Utility/_values	22 Jan 2002 10:22:48 -0000	1.7
+++ Completion/Base/Utility/_values	16 Apr 2002 07:54:35 -0000
@@ -51,7 +51,7 @@
     else
       compvalues -d descr
       if [[ ${#noargs}+${#args}+${#opts} -ne 1 ]] && compvalues -s sep; then
-        sep=( "-qQS" "$sep" )
+        sep=( "-qS" "$sep" )
       else
         sep=()
       fi

-- 
Sven Wischnowsky                          wischnow@berkom.de

