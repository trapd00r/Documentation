From zsh-workers-return-7057-mason-zsh=primenet.com.au@sunsite.auc.dk Fri Jul 09 08:28:16 1999
Return-Path: <zsh-workers-return-7057-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 17385 invoked from network); 9 Jul 1999 08:28:14 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 Jul 1999 08:28:14 -0000
Received: (qmail 3128 invoked by alias); 9 Jul 1999 08:28:06 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7057
Received: (qmail 3121 invoked from network); 9 Jul 1999 08:28:06 -0000
Date: Fri, 9 Jul 1999 10:28:04 +0200 (MET DST)
Message-Id: <199907090828.KAA13033@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
In-reply-to: "Andrej Borsenkow"'s message of Thu, 8 Jul 1999 20:26:19 +0400
Subject: Re: Big problems RE: Problem with cursor position after wrapped completion lists


Andrej Borsenkow wrote:

> Note the extra "  " at the end of every match that is listed. I have no idea,
> where it comes from. Probably, without this extra " " nobody would even notice
> this problem.

setopt listtypes, I guess.

> Actually, list display does not work at all if terminal does not do automargins
> (and even if it correctly says it in terminfo) and size of a single match exeeds
> COLUMNS-2 (the is the last size that works). List display thinks that terminal
> always does am (at least, this is how I interpret this) and gets number of lines
> wrong and moves cursor far above original prompt :-) If you can switch am off,
> just try it - it is funny.

There is also a bit of extra padding at the end of each match. With
normal listing this shouldn't be printed for the last match of each
line, but with complist it is (to have the right margin nicely aligned 
if someone sets the bcakground colour).

mason@primenet.com.au wrote:

> I'm pretty sure zle_refresh.c violates this in some special cases (prompt
> things I think) so I guess I better fix those soonish.  Printing outside of
> zle_refresh.c I've got no idea about.

I'll just wait for this solution and then hack the completion listing
code, we'll probably end up with some utility functions that at least
try to return some information about the current cursor-position or
the number of characters printed in this process. Then we can decide
what else we want to do with them.

Bye
 Sven


--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

