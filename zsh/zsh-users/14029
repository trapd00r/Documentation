From zsh-users-return-14029-mason-zsh=primenet.com.au@sunsite.dk Sat Apr 11 09:22:47 2009
Return-Path: <zsh-users-return-14029-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8696 invoked from network); 11 Apr 2009 09:22:43 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-1.7 required=5.0 tests=AWL,BAYES_00,LONGWORDS
	autolearn=no version=3.2.5
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 11 Apr 2009 09:22:43 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 108 invoked from network); 11 Apr 2009 09:22:31 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 11 Apr 2009 09:22:31 -0000
Received: (qmail 16200 invoked by alias); 11 Apr 2009 09:22:11 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14029
Received: (qmail 16190 invoked from network); 11 Apr 2009 09:22:10 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 11 Apr 2009 09:22:10 -0000
Received: from donnergurgler.informatik.uni-erlangen.de (meinungsverstaerker.de [213.239.249.194])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id F12E482D4B6A
	for <zsh-users@sunsite.dk>; Sat, 11 Apr 2009 11:22:06 +0200 (CEST)
Received: from yogan by donnergurgler.informatik.uni-erlangen.de with local (Exim 4.69 #1 (Debian))
	id 1LsZPZ-0004zm-Lk
	for <zsh-users@sunsite.dk>; Sat, 11 Apr 2009 11:22:05 +0200
Date: Sat, 11 Apr 2009 11:22:00 +0200
From: Frank Blendinger <fb@intoxicatedmind.net>
To: zsh-users@sunsite.dk
Subject: Re: Escaping of : in a _describe completion
Message-ID: <20090411092200.GD11551@intoxicatedmind.net>
Mail-Followup-To: zsh-users@sunsite.dk
References: <20090411020319.GF4047@intoxicatedmind.net> <200904110910.20171.arvidjaar@gmail.com> <20090411081526.GA11551@intoxicatedmind.net> <200904111231.12449.arvidjaar@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="Qz2CZ664xQdCRdPu"
Content-Disposition: inline
In-Reply-To: <200904111231.12449.arvidjaar@gmail.com>
User-Agent: Mutt/1.5.18 (2008-05-17)
Sender: Frank Blendinger <yogan@meinungsverstaerker.de>
X-Virus-Scanned: ClamAV 0.92.1/9224/Fri Apr 10 23:49:29 2009 on bifrost
X-Virus-Status: Clean


--Qz2CZ664xQdCRdPu
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hi.

On Sat 2009-04-11 12:31, Andrey Borzenkov <arvidjaar@gmail.com>
proclaimed:
> It does here so you must be doing something differently.
>=20
> {pts/3}% _etherwake() {
>  typeset -a etherwake_desc;
>  etherwake_desc=3D('00\:0c\:6e\:74\:16\:77:host1'=20
> '00\:1b\:63\:31\:4a\:6b:host2');
>  _describe etherwake etherwake_desc;
>  }
> {pts/3}% compdef _etherwake etherwake
> {pts/3}% etherwake 00:0c:6e:74:16:77
> Completing etherwake
> 00:0c:6e:74:16:77  -- host1
> 00:1b:63:31:4a:6b  -- host2
>=20
>=20
> > It will
> > complete the leading ``00:'' part, but then it stops.
>=20
> You have to "setopt menucomplete" to make it display lists immediately.=
=20
> Default it to insert longest common prefix and wait for you to=20
> disambiguate.

This works for my other (non self written) completions, i.e. cd /s<Tab>
will show me a menu with ``sbin/ selinux/ srv/ sys/''

I have the following settings in my ~/.zsh/* files:

    setopt auto_list
    setopt auto_menu

    zstyle ':completion:*' add-space true                                  =
                                                     =20
    zstyle ':completion:*' completer _expand _complete _list
    zstyle ':completion:*' menu select=3D2
    zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
    zstyle ':completion:*' use-cache on
    zstyle ':completion:*' cache-path ~/.zsh/cache

    zstyle ':completion:*' matcher-list 'm:{a-z}=3D{A-Z}'

    zstyle ':completion:*:descriptions' format '%B%UComplete-o-matic%u %d%b'
    zstyle ':completion:*' group-name ''
    zstyle ':completion:*:-command-' group-order builtins functions commands

    zstyle ':completion:*:*:kill:*:processes' list-colors '=3D(#b) #([0-9]#=
)*=3D0=3D01;31'=20

I hope I did not miss any relevant settings.

I added a ``setopt menucomplete'', and now it works. But this also
changes the completion behaviour: previously, I would get the menu shown
on my first <Tab>, but nothing yet selected, the second <Tab> did that.
With ``setopt menucomplete'', the first <Tab> selects. I am not sure if
I like that...

Could I get my old behaviour somehow, with a menu of my etherwake
completion showing up after the second <Tab>?

> > Pressing <Tab>
> > again after that won't bring up the completion menu, as zsh does for
> > my other completions, even if I manually enter a `0' or `1' to
> > distinguish the both available arguments.
>=20
> Enter where? Anyway, this is completely different problem. Now=20
> *completion* is correct but *display* not :)

Enter on the command line, right after the ``00:'' part that the
completer put there.


> Could you show you options and styles (setopt; zstyle -L)?

Sure:

alwaystoend
autopushd
nobeep
chaselinks
completeinword
correct
extendedglob
noglobalexport
nohistbeep
histfindnodups
histignorealldups
histignoredups
histsavenodups
interactive
interactivecomments
nolistbeep
listpacked
longlistjobs
markdirs
menucomplete
monitor
nonomatch
promptsubst
pushdignoredups
pushdsilent
pushdtohome
sharehistory
shinstdin
transientrprompt
vi
zle

zstyle ':completion:*' add-space true
zstyle ':completion:*' cache-path /home/yogan/.zsh/cache
zstyle ':completion:*:sudo:*' command-path /usr/local/sbin /usr/local/bin /=
usr/sbin /usr/bin /sbin /bin /usr/X11R6/bin
zstyle ':completion:*' completer _expand _complete _list
zstyle ':completion:*:descriptions' format '%B%UComplete-o-matic%u %d%b'
zstyle ':completion:*' group-name ''
zstyle ':completion:*:-command-' group-order builtins functions commands
zstyle ':completion:*:*:kill:*:processes' list-colors '=3D(#b) #([0-9]#)*=
=3D0=3D01;31'
zstyle ':completion:*' list-colors 'rs=3D0' 'di=3D01;34' 'ln=3D04' 'hl=3D44=
;37' 'pi=3D40;33' 'so=3D40;35' 'do=3D40;31' 'bd=3D40;33;01' 'cd=3D40;33;01'=
 'or=3D40;31;01' 'su=3D37;41' 'sg=3D30;43' 'ca=3D30;41' 'tw=3D30;44' 'ow=3D=
31;44' 'st=3D37;44' 'ex=3D01;32' '*.tar=3D01;31' '*.tgz=3D01;31' '*.arj=3D0=
1;31' '*.taz=3D01;31' '*.lzh=3D01;31' '*.lzma=3D01;31' '*.zip=3D01;31' '*.z=
=3D01;31' '*.Z=3D01;31' '*.dz=3D01;31' '*.gz=3D01;31' '*.bz2=3D01;31' '*.bz=
=3D01;31' '*.tbz2=3D01;31' '*.tz=3D01;31' '*.deb=3D01;31' '*.rpm=3D01;31' '=
*.jar=3D01;31' '*.rar=3D01;31' '*.ace=3D01;31' '*.zoo=3D01;31' '*.cpio=3D01=
;31' '*.7z=3D01;31' '*.rz=3D01;31' '*.jpg=3D01;35' '*.jpeg=3D01;35' '*.JPG=
=3D01;35' '*.JPEG=3D01;35' '*.gif=3D01;35' '*.bmp=3D01;35' '*.pbm=3D01;35' =
'*.pgm=3D01;35' '*.ppm=3D01;35' '*.tga=3D01;35' '*.xbm=3D01;35' '*.xpm=3D01=
;35' '*.tif=3D01;35' '*.tiff=3D01;35' '*.png=3D01;35' '*.svg=3D01;35' '*.sv=
gz=3D01;35' '*.mng=3D01;35' '*.pcx=3D01;35' '*.xcf=3D01;35' '*.mov=3D00;32'=
 '*.MOV=3D00;32' '*.mpg=3D00;32' '*.MPG=3D00;32' '*.mpeg=3D00;32' '*.MPEG=
=3D00;32' '*.m2v=3D00;32' '*.mkv=3D00;32' '*.ogm=3D00;32' '*.mp4=3D00;32' '=
*.m4v=3D00;32' '*.mp4v=3D00;32' '*.vob=3D00;32' '*.qt=3D00;32' '*.nuv=3D00;=
32' '*.wmv=3D00;32' '*.asf=3D00;32' '*.rm=3D00;32' '*.rmvb=3D00;32' '*.flc=
=3D00;32' '*.avi=3D00;32' '*.AVI=3D00;32' '*.fli=3D00;32' '*.flv=3D00;32' '=
*.gl=3D00;32' '*.dl=3D00;32' '*.xwd=3D00;32' '*.yuv=3D00;32' '*.axv=3D00;32=
' '*.anx=3D00;32' '*.ogv=3D00;32' '*.ogx=3D00;32' '*.aac=3D01;36' '*.au=3D0=
1;36' '*.flac=3D01;36' '*.mid=3D01;36' '*.midi=3D01;36' '*.mka=3D01;36' '*.=
mp3=3D01;36' '*.mpc=3D01;36' '*.ogg=3D01;36' '*.ra=3D01;36' '*.wav=3D01;36'=
 '*.m4a=3D01;36' '*.axa=3D01;36' '*.oga=3D01;36' '*.spx=3D01;36' '*.xspf=3D=
01;36' '*.class=3D01;33' '*.o=3D01;33' '*.so=3D01;33' '*.ko=3D01;33' '*.pdf=
=3D00;32' '*.dvi=3D00;32' '*.ps=3D00;32' '*.txt=3D01;37' '*.nfo=3D01;37' '*=
=2Elog=3D01;31' '*Makefile=3D00;33' '*.make=3D00;33' '*.cmake=3D00;33' '*RE=
ADME=3D07;32' '*README.TXT=3D07;32' '*README.Debian=3D07;32' '*readme=3D07;=
32' '*readme.txt=3D07;32' '*INSTALL=3D04;32' '*NEWS=3D04;37' '*NOTES=3D04;3=
7' '*TODO=3D04;37' '*COPYING=3D04;37' '*AUTHORS=3D04;37' '*PATCHES=3D04;37'=
 '*STYLE=3D04;37' '*LICENCE=3D04;37' '*LICENSE=3D04;37' '*VERSION=3D04;37' =
'*BUGS=3D04;37' '*HISTORY=3D04;37' '*CHANGES=3D04;37' '*CHANGELOG=3D04;37' =
'*ChangeLog=3D04;37' '*Changelog=3D04;37' '*.swp=3D01;30' '*.aux=3D01;30' '=
*.tmp=3D01;30'
zstyle ':completion:*' matcher-list 'm:{a-z}=3D{A-Z}'
zstyle ':completion:*' menu 'select=3D2'
zstyle ':completion:*' use-cache on


Btw, you don't have to Cc: me, I am on the list.


Greetings,
Frank

--=20
Frank Blendinger | fb(at)intoxicatedmind.net | GPG: 0x0BF2FE7A
Fingerprint: BB64 F2B8 DFD8 BF90 0F2E 892B 72CF 7A41 0BF2 FE7A

--Qz2CZ664xQdCRdPu
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature
Content-Disposition: inline

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkngYTgACgkQcs96QQvy/npOEQCfVVsBle9kDhIxaHUHxn0wAjq6
YQwAnAmAKcq0FTsQsf4UsF5t+J9F1+pa
=XAx6
-----END PGP SIGNATURE-----

--Qz2CZ664xQdCRdPu--

