<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Git Magic - 章 4. 分支巫術</title>
  <link rel="stylesheet" href="default.css" type="text/css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
  <link rel="home" href="index.html" title="Git 魔法">
  <link rel="up" href="index.html" title="Git 魔法">
  <link rel="prev" href="ch03.html" title="章 3. 克隆周邊">
  <link rel="next" href="ch05.html" title="章 5. 關於歷史">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
    <div class="toc">
      <ul>
<li><b>Git Magic</b></li>
        <li>
          <span class="preface"><a href="index.html">前言</a></span>

          <ul>
            <li><span class="section"><a href=
            "index.html#_%E8%87%B4%E8%AC%9D">致謝！</a></span></li>

            <li><span class="section"><a href=
            "index.html#_%E8%A8%B1%E5%8F%AF">許可</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch01.html">1.
          入門</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch01.html#_%E5%B7%A5%E4%BD%9C%E6%98%AF%E7%8E%A9">工作是玩</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">版本控制</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_%E5%88%86%E4%BD%88%E6%8E%A7%E5%88%B6">分佈控制</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_%E4%B8%80%E5%80%8B%E8%AA%A4%E5%8D%80">一個誤區</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_%E5%90%88%E4%BD%B5%E8%A1%9D%E7%AA%81">合併衝突</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch02.html">2.
          基本技巧</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch02.html#_%E4%BF%9D%E5%AD%98%E7%8B%80%E6%85%8B">保存狀態</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E6%B7%BB%E5%8A%A0_%E5%88%AA%E9%99%A4_%E9%87%8D%E5%91%BD%E5%90%8D">
            添加、刪除、重命名</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E9%80%B2%E9%9A%8E%E6%92%A4%E9%8A%B7_%E9%87%8D%E5%81%9A">
            進階撤銷/重做</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E6%92%A4%E9%8A%B7">撤銷</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E8%AE%8A%E6%9B%B4%E6%97%A5%E8%AA%8C%E7%94%9F%E6%88%90">
            變更日誌生成</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E4%B8%8B%E8%BC%89%E6%AA%94%E6%A1%88">下載檔案</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E5%88%B0%E6%9C%80%E6%96%B0">到最新</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E5%BF%AB%E9%80%9F%E7%99%BC%E4%BD%88">快速發佈</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E6%88%91%E5%80%91%E5%B7%B2%E7%B6%93%E5%81%9A%E4%BA%86%E4%BB%80%E9%BA%BC">
            我們已經做了什麼？</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_%E7%B7%B4%E7%BF%92">練習</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch03.html">3.
          克隆周邊</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch03.html#_%E8%A8%88%E7%AE%97%E6%A9%9F%E9%96%93%E5%90%8C%E6%AD%A5">
            計算機間同步</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E5%85%B8%E5%9E%8B%E6%BA%90%E7%A2%BC%E6%8E%A7%E5%88%B6">
            典型源碼控制</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E5%B0%81%E9%96%89%E6%BA%90%E7%A2%BC">封閉源碼</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E8%A3%B8%E5%80%89%E5%BA%AB">裸倉庫</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E6%8E%A8%E9%82%84%E6%98%AF%E6%8B%BD">推還是拽</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E9%A0%85%E7%9B%AE%E5%88%86%E5%8F%89">項目分叉</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E7%B5%82%E6%A5%B5%E5%82%99%E4%BB%BD">終極備份</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E8%BC%95%E5%BF%AB%E5%A4%9A%E4%BB%BB%E5%8B%99">
            輕快多任務</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E6%B8%B8%E6%93%8A%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">
            游擊版本控制</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_mercurial">Mercurial</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bazaar">Bazaar</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_%E6%88%91%E5%81%8F%E6%84%9Bgit%E7%9A%84%E5%8E%9F%E5%9B%A0">
            我偏愛Git的原因</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch04.html">4.
          分支巫術</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch04.html#_%E8%80%81%E9%97%86%E9%8D%B5">老闆鍵</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E9%AA%AF%E9%AB%92%E7%9A%84%E5%B7%A5%E4%BD%9C">
            骯髒的工作</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E5%BF%AB%E9%80%9F%E4%BF%AE%E8%A8%82">快速修訂</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E5%90%88%E4%BD%B5">合併</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E4%B8%8D%E9%96%93%E6%96%B7%E5%B7%A5%E4%BD%9C%E6%B5%81">
            不間斷工作流</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E9%87%8D%E7%B5%84%E9%9B%9C%E4%BA%82">重組雜亂</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E7%AE%A1%E7%90%86%E5%88%86%E6%94%AF">管理分支</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E8%87%A8%E6%99%82%E5%88%86%E6%94%AF">臨時分支</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_%E6%8C%89%E4%BD%A0%E5%B8%8C%E6%9C%9B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%B7%A5%E4%BD%9C">
            按你希望的方式工作</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch05.html">5.
          關於歷史</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch05.html#_%E6%88%91%E8%AA%8D%E9%8C%AF">我認錯</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_%E6%9B%B4%E8%A4%87%E9%9B%9C%E6%83%85%E6%B3%81">
            更複雜情況</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_%E6%9C%AC%E5%9C%B0%E8%AE%8A%E6%9B%B4%E4%B9%8B%E5%BE%8C">
            本地變更之後</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_%E9%87%8D%E5%AF%AB%E6%AD%B7%E5%8F%B2">重寫歷史</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_%E8%A3%BD%E9%80%A0%E6%AD%B7%E5%8F%B2">製造歷史</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_%E5%93%AA%E5%85%92%E9%8C%AF%E4%BA%86">哪兒錯了？</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_%E8%AA%B0%E8%AE%93%E4%BA%8B%E6%83%85%E8%AE%8A%E7%B3%9F%E4%BA%86">
            誰讓事情變糟了？</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_%E5%80%8B%E4%BA%BA%E7%B6%93%E9%A9%97">個人經驗</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch06.html">6.
          多人Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch06.html#_%E6%88%91%E6%98%AF%E8%AA%B0">我是誰？</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git%E5%9C%A8ssh_http%E4%B8%8A">Git在SSH,
            HTTP上</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git%E5%9C%A8%E9%9A%A8%E4%BE%BF%E4%BB%80%E9%BA%BC%E4%B8%8A">
            Git在隨便什麼上</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_%E8%A3%9C%E4%B8%81_%E5%85%A8%E7%90%83%E8%B2%A8%E5%B9%A3">
            補丁：全球貨幣</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_%E5%B0%8D%E4%B8%8D%E8%B5%B7_%E7%A7%BB%E8%B5%B0%E4%BA%86">
            對不起，移走了</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_%E9%81%A0%E7%AB%AF%E5%88%86%E6%94%AF">遠端分支</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_%E5%A4%9A%E9%81%A0%E7%AB%AF">多遠端</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_%E6%88%91%E7%9A%84%E5%96%9C%E5%A5%BD">我的喜好</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch07.html">7.
          Git大師技</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch07.html#_%E6%BA%90%E7%A2%BC%E7%99%BC%E4%BD%88">源碼發佈</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_%E6%8F%90%E4%BA%A4%E8%AE%8A%E6%9B%B4">提交變更</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_%E6%88%91%E7%9A%84%E6%8F%90%E4%BA%A4%E5%A4%AA%E5%A4%A7%E4%BA%86">
            我的提交太大了！</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_%E7%B4%A2%E5%BC%95_git%E7%9A%84%E4%B8%AD%E8%BD%89%E5%8D%80%E5%9F%9F">
            索引：Git的中轉區域</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_%E5%88%A5%E4%B8%9F%E4%BA%86%E4%BD%A0%E7%9A%84head">
            別丟了你的HEAD</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_head%E6%8D%95%E7%8D%B5">HEAD捕獵</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_%E5%9F%BA%E4%BA%8Egit%E6%A7%8B%E5%BB%BA">基于Git構建</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_%E5%A4%A7%E8%86%BD%E7%9A%84%E7%89%B9%E6%8A%80">
            大膽的特技</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_%E9%98%BB%E6%AD%A2%E5%A3%9E%E6%8F%90%E4%BA%A4">
            阻止壞提交</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch08.html">8.
          揭開面紗</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch08.html#_%E5%A4%A7%E8%B1%A1%E7%84%A1%E5%BD%A2">大象無形</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_%E6%95%B8%E6%93%9A%E5%AE%8C%E6%95%B4%E6%80%A7">
            數據完整性</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_%E6%99%BA%E8%83%BD">智能</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_%E7%B4%A2%E5%BC%95">索引</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_git%E7%9A%84%E6%BA%90%E8%B5%B7">Git的源起</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_%E5%B0%8D%E8%B1%A1%E8%B3%87%E6%96%99%E5%BA%AB">
            對象資料庫</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_blob%E5%B0%8D%E8%B1%A1">Blob對象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_tree%E5%B0%8D%E8%B1%A1">Tree對象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_commit%E5%B0%8D%E8%B1%A1">Commit對象</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_%E6%B2%92%E9%82%A3%E9%BA%BC%E7%A5%9E">沒那麼神</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch09.html">9. 附錄 A:
          Git的缺點</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch09.html#_sha1_%E7%9A%84%E5%BC%B1%E9%BB%9E">SHA1
            的弱點</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E5%BE%AE%E8%BB%9F_windows">微軟
            Windows</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E4%B8%8D%E7%9B%B8%E9%97%9C%E7%9A%84%E6%AA%94%E6%A1%88">
            不相關的檔案</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E8%AA%B0%E5%9C%A8%E7%B7%A8%E8%BC%AF%E4%BB%80%E9%BA%BC">
            誰在編輯什麼？</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E6%AA%94%E6%A1%88%E6%AD%B7%E5%8F%B2">檔案歷史</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E5%88%9D%E5%A7%8B%E5%85%8B%E9%9A%86">初始克隆</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E4%B8%8D%E7%A9%A9%E5%AE%9A%E7%9A%84%E9%A0%85%E7%9B%AE">
            不穩定的項目</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E5%85%A8%E5%B1%80%E8%A8%88%E6%95%B8%E5%99%A8">
            全局計數器</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E7%A9%BA%E5%AD%90%E7%9B%AE%E9%8C%84">空子目錄</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E5%88%9D%E5%A7%8B%E6%8F%90%E4%BA%A4">初始提交</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_%E4%BB%8B%E9%9D%A2%E6%80%AA%E7%99%96">介面怪癖</a></span></li>
          </ul>
        </li>

        <li><span class="chapter"><a href="ch10.html">10. 附錄 B:
        本指南的翻譯</a></span></li>
      </ul>
    </div>
<div class="content">
  <div class="chapter" title="章 4. 分支巫術">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title"><a name=
          "_%E5%88%86%E6%94%AF%E5%B7%AB%E8%A1%93"></a>章 4.
          分支巫術</h2>
        </div>
      </div>
    </div>

    <p>即時分支合併是Git最給力的殺手鐧。</p>

    <p><span class="strong"><strong>問題</strong></span>
    ：外部因素要求必須切換場景。在發佈版本中突然蹦出個嚴重缺陷。某個特性完
    成的截至日期就要來臨。在項目關鍵部分可以提供幫助的一個開發正打算離職。所有情
    況逼迫你停下所有手頭工作，全力撲到到這個完全不同的任務上。</p>

    <p>打斷思維的連續性會使你的生產力大大降低，並且切換上下文也更麻煩，更大的損失。
    使用中心版本控制我們必須從中心伺服器下載一個新的工作拷貝。分散式系統的情況就
    好多了，因為我們能夠在本地克隆所需要的版本。</p>

    <p>但是克隆仍然需要拷貝整個工作目錄，還有直到給定點的整個歷史記錄。儘管Git使用文
    件共享和硬連結減少了花費，項目檔案自身還是必須在新的工作目錄裡重建。</p>

    <p><span class="strong"><strong>方案</strong></span>
    ：Git有一個更好的工具對付這種情況，比克隆快多了而且節省空間： <span class=
    "strong"><strong>git branch</strong></span> 。</p>

    <p>使用這個魔咒，目錄裡的檔案突然從一個版本變到另一個。除了只是在歷史記錄裡上跳
    下竄外，這個轉換還可以做更多。你的檔案可以從上一個發佈版變到實驗版本到當前開 發版本到你朋友的版本等等。</p>

    <div class="section" title="老闆鍵">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E8%80%81%E9%97%86%E9%8D%B5"></a>老闆鍵</h2>
          </div>
        </div>
      </div>

      <p>曾經玩過那樣的遊戲嗎？按一個鍵（“老闆鍵”），屏幕立即顯示一個電子表格或別的？
      那麼如果老闆走進辦公室，而你正在玩遊戲，就可以快速將遊戲藏起來。</p>

      <p>在某個目錄：</p>
      <pre class="literallayout">
$ echo "I'm smarter than my boss" &gt; myfile.txt
$ git init
$ git add .
$ git commit -m "Initial commit"
</pre>

      <p>我們已經創建了一個Git倉庫，該倉庫記錄一個包含特定信息的檔案。現在我們鍵入：</p>
      <pre class="literallayout">
$ git checkout -b boss  # 之後似乎沒啥變化
$ echo "My boss is smarter than me" &gt; myfile.txt
$ git commit -a -m "Another commit"
</pre>

      <p>看起來我們剛剛只是覆蓋了原來的檔案並提交了它。但這是個錯覺。鍵入：</p>
      <pre class="literallayout">
$ git checkout master  # 切到檔案的原先版本
</pre>

      <p>嘿真快！這個檔案就恢復了。並且如果老闆決定窺視這個目錄，鍵入：</p>
      <pre class="literallayout">
$ git checkout boss  # 切到適合老闆看的版本
</pre>

      <p>你可以在兩個版本之間相切多少次就切多少次，而且每個版本都可以獨立提交。</p>
    </div>

    <div class="section" title="骯髒的工作">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E9%AA%AF%E9%AB%92%E7%9A%84%E5%B7%A5%E4%BD%9C"></a>骯髒的工作</h2>
          </div>
        </div>
      </div>

      <p><a name="branch" id=
      "branch"></a>比如你正在開發某個特性，並且由於某種原因，你需要回退三個版本，臨時加進幾行打
      印語句來，來看看一些東西是如何工作的。那麼：</p>
      <pre class="literallayout">
$ git commit -a
$ git checkout HEAD~3
</pre>

      <p>現在你可以到處加醜陋的臨時代碼。你甚至可以提交這些改動。當你做完的時候，</p>
      <pre class="literallayout">
$ git checkout master
</pre>

      <p>來返回到你原來的工作。看，所有未提交變更都結轉了。</p>

      <p>如果你後來想保存臨時變更怎麼辦？簡單：</p>
      <pre class="literallayout">
$ git checkout -b dirty
</pre>

      <p>只要在切換到主分支之前提交就可以了。無論你什麼時候想回到髒的變更，只需鍵入：</p>
      <pre class="literallayout">
$ git checkout dirty
</pre>

      <p>我們在前面章節討論加載舊狀態的時候，曾經接觸過這個命令。最終我們把故事說全：
      檔案改變成請求的狀態，但我們必須離開主分支。從現在開始的任何提交都會將你的文
      件提交到另一條不同的路，這個路可以之後命名。</p>

      <p>換一個說法，在checkout一個舊狀態之後，Git自動把你放到一個新的，未命名的分支， 這個分支可以使用
      <span class="strong"><strong>git checkout -b</strong></span>
      來命名和保存。</p>
    </div>

    <div class="section" title="快速修訂">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E5%BF%AB%E9%80%9F%E4%BF%AE%E8%A8%82"></a>快速修訂</h2>
          </div>
        </div>
      </div>

      <p>你正在做某件事的當間，被告知先停所有的事情，去修理一個新近發現的臭蟲，這個臭 蟲在提交 `1b6d…`：</p>
      <pre class="literallayout">
$ git commit -a
$ git checkout -b fixes 1b6d
</pre>

      <p>那麼一旦你修正了這個臭蟲：</p>
      <pre class="literallayout">
$ git commit -a -m "Bug fixed"
$ git checkout master
</pre>

      <p>並可以繼續你原來的任務。你甚至可以“合併”到最新修訂：</p>
      <pre class="literallayout">
$ git merge fixes
</pre>
    </div>

    <div class="section" title="合併">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E5%90%88%E4%BD%B5"></a>合併</h2>
          </div>
        </div>
      </div>

      <p>一些版本控制系統，創建分支很容易，但把分支合併回來很難。使用Git，合併簡直是家
      常便飯，以至于甚至你可能對其發生沒有察覺。</p>

      <p>我們很久之前就遇到合併了。 <span class=
      "strong"><strong>pull</strong></span> 命令取出提交併合並它們到你的當前分支。如果
      你沒有本地變更，那這個合併就是一個“快進”，相當於中心式版本控制系統裡的一個
      弱化的獲取最新版本操作。但如有本地變更，Git將自動合併，並報告任何衝突。</p>

      <p>通常，一個提交只有一個“父提交”，也叫前一個提交。合併分支到一起產生一個至少 有兩個父的提交。這就引出了問題：
      <code class="literal">HEAD~10</code> 真正指哪個提交？一個提交可能有多個
      父，那我們跟哪個呢？</p>

      <p>原來這個表示每次選擇第一個父。這是可取的，因為在合併時候當前分支成了第一個父；
      多數情況下我們只關注我們在當前分支都改了什麼，而不是從其他分支合併來的變更。</p>

      <p>你可以用插入符號來特別指定父。比如，顯示來自第二個父的日誌：</p>
      <pre class="literallayout">
$ git log HEAD^2
</pre>

      <p>你可以忽略數字以指代第一個父。比如，顯示與第一個父的差別：</p>
      <pre class="literallayout">
$ git diff HEAD^
</pre>

      <p>你可以結合其他類型使用這個記號。比如：</p>
      <pre class="literallayout">
$ git checkout 1b6d^^2~10 -b ancient
</pre>

      <p>開始一個新分支 “ancient” ，表示第一個父的第二個父的倒數第十次提交的狀態。</p>
    </div>

    <div class="section" title="不間斷工作流">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E4%B8%8D%E9%96%93%E6%96%B7%E5%B7%A5%E4%BD%9C%E6%B5%81">
            </a>不間斷工作流</h2>
          </div>
        </div>
      </div>

      <p>經常在硬件項目裡，計劃的第二步必須等第一步完成才能開始。待修的汽車傻等在車庫
      裡，直到特定的零件從工廠運來。一個原型在其可以構建之前，可能苦等晶片成型。</p>

      <p>軟件項目可能也類似。新功能的第二部分不得不等待，直到第一部分發佈並通過測試。
      一些項目要求你的代碼需要審批才能接受，因此你可能需要等待第一部分得到批准，才 能開始第二部分。</p>

      <p>多虧了無痛分支合併，我們可以不必遵循這些規則，在第一部分正式準備好前開始第二
      部分的工作。假設你已經將第一部分提交並發去審批，比如說你現在在主分支。那麼分 岔：</p>
      <pre class="literallayout">
$ git checkout -b part2
</pre>

      <p>接下來，做第二部分，隨時可以提交變更。只要是人就可能犯錯誤，經常你將回到第一
      部分在修修補補。如果你非常幸運，或者超級棒，你可能不必做這幾行：</p>
      <pre class="literallayout">
$ git checkout master  # 回到第一部分
$ 修復問題
$ git commit -a        # 提交變更
$ git checkout part2   # 回到第二部分
$ git merge master     # 合併這些改動
</pre>

      <p>最終，第一部分獲得批准：</p>
      <pre class="literallayout">
$ git checkout master  # 回到第一部分
$ submit files         # 對世界發佈
$ git merge part2      # 合併第二部分
$ git branch -d part2  # 刪除分支“part2”
</pre>

      <p>現在你再次處在主分支，第二部分的代碼也在工作目錄。</p>

      <p>很容易擴展這個技巧，應用到任意數目的部分。它也很容易追溯分支：假如你很晚才意
      識到你本應在7次提交前就創建分支。那麼鍵入：</p>
      <pre class="literallayout">
$ git branch -m master part2  # 重命名“master”分支為“part2”。
$ git branch master HEAD~7    # 以七次前提交建一個新的“master”。
</pre>

      <p>分支 <code class="literal">master</code> 只有第一部分內容，其他內容在分支
      <code class="literal">part2</code> 。 我們現在後一個分支； 我們創建了
      <code class="literal">master</code> 分支還沒有切換過去，因為我們想繼續工作在
      <code class="literal">part2</code> 。這是不
      尋常的。直到現在，我們已經在創建之後切換到分支，如：</p>
      <pre class="literallayout">
$ git checkout HEAD~7 -b master  # 創建分支，並切換過去。
</pre>
    </div>

    <div class="section" title="重組雜亂">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E9%87%8D%E7%B5%84%E9%9B%9C%E4%BA%82"></a>重組雜亂</h2>
          </div>
        </div>
      </div>

      <p>或許你喜歡在同一個分支下完成工作的方方面面。你想為自己保留工作進度並希望其他
      人只能看到你仔細整理過後的提交。開啟一對分支：</p>
      <pre class="literallayout">
$ git branch sanitized    # 為乾淨提交創建分支
$ git checkout -b medley  # 創建並切換分支以進去工作
</pre>

      <p>接下來，做任何事情：修臭蟲，加特性，加臨時代碼，諸如此類，經常按這種方式提交。 然後：</p>
      <pre class="literallayout">
$ git checkout sanitized
$ git cherry-pick medley^^
</pre>

      <p>應用分支 “medley” 的祖父提交到分支 “sanitized” 。通過合適的挑選（像選櫻桃
      那樣）你可以構建一個只包含成熟代碼的分支，而且相關的提交也組織在一起。</p>
    </div>

    <div class="section" title="管理分支">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E7%AE%A1%E7%90%86%E5%88%86%E6%94%AF"></a>管理分支</h2>
          </div>
        </div>
      </div>

      <p>列出所有分支：</p>
      <pre class="literallayout">
$ git branch
</pre>

      <p>預設你從叫 “master” 的分支開始。一些人主張別碰“master”分支，而是創建你自 己版本的新分支。</p>

      <p>選項 <span class="strong"><strong>-d</strong></span> 和
      <span class="strong"><strong>-m</strong></span>
      允許你來刪除和移動（重命名）分支。參見 <span class="strong"><strong>git help
      branch</strong></span> 。</p>

      <p>分支“master” 是一個有用的慣例。其他人可能假定你的倉庫有一個叫這個名字的分
      支，並且該分支包含你項目的官方版本。儘管你可以重命名或抹殺 “master” 分支， 你最好還是尊重這個約定。</p>
    </div>

    <div class="section" title="臨時分支">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E8%87%A8%E6%99%82%E5%88%86%E6%94%AF"></a>臨時分支</h2>
          </div>
        </div>
      </div>

      <p>很快你會發現你經常會因為一些相似的原因創建短期的分支：每個其它分支只是為了保
      存當前狀態，那樣你就可以直接跳到較老狀態以修復高優先順序的臭蟲之類。</p>

      <p>可以和電視的換台做類比，臨時切到別的頻道，來看看其它台那正放什麼。但並不是簡
      單地按幾個按鈕，你不得不創建，檢出，合併，以及刪除臨時分支。幸運的是，Git已經
      有了和電視機遙控器一樣方便的快捷方式：</p>
      <pre class="literallayout">
$ git stash
</pre>

      <p>這個命令保存當前狀態到一個臨時的地方（一個隱藏的地方）並且恢復之前狀態。你的
      工作目錄看起來和你開始編輯之前一樣，並且你可以修復臭蟲，引入之前變更等。當你 想回到隱藏狀態的時候，鍵入：</p>
      <pre class="literallayout">
$ git stash apply  # 你可能需要解決一些衝突
</pre>

      <p>你可以有多個隱藏，並用不同的方式來操作他們。參見 <span class="strong"><strong>git
      help slash</strong></span> 。也許你已
      經猜到，Git維護在這個場景之後的分支以執行魔法技巧.</p>
    </div>

    <div class="section" title="按你希望的方式工作">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_%E6%8C%89%E4%BD%A0%E5%B8%8C%E6%9C%9B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%B7%A5%E4%BD%9C">
            </a>按你希望的方式工作</h2>
          </div>
        </div>
      </div>

      <p>你可能猶疑于分支是否值得一試。畢竟，克隆也几乎一樣快，並且你可以用 <span class=
      "strong"><strong>cd</strong></span> 來在
      彼此之間切換，而不是用Git深奧的命令。</p>

      <p>考慮一下瀏覽器。為什麼同時支持多標籤和多窗口？因為允許兩者同時接納納了多種風
      格的用戶。一些用戶喜歡只保持一個打開的窗口，然後用標籤瀏覽多個網頁。一些可能
      堅持另一個極端：任何地方都沒有標籤的多窗口。一些喜好處在兩者之間。</p>

      <p>分支類似你工作目錄的標籤，克隆類似打開的瀏覽器新窗口。這些是本地操作很快，那
      為什麼不試着找出最適合你的組合呢？Git讓你按你確實所希望的那樣工作。</p>
    </div>
  </div><script type="text/javascript" src="find_selflink.js">
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1901330-2");
  pageTracker._initData();
  pageTracker._trackPageview();
  </script>
</div>
</div><div class="footer"><a href="/~blynn/">Ben Lynn</a></div>
</body>
</html>
