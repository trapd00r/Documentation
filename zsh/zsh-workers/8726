From zsh-workers-return-8726-mason-zsh=primenet.com.au@sunsite.auc.dk Mon Nov 22 16:08:59 1999
Return-Path: <zsh-workers-return-8726-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 25800 invoked from network); 22 Nov 1999 16:08:56 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 22 Nov 1999 16:08:56 -0000
Received: (qmail 5998 invoked by alias); 22 Nov 1999 16:08:51 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8726
Received: (qmail 5988 invoked from network); 22 Nov 1999 16:08:46 -0000
Message-ID: <38396A7D.3CEF8AE5@u.genie.co.uk>
Date: Mon, 22 Nov 1999 16:08:29 +0000
From: Oliver Kiddle <opk@u.genie.co.uk>
X-Mailer: Mozilla 4.7 [en] (Win95; U)
X-Accept-Language: en
MIME-Version: 1.0
To: Zsh workers <zsh-workers@sunsite.auc.dk>
Subject: PATCH: broken _netscape
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

_netscape in pws-9 seems to be broken. This patch fixes it to a point
where it atleast runs without errors but for some reason, completion of
the arguments doesn't work. I suspect that it is a bug somewhere in
_arguments.

Oliver

--- Completion/User/_netscape.bak	Mon Nov 22 15:30:21 1999
+++ Completion/User/_netscape	Mon Nov 22 15:57:20 1999
@@ -43,7 +43,6 @@
         _wanted types expl 'data type' &&
             compadd -s")" -M 'm:{a-zA-Z}={A-Za-z}' HTML Text PostScript &&
                 ret=0
-        fi
       else
         _tags files && _path_files -W ~ && ret=0
       fi
@@ -53,19 +52,17 @@
       if compset -P '*@'; then
         _wanted hosts expl 'remote host name' &&
             _hosts "$expl[@]" -q -S, && ret=0
-        fi
       else
         _wanted users expl 'login name' && _users "$expl[@]" -q -S@ && ret=0
-        fi
       fi
     ;;
     *)
       if _wanted commands expl 'remote commands'; then
-        if [[ "$QIPREFIX" ]]; then
-          compadd "$expl[@]" -qS '(' -M 'm:{a-zA-Z}={A-Za-z}' - \
+        if [[ -z "$QIPREFIX" ]]; then
+	  compadd "$expl[@]" -s'(' -S '' -M 'm:{a-zA-Z}={A-Za-z}' - \
                   $remote_commands && ret=0
         else
-	  compadd "$expl[@]" -s'(' -S '' -M 'm:{a-zA-Z}={A-Za-z}' - \
+          compadd "$expl[@]" -qS '(' -M 'm:{a-zA-Z}={A-Za-z}' - \
                   $remote_commands && ret=0
 	fi
       fi
@@ -75,7 +72,7 @@
 
 if [[ "$state" = "urls" ]]; then
   # Complete netscape urls
-  if compset about: ; then
+  if compset -P about: ; then
     _wanted values expl 'about what' &&
         compadd authors blank cache document fonts global hype image-cache \
             license logo memory-cache mozilla plugins && ret=0

