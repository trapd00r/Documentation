From zsh-users-return-12290-mason-zsh=primenet.com.au@sunsite.dk Wed Dec 05 05:09:18 2007
Return-Path: <zsh-users-return-12290-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 2130 invoked from network); 5 Dec 2007 05:09:10 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 5 Dec 2007 05:09:10 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 79163 invoked from network); 5 Dec 2007 05:09:01 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 5 Dec 2007 05:09:01 -0000
Received: (qmail 28176 invoked by alias); 5 Dec 2007 05:08:37 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12290
Received: (qmail 28155 invoked from network); 5 Dec 2007 05:08:36 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 5 Dec 2007 05:08:36 -0000
Received: (qmail 77784 invoked from network); 5 Dec 2007 05:08:36 -0000
Received: from indy.ph.unimelb.edu.au (128.250.54.6)
  by a.mx.sunsite.dk with SMTP; 5 Dec 2007 05:08:29 -0000
Received: from localhost (localhost [127.0.0.1])
	by indy.ph.unimelb.edu.au (Postfix) with ESMTP id D431FEB41A
	for <zsh-users@sunsite.dk>; Wed,  5 Dec 2007 15:08:50 +1100 (EST)
Received: from indy.ph.unimelb.edu.au ([127.0.0.1])
	by localhost (indy.ph.unimelb.edu.au [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 06140-08 for <zsh-users@sunsite.dk>;
	Wed, 5 Dec 2007 15:08:50 +1100 (EST)
Received: from tselap.local (visitor9.physics.usyd.edu.au [129.78.100.210])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by indy.ph.unimelb.edu.au (Postfix) with ESMTP id B4EB2EB402
	for <zsh-users@sunsite.dk>; Wed,  5 Dec 2007 15:08:50 +1100 (EST)
From: "=?utf-8?q?=E8=AC=9D=E6=AD=A5=E9=81=99?= Sie, Bu Yau" <ps@pacesie.name>
To: zsh-users@sunsite.dk
Subject: getopts / OPTIND / shift : inconsistent behavior
Date: Wed, 5 Dec 2007 16:08:26 +1100
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200712051608.26752.ps@pacesie.name>
X-Virus-Scanned: by amavisd-new-20030616-p10 ph.unimelb.edu.au

Hi,

With zsh 4.3.4 the OPTIND incremental bebavior is inconsistent for options 
with argument and without argument. For option with argument, OPTIND points 
to next argument, while for option without argument it points to current 
argument.

func() {
getopts a:b optvar
shift $(( OPTIND -1 ))
echo "$OPTIND, $1"
}

func -a x y z
output: 3, y

func -b x y z
output: 1, -b

Is this a bug? There is no consistent way to do "shift" as such.

