From zsh-workers-return-16996-mason-zsh=primenet.com.au@sunsite.dk Tue Apr 16 16:11:08 2002
Return-Path: <zsh-workers-return-16996-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 12785 invoked from network); 16 Apr 2002 16:11:08 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 16 Apr 2002 16:11:08 -0000
Received: (qmail 14384 invoked by alias); 16 Apr 2002 16:10:58 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 16996
Received: (qmail 14360 invoked from network); 16 Apr 2002 16:10:55 -0000
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <1020416160723.ZM10203@candle.brasslantern.com>
Date: Tue, 16 Apr 2002 16:07:23 +0000
In-Reply-To: <002a01c1e52e$9a40aa30$1fc1f2a3@mow.siemens.ru>
Comments: In reply to Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
        "RE: _values does not quote inserted matches" (Apr 16,  2:08pm)
References: <002a01c1e52e$9a40aa30$1fc1f2a3@mow.siemens.ru>
X-Mailer: Z-Mail (5.0.0 30July97)
To: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>, zsh-workers@sunsite.dk
Subject: Re: _values does not quote inserted matches
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

On Apr 16,  2:08pm, Borsenkow Andrej wrote:
}
} Now, this does quote inserted string which is good. Unfortunately, it is
} still confused by inserted quotes ... 

I tried to reproduce this, but I don't have the version of _urpmi that
calls _urpmi_media ... which I didn't notice at first, and then I spent
an inordinate amount of time figuring out why I was getting

zsh% urpmi <TAB>
zsh% urpmi expl=''
expl=''
expl=''
expl=''

It turned out to be an extraneous `local expl' in the version of _urpmi
that I do have:

@@ -92,7 +92,7 @@
 	    done < /etc/urpmi/urpmi.cfg
 	;;
 	urpmi_rpms )
-	    local pkg foo expl
+	    local pkg foo
 	    local -a pkgs
 	    local -a synthesis
 	    synthesis=(/var/lib/urpmi/synthesis.*(N))

Andrej, please fix that when you're committing your other changes.

} bor@cooker% urpmi --media Contrib\ CD,
} No matches for: `urpmi media'
} 
} Looks like _values get confused by quoting on command line?

I finally did reproduce this with a simpler compdef, and looked at the
_complete_debug output.

The problem doesn't seem to be with _values, per se ... it's either in the
`compvalues' C function, or somewhere down below _describe.

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

Zsh: http://www.zsh.org | PHPerl Project: http://phperl.sourceforge.net   

