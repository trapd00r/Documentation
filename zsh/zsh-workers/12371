From zsh-workers-return-12371-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Jul 25 17:08:30 2000
Return-Path: <zsh-workers-return-12371-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3430 invoked from network); 25 Jul 2000 17:08:28 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 Jul 2000 17:08:28 -0000
Received: (qmail 22521 invoked by alias); 25 Jul 2000 17:07:52 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 12371
Received: (qmail 22514 invoked from network); 25 Jul 2000 17:07:51 -0000
X-Envelope-Sender-Is: Andrej.Borsenkow@mow.siemens.ru (at relayer david.siemens.de)
From: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>
To: "Andrej Borsenkow" <Andrej.Borsenkow@mow.siemens.ru>,
   "Mike Boilen" <mboilen@microsoft.com>
Cc: "ZSH workers mailing list" <zsh-workers@sunsite.auc.dk>,
   <Cygwin@Sourceware.Cygnus.Com>
Subject: Problems under domain account  on Win2k RE: Problems with zsh 3.1.9 and cygwin
Date: Tue, 25 Jul 2000 21:07:45 +0400
Message-ID: <002401bff65a$d9db2310$21c9ca95@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="koi8-r"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400
Importance: Normal
In-reply-to: <002301bff634$235e7b30$21c9ca95@mow.siemens.ru>

>
> > >
> > >       0 [main] zsh 18877 handle_exceptions: Exception:
> > > STATUS_ACCESS_VIOLATION
> > >     913 [main] zsh 18877 stackdump: Dumping stack trace to
> > > zsh.exe.stackdump
> > >
> > > and the following stackdump:
> >
> > I understand, that it is of little help, but I can build and
> > run current
> > Zsh code (I do not remember, if I tried stock 3.1.9 - but it is very
> > probable) in exactly the above configuration.
>
> Sorry, I was wrong. It appeared, that I had outdated Cygwin already (I
> have not seen any announcements so assumed there was nothing new).
> Obviously, binutils have changed, so I get now exactly the same crash.
> Damn ... I just downloaded Cygwin, downloaded updated ld.exe
> but no way.
>

This particular problem was due to tgetent() problem. Zsh tests, if
tgetent() accepts null pointer for buffer. Unfortunately, test always
succeeded, but running under gdb showed, that Zsh crashed in
tgetent(0,"cygwin").

But really weird was when I recompiled Zsh without TGETENT_ACCEPTS_NULL.
Now, Zsh correctly starts under local account but crashes under domain
account!!!

The problem is, that, as was already mentioned on cygwin list, gdb also
does not work under domain account. That means, that

- either I have working gdb and zsh and nothing to debug
- or both do not work and I have no way to debug

Usage of printf would be nice IF I had the slightest idea where it
crashes.

I'm running under Win2k professional with 128 bit security (hmm, may
this be a problem?). It is a member of NT4 domain; domain controller is
NT4SP6a.

-andrej

