From zsh-users-return-14427-mason-zsh=primenet.com.au@sunsite.dk Tue Sep 22 09:15:49 2009
Return-Path: <zsh-users-return-14427-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 26455 invoked from network); 22 Sep 2009 09:15:37 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.4 required=5.0 tests=AWL,BAYES_00 autolearn=ham
	version=3.2.5
Received: from new-brage.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.254.104)
  by ns1.primenet.com.au with SMTP; 22 Sep 2009 09:15:37 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 51958 invoked from network); 22 Sep 2009 09:15:19 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 22 Sep 2009 09:15:19 -0000
Received: (qmail 8759 invoked by alias); 22 Sep 2009 09:15:09 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 14427
Received: (qmail 8746 invoked from network); 22 Sep 2009 09:15:09 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 22 Sep 2009 09:15:09 -0000
Received: from cluster-d.mailcontrol.com (cluster-d.mailcontrol.com [85.115.60.190])
	by bifrost.dotsrc.org (Postfix) with ESMTPS id 7754E801E2BF
	for <zsh-users@sunsite.dk>; Tue, 22 Sep 2009 11:15:02 +0200 (CEST)
Received: from cameurexb01.EUROPE.ROOT.PRI ([193.128.72.68])
	by rly22d.srv.mailcontrol.com (MailControl) with ESMTP id n8M9Et6T013068
	for <zsh-users@sunsite.dk>; Tue, 22 Sep 2009 10:15:01 +0100
Received: from news01 ([10.99.50.25]) by cameurexb01.EUROPE.ROOT.PRI with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 22 Sep 2009 10:14:57 +0100
Date: Tue, 22 Sep 2009 10:14:51 +0100
From: Peter Stephenson <pws@csr.com>
To: <zsh-users@sunsite.dk>
Subject: Re: completion problem with dirs
Message-ID: <20090922101451.2075abb8@news01>
In-Reply-To: <20090922062048.GA14403@Junius>
References: <20090922062048.GA14403@Junius>
Organization: CSR
X-Mailer: Claws Mail 3.5.0 (GTK+ 2.12.8; i386-redhat-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 22 Sep 2009 09:14:57.0084 (UTC) FILETIME=[27510FC0:01CA3B65]
X-Scanned-By: MailControl A-06-00-00 (www.mailcontrol.com) on 10.68.0.132
X-Virus-Scanned: ClamAV 0.94.2/9821/Tue Sep 22 01:48:15 2009 on bifrost
X-Virus-Status: Clean

On Tue, 22 Sep 2009 07:20:48 +0100
David Woodfall <dave@unrealize.co.uk> wrote:
> I have a some completions like:
> 
> zstyle ':completion:*:*:display:*' file-patterns
> '(*.png|*.gif|*.jpg|*.jpeg|*.bmp|*.svg|*.xpm)' file-sort time

That should be:

zstyle ':completion:*:*:display:*' file-patterns \
  '(*.png|*.gif|*.jpg|*.jpeg|*.bmp|*.svg|*.xpm)'
zstyle ':completion:*:*:display:*' file-sort time

However, display is handled by the standard completion _imagemagick:  it
maybe that that needs updating (unless you're specifically trying to
exclude certain types).

> The problem is when I try to follow a directory like:
>
> display ~/some/path/
>
> tabbing does not work for the path completion at all. What do I need
> to add to my completion line to get this to work?

Read further in the documentation for file-patterns and there's enough
information to work it out:

zstyle ':completion:*:*:display:*' file-patterns \
       '(*.png|*.gif|*.jpg|*.jpeg|*.bmp|*.svg|*.xpm)' \
       '*(-/):directories:directory'

What doesn't seem to work, however, is that the documentation suggests that
this should make "directory" be used as the description when completing
directories instead of "picture file", but it doesn't.  It seems to be
being overridden by _imagemagick, which calls

  _files "$@" -g "*.(#i)(${~formats//:/|})(-.)"

for a set of formats defined just above, so fixing that might be a better
bet.

-- 
Peter Stephenson <pws@csr.com>            Software Engineer
Tel: +44 (0)1223 692070                   Cambridge Silicon Radio Limited
Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, UK


Member of the CSR plc group of companies. CSR plc registered in England and Wales, registered number 4187346, registered office Churchill House, Cambridge Business Park, Cowley Road, Cambridge, CB4 0WZ, United Kingdom

