From zsh-workers-return-19760-mason-zsh=primenet.com.au@sunsite.dk Mon Apr 12 21:36:03 2004
Return-Path: <zsh-workers-return-19760-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16309 invoked from network); 12 Apr 2004 21:36:02 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 12 Apr 2004 21:36:02 -0000
Received: (qmail 12290 invoked by alias); 12 Apr 2004 21:35:55 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19760
Received: (qmail 12239 invoked from network); 12 Apr 2004 21:35:55 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 12 Apr 2004 21:35:55 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [130.225.247.86] by sunsite.dk (MessageWall 1.0.8) with SMTP; 12 Apr 2004 21:35:54 -0000
Received: (qmail 26837 invoked from network); 12 Apr 2004 21:35:54 -0000
Received: from d7f88.d.pppool.de (HELO athlon) (80.184.127.136)
  by a.mx.sunsite.dk with SMTP; 12 Apr 2004 21:35:42 -0000
Received: from opk by athlon with esmtp (masqmail 0.2.20) id
 1BD9Ct-0vc-00 for <zsh-workers@sunsite.dk>; Mon, 12 Apr 2004 23:43:07
 +0200
In-reply-to: <040412085942.ZM19035@candle.brasslantern.com> 
From: Oliver Kiddle <okiddle@yahoo.co.uk>
References: <1040410174430.ZM10891@candle.brasslantern.com> <1170.1081778412@athlon> <040412085942.ZM19035@candle.brasslantern.com>
To: zsh-workers@sunsite.dk
Subject: Re: Compsys and KSH_AUTOLOAD 
Date: Mon, 12 Apr 2004 23:43:07 +0200
Message-ID: <3571.1081806187@athlon>
X-Spam-Checker-Version: SpamAssassin 2.63 on a.mx.sunsite.dk
X-Spam-Level: ****
X-Spam-Status: No, hits=4.0 required=6.0 tests=RCVD_IN_DYNABLOCK,
	RCVD_IN_SORBS autolearn=no version=2.63
X-Spam-Hits: 4.0

Bart wrote:

> Matthias has since written back to me again and says he's having all sorts
> of problems with zcompile'd functions even after starting from scratch and

I've had problems with it in the past so it probably needs more
investigation.

> I don't specifically mean "does the above workaround deserve a FAQ entry"
> but rather "does using compsys with kshautoload deserve a FAQ entry",
> whatever the best A to the Q turns out to be.

It probably does deserve an FAQ entry. The minimum possible A to the Q
will be to use -z when using autoload for compinit. With that we either
need an FAQ or to suggest the -z everywhere we show the autoload -U
compinit.

> The autoload method used isn't stored anywhere in the function structure.
> Only the fact that the function is not yet defined is stored, and then zsh
> applies whatever autoload setting is in effect globally at the time that
> the function is loaded.

Presumably it also stores whether the function was autoloaded with the
-U option. Looks like there is a PM_UNALIASED flag. Maybe we can just
add PM_ZSHSTORED and PM_KSHSTORED flags.

> I suppose we could modify the storage and the code that does autoloading
> [as opposed to modifying only bin_autoload()]; I forget why I didn't do
> so at the time -- probably because it was a significantly larger change.

It just needs a bit of investigation then to see if there was a more
fundamental reason. I was wondering if there was some clash with
typeset options (autoload being a variant of it). Hopefully not.

Oliver

