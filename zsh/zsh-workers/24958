From zsh-workers-return-24958-mason-zsh=primenet.com.au@sunsite.dk Wed May 07 07:35:20 2008
Return-Path: <zsh-workers-return-24958-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 16477 invoked from network); 7 May 2008 07:35:18 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.4
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 7 May 2008 07:35:18 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 64138 invoked from network); 7 May 2008 07:35:13 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 7 May 2008 07:35:13 -0000
Received: (qmail 3591 invoked by alias); 7 May 2008 07:35:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 24958
Received: (qmail 3572 invoked from network); 7 May 2008 07:35:10 -0000
Received: from bifrost.dotsrc.org (130.225.254.106)
  by sunsite.dk with SMTP; 7 May 2008 07:35:10 -0000
Received: from fk-out-0910.google.com (fk-out-0910.google.com [209.85.128.191])
	by bifrost.dotsrc.org (Postfix) with ESMTP id 6F60380ED173
	for <zsh-workers@sunsite.dk>; Wed,  7 May 2008 09:35:06 +0200 (CEST)
Received: by fk-out-0910.google.com with SMTP id 26so196752fkx.13
        for <zsh-workers@sunsite.dk>; Wed, 07 May 2008 00:35:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=zieS9E0uKo8s01BI5uvIFU7pazKc0RtGfKGe4SCutE8=;
        b=esi/F5tojx0v8J5BFlHCHga32N0WfmaVbQcAmpioo+n/E9Qie/kEo378VrlvNnEi51aWTboAHGEU4AI0gXc5ACN5PuCXz32VfuEn27+HEDFJ7MKUGJ1fAGv/I1IO9VSaT89uX+I4fnIDif0VBCwo6SJYB87ZYfWfKdEDl8jtmeQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=EPTXMSLeg5eFQp5ymXyRCTc+PXMgVVCxJsr0u17Iy/+gczs/P3nI/gTXsctS0A3m7TBR/8QnhCYnUmvmlRN0PaCZx+e1bMvOdKUj3kMMRPid51qiH5V+Dx6O9lInmQ6y/68rwMfSbqS93P1ub3+AsvF/bkdiBy08EdUgEYez7gw=
Received: by 10.82.150.15 with SMTP id x15mr157252bud.23.1210145705967;
        Wed, 07 May 2008 00:35:05 -0700 (PDT)
Received: by 10.82.148.11 with HTTP; Wed, 7 May 2008 00:35:05 -0700 (PDT)
Message-ID: <ca15a72c0805070035v3c872950m85b9f5b377d46196@mail.gmail.com>
Date: Wed, 7 May 2008 16:35:05 +0900
From: "Hiroto Kagotani" <hiroto.kagotani@gmail.com>
To: zsh-workers@sunsite.dk
Subject: Segmentation fault on Ctrl-D
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Scanned: ClamAV 0.91.2/7046/Wed May  7 05:35:44 2008 on bifrost
X-Virus-Status: Clean

Hi there,

I'm new to this list so please let me know if I'm missing any important
information.

zsh (CVS, 4.3.6, 4.3.4 on FreeBSD, and 4.3.4 on Cygwin) crashes
when I type a key sequence followed by two Ctrl-D's.

zsh -f
q<TAB><TAB><^D><^D>
 -> Segmentation fault

"q" may be any letter.  If you have a lot of commands begin with the letter,
type three <TAB>s to force zsh choose a candidate.


In my case, the first candidate beginning with "q" is qembed, and the gdb
back trace for the latest CVS is as follows:

Program received signal SIGSEGV, Segmentation fault.
0x28276783 in zlelineasstring (instr=0x0, inll=6, incs=6, outllp=0x80d7c00,
    outcsp=0x80d7c3c, useheap=0) at zle_utils.c:198
198             j = wcrtomb(s + mb_len, instr[i], &mbs);
(gdb) bt
#0  0x28276783 in zlelineasstring (instr=0x0, inll=6, incs=6,
    outllp=0x80d7c00, outcsp=0x80d7c3c, useheap=0) at zle_utils.c:198
#1  0x28270bd3 in metafy_line () at zle_tricky.c:960
#2  0x2825f1ce in execzlefunc (func=0x28281dc0, args=0x28284900, set_bindk=0)
    at zle_main.c:1356
#3  0x2825e3a4 in zlecore () at zle_main.c:1043
#4  0x2825ea46 in zleread (lp=0x80d7e08, rp=0x0, flags=3, context=0)
    at zle_main.c:1205
#5  0x080808d8 in autoload_zleread (lp=0x80d7e08, rp=0x0, ha=3, con=0)
    at init.c:1227
#6  0x080810c9 in inputline () at input.c:278
#7  0x08080f7f in ingetc () at input.c:214
#8  0x08077bbf in ihgetc () at hist.c:240
#9  0x0808807e in gettok () at lex.c:663
#10 0x08087951 in yylex () at lex.c:350
#11 0x080a1365 in parse_event () at parse.c:451
#12 0x0807e1f6 in loop (toplevel=1, justonce=0) at init.c:134
#13 0x08080bd1 in zsh_main (argc=2, argv=0xbfbfe3ec) at init.c:1358
#14 0x08052316 in main (argc=2, argv=0xbfbfe3ec) at ./main.c:93

Thanks.
-- 
Hiroto Kagotani
<hiroto.kagotani@gmail.com>

