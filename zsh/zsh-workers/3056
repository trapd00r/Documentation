From zsh-workers-request@euclid.skiles.gatech.edu Tue Apr 01 00:04:14 1997
Return-Path: <zsh-workers-request@euclid.skiles.gatech.edu>
Delivered-To: mason@primenet.com.au
Received: (qmail 22045 invoked from network); 1 Apr 1997 00:04:11 -0000
Received: from euclid.skiles.gatech.edu (list@130.207.146.50)
  by coral.primenet.com.au with SMTP; 1 Apr 1997 00:04:11 -0000
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id SAA10584; Mon, 31 Mar 1997 18:57:40 -0500 (EST)
Resent-Date: Mon, 31 Mar 1997 18:57:40 -0500 (EST)
Date: Tue, 1 Apr 1997 01:00:32 +0100 (BST)
From: Zefram <zefram@dcs.warwick.ac.uk>
Message-Id: <14987.199704010000@stone.dcs.warwick.ac.uk>
Subject: documentation fixes
X-Patch: 242
Resent-Message-ID: <"pgRkL2.0.Jb2.pz4Gp"@euclid>
To: zsh-workers@math.gatech.edu
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/3056
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

-----BEGIN PGP SIGNED MESSAGE-----

This patch fixes a couple of problems concerning the documentation.

Currently, the Doc/Makefile attempts to install man pages from the
source directory, ignoring any it has built and failing if the source
tree is clean.  Conversely, the info files can't be installed from the
source tree.  This patch makes each file be checked for in first the
build directory, then the source directory.

Due to possibly a yodl bug, zshall.1 wasn't properly including zshmisc.1.
This patch fixes it.  Also, the "Files" and "See Also" sections at the
end of zshall(1) appeared to be part of zshmodules(1).  This patch adds
an extra .TH line, to change the page headings correctly.

 -zefram

 *** Doc/Makefile.in	1997/03/17 04:22:00	1.10
 --- Doc/Makefile.in	1997/03/31 00:26:06
 ***************
 *** 164,177 ****
   install.man: $(MAN)
   	$(top_srcdir)/mkinstalldirs $(mandir)/man$(manext)
   	for file in $(MAN); do \
 ! 	  $(INSTALL_DATA) $(srcdir)/$$file $(mandir)/man$(manext) ; \
   	done
   
   # install info pages, creating install directory if necessary
   install.info: zsh.info
   	$(top_srcdir)/mkinstalldirs $(infodir)
   	for file in zsh.info zsh.info-[1-9]; do \
 ! 	  [ -f "$$file" ] && $(INSTALL_DATA) $$file $(infodir) ; \
   	done
   
   # uninstall man pages
 --- 164,187 ----
   install.man: $(MAN)
   	$(top_srcdir)/mkinstalldirs $(mandir)/man$(manext)
   	for file in $(MAN); do \
 ! 	  if test -f $$file; then \
 ! 	    $(INSTALL_DATA) $$file $(mandir)/man$(manext); \
 ! 	  elif test -f $(srcdir)/$$file; then \
 ! 	    $(INSTALL_DATA) $(srcdir)/$$file $(mandir)/man$(manext); \
 ! 	  else :; \
 ! 	  fi || exit 1; \
   	done
   
   # install info pages, creating install directory if necessary
   install.info: zsh.info
   	$(top_srcdir)/mkinstalldirs $(infodir)
   	for file in zsh.info zsh.info-[1-9]; do \
 ! 	  if test -f $$file; then \
 ! 	    $(INSTALL_DATA) $$file $(infodir); \
 ! 	  elif test -f $(srcdir)/$$file; then \
 ! 	    $(INSTALL_DATA) $(srcdir)/$$file $(infodir); \
 ! 	  else :; \
 ! 	  fi || exit 1; \
   	done
   
   # uninstall man pages
 *** Doc/zsh.yo	1997/03/17 04:22:01	1.6
 --- Doc/zsh.yo	1997/03/31 00:18:28
 ***************
 *** 67,72 ****
 --- 67,73 ----
   ifnzman(includefile(Zsh/modules.yo))
   ifzshall(\
   def(source)(1)(NOTRANS(.so )mandir()/ARG1NOTRANS(.)manext())\
 + CMT()
   source(zshmisc)
   source(zshexpn)
   source(zshzle)
 ***************
 *** 75,80 ****
 --- 76,82 ----
   source(zshbuiltins)
   source(zshcompctl)
   source(zshmodules)
 + manpage(ZSHALL)(manext())(date())(zsh version())
   )\
   ifzman(includefile(Zsh/filelist.yo))
   ifzman(includefile(Zsh/seealso.yo))

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3ia
Charset: ascii

iQCVAwUBMz8G6nD/+HJTpU/hAQFxZQQAlNJ5F3tqFYByXaKWPudrCzQq9biYBjt8
ox6sv7dcAO5PLJMGbaxW+dZKx8PfloqCcMnEBrksa3ulsAKuMhZDl3FuLutAZNfI
ZjxphZ8FnM7WXdHKn23SmTAk4+IjMKWp4Iisxydq+Z6EI9UuN7lVSmGejIhSZF3O
RHJNn143Ifw=
=LNqj
-----END PGP SIGNATURE-----

