From zsh-workers-return-14592-mason-zsh=primenet.com.au@sunsite.dk Thu May 31 01:16:19 2001
Return-Path: <zsh-workers-return-14592-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 28498 invoked from network); 31 May 2001 01:16:17 -0000
Received: from sunsite.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 31 May 2001 01:16:17 -0000
Received: (qmail 9453 invoked by alias); 31 May 2001 01:16:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 14592
Received: (qmail 9441 invoked from network); 31 May 2001 01:16:08 -0000
Date: Wed, 30 May 2001 18:15:50 -0700
From: Jos Backus <josb@cncdsl.com>
To: Bart Schaefer <schaefer@candle.brasslantern.com>
Cc: zsh-workers@sunsite.dk
Subject: Re: zsh and autoconf-2.50
Message-ID: <20010530181550.K47866@lizzy.bugworks.com>
Reply-To: Jos Backus <josb@cncdsl.com>
References: <20010530155301.H47866@lizzy.bugworks.com> <Pine.LNX.4.33L2.0105301618520.5838-100000@phong.blorf.net> <20010530165042.J47866@lizzy.bugworks.com> <010530171233.ZM4082@candle.brasslantern.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <010530171233.ZM4082@candle.brasslantern.com>; from schaefer@candle.brasslantern.com on Wed, May 30, 2001 at 05:12:11PM -0700

On Wed, May 30, 2001 at 05:12:11PM -0700, Bart Schaefer wrote:
> "make check", but it runs several sub-shells, some of them on zpty terminals,
> so it may be hard to consolidate the purify output sensibly.

I'm using

    PURIFYOPTIONS="-log-file='purify.%v.%p.out' -chain-length=20"

which causes each shell to get its own log file. That should make things
easier.

> If you distill it down a bit first, you can send it to zsh-workers.

OK, I have to get it built first without the shell coredumping, which it
wasn't doing earlier when I built it used --disable-dynamic, but then the zpty
tests failed during ``gmake check''. I guess I may have to go back to using
--disable-dynamic and force zpty to be loaded statically (somehow).

This is what I see after

    ./configure --enable-zsh-debug
    gmake
    gmake install

taiko:/depot/src/zsh-4.0.1% Src/zsh
Purify 5.3 Solaris 2 (32-bit), Copyright (C) 1992-2001 Rational Software Corp. All rights reserved. 
Instrumenting: parameter.so Done.
Purify 5.3 Solaris 2 (32-bit), Copyright (C) 1992-2001 Rational Software Corp. All rights reserved. 
Instrumenting: zle.so Done.
Purify 5.3 Solaris 2 (32-bit), Copyright (C) 1992-2001 Rational Software Corp. All rights reserved. 
Instrumenting: complete.so Done.
Purify 5.3 Solaris 2 (32-bit), Copyright (C) 1992-2001 Rational Software Corp. All rights reserved. 
Instrumenting: zutil.so Done.
zsh: segmentation fault (core dumped)  Src/zsh
taiko:/depot/src/zsh-4.0.1% gdb Src/zsh core
GNU gdb 5.0
Copyright 2000 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "sparc-sun-solaris2.7"...
Core was generated by `Src/zsh'.
Program terminated with signal 11, Segmentation Fault.
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/lib32/libpure_solaris2_init.so.1...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/lib32/libpure_solaris2_init.so.1
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libsocket.so_pure_p3_c0_530_57_32_56988...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libsocket.so_pure_p3_c0_530_57_32_56988
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libdl.so.1_pure_p3_c0_530_57_32_4572...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libdl.so.1_pure_p3_c0_530_57_32_4572
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libnsl.so_pure_p3_c0_530_57_32_831560...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libnsl.so_pure_p3_c0_530_57_32_831560
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libcurses.so.1_pure_p3_c0_530_57_32_459136...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libcurses.so.1_pure_p3_c0_530_57_32_459136
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libm.so.1_pure_p3_c0_530_57_32_106368...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libm.so.1_pure_p3_c0_530_57_32_106368
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libc.so.1_pure_p3_c0_530_57_32_1115336...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libc.so.1_pure_p3_c0_530_57_32_1115336
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/lib32/libinternal_stubs.so.1...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/lib32/libinternal_stubs.so.1
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libnsl.so.1_pure_p3_c0_530_57_32_831560...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libnsl.so.1_pure_p3_c0_530_57_32_831560
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libmp.so.2_pure_p3_c0_530_57_32_19876...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libmp.so.2_pure_p3_c0_530_57_32_19876
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/platform/SUNW,UltraAX-MP/lib/libc_psr.so.1_pure_p3_c0_530_57_32...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/platform/SUNW,UltraAX-MP/lib/libc_psr.so.1_pure_p3_c0_530_57_32
Reading symbols from /depot/pkg/zsh-4.0.1/lib/zsh/4.0.1-pre-5/zsh/parameter.so_pure_p3_c0_530_57_32...done.
Loaded symbols for /depot/pkg/zsh-4.0.1/lib/zsh/4.0.1-pre-5/zsh/parameter.so_pure_p3_c0_530_57_32
Reading symbols from /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libsocket.so.1_pure_p3_c0_530_57_32_56988...done.
Loaded symbols for /depot/pkg/rational/releases/purify-5.3-solaris2/cache/usr/lib/libsocket.so.1_pure_p3_c0_530_57_32_56988
Reading symbols from /depot/pkg/zsh-4.0.1/lib/zsh/4.0.1-pre-5/zsh/zle.so_pure_p3_c0_530_57_32...done.
Loaded symbols for /depot/pkg/zsh-4.0.1/lib/zsh/4.0.1-pre-5/zsh/zle.so_pure_p3_c0_530_57_32
re_p3_c0_530_57_32...done.
Loaded symbols for /depot/pkg/zsh-4.0.1/lib/zsh/4.0.1-pre-5/zsh/complete.so_pure_p3_c0_530_57_32
Reading symbols from /depot/pkg/zsh-4.0.1/lib/zsh/4.0.1-pre-5/zsh/zutil.so_pure_p3_c0_530_57_32...done.
Loaded symbols for /depot/pkg/zsh-4.0.1/lib/zsh/4.0.1-pre-5/zsh/zutil.so_pure_p3_c0_530_57_32
#0  0x69040 in _p888static ()
(gdb) bt
#0  0x69040 in _p888static ()
#1  0x48718 in pure_signal_handler_wrapper ()
#2  0x66208 in pure_sigtramp ()
#3  0x6e51c in execbuiltin (args=0x1f4df8, bn=0xfe4ed754) at builtin.c:367
#4  0xa40e8 in execcmd (state=0xffbeee30, input=0, output=0, how=2, last1=2)
    at exec.c:2287
#5  0x9c25c in execpline2 (state=0xffbeee30, pcode=31299, how=2, input=0, 
    output=0, last1=0) at exec.c:1192
#6  0x9a47c in execpline (state=0xffbeee30, slcode=7202, how=2, last1=0)
    at exec.c:982
#7  0x99298 in execlist (state=0xffbeee30, dont_change_job=1, exiting=0)
    at exec.c:833
#8  0xf91d0 in execif (state=0xffbeee30, do_exec=0) at loop.c:469
#9  0xa3b2c in execcmd (state=0xffbeee30, input=0, output=0, how=2, last1=2)
    at exec.c:2234
#10 0x9c25c in execpline2 (state=0xffbeee30, pcode=31235, how=2, input=0, 
    output=0, last1=0) at exec.c:1192
#11 0x9a47c in execpline (state=0xffbeee30, slcode=29698, how=2, last1=0)
    at exec.c:982
#12 0x991ec in execlist (state=0xffbeee30, dont_change_job=1, exiting=0)
    at exec.c:826
#13 0x98984 in execode (p=0x1e1500, dont_change_job=1, exiting=0) at exec.c:729
#14 0xaa170 in execautofn (state=0xffbef268, do_exec=0) at exec.c:3219
#15 0xa3b2c in execcmd (state=0xffbef268, input=0, output=0, how=18, last1=2)
    at exec.c:2234
#16 0x9c25c in execpline2 (state=0xffbef268, pcode=3, how=18, input=0, 
    output=0, last1=0) at exec.c:1192
#17 0x9a47c in execpline (state=0xffbef268, slcode=3074, how=18, last1=0)
    at exec.c:982
#18 0x991ec in execlist (state=0xffbef268, dont_change_job=1, exiting=0)
    at exec.c:826
#19 0x98984 in execode (p=0x1e9bb8, dont_change_job=1, exiting=0) at exec.c:729
#20 0xab768 in runshfunc (prog=0x1e9bb8, wrap=0x0, name=0x1f41f0 "compinit")
    at exec.c:3449
#21 0xab078 in doshfunc (name=0x1fa828 "compinit", prog=0x1e9bb8, 
    doshargs=0x1f41b8, flags=8704, noreturnval=0) at exec.c:3382
#22 0xa9f74 in execshfunc (shf=0x1fe488, args=0x1f41b8) at exec.c:3191
#23 0xa3f5c in execcmd (state=0xffbef868, input=0, output=0, how=18, last1=2)
    at exec.c:2276
#24 0x9c25c in execpline2 (state=0xffbef868, pcode=323, how=18, input=0, 
    output=0, last1=0) at exec.c:1192
#25 0x9a47c in execpline (state=0xffbef868, slcode=3074, how=18, last1=0)
    at exec.c:982
#26 0x991ec in execlist (state=0xffbef868, dont_change_job=0, exiting=0)
    at exec.c:826
#27 0x98984 in execode (p=0x1f4170, dont_change_job=0, exiting=0) at exec.c:729
#28 0xd5b24 in loop (toplevel=0, justonce=0) at init.c:160
#29 0xd9ea8 in source (s=0xffbefa18 "/depot-common/.zshrc") at init.c:999
#30 0xda674 in sourcehome (s=0x19f658 ".zshrc") at init.c:1044
#31 0xd96c8 in run_init_scripts () at init.c:908
#32 0xdb5f8 in zsh_main (argc=1, argv=0xffbefc44) at init.c:1204
#33 0x6ce20 in main (argc=1, argv=0xffbefc44) at ./main.c:37
(gdb) 

> By the way, folks, reminder again:  It's <zsh-workers@sunsite.dk> now (no
> "auc") so please update your aliases/addressbooks/etc.
 
Oops. The X-Mailing-List was throwing me off.

-- 
Jos Backus                 _/  _/_/_/        "Modularity is not a hack."
                          _/  _/   _/                -- D. J. Bernstein
                         _/  _/_/_/             
                    _/  _/  _/    _/
josb@cncdsl.com     _/_/   _/_/_/            use Std::Disclaimer;

