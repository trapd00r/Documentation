From zsh-workers-return-9634-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Feb 09 10:36:09 2000
Return-Path: <zsh-workers-return-9634-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 5035 invoked from network); 9 Feb 2000 10:36:08 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 9 Feb 2000 10:36:08 -0000
Received: (qmail 10530 invoked by alias); 9 Feb 2000 10:36:00 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 9634
Received: (qmail 10522 invoked from network); 9 Feb 2000 10:36:00 -0000
To: zsh-workers@math.gatech.edu
Subject: PATCH: empty trap coredump
X-Attribution: adl
From: Alexandre Duret-Lutz <duret_g@epita.fr>
Date: 09 Feb 2000 11:34:30 +0100
Message-ID: <mvbd7q6fyvd.fsf@phobos.lrde.epita.fr>
Lines: 22
User-Agent: Gnus/5.0803 (Gnus v5.8.3) Emacs/20.5
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


% trap '' 1
zsh: segmentation fault  /bin/zsh

The fix below come from Akim Demaille <akim@epita.fr> though I'm sending it.

Index: Src/builtin.c
--- Src/builtin.c Sun, 06 Feb 2000 11:06:18 +0100 Alexandre
+++ Src/builtin.c Wed, 09 Feb 2000 11:15:22 +0100 Alexandre
@@ -3883,7 +3883,7 @@
     /* Sort out the command to execute on trap */
     arg = *argv++;
     if (!*arg)
-	prog = NULL;
+	prog = &dummy_eprog;
     else if (!(prog = parse_string(arg, 0))) {
 	zwarnnam(name, "couldn't parse trap command", NULL, 0);
 	return 1;


-- 
Alexandre Duret-Lutz

