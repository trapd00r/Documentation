From zsh-users-return-7103-mason-zsh=primenet.com.au@sunsite.dk Wed Mar 03 18:53:42 2004
Return-Path: <zsh-users-return-7103-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 15586 invoked from network); 3 Mar 2004 18:53:42 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 3 Mar 2004 18:53:42 -0000
Received: (qmail 19250 invoked by alias); 3 Mar 2004 18:53:23 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 7103
Received: (qmail 19235 invoked from network); 3 Mar 2004 18:53:23 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 3 Mar 2004 18:53:23 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [63.249.88.2] by sunsite.dk (MessageWall 1.0.8) with SMTP; 3 Mar 2004 18:53:22 -0000
Received: by binome.blorf.net (Postfix, from userid 1000)
	id E63642980; Wed,  3 Mar 2004 10:53:21 -0800 (PST)
Date: Wed, 3 Mar 2004 10:53:21 -0800
From: Wayne Davison <wayned@users.sourceforge.net>
To: Zsh users list <zsh-users@sunsite.dk>
Subject: Re: 4.2.0-pre-2
Message-ID: <20040303185321.GE9561@blorf.net>
References: <17958.1078322407@csr.com>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="VV4b6MQE+OnNyhkM"
Content-Disposition: inline
In-Reply-To: <17958.1078322407@csr.com>
User-Agent: Mutt/1.5.5.1+cvs20040105i


--VV4b6MQE+OnNyhkM
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

I noticed that someone removed the stamp-h idiom from the Makefile
recently.  This means that we no longer handle the case where configure
gets rerun (generating a new config.status) but the config.h file didn't
change (so it's timestamp doesn't update).  When this happens the
config.h rules will get rerun every time you type "make".  The attached
patch fixes this.

..wayne..

--VV4b6MQE+OnNyhkM
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="stamp.patch"

--- Makefile.in	14 Feb 2004 18:50:16 -0000	1.12
+++ Makefile.in	3 Mar 2004 17:23:53 -0000
@@ -134,8 +134,9 @@
 $(sdir)/configure: $(sdir)/aclocal.m4 $(sdir)/aczsh.m4 $(sdir)/configure.ac
 	cd $(sdir) && autoconf
 
-config.h config.modules: $(sdir)/config.h.in config.status
-	cd $(dir_top) && $(SHELL) ./config.status $@
+config.h: stamp-h
+stamp-h config.modules: $(sdir)/config.h.in config.status
+	cd $(dir_top) && $(SHELL) ./config.status config.h $@
 
 $(sdir)/config.h.in: $(sdir)/stamp-h.in
 $(sdir)/stamp-h.in: $(sdir)/configure.ac \
--- configure.ac	1 Mar 2004 17:58:55 -0000	1.11
+++ configure.ac	3 Mar 2004 17:23:53 -0000
@@ -2379,6 +2379,7 @@
 AC_CONFIG_FILES(Config/defs.mk Makefile Doc/Makefile Etc/Makefile \
 Src/Makefile Test/Makefile)
 AC_CONFIG_COMMANDS([config.modules], [. ./config.modules.sh])
+AC_CONFIG_COMMANDS([stamp-h], [echo >stamp-h])
 
 AC_OUTPUT
 

--VV4b6MQE+OnNyhkM--

