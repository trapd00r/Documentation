Delivered-To: mason-zsh@primenet.com.au
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
From: "Bart Schaefer" <schaefer@brasslantern.com>
Message-Id: <990202041028.ZM3959@candle.brasslantern.com>
Date: Tue, 2 Feb 1999 04:10:27 -0800
In-Reply-To: <990202035928.ZM3652@candle.brasslantern.com>
Comments: In reply to "Bart Schaefer" <schaefer@brasslantern.com>
        "Re: Fun with zsh (Re: Associative array ordering (Re: Example function))" (Feb  2,  3:59am)
References: <jarausch-990202124256.A09694@numa1> 
	<990202035928.ZM3652@candle.brasslantern.com>
X-Mailer: Z-Mail (4.0b.820 20aug96)
To: Helmut Jarausch <jarausch@IGPM.Rwth-Aachen.DE>
Subject: Re: Fun with zsh (Re: Associative array ordering (Re: Example function))
Cc: zsh-workers@sunsite.auc.dk
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailing-List: <zsh-workers@sunsite.auc.dk> 5177

On Feb 2,  3:59am, Bart Schaefer wrote:
} Subject: Re: Fun with zsh (Re: Associative array ordering (Re: Example fun
}
} On Feb 2, 12:42pm, Helmut Jarausch wrote:
} } array> '(*.bz)AIcons-1.5.tar.bz2bzip -dc'
} }               ^^^^^^^^^^^^^^^^^^   where does this come from?
} 
} If you did cut and paste, that's showing up because there's a tab
} 
} That's obviously wrong here in more ways than one, and in fact my own
} just-compiled copy of zsh dumps core when I do the same thing.

I think this fixes it; at least, it prevents my crash, but I'm not sure
it's otherwise correct.  Help, Sven!

Index: Src/Zle/zle_tricky.c
===================================================================
RCS file: /extra/cvsroot/zsh/zsh-3.1/Src/Zle/zle_tricky.c,v
retrieving revision 1.46
diff -u -r1.46 zle_tricky.c
--- zle_tricky.c	1999/02/01 17:26:44	1.46
+++ zle_tricky.c	1999/02/02 12:03:54
@@ -3708,7 +3708,7 @@
 {
     Patcomp pc;
     Comp pat;
-    char *s = findcmd(cmdstr, 1);
+    char *s = incmd ? findcmd(cmdstr, 1) : os;
 
     for (pc = patcomps; pc; pc = pc->next) {
 	if ((pat = parsereg(pc->pat)) &&

-- 
Bart Schaefer                                 Brass Lantern Enterprises
http://www.well.com/user/barts              http://www.brasslantern.com

