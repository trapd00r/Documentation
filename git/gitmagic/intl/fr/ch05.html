<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Git Magic - Chapitre&nbsp;5.&nbsp;Les leçons de l’histoire</title>
  <link rel="stylesheet" href="default.css" type="text/css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
  <link rel="home" href="index.html" title="Git Magique">
  <link rel="up" href="index.html" title="Git Magique">
  <link rel="prev" href="ch04.html" title=
  "Chapitre&nbsp;4.&nbsp;La sorcellerie des branches">
  <link rel="next" href="ch06.html" title=
  "Chapitre&nbsp;6.&nbsp;Git multijoueur">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
    <div class="toc">
      <ul>
<li><b>Git Magic</b></li>
        <li>
          <span class="preface"><a href=
          "index.html">Préface</a></span>

          <ul>
            <li><span class="section"><a href=
            "index.html#_merci">Merci&nbsp;!</a></span></li>

            <li><span class="section"><a href=
            "index.html#_licence">Licence</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch01.html">1.
          Introduction</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch01.html#_le_travail_comme_un_jeu">Le travail comme
            un jeu</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_gestion_de_versions">Gestion de
            versions</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_gestion_distribu%C3%A9e">Gestion
            distribuée</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_une_superstition_idiote">Une superstition
            idiote</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_conflits_fusionnels">Conflits
            fusionnels</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch02.html">2. Astuces de
          base</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch02.html#_enregistrer_l_%C3%A9tat_courant">Enregistrer
            l'état courant</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_ajouter_supprimer_renommer">Ajouter,
            supprimer, renommer</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_annuler_reprendre_avanc%C3%A9">Annuler/Reprendre
            avancé</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_reprise_revert">Reprise
            (revert)</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_g%C3%A9n%C3%A9ration_du_journal_des_modifications_changelog">
            Génération du journal des modifications
            (changelog)</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_t%C3%A9l%C3%A9charger_des_fichiers">Télécharger
            des fichiers</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_le_dernier_cri">Le dernier
            cri</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_publication_instantan%C3%A9e">Publication
            instantanée</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_qu_8217_ai_je_fait">Qu’ai-je
            fait&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_exercice">Exercice</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch03.html">3. Clonons
          gaiement</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch03.html#_synchronisation_entre_machines">Synchronisation
            entre machines</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_gestion_classique_des_sources">Gestion
            classique des sources</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_d%C3%A9p%C3%B4ts_nus">Dépôts
            nus</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_envoi_vs_rapatriement_push_vs_pull">Envoi
            vs rapatriement (push vs pull)</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_forker_un_projet">Forker un
            projet</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_syst%C3%A8me_ultime_de_sauvegarde">Système
            ultime de sauvegarde</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_le_multi_t%C3%A2che_%C3%A0_la_vitesse_de_la_lumi%C3%A8re">
            Le multi-tâche à la vitesse de la
            lumière</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_gu%C3%A9rilla_de_la_gestion_de_versions">Guérilla
            de la gestion de versions</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_mercurial">Mercurial</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bazaar">Bazaar</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_pourquoi_j_8217_utilise_git">Pourquoi
            j’utilise Git</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch04.html">4. La
          sorcellerie des branches</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch04.html#_la_touche_du_chef">La touche du
            chef</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_travail_temporaire">Travail
            temporaire</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_corrections_rapides">Corrections
            rapides</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_fusionner">Fusionner</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_workflow_sans_interruption">Workflow sans
            interruption</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_r%C3%A9organiser_le_foutoir">Réorganiser le
            foutoir</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_gestion_des_branches">Gestion des
            branches</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_les_branches_temporaires">Les branches
            temporaires</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_travailler_comme_il_vous_chante">Travailler
            comme il vous chante</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch05.html">5. Les leçons
          de l’histoire</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch05.html#_je_me_corrige_8230">Je me
            corrige…</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_8230_et_bien_plus">… et bien
            plus</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_les_changements_locaux_en_dernier">Les
            changements locaux en dernier</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_r%C3%A9%C3%A9criture_de_l_8217_histoire">Réécriture
            de l’histoire</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_faire_l_8217_histoire">Faire
            l’histoire</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_qu_8217_est_ce_qui_a_tout_cass%C3%A9">Qu’est-ce
            qui a tout cassé&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_qui_a_tout_cass%C3%A9">Qui a tout
            cassé&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_exp%C3%A9rience_personnelle">Expérience
            personnelle</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch06.html">6. Git
          multijoueur</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch06.html#_qui_suis_je">Qui
            suis-je&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_via_ssh_et_http">Git via SSH et
            HTTP</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_via_n_8217_importe_quoi">Git via
            n’importe quoi</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_les_patches_la_monnaie_d_%C3%A9change_globale">
            Les patches&nbsp;: la monnaie d'échange
            globale</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_le_num%C3%A9ro_de_votre_correspondant_a_chang%C3%A9">
            Le numéro de votre correspondant a
            changé</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_les_branches_distantes">Les branches
            distantes</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_d%C3%A9p%C3%B4ts_distants_multiples">Dépôts
            distants multiples</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_mes_pr%C3%A9f%C3%A9rences">Mes
            préférences</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch07.html">7. La maîtrise
          de Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch07.html#_publication_de_sources">Publication de
            sources</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_g%C3%A9rer_le_changement">Gérer le
            changement</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_mon_commit_est_trop_gros">Mon commit est
            trop gros&nbsp;!</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_l_8217_index_l_8217_aire_d_8217_assemblage">
            L’index&nbsp;: l’aire d’assemblage</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_ne_perdez_pas_la_t%C3%AAte">Ne perdez pas
            la tête</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_chasseur_de_t%C3%AAte">Chasseur de
            tête</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_construire_au_dessus_de_git">Construire
            au-dessus de Git</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_audacieuses_acrobaties">Audacieuses
            acrobaties</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_se_pr%C3%A9munir_des_commits_erron%C3%A9s">Se
            prémunir des commits erronés</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch08.html">8. Les secrets
          révélés</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch08.html#_l_8217_invisibilit%C3%A9">L’invisibilité</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_l_8217_int%C3%A9grit%C3%A9">L’intégrité</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_l_8217_intelligence">L’intelligence</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_l_8217_indexation">L’indexation</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_origines_de_git">Les origines de
            Git</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_la_base_d_8217_objets">La base
            d’objets</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_blobs">Les blobs</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_arbres_literal_trees_literal">Les
            arbres (<code class=
            "literal">trees</code>)</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_les_commits">Les commits</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_indiscernable_de_la_magie">Indiscernable de
            la magie</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch09.html">9. Appendix A:
          Les lacunes de Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch09.html#_les_faiblesses_de_sha1">Les faiblesses de
            SHA1</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_microsoft_windows">Microsoft
            Windows</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_des_fichiers_sans_relation">Des fichiers
            sans relation</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_qui_modifie_quoi">Qui modifie
            quoi&nbsp;?</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_l_8217_historique_d_8217_un_fichier">L’historique
            d’un fichier</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_le_clone_initial">Le clone
            initial</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_les_projets_versatiles">Les projets
            versatiles</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_compteur_global">Compteur
            global</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_les_dossiers_vides">Les dossiers
            vides</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_le_premier_commit">Le premier
            commit</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_bizarreries_de_l_8217_interface">Bizarreries
            de l’interface</a></span></li>
          </ul>
        </li>

        <li><span class="chapter"><a href="ch10.html">10. Appendix
        B: Traduire ce guide</a></span></li>
      </ul>
    </div>
<div class="content">
  <div class="chapter" title=
  "Chapitre&nbsp;5.&nbsp;Les leçons de l’histoire">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title"><a name=
          "_les_le%C3%A7ons_de_l_8217_histoire"></a>Chapitre&nbsp;5.&nbsp;Les
          leçons de l’histoire</h2>
        </div>
      </div>
    </div>

    <p>L’une des conséquences de la nature distribuée de Git est
    qu’il est facile de modifier l’historique. Mais si vous
    réécrivez le passé, faites attention&nbsp;: ne modifiez que la
    partie de l’historique que vous êtes le seul à posséder. Sinon,
    comme des nations qui se battent éternellement pour savoir qui
    a commis telle ou telle atrocité, si quelqu’un d’autre possède
    un clone dont l’historique diffère du vôtre, vous aurez des
    difficultés à vous réconcilier lorsque vous interagirez.</p>

    <p>Certains développeurs insistent très fortement pour que
    l’historique soit considérer comme immuable. D’autres pensent
    au contraire que les historiques doivent être rendus
    présentables avant d'être présentés publiquement. Git
    s’accommode des deux points de vue. Comme les clones, les
    branches et les fusions, la réécriture de l’historique est
    juste un pouvoir supplémentaire que vous donne Git. C’est à
    vous de l’utiliser à bon escient.</p>

    <div class="section" title="Je me corrige…">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="_je_me_corrige_8230"></a>Je
            me corrige…</h2>
          </div>
        </div>
      </div>

      <p>Que faire si vous avez fait un commit mais que vous
      souhaitez y attacher un message différent&nbsp;? Pour
      modifier le dernier message, tapez&nbsp;:</p>
      <pre class="literallayout">
$ git commit --amend
</pre>

      <p>Vous apercevez-vous que vous avez oublié un fichier&nbsp;?
      Faites <span class="strong"><strong>git add</strong></span>
      pour l’ajouter puis exécutez le commande ci-dessus.</p>

      <p>Voulez-vous ajouter quelques modifications supplémentaires
      au dernier commit&nbsp;? Faites ces modifications puis
      exécutez&nbsp;:</p>
      <pre class="literallayout">
$ git commit --amend -a
</pre>
    </div>

    <div class="section" title="… et bien plus">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="_8230_et_bien_plus"></a>… et
            bien plus</h2>
          </div>
        </div>
      </div>

      <p>Supposons que le problème précédent est dix fois pire.
      Après une longue séance, vous avez effectué une série de
      commits. Mais vous n'êtes pas satisfait de la manière dont
      ils sont organisés et certains des messages associés doivent
      être revus. Tapez alors&nbsp;:</p>
      <pre class="literallayout">
$ git rebase -i HEAD~10
</pre>

      <p>et les dix derniers commits apparaissent dans votre
      $EDITOR favori. Voici un petit extrait&nbsp;:</p>
      <pre class="literallayout">
pick 5c6eb73 Added repo.or.cz link
pick a311a64 Reordered analogies in "Work How You Want"
pick 100834f Added push target to Makefile
</pre>

      <p>Ensuite&nbsp;:</p>

      <div class="itemizedlist">
        <ul class="itemizedlist">
          <li class="listitem">Supprimez un commit en supprimant sa
          ligne.</li>

          <li class="listitem">Réordonnez des commits en
          réordonnant leurs lignes.</li>

          <li class="listitem">
            <p class="simpara">Remplacez <code class=
            "literal">pick</code> par&nbsp;:</p>

            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem"><code class=
                "literal">edit</code> pour marquer ce commit pour
                amendement.</li>

                <li class="listitem"><code class=
                "literal">reword</code> pour modifier le message
                associé.</li>

                <li class="listitem"><code class=
                "literal">squash</code> pour fusionner ce commit
                avec le précédent.</li>

                <li class="listitem"><code class=
                "literal">fixup</code> pour fusionner ce commit
                avec le précédent en supprimant le message
                associé.</li>
              </ul>
            </div>
          </li>
        </ul>
      </div>

      <p>Sauvegardez et quittez. Si vous avez marqué un commit pour
      amendement alors tapez&nbsp;:</p>
      <pre class="literallayout">
$ git commit --amend
</pre>

      <p>Sinon, tapez&nbsp;:</p>
      <pre class="literallayout">
$ git rebase --continue
</pre>

      <p>Donc faites des commits très tôt et faites-en
      souvent&nbsp;: vous pourrez tout ranger plus tard grâce à
      <span class="emphasis"><em>rebase</em></span>.</p>
    </div>

    <div class="section" title="Les changements locaux en dernier">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_les_changements_locaux_en_dernier"></a>Les
            changements locaux en dernier</h2>
          </div>
        </div>
      </div>

      <p>Vous travaillez sur un projet actif. Vous faites quelques
      commits locaux puis vous vous resynchronisez avec le dépôt
      officiel grâce à une fusion (merge). Ce cycle se répète
      jusqu’au moment où vous êtes prêt à pousser vos contributions
      vers le dépôt central.</p>

      <p>Mais à cet instant l’historique de votre clone Git local
      est un fouillis infâme mélangeant les modifications
      officielles et les vôtres. Vous préféreriez que toutes vos
      modifications soient contiguës et se situent après toutes les
      modifications officielles.</p>

      <p>C’est un boulot pour <span class="strong"><strong>git
      rebase</strong></span> comme décrit ci-dessus. Dans la
      plupart des cas, vous pouvez utilisez l’option <span class=
      "strong"><strong>--onto</strong></span> et éviter les
      interactions.</p>

      <p>Lisez <span class="strong"><strong>git help
      rebase</strong></span> pour des exemples détaillés sur cette
      merveilleuse commande. Vous pouvez scinder des commits. Vous
      pouvez même réarranger des branches de l’arbre.</p>
    </div>

    <div class="section" title="Réécriture de l’histoire">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_r%C3%A9%C3%A9criture_de_l_8217_histoire"></a>Réécriture
            de l’histoire</h2>
          </div>
        </div>
      </div>

      <p>De temps en temps, vous avez besoin de faire des
      modifications équivalentes à la suppression d’une personne
      d’une photo officielle, la gommant ainsi de l’histoire d’une
      manière quasi Stalinienne. Supposons que vous ayez publié un
      projet mais en y intégrant un fichier que vous auriez dû
      conserver secret. Par exemple, vous avez accidentellement
      ajouté un fichier texte contenant votre numéro de carte de
      crédit. Supprimer ce fichier n’est pas suffisant puisqu’il
      pourra encore être retrouvé via d’anciennes versions du
      projet. Vous devez supprimer ce fichier dans toutes les
      versions&nbsp;:</p>
      <pre class="literallayout">
$ git filter-branch --tree-filter 'rm top/secret/fichier' HEAD
</pre>

      <p>La documentation <span class="strong"><strong>git help
      filter-branch</strong></span> explique cette exemple et donne
      une méthode plus rapide. De manière générale, <span class=
      "strong"><strong>filter-branch</strong></span> vous permet de
      modifier des pans entiers de votre historique grâce à une
      seule commande.</p>

      <p>Après cela, le dossier <code class=
      "literal">.git/refs/original</code> contiendra l'état de
      votre dépôt avant l’opération. Vérifiez que la commande
      filter-branch a bien fait ce que vous souhaitiez puis effacer
      ce dossier si vous voulez appliquer d’autres commandes
      filter-branch.</p>

      <p>Finalement, remplacez tous les clones de votre projet par
      votre version révisée si vous voulez pouvoir interagir avec
      eux plus tard.</p>
    </div>

    <div class="section" title="Faire l’histoire">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_faire_l_8217_histoire"></a>Faire l’histoire</h2>
          </div>
        </div>
      </div>

      <p><a name="makinghistory" id="makinghistory"></a>
      Voulez-vous faire migrer un projet vers Git&nbsp;? S’il est
      géré par l’un des systèmes bien connus alors il y a de
      grandes chances que quelqu’un ait déjà écrit un script afin
      d’importer l’ensemble de l’historique dans Git.</p>

      <p>Sinon, regarder du côté de <span class=
      "strong"><strong>git fast-import</strong></span> qui lit un
      fichier texte dans un format spécifique pour créer un
      historique Git à partir de rien. Typiquement un script
      utilisant cette commande est un script jetable qui ne servira
      qu’une seule fois pour migrer le projet d’un seul coup.</p>

      <p>À titre d’exemple, collez le texte suivant dans un fichier
      temporaire (<code class=
      "literal">/tmp/historique</code>)&nbsp;:</p>
      <pre class="screen">
commit refs/heads/master
committer Alice &lt;alice@example.com&gt; Thu, 01 Jan 1970 00:00:00 +0000
data &lt;&lt;EOT
Commit initial
EOT

M 100644 inline hello.c
data &lt;&lt;EOT
#include &lt;stdio.h&gt;

int main() {
  printf("Hello, world!\n");
  return 0;
}
EOT


commit refs/heads/master
committer Bob &lt;bob@example.com&gt; Tue, 14 Mar 2000 01:59:26 -0800
data &lt;&lt;EOT
Remplacement de printf() par write().
EOT

M 100644 inline hello.c
data &lt;&lt;EOT
#include &lt;unistd.h&gt;

int main() {
  write(1, "Hello, world!\n", 14);
  return 0;
}
EOT
</pre>

      <p>Puis créez un dépôt Git à partir de ce fichier temporaire
      en tapant&nbsp;:</p>
      <pre class="literallayout">
$ mkdir projet; cd projet; git init
$ git fast-import --date-format=rfc2822 &lt; /tmp/historique
</pre>

      <p>Vous pouvez extraire la dernière version de ce projet
      avec&nbsp;:</p>
      <pre class="literallayout">
$ git checkout master .
</pre>

      <p>La commande <span class="strong"><strong>git
      fast-export</strong></span> peut convertir n’importe quel
      dépôt Git en un fichier au format <span class=
      "strong"><strong>git fast-import</strong></span> ce qui vous
      permet de l'étudier pour écrire des scripts d’exportation
      mais vous permet aussi de transporter un dépôt dans un format
      lisible. Ces commandes permettent aussi d’envoyer un dépôt
      via un canal qui n’accepte que du texte pur.</p>
    </div>

    <div class="section" title="Qu’est-ce qui a tout cassé&nbsp;?">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_qu_8217_est_ce_qui_a_tout_cass%C3%A9"></a>Qu’est-ce
            qui a tout cassé&nbsp;?</h2>
          </div>
        </div>
      </div>

      <p>Vous venez tout juste de découvrir un bug dans une
      fonctionnalité de votre programme et pourtant vous êtes sûr
      qu’elle fonctionnait encore parfaitement il y a quelques
      mois. Zut&nbsp;! D’où provient ce bug&nbsp;? Si seulement
      vous aviez testé cette fonctionnalité pendant vos
      développements.</p>

      <p>Mais il est trop tard. En revanche, en supposant que vous
      avez fait des commits suffisamment souvent, Git peut cerner
      le problème.</p>
      <pre class="literallayout">
$ git bisect start
$ git bisect bad HEAD
$ git bisect good 1b6d
</pre>

      <p>Git extrait un état à mi-chemin entre ces deux versions
      (HEAD et 1b6d). Testez la fonctionnalité et si le bug se
      manifeste&nbsp;:</p>
      <pre class="literallayout">
$ git bisect bad
</pre>

      <p>Si elle ne se manifeste pas, remplacer "bad" (mauvais) par
      "good" (bon). Git vous transporte à nouveau dans un état à
      mi-chemin entre la bonne et la mauvaise version, en réduisant
      ainsi les possibilités. Après quelques itérations, cette
      recherche dichotomique vous amènera au commit où le bug est
      survenu. Une fois vos investigations terminées, retourner à
      votre état original en tapant&nbsp;:</p>
      <pre class="literallayout">
$ git bisect reset
</pre>

      <p>Au lieu de tester chaque état à la main, automatisez la
      recherche en tapant&nbsp;:</p>
      <pre class="literallayout">
$ git bisect run mon_script
</pre>

      <p>Git utilise la valeur de retour du script fourni pour
      décider si un état est bon ou mauvais&nbsp;: mon_script doit
      retourner 0 si l'état courant est ok, 125 si cet état doit
      être sauté et n’importe quelle valeur entre 1 et 127 si
      l'état est mauvais. Une valeur négative abandonne la commande
      bisect.</p>

      <p>Vous pouvez faire bien plus&nbsp;: la page d’aide explique
      comment visualiser les bisects, comment examiner ou rejouer
      le log d’un bisect et comment éliminer des changements que
      vous savez sans conséquence afin d’accélérer la
      recherche.</p>
    </div>

    <div class="section" title="Qui a tout cassé&nbsp;?">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_qui_a_tout_cass%C3%A9"></a>Qui a tout
            cassé&nbsp;?</h2>
          </div>
        </div>
      </div>

      <p>Comme de nombreux systèmes de gestion de versions, Git a
      sa commande blame&nbsp;:</p>
      <pre class="literallayout">
$ git blame bug.c
</pre>

      <p>Cette commande annote chaque ligne du fichier afin de
      montrer par qui et quand elle a été modifiée la dernière
      fois. À l’inverse de la plupart des autres systèmes, cette
      commande marche hors-ligne et ne lit que le disque local.</p>
    </div>

    <div class="section" title="Expérience personnelle">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_exp%C3%A9rience_personnelle"></a>Expérience
            personnelle</h2>
          </div>
        </div>
      </div>

      <p>Avec un système de gestion de versions centralisé, la
      modification de l’historique est une opération difficile et
      faisable uniquement par les administrateurs. Créer un clone,
      créer une branche ou en fusionner plusieurs sont des
      opérations impossibles à réaliser sans communication réseau.
      Il en est de même pour certains opérations basiques telles
      que parcourir l’historique ou intégrer une modification. Avec
      certains systèmes, des communications réseaux sont même
      nécessaires juste pour voir ses propres modifications ou pour
      ouvrir un fichier avec le droit de modification.</p>

      <p>Ces systèmes centralisés empêchent le travail hors-ligne
      et nécessitent une infrastructure réseau d’autant plus lourde
      que le nombre de développeurs augmentent. Plus important
      encore, certaines opérations deviennent si lentes que les
      utilisateurs les évitent à moins qu’elles soient absolument
      indispensables. Dans les cas extrêmes cela devient vrai même
      pour les commandes les plus basiques. Lorsque les
      utilisateurs doivent effectuer des opérations lentes, la
      productivité souffre des interruptions répétées.</p>

      <p>J’ai moi-même vécu ce phénomène. Git a été le premier
      système de gestion de versions que j’ai utilisé. Je me suis
      vite accoutumé à lui, tenant la plupart de ses
      fonctionnalités pour acquises. Je pensais que les autres
      systèmes étaient similaires&nbsp;: le choix d’un système de
      gestion de versions ne devait pas être bien différent du
      choix d’un éditeur de texte ou d’un navigateur web.</p>

      <p>J’ai été très surpris lorsque, plus tard, il m’a fallu
      utilisé un système centralisé. Une liaison internet
      épisodique importe peu avec Git mais rend le développement
      quasi impossible lorsque le système exige qu’elle soit aussi
      fiable que les accès au disque local. De plus, je me
      restreignais afin d'éviter certaines commandes trop longues,
      ce qui m’empêchait de suivre ma méthode de travail
      habituelle.</p>

      <p>Lorsqu’il me fallait utiliser ces commandes lentes, cela
      interrompait mes réflexions et avait des effets pervers. En
      attendant la fin des communications avec le serveur, je me
      lançais dans autre chose pour passer le temps comme lire mes
      mails ou écrire de la documentation. Lorsque je revenais à
      mon travail initial, la commande s'était terminée depuis
      longtemps et je perdais du temps à retrouver le fil de mes
      pensées. Les être humains ne sont pas bons pour changer de
      contexte.</p>

      <p>Il y a aussi un effet intéressant du type «&nbsp;tragédie
      des biens communs&nbsp;»&nbsp;: afin d’anticiper la
      congestion du réseau, certains vont consommer plus de bandes
      passantes que nécessaire pour effectuer des opérations visant
      à réduire leurs attentes futures. Ces efforts combinés vont
      encore augmenter la congestion, incitant ces personnes à
      consommer encore plus de bande passante pour éviter ces
      délais toujours plus longs.</p>
    </div>
  </div><script type="text/javascript" src="find_selflink.js">
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1901330-2");
  pageTracker._initData();
  pageTracker._trackPageview();
  </script>
</div>
</div><div class="footer"><a href="/~blynn/">Ben Lynn</a></div>
</body>
</html>
