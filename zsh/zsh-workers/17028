From zsh-workers-return-17028-mason-zsh=primenet.com.au@sunsite.dk Wed Apr 24 07:38:22 2002
Return-Path: <zsh-workers-return-17028-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 3646 invoked from network); 24 Apr 2002 07:38:20 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 24 Apr 2002 07:38:20 -0000
Received: (qmail 22347 invoked by alias); 24 Apr 2002 07:38:10 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 17028
Received: (qmail 22333 invoked from network); 24 Apr 2002 07:38:09 -0000
From: Sven Wischnowsky <wischnow@berkom.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15558.24758.24690.413672@wischnow.berkom.de>
Date: Wed, 24 Apr 2002 09:37:26 +0200
To: zsh-workers@sunsite.dk
Subject: Re: _values does not quote inserted matches
In-Reply-To: <20020423094513.GA20267@logica.com>
References: <001501c1e77d$6e0a94c0$1fc1f2a3@mow.siemens.ru>
	<1020419165448.ZM15149@candle.brasslantern.com>
	<20020423094513.GA20267@logica.com>
X-Mailer: VM 6.95 under 21.5 (patch 3) "asparagus" XEmacs Lucid


Oliver Kiddle wrote:

> Andrej wrote:
> > 
> > Here is updated version. It relies on recent _values fixes. The
> > completion is correct for Mandrake 8.2. If you say O.K it will go in
> > both head and 4.0.
> 
> Are the recent _values fixes going on the 4.0 branch then? I'd say that
> was questionable without first checking through _values calls for
> quoted strings. Presumably _urpmi can be adjusted for the old _values
> fairly easily so if Andrej is happy that it works on each branch, it
> gets my okay.

Well, the C-code changes (16998) have been applied to 4.0. If that's
everything this patch relies upon, it's probably ok. No doubt Andrej
has made or will make sure.

> > I'd like to use common with _rpm cache and functions to get list of
> > installed RPMs, but _rpm is one large function and I am reluctant to
> > split it (I remember somebody was against it, but forgot reasons).
> 
> I can't think of any reason why not. It is very similar to the Debian
> situation where we have an _deb_packages used by both _dpkg and _apt.
> Maybe the reasons against splitting _rpm before was based on rpm being
> the only command to complete rpm packages.

I think we only were against splitting it up so that we have one
function file per sub-command. Factoring out the completion of RPM
names is alright, I think.

> Bart wrote:
> > Somebody other than me (Peter?  Oliver?  Sven?) should give the OK.
> 
> Well I haven't been able to test the _values calling part as it gets
> its arguments by parsing urpmi.cfg which I don't have.
> 
> Looking over the rest it looks fine. The one thing I see that I would
> do differently is to have a single tags loop in _urpmi_rpms instead
> of the three consecutive _wanted calls. It also adds source and
> binary rpms separately which means that directories get added twice.
> I think it'd be better to add them together - a user can always
> separate them with a file-patterns style.

Right. My only other comment is that the indentation style is
completely different from our normal one in the completion functions.


Bye
  Sven

-- 
Sven Wischnowsky                          wischnow@berkom.de

