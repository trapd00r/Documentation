From zsh-workers-return-8826-mason-zsh=primenet.com.au@sunsite.auc.dk Tue Nov 30 18:15:48 1999
Return-Path: <zsh-workers-return-8826-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 4832 invoked from network); 30 Nov 1999 18:15:37 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 30 Nov 1999 18:15:37 -0000
Received: (qmail 11836 invoked by alias); 30 Nov 1999 18:15:29 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 8826
Received: (qmail 11829 invoked from network); 30 Nov 1999 18:15:28 -0000
To: zsh-workers@sunsite.auc.dk
From: zefram@fysh.org
Subject: PATCH: zftp without inet_aton()
Message-Id: <E11sroF-0004Kq-00@crucigera.fysh.org>
Date: Tue, 30 Nov 1999 18:15:27 +0000

This should fix zftp for systems that lack inet_aton().  I haven't tested
it on such a system, however.

-zefram

diff -cr ../zsh-/Src/Modules/zftp.c ./Src/Modules/zftp.c
*** ../zsh-/Src/Modules/zftp.c	Sun Nov 28 17:42:28 1999
--- ./Src/Modules/zftp.c	Tue Nov 30 18:04:01 1999
***************
*** 126,131 ****
--- 126,147 ----
  #ifndef HAVE_INET_PTON
  
  /**/
+ # ifndef HAVE_INET_ATON
+ 
+ #  ifndef INADDR_NONE
+ #   define INADDR_NONE 0xffffffffUL
+ #  endif
+ 
+ /**/
+ static int inet_aton(char const *src, struct in_addr *dst)
+ {
+     return (dst->s_addr = inet_addr(src)) != INADDR_NONE;
+ }
+ 
+ /**/
+ # endif /* !HAVE_INET_ATON */
+ 
+ /**/
  static int
  inet_pton(int af, char const *src, void *dst)
  {
diff -cr ../zsh-/configure.in ./configure.in
*** ../zsh-/configure.in	Sun Nov 28 17:42:26 1999
--- ./configure.in	Tue Nov 30 17:57:13 1999
***************
*** 791,797 ****
                sigprocmask setuid seteuid setreuid setresuid setsid strerror \
                nis_list initgroups fchdir cap_get_proc readlink nice \
  	      getgrgid getgrnam getpwent getpwnam getpwuid setpgrp \
! 	      inet_pton inet_ntop getipnodebyname gethostbyname2 \
  	      fseeko ftello mmap munmap msync ftruncate setlocale)
  
  dnl ---------------
--- 791,797 ----
                sigprocmask setuid seteuid setreuid setresuid setsid strerror \
                nis_list initgroups fchdir cap_get_proc readlink nice \
  	      getgrgid getgrnam getpwent getpwnam getpwuid setpgrp \
! 	      inet_aton inet_pton inet_ntop getipnodebyname gethostbyname2 \
  	      fseeko ftello mmap munmap msync ftruncate setlocale)
  
  dnl ---------------
END

