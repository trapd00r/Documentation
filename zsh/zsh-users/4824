From zsh-users-return-4824-mason-zsh=primenet.com.au@sunsite.dk Wed Apr 10 06:22:52 2002
Return-Path: <zsh-users-return-4824-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21534 invoked from network); 10 Apr 2002 06:22:51 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 10 Apr 2002 06:22:51 -0000
Received: (qmail 17618 invoked by alias); 10 Apr 2002 06:22:38 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 4824
Received: (qmail 17606 invoked from network); 10 Apr 2002 06:22:37 -0000
From: Borsenkow Andrej <Andrej.Borsenkow@mow.siemens.ru>
To: "'Ackersviller, Paul:'" <packersv@ppco.com>, zsh-users@sunsite.dk
Subject: RE: 4.0.4 configuration on AIX 5.1
Date: Wed, 10 Apr 2002 10:22:24 +0400
Message-ID: <000401c1e058$15c88050$1fc1f2a3@mow.siemens.ru>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.3416
In-Reply-To: <8A6886DD01F4D511A0FC00508BBB3FC101229DC4@phxntx04.mkt.tosco.com>
x-mimeole: Produced By Microsoft MimeOLE V6.00.2600.0000
Importance: Normal

> 
> I'm running into some trouble building zsh on AIX 5.1 due to the code
in
> Src/utils.c and Src/Modules/cap.c inside #ifdef HAVE_CAP_GET_PROC.
> There are two strange things I notice about this system.  First,
there's a
> <sys/capabilities.h> that seems to replace <sys/capability.h>, but it
won't
> work to include this instead because it typedefs cap_t as void *,
while not
> having a prototype for cap_get_proc().
> 

autoconf 2.5x has standard tests for declaration (AC_CHECK_DECL). I am
not sure if autoconf-2.13 includes them. If not I am afraid adding extra
tests won't do for 4.0.x (too much change).

> This system also has no libcap library, although there is a
cap_get_proc
> directly in the C library (which I assume configure is finding).
However
> I'm unable to find documentation on it, nor can I find a prototype for
it
> anywhere in the system headers.
> 
> Anyway, I can compile zsh by taking the HAVE_CAP_GET_PROC
> definition out of config.h and building in Src/.  Does anyone think
the
> configure script should be able to handle this system, or is it too
broken?
> 

You could also remove cap nodule from modules.list. I guess it should go
into Etc/MACHINES then. 

Or you could add explicit tests to zsh/cap for AIX 5.1 to skip building
it on this system. It is ugly but it is better that nothing.

-andrej

