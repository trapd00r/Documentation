From zsh-workers-return-7244-mason-zsh=primenet.com.au@sunsite.auc.dk Wed Jul 21 15:51:08 1999
Return-Path: <zsh-workers-return-7244-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29110 invoked from network); 21 Jul 1999 15:51:06 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 21 Jul 1999 15:51:06 -0000
Received: (qmail 15510 invoked by alias); 21 Jul 1999 15:50:57 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 7244
Received: (qmail 15502 invoked from network); 21 Jul 1999 15:50:56 -0000
To: zsh-workers@sunsite.auc.dk
Subject: core dump with completion.
MIME-Version: 1.0 (generated by AKEMI 1.13.2 - =?ISO-2022-JP?B?Ig==?=
 =?ISO-2022-JP?B?GyRCQTA0Y0s8GyhCIg==?=)
Content-Type: text/plain; charset=US-ASCII
From: Tanaka Akira <akr@jaist.ac.jp>
Date: 22 Jul 1999 00:50:54 +0900
Message-ID: <rsqogh62e8x.fsf@crane.jaist.ac.jp>
Lines: 171
User-Agent: Chao-gnus/6.12.5 AKEMI/1.13.2 (=?ISO-2022-JP?B?GyRCQTAbKEI=?=
 =?ISO-2022-JP?B?GyRCNGNLPBsoQg==?=) FLAM-DOODLE/1.12.6
 (=?ISO-2022-JP?B?GyRCM3cbKEI=?= 10R4.0/5.0) Emacs/20.4
 (sparc-sun-solaris2.6) MULE/4.0 (HANANOEN)

zsh dumps core with completion with following operation.

Script started, file is typescript
$ ls
7196              7217              7230              share
7202              7218              7231              typescript
7205              7219              7235              u2456
7209              7220              7241              zsh-3.1.6-test-2
7210              7223              bin
7213              7226              lib
7216              7229              man
$ bin/zsh -f
is27e1u11% bindkey -e; autoload -U compinit; compinit
is27e1u11% cvs add <TAB><C-c>
is27e1u11% A=sh<TAB>zsh: segmentation fault (core dumped)  bin/zsh -f
$ Script done, file is typescript

The backtrace is follows.

Z:akr@is27e1u11% gdb bin/zsh core
GNU gdb 19981224
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "sparc-sun-solaris2.7"...
Core was generated by `bin/zsh -f'.
Program terminated with signal 11, Segmentation Fault.
Reading symbols from /usr/lib/libsocket.so.1...done.
Reading symbols from /usr/lib/libdl.so.1...done.
Reading symbols from /usr/lib/libnsl.so.1...done.
Reading symbols from /usr/lib/libcurses.so.1...done.
Reading symbols from /usr/lib/libc.so.1...done.
Reading symbols from /usr/lib/libmp.so.2...done.
Reading symbols from /usr/platform/SUNW,Ultra-5_10/lib/libc_psr.so.1...done.
Reading symbols from /home/fs114/akr/zsh/y/lib/zsh/3.1.6-test-2/comp1.so...
done.
Reading symbols from /home/fs114/akr/zsh/y/lib/zsh/3.1.6-test-2/zle.so...done.
Reading symbols from /home/fs114/akr/zsh/y/lib/zsh/3.1.6-test-2/compctl.so...
done.
#0  0xff136bf8 in strlen ()
(gdb) where
#0  0xff136bf8 in strlen ()
#1  0x699a4 in dupstring (s=0x1 <Address 0x1 out of bounds>) at mem.c:494
#2  0x97c04 in arrdup (s=0x14b094) at utils.c:2234
#3  0xff1dbb78 in comp_wrapper (list=0x0, w=0x0, name=0x1204d0 "_first")
    at compctl.c:2412
#4  0x37f78 in runshfunc (list=0x0, wrap=0xff1ed770, name=0x1204d0 "_first")
    at exec.c:3006
#5  0x37c70 in doshfunc (name=0x1204d0 "_first", list=0x0, doshargs=0x1197c0, 
    flags=2048, noreturnval=0) at exec.c:2957
#6  0x37654 in execshfunc (cmd=0x10a5f8, shf=0x120298, args=0x1197c0)
    at exec.c:2850
#7  0x343f4 in execcmd (cmd=0x10a5f8, input=0, output=0, how=2, last1=2)
    at exec.c:2013
#8  0x300e0 in execpline2 (pline=0x10a758, how=2, input=0, output=0, last1=0)
    at exec.c:1054
#9  0x2f240 in execpline (l=0x109b90, how=2, last1=0) at exec.c:869
#10 0x2eb68 in execlist (list=0x109360, dont_change_job=1, exiting=0)
    at exec.c:738
#11 0x639b8 in execif (cmd=0x106dd0, args=0x0, flags=0) at loop.c:404
#12 0x34164 in execcmd (cmd=0x106dd0, input=0, output=0, how=2, last1=2)
    at exec.c:1976
#13 0x300e0 in execpline2 (pline=0x10d1a0, how=2, input=0, output=0, last1=0)
    at exec.c:1054
#14 0x2f240 in execpline (l=0x109b30, how=2, last1=0) at exec.c:869
#15 0x2eb68 in execlist (list=0x108060, dont_change_job=1, exiting=0)
    at exec.c:738
#16 0x38048 in runshfunc (list=0x10b510, wrap=0x0, name=0x11fb70 "_complete")
    at exec.c:3019
#17 0xff1dbbf0 in comp_wrapper (list=0x10b510, w=0x0, 
    name=0x11fb70 "_complete") at compctl.c:2415
#18 0x37f78 in runshfunc (list=0x10b510, wrap=0xff1ed770, 
    name=0x11fb70 "_complete") at exec.c:3006
#19 0x37c70 in doshfunc (name=0x11fb70 "_complete", list=0x10b510, 
    doshargs=0x119570, flags=2048, noreturnval=0) at exec.c:2957
---Type <return> to continue, or q <return> to quit---
#20 0x37654 in execshfunc (cmd=0x106d58, shf=0x11fb28, args=0x119570)
    at exec.c:2850
#21 0x343f4 in execcmd (cmd=0x106d58, input=0, output=0, how=2, last1=2)
    at exec.c:2013
#22 0x300e0 in execpline2 (pline=0x10c8b0, how=2, input=0, output=0, last1=0)
    at exec.c:1054
#23 0x2f240 in execpline (l=0x1077e0, how=2, last1=0) at exec.c:869
#24 0x2eb68 in execlist (list=0x10c958, dont_change_job=1, exiting=0)
    at exec.c:738
#25 0x63838 in execif (cmd=0x106da8, args=0x0, flags=0) at loop.c:392
#26 0x34164 in execcmd (cmd=0x106da8, input=0, output=0, how=2, last1=2)
    at exec.c:1976
#27 0x300e0 in execpline2 (pline=0x1085a8, how=2, input=0, output=0, last1=0)
    at exec.c:1054
#28 0x2f240 in execpline (l=0x10bc58, how=2, last1=0) at exec.c:869
#29 0x2eb68 in execlist (list=0x108590, dont_change_job=1, exiting=0)
    at exec.c:738
#30 0x62410 in execfor (cmd=0x106d80, args=0x119530, flags=0) at loop.c:117
#31 0x34164 in execcmd (cmd=0x106d80, input=0, output=0, how=2, last1=2)
    at exec.c:1976
#32 0x300e0 in execpline2 (pline=0x108578, how=2, input=0, output=0, last1=0)
    at exec.c:1054
#33 0x2f240 in execpline (l=0x109750, how=2, last1=0) at exec.c:869
#34 0x2eb68 in execlist (list=0x10c7f0, dont_change_job=1, exiting=0)
    at exec.c:738
#35 0x38048 in runshfunc (list=0x1084e0, wrap=0x0, 
    name=0x116e30 "_main_complete") at exec.c:3019
#36 0xff1dbbf0 in comp_wrapper (list=0x1084e0, w=0x0, 
    name=0x116e30 "_main_complete") at compctl.c:2415
#37 0x37f78 in runshfunc (list=0x1084e0, wrap=0xff1ed770, 
    name=0x116e30 "_main_complete") at exec.c:3006
#38 0x37c70 in doshfunc (name=0x116e30 "_main_complete", list=0x1084e0, 
    doshargs=0x0, flags=0, noreturnval=0) at exec.c:2957
#39 0xff0c9554 in callcompfunc (s=0xce230 "sh", fn=0x116e30 "_main_complete")
---Type <return> to continue, or q <return> to quit---
    at zle_tricky.c:4775
#40 0xff0c9f28 in makecomplist (s=0xce230 "sh", incmd=0, lst=0)
    at zle_tricky.c:4932
#41 0xff0c7de0 in docompletion (s=0x10ccd0 "sh", lst=0, incmd=0)
    at zle_tricky.c:4449
#42 0xff0ba730 in docomplete (lst=0) at zle_tricky.c:1076
#43 0xff0b7be8 in expandorcomplete (args=0xff0f8070) at zle_tricky.c:491
#44 0xff0b7678 in completecall (args=0xff0f8070) at zle_tricky.c:390
#45 0xff0a8974 in execzlefunc (func=0xff0f5fcc, args=0xff0f8070)
    at zle_main.c:628
#46 0xff0a8468 in zleread (lp=0xc95e8 "%m%# ", rp=0x0, flags=3)
    at zle_main.c:547
#47 0x54c94 in inputline () at input.c:265
#48 0x54a60 in ingetc () at input.c:210
#49 0x4a980 in ihgetc () at hist.c:242
#50 0x5cb2c in gettok () at lex.c:545
#51 0x5be90 in yylex () at lex.c:308
#52 0x79d24 in parse_event () at parse.c:105
#53 0x514cc in loop (toplevel=1, justonce=0) at init.c:113
#54 0x1a8b8 in main (argc=2, argv=0xffbef6dc) at ./main.c:89
(gdb) 

typescript is follows.

begin 644 typescript
M4V-R:7!T('-T87)T960@;VX@5&AU($IU;" R,B P,#HT-#HR.2 Q.3DY"@T;
M6VT;6VT;6VT;6THD(!M;2VP(;',-#0HW,3DV(" @(" @(" @(" @(" W,C$W
M(" @(" @(" @(" @(" W,C,P(" @(" @(" @(" @("!S:&%R90T*-S(P,B @
M(" @(" @(" @(" @-S(Q." @(" @(" @(" @(" @-S(S,2 @(" @(" @(" @
M(" @='EP97-C<FEP= T*-S(P-2 @(" @(" @(" @(" @-S(Q.2 @(" @(" @
M(" @(" @-S(S-2 @(" @(" @(" @(" @=3(T-38-"C<R,#D@(" @(" @(" @
M(" @(#<R,C @(" @(" @(" @(" @(#<R-#$@(" @(" @(" @(" @('IS:"TS
M+C$N-BUT97-T+3(-"C<R,3 @(" @(" @(" @(" @(#<R,C,@(" @(" @(" @
M(" @(&)I;@T*-S(Q,R @(" @(" @(" @(" @-S(R-B @(" @(" @(" @(" @
M;&EB#0HW,C$V(" @(" @(" @(" @(" W,C(Y(" @(" @(" @(" @("!M86X-
M"@T;6VT;6VT;6VT;6THD(!M;2V((8FEN+WIS:" M9@T-"@T;6VT;6VT;6VT;
M6TII<S(W93%U,3$E(!M;2V((8FEN9&ME>2 M93L@875T;VQO860@+54@8V]M
M<&EN:70[(&-O;7!I;FET#0T*#1M;;1M;;1M;;1M;2FES,C=E,74Q,24@&UM+
M8PAC=G,@861D( <-#0HM:R @(" @(" @(" @(" @(" @-S(Q,R @(" @(" @
M(" @(" @(#<R,C8@(" @(" @(" @(" @("!L:6(O#0HM;2 @(" @(" @(" @
M(" @(" @-S(Q-B @(" @(" @(" @(" @(#<R,CD@(" @(" @(" @(" @("!M
M86XO#0HW,3DV(" @(" @(" @(" @(" @-S(Q-R @(" @(" @(" @(" @(#<R
M,S @(" @(" @(" @(" @("!S:&%R92\-"C<R,#(@(" @(" @(" @(" @(" W
M,C$X(" @(" @(" @(" @(" @-S(S,2 @(" @(" @(" @(" @('1Y<&5S8W)I
M<'0@#0HW,C U(" @(" @(" @(" @(" @-S(Q.2 @(" @(" @(" @(" @(#<R
M,S4@(" @(" @(" @(" @("!U,C0U-B -"C<R,#D@(" @(" @(" @(" @(" W
M,C(P(" @(" @(" @(" @(" @-S(T,2 @(" @(" @(" @(" @('IS:"TS+C$N
M-BUT97-T+3(O#0HW,C$P(" @(" @(" @(" @(" @-S(R,R @(" @(" @(" @
M(" @(&)I;B\@(" @(" @(" @(" @(" ;6S=!&UMM&UMM&UMM#1M;,3%#&ULX
M0PT-"AM;2@T;6VT;6VT;6VT;6TII<S(W93%U,3$E(!M;2T$(03US:'IS:#H@
M<V5G;65N=&%T:6]N(&9A=6QT("AC;W)E(&1U;7!E9"D@(&)I;B]Z<V@@+68-
M"@T;6VT;6VT;6VT;6THD(!M;2PT-"GIS:#H@9&\@>6]U('=I<V@@=&\@<V5E
M(&%L;" R.3$W('!O<W-I8FEL:71I97,_(&X-&UM*&UM!&UMM&UMM&UMM#1M;
K,D,*<V-R:7!T(&1O;F4@;VX@5&AU($IU;" R,B P,#HT-3HP-B Q.3DY"AM;
 
end
-- 
Tanaka Akira

