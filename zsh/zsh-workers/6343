From zsh-workers-return-6343-mason-zsh=primenet.com.au@sunsite.auc.dk Tue May 25 07:57:26 1999
Return-Path: <zsh-workers-return-6343-mason-zsh=primenet.com.au@sunsite.auc.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 21855 invoked from network); 25 May 1999 07:57:24 -0000
Received: from sunsite.auc.dk (130.225.51.30)
  by ns1.primenet.com.au with SMTP; 25 May 1999 07:57:24 -0000
Received: (qmail 25645 invoked by alias); 25 May 1999 07:57:04 -0000
Mailing-List: contact zsh-workers-help@sunsite.auc.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.auc.dk
X-Seq: 6343
Received: (qmail 25638 invoked from network); 25 May 1999 07:57:04 -0000
Date: Tue, 25 May 1999 09:56:55 +0200 (MET DST)
Message-Id: <199905250756.JAA03767@beta.informatik.hu-berlin.de>
From: Sven Wischnowsky <wischnow@informatik.hu-berlin.de>
To: zsh-workers@sunsite.auc.dk
Subject: PATCH: small completion matching fix


With `compctl -M "r:|-=*"' the string `f--' didn't match `f-oo-bar'
because the code avoided re-using a matching spec if it didn't match
anything (to avoid infinite recursion). This is still important to
have, but the test was wrong because the length of the matched anchor
wasn't taken into account.

Bye
 Sven

diff -u os/Zle/zle_tricky.c Src/Zle/zle_tricky.c
--- os/Zle/zle_tricky.c	Wed May 19 20:23:33 1999
+++ Src/Zle/zle_tricky.c	Fri May 21 23:44:01 1999
@@ -2327,7 +2327,7 @@
 		    }
 		    ow = w;
 
-		    if (!ict)
+		    if (!llen && !alen)
 			lm = mp;
 		    else
 			lm = NULL;

--
Sven Wischnowsky                         wischnow@informatik.hu-berlin.de

