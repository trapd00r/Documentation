From zsh-workers-request@math.gatech.edu Sat Nov 07 09:28:03 1998
Return-Path: <zsh-workers-request@math.gatech.edu>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 13102 invoked from network); 7 Nov 1998 09:28:02 -0000
Received: from math.gatech.edu (list@130.207.146.50)
  by ns1.primenet.com.au with SMTP; 7 Nov 1998 09:28:02 -0000
Received: (from list@localhost)
	by math.gatech.edu (8.9.1/8.9.1) id EAA16934;
	Sat, 7 Nov 1998 04:23:33 -0500 (EST)
Resent-Date: Sat, 7 Nov 1998 04:23:33 -0500 (EST)
Sender: martin@golem.bi
Message-ID: <364410F4.7B138182@aon.at>
Date: Sat, 07 Nov 1998 10:20:52 +0100
From: Martin Birgmeier <Martin.Birgmeier@aon.at>
X-Mailer: Mozilla 4.06 [en] (X11; U; FreeBSD 2.2.7-STABLE i386)
MIME-Version: 1.0
To: zsh-workers@math.gatech.edu
Subject: Bug in zsh-3.1.5
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"lKt4s.0.X84.L61Hs"@math>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/4586
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

Hi -

First, thanks for a great program!

Now, the bug report: I am using zsh-3.1.5 on FreeBSD 2.2.7. Since zsh-3.1.3, there
is a bug in case statement processing. Relevant output goes here:

$ echo echo "${HOSTTYPE:-$OSTYPE}:${TERM}:${TTY}"       <--- informational
freebsd2.2.7:xterm:/dev/ttyp0

$ case a in                                             <--- works
a* | b* )
echo yes
;;
* )
echo no
;;
esac
yes

$ case "${HOSTTYPE:-$OSTYPE}:${TERM}:${TTY}" in         <--- works
freebsd*:xterm:* )
echo yes
;;
* )
echo no
;;
case> esac
yes

$ case "${HOSTTYPE:-$OSTYPE}:${TERM}:${TTY}" in        <--- DOES NOT WORK
freebsd*:xterm:* | freebsd*:xterms:* )
echo yes
;;
* )
echo no
;;
esac
no

It seems that the second choice of the first case label controls the truth
value of the expression!

$ case "${HOSTTYPE:-$OSTYPE}:${TERM}:${TTY}" in       <--- WORKS!
( freebsd*:xterm:* | freebsd*:xterms:* )
echo yes
;;
* )
echo no
;;
esac
yes

The last example shows that the problem must have something to do with
a new allowed syntax for case labels (leading parenthesis). Also, the
first example shows that the case statement is working if patterns are
quite simple.

I hope you can reproduce and fix this problem. I did not include
the output of "reporter" since I am quite confident that you don't
need it. If I am wrong, I'll mail it to you, just let me know.

Please note that I am not on the mailing list.

Best regards,

Martin

-- 
Martin Birgmeier

Vienna                            e-mail: Martin.Birgmeier@IEEE.org
Austria                                   Martin.Birgmeier@aon.at

