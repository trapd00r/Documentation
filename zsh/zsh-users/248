From hzoli@cs.elte.hu Tue Jun 11 07:06:26 1996
Received: from euclid.skiles.gatech.edu (list@euclid.skiles.gatech.edu [130.207.146.50]) by melb.werple.net.au (8.7.5/8.7.3/2) with ESMTP id HAA25405 for <mason@werple.mira.net.au>; Tue, 11 Jun 1996 07:06:23 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id QAA02641; Mon, 10 Jun 1996 16:56:24 -0400 (EDT)
Resent-Date: Mon, 10 Jun 1996 16:55:51 -0400 (EDT)
From: Zoltan Hidvegi <hzoli@cs.elte.hu>
Message-Id: <199606102056.WAA08308@bolyai.cs.elte.hu>
Subject: Re: zsh-2.6beta20  -  BUG: cmdstack empty
To: vlefevre@ens-lyon.fr
Date: Mon, 10 Jun 1996 22:56:39 +0200 (MET DST)
Cc: zsh-users@math.gatech.edu
In-Reply-To: <199606072252.AAA27655@perrache.ens-lyon.fr> from Vincent Lefevre at "Jun 8, 96 00:52:58 am"
Organization: Dept. of Comp. Sci., Eotvos University, Budapest, Hungary
Phone: (36 1)2669833 ext: 2667, home phone: (36 1) 2752368
X-Mailer: ELM [version 2.4ME+ PL16 (25)]
MIME-Version: 1.0
Content-Type: application/pgp; format=text; x-action=sign
Content-Transfer-Encoding: 7bit
Resent-Message-ID: <"iBJ2X2.0.Ve.Nl8ln"@euclid>
Resent-From: zsh-users@math.gatech.edu
X-Mailing-List: <zsh-users@math.gatech.edu> archive/latest/248
X-Loop: zsh-users@math.gatech.edu
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu
Content-Length: 1457
Status: OR

-----BEGIN PGP SIGNED MESSAGE-----

> Hi,
> 
> I've just compiled zsh-2.6-beta20. But with something like
> 
>   if [[ <condition> ]] echo abc
> 
> the string "BUG: cmdstack empty" is now displayed. Why?
> 
> Note: the option CSH_JUNKIE_PAREN is set.
> The machine is a Sparc5 under Solaris 2.4.

That a really obscure way of using if.  It is almost equivalent to the

[[ <condition> ]] && echo abc

construct.  Do we really need the above syntax?  This syntax is not
mentioned in the manual and the usage of similar obscure features is
explicely deprecated in zshmisc noting that this feature may go away in the
future.  Such constructs should never be used in shell scripts or startup
files although in interactive shells it might be useful.

Anyway this is a very easy bug.  It is really an old bug.  I enabled some
debug checks in beta20 to find some possibly hiding bugs this way.

Zoltan

 *** Src/parse.c	1996/06/10 18:27:36	2.7
 --- Src/parse.c	1996/06/10 20:45:16
 ***************
 *** 652,658 ****
   		cmdpush(nc);
   		addlinknode(thensl, par_list1());
   		nt++;
 - 		cmdpop();
   		incmdpos = 1;
   		break;
   	    }
 --- 652,657 ----

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3i
Charset: noconv

iQCVAwUBMbyMBAupSCiLN749AQEyUAQAmJH4/EgOBAJ8bm6h0v4n9Cg7Bna7nbc1
Tnh1o1pHUSL4ydca5PIGWrCEB4e6QvRM3+inr9t40Pe6SELc2yZxRcdNhBflRGgg
MkGcNqr4W75igYpXlhEmrutsv7kSkUGJ8SWgKPAZXP3fWK8ZSuwXFLk1mfj2K7vh
aNJvpsX7tns=
=/Ixr
-----END PGP SIGNATURE-----


