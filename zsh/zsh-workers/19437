From zsh-workers-return-19437-mason-zsh=primenet.com.au@sunsite.dk Wed Feb 18 13:35:35 2004
Return-Path: <zsh-workers-return-19437-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 8172 invoked from network); 18 Feb 2004 13:35:34 -0000
Received: from sunsite.dk (130.225.247.90)
  by ns1.primenet.com.au with SMTP; 18 Feb 2004 13:35:34 -0000
Received: (qmail 11767 invoked by alias); 18 Feb 2004 13:35:27 -0000
Mailing-List: contact zsh-workers-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-workers@sunsite.dk
X-Seq: 19437
Received: (qmail 11731 invoked from network); 18 Feb 2004 13:35:27 -0000
Received: from localhost (HELO sunsite.dk) (127.0.0.1)
  by localhost with SMTP; 18 Feb 2004 13:35:27 -0000
X-MessageWall-Score: 0 (sunsite.dk)
Received: from [193.109.254.211] by sunsite.dk (MessageWall 1.0.8) with SMTP; 18 Feb 2004 13:35:27 -0000
X-VirusChecked: Checked
X-Env-Sender: okiddle@yahoo.co.uk
X-Msg-Ref: server-6.tower-36.messagelabs.com!1077111326!3991995
X-StarScan-Version: 5.2.5; banners=-,-,-
X-Originating-IP: [158.234.9.163]
Received: (qmail 25307 invoked from network); 18 Feb 2004 13:35:26 -0000
Received: from iris.logica.co.uk (158.234.9.163)
  by server-6.tower-36.messagelabs.com with SMTP; 18 Feb 2004 13:35:26 -0000
Received: from trentino.logica.co.uk ([158.234.142.61])
	by iris.logica.co.uk (8.12.3/8.12.3/Debian -4) with ESMTP id i1IDZOkb010112
	for <zsh-workers@sunsite.dk>; Wed, 18 Feb 2004 13:35:25 GMT
Received: from trentino.logica.co.uk (localhost [127.0.0.1])
	by trentino.logica.co.uk (Postfix) with ESMTP id 090A67979FD6
	for <zsh-workers@sunsite.dk>; Wed, 18 Feb 2004 14:09:58 +0100 (CET)
To: zsh-workers@sunsite.dk (Zsh hackers list)
X-VirusChecked: Checked
X-StarScan-Version: 5.0.7; banners=.,-,-
In-reply-to: <20040214184324.9D336865B@pwstephenson.fsnet.co.uk> 
From: Oliver Kiddle <okiddle@yahoo.co.uk>
References: <20040214184324.9D336865B@pwstephenson.fsnet.co.uk>
Subject: Re: PATCH: fix configure good and proper. 
Date: Wed, 18 Feb 2004 14:09:57 +0100
Message-ID: <23791.1077109797@trentino.logica.co.uk>

On 14 Feb, Peter wrote:
> I've spent my afternoon updating configure to fit better with the latest
> features.  I will commit the changes immediately --- it's only been
> tried on Debian and Mandrake, so expect a certain amount of pain
> elsewhere.  However, the changes went a lot smoother than I expected.

This looks great.

Only one minor issue:

  config.status: executing config.modules commands
  ./config.status[1515]: config.modules.sh:  not found

That's because the dot command in /bin/sh on Solaris searches the path
for config.modules.sh. It seems bash will look in the current directory
anyway which is probably why it works on Linux. I've put the fix below.

> I have not reapplied the changes to attempt to improve terminfo
> configuration.  That will need rewriting; also, we need to avoid a
> problem with checking term.h before we know it compiles.

Yes, I still need the previous terminfo patch at home but it seems to
have solved the config.modules problems I had - thanks. I also get this
on Solaris 8. Is that what you're talking about with term.h:

  checking term.h usability... no
  checking term.h presence... yes
  configure: WARNING: term.h: present but cannot be compiled
  configure: WARNING: term.h:     check for missing prerequisite headers?
  configure: WARNING: term.h: see the Autoconf documentation
  configure: WARNING: term.h:     section "Present But Cannot Be Compiled"
  configure: WARNING: term.h: proceeding with the preprocessor's result
  configure: WARNING: term.h: in the future, the compiler will take precedence
  configure: WARNING:     ## ------------------------------------------ ##
  configure: WARNING:     ## Report this to the AC_PACKAGE_NAME lists.  ##
  configure: WARNING:     ## ------------------------------------------ ##
  checking for term.h... yes

Should we be defining something so that it says `zsh' instead of
AC_PACKAGE_NAME?

Doesn't seem to matter though - it builds and `make test' passes.

Oliver

Index: configure.ac
===================================================================
RCS file: /cvsroot/zsh/zsh/configure.ac,v
retrieving revision 1.6
diff -u -r1.6 configure.ac
--- configure.ac	17 Feb 2004 13:53:36 -0000	1.6
+++ configure.ac	18 Feb 2004 13:14:40 -0000
@@ -2341,7 +2341,7 @@
 
 AC_CONFIG_FILES(Config/defs.mk Makefile Doc/Makefile Etc/Makefile \
 Src/Makefile Test/Makefile)
-AC_CONFIG_COMMANDS([config.modules], [. config.modules.sh])
+AC_CONFIG_COMMANDS([config.modules], [. ./config.modules.sh])
 
 AC_OUTPUT
 

