From zsh-users-return-12146-mason-zsh=primenet.com.au@sunsite.dk Tue Oct 30 12:09:30 2007
Return-Path: <zsh-users-return-12146-mason-zsh=primenet.com.au@sunsite.dk>
Delivered-To: mason-zsh@primenet.com.au
Received: (qmail 29203 invoked from network); 30 Oct 2007 12:09:21 -0000
X-Spam-Checker-Version: SpamAssassin 3.2.3 (2007-08-08) on f.primenet.com.au
X-Spam-Level: 
X-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
	version=3.2.3
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by ns1.primenet.com.au with SMTP; 30 Oct 2007 12:09:21 -0000
Received-SPF: none (ns1.primenet.com.au: domain at sunsite.dk does not designate permitted sender hosts)
Received: (qmail 90878 invoked from network); 30 Oct 2007 12:09:15 -0000
Received: from sunsite.dk (130.225.247.90)
  by a.mx.sunsite.dk with SMTP; 30 Oct 2007 12:09:15 -0000
Received: (qmail 13188 invoked by alias); 30 Oct 2007 12:09:00 -0000
Mailing-List: contact zsh-users-help@sunsite.dk; run by ezmlm
Precedence: bulk
X-No-Archive: yes
Delivered-To: mailing list zsh-users@sunsite.dk
X-Seq: 12146
Received: (qmail 13167 invoked from network); 30 Oct 2007 12:08:59 -0000
Received: from news.dotsrc.org (HELO a.mx.sunsite.dk) (130.225.247.88)
  by sunsite.dk with SMTP; 30 Oct 2007 12:08:59 -0000
Received: (qmail 88542 invoked from network); 30 Oct 2007 12:08:59 -0000
Received: from smtp.ctxuk.citrix.com (HELO SMTP.EU.CITRIX.COM) (62.200.22.115)
  by a.mx.sunsite.dk with SMTP; 30 Oct 2007 12:08:54 -0000
X-IronPort-AV: E=Sophos;i="4.21,347,1188792000"; 
   d="scan'208";a="11584340"
Received: from lonpexchmx01.citrite.net ([10.30.224.191])
  by LONPIPO01.EU.CITRIX.COM with ESMTP; 30 Oct 2007 08:08:53 -0400
Received: from lonpexch01.citrite.net ([10.30.224.136]) by lonpexchmx01.citrite.net with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 30 Oct 2007 12:07:53 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Slow compdump on Vista - no .zcompdump created
Date: Tue, 30 Oct 2007 12:07:44 -0000
Message-ID: <DD74FBB8EE28D441903D56487861CD9D22D34884@lonpexch01.citrite.net>
In-Reply-To: <DD74FBB8EE28D441903D56487861CD9D22836A73@lonpexch01.citrite.net>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Slow compdump on Vista - no .zcompdump created
thread-index: AcgXOHvNIvXa841zQ2qztEbI0AG2VwAc3W7gANAWetA=
References: <DD74FBB8EE28D441903D56487861CD9D22719534@lonpexch01.citrite.net> <016801c8164c$301c5d70$90551850$@com> <DD74FBB8EE28D441903D56487861CD9D2271979B@lonpexch01.citrite.net> <018501c81658$6beebbc0$43cc3340$@com> <DD74FBB8EE28D441903D56487861CD9D2271A057@lonpexch01.citrite.net> <200710251044.l9PAi9Ag016224@news01.csr.com> <DD74FBB8EE28D441903D56487861CD9D22835ED2@lonpexch01.citrite.net> <20071025185356.GB19564@mastermind> <DD74FBB8EE28D441903D56487861CD9D22836A73@lonpexch01.citrite.net>
From: "John Cooper" <John.Cooper@eu.citrix.com>
To: "John Cooper" <John.Cooper@citrix.com>,
	"Matthew Wozniski" <godlygeek@gmail.com>,
	<zsh-users@sunsite.dk>
X-OriginalArrivalTime: 30 Oct 2007 12:07:53.0430 (UTC) FILETIME=[7FD50F60:01C81AED]

This problem also occurred on my home machine; it's now being fixed in
Cygwin:

http://www.cygwin.com/ml/cygwin/2007-10/msg00606.html

    --- John.

-----Original Message-----
From: John Cooper [mailto:John.Cooper@citrix.com]=20
Sent: 26 October 2007 09:57
To: Matthew Wozniski; zsh-users@sunsite.dk
Subject: RE: Slow compdump on Vista - no .zcompdump created

> try running
> cacls "`cygpath -w /c/Users/johnc.CITRITE/Documents`"
>
> and seeing if the output tells you anything interesting about the ACLs
> in effect.  After all, there has to be some reason why cygwin doesn't
> think that you have full write permissions to that directory.

It doesn't seem to show anything peculiar - it indicates that I (a
domain user) have full permissions and (I think) that these permissions
are inherited:
  CITRITE\johnc:F
  CITRITE\johnc:(OI)(CI)(IO)F

It also shows that Domain Users (and also "Everyone") have some special
read permissions:
  CITRITE\Domain Users:(special access:)
                                                      READ_CONTROL
                                                      FILE_READ_EA
=20
FILE_READ_ATTRIBUTES

I'll take a look later on my home machine (not in a domain) to see if
the problem occurs there - I suspect it won't.

    --- John.


-----Original Message-----
From: Matthew Wozniski [mailto:godlygeek@gmail.com]=20
Sent: 25 October 2007 19:54
To: zsh-users@sunsite.dk
Cc: John Cooper
Subject: Re: Slow compdump on Vista - no .zcompdump created

On Thu, Oct 25, 2007 at 12:12:59PM +0100, John Cooper wrote:
> I can create files in this directory:
>   $ touch /c/Users/johnc.CITRITE/Documents/foo=20
>   $
>=20
> .. although Cygwin seems to think it is not writeable:
>   $ ls -ld /c/Users/johnc.CITRITE/Documents
>=20
>   dr-x------+ 16 johnc mkpasswd 16384 Oct 25 12:10
> /c/Users/johnc.CITRITE/Documents/
>=20

Now we're on to something.  The directory is conspicuously missing
a 'w' for user permissions, but its permissions list ends in a '+',
which means overriding ACLs are in effect that mean that the
permissions on the directory can't really be mapped to simple user,
group, and other permissions.  Maybe you're only allowed to create
certain types of files in that directory, or something similar.
I dunno, I'm not really a windows person.  In any event, try running

cacls "`cygpath -w /c/Users/johnc.CITRITE/Documents`"

and seeing if the output tells you anything interesting about the ACLs
in effect.  After all, there has to be some reason why cygwin doesn't
think that you have full write permissions to that directory.

~Matt

