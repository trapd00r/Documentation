From zsh-workers-request@euclid.skiles.gatech.edu  Thu Aug  1 23:03:55 1996
Received: from euclid.skiles.gatech.edu (root@euclid.skiles.gatech.edu [130.207.146.50]) by coral.primenet.com.au (8.7.5/8.7.3) with ESMTP id XAA00221 for <mason@primenet.com.au>; Thu, 1 Aug 1996 23:03:49 +1000 (EST)
Received: (from list@localhost) by euclid.skiles.gatech.edu (8.7.3/8.7.3) id HAA05940; Thu, 1 Aug 1996 07:31:23 -0400 (EDT)
Resent-Date: Thu, 1 Aug 1996 07:31:23 -0400 (EDT)
Message-Id: <199608011129.NAA17916@hera.cuci.nl>
From: srb@cuci.nl (Stephen R. van den Berg)
Date: Thu, 1 Aug 1996 13:29:46 +0200
In-Reply-To: borsenkow.msk@sni.de's message as of 1996 Aug 1 Thu 12:28.
       <Pine.SV4.3.95.960801121636.4508C-100000@itsrm1>
To: borsenkow.msk@sni.de,
        Zsh workers mailing list <zsh-workers@math.gatech.edu>
Subject: Re: Procmail rejects zsh as being "broken"
Resent-Message-ID: <"iqr7b2.0.hS1.AM90o"@euclid>
Resent-From: zsh-workers@math.gatech.edu
X-Mailing-List: <zsh-workers@math.gatech.edu> archive/latest/1864
X-Loop: zsh-workers@math.gatech.edu
Precedence: list
Resent-Sender: zsh-workers-request@math.gatech.edu

borsenkow.msk@sni.de <borsenkow.msk@sni.de> wrote:
>I recently installed procmail-3.11pre4 under zsh-3.0pre4. When running
>'make init' procmail gave me warning, that `/opt/local/bin/zsh is broken'.
>I checked initmake script and here is relevant part:

>case "$SHELL" in
> ...
>       *zsh*) $RM src/_autotst
>            $SHELL <<HERE
>            O="echo test >src/_autotst"
>            exec 2>$DEVNULL
>            \$O
>HERE                                                                            
>           if test ! -f src/_autotst 
>           then
>              echo "Warning: your $SHELL is broken, avoiding it"; SHELL=""
>           fi ;;

>The test seems to imply, that in
>% foo="echo test > test"
>% $foo

>the line is to be rescanned for I/O redirections *after* foo is expanded. 
>I am not aware of any shell to behave this way. 

You're right.  Sorry, my mistake.  The test is a bit too rigorous, it
now fails on every shell (which just had the effect that it never used
the zsh, which is why I never noticed the problem, of course).  The intent
was to check for something else.

>Do I  miss something? What is the sense of this test? And why it is done
>only for zsh ;)?

The test should have read (fixed in the next release :-):

        *zsh*) $RM src/_autotst
            $SHELL <<HERE
            O="echo test"
            exec 2>$DEVNULL 1>&2
            \$O && echo test >src/_autotst
HERE

As to why it is just being tested on zsh, well, that's the only shell
that (ever) exhibited this (broken) behaviour.
-- 
Sincerely,                                                          srb@cuci.nl
           Stephen R. van den Berg (AKA BuGless).
Auto repair rates: basic labor $40/hour; if you wait, $60; if you watch, $80;
if you ask questions, $100; if you help, $120; if you laugh, $140.

